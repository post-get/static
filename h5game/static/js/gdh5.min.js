$(document).ready(function(){
    if (game_id) {
        var oCss = document.createElement("link");
        oCss.setAttribute("rel", "stylesheet");
        oCss.setAttribute("type", "text/css");
        oCss.setAttribute("href", '/static/css/modal.css');
        document.body.appendChild(oCss);

        oBoxw();
    }

});

function oBoxw(){

    var oBox = document.getElementById('modal-button');
    var oClose = document.getElementById('modal-left');
    var oModan = document.getElementById('moban');


    oBox.onmousedown = function(e){
        var oEvent = e || window.event,
            disL = oEvent.clientX - oBox.offsetLeft,
            disT = oEvent.clientY - oBox.offsetTop,
            maxL = document.documentElement.clientWidth - oBox.offsetWidth,
            maxT = document.documentElement.clientHeight - oBox.offsetHeight;

        document.onmousemove = function(e){
            var oEvent = e || window.event,
                disX = oEvent.clientX - disL,
                disY = oEvent.clientY - disT;
            if(disX <=0){ disX =0}
            if(disY <=0){ disY =0}
            if(disX >=maxL){ disX =maxL}
            if(disY >=maxT){ disY =maxT}
            oBox.style.left = disX+'px';
            oBox.style.top = disY+'px';
        }
    }
    document.onmouseup = function(){
        document.onmousemove = null;
    }

    oBox.addEventListener("touchstart",function(e){
        var p,f1,f2;
        //鐢变簬瑙﹀睆鐨勫潗鏍囨槸涓暟缁勶紝鎵€浠ュ彇鍑鸿繖涓暟缁勭殑绗竴涓厓绱�
        e=e.touches[0];
        //淇濆瓨oBox鍜屽紑濮嬭Е灞忔椂鐨勫潗鏍囧樊
        p={
            x:e.clientX - oBox.offsetLeft,
            y:e.clientY - oBox.offsetTop
        };
        maxL = document.documentElement.clientWidth - oBox.offsetWidth,
            maxT = document.documentElement.clientHeight - oBox.offsetHeight;
        //娣诲姞瑙﹀睆绉诲姩浜嬩欢
        document.addEventListener("touchmove",f2=function(e){
            //鑾峰彇淇濊Е灞忓潗鏍囩殑瀵硅薄
            var t=t=e.touches[0];
            //鎶妎Box绉诲姩鍒板垵濮嬭绠楃殑浣嶇疆鍔犱笂褰撳墠瑙﹀睆浣嶇疆
            disX = t.clientX - p.x,
                disY = t.clientY - p.y;
            if(disX <=0){ disX =0}
            if(disY <=0){ disY =0}
            if(disX >=maxL){ disX =maxL}
            if(disY >=maxT){ disY =maxT}
            oBox.style.left = disX+'px';
            oBox.style.top = disY+'px';
            //闃绘榛樿浜嬩欢
            e.preventDefault();
        },false);
        //娣诲姞瑙﹀睆缁撴潫浜嬩欢
        document.addEventListener("touchend",f1=function(e){
            //绉婚櫎鍦╠ocument涓婃坊鍔犵殑涓や釜浜嬩欢
            document.removeEventListener("touchend",f1);
            document.removeEventListener("touchmove",f2);
        },false);
    },false);

    oBox.onclick = function (){
        oBoxShow();
    };
    oClose.onclick = function(){
        oBoxHide();
    };
}

function oBoxShow(){
    var oModan = document.getElementById('moban');
    flag = 3;
    if(oModan){
        oModan.style.display = 'block';
        //_czc.push(["_trackEvent",'鎮诞鎸夐挳','鏄剧ず']);
        return 1;
    }else{
        return '/libao.html';
    }
}

function oBoxHide(){
    var oModan = document.getElementById('moban');
    oModan.style.display = 'none';
    //_czc.push(["_trackEvent",'鎮诞鎸夐挳','闅愯棌']);
    var flag = 2;
    if (flag == 2)
    {
        window.history.pushState({
            title: document.title,
            url: location.href
        }, document.title, location.href);
    }
}