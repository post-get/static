
/***********************************/
/*http://www.layabox.com  2017/12/12*/
/***********************************/
var Laya=window.Laya=(function(window,document){
	var Laya={
		__internals:[],
		__packages:{},
		__classmap:{'Object':Object,'Function':Function,'Array':Array,'String':String},
		__sysClass:{'object':'Object','array':'Array','string':'String','dictionary':'Dictionary'},
		__propun:{writable: true,enumerable: false,configurable: true},
		__presubstr:String.prototype.substr,
		__substr:function(ofs,sz){return arguments.length==1?Laya.__presubstr.call(this,ofs):Laya.__presubstr.call(this,ofs,sz>0?sz:(this.length+sz));},
		__init:function(_classs){_classs.forEach(function(o){o.__init$ && o.__init$();});},
		__isClass:function(o){return o && (o.__isclass || o==Object || o==String || o==Array);},
		__newvec:function(sz,value){
			var d=[];
			d.length=sz;
			for(var i=0;i<sz;i++) d[i]=value;
			return d;
		},
		__extend:function(d,b){
			for (var p in b){
				if (!b.hasOwnProperty(p)) continue;
				var gs=Object.getOwnPropertyDescriptor(b, p);
				var g = gs.get, s = gs.set; 
				if ( g || s ) {
					if ( g && s)
						Object.defineProperty(d,p,gs);
					else{
						g && Object.defineProperty(d, p, g);
						s && Object.defineProperty(d, p, s);
					}
				}
				else d[p] = b[p];
			}
			function __() { Laya.un(this,'constructor',d); }__.prototype=b.prototype;d.prototype=new __();Laya.un(d.prototype,'__imps',Laya.__copy({},b.prototype.__imps));
		},
		__copy:function(dec,src){
			if(!src) return null;
			dec=dec||{};
			for(var i in src) dec[i]=src[i];
			return dec;
		},
		__package:function(name,o){
			if(Laya.__packages[name]) return;
			Laya.__packages[name]=true;
			var p=window,strs=name.split('.');
			if(strs.length>1){
				for(var i=0,sz=strs.length-1;i<sz;i++){
					var c=p[strs[i]];
					p=c?c:(p[strs[i]]={});
				}
			}
			p[strs[strs.length-1]] || (p[strs[strs.length-1]]=o||{});
		},
		__hasOwnProperty:function(name,o){
			o=o ||this;
		    function classHas(name,o){
				if(Object.hasOwnProperty.call(o.prototype,name)) return true;
				var s=o.prototype.__super;
				return s==null?null:classHas(name,s);
			}
			return (Object.hasOwnProperty.call(o,name)) || classHas(name,o.__class);
		},
		__typeof:function(o,value){
			if(!o || !value) return false;
			if(value===String) return (typeof o==='string');
			if(value===Number) return (typeof o==='number');
			if(value.__interface__) value=value.__interface__;
			else if(typeof value!='string')  return (o instanceof value);
			return (o.__imps && o.__imps[value]) || (o.__class==value);
		},
		__as:function(value,type){
			return (this.__typeof(value,type))?value:null;
		},
        __int:function(value){
            return value?parseInt(value):0;
        },
		interface:function(name,_super){
			Laya.__package(name,{});
			var ins=Laya.__internals;
			var a=ins[name]=ins[name] || {self:name};
			if(_super)
			{
				var supers=_super.split(',');
				a.extend=[];
				for(var i=0;i<supers.length;i++){
					var nm=supers[i];
					ins[nm]=ins[nm] || {self:nm};
					a.extend.push(ins[nm]);
				}
			}
			var o=window,words=name.split('.');
			for(var i=0;i<words.length-1;i++) o=o[words[i]];
			o[words[words.length-1]]={__interface__:name};
		},
		class:function(o,fullName,_super,miniName){
			_super && Laya.__extend(o,_super);
			if(fullName){
				Laya.__package(fullName,o);
				Laya.__classmap[fullName]=o;
				if(fullName.indexOf('.')>0){
					if(fullName.indexOf('laya.')==0){
						var paths=fullName.split('.');
						miniName=miniName || paths[paths.length-1];
						if(Laya[miniName]) console.log("Warning!,this class["+miniName+"] already exist:",Laya[miniName]);
						Laya[miniName]=o;
					}
				}
				else {
					if(fullName=="Main")
						window.Main=o;
					else{
						if(Laya[fullName]){
							console.log("Error!,this class["+fullName+"] already exist:",Laya[fullName]);
						}
						Laya[fullName]=o;
					}
				}
			}
			var un=Laya.un,p=o.prototype;
			un(p,'hasOwnProperty',Laya.__hasOwnProperty);
			un(p,'__class',o);
			un(p,'__super',_super);
			un(p,'__className',fullName);
			un(o,'__super',_super);
			un(o,'__className',fullName);
			un(o,'__isclass',true);
			un(o,'super',function(o){this.__super.call(o);});
		},
		imps:function(dec,src){
			if(!src) return null;
			var d=dec.__imps|| Laya.un(dec,'__imps',{});
			function __(name){
				var c,exs;
				if(! (c=Laya.__internals[name]) ) return;
				d[name]=true;
				if(!(exs=c.extend)) return;
				for(var i=0;i<exs.length;i++){
					__(exs[i].self);
				}
			}
			for(var i in src) __(i);
		},
        superSet:function(clas,o,prop,value){
            var fun = clas.prototype["_$set_"+prop];
            fun && fun.call(o,value);
        },
        superGet:function(clas,o,prop){
            var fun = clas.prototype["_$get_"+prop];
           	return fun?fun.call(o):null;
        },
		getset:function(isStatic,o,name,getfn,setfn){
			if(!isStatic){
				getfn && Laya.un(o,'_$get_'+name,getfn);
				setfn && Laya.un(o,'_$set_'+name,setfn);
			}
			else{
				getfn && (o['_$GET_'+name]=getfn);
				setfn && (o['_$SET_'+name]=setfn);
			}
			if(getfn && setfn) 
				Object.defineProperty(o,name,{get:getfn,set:setfn,enumerable:false,configurable:true});
			else{
				getfn && Object.defineProperty(o,name,{get:getfn,enumerable:false,configurable:true});
				setfn && Object.defineProperty(o,name,{set:setfn,enumerable:false,configurable:true});
			}
		},
		static:function(_class,def){
				for(var i=0,sz=def.length;i<sz;i+=2){
					if(def[i]=='length') 
						_class.length=def[i+1].call(_class);
					else{
						function tmp(){
							var name=def[i];
							var getfn=def[i+1];
							Object.defineProperty(_class,name,{
								get:function(){delete this[name];return this[name]=getfn.call(this);},
								set:function(v){delete this[name];this[name]=v;},enumerable: true,configurable: true});
						}
						tmp();
					}
				}
		},		
		un:function(obj,name,value){
			value || (value=obj[name]);
			Laya.__propun.value=value;
			Object.defineProperty(obj, name, Laya.__propun);
			return value;
		},
		uns:function(obj,names){
			names.forEach(function(o){Laya.un(obj,o)});
		}
	};

    window.console=window.console || ({log:function(){}});
	window.trace=window.console.log;
	Error.prototype.throwError=function(){throw arguments;};
	//String.prototype.substr=Laya.__substr;
	Object.defineProperty(Array.prototype,'fixed',{enumerable: false});

	return Laya;
})(window,document);

(function(window,document,Laya){
	var __un=Laya.un,__uns=Laya.uns,__static=Laya.static,__class=Laya.class,__getset=Laya.getset,__newvec=Laya.__newvec;
Laya.interface('laya.ui.IItem');
Laya.interface('laya.ui.ISelect');
Laya.interface('fight.IBattleDpo');
Laya.interface('game.base.IGameInit');
Laya.interface('laya.runtime.IMarket');
Laya.interface('laya.filters.IFilter');
Laya.interface('laya.display.ILayout');
Laya.interface('laya.resource.IDispose');
Laya.interface('laya.runtime.IConchNode');
Laya.interface('laya.webgl.shapes.IShape');
Laya.interface('laya.webgl.submit.ISubmit');
Laya.interface('laya.filters.IFilterAction');
Laya.interface('laya.webgl.text.ICharSegment');
Laya.interface('laya.runtime.ICPlatformClass');
Laya.interface('laya.webgl.canvas.save.ISaveData');
Laya.interface('huamao.panel.talk.PanelInterface');
Laya.interface('laya.webgl.resource.IMergeAtlasBitmap');
Laya.interface('laya.runtime.IPlatformClass','laya.runtime.IPlatform');
Laya.interface('laya.filters.IFilterActionGL','laya.filters.IFilterAction');
/**
*@private
*/
//class laya.utils.RunDriver
var RunDriver=(function(){
	function RunDriver(){}
	__class(RunDriver,'laya.utils.RunDriver');
	RunDriver.FILTER_ACTIONS=[];
	RunDriver.pixelRatio=-1;
	RunDriver._charSizeTestDiv=null;
	RunDriver.now=function(){
		return Date.now();
	}

	RunDriver.getWindow=function(){
		return window;
	}

	RunDriver.getPixelRatio=function(){
		if (RunDriver.pixelRatio < 0){
			var ctx=Browser.context;
			var backingStore=ctx.backingStorePixelRatio || ctx.webkitBackingStorePixelRatio || ctx.mozBackingStorePixelRatio || ctx.msBackingStorePixelRatio || ctx.oBackingStorePixelRatio || ctx.backingStorePixelRatio || 1;
			RunDriver.pixelRatio=(Browser.window.devicePixelRatio || 1)/ backingStore;
			if (RunDriver.pixelRatio < 1)RunDriver.pixelRatio=1;
		}
		return RunDriver.pixelRatio;
	}

	RunDriver.getIncludeStr=function(name){
		return null;
	}

	RunDriver.createShaderCondition=function(conditionScript){
		var fn="(function() {return "+conditionScript+";})";
		return Laya._runScript(fn);
	}

	RunDriver.fontMap=[];
	RunDriver.measureText=function(txt,font){
		var isChinese=RunDriver.hanzi.test(txt);
		if (isChinese && RunDriver.fontMap[font]){
			return RunDriver.fontMap[font];
		};
		var ctx=Browser.context;
		ctx.font=font;
		var r=ctx.measureText(txt);
		if (isChinese)RunDriver.fontMap[font]=r;
		return r;
	}

	RunDriver.getWebGLContext=function(canvas){
	};

	RunDriver.beginFlush=function(){
	};

	RunDriver.endFinish=function(){
	};

	RunDriver.addToAtlas=null;
	RunDriver.flashFlushImage=function(atlasWebGLCanvas){
	};

	RunDriver.drawToCanvas=function(sprite,_renderType,canvasWidth,canvasHeight,offsetX,offsetY){
		var canvas=HTMLCanvas.create("2D");
		var context=new RenderContext(canvasWidth,canvasHeight,canvas);
		RenderSprite.renders[_renderType]._fun(sprite,context,offsetX,offsetY);
		return canvas;
	}

	RunDriver.createParticleTemplate2D=null;
	RunDriver.createGLTextur=null;
	RunDriver.createWebGLContext2D=null;
	RunDriver.changeWebGLSize=function(w,h){
	};

	RunDriver.createRenderSprite=function(type,next){
		return new RenderSprite(type,next);
	}

	RunDriver.createFilterAction=function(type){
		return new ColorFilterAction();
	}

	RunDriver.createGraphics=function(){
		return new Graphics();
	}

	RunDriver.clear=function(value){
		Render._context.ctx.clear();
	}

	RunDriver.cancelLoadByUrl=function(url){
	};

	RunDriver.clearAtlas=function(value){
	};

	RunDriver.isAtlas=function(bitmap){
		return false;
	}

	RunDriver.addTextureToAtlas=function(value){
	};

	RunDriver.getTexturePixels=function(value,x,y,width,height){
		return null;
	}

	RunDriver.skinAniSprite=function(){
		return null;
	}

	RunDriver.update3DLoop=function(){
	};

	__static(RunDriver,
	['hanzi',function(){return this.hanzi=new RegExp("^[\u4E00-\u9FA5]$");}
	]);
	return RunDriver;
})()


/**
*<code>Laya</code> 是全局对象的引用入口集。
*Laya类引用了一些常用的全局对象，比如Laya.stage：舞台，Laya.timer：时间管理器，Laya.loader：加载管理器，使用时注意大小写。
*/
//class Laya
var ___Laya=(function(){
	//function Laya(){}
	/**
	*表示是否捕获全局错误并弹出提示。默认为false。
	*适用于移动设备等不方便调试的时候，设置为true后，如有未知错误，可以弹窗抛出详细错误堆栈。
	*/
	__getset(1,Laya,'alertGlobalError',null,function(value){
		var erralert=0;
		if (value){
			Browser.window.onerror=function (msg,url,line,column,detail){
				if (erralert++< 5 && detail)
					alert("出错啦，请把此信息截图给研发商\n"+msg+"\n"+detail.stack||detail);
			}
			}else {
			Browser.window.onerror=null;
		}
	});

	Laya.init=function(width,height,__plugins){
		var plugins=[];for(var i=2,sz=arguments.length;i<sz;i++)plugins.push(arguments[i]);
		if (Laya._isinit)return;
		ArrayBuffer.prototype.slice || (ArrayBuffer.prototype.slice=Laya._arrayBufferSlice);
		Laya._isinit=true;
		Browser.__init__();
		Context.__init__();
		Graphics.__init__();
		Laya.timer=new Timer();
		Laya.scaleTimer=new Timer();
		Laya.loader=new LoaderManager();
		WeakObject.__init__();
		for (var i=0,n=plugins.length;i < n;i++){
			if (plugins[i].enable)plugins[i].enable();
		}
		Font.__init__();
		Style.__init__();
		ResourceManager.__init__();
		CacheManager.beginCheck();
		Laya._currentStage=Laya.stage=new Stage();
		Laya.stage.conchModel && Laya.stage.conchModel.setRootNode();
		Laya.getUrlPath();
		Laya.render=new Render(0,0);
		Laya.stage.size(width,height);
		RenderSprite.__init__();
		KeyBoardManager.__init__();
		MouseManager.instance.__init__(Laya.stage,Render.canvas);
		Input.__init__();
		SoundManager.autoStopMusic=true;
		LocalStorage.__init__();
		return Render.canvas;
	}

	Laya.getUrlPath=function(){
		var location=Browser.window.location;
		var pathName=location.pathname;
		pathName=pathName.charAt(2)==':' ? pathName.substring(1):pathName;
		URL.rootPath=URL.basePath=URL.getPath(location.protocol=="file:" ? pathName :location.protocol+"//"+location.host+location.pathname);
	}

	Laya._arrayBufferSlice=function(start,end){
		var arr=this;
		var arrU8List=new Uint8Array(arr,start,end-start);
		var newU8List=new Uint8Array(arrU8List.length);
		newU8List.set(arrU8List);
		return newU8List.buffer;
	}

	Laya._runScript=function(script){
		return Browser.window["e"+String.fromCharCode(100+10+8)+"a"+"l"](script);
	}

	Laya.stage=null;
	Laya.timer=null;
	Laya.scaleTimer=null;
	Laya.loader=null;
	Laya.version="1.7.18";
	Laya.render=null;
	Laya._currentStage=null;
	Laya._isinit=false;
	Laya.MiniAdpter={init:function(){if (window.navigator && window.navigator.userAgent && window.navigator.userAgent.indexOf("MiniGame")>-1)console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}};
	__static(Laya,
	['conchMarket',function(){return this.conchMarket=window.conch?conchMarket:null;},'PlatformClass',function(){return this.PlatformClass=window.PlatformClass;}
	]);
	return Laya;
})()


/**
*<code>EventDispatcher</code> 类是可调度事件的所有类的基类。
*/
//class laya.events.EventDispatcher
var EventDispatcher=(function(){
	var EventHandler;
	function EventDispatcher(){
		/**@private */
		this._events=null;
	}

	__class(EventDispatcher,'laya.events.EventDispatcher');
	var __proto=EventDispatcher.prototype;
	/**
	*检查 EventDispatcher 对象是否为特定事件类型注册了任何侦听器。
	*@param type 事件的类型。
	*@return 如果指定类型的侦听器已注册，则值为 true；否则，值为 false。
	*/
	__proto.hasListener=function(type){
		var listener=this._events && this._events[type];
		return !!listener;
	}

	/**
	*派发事件。
	*@param type 事件类型。
	*@param data （可选）回调数据。<b>注意：</b>如果是需要传递多个参数 p1,p2,p3,...可以使用数组结构如：[p1,p2,p3,...] ；如果需要回调单个参数 p ，且 p 是一个数组，则需要使用结构如：[p]，其他的单个参数 p ，可以直接传入参数 p。
	*@return 此事件类型是否有侦听者，如果有侦听者则值为 true，否则值为 false。
	*/
	__proto.event=function(type,data){
		if (!this._events || !this._events[type])return false;
		var listeners=this._events[type];
		if (listeners.run){
			if (listeners.once)delete this._events[type];
			data !=null ? listeners.runWith(data):listeners.run();
			}else {
			for (var i=0,n=listeners.length;i < n;i++){
				var listener=listeners[i];
				if (listener){
					(data !=null)? listener.runWith(data):listener.run();
				}
				if (!listener || listener.once){
					listeners.splice(i,1);
					i--;
					n--;
				}
			}
			if (listeners.length===0 && this._events)delete this._events[type];
		}
		return true;
	}

	/**
	*使用 EventDispatcher 对象注册指定类型的事件侦听器对象，以使侦听器能够接收事件通知。
	*@param type 事件的类型。
	*@param caller 事件侦听函数的执行域。
	*@param listener 事件侦听函数。
	*@param args （可选）事件侦听函数的回调参数。
	*@return 此 EventDispatcher 对象。
	*/
	__proto.on=function(type,caller,listener,args){
		return this._createListener(type,caller,listener,args,false);
	}

	/**
	*使用 EventDispatcher 对象注册指定类型的事件侦听器对象，以使侦听器能够接收事件通知，此侦听事件响应一次后自动移除。
	*@param type 事件的类型。
	*@param caller 事件侦听函数的执行域。
	*@param listener 事件侦听函数。
	*@param args （可选）事件侦听函数的回调参数。
	*@return 此 EventDispatcher 对象。
	*/
	__proto.once=function(type,caller,listener,args){
		return this._createListener(type,caller,listener,args,true);
	}

	/**@private */
	__proto._createListener=function(type,caller,listener,args,once,offBefore){
		(offBefore===void 0)&& (offBefore=true);
		offBefore && this.off(type,caller,listener,once);
		var handler=EventHandler.create(caller || this,listener,args,once);
		this._events || (this._events={});
		var events=this._events;
		if (!events[type])events[type]=handler;
		else {
			if (!events[type].run)events[type].push(handler);
			else events[type]=[events[type],handler];
		}
		return this;
	}

	/**
	*从 EventDispatcher 对象中删除侦听器。
	*@param type 事件的类型。
	*@param caller 事件侦听函数的执行域。
	*@param listener 事件侦听函数。
	*@param onceOnly （可选）如果值为 true ,则只移除通过 once 方法添加的侦听器。
	*@return 此 EventDispatcher 对象。
	*/
	__proto.off=function(type,caller,listener,onceOnly){
		(onceOnly===void 0)&& (onceOnly=false);
		if (!this._events || !this._events[type])return this;
		var listeners=this._events[type];
		if (listener !=null){
			if (listeners.run){
				if ((!caller || listeners.caller===caller)&& listeners.method===listener && (!onceOnly || listeners.once)){
					delete this._events[type];
					listeners.recover();
				}
				}else {
				var count=0;
				for (var i=0,n=listeners.length;i < n;i++){
					var item=listeners[i];
					if (item && (!caller || item.caller===caller)&& item.method===listener && (!onceOnly || item.once)){
						count++;
						listeners[i]=null;
						item.recover();
					}
				}
				if (count===n)delete this._events[type];
			}
		}
		return this;
	}

	/**
	*从 EventDispatcher 对象中删除指定事件类型的所有侦听器。
	*@param type （可选）事件类型，如果值为 null，则移除本对象所有类型的侦听器。
	*@return 此 EventDispatcher 对象。
	*/
	__proto.offAll=function(type){
		var events=this._events;
		if (!events)return this;
		if (type){
			this._recoverHandlers(events[type]);
			delete events[type];
			}else {
			for (var name in events){
				this._recoverHandlers(events[name]);
			}
			this._events=null;
		}
		return this;
	}

	__proto._recoverHandlers=function(arr){
		if (!arr)return;
		if (arr.run){
			arr.recover();
			}else {
			for (var i=arr.length-1;i >-1;i--){
				if (arr[i]){
					arr[i].recover();
					arr[i]=null;
				}
			}
		}
	}

	/**
	*检测指定事件类型是否是鼠标事件。
	*@param type 事件的类型。
	*@return 如果是鼠标事件，则值为 true;否则，值为 false。
	*/
	__proto.isMouseEvent=function(type){
		return EventDispatcher.MOUSE_EVENTS[type];
	}

	EventDispatcher.MOUSE_EVENTS={"rightmousedown":true,"rightmouseup":true,"rightclick":true,"mousedown":true,"mouseup":true,"mousemove":true,"mouseover":true,"mouseout":true,"click":true,"doubleclick":true};
	EventDispatcher.__init$=function(){
		Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:false,writable:true});
		/**@private */
		//class EventHandler extends laya.utils.Handler
		EventHandler=(function(_super){
			function EventHandler(caller,method,args,once){
				EventHandler.__super.call(this,caller,method,args,once);
			}
			__class(EventHandler,'',_super);
			var __proto=EventHandler.prototype;
			__proto.recover=function(){
				if (this._id > 0){
					this._id=0;
					EventHandler._pool.push(this.clear());
				}
			}
			EventHandler.create=function(caller,method,args,once){
				(once===void 0)&& (once=true);
				if (EventHandler._pool.length)return EventHandler._pool.pop().setTo(caller,method,args,once);
				return new EventHandler(caller,method,args,once);
			}
			EventHandler._pool=[];
			return EventHandler;
		})(Handler)
	}

	return EventDispatcher;
})()


/**
*<p><code>Handler</code> 是事件处理器类。</p>
*<p>推荐使用 Handler.create()方法从对象池创建，减少对象创建消耗。创建的 Handler 对象不再使用后，可以使用 Handler.recover()将其回收到对象池，回收后不要再使用此对象，否则会导致不可预料的错误。</p>
*<p><b>注意：</b>由于鼠标事件也用本对象池，不正确的回收及调用，可能会影响鼠标事件的执行。</p>
*/
//class laya.utils.Handler
var Handler=(function(){
	function Handler(caller,method,args,once){
		/**执行域(this)。*/
		//this.caller=null;
		/**处理方法。*/
		//this.method=null;
		/**参数。*/
		//this.args=null;
		/**表示是否只执行一次。如果为true，回调后执行recover()进行回收，回收后会被再利用，默认为false 。*/
		this.once=false;
		/**@private */
		this._id=0;
		(once===void 0)&& (once=false);
		this.setTo(caller,method,args,once);
	}

	__class(Handler,'laya.utils.Handler');
	var __proto=Handler.prototype;
	/**
	*设置此对象的指定属性值。
	*@param caller 执行域(this)。
	*@param method 回调方法。
	*@param args 携带的参数。
	*@param once 是否只执行一次，如果为true，执行后执行recover()进行回收。
	*@return 返回 handler 本身。
	*/
	__proto.setTo=function(caller,method,args,once){
		this._id=Handler._gid++;
		this.caller=caller;
		this.method=method;
		this.args=args;
		this.once=once;
		return this;
	}

	/**
	*执行处理器。
	*/
	__proto.run=function(){
		if (this.method==null)return null;
		var id=this._id;
		var result=this.method.apply(this.caller,this.args);
		this._id===id && this.once && this.recover();
		return result;
	}

	/**
	*执行处理器，携带额外数据。
	*@param data 附加的回调数据，可以是单数据或者Array(作为多参)。
	*/
	__proto.runWith=function(data){
		if (this.method==null)return null;
		var id=this._id;
		if (data==null)
			var result=this.method.apply(this.caller,this.args);
		else if (!this.args && !data.unshift)result=this.method.call(this.caller,data);
		else if (this.args)result=this.method.apply(this.caller,this.args.concat(data));
		else result=this.method.apply(this.caller,data);
		this._id===id && this.once && this.recover();
		return result;
	}

	/**
	*清理对象引用。
	*/
	__proto.clear=function(){
		this.caller=null;
		this.method=null;
		this.args=null;
		return this;
	}

	/**
	*清理并回收到 Handler 对象池内。
	*/
	__proto.recover=function(){
		if (this._id > 0){
			this._id=0;
			Handler._pool.push(this.clear());
		}
	}

	Handler.create=function(caller,method,args,once){
		(once===void 0)&& (once=true);
		if (Handler._pool.length)return Handler._pool.pop().setTo(caller,method,args,once);
		return new Handler(caller,method,args,once);
	}

	Handler._pool=[];
	Handler._gid=1;
	return Handler;
})()


//class BezierMove
var BezierMove=(function(){
	function BezierMove(){
		this.updateHandler=null;
		this.sx=0;
		this.sy=0;
		this.ex=0;
		this.ey=0;
		this.lx=0;
		this.ly=0;
		this.startTime=0;
		this.endTime=0;
		this.time=0;
		//t->(0,1)stx:起始位置 kongzhiX:拉力点 endX:终点
		this.comHandler=null;
		this.po=new Point();
		this.bezierPo=new Point();
	}

	__class(BezierMove,'BezierMove');
	var __proto=BezierMove.prototype;
	/**
	*
	*@param time 毫秒
	*@param updateHandler
	*@param sx
	*@param sy
	*@param ex
	*@param ey
	*@param height 多高
	*/
	__proto.start=function(time,comHandler,updateHandler,sx,sy,ex,ey,height){
		this.comHandler=comHandler;
		this.startTime=Browser.now();
		this.time=time;
		this.ey=ey;
		this.ex=ex;
		this.sy=sy;
		this.sx=sx;
		this.lx=(sx+ex)/ 2;
		this.ly=ey-height;
		this.updateHandler=updateHandler;
		Laya.timer.frameLoop(1,this,this.move);
	}

	__proto.move=function(){
		var t=(Browser.now()-this.startTime)/this.time;
		t=Math.min(t,1);
		var po1=this.bezier(t,this.sx,this.sy,this.lx,this.ly,this.ex,this.ey);
		this.po.x=po1.x;
		this.po.y=po1.y;
		this.updateHandler.runWith(this.po);
		if(t >=1){
			Laya.timer.clear(this,this.move);
			this.comHandler.run();
		}
	}

	__proto.bezier=function(t,stx,stY,kongzhiX,kongzhiY,endX,endY){
		var tem=1-t;
		var tx=tem *tem *stx+2 *t *tem *kongzhiX+t *t *endX;
		var ty=tem *tem *stY+2 *t *tem *kongzhiY+t *t *endY;
		this.bezierPo.x=tx;
		this.bezierPo.y=ty;
		return this.bezierPo;
	}

	__proto.nextPoint=function(){
		var t=(Browser.now()+1000 / 60-this.startTime)/this.time;
		return this.bezier(t,this.sx,this.sy,this.lx,this.ly,this.ex,this.ey);
	}

	__proto.clear=function(){
		Laya.timer.clear(this,this.move);
	}

	return BezierMove;
})()


//class FaceBookManager
var FaceBookManager=(function(){
	function FaceBookManager(){}
	__class(FaceBookManager,'FaceBookManager');
	FaceBookManager.isFaceBook=function(){
		return Browser.window["FBInstant"] !=null;
	}

	FaceBookManager.FaceBook=function(){
		return Browser.window.FBInstant;
	}

	FaceBookManager.getPlatform=function(){
		if(FaceBookManager.isFaceBook()){
			return Browser.window.FBInstant.getPlatform();
		}
		return "";
	}

	FaceBookManager.getLocale=function(){
		if(FaceBookManager.isFaceBook()){
			return Browser.window.FBInstant.getLocale();
		}
		return "";
	}

	FaceBookManager.PAY_API="payments.purchaseAsync";
	FaceBookManager.ANDROID="ANDROID";
	FaceBookManager.IOS="IOS";
	FaceBookManager.WEB="WEB";
	FaceBookManager.MOBILE_WEB="MOBILE_WEB";
	return FaceBookManager;
})()


//class fight.AtkData
var AtkData=(function(){
	function AtkData(){
		this.dataType=0;
		this.heroIndex=0;
		this.disType=0;
		this.skillId=0;
		this.defArr=null;
		this.isBaoJi=0;
		this.value=0;
		this.nowHp=0;
		this.data=null;
	}

	__class(AtkData,'fight.AtkData');
	var __proto=AtkData.prototype;
	__proto.isLeft=function(){
		return this.heroIndex >=6;
	}

	AtkData.BUFF_EFFECT=0;
	AtkData.ACTION=1;
	AtkData.DATA=2;
	return AtkData;
})()


//class fight.BattleData
var BattleData=(function(){
	function BattleData(){
		this.isGuide=false;
		this.cellArr=[];
		this.nowTurn=0;
		//第几回合
		this.nowIndex=0;
		//这回合的索引
		this.nowCell=null;
		this.nowActionData=null;
		/**
		*几段战斗 协防是两段
		*/
		this.battleCount=0;
		this.isPlayBack=false;
	}

	__class(BattleData,'fight.BattleData');
	var __proto=BattleData.prototype;
	__proto.setArrayBuffer=function(ab){
		this.resetData();
		var byte=new Byte(ab);
		BattleData.ver=byte.getInt32();
		this.battleCount=byte.getInt32();
		for (var i=0;i < this.battleCount;i++){
			var cell=new BattleDataCell();
			this.cellArr.push(cell);
			cell.readInfo(byte);
		}
		for (var j=0;j < this.battleCount;j++){
			var bdcell=this.cellArr[j];
			bdcell.readContent(byte);
		}
		this.nowCell=this.cellArr[0];
		this.isPlayBack=GameUtils.GetServerTime()> this.getEndTime();
	}

	__proto.resetData=function(){
		this.nowIndex=0;
		this.nowTurn=0;
		for (var i=0;i < this.cellArr.length;i++){
			var cell=this.cellArr[i];
			cell.clear();
		}
		this.cellArr.length=0;
		this.nowActionData=null;
		this.nowCell=null;
	}

	__proto.getOneAtkArr=function(){
		this.nowTurn=TheGame.betweenArr(this.nowTurn,-1,this.nowCell.turnArr);
		if(this.nowTurn==-1){
			return null;
		};
		var turnData=this.nowCell.turnArr[this.nowTurn];
		this.nowIndex=TheGame.betweenArr(this.nowIndex,-1,turnData.attakDataArr);
		if(this.nowIndex==-1){
			this.nowIndex=0;
			this.nowTurn++;
			return this.getOneAtkArr();
		}
		this.nowActionData=turnData.attakDataArr[this.nowIndex++];
		return this.nowActionData.atkDataArr;
	}

	/**
	*检测是否还有下一场战斗
	*@return
	*/
	__proto.haveNextBattle=function(){
		return this.cellArr.indexOf(this.nowCell)!=(this.cellArr.length-1);
	}

	/**
	*改变未下一场战斗 清除数据
	*/
	__proto.changeNextBattle=function(){
		this.nowCell=this.cellArr[ this.cellArr.indexOf(this.nowCell)+1];
		this.nowTurn=0;
		this.nowIndex=0;
	}

	/**
	*@param time
	*/
	__proto.getNowTime=function(time){
		for (var p=0;p < this.cellArr.length;p++){
			var cell=this.cellArr[p];
			this.nowCell=cell;
			this.nowTurn=0;
			this.nowIndex=0;
			var arr=this.copyInitData(cell);
			for (var turnIndex=0,len=cell.turnArr.length;turnIndex < len;turnIndex++){
				var turnData=cell.turnArr[turnIndex];
				for (var attackIndex=0,len2=turnData.attakDataArr.length;attackIndex < len2;attackIndex++){
					var actionData=turnData.attakDataArr[attackIndex];
					var atkData=actionData.atkDataArr[0];
					var startIndex=((atkData.dataType==0)?0:1);
					for (var k=startIndex,len3=actionData.atkDataArr.length;k < len3;k++){
						var ad=actionData.atkDataArr[k];
						var bid=arr[ad.heroIndex];
						if(ad.disType==5){
							bid.anger=ad.value;
							}else if(ad.disType==2 || ad.disType==1 || ad.disType==11){
							bid.hp=ad.nowHp;
							}else if(ad.disType==9){
							ad.data.copy(bid);
							}else if(ad.disType==3){
							bid.addBuffer(ad.value);
							}else if(ad.disType==4){
							bid.removeBuffer(ad.value);
						}
					}
					if(time==-1){
						this.nowTurn=turnIndex;
						this.nowIndex=attackIndex+1;
						this.nowActionData=actionData;
						}else{
						if(actionData.time > time){
							this.nowTurn=turnIndex;
							this.nowIndex=attackIndex+1;
							this.nowActionData=actionData;
							return this.clearHp0(arr);
						}
					}
				}
			}
		}
		if(time==-1){
			return this.clearHp0(arr);
		}
		this.nowCell=this.cellArr[0];
		return this.nowCell.initDataArr;
	}

	/**
	*把所有hp为0的去掉
	*/
	__proto.clearHp0=function(arr){
		var len=arr.length;
		for (var i=0;i < len;i++){
			var data=arr[i];
			if(data){
				if(data.hp==0){
					arr[i]=null;
				}
			}
		}
		return arr;
	}

	/**
	*赋值初始化数据 好用来计算特定时间 hp
	*/
	__proto.copyInitData=function(cell){
		var arr=[];
		for (var i=-1;i < cell.initDataArr.length;i++){
			if(cell.initDataArr[i]==null){
				continue ;
			};
			var data=cell.initDataArr [i];
			arr[data.index]=data.copy();
		}
		return arr;
	}

	__proto.getSkillArr=function(cell){
		var arr=[];
		for (var i=0;i < cell.turnArr.length;i++){
			var turnData=cell.turnArr[i];
			for (var j=0,len2=turnData.attakDataArr.length;j < len2;j++){
				var attackData=turnData.attakDataArr[j];
				var atkData=attackData.atkDataArr[0];
				if(atkData.skillId > 0){
					arr.push(atkData.skillId);
				}
			}
		}
		return arr;
	}

	__proto.getEndTime=function(){
		var time=0;
		for (var i=0;i < this.cellArr.length;i++){
			var cell=this.cellArr [i];
			time=cell.endTime;
		}
		return time;
	}

	BattleData.getTime=function(type){
		if(BattleData.timeMap[type]==null){
			var sys=ConfigManager.getConfig("sys_timetake.txt",type);
			BattleData.timeMap[type]=sys.timeCd;
		}
		return BattleData.timeMap[type];
	}

	BattleData.ver=0;
	BattleData.DIS_TYPE_ADD_HP=1;
	BattleData.DIS_TYPE_DAMAGE=2;
	BattleData.ADD_BUFF=3;
	BattleData.REMOVE_BUFF=4;
	BattleData.DIS_TYPE_ANGER=5;
	BattleData.DIS_TYPE_SHANBI=6;
	BattleData.DIS_TYPE_SHIPO=7;
	BattleData.DIS_TYPE_BU_QU=8;
	BattleData.DIS_TYPE_CHANGE_HERO=9;
	BattleData.DIS_TYPE_JUE_XING=10;
	BattleData.DIS_TYPE_FAN_TAN=11;
	BattleData.BUFF_FLASH=12;
	BattleData.DIS_TYPE_LIAN_JI=13;
	BattleData.timeMap=[];
	return BattleData;
})()


//class fight.BattleDataCell
var BattleDataCell=(function(){
	function BattleDataCell(){
		this.atkName=null;
		this.atkStatArr=[];
		this.defName=null;
		this.defStatArr=[];
		this.haveWallSoldiers=0;
		this.citiId=0;
		this.startTime=0;
		this.endTime=0;
		this.atkMaxHp=0;
		this.atkDamageHp=0;
		this.defMaxHp=0;
		this.defDamageHp=0;
		this.heroNum=0;
		this.initDataArr=[];
		this.turnNum=0;
		this.turnArr=[];
		this.replaceHeroArr=[];
	}

	__class(BattleDataCell,'fight.BattleDataCell');
	var __proto=BattleDataCell.prototype;
	__proto.clear=function(){
		this.atkStatArr.length=0;
		this.defStatArr.length=0;
		this.initDataArr.length=0;
		this.turnArr.length=0;
		this.replaceHeroArr.length=0;
	}

	__proto.readInfo=function(byte){
		var dataLen=byte.getInt32();
		this.atkName=byte.getUTFString();
		this.atkStatArr=this.getBattleStat(byte);
		this.defName=byte.getUTFString();
		this.defStatArr=this.getBattleStat(byte);
	}

	__proto.readContent=function(byte){
		var dataLen=byte.getInt32();
		this.haveWallSoldiers=byte.getByte();
		this.citiId=byte.getInt32();
		this.startTime=byte.getInt32();
		this.endTime=byte.getInt32();
		this.atkName=byte.getUTFString();
		this.atkMaxHp=byte.getInt32();
		this.atkDamageHp=byte.getInt32();
		this.defName=byte.getUTFString();
		this.defMaxHp=byte.getInt32();
		this.defDamageHp=byte.getInt32();
		this.heroNum=byte.getByte();
		var allHp=0;
		for (var i=0;i < this.heroNum;i++){
			var battleInitData=new BattleInitData();
			battleInitData.read(byte);
			this.initDataArr[battleInitData.index]=battleInitData;
			if(battleInitData.index < 6){
				allHp+=battleInitData.hp;
			}
		};
		var bid=new BattleInitData();
		bid.maxHp=bid.hp=this.defMaxHp-allHp;
		bid.index=-1;
		this.initDataArr[-1]=bid;
		this.turnNum=byte.getInt32();
		var atkHpTemp=this.atkMaxHp;
		var defHpTemp=this.defMaxHp;
		var allTime=0;
		for (var j=0;j < this.turnNum;j++){
			var turnData=new TurnData();
			turnData.nowTurn=j;
			this.turnArr.push(turnData);
			var actionData=new FightActionData();
			var num=byte.getInt32();
			var lastType=-1;
			for (var k=0;k < num;k++){
				var atkData=new AtkData();
				atkData.dataType=byte.getByte();
				atkData.heroIndex=byte.getByte();
				atkData.disType=byte.getByte();
				if((lastType !=0 && atkData.dataType==0)|| atkData.dataType==1){
					actionData.atkHp=atkHpTemp;
					actionData.defHp=defHpTemp;
					actionData=new FightActionData();
					turnData.attakDataArr.push(actionData);
				}
				lastType=atkData.dataType;
				actionData.atkDataArr.push(atkData);
				var disType=atkData.disType;
				if(disType==0 || disType==10){
					atkData.skillId=byte.getInt32();
					var attackNum=byte.getByte();
					var arr=[];
					for (var i2=0;i2 < attackNum;i2++){
						var defIndex=byte.getByte();
						arr.push(defIndex);
					}
					atkData.defArr=arr;
					}else if(disType==1){
					atkData.value=byte.getInt32();
					atkData.nowHp=byte.getInt32();
					if(atkData.isLeft()){
						atkHpTemp+=atkData.value;
						}else{
						defHpTemp+=atkData.value;
					}
					}else if(disType==2 || disType==11){
					atkData.isBaoJi=byte.getByte();
					atkData.value=byte.getInt32();
					atkData.nowHp=byte.getInt32();
					if(atkData.isLeft()){
						atkHpTemp-=atkData.value;
						}else{
						defHpTemp-=atkData.value;
					}
					}else if(disType==3 || disType==12){
					atkData.value=byte.getInt32();
					}else if(disType==4){
					atkData.value=byte.getInt32();
					}else if(disType==5){
					atkData.value=byte.getByte();
					}else if(disType==6){
					}else if(disType==7){
					}else if(disType==8){
					}else if(disType==9){
					var data=new BattleInitData();
					data.read2(byte);
					data.index=atkData.heroIndex;
					atkData.data=data;
					this.replaceHeroArr.push(data);
				}
				if(k==(num-1)){
					actionData.atkHp=atkHpTemp;
					actionData.defHp=defHpTemp;
				}
				if(actionData.atkDataArr.length==1){
					if(atkData.dataType==1){
						if(atkData.skillId > 0){
							allTime+=BattleData.getTime(12);
							}else{
							allTime+=BattleData.getTime(11);
						}
						}else if(atkData.dataType==0){
						allTime+=BattleData.getTime(13);
					}
					actionData.time=allTime;
				}
			}
		}
	}

	__proto.getBattleStat=function(byte){
		var heroNum=byte.getInt32();
		var arr=[];
		for (var i=0;i < heroNum;i++){
			var battleStatData=new BattleStatData();
			battleStatData.read(byte);
			arr.push(battleStatData);
		}
		return arr;
	}

	return BattleDataCell;
})()


//class fight.BattleHeroData
var BattleHeroData=(function(){
	function BattleHeroData(){
		this.hp=0;
		this.lv=0;
		this.heroId=0;
		this.maxHp=0;
		this.nowHp=0;
		this.cure=0;
		this.damage=0;
		this.kill=0;
	}

	__class(BattleHeroData,'fight.BattleHeroData');
	return BattleHeroData;
})()


//class fight.BattleInitData
var BattleInitData=(function(){
	function BattleInitData(){
		this.index=0;
		this.heroId=0;
		this.heroLv=0;
		/**兵种 */
		this.type=0;
		this.hp=0;
		this.anger=0;
		this.maxHp=0;
		this.bufferIdArr=[];
	}

	__class(BattleInitData,'fight.BattleInitData');
	var __proto=BattleInitData.prototype;
	__proto.addBuffer=function(id){
		this.bufferIdArr.push(id);
	}

	__proto.removeBuffer=function(id){
		for (var i=0;i < this.bufferIdArr.length;i++){
			if(this.bufferIdArr[i]==id){
				this.bufferIdArr.splice(i,1);
				return;
			}
		}
	}

	__proto.read=function(byte){
		this.index=byte.getByte();
		this.read2(byte);
	}

	__proto.read2=function(byte){
		this.heroId=byte.getInt32();
		this.heroLv=byte.getInt32();
		this.type=byte.getInt32();
		this.hp=byte.getInt32();
		this.anger=byte.getByte();
		if(BattleData.ver==2){
			this.maxHp=byte.getInt32();
			}else if(BattleData.ver==1){
			this.maxHp=this.hp;
		}
	}

	__proto.copy=function(data){
		if(data==null){
			data=new BattleInitData();
		}
		data.index=this.index;
		data.heroId=this.heroId;
		data.heroLv=this.heroLv;
		data.type=this.type;
		data.hp=this.hp;
		data.anger=this.anger;
		data.maxHp=this.maxHp;
		return data;
	}

	return BattleInitData;
})()


//class fight.BattleStatData
var BattleStatData=(function(){
	function BattleStatData(){
		this.heroId=0;
		this.lv=0;
		this.maxHp=0;
		this.nowHp=0;
		this.kill=0;
		this.damage=0;
		this.cure=0;
	}

	__class(BattleStatData,'fight.BattleStatData');
	var __proto=BattleStatData.prototype;
	__proto.read=function(byte){
		this.heroId=byte.getInt32();
		this.lv=byte.getInt32();
		this.maxHp=byte.getInt32();
		this.nowHp=byte.getInt32();
		this.kill=byte.getInt32();
		this.damage=byte.getInt32();
		this.cure=byte.getInt32();
	}

	return BattleStatData;
})()


/**
*弩的移动
*@author chengxu03
*/
//class fight.CrossbowMove
var CrossbowMove=(function(){
	function CrossbowMove(){
		this.updateHandler=null;
		this.sX=0;
		this.sY=0;
		this.eX=0;
		this.eY=0;
		this.overHandler=null;
		this.startTime=NaN;
		this.endTime=NaN;
		this.allTime=0;
		this.speedX=0;
		this.speedY=0;
		this.tempPoint=new Point();
	}

	__class(CrossbowMove,'fight.CrossbowMove');
	var __proto=CrossbowMove.prototype;
	__proto.setAll=function(updateHandler,overHandler,allTime,sX,sY,eX,eY){
		this.allTime=allTime;
		this.eY=eY;
		this.eX=eX;
		this.sY=sY;
		this.sX=sX;
		this.updateHandler=updateHandler;
		this.overHandler=overHandler;
		this.startTime=Browser.now();
		this.speedX=(eX-sX)/ allTime;
		this.speedY=(eY-sY)/ allTime;
		this.endTime=this.startTime+allTime;
		Laya.timer.frameLoop(1,this,this.efFun);
	}

	__proto.efFun=function(){
		var time=(Browser.now()-this.startTime)*ScaleManager.nowSpeedScale;
		if(time >=this.allTime){
			Laya.timer.clear(this,this.efFun);
			this.tempPoint.setTo(this.eX,this.eY);
			this.updateHandler.runWith(this.tempPoint);
			this.overHandler.run();
			return;
		}
		this.getPoByTime(time);
		this.updateHandler.runWith(this.tempPoint);
	}

	__proto.getPoByTime=function(time){
		this.tempPoint.x=this.sX+time *this.speedX;
		this.tempPoint.y=this.sY+time *this.speedY;
		return this.tempPoint;
	}

	__proto.nextPoint=function(){
		var rate=(Laya.stage.frameRate=="fast")? 60 :30;
		var t=(Browser.now()+1000 / rate-this.startTime)*ScaleManager.nowSpeedScale;
		return this.getPoByTime(t);
	}

	return CrossbowMove;
})()


/**
*一次完整的攻击
*比如普攻 技能 数组是造成的一连串效果
*/
//class fight.FightActionData
var FightActionData=(function(){
	function FightActionData(){
		/**
		*一次攻击后 所剩的hp 和 经过的时间
		*/
		this.atkHp=0;
		this.defHp=0;
		this.atkDataArr=[];
		this.time=0;
	}

	__class(FightActionData,'fight.FightActionData');
	return FightActionData;
})()


//class fight.GroupSkill
var GroupSkill=(function(){
	function GroupSkill(){
		this.tip=null;
		this.btn=null;
		this.start=0;
		this.end=0;
		this.heroArr=null;
		this.map=null;
		this.haveMap={};
		this.tempDiv=new HTMLDivElement();
	}

	__class(GroupSkill,'fight.GroupSkill');
	var __proto=GroupSkill.prototype;
	__proto.setAll=function(tip,btn,heroArr,start,end){
		this.end=end;
		this.start=start;
		this.btn=btn;
		this.tip=tip;
		this.heroArr=heroArr;
		tip.visible=false;
		btn.clickHandler=new Handler(this,this.disFun);
	}

	__proto.disFun=function(type){
		this.tip.visible=true;
		this.reset();
		Laya.stage.off("click",this,this.stageClickFun);
		Laya.timer.callLater(this,this.laterFun);
	}

	__proto.laterFun=function(type){
		Laya.stage.once("click",this,this.stageClickFun);
	}

	__proto.stageClickFun=function(){
		this.tip.visible=false;
	}

	/**
	*重新检测
	*/
	__proto.reset=function(){
		this.map={};
		this.haveMap={};
		for (var i=this.start;i <=this.end;i++){
			var hero=this.heroArr[i];
			if(hero && hero.nowHp !=0){
				this.map[hero.data.heroId]=1;
			}
		};
		var str="";
		for(var heroId=0 in this.map){
			str+=this.checkHero(heroId);
		}
		if(this.tip.visible){
			this.tempDiv.width=1000;
			this.tempDiv.height=1000;
			this.tempDiv.innerHTML=str;
			this.tip.di1.size(this.tempDiv.contextWidth+40,this.tempDiv.contextHeight+35);
			this.tip.di0.size(this.tempDiv.contextWidth+40,this.tempDiv.contextHeight+35);
			this.tip.html0.size(this.tempDiv.contextWidth,this.tempDiv.contextHeight);
			this.tip.html0.innerHTML=str;
			var localToGlobal=this.tip.localToGlobal(new Point());
			if((this.tip.di1.width+localToGlobal.x)> Laya.stage.width){
				this.tip.x=Laya.stage.width-this.tip.di1.width;
				var point=new Point(Laya.stage.width-this.tip.di1.width ,0);
				var p=(this.tip.parent).globalToLocal(point);
				this.tip.x=p.x;
			}
		}
		this.btn.visible=(str !="");
	}

	/**
	*一个英雄有多个组合技
	*@param heroId
	*/
	__proto.checkHero=function(heroId){
		var str="";
		var sysHero=ConfigManager.getConfig("sys_hero.txt",heroId);
		for (var i=0;i < sysHero.mixSkillArr.length;i++){
			var mixId=sysHero.mixSkillArr[i];
			var sys=this.checkMixSkill(mixId);
			if(sys){
				if(this.haveMap[sys.mixSkillId]==null){
					var text=this.getText(sys);
					str+=text;
					str+="<br>";
					this.haveMap[sys.mixSkillId]=1;
				}
			}
		}
		return str;
	}

	__proto.getText=function(sys){
		var str=this.getHtml(sys.mixSkillName+" : ","#e3a915");
		for (var i=0,len=sys.mixHeroArr.length;i < len;i++){
			var heroId=sys.mixHeroArr[i];
			var sysHero=ConfigManager.getConfig("sys_hero.txt",heroId);
			str+=(this.getHtml(sysHero.heroName+((i==(len-1))?"":","),"#efe1bd"));
		};
		var str2="同时上场,"+SysTalent.getName(sys.property)+"+"+SysTalent.getValue(sys.property,sys.add);
		str+=this.getHtml(str2,"#efe1bd");
		return str;
	}

	__proto.getHtml=function(str,color){
		return TheGame.FONT(str,color,20,"微软雅黑");
	}

	/**
	*检查单个组合技
	*@param mixId
	*@return
	*/
	__proto.checkMixSkill=function(mixId){
		var sysSkillMix=ConfigManager.getConfig("sys_skill_mix.txt",mixId);
		var mixHeroArr=sysSkillMix.mixHeroArr;
		for (var i=0;i < mixHeroArr.length;i++){
			var mixHeroId=mixHeroArr[i];
			if(this.map[mixHeroId]==null){
				return null;
			}
		}
		return sysSkillMix;
	}

	return GroupSkill;
})()


/**
*控制全局tween 和 time的缩放
*/
//class fight.ScaleManager
var ScaleManager=(function(){
	function ScaleManager(){
		this.tweenMap={};
	}

	__class(ScaleManager,'fight.ScaleManager');
	var __proto=ScaleManager.prototype;
	__proto.setNowSpeedScale=function(nowSpeedScale){
		fight.ScaleManager.nowSpeedScale=nowSpeedScale;
	}

	__proto.getTime=function(time){
		return time/ScaleManager.nowSpeedScale;
	}

	/**
	*总管一切延迟方法 方便清理
	*@param delay
	*@param caller
	*@param method
	*@param args
	*/
	__proto.addTimer=function(delay,caller,method,args){
		Laya.timer.once(this.getTime(delay),this,this.timerFun,[caller,method,args],false);
	}

	//Browser.window.setTimeout(timerFun,getTime(delay),caller,method,args);
	__proto.timerFun=function(caller,method,args){
		args ? method.apply(caller,args):method.call(caller);
	}

	__proto.clearAllTimer=function(){
		Laya.timer.clearAll(this);
	}

	__proto.tween=function(target,props,duration,ease,complete,delay){
		(delay===void 0)&& (delay=0);
		var tween=new Tween();
		var key=Math.random()+"";
		tween.to(target,props,this.getTime(duration),ease,new Handler(this,this.tweenOver,[key,complete]),delay);
		this.tweenMap[key]=tween;
	}

	__proto.tweenOver=function(key,complete){
		this.tweenMap[key]=null;
		delete this.tweenMap[key];
		if(complete){
			complete.run();
		}
	}

	__proto.clearAllTween=function(){
		var tween;
		for(var $each_tween in this.tweenMap){
			tween=this.tweenMap[$each_tween];
			tween.clear();
		}
		this.tweenMap={};
	}

	ScaleManager.nowSpeedScale=1;
	return ScaleManager;
})()


//class fight.ShootIMG
var ShootIMG=(function(){
	function ShootIMG(){
		this.layer=null;
		this.one=null;
		this.def=null;
		//弩车
		this.shootSp=null;
		//private var stoneSp:Clip=null;
		this.shootType=0;
		this.g=1500;
		this.ballisticSp=null;
		this.upindex=0;
		this.atk=null;
		this.shootMove=new ShootMove();
		this.crossbowMove=new CrossbowMove();
		this.targetPo=new Point();
		this.shootSp=new Sprite();
		this.ballisticSp=new Sprite();
	}

	__class(ShootIMG,'fight.ShootIMG');
	var __proto=ShootIMG.prototype;
	__proto.setShootDpo=function(type){
		this.shootType=type;
		this.shootSp.removeChildren();
		var cl=ClassUtils.getRegClass("jian"+type);
		var view=new cl();
		this.shootSp.addChild(view);
	}

	__proto.flyFun=function(){
		this.layer.addChild(this.ballisticSp);
		this.ballisticSp.addChild(this.shootSp);
		this.shootSp.zOrder=1000;
		var atkX=this.atk.x+this.one.x;
		var atkY=this.atk.y+this.one.y;
		if(this.shootType==4){
			atkY-=45;
			atkX+=20;
		}
		this.shootSp.pos(atkX,atkY);
		this.updateFun(new Point(atkX,atkY));
		var dpo=this.def.getDpo();
		var rect;
		if((dpo instanceof fight.BattleHeroDpo )){
			rect=new Rectangle();
			var sp=(dpo).heroModel.disUI;
			if(sp){
				rect.width=sp.width;
				rect.height=sp.height;
			}
			}else{
			rect=dpo.getBounds();
		};
		var xx=(rect.width/2-50)+Math.random()*50 *2;
		var yy=(rect.height/2-80)+Math.random()*40 *2;
		var defX=dpo.x+xx;
		var defY=dpo.y+yy;
		if(this.shootType==4){
			if((dpo instanceof fight.BattleHeroDpo )){
				defX=dpo.x+this.one.x;
				defY=dpo.y+this.one.y;
				}else{
				defX=dpo.x;
				defY=dpo.y;
			}
		}
		this.upindex=0;
		if(this.shootType==5 || this.shootType==9){
			this.crossbowMove.setAll(new Handler(this,this.updateFun),new Handler(this,this.comFun),200,atkX,atkY,defX,defY);
			}else{
			var speed=Math.abs(atkX-defX)/0.8;
			this.shootMove.setAll(new Handler(this,this.updateFun),new Handler(this,this.comFun),speed,this.g,atkX,atkY,defX,defY);
		}
	}

	/**
	*击中敌人
	*/
	__proto.comFun=function(){
		this.shootSp.removeSelf();
		Laya.timer.frameLoop(1,this,this.loopCheckFun);
	}

	/**
	*每帧检测 尾巴的烟是否都消失
	*/
	__proto.loopCheckFun=function(){
		if(this.ballisticSp.numChildren > 0){
			return;
		}
		Laya.timer.clear(this,this.loopCheckFun);
		this.ballisticSp.removeSelf();
		Pool.recover("ShootIMG",this);
	}

	__proto.updateFun=function(po){
		this.shootSp.pos(po.x,po.y);
		var xx=po.x;
		var yy=po.y;
		if(this.shootType==5 || this.shootType==9){
			var np1=this.crossbowMove.nextPoint();
			this.shootSp.rotation=180 / Math.PI *(Math.atan2(np1.y-yy,np1.x-xx));
			}else if(this.shootType==4){
			var np=this.shootMove.nextPoint();
			this.shootSp.rotation=180 / Math.PI *(Math.atan2(np.y-yy,np.x-xx));
			this.upindex++;
			if(this.upindex % 2==0){
				var stoneSmoke=new StoneSmoke();
				this.ballisticSp.addChild(stoneSmoke);
				stoneSmoke.x=this.shootSp.x;
				stoneSmoke.y=this.shootSp.y;
				stoneSmoke.blendMode="lighter";
			}
			}else{
			var np2=this.shootMove.nextPoint();
			this.shootSp.rotation=180 / Math.PI *(Math.atan2(np2.y-yy,np2.x-xx));
		}
	}

	__proto.start=function(one,atk,def,layer){
		this.atk=atk;
		this.def=def;
		this.one=one;
		this.layer=layer;
		BattleFileScene.instance.scaleManager.addTimer(300 ,this,this.flyFun);
	}

	ShootIMG.getNew=function(){
		return Pool.getItemByClass("ShootIMG",ShootIMG);
	}

	ShootIMG.ARROW=2;
	ShootIMG.CESHI=3;
	ShootIMG.STONE=4;
	ShootIMG.QINGNU=5;
	ShootIMG.HUOJIAN=6;
	ShootIMG.BIAOQIANG=7;
	ShootIMG.CHANGGONGJIAN=8;
	ShootIMG.ZHONGNU=9;
	ShootIMG.NUCHE=10;
	ShootIMG.WID=50;
	ShootIMG.SIGN="ShootIMG";
	return ShootIMG;
})()


//class fight.ShootMove
var ShootMove=(function(){
	function ShootMove(){
		this.speedX=0;
		this.speedY=0;
		this.g=0;
		this.allTime=0;
		this.startTime=0;
		this.updateHandler=null;
		this.sX=0;
		this.sY=0;
		this.overHandler=null;
		this.eX=0;
		this.eY=0;
		this.tempPoint=new Point();
	}

	__class(ShootMove,'fight.ShootMove');
	var __proto=ShootMove.prototype;
	__proto.setAll=function(updateHandler,overHandler,speedX,g,sX,sY,eX,eY){
		this.eY=eY;
		this.eX=eX;
		this.overHandler=overHandler;
		this.sY=sY;
		this.sX=sX;
		this.updateHandler=updateHandler;
		this.g=g;
		this.speedX=speedX;
		if(eX < sX){
			this.speedX=-this.speedX;
		};
		var xDistance=Math.abs(eX-sX);
		this.allTime=Math.abs(xDistance/speedX);
		this.speedY=(sY-eY+g *this.allTime *this.allTime / 2)/this.allTime;
		this.startTime=Browser.now();
		Laya.timer.frameLoop(1,this,this.efFun);
		this.tempPoint.setTo(sX,sY);
		this.updateHandler.runWith(this.tempPoint);
	}

	__proto.efFun=function(){
		var time=(Browser.now()-this.startTime)/1000 *ScaleManager.nowSpeedScale;
		if(time >=this.allTime){
			Laya.timer.clear(this,this.efFun);
			this.tempPoint.setTo(this.eX,this.eY);
			this.updateHandler.runWith(this.tempPoint);
			this.overHandler.run();
			return;
		}
		this.getPoByTime(time);
		this.updateHandler.runWith(this.tempPoint);
	}

	__proto.getPoByTime=function(time){
		this.tempPoint.x=this.sX+time *this.speedX;
		this.tempPoint.y=this.sY-(this.speedY *time-this.g *time *time / 2);
		return this.tempPoint;
	}

	__proto.nextPoint=function(){
		var rate=(Laya.stage.frameRate=="fast")? 60 :30;
		var t=(Browser.now()+1000 / rate-this.startTime)/1000;
		t=t *ScaleManager.nowSpeedScale;
		return this.getPoByTime(t);
	}

	return ShootMove;
})()


//class fight.TurnData
var TurnData=(function(){
	function TurnData(){
		this.nowTurn=0;
		this.attakDataArr=[];
	}

	__class(TurnData,'fight.TurnData');
	return TurnData;
})()


//class game.App
var App=(function(){
	/**
	*默认会对action session command全部进行注册
	*/
	function App(){}
	__class(App,'game.App');
	App.isTest=function(){
		return App.configJson["test"]==1;
	}

	App.isApp=function(){
		return Render.isConchApp;
	}

	App.INIT=function(initClass){
		var gameInit=new initClass();
		gameInit.initAction();
		gameInit.initSession();
		game.App.initInjection();
		gameInit.initCommand();
		gameInit.initDialog();
		gameInit.initDoublePanel();
		gameInit.initScence();
		gameInit.initGameLoader();
		gameInit.initConfig();
		gameInit.initPng();
	}

	App.MyInit=function(initClass){
		var cmdArr=[];
		cmdArr.push(LoadConfigTxtCMD);
		if(initClass){
			cmdArr.push([InitAllRegCMD,initClass]);
		}
		cmdArr.push(LoadUIJsonCMD);
		cmdArr.push(LoadConfigZipCMD);
		game.App.commandManager.exeOrderCMD(cmdArr);
	}

	App.DevelopmentSettings=function(designWid,designHei,screenMode){
		game.App.designHei=designHei;
		game.App.designWid=designWid;
		var sc=NaN;
		if(screenMode=="vertical"){
			sc=Browser.width/designWid;
			Laya.init(designWid,Browser.height/sc ,WebGL);
			Laya.stage.screenMode=screenMode;
			Laya.stage.scaleMode="fixedwidth";
			}else{
			var designScale=designWid / designHei;
			var browserScale=Browser.height/Browser.width;
			if(designScale > browserScale){
				sc=Browser.height/designWid;
				Laya.init(designWid ,designHei ,WebGL);
				Laya.stage.scaleMode="showall";
				}else{
				sc=Browser.width/designHei;
				Laya.init(0,designHei,WebGL);
				Laya.stage.scaleMode="fixedheight";
			}
			Laya.stage.screenMode=screenMode;
		}
		Laya.stage.alignH="center";
		Laya.stage.alignV="middle";
		Laya.stage.bgColor="#000000";
		AtlasResourceManager.atlasLimitHeight=64;
		AtlasResourceManager.atlasLimitWidth=64;
	}

	App.setDevelopMode=function(){
		Laya.stage.size(App.designWid,App.designHei);
		Laya.stage.scaleMode="noscale";
	}

	App.errorFun=function(msg,url,line,column,detail){
		if(App.errorUrl==null){
			return;
		};
		var json={};
		json.msg=msg;
		json.line=line;
		json.column=column;
		json.detail=detail;
		var http=new HttpRequest();
		http.send(App.errorUrl+"error=111",null ,"get",'text',["Content-Type","text/html"]);
	}

	App.SetErrorCollectionUrl=function(errorUrl){
		game.App.errorUrl=errorUrl;
	}

	App.regCMD=function(command,commandClass){
		App.CMDMap[command]=commandClass;
	}

	App.exeCMD=function(commandClass,data){
		var cmd=new commandClass();
		App.injOne(cmd);
		cmd.execute(data);
		cmd=null;
		commandClass=null;
	}

	App.sendCMD=function(cmd,data){
		App.exeCMD(App.CMDMap[cmd],data);
	}

	App.regAction=function(actionId,actionClass){
		var action=new actionClass();
		action.setActionId(actionId);
		App.actionMap[actionId]=action;
		App.regInjection(App.getInjectionName(action),action);
	}

	App.getAction=function(actionId){
		if(App.actionMap[actionId]==null){
			console.log("当前action未注册  actionId = "+actionId);
		}
		return App.actionMap[actionId];
	}

	App.regSession=function(sessionClass){
		var session=new sessionClass();
		App.regInjection(App.getInjectionName(session),session);
	}

	App.getInjectionName=function(instance){
		var str=App.getInstanceClassName(instance);
		return StringTool.toLowHead(str);
	}

	App.getInstanceClassName=function(instance){
		return ClassTool.getClassName(instance);
	}

	App.getSession=function(key){
		return App.injMap[key];
	}

	App.regInjection=function(str,obj){
		App.injMap[str]=obj;
	}

	App.initInjection=function(){
		for (var attribute in App.injMap){
			App.injOne(App.injMap[attribute]);
		}
	}

	App.injOne=function(obj){
		if(App.CHECK_VIEW_INJECTION){
			var panelData;
			for(var $each_panelData in OpenDialogManager.dialogMap){
				panelData=OpenDialogManager.dialogMap[$each_panelData];
				if(panelData.mediatorClass && Laya.__typeof(obj,panelData.panelClass)){
					alert("有mediator的面板不允许在view里注入");
					return;
				}
			}
		}
		for (var str in obj){
			if(obj[str]==null && App.injMap[str]){
				obj[str]=App.injMap[str];
			}
		}
	}

	App.loadZip=function(zipName,callBackFun,type){
		(type===void 0)&& (type="string");
		Browser.window.loadZip(zipName,callBackFun,type);
	}

	App.getServerTime=function(){
		return 0;
	}

	App.getLong=function(byte){
		return byte.getInt32()*10000000+byte.getInt32();
	}

	App.setCloseDialogOnSide=function(value){
		if(value){
			Dialog.manager.maskLayer.on("click",Dialog.manager,Dialog.manager["_closeOnSide"]);
			}else{
			Dialog.manager.maskLayer.offAll("click");
		}
	}

	App.reload=function(){
		Browser.window.location.reload();
	}

	App.VER=null;
	App.configJson=null;
	App.designWid=0;
	App.designHei=0;
	App.errorUrl=null;
	App.CMDMap={};
	App.actionMap={};
	App.injMap={};
	App.CHECK_VIEW_INJECTION=true;
	__static(App,
	['eventManager',function(){return this.eventManager=new EventDispatcher();},'socketManager',function(){return this.socketManager=new SocketManager();},'dialogManager',function(){return this.dialogManager=new OpenDialogManager();},'loaderManager',function(){return this.loaderManager=new GameLoaderManager();},'commandManager',function(){return this.commandManager=new CommandManager();},'sceneManager',function(){return this.sceneManager=new SceneManager();},'layerManager',function(){return this.layerManager=new LayerManager();},'configManager',function(){return this.configManager=new ConfigManager();},'dragonBonesManager',function(){return this.dragonBonesManager=new DragonBonesManager();},'pngManager',function(){return this.pngManager=new PngManager();},'voiceManager',function(){return this.voiceManager=new VoiceManager();},'BLACK_BORDER',function(){return this.BLACK_BORDER=new ColorFilter([0,1,2,2,10,1]);}
	]);
	return App;
})()


//class game.base.AutoEvent
var AutoEvent=(function(){
	function AutoEvent(sprite){
		this.arr=[];
		this.sprite=null;
		if(sprite==null){
			return;
		}
		this.sprite=sprite;
		sprite.on("display",this,this.disFun);
		sprite.on("undisplay",this,this.undisFun);
	}

	__class(AutoEvent,'game.base.AutoEvent');
	var __proto=AutoEvent.prototype;
	__proto.undisFun=function(){
		this.removeAllEvent();
	}

	/**
	*移除所有事件
	*/
	__proto.removeAllEvent=function(){
		for (var i=0;i < this.arr.length;i+=3){
			App.eventManager.off(this.arr[i],this.arr[i+1],this.arr[i+2]);
		}
	}

	__proto.disFun=function(){
		for (var i=0;i < this.arr.length;i+=3){
			App.eventManager.on(this.arr[i],this.arr[i+1],this.arr[i+2]);
		}
	}

	/**
	*立即注册事件
	*/
	__proto.addEventNow=function(){
		this.disFun();
	}

	/**
	*事件不会立即注册 而是DISPLAY事件后注册
	*@param type
	*@param caller
	*@param listener
	*
	*/
	__proto.add=function(type,caller,listener){
		this.arr.push(type,caller,listener);
	}

	return AutoEvent;
})()


/**
*在某些手机上 比如三星 点击list里的item 很不容易触发click
*因为在上面点一下 位移太多 会触发mouse_move 导致无法click
*这个类是用来解决这个问题的
*@author chengxu03
*/
//class game.base.display.ListItemEvent
var ListItemEvent=(function(){
	function ListItemEvent(sp){
		this.distance=50;
		this.sp=null;
		this.isClick=true;
		this.p=new Point();
		this.sp=sp;
		sp.on("mousedown",this,this.downFun);
	}

	__class(ListItemEvent,'game.base.display.ListItemEvent');
	var __proto=ListItemEvent.prototype;
	__proto.upFun=function(e){
		if(this.sp.hitTestPoint(this.sp.stage.mouseX,this.sp.stage.mouseY)&& this.isClick){
			this.sp.event("SELECT_LIST",this.sp);
		}
		this.clearFun();
	}

	__proto.downFun=function(){
		this.isClick=true;
		this.sp.stage.once("mouseup",this,this.upFun);
		this.sp.stage.once("mouseout",this,this.clearFun);
		this.p.setTo(this.sp.stage.mouseX,this.sp.stage.mouseY);
		Laya.timer.clear(this,this.efCheckFun);
		Laya.timer.frameLoop(1,this,this.efCheckFun);
	}

	__proto.clearFun=function(){
		this.sp.stage.off("mouseup",this,this.upFun);
		this.sp.stage.off("mouseout",this,this.clearFun);
		Laya.timer.clear(this,this.efCheckFun);
	}

	__proto.efCheckFun=function(){
		if(this.p.distance(this.sp.stage.mouseX,this.sp.stage.mouseY)> this.distance){
			this.isClick=false;
			this.clearFun();
		}
	}

	ListItemEvent.SELECT_LIST="SELECT_LIST";
	return ListItemEvent;
})()


//class game.base.display.ScrollRectProgressBar
var ScrollRectProgressBar=(function(){
	function ScrollRectProgressBar(img){
		this.maxWid=0;
		this.img=null;
		this.rect=new Rectangle();
		this.img=img;
		this.maxWid=img.width;
		this.rect.height=img.height;
	}

	__class(ScrollRectProgressBar,'game.base.display.ScrollRectProgressBar');
	var __proto=ScrollRectProgressBar.prototype;
	__proto.setValue=function(value){
		this.rect.width=this.maxWid *value;
		this.img.scrollRect=this.rect;
	}

	return ScrollRectProgressBar;
})()


//class game.base.entity.ConfigData
var ConfigData=(function(){
	function ConfigData(){
		this.analysisFun=null;
		this.configClass=null;
		this.mapKey=null;
		//希望哪个属性当key
		this.keyFun=null;
	}

	__class(ConfigData,'game.base.entity.ConfigData');
	return ConfigData;
})()


//class game.base.entity.DialogResData
var DialogResData=(function(){
	function DialogResData(){
		this.time=0;
		this.classArr=[];
	}

	__class(DialogResData,'game.base.entity.DialogResData');
	var __proto=DialogResData.prototype;
	__proto.addClass=function(panelClass){
		for (var i=0;i < this.classArr.length;i++){
			if(this.classArr[i]==panelClass){
				return;
			}
		}
		this.classArr.push(panelClass);
	}

	return DialogResData;
})()


//class game.base.entity.OpenPanelData
var OpenPanelData=(function(){
	function OpenPanelData(panelString,data,autoClose,haveBlackMask){
		this.autoCLose=true;
		this.panelString=null;
		this.data=null;
		this.haveBlackMask=false;
		(autoClose===void 0)&& (autoClose=true);
		(haveBlackMask===void 0)&& (haveBlackMask=false);
		this.panelString=panelString;
		this.data=data;
		this.autoCLose=autoClose;
		this.haveBlackMask=haveBlackMask;
	}

	__class(OpenPanelData,'game.base.entity.OpenPanelData');
	return OpenPanelData;
})()


//class game.base.entity.PanelData
var PanelData=(function(){
	function PanelData(){
		this.panelKey=null;
		this.panelClass=null;
		this.resName=null;
		this.mediatorClass=null;
	}

	__class(PanelData,'game.base.entity.PanelData');
	return PanelData;
})()


//class game.base.entity.SceneData
var SceneData=(function(){
	function SceneData(){
		this.sceneName=null;
		this.sceneClass=null;
		this.mediatorClass=null;
		this.res=null;
		this.floatScene=false;
		this.onlyOneInstance=false;
		this.sceneInstance=null;
		this.mediatorInstance=null;
		this.group=null;
	}

	__class(SceneData,'game.base.entity.SceneData');
	var __proto=SceneData.prototype;
	__proto.getNew=function(mediatorData){
		if(this.onlyOneInstance && this.sceneInstance){
			if(this.mediatorInstance){
				this.mediatorInstance.resume(mediatorData);
			}
			return this.sceneInstance;
		};
		var scene=new this.sceneClass();
		var mediator=null;
		if(this.mediatorClass){
			mediator=new this.mediatorClass(scene,mediatorData);
		}
		if(this.onlyOneInstance){
			this.sceneInstance=scene;
			this.mediatorInstance=mediator;
		}
		return scene;
	}

	SceneData.getResData=function(urlStr,type){
		return {url:urlStr,resType:type};
	}

	SceneData.getResDataArray=function(arr,type){
		var dataArr=[];
		for (var i=0;i < arr.length;i++){
			var obj=SceneData.getResData(arr[i],type);
			dataArr.push(obj);
		}
		return dataArr;
	}

	return SceneData;
})()


//class game.mvc.Command
var Command=(function(){
	function Command(){}
	__class(Command,'game.mvc.Command');
	var __proto=Command.prototype;
	__proto.execute=function(data){}
	return Command;
})()


//class game.base.manager.ConfigManager
var ConfigManager=(function(){
	function ConfigManager(){}
	__class(ConfigManager,'game.base.manager.ConfigManager');
	var __proto=ConfigManager.prototype;
	__proto.loadConfig=function(configName){
		App.loadZip(configName,ConfigManager.fun);
	}

	/**
	*注册一个自定义的解析方法
	*@param fileName
	*@param analysisFun
	*/
	__proto.regAnalysisFun=function(fileName,analysisFun){
		var configData=new ConfigData();
		configData.analysisFun=analysisFun;
		ConfigManager.regMap[fileName]=configData;
	}

	/**
	*注册一个配置文件
	*@param fileName
	*@param configClass
	*@param mapKey
	*/
	__proto.regConfig=function(fileName,configClass,mapKey){
		var configData=new ConfigData();
		configData.configClass=configClass;
		if((typeof mapKey=='string')){
			configData.mapKey=mapKey;
			}else if((typeof mapKey=='function')){
			configData.keyFun=mapKey;
		}
		ConfigManager.regMap[fileName]=configData;
	}

	ConfigManager.fun=function(arr){
		for (var i=0,len=arr.length;i < len;i+=2){
			var fileName=arr[i];
			var fileContent=arr[i+1];
			var configData=ConfigManager.regMap[fileName];
			if(configData==null){
				continue ;
			}
			if(configData.analysisFun){
				configData.analysisFun(fileContent);
				continue ;
			};
			var dataArr=ConfigManager.analysisConfig(fileContent,configData.configClass);
			ConfigManager.dataArrMap[fileName]=dataArr;
			if(configData.mapKey || configData.keyFun){
				for (var j=0 ,len1=dataArr.length;j < len1;j++){
					var data=dataArr[j];
					var key=(configData.mapKey?data[configData.mapKey]:configData.keyFun(data));
					ConfigManager.putConfig(fileName,key,data);
				}
				}else{
				configData.configClass["init"](dataArr);
			}
		}
		App.eventManager.event("CONFIG_OVER");
	}

	ConfigManager.putConfig=function(fileName,key,value){
		if(ConfigManager.configMap[fileName]==null){
			ConfigManager.configMap[fileName]={};
		}
		ConfigManager.configMap[fileName][key]=value;
	}

	ConfigManager.getConfig=function(fileName,key){
		if(ConfigManager.configMap[fileName]){
			return ConfigManager.configMap[fileName][key];
		}
		return null;
	}

	ConfigManager.getDataArr=function(fileName){
		return ConfigManager.dataArrMap[fileName];
	}

	ConfigManager.analysisConfig=function(configString,configClass){
		if(configString.charCodeAt(0)==65279){
			configString=configString.substring(1);
		};
		var resultArr=[];
		var strary=configString.split("\n");
		var head=String(strary[0]).replace("\r","");
		var headary=head.split("\t");
		var contentary=strary.slice(1);
		for(var i=0,len=contentary.length;i < len;i++){
			var propstr=String(contentary[i]).replace("\r","");
			var propary=propstr.split("\t");
			var config=new configClass();
			for(var j=0 ,len2=propary.length;j < len2;j++){
				var now=config[headary[j]];
				var value=propary[j];
				if(((typeof now=='number')&& Math.floor(now)==now)|| (typeof now=='number')){
					if(value==null || value==""){
						now=0;
						}else{
						now=(((typeof now=='number')&& Math.floor(now)==now))? parseInt(value+""):parseFloat(value+"");
					}
					}else {
					now=value;
				}
				config[headary[j]]=now;
			}
			resultArr.push(config);
		}
		return resultArr;
	}

	ConfigManager.regMap={};
	ConfigManager.configMap={};
	ConfigManager.dataArrMap={};
	return ConfigManager;
})()


//class game.base.manager.DialogResManager
var DialogResManager=(function(){
	function DialogResManager(){
		this.resMap=new Map();
		Laya.timer.loop(DialogResManager.CHECK_TIME,this,this.check);
	}

	__class(DialogResManager,'game.base.manager.DialogResManager');
	var __proto=DialogResManager.prototype;
	__proto.open=function(resName,class1){
		if(resName==null)return;
		var data=Map.putClass(this.resMap,resName,DialogResData);
		data.time=-1;
		data.addClass(class1);
	}

	__proto.check=function(){
		var now=Browser.now();
		for (var resName in this.resMap){
			var data=this.resMap[resName];
			if(data.time==-1){
				this.checkIsOpen(data);
				}else if((now-data.time)> DialogResManager.DISPOSE_TIME){
				Laya.loader.clearRes(OpenDialogManager.getResUrl(resName),true);
				this.resMap.remove(resName);
			}
		}
	}

	__proto.checkIsOpen=function(data){
		for (var i=0;i < data.classArr.length;i++){
			var class1=data.classArr [i];
			if(this.haveDialog(class1)){
				return;
			}
		}
		data.time=Browser.now();
	}

	__proto.haveDialog=function(class1){
		for (var i=0;i < Dialog.manager.numChildren;i++){
			var node=Dialog.manager.getChildAt(i);
			if(Laya.__typeof(node,class1)){
				return true;
			}
		}
		return false;
	}

	DialogResManager.DISPOSE_TIME=10 *60 *1000;
	DialogResManager.CHECK_TIME=60 *1000;
	return DialogResManager;
})()


//class game.base.manager.GameLoaderManager
var GameLoaderManager=(function(){
	function GameLoaderManager(){
		this.typeMap={};
		GameLoaderManager.isHttps=(Browser.window.location.protocol=="https:");
		this.regPath("","");
		this.regPath("ATLAS","res/atlas/comp/");
		this.regPath("PNG","res/png/");
		this.regPath("CLIP","res/clip/");
	}

	__class(GameLoaderManager,'game.base.manager.GameLoaderManager');
	var __proto=GameLoaderManager.prototype;
	__proto.setCDN=function(cdnRoot){
		URL.basePath=cdnRoot;
	}

	__proto.regPath=function(resType,path){
		this.typeMap[resType]=path;
	}

	/**
	*
	*@param resType 可以传null 必须在obj里声明resType属性
	*@param url
	*@param complete
	*@param progress
	*@param type
	*@param priority
	*@param cache
	*@param group
	*@param ignoreCache
	*
	*/
	__proto.load=function(resType,url,complete,progress,type,priority,cache,group,ignoreCache){
		(priority===void 0)&& (priority=1);
		(cache===void 0)&& (cache=true);
		(ignoreCache===void 0)&& (ignoreCache=false);
		Laya.loader.load(this.getUrl(resType,url),complete,progress,type,priority,cache,group,true);
	}

	/**
	*@param resType
	*@param url
	*@return
	*传字符串或者数组
	*/
	__proto.getUrl=function(resType,url){
		var path=this.typeMap[resType];
		if ((url instanceof Array)){
			var arr=url;
			var copyArr=[];
			for (var i=0;i < arr.length;i++){
				var oldObj=arr[i];
				if((typeof oldObj=='string')){
					copyArr[i]=this.resetUrl(path+oldObj);
					}else {
					var obj=ObjectTools.copyObj(oldObj);
					copyArr[i]=obj;
					if(resType==null){
						if(obj.resType !=null){
							obj.url=this.resetUrl(this.typeMap[obj.resType]+obj.url);
						}
						}else{
						obj.url=this.resetUrl(path+obj.url);
					}
				}
			}
			return copyArr;
			}else{
			return this.resetUrl(path+url);
		}
	}

	__proto.resetUrl=function(url){
		return url;
	}

	GameLoaderManager.ROOT="";
	GameLoaderManager.ATLAS="ATLAS";
	GameLoaderManager.PNG="PNG";
	GameLoaderManager.CLIP="CLIP";
	GameLoaderManager.isHttps=false;
	return GameLoaderManager;
})()


//class game.base.manager.LayerManager
var LayerManager=(function(){
	function LayerManager(){
		this.loadUIClass=null;
		this.loadInstance=null;
		this.sceneLayer=new Sprite();
		this.tipsLayer=new Sprite();
		this.effectLayer=new Sprite();
		this.guideLayer=new StageSprite();
		this.init();
	}

	__class(LayerManager,'game.base.manager.LayerManager');
	var __proto=LayerManager.prototype;
	__proto.init=function(){
		Dialog.manager.zOrder=0;
		Laya.stage.addChild(this.sceneLayer);
		Laya.stage.addChild(Dialog.manager);
		Laya.stage.addChild(this.effectLayer);
		Laya.stage.addChild(this.tipsLayer);
		Laya.stage.addChild(this.guideLayer);
		this.guideLayer.mouseThrough=true;
	}

	__proto.showLoadLayer=function(value){
		if(this.loadUIClass==null){
			return;
		}
		if(this.loadInstance==null){
			this.loadInstance=new this.loadUIClass();
		}
		if(value){
			Laya.stage.addChild(this.loadInstance);
			}else{
			this.loadInstance.removeSelf();
		}
	}

	__proto.isShowLoad=function(){
		if(this.loadUIClass==null || this.loadInstance==null){
			return false;
		}
		return this.loadInstance.parent !=null;
	}

	/**
	*第一次展示的时候才会创建
	*@param loadUIClass
	*/
	__proto.setLoadUIClass=function(loadUIClass){
		this.loadUIClass=loadUIClass;
	}

	return LayerManager;
})()


//class game.base.manager.OpenDialogManager
var OpenDialogManager=(function(){
	function OpenDialogManager(){
		this.isLoading=false;
		/**
		*打开面板的时候 是否隐藏其他面板
		*/
		this.displayOtherDialog=false;
		this.interceptHandler=null;
		this.interceptMap={};
		this.manager=new DialogResManager();
	}

	__class(OpenDialogManager,'game.base.manager.OpenDialogManager');
	var __proto=OpenDialogManager.prototype;
	/**
	*
	*@param dialogStr
	*@param panelClass panel里不允许注入session 和 action 如果需要都写mediator里
	*@param resName
	*@param mediatorClass
	*
	*/
	__proto.regDialog=function(dialogStr,panelClass,resName,mediatorClass){
		var panelObject=new PanelData();
		panelObject.panelKey=dialogStr;
		panelObject.panelClass=panelClass;
		panelObject.mediatorClass=mediatorClass;
		panelObject.resName=resName;
		OpenDialogManager.dialogMap[dialogStr]=panelObject;
	}

	__proto.regDoubleDialog=function(panel1,panel2){
		Map.putClass(OpenDialogManager.doubleDialogMap,panel1,Array).push(panel2);
		Map.putClass(OpenDialogManager.doubleDialogMap,panel2,Array).push(panel1);
	}

	/**
	*
	*@param dialogClass
	*@param autoClose
	*@param popup
	*@param nextFrameShow
	*这种是弹出简单的提示窗口那种 没有mediator
	*/
	__proto.showMiniDialog=function(dialogClass,autoClose,popup,nextFrameShow,hideOther){
		(autoClose===void 0)&& (autoClose=false);
		(popup===void 0)&& (popup=false);
		(nextFrameShow===void 0)&& (nextFrameShow=false);
		(hideOther===void 0)&& (hideOther=true);
		for (var i=0;i < Dialog.manager.numChildren;i++){
			var dialog=Dialog.manager.getChildAt(i);
			if(Laya.__typeof(dialog,dialogClass)){
				if(autoClose){
					dialog.close();
				}
				return dialog;
			}
		};
		var dialog1=new dialogClass();
		if(nextFrameShow){
			Laya.timer.callLater(this,this.nextShow,[dialog1,popup,hideOther]);
			}else{
			this.nextShow(dialog1,popup,hideOther);
		}
		dialog1.name=App.getInstanceClassName(dialog1);
		return dialog1;
	}

	__proto.nextShow=function(dialog,popup,hideOther){
		if(popup){
			dialog.popup(false,false);
			}else{
			dialog.show(false,false);
		}
		this.managerDialog(dialog,hideOther);
	}

	/**
	*打开任何面板最后都会走这里 进行最后的处理
	*@param dialog
	*/
	__proto.managerDialog=function(dialog,hideOther){
		App.eventManager.event("OPEN_DIALOG_INSTANCE",dialog);
		if(this.displayOtherDialog==false){
			return;
		}
		if(hideOther==false){
			return;
		}
		for (var i=0;i < Dialog.manager.numChildren;i++){
			var node=Dialog.manager.getChildAt(i);
			if((node instanceof laya.ui.Dialog )){
				(node).visible=false;
			}
		}
		dialog.visible=true;
		dialog.once("removed",this,this.dialogRemoveFun);
	}

	/**
	*关闭一个面板 显示最后一个面板
	*/
	__proto.dialogRemoveFun=function(){
		for (var i=0;i < Dialog.manager.numChildren;i++){
			var node=Dialog.manager.getChildAt(Dialog.manager.numChildren-i-1);
			if((node instanceof laya.ui.Dialog )){
				(node).visible=true;
				return;
			}
		}
	}

	/**
	*根据字符串打开面板 这应该是最常用的
	*@param panelStr
	*@param data
	*/
	__proto.openDialogByStr=function(panelStr,data,autoClose,haveBlackMask){
		(autoClose===void 0)&& (autoClose=true);
		(haveBlackMask===void 0)&& (haveBlackMask=false);
		if(this.interceptMap[panelStr]){
			App.eventManager.event("DIALOG_INTERCEPT",panelStr);
			return;
		}
		if(this.interceptHandler){
			if(this.interceptHandler.runWith(panelStr)){
				return;
			}
		};
		var panelObject=OpenDialogManager.dialogMap[panelStr];
		var openPanelData=new OpenPanelData(panelStr,data,autoClose,haveBlackMask);
		this.open(panelObject,openPanelData);
	}

	/**
	*根据字符串关闭面板
	*/
	__proto.closeDialogByStr=function(panelStr){
		var dialog=Dialog.manager.getChildByName(panelStr);
		if(dialog){
			dialog.close();
		}
	}

	//获取某个ui
	__proto.getDialogBystr=function(panelStr){
		var dialog=Dialog.manager.getChildByName(panelStr);
		return dialog;
	}

	__proto.open=function(obj,data){
		var dialog=Dialog.manager.getChildByName(obj.panelKey);
		if(dialog){
			if(data.autoCLose){
				dialog.close();
			}
			return;
		}
		if(this.isLoading && obj.resName){
			return;
		}
		this.isLoading=true;
		var resUrl=OpenDialogManager.getResUrl(obj.resName);
		if(obj.resName==null || Loader.getRes(resUrl)){
			this.loadOver(obj,data);
			}else{
			Laya.loader.load(resUrl ,Handler.create(this,this.loadOver,[obj,data]));
			App.eventManager.event("LOAD_PANEL_RES_START");
		}
	}

	__proto.loadOver=function(obj,openPanelData){
		App.eventManager.event("LOAD_PANEL_RES_OVER");
		this.manager.open(obj.resName,obj.panelClass);
		var data=openPanelData.data;
		this.isLoading=false;
		var panel=new obj.panelClass();
		panel.name=obj.panelKey;
		panel.tag=data;
		if(obj.mediatorClass){
			var panelMediator=new obj.mediatorClass(panel,data);
		};
		var arr=OpenDialogManager.doubleDialogMap[obj.panelKey];
		if(arr==null){
			this.exeOpen(panel,openPanelData);
			return;
		}
		for (var i=0;i < arr.length;i++){
			var dialog=Dialog.manager.getChildByName(arr[i]);
			if(dialog){
				var wid=(dialog.width+panel.width)/ 2;
				var stageWid=Laya.stage.width / 2;
				var dialogX=stageWid-wid;
				var dialogY=(Laya.stage.height-dialog.height)/ 2;
				panel.popupEffect=null;
				this.exeOpen(panel,openPanelData);
				panel.x=dialogX+dialog.width;
				Tween.to(dialog,{x:dialogX,y:dialogY},100);
				return;
			}
		}
		this.exeOpen(panel,openPanelData);
	}

	__proto.exeOpen=function(dialog,openPanelData){
		dialog.popupEffect=null;
		dialog.closeEffect=null;
		if(openPanelData && openPanelData.haveBlackMask){
			dialog.popup(false,false);
			}else{
			dialog.show(false,false);
		}
		this.managerDialog(dialog,this.displayOtherDialog);
	}

	/**
	*注册拦截窗口
	*@param dialogStr
	*@param value
	*true 是不拦截
	*false 是拦截
	*/
	__proto.regIntercept=function(dialogStr,value){
		if(value){
			this.interceptMap[dialogStr]=null;
			delete this.interceptMap[dialogStr];
			}else{
			this.interceptMap[dialogStr]=1;
		}
	}

	OpenDialogManager.getResUrl=function(fileName){
		return App.loaderManager.getUrl("ATLAS",fileName+".atlas");
	}

	OpenDialogManager.dialogMap={};
	OpenDialogManager.doubleDialogMap={};
	return OpenDialogManager;
})()


//class game.base.manager.PngManager
var PngManager=(function(){
	function PngManager(){
		this.map={};
	}

	__class(PngManager,'game.base.manager.PngManager');
	var __proto=PngManager.prototype;
	__proto.regPng=function(type,url){
		this.map[type]=url;
	}

	__proto.getUrl=function(type){
		return this.map[type];
	}

	return PngManager;
})()


//class game.base.manager.SceneManager
var SceneManager=(function(){
	function SceneManager(){
		this.sceneMap={};
		this.currentSceneName=null;
		Laya.stage.on("resize",this,this.resizeFun);
	}

	__class(SceneManager,'game.base.manager.SceneManager');
	var __proto=SceneManager.prototype;
	/**
	*@param sceneName
	*@param sceneClass
	*@param mediatorClass
	*@param res 可以是数组 可以是handler 如果是hanlder 有一个返回值 如果是数组 那么直接加载数组里的内容 如果返回的是null
	*那么会监听MyEvent.CUSTOM_SCENE_LOAD_OVER 事件 你可以去做任何事
	*@float 是否悬浮 不移除主层
	*/
	__proto.regScene=function(sceneName,sceneClass,mediatorClass,res,floatScene,onlyOneInstance,group){
		(floatScene===void 0)&& (floatScene=false);
		(onlyOneInstance===void 0)&& (onlyOneInstance=false);
		var sceneData=new SceneData();
		sceneData.sceneName=sceneName;
		sceneData.sceneClass=sceneClass;
		sceneData.mediatorClass=mediatorClass;
		sceneData.res=res;
		sceneData.floatScene=floatScene;
		sceneData.onlyOneInstance=onlyOneInstance;
		sceneData.group=group;
		this.sceneMap[sceneName]=sceneData;
	}

	/**
	*@param sceneName
	*@param removeOther 是否移除其他场景 不移除时会隐藏
	*@param mediatorData
	*/
	__proto.setScene=function(sceneName,removeOther,mediatorData,closeDialog){
		(removeOther===void 0)&& (removeOther=true);
		(closeDialog===void 0)&& (closeDialog=true);
		var sceneData=this.sceneMap[sceneName];
		if(sceneData==null){
			return;
		};
		var sceneLayer=App.layerManager.sceneLayer;
		if(closeDialog){
			Dialog.manager.closeAll();
			}else{
			this.setDialogVisible();
		}
		if(removeOther){
			sceneLayer.removeChildren();
			}else{
			this.setVisible(false);
		};
		var haveSp=this.checkHaveScene(sceneData.sceneClass);
		if(haveSp !=null){
			App.layerManager.sceneLayer.addChild(haveSp);
			return;
		}
		if(sceneData.res==null){
			this.comFun(sceneData,mediatorData,sceneName);
			}else{
			var arr=sceneData.res;
			if((sceneData.res instanceof laya.utils.Handler )){
				arr=(sceneData.res).run();
			}
			if(arr==null){
				App.eventManager.on("CUSTOM_SCENE_LOAD_OVER",this,this.comFun,[sceneData,mediatorData]);
				}else{
				App.loaderManager.load(null,arr,new Handler(this,this.comFun,[sceneData,mediatorData,sceneName]),new Handler(this,this.progressFun),null,1,true,sceneData.group);
			}
			App.eventManager.event("SET_SCENE",sceneName);
		}
	}

	__proto.progressFun=function(value){
		App.eventManager.event("SET_SCENE_PROGRESS",value);
	}

	__proto.checkHaveScene=function(sceneClass){
		for (var i=0;i < App.layerManager.sceneLayer.numChildren;i++){
			var sprite=App.layerManager.sceneLayer.getChildAt(i);
			if(Laya.__typeof(sprite,sceneClass)){
				return sprite;
			}
		}
		return null;
	}

	__proto.setDialogVisible=function(){
		for (var i=0;i < Dialog.manager.numChildren;i++){
			var sp=Dialog.manager.getChildAt(i);
			sp.visible=false;
		}
	}

	__proto.resetDialog=function(){
		var arr=[];
		for (var i=0;i < Dialog.manager.numChildren;i++){
			var sp=Dialog.manager.getChildAt(i);
			if(sp.visible && ((sp instanceof laya.ui.Dialog ))){
				arr.push(sp);
				}else{
				sp.visible=true;
			}
		}
		for (var j=0;j < arr.length;j++){
			(arr [j]).close();
		}
	}

	/**
	*移除当前层 其他隐藏的层会重新显示
	*/
	__proto.removeCurrentScene=function(){
		var sceneLayer=App.layerManager.sceneLayer;
		sceneLayer.removeChildAt(sceneLayer.numChildren-1);
		this.setVisible(true);
		this.resetDialog();
	}

	// }
	__proto.getCurrentScene=function(){
		var sceneLayer=App.layerManager.sceneLayer;
		return sceneLayer.getChildAt(sceneLayer.numChildren-1);
	}

	__proto.setVisible=function(value){
		var sceneLayer=App.layerManager.sceneLayer;
		for (var i=0;i < sceneLayer.numChildren;i++){
			var sprite=sceneLayer.getChildAt(i);
			sprite.visible=value;
			if(value){
				sprite.event("RE_DISPLAY");
			}
		}
	}

	__proto.comFun=function(sceneData,mediatorData,sceneName){
		App.eventManager.event("SET_SCENE_OVER",sceneName);
		var sp=sceneData.getNew(mediatorData);
		this.setCenter(sp);
		this.resizeFun();
		App.layerManager.sceneLayer.addChild(sp);
	}

	__proto.resizeFun=function(){
		App.layerManager.sceneLayer.size(Laya.stage.width,Laya.stage.height);
		for (var i=0;i < App.layerManager.sceneLayer.numChildren;i++){
			this.setCenter(App.layerManager.sceneLayer.getChildAt(i));
		}
	}

	__proto.setCenter=function(sp){
		if(sp.width !=0){
			sp.x=(Laya.stage.width-sp.width)/2;
		}
	}

	SceneManager.RE_DISPLAY="RE_DISPLAY";
	return SceneManager;
})()


//class game.base.manager.VoiceManager
var VoiceManager=(function(){
	function VoiceManager(){
		this.pathRoot=null;
		this.currentMusic=null;
		this.musicStat=1;
		this.soundStat=1;
		this.canPlay=false;
		if(App.isApp()){
			return;
		}
		if(Browser.onPC){
			this.musicStat=0;
			Laya.stage.once("click",this,this.clickFun);
		}
	}

	__class(VoiceManager,'game.base.manager.VoiceManager');
	var __proto=VoiceManager.prototype;
	__proto.clickFun=function(){
		this.canPlay=true;
		this.setMusic(1);
	}

	__proto.setRoot=function(pathRoot){
		this.pathRoot=pathRoot;
	}

	/**
	*设置状态 0是关闭 1是开启
	*@param value
	*/
	__proto.setMusic=function(value){
		if(value==this.musicStat){
			return;
		}
		this.musicStat=value;
		if(value==0){
			SoundManager.stopMusic();
			}else{
			if(this.currentMusic==null){
				return;
			}
			SoundManager.playMusic(this.currentMusic);
		}
	}

	__proto.setSound=function(value){
		if(value==this.soundStat){
			return;
		}
		this.soundStat=value;
		if(value==0){
			SoundManager.stopAllSound();
		}
	}

	/**
	*背景音乐
	*@param url
	*@return
	*/
	__proto.playMusic=function(url){
		var string=App.loaderManager.getUrl(this.pathRoot,url);
		this.currentMusic=string;
		if(this.musicStat==0){
			return;
		}
		SoundManager.playMusic(string);
	}

	/**
	*音效
	*@param url
	*@param loops 循环次数 默认一次
	*@return
	*/
	__proto.playSound=function(url,loops){
		(loops===void 0)&& (loops=1);
		if(this.soundStat==0){
			return;
		}
		SoundManager.playSound(App.loaderManager.getUrl(this.pathRoot,url),loops);
	}

	/**
	*停止播放音效
	*@param url
	*@return
	*/
	__proto.stopSound=function(url){
		SoundManager.stopSound(App.loaderManager.getUrl(this.pathRoot,url));
	}

	return VoiceManager;
})()


//class game.base.MyEvent
var MyEvent=(function(){
	function MyEvent(){}
	__class(MyEvent,'game.base.MyEvent');
	MyEvent.LOAD_PANEL_RES_START="LOAD_PANEL_RES_START";
	MyEvent.LOAD_PANEL_RES_OVER="LOAD_PANEL_RES_OVER";
	MyEvent.CONFIG_TXT_OVER="CONFIG_TXT_OVER";
	MyEvent.UI_JSON_OVER="UI_JSON_OVER";
	MyEvent.SCENE_CHANGE="SCENE_CHANGE";
	MyEvent.CONFIG_OVER="CONFIG_OVER";
	MyEvent.SYS_CONFIG_OVER="SYS_CONFIG_OVER";
	MyEvent.CONNECT_SERVER_OK="CONNECT_SERVER_OK";
	MyEvent.NET_CLOSE="NET_CLOSE";
	MyEvent.TRY_CONNECT_FAILED="TRY_CONNECT_FAILED";
	MyEvent.SCENE_LOAD_PROGRESS="SCENE_LOAD_PROGRESS";
	MyEvent.OPEN_DIALOG_INSTANCE="OPEN_DIALOG_INSTANCE";
	MyEvent.SET_SDK_ID="SET_SDK_ID";
	MyEvent.SWITCH_SDK_ID="SWITCH_SDK_ID";
	MyEvent.LOGOUT_SDK="LOGOUT_SDK";
	MyEvent.LOGIN_SDK_CANCEL="LOGIN_SDK_CANCEL";
	MyEvent.DIALOG_INTERCEPT="DIALOG_INTERCEPT";
	MyEvent.CONNECT_TRY_ONE="CONNECT_TRY_ONE";
	MyEvent.SOCKET_CLOSE="SOCKET_CLOSE";
	MyEvent.CUSTOM_SCENE_LOAD_OVER="CUSTOM_SCENE_LOAD_OVER";
	MyEvent.SET_SCENE="SET_SCENE";
	MyEvent.SET_SCENE_OVER="SET_SCENE_OVER";
	MyEvent.SET_SCENE_PROGRESS="SET_SCENE_PROGRESS";
	MyEvent.LOAD_SCENE_AUTO="LOAD_SCENE_AUTO";
	MyEvent.CLEAR_SESSION_DATA="CLEAR_SESSION_DATA";
	MyEvent.SOCKET_CLOSE_ACTIVE="SOCKET_CLOSE_ACTIVE";
	return MyEvent;
})()


//class game.base.Shake
var Shake=(function(){
	function Shake(){
		this.sp=null;
		this.time=0;
		this.shakeAni=null;
		this.shakeBox=null;
		this.startTime=0;
		this.arr=[-1,-1,0,0,1,1];
		this.now=0;
		this.moveLen=0;
		this.nowIndex=0;
		this.startPo=new Point();
	}

	__class(Shake,'game.base.Shake');
	var __proto=Shake.prototype;
	__proto.exe=function(sp,time,moveLen){
		this.moveLen=moveLen;
		this.time=time;
		this.sp=sp;
		this.startPo.setTo(sp.x,sp.y);
		Laya.timer.frameLoop(1,this,this.loopFun);
		this.startTime=Browser.now();
		this.now=0;
	}

	__proto.loopFun=function(){
		if((Browser.now()-this.startTime)>this.time){
			Laya.timer.clear(this,this.loopFun);
			this.sp.pos(this.startPo.x,this.startPo.y);
			this.sp=null;
			return;
		}
		if(this.now >=this.arr.length){
			this.now=0;
		}
		this.sp.pos(this.startPo.x+this.arr[this.now] *this.moveLen ,this.startPo.y+this.arr[this.now+1] *this.moveLen);
		this.now+=2;
	}

	__proto.exeByUI=function(sp){
		this.sp=sp;
		this.startPo.setTo(sp.x,sp.y);
		Laya.timer.frameLoop(1,this,this.enterFun);
	}

	__proto.enterFun=function(){
		if(this.nowIndex >=this.shakeAni.count){
			this.stopShakeByUI();
			return;
		}
		this.shakeAni.index=this.nowIndex;
		this.sp.pos(this.startPo.x+this.shakeBox.x ,this.startPo.y+this.shakeBox.y);
		this.nowIndex++;
	}

	__proto.stopShakeByUI=function(){
		this.sp.pos(this.startPo.x,this.startPo.y);
		Laya.timer.clear(this,this.enterFun);
		this.nowIndex=0;
	}

	Shake.setShakeUI=function(ani,box){
		Shake.shake.shakeAni=ani;
		Shake.shake.shakeBox=box;
	}

	Shake.execute=function(sp,time,moveLen){
		Shake.shake.exe(sp,time,moveLen);
	}

	Shake.shakeByUI=function(sp){
		Shake.shake.exeByUI(sp);
	}

	__static(Shake,
	['shake',function(){return this.shake=new Shake();}
	]);
	return Shake;
})()


//class game.base.TheGame
var TheGame=(function(){
	function TheGame(){}
	__class(TheGame,'game.base.TheGame');
	TheGame.GetNumStr=function(value,maxLen){
		var len=maxLen-value.toString().length;
		var str="";
		for(var i=0;i < len;i++){
			str+="0";
		}
		return str+value;
	}

	TheGame.getNum=function(value,fix){
		(fix===void 0)&& (fix=2);
		var str=value+"";
		if(str.indexOf(".")==-1){
			return str;
		}
		return value.toFixed(fix);
	}

	TheGame.beween=function(min,max,value){
		return (value>max)?max:((value<min)?min:value);
	}

	TheGame.C=function(color,text,br){
		(br===void 0)&& (br=0);
		return "<font color='"+color+"'> "+text+"</font>"+((br==1)? "<br>" :"");
	}

	TheGame.CS=function(color,text,size,br){
		(br===void 0)&& (br=0);
		return "<font style='font-family:隶书;fontSize:"+size+"' color='"+color+"' > "+text+"</font>"+((br==1)? "<br>" :"");
	}

	TheGame.FONT=function(text,color,size,family){
		return "<font style='color:"+color+";font-family:"+family+";fontSize:"+size+"'>"+text+"</font>";
	}

	TheGame.between=function(value,min,max){
		value=Math.max(value,min);
		value=Math.min(value,max);
		return value;
	}

	TheGame.betweenLoop=function(value,min,max){
		if(value > max){
			return min;
		}
		if(value < min){
			return max;
		}
		return value;
	}

	TheGame.betweenArr=function(value,min,arr){
		return TheGame.betweenLoop(value,min,arr.length-1);
	}

	TheGame.getWidth=function(sp){
		var min=0;
		var max=0;
		for (var i=0;i < sp.numChildren;i++){
			var node=sp.getChildAt(i);
			min=Math.min(min,node.x);
			max=Math.max(max ,node.width+node.x);
		}
		return max-min;
	}

	TheGame.lang=function(lbl,text,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10){
		if(lbl !=null){
			lbl.textField.lang(text,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10);
			lbl.textField.typeset();
		}
	}

	return TheGame;
})()


//class game.base.utils.AutoResize
var AutoResize=(function(){
	function AutoResize(node){
		this.resizeArr=[];
		this.node=null;
		this.node=node;
		node.on("undisplay",this,this.undisFun);
		Laya.stage.on("resize",this,this.resizeFun);
	}

	__class(AutoResize,'game.base.utils.AutoResize');
	var __proto=AutoResize.prototype;
	__proto.undisFun=function(){
		Laya.stage.off("resize",this,this.resizeFun);
	}

	__proto.push=function(sp){
		this.resizeArr.push(sp);
		Laya.timer.callLater(this,this.resizeFun);
	}

	__proto.resizeFun=function(){
		for (var i=0;i < this.resizeArr.length;i++){
			(this.resizeArr [i]).size(Laya.stage.width,Laya.stage.height);
		}
	}

	return AutoResize;
})()


/**
*<p> <code>Byte</code> 类提供用于优化读取、写入以及处理二进制数据的方法和属性。</p>
*<p><b>注意：</b> <code>Byte</code> 类适用于需要在字节层访问数据的高级开发人员。</p>
*/
//class laya.utils.Byte
var Byte=(function(){
	function Byte(data){
		/**
		*@private
		*是否为小端数据。
		*/
		this._xd_=true;
		this._allocated_=8;
		/**
		*@private
		*原始数据。
		*/
		//this._d_=null;
		/**
		*@private
		*DataView
		*/
		//this._u8d_=null;
		/**@private */
		this._pos_=0;
		/**@private */
		this._length=0;
		if (data){
			this._u8d_=new Uint8Array(data);
			this._d_=new DataView(this._u8d_.buffer);
			this._length=this._d_.byteLength;
			}else {
			this.___resizeBuffer(this._allocated_);
		}
	}

	__class(Byte,'laya.utils.Byte');
	var __proto=Byte.prototype;
	/**@private */
	__proto.___resizeBuffer=function(len){
		try {
			var newByteView=new Uint8Array(len);
			if (this._u8d_ !=null){
				if (this._u8d_.length <=len)newByteView.set(this._u8d_);
				else newByteView.set(this._u8d_.subarray(0,len));
			}
			this._u8d_=newByteView;
			this._d_=new DataView(newByteView.buffer);
			}catch (err){
			throw "___resizeBuffer err:"+len;
		}
	}

	/**
	*<p>常用于解析固定格式的字节流。</p>
	*<p>先从字节流的当前字节偏移位置处读取一个 <code>Uint16</code> 值，然后以此值为长度，读取此长度的字符串。</p>
	*@return 读取的字符串。
	*/
	__proto.getString=function(){
		return this.rUTF(this.getUint16());
	}

	/**
	*从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Float32Array</code> 对象并返回此对象。
	*@param start 开始位置。
	*@param len 需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。
	*@return 读取的 Float32Array 对象。
	*/
	__proto.getFloat32Array=function(start,len){
		var end=start+len;
		end=(end > this._length)? this._length :end;
		var v=new Float32Array(this._d_.buffer.slice(start,end));
		this._pos_=end;
		return v;
	}

	/**
	*从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Uint8Array</code> 对象并返回此对象。
	*@param start 开始位置。
	*@param len 需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。
	*@return 读取的 Uint8Array 对象。
	*/
	__proto.getUint8Array=function(start,len){
		var end=start+len;
		end=(end > this._length)? this._length :end;
		var v=new Uint8Array(this._d_.buffer.slice(start,end));
		this._pos_=end;
		return v;
	}

	/**
	*从字节流中 <code>start</code> 参数指定的位置开始，读取 <code>len</code> 参数指定的字节数的数据，用于创建一个 <code>Int16Array</code> 对象并返回此对象。
	*@param start 开始读取的字节偏移量位置。
	*@param len 需要读取的字节长度。如果要读取的长度超过可读取范围，则只返回可读范围内的值。
	*@return 读取的 Uint8Array 对象。
	*/
	__proto.getInt16Array=function(start,len){
		var end=start+len;
		end=(end > this._length)? this._length :end;
		var v=new Int16Array(this._d_.buffer.slice(start,end));
		this._pos_=end;
		return v;
	}

	/**
	*从字节流的当前字节偏移位置处读取一个 IEEE 754 单精度（32 位）浮点数。
	*@return 单精度（32 位）浮点数。
	*/
	__proto.getFloat32=function(){
		if (this._pos_+4 > this._length)throw "getFloat32 error - Out of bounds";
		var v=this._d_.getFloat32(this._pos_,this._xd_);
		this._pos_+=4;
		return v;
	}

	/**
	*从字节流的当前字节偏移量位置处读取一个 IEEE 754 双精度（64 位）浮点数。
	*@return 双精度（64 位）浮点数。
	*/
	__proto.getFloat64=function(){
		if (this._pos_+8 > this._length)throw "getFloat64 error - Out of bounds";
		var v=this._d_.getFloat64(this._pos_,this._xd_);
		this._pos_+=8;
		return v;
	}

	/**
	*在字节流的当前字节偏移量位置处写入一个 IEEE 754 单精度（32 位）浮点数。
	*@param value 单精度（32 位）浮点数。
	*/
	__proto.writeFloat32=function(value){
		this.ensureWrite(this._pos_+4);
		this._d_.setFloat32(this._pos_,value,this._xd_);
		this._pos_+=4;
	}

	/**
	*在字节流的当前字节偏移量位置处写入一个 IEEE 754 双精度（64 位）浮点数。
	*@param value 双精度（64 位）浮点数。
	*/
	__proto.writeFloat64=function(value){
		this.ensureWrite(this._pos_+8);
		this._d_.setFloat64(this._pos_,value,this._xd_);
		this._pos_+=8;
	}

	/**
	*从字节流的当前字节偏移量位置处读取一个 Int32 值。
	*@return Int32 值。
	*/
	__proto.getInt32=function(){
		if (this._pos_+4 > this._length)throw "getInt32 error - Out of bounds";
		var float=this._d_.getInt32(this._pos_,this._xd_);
		this._pos_+=4;
		return float;
	}

	/**
	*从字节流的当前字节偏移量位置处读取一个 Uint32 值。
	*@return Uint32 值。
	*/
	__proto.getUint32=function(){
		if (this._pos_+4 > this._length)throw "getUint32 error - Out of bounds";
		var v=this._d_.getUint32(this._pos_,this._xd_);
		this._pos_+=4;
		return v;
	}

	/**
	*在字节流的当前字节偏移量位置处写入指定的 Int32 值。
	*@param value 需要写入的 Int32 值。
	*/
	__proto.writeInt32=function(value){
		this.ensureWrite(this._pos_+4);
		this._d_.setInt32(this._pos_,value,this._xd_);
		this._pos_+=4;
	}

	/**
	*在字节流的当前字节偏移量位置处写入 Uint32 值。
	*@param value 需要写入的 Uint32 值。
	*/
	__proto.writeUint32=function(value){
		this.ensureWrite(this._pos_+4);
		this._d_.setUint32(this._pos_,value,this._xd_);
		this._pos_+=4;
	}

	/**
	*从字节流的当前字节偏移量位置处读取一个 Int16 值。
	*@return Int16 值。
	*/
	__proto.getInt16=function(){
		if (this._pos_+2 > this._length)throw "getInt16 error - Out of bounds";
		var us=this._d_.getInt16(this._pos_,this._xd_);
		this._pos_+=2;
		return us;
	}

	/**
	*从字节流的当前字节偏移量位置处读取一个 Uint16 值。
	*@return Uint16 值。
	*/
	__proto.getUint16=function(){
		if (this._pos_+2 > this._length)throw "getUint16 error - Out of bounds";
		var us=this._d_.getUint16(this._pos_,this._xd_);
		this._pos_+=2;
		return us;
	}

	/**
	*在字节流的当前字节偏移量位置处写入指定的 Uint16 值。
	*@param value 需要写入的Uint16 值。
	*/
	__proto.writeUint16=function(value){
		this.ensureWrite(this._pos_+2);
		this._d_.setUint16(this._pos_,value,this._xd_);
		this._pos_+=2;
	}

	/**
	*在字节流的当前字节偏移量位置处写入指定的 Int16 值。
	*@param value 需要写入的 Int16 值。
	*/
	__proto.writeInt16=function(value){
		this.ensureWrite(this._pos_+2);
		this._d_.setInt16(this._pos_,value,this._xd_);
		this._pos_+=2;
	}

	/**
	*从字节流的当前字节偏移量位置处读取一个 Uint8 值。
	*@return Uint8 值。
	*/
	__proto.getUint8=function(){
		if (this._pos_+1 > this._length)throw "getUint8 error - Out of bounds";
		return this._d_.getUint8(this._pos_++);
	}

	/**
	*在字节流的当前字节偏移量位置处写入指定的 Uint8 值。
	*@param value 需要写入的 Uint8 值。
	*/
	__proto.writeUint8=function(value){
		this.ensureWrite(this._pos_+1);
		this._d_.setUint8(this._pos_,value);
		this._pos_++;
	}

	/**
	*@private
	*从字节流的指定字节偏移量位置处读取一个 Uint8 值。
	*@param pos 字节读取位置。
	*@return Uint8 值。
	*/
	__proto._getUInt8=function(pos){
		return this._d_.getUint8(pos);
	}

	/**
	*@private
	*从字节流的指定字节偏移量位置处读取一个 Uint16 值。
	*@param pos 字节读取位置。
	*@return Uint16 值。
	*/
	__proto._getUint16=function(pos){
		return this._d_.getUint16(pos,this._xd_);
	}

	/**
	*@private
	*使用 getFloat32()读取6个值，用于创建并返回一个 Matrix 对象。
	*@return Matrix 对象。
	*/
	__proto._getMatrix=function(){
		var rst=new Matrix(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32());
		return rst;
	}

	/**
	*@private
	*读取指定长度的 UTF 型字符串。
	*@param len 需要读取的长度。
	*@return 读取的字符串。
	*/
	__proto.rUTF=function(len){
		var v="",max=this._pos_+len,c=0,c2=0,c3=0,f=String.fromCharCode;
		var u=this._u8d_,i=0;
		while (this._pos_ < max){
			c=u[this._pos_++];
			if (c < 0x80){
				if (c !=0){
					v+=f(c);
				}
				}else if (c < 0xE0){
				v+=f(((c & 0x3F)<< 6)| (u[this._pos_++] & 0x7F));
				}else if (c < 0xF0){
				c2=u[this._pos_++];
				v+=f(((c & 0x1F)<< 12)| ((c2 & 0x7F)<< 6)| (u[this._pos_++] & 0x7F));
				}else {
				c2=u[this._pos_++];
				c3=u[this._pos_++];
				v+=f(((c & 0x0F)<< 18)| ((c2 & 0x7F)<< 12)| ((c3 << 6)& 0x7F)| (u[this._pos_++] & 0x7F));
			}
			i++;
		}
		return v;
	}

	/**
	*@private
	*读取 <code>len</code> 参数指定的长度的字符串。
	*@param len 要读取的字符串的长度。
	*@return 指定长度的字符串。
	*/
	__proto.getCustomString=function(len){
		var v="",ulen=0,c=0,c2=0,f=String.fromCharCode;
		var u=this._u8d_,i=0;
		while (len > 0){
			c=u[this._pos_];
			if (c < 0x80){
				v+=f(c);
				this._pos_++;
				len--;
				}else {
				ulen=c-0x80;
				this._pos_++;
				len-=ulen;
				while (ulen > 0){
					c=u[this._pos_++];
					c2=u[this._pos_++];
					v+=f((c2 << 8)| c);
					ulen--;
				}
			}
		}
		return v;
	}

	/**
	*清除字节数组的内容，并将 length 和 pos 属性重置为 0。调用此方法将释放 Byte 实例占用的内存。
	*/
	__proto.clear=function(){
		this._pos_=0;
		this.length=0;
	}

	/**
	*@private
	*获取此对象的 ArrayBuffer 引用。
	*@return
	*/
	__proto.__getBuffer=function(){
		return this._d_.buffer;
	}

	/**
	*<p>将 UTF-8 字符串写入字节流。类似于 writeUTF()方法，但 writeUTFBytes()不使用 16 位长度的字为字符串添加前缀。</p>
	*<p>对应的读取方法为： getUTFBytes 。</p>
	*@param value 要写入的字符串。
	*/
	__proto.writeUTFBytes=function(value){
		value=value+"";
		for (var i=0,sz=value.length;i < sz;i++){
			var c=value.charCodeAt(i);
			if (c <=0x7F){
				this.writeByte(c);
				}else if (c <=0x7FF){
				this.ensureWrite(this._pos_+2);
				this._u8d_.set([0xC0 | (c >> 6),0x80 | (c & 0x3F)],this._pos_);
				this._pos_+=2;
				}else if (c <=0xFFFF){
				this.ensureWrite(this._pos_+3);
				this._u8d_.set([0xE0 | (c >> 12),0x80 | ((c >> 6)& 0x3F),0x80 | (c & 0x3F)],this._pos_);
				this._pos_+=3;
				}else {
				this.ensureWrite(this._pos_+4);
				this._u8d_.set([0xF0 | (c >> 18),0x80 | ((c >> 12)& 0x3F),0x80 | ((c >> 6)& 0x3F),0x80 | (c & 0x3F)],this._pos_);
				this._pos_+=4;
			}
		}
	}

	/**
	*<p>将 UTF-8 字符串写入字节流。先写入以字节表示的 UTF-8 字符串长度（作为 16 位整数），然后写入表示字符串字符的字节。</p>
	*<p>对应的读取方法为： getUTFString 。</p>
	*@param value 要写入的字符串值。
	*/
	__proto.writeUTFString=function(value){
		var tPos=this.pos;
		this.writeUint16(1);
		this.writeUTFBytes(value);
		var dPos=this.pos-tPos-2;
		if (dPos >=65536){
			throw "writeUTFString byte len more than 65536";
		}
		this._d_.setUint16(tPos,dPos,this._xd_);
	}

	/**
	*@private
	*读取 UTF-8 字符串。
	*@return 读取的字符串。
	*/
	__proto.readUTFString=function(){
		return this.readUTFBytes(this.getUint16());
	}

	/**
	*<p>从字节流中读取一个 UTF-8 字符串。假定字符串的前缀是一个无符号的短整型（以此字节表示要读取的长度）。</p>
	*<p>对应的写入方法为： writeUTFString 。</p>
	*@return 读取的字符串。
	*/
	__proto.getUTFString=function(){
		return this.readUTFString();
	}

	/**
	*@private
	*读字符串，必须是 writeUTFBytes 方法写入的字符串。
	*@param len 要读的buffer长度，默认将读取缓冲区全部数据。
	*@return 读取的字符串。
	*/
	__proto.readUTFBytes=function(len){
		(len===void 0)&& (len=-1);
		if (len==0)return "";
		var lastBytes=this.bytesAvailable;
		if (len > lastBytes)throw "readUTFBytes error - Out of bounds";
		len=len > 0 ? len :lastBytes;
		return this.rUTF(len);
	}

	/**
	*<p>从字节流中读取一个由 length 参数指定的长度的 UTF-8 字节序列，并返回一个字符串。</p>
	*<p>一般读取的是由 writeUTFBytes 方法写入的字符串。</p>
	*@param len 要读的buffer长度，默认将读取缓冲区全部数据。
	*@return 读取的字符串。
	*/
	__proto.getUTFBytes=function(len){
		(len===void 0)&& (len=-1);
		return this.readUTFBytes(len);
	}

	/**
	*<p>在字节流中写入一个字节。</p>
	*<p>使用参数的低 8 位。忽略高 24 位。</p>
	*@param value
	*/
	__proto.writeByte=function(value){
		this.ensureWrite(this._pos_+1);
		this._d_.setInt8(this._pos_,value);
		this._pos_+=1;
	}

	/**
	*@private
	*从字节流中读取带符号的字节。
	*/
	__proto.readByte=function(){
		if (this._pos_+1 > this._length)throw "readByte error - Out of bounds";
		return this._d_.getInt8(this._pos_++);
	}

	/**
	*<p>从字节流中读取带符号的字节。</p>
	*<p>返回值的范围是从-128 到 127。</p>
	*@return 介于-128 和 127 之间的整数。
	*/
	__proto.getByte=function(){
		return this.readByte();
	}

	/**
	*<p>保证该字节流的可用长度不小于 <code>lengthToEnsure</code> 参数指定的值。</p>
	*@param lengthToEnsure 指定的长度。
	*/
	__proto.ensureWrite=function(lengthToEnsure){
		if (this._length < lengthToEnsure)this._length=lengthToEnsure;
		if (this._allocated_ < lengthToEnsure)this.length=lengthToEnsure;
	}

	/**
	*<p>将指定 arraybuffer 对象中的以 offset 为起始偏移量， length 为长度的字节序列写入字节流。</p>
	*<p>如果省略 length 参数，则使用默认长度 0，该方法将从 offset 开始写入整个缓冲区；如果还省略了 offset 参数，则写入整个缓冲区。</p>
	*<p>如果 offset 或 length 小于0，本函数将抛出异常。</p>
	*$NEXTBIG 由于没有判断length和arraybuffer的合法性，当开发者填写了错误的length值时，会导致写入多余的空白数据甚至内存溢出，为了避免影响开发者正在使用此方法的功能，下个重大版本会修复这些问题。
	*@param arraybuffer 需要写入的 Arraybuffer 对象。
	*@param offset Arraybuffer 对象的索引的偏移量（以字节为单位）
	*@param length 从 Arraybuffer 对象写入到 Byte 对象的长度（以字节为单位）
	*/
	__proto.writeArrayBuffer=function(arraybuffer,offset,length){
		(offset===void 0)&& (offset=0);
		(length===void 0)&& (length=0);
		if (offset < 0 || length < 0)throw "writeArrayBuffer error - Out of bounds";
		if (length==0)length=arraybuffer.byteLength-offset;
		this.ensureWrite(this._pos_+length);
		var uint8array=new Uint8Array(arraybuffer);
		this._u8d_.set(uint8array.subarray(offset,offset+length),this._pos_);
		this._pos_+=length;
	}

	/**
	*获取此对象的 ArrayBuffer 数据，数据只包含有效数据部分。
	*/
	__getset(0,__proto,'buffer',function(){
		var rstBuffer=this._d_.buffer;
		if (rstBuffer.byteLength==this.length)return rstBuffer;
		return rstBuffer.slice(0,this.length);
	});

	/**
	*<p> <code>Byte</code> 实例的字节序。取值为：<code>BIG_ENDIAN</code> 或 <code>BIG_ENDIAN</code> 。</p>
	*<p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。通过 <code>getSystemEndian</code> 可以获取当前系统的字节序。</p>
	*<p> <code>BIG_ENDIAN</code> ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。有时也称之为网络字节序。<br/>
	*<code>LITTLE_ENDIAN</code> ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。</p>
	*/
	__getset(0,__proto,'endian',function(){
		return this._xd_ ? "littleEndian" :"bigEndian";
		},function(endianStr){
		this._xd_=(endianStr=="littleEndian");
	});

	/**
	*<p> <code>Byte</code> 对象的长度（以字节为单位）。</p>
	*<p>如果将长度设置为大于当前长度的值，则用零填充字节数组的右侧；如果将长度设置为小于当前长度的值，将会截断该字节数组。</p>
	*<p>如果要设置的长度大于当前已分配的内存空间的字节长度，则重新分配内存空间，大小为以下两者较大者：要设置的长度、当前已分配的长度的2倍，并将原有数据拷贝到新的内存空间中；如果要设置的长度小于当前已分配的内存空间的字节长度，也会重新分配内存空间，大小为要设置的长度，并将原有数据从头截断为要设置的长度存入新的内存空间中。</p>
	*/
	__getset(0,__proto,'length',function(){
		return this._length;
		},function(value){
		if (this._allocated_ < value)
			this.___resizeBuffer(this._allocated_=Math.floor(Math.max(value,this._allocated_ *2)));
		else if (this._allocated_ > value)
		this.___resizeBuffer(this._allocated_=value);
		this._length=value;
	});

	/**
	*移动或返回 Byte 对象的读写指针的当前位置（以字节为单位）。下一次调用读取方法时将在此位置开始读取，或者下一次调用写入方法时将在此位置开始写入。
	*/
	__getset(0,__proto,'pos',function(){
		return this._pos_;
		},function(value){
		this._pos_=value;
	});

	/**
	*可从字节流的当前位置到末尾读取的数据的字节数。
	*/
	__getset(0,__proto,'bytesAvailable',function(){
		return this._length-this._pos_;
	});

	Byte.getSystemEndian=function(){
		if (!Byte._sysEndian){
			var buffer=new ArrayBuffer(2);
			new DataView(buffer).setInt16(0,256,true);
			Byte._sysEndian=(new Int16Array(buffer))[0]===256 ? "littleEndian" :"bigEndian";
		}
		return Byte._sysEndian;
	}

	Byte.BIG_ENDIAN="bigEndian";
	Byte.LITTLE_ENDIAN="littleEndian";
	Byte._sysEndian=null;
	return Byte;
})()


//class game.base.utils.Map
var Map=(function(){
	function Map(){}
	__class(Map,'game.base.utils.Map');
	var __proto=Map.prototype;
	__proto.remove=function(key1){
		this[key1]=null;
		delete this[key1];
	}

	Map.putClass=function(obj,key,valueClass){
		if(obj[key]==null){
			obj[key]=new valueClass();
		}
		return obj[key];
	}

	Map.putValue=function(obj,key,value){
		if(obj[key]==null){
			obj[key]=value;
		}
		return obj[key];
	}

	return Map;
})()


//class game.base.utils.TabBind
var TabBind=(function(){
	function TabBind(tab,container,defaultIndex){
		this.tab=null;
		this.container=null;
		this.map=[];
		this.defaultIndex=0;
		(defaultIndex===void 0)&& (defaultIndex=0);
		this.defaultIndex=defaultIndex;
		this.container=container;
		this.tab=tab;
		Laya.timer.callLater(this,this.nextTime);
	}

	__class(TabBind,'game.base.utils.TabBind');
	var __proto=TabBind.prototype;
	__proto.nextTime=function(){
		this.tab.selectedIndex=-1;
		this.tab.selectHandler=new Handler(this,this.selectHandlerFun);
		this.tab.selectedIndex=this.defaultIndex;
	}

	__proto.selectHandlerFun=function(index){
		this.container.removeChildren();
		var tabBindData=this.map[index];
		if(tabBindData !=null){
			tabBindData.check();
			this.container.addChild(tabBindData.viewInstance);
		}
	}

	__proto.addTabCell=function(tabIndex,viewObject,mediatorClass){
		var tabBindData=new TabBindData();
		if(Laya.__isClass(viewObject)){
			tabBindData.viewClass=viewObject;
			}else {
			tabBindData.viewInstance=viewObject;
		}
		tabBindData.mediatorClass=mediatorClass;
		this.map[tabIndex]=tabBindData;
	}

	__proto.getTabCell=function(tabIndex){
		if((this.map [tabIndex])==null)return null;
		return (this.map [tabIndex]).viewInstance;
	}

	__proto.getTab=function(tabIndex){
		return this.tab.items [tabIndex];
	}

	return TabBind;
})()


//class game.base.utils.TabBindData
var TabBindData=(function(){
	function TabBindData(){
		this.tabIndex=0;
		this.viewClass=null;
		this.viewInstance=null;
		this.mediatorClass=null;
		this.mediatorInstance=null;
	}

	__class(TabBindData,'game.base.utils.TabBindData');
	var __proto=TabBindData.prototype;
	__proto.check=function(){
		if(this.viewClass && this.viewInstance==null){
			this.viewInstance=new this.viewClass();
		}
		if(this.mediatorClass && this.mediatorInstance==null){
			this.mediatorInstance=new this.mediatorClass(this.viewInstance);
		}
	}

	return TabBindData;
})()


//class game.mvc.Sender
var Sender=(function(){
	function Sender(){
		this.byte=null;
		this.actionId=0;
		this.byte=App.socketManager.sendByte;
	}

	__class(Sender,'game.mvc.Sender');
	var __proto=Sender.prototype;
	__proto.putByte=function(value){
		this.byte.writeByte(value);
	}

	__proto.putInt=function(value){
		this.byte.writeInt32(value);
	}

	__proto.putUtf=function(value){
		this.byte.writeUTFString(value);
	}

	__proto.putLong=function(i){
		this.putInt(i / 10000000);
		this.putInt(i % 10000000);
	}

	__proto.start=function(){
		this.byte.clear();
	}

	__proto.send=function(){
		App.socketManager.sendToServer();
	}

	__proto.setActionId=function(actionId){
		this.actionId=actionId;
	}

	__proto.startByAction=function(){
		this.start();
		this.putInt(this.actionId);
	}

	Sender.getLong=function(ba){
		return ba.readInt()*10000000+ba.readInt();
	}

	return Sender;
})()


//class game.mvc.CommandManager
var CommandManager=(function(){
	function CommandManager(){
		this.orderCMDClassArr=[];
	}

	__class(CommandManager,'game.mvc.CommandManager');
	var __proto=CommandManager.prototype;
	/**
	*按照顺序执行cmd 同一时刻只允许有一组
	*@param orderCMDClassArr
	*数组里面是类 每个类必须继承 OrderCommand command执行完后调用nextstep方法
	*/
	__proto.exeOrderCMD=function(orderCMDClassArr){
		this.orderCMDClassArr=orderCMDClassArr;
		App.eventManager.on("ORDER_CMD_NEXT",this,this.executeOver);
		this.executeOne();
	}

	__proto.executeOver=function(){
		if(this.orderCMDClassArr.length !=0){
			this.executeOne();
			}else{
			App.eventManager.off("ORDER_CMD_NEXT",this,this.executeOver);
		}
	}

	__proto.executeOne=function(){
		var cmd=this.orderCMDClassArr.shift();
		if((cmd instanceof Array)){
			App.exeCMD(cmd[0],cmd[1]);
			}else{
			App.exeCMD(cmd);
		}
	}

	return CommandManager;
})()


//class game.mvc.Mediator
var Mediator=(function(){
	function Mediator(sprite){
		this.sprite=null;
		this.autoEvent=null;
		this.sprite=sprite;
		App.injOne(this);
		this.autoEvent=new AutoEvent(sprite);
	}

	__class(Mediator,'game.mvc.Mediator');
	return Mediator;
})()


//class game.mvc.SceneMediator
var SceneMediator=(function(){
	function SceneMediator(sprite,mediatorData){
		this.sprite=null;
		this.autoEvent=null;
		this.mediatorData=null;
		this.mediatorData=mediatorData;
		this.sprite=sprite;
		App.injOne(this);
		this.autoEvent=new AutoEvent(sprite);
	}

	__class(SceneMediator,'game.mvc.SceneMediator');
	var __proto=SceneMediator.prototype;
	__proto.resume=function(mediatorData){}
	return SceneMediator;
})()


//class huamao.ActionId
var ActionId=(function(){
	function ActionId(){}
	__class(ActionId,'huamao.ActionId');
	ActionId.HEART=0;
	ActionId.ERRORTIPS=1;
	ActionId.CHANGE_SERVER=2;
	ActionId.KickingOffTheLine=3;
	ActionId.Banned=4;
	ActionId.LOGIN=1001;
	ActionId.MAPCITY=1002;
	ActionId.SHOUFEN=1003;
	ActionId.PlayerInfo=1004;
	ActionId.RANK=1005;
	ActionId.MAIL=1006;
	ActionId.FRIEND=1007;
	ActionId.SIGNIN=1008;
	ActionId.SevenTask=4001;
	ActionId.HUOYUEDAY=4002;
	ActionId.SETTING=1010;
	ActionId.ZHAOMU=3001;
	ActionId.SHOP=2001;
	ActionId.STRATAGEM=2002;
	ActionId.InitServerTime=2003;
	ActionId.WUJIANG=3002;
	ActionId.BAG=2004;
	ActionId.FLUSHPLAYERNUM=2005;
	ActionId.TALK=2006;
	ActionId.GUIDE=2007;
	ActionId.PAOMA=2008;
	ActionId.DUOBAO=2009;
	ActionId.HERO_TEAM=3003;
	ActionId.ARMS=3004;
	ActionId.TASK=3005;
	ActionId.NewPlayerTASK=3006;
	ActionId.GPlayerTASK=3007;
	ActionId.RECHARGE=1009;
	ActionId.JIJINLEIJI=1011;
	ActionId.VICTORY_BOX=5001;
	ActionId.MD5API=1012;
	ActionId.UNION=1013;
	return ActionId;
})()


//class huamao.entity.ActionData
var ActionData=(function(){
	function ActionData(){
		this.actionId=NaN;
		//唯一id
		this.battleId=0;
		this.battleFileUrl="";
		/**1:出征自己城池,2:出征盟友城池,3:出征敌方城池*/
		this.actionType=0;
		this.actionPlayerId=0;
		/**出发城池*/
		this.fromId=0;
		/**目标城池*/
		this.toId=0;
		this.isWeixian=0;
		this.remainingTime=0;
		this.jiasuTimes=0;
		this.yubeiyiNum=0;
		this.heroList=[];
		this.endTime=0;
	}

	__class(ActionData,'huamao.entity.ActionData');
	return ActionData;
})()


//class huamao.entity.AssessData
var AssessData=(function(){
	function AssessData(){
		this.heroId=0;
		//问题一
		this.num11=0;
		this.num12=0;
		this.num13=0;
		this.num14=0;
		//问题二
		this.num21=0;
		this.num22=0;
		this.num23=0;
		this.num24=0;
		//问题三
		this.num31=0;
		this.num32=0;
		this.num33=0;
		this.num34=0;
	}

	__class(AssessData,'huamao.entity.AssessData');
	var __proto=AssessData.prototype;
	__proto.getIndex=function(ary){
		var tt=0;
		var result=0;
		for(var i=0;i<ary.length;i++){
			if(ary[i] > tt){
				tt=ary[i];
				result=i;
			}
		}
		return result;
	}

	__proto.getQuestionPer=function(type){
		var ary=[];
		var textary=[];
		switch(type){
			case 1:
				ary=[this.num11,this.num12,this.num13,this.num14];
				textary=["1.前期便可以开始培养，后期也很厉害","2.前期可以培养，但后期只能做副将","3.前期不适合培养，升入更高区再培养","4.该武将不强，任何阶段都不值得培养"];
				break ;
			case 2:
				ary=[this.num21,this.num22,this.num23,this.num24];
				textary=["1.配合组合技或升星有了闪避后，可放在前排，否则站后排","2.该武将挺肉，不管有没有闪避又可以持刀或持剑站在前排","3.该武将是输出型，攻击高防御低，应站在后排","4.可前可后，没有足够的前排可放前排，也可持枪或扇站后排"];
				break ;
			case 3:
				ary=[this.num31,this.num32,this.num33,this.num34];
				var syshero=ConfigManager.getConfig("sys_hero.txt",this.heroId);
				textary=syshero.getForceNameArr();
				break ;
			};
		var i=this.getIndex(ary);
		var all=ary[0]+ary[1]+ary[2]+ary[3];
		var tt=0;
		if(all !=0){
			tt=Math.floor(ary[i] / all *100);
		}
		return [i,tt,textary[i]];
	}

	return AssessData;
})()


//class huamao.entity.BagItemData
var BagItemData=(function(){
	function BagItemData(){
		this.onlyId=0;
		//唯一id
		this.playerId=0;
		this.heroId=0;
		//英雄id 这个物品在谁身上 0就是背包里
		this.itemId=0;
		this.itemNum=0;
		this.lv=0;
		//物品强化等级
		this.isLock=0;
		//是否锁定 0:未锁定 1:锁定
		this.overTime=0;
	}

	__class(BagItemData,'huamao.entity.BagItemData');
	var __proto=BagItemData.prototype;
	//到期时间
	__proto.getSysStrenght=function(){
		var sysitem=ConfigManager.getConfig("sys_item.txt",this.itemId);
		var color=sysitem.itemColor;
		var sysStrength=ConfigManager.getConfig("sys_strength.txt",color+"_"+this.lv);
		return sysStrength;
	}

	//当前是不是最高等级
	__proto.ifMaxStep=function(){
		return (this.getSysStrenght().strengthItemNum==-1)
	}

	__proto.getSysItem=function(){
		var sysItem=ConfigManager.getConfig("sys_item.txt",this.itemId);
		return sysItem;
	}

	//type 0:当前属性 1:下一级属性
	__proto.getShuXing=function(type){
		var result=[];
		var sysEquip=ConfigManager.getConfig("sys_equip.txt",this.itemId);
		var sysItem=ConfigManager.getConfig("sys_item.txt",this.itemId);
		var color=sysItem.itemColor;
		var sysStrength=ConfigManager.getConfig("sys_strength.txt",color+"_"+this.lv);
		var k=0;
		if(type==0){
			k=sysStrength.strengthAttrCurrent;
			}else{
			k=sysStrength.strengthAttrBonus;
		}
		if(sysEquip !=null){
			result=sysEquip.getAry();
			for(var i=0;i<result.length;i+=2){
				result[i+1]=Math.ceil(result[i+1]*(k+1000)/1000);
			}
		}
		return result;
	}

	/**
	*@return
	*是否空闲
	*/
	__proto.isEmpty=function(){
		return this.heroId==0;
	}

	__proto.getBigType=function(){
		var sys=ConfigManager.getConfig("sys_item.txt",this.itemId);
		return sys.itemType;
	}

	__proto.lock=function(){
		return this.isLock==1;
	}

	return BagItemData;
})()


//class huamao.entity.BattleReportData
var BattleReportData=(function(){
	function BattleReportData(){
		this.battleId=NaN;
		this.cityId=0;
		this.startTime=0;
		this.endTime=0;
		this.actionId=NaN;
		this.remainingTime=0;
		this.battleFileUrl=null;
	}

	__class(BattleReportData,'huamao.entity.BattleReportData');
	return BattleReportData;
})()


//class huamao.entity.BuildData
var BuildData=(function(){
	function BuildData(){
		this.cityId=0;
		/**0:太守府,1:民居,2:集市,3:农田*/
		this.type=0;
		/**0:太守府，1-10对应的位置*/
		this.index=0;
		this.lv=0;
		this.endTime=0;
		this.time=0;
		this.isHas=0;
		this.sysBuilding=null;
	}

	__class(BuildData,'huamao.entity.BuildData');
	return BuildData;
})()


//class huamao.entity.ChatData
var ChatData=(function(){
	function ChatData(){
		this.msgType=0;
		this.fromId=0;
		this.toId=0;
		this.isSelf=false;
		this._content=null;
		this.time=0;
	}

	__class(ChatData,'huamao.entity.ChatData');
	var __proto=ChatData.prototype;
	__getset(0,__proto,'content',function(){
		return this._content;
		},function(value){
		this._content=value;
	});

	ChatData.FRIEND_MSG=0;
	ChatData.BATTLE_REPORT=1;
	return ChatData;
})()


//class huamao.entity.ChuzhengParam
var ChuzhengParam=(function(){
	function ChuzhengParam(){
		this.chuzhengType=0;
		this.fromId=0;
		this.toId=0;
		this.juli=0;
		this.jicetype=0;
	}

	__class(ChuzhengParam,'huamao.entity.ChuzhengParam');
	var __proto=ChuzhengParam.prototype;
	__proto.setData=function(cType,fId,tId,distance,type){
		(type===void 0)&& (type=0);
		this.chuzhengType=cType;
		this.fromId=fId;
		this.toId=tId;
		this.juli=distance;
		this.jicetype=type;
	}

	__proto.reset=function(){
		this.chuzhengType=-1;
		this.fromId=-1;
		this.toId=-1;
		this.juli=-1;
		this.jicetype=-1;
	}

	return ChuzhengParam;
})()


//class huamao.entity.CityData
var CityData=(function(){
	function CityData(){
		// public var yy:Number;
		this.playerId=0;
		//是谁的id就是谁的城
		this.level=0;
		this.cityId=0;
		this.yubeiyiNum=0;
		this.heroNum=0;
		this.childNum=0;
		this.sysCity=null;
		this.battleFileUrl="";
		//battleId>0 在战斗中 根据战斗时间移除
		this.zhenchaTime=0;
		this.xiefangHeroNum=0;
		this.xiefangChildNum=0;
		this.playerType=CityPlayerType.ENEMY;
		this.heroObj=new Object();
		this.xiefangHeroObj=new Object();
	}

	__class(CityData,'huamao.entity.CityData');
	var __proto=CityData.prototype;
	__proto.clear=function(){
		var data;
		for(var $each_data in this.xiefangHeroObj){
			data=this.xiefangHeroObj[$each_data];
			data.cityId=0;
			data.soldier=0;
		}
		var $each_data;
		for($each_data in this.heroObj){
			data=this.heroObj[$each_data];
			data.cityId=0;
			data.soldier=0;
		}
	}

	__getset(0,__proto,'heroList',function(){
		var arr=[];
		var data;
		for(var $each_data in this.xiefangHeroObj){
			data=this.xiefangHeroObj[$each_data];
			arr.push(data);
		}
		arr.sort(function(a,b){
			return a.index-b.index;
		});
		var arr1=[];
		var $each_data;
		for($each_data in this.heroObj){
			data=this.heroObj[$each_data];
			arr1.push(data);
		}
		arr1.sort(function(a,b){
			return a.index-b.index;
		});
		arr=arr.concat(arr1);
		return arr;
	});

	return CityData;
})()


//class huamao.entity.CityListData
var CityListData=(function(){
	function CityListData(){
		this.cityId=0;
		//城池id
		this.cityLv=0;
		//城池等级
		this.ifMainCityUp=0;
		//太守府升级中 1：是 0：否
		this.ifCityUp=0;
		//建筑升级中 1：是 0：否
		this.mjNum=0;
		this.sjNum=0;
		this.ntNum=0;
		this.pjLv=0;
		//建筑平均等级
		this.soldier=0;
		//预备役
		this.heroNum=0;
		//驻守武将数量
		this.heroSoldier=0;
		//驻守武将带兵数
		this.soldierOutPut=0;
		//预备役产量（小时）
		this.time=0;
	}

	__class(CityListData,'huamao.entity.CityListData');
	var __proto=CityListData.prototype;
	//城池获得时间
	__proto.checkCityUp=function(){
		return (this.ifCityUp==1);
	}

	__proto.checkMainCityUp=function(){
		return (this.ifMainCityUp==1);
	}

	return CityListData;
})()


//class huamao.entity.CityPlayerData
var CityPlayerData=(function(){
	function CityPlayerData(){
		this.playerId=0;
		this.groupId=0;
		this.playerName=null;
		this.firstCityId=0;
		this.cityFlag=null;
		/**0空城1自己2盟友3敌人*/
		this.playerType=0;
		this.inviteToPlayerId=0;
		//我邀请了谁同盟
		this.inviteFromPlayerList=[];
		//谁邀请了我同盟
		this.tongqian=0;
		this.liangcao=0;
		this.headId=0;
		//头像
		this.guanzhiId=0;
		//官职id
		this.playerLv=0;
		//等级
		this.mengyouId=0;
		//盟友id
		this.diduidu=0;
		//敌对度
		this.isChoudi=0;
		//是否是仇敌 1是 0 不是
		this.isBaijiang=0;
		//是否是败将 1是 0不是
		this.hasBorder=false;
	}

	__class(CityPlayerData,'huamao.entity.CityPlayerData');
	var __proto=CityPlayerData.prototype;
	//从邀请列表删除
	__proto.removeFromPlayerList=function(playerid){
		var t=[];
		for(var i=0;i<this.inviteFromPlayerList.length;i++){
			if(this.inviteFromPlayerList[i] !=playerid){
				t.push(this.inviteFromPlayerList[i]);
			}
		}
		this.inviteFromPlayerList=t;
	}

	__getset(0,__proto,'maxCityNum',function(){
		var mapCitySession=App.getSession("mapCitySession");
		var arr=mapCitySession.getCitysByPlayerId(this.playerId);
		return arr.length;
	});

	__getset(0,__proto,'pName',function(){
		return this.playerName==null ? "空" :this.playerName;
	});

	return CityPlayerData;
})()


//class huamao.entity.DianZanData
var DianZanData=(function(){
	function DianZanData(){
		this.playerId=0;
		this.playerName=null;
		this.playerStyle=0;
		/**
		*0是未点 1是点赞
		*/
		this.isZan=0;
	}

	__class(DianZanData,'huamao.entity.DianZanData');
	return DianZanData;
})()


//class huamao.entity.FriendData
var FriendData=(function(){
	function FriendData(){
		this.friendId=0;
		this.friendName=null;
		this.style=0;
		this.head=0;
		this.isTop=0;
		this.beizhu=null;
		this.state=0;
		this.isOnLine=0;
		this.lastTime=0;
		this.isFriend=0;
		this.battleId=NaN;
		this.battleEndTime=0;
		this.battleFileUrl="";
	}

	__class(FriendData,'huamao.entity.FriendData');
	var __proto=FriendData.prototype;
	__proto.checkState=function(v){
		return (this.state & v)!=0;
	}

	return FriendData;
})()


//class huamao.entity.GameOverData
var GameOverData=(function(){
	function GameOverData(){
		this.year=0;
		this.killEnemyNum=0;
		this.maxCityNum=0;
		this.timeExp=0;
		this.tongyiReward=0;
		this.dutongReward=0;
		this.type=0;
		this.playerName=null;
		this.grade=0;
		this.bawang=0;
		this.zhanshen=0;
		this.zhizhe=0;
		this.xibai=0;
		this.dizanList=[];
		/**0未达成 1未领取 2已领取*/
		this.taskType=0;
	}

	__class(GameOverData,'huamao.entity.GameOverData');
	return GameOverData;
})()


//class huamao.entity.HeroTeamData
var HeroTeamData=(function(){
	function HeroTeamData(){
		this.teamIndex=0;
		this.teamName=null;
		this.heroIdArr=[];
	}

	__class(HeroTeamData,'huamao.entity.HeroTeamData');
	return HeroTeamData;
})()


//class huamao.entity.JianbaoData
var JianbaoData=(function(){
	function JianbaoData(){
		this.battleId=NaN;
		this.cityId=0;
		this.isWin=0;
		this.attName=null;
		this.attBingli=0;
		this.attLoseBingli=0;
		this.defName=null;
		this.defBingli=0;
		this.defLoseBingli=0;
		this.exp=0;
		this.deltaExp=0;
		this.battleFileUrl=null;
	}

	__class(JianbaoData,'huamao.entity.JianbaoData');
	return JianbaoData;
})()


//class huamao.entity.LingQiData
var LingQiData=(function(){
	function LingQiData(){
		this.uid=null;
		this.uname=null;
		this.time=0;
		this.ext_sdk=null;
		this.sign=null;
		this.sign_type=null;
	}

	__class(LingQiData,'huamao.entity.LingQiData');
	return LingQiData;
})()


//class huamao.entity.LoadResData
var LoadResData=(function(){
	function LoadResData(){
		this.value=NaN;
		this.text1="";
		this.text2="";
	}

	__class(LoadResData,'huamao.entity.LoadResData');
	return LoadResData;
})()


//class huamao.entity.MailData
var MailData=(function(){
	function MailData(){
		/**邮件ID*/
		this.mailId=0;
		/**邮件类型*/
		this.mailType=0;
		/**0未读 1已读 2已读并且领取*/
		this.isRead=0;
		/**标题*/
		this.mailTitle=null;
		/**内容 有可能是内容里面的人物名字 具体ID具体使用 战况 战况ID，名字*/
		this.mailContent=null;
		/**物品ID，数量*/
		this.item=null;
		/**邮件时间(秒)*/
		this.time=0;
		/**物品数据*/
		this.itemArr=[];
		/**内容里面发来的数据数据*/
		this.contentArr=[];
	}

	__class(MailData,'huamao.entity.MailData');
	return MailData;
})()


//class huamao.entity.OtherTalkData
var OtherTalkData=(function(){
	function OtherTalkData(){
		//联盟
		this.channelId=0;
		//发送频道
		this.paoBg=0;
		//聊天背景泡泡类型
		this.playerid=0;
		//玩家id
		this.playerset=0;
		//0：官职 1：国家 2联盟
		this.playerstyle=0;
		//玩家类型
		this.playerName=null;
		//玩家名字
		this.playerJob=0;
		//玩家官职
		this.playerCountry=0;
		//玩家所属国际
		this.playerCollege=0;
		//玩家所属学院
		this.ColleageName=null;
		//联盟名字
		this.battleId=null;
		//战报url
		this._content=null;
		//发送内容
		this.time=0;
	}

	__class(OtherTalkData,'huamao.entity.OtherTalkData');
	var __proto=OtherTalkData.prototype;
	__proto.getJobHtml=function(){
		var result="";
		if(this.playerset==0){
			var systitleplayer=ConfigManager.getConfig("sys_title_player.txt",this.playerJob);
			var jobName=systitleplayer.titleName;
			result=TheGame.FONT("【"+jobName+"】","#f79646",22,SysTalkData.font);
			}else if(this.playerset==1){
			result=TheGame.FONT("【"+"国家"+"】","#38b0dc",22,SysTalkData.font);
			}else if(this.playerset==2){
			result=TheGame.FONT("【"+this.ColleageName+"】","#f79646",22,SysTalkData.font);
		}
		return result;
	}

	__proto.getNameHtml=function(){
		var result=this.getJobHtml()+TheGame.FONT(this.playerName,"#e9cc7c",22,SysTalkData.font);
		return result;
	}

	__proto.getContentHtml=function(paobg){
		var result;
		var contentcolor=((paobg==0)? "#d2af82" :"#483713");
		if(this.battleId !=null && this.battleId.length > 0){
			var hrefstr="battleId:"+this.battleId;
			result=(TheGame.FONT("我分享了一份战报",contentcolor,22,SysTalkData.font)+"<span style='"+"fontSize:21' "+"color='#feae24' "+"href='"+hrefstr+"'>"+"战报</span>");
			}else{
			result=TheGame.FONT(this.content,contentcolor,22,SysTalkData.font);
		}
		return result;
	}

	__proto.getSysHtml=function(){
		var result;
		var channelstr="";
		var chanelcolor="";
		switch(this.channelId){
			case 0:
				channelstr="【系统】";
				chanelcolor="#e3714d";
				break ;
			case 1:
				channelstr="【当前】";
				chanelcolor="#d8ce79";
				break ;
			case 2:
				channelstr="【世界】";
				chanelcolor="#7993d8";
				break ;
			case 3:
				channelstr="【国家】";
				chanelcolor="#4dbbef";
				break ;
			case 4:
				channelstr="【队伍】";
				chanelcolor="#53e06e";
				break ;
			case 5:
				channelstr="【联盟】";
				chanelcolor="#d879c9";
				break ;
			}
		result=TheGame.FONT(channelstr,chanelcolor,22,SysTalkData.font);
		result+=(this.getJobHtml()+TheGame.FONT(this.playerName+":","#e9cc7c",22,SysTalkData.font));
		if(this.battleId!=null && this.battleId.length > 0){
			var hrefstr="battleId:"+this.battleId;
			result+=(TheGame.FONT("我分享了一份战报","#d2af82",22,SysTalkData.font)+"<span style='"+"fontSize:21' "+"color='#feae24' "+"href='"+hrefstr+"'>"+"战报</span>");
			}else{
			result+=TheGame.FONT(this.content,"#d2af82",22,SysTalkData.font);
		}
		return result;
	}

	//内容
	__getset(0,__proto,'content',function(){
		return this._content;
		},function(value){
		this._content=value;
		console.log(this._content);
	});

	OtherTalkData.SYS=0;
	OtherTalkData.CURRENT=1;
	OtherTalkData.WORD=2;
	OtherTalkData.COUNTRY=3;
	OtherTalkData.TEAM=4;
	OtherTalkData.COLEAGE=5;
	OtherTalkData.jobColor="#f79646";
	OtherTalkData.contryColor="#38b0dc";
	OtherTalkData.lianMengColor="#f79646";
	OtherTalkData.nameColor="#e9cc7c";
	OtherTalkData.contentColor1="#d2af82";
	OtherTalkData.contentColor2="#483713";
	return OtherTalkData;
})()


//class huamao.entity.PlayerData
var PlayerData=(function(){
	function PlayerData(){
		this.playerId=0;
		this.playerName=null;
		this.Lv=0;
		this.style=0;
		this.exp=0;
		/**元宝*/
		this.gold=0;
		/**银两*/
		this.silver=0;
		this.heroExp=0;
		this.job=0;
		this.jobScore=0;
		this.gameTimes=0;
		// 参与局数
		this.winTimes=0;
		// 统一次数
		this.tortoise=0;
		// 霸王
		this.mars=0;
		// 战神
		this.wise=0;
		// 智者
		this.defeat=0;
		// 惜败
		this.cityStyle=0;
		// 城池外观
		this.headFrame=0;
		// 头像框
		this.banner=0;
		// 旗帜
		this.resetCount=0;
		// 每月重置次数
		this.vipId=[];
		//vipId 可以是多个ID
		this.createTime=0;
	}

	__class(PlayerData,'huamao.entity.PlayerData');
	return PlayerData;
})()


//class huamao.entity.PropertyChangeData
var PropertyChangeData=(function(){
	function PropertyChangeData(){
		this.heroId=0;
		this.force=0;
		this.resist=0;
		this.wisdom=0;
		this.might=0;
		//
		this.attack=0;
		this.defense=0;
		this.stratagemAttack=0;
		this.stratagemDefense=0;
		this.soldierMax=0;
		this.crit=0;
		this.dodge=0;
		this.insight=0;
		this.parry=0;
		//
		this.damageAdd=0;
		this.attackDamageAdd=0;
		this.stratagemDamageAdd=0;
		this.damageReduce=0;
		this.attackDamageReduce=0;
		this.stratagemDamageReduce=0;
		this.critDamageAdd=0;
		this.dataArr=[];
	}

	__class(PropertyChangeData,'huamao.entity.PropertyChangeData');
	var __proto=PropertyChangeData.prototype;
	__proto.setBa=function(ba){
		this.dataArr.length=0;
		for (var i=0;i < PropertyChangeData.arr.length;i++){
			this.dataArr.push(ba.readInt());
		}
	}

	__static(PropertyChangeData,
	['arr',function(){return this.arr=["勇","御","智","威",
		"物理攻击","物理防御","计策攻击","计策防御",
		"带兵上限",
		"暴击率","闪避率","识破率",
		"物伤减免","策伤减免","伤害减免"];}
	]);
	return PropertyChangeData;
})()


//class huamao.entity.QiYouData
var QiYouData=(function(){
	function QiYouData(){
		this.username=null;
		this.logintime=0;
		this.token=null;
	}

	__class(QiYouData,'huamao.entity.QiYouData');
	return QiYouData;
})()


//class huamao.entity.RankData
var RankData=(function(){
	function RankData(){
		this.playerId=0;
		this.index=0;
		this.type=0;
		this.playerName=null;
		this.job=0;
		this.playerLv=0;
		this.jobScore=0;
		this.praise=0;
	}

	__class(RankData,'huamao.entity.RankData');
	return RankData;
})()


//class huamao.entity.ShouFenData
var ShouFenData=(function(){
	function ShouFenData(){
		this.battleId=NaN;
		/**0好友1地图战报*/
		this.type=0;
		this.dateTime=0;
		this.cityId=0;
		/**0进攻或挑战1防守或应战*/
		this.battleType=0;
		/**1失败0胜利*/
		this.result=0;
		this.attackName=null;
		this.attackBingli=0;
		this.attackLoseBingli=0;
		this.defenseName=null;
		this.defenseBingli=0;
		this.defenseLoseBingli=0;
		this.exp=0;
		this.deltaExp=0;
		this.battleFileUrl=null;
	}

	__class(ShouFenData,'huamao.entity.ShouFenData');
	return ShouFenData;
})()


//class huamao.entity.SiSanData
var SiSanData=(function(){
	function SiSanData(){
		this.gameId=0;
		this.userId=0;
		this.userName=null;
		this.time=0;
		this.sign=null;
	}

	__class(SiSanData,'huamao.entity.SiSanData');
	return SiSanData;
})()


//class huamao.entity.StudyData
var StudyData=(function(){
	function StudyData(){
		this.forceId=0;
		this.itemId=0;
		this.itemNum=0;
	}

	__class(StudyData,'huamao.entity.StudyData');
	return StudyData;
})()


//class huamao.entity.SysTalkData
var SysTalkData=(function(){
	function SysTalkData(){
		//"隶书"
		this.playerName=null;
		//玩家名字
		this.type=0;
		//系统聊天类型
		this.cityId=0;
		//城市id
		this.time=0;
		//发送时间s
		this.leftCD=0;
	}

	__class(SysTalkData,'huamao.entity.SysTalkData');
	var __proto=SysTalkData.prototype;
	//[系统][小时:分钟]
	__proto.getPubStr=function(typeT){
		var result="";
		result=TheGame.FONT("【系统】","#e3714d",22,SysTalkData.font);
		var timestr=GameUtils.timeFormat(this.time,3);
		result+=TheGame.FONT("【"+timestr+"】","#d2af82",22,SysTalkData.font);
		return result;
	}

	__proto.getCityStr=function(){
		var result="";
		var syscity=ConfigManager.getConfig("sys_city.txt",this.cityId);
		var cityname=syscity.cityName;
		result=TheGame.FONT(cityname,"#feae24",22,SysTalkData.font);
		return result;
	}

	__proto.getNameStr=function(){
		return TheGame.FONT(this.playerName,"#70be09",22,SysTalkData.font);
	}

	//名字+加入该战局
	__proto.getKaiJuStr=function(typeT){
		var result=this.getPubStr(typeT);
		result+=this.getNameStr();
		result+=TheGame.FONT("加入该战局","#d2af82",22,SysTalkData.font);
		return result;
	}

	//xxxx的大军正向XX进发，还有（全程/4/1）分钟到达，大战即将来临
	__proto.getFaBingStr=function(typeT){
		var result=this.getPubStr(typeT);
		result+=this.getNameStr();
		result+=TheGame.FONT("的大军正向","#d2af82",22,SysTalkData.font);
		result+=this.getCityStr();
		result+=TheGame.FONT("进发，还有","#d2af82",22,SysTalkData.font);
		result+=TheGame.FONT(this.leftCD+"分钟","#e20604",22,SysTalkData.font);
		result+=TheGame.FONT("到达，大战即将来临","#d2af82",22,SysTalkData.font);
		return result;
	}

	//XX发生战斗
	__proto.getFightStr=function(typeT){
		var result=this.getPubStr(typeT);
		result+=this.getCityStr();
		result+=TheGame.FONT("发生战斗","#d2af82",22,SysTalkData.font);
		return result;
	}

	//经过一番鏖战，xxxx的部队成功占领了XX
	__proto.getFightWinStr=function(typeT){
		var result=this.getPubStr(typeT);
		result+=TheGame.FONT("经过一番鏖战,","#d2af82",22,SysTalkData.font);
		result+=this.getNameStr();
		result+=TheGame.FONT("的部队成功占领了","#d2af82",22,SysTalkData.font);
		result+=this.getCityStr();
		return result;
	}

	//经过连番大战，xxxx的部队未能成功占领XX，全军覆没
	__proto.getFightFailStr=function(typeT){
		var result=this.getPubStr(typeT);
		result+=TheGame.FONT("经过连番大战,","#d2af82",22,SysTalkData.font);
		result+=this.getNameStr();
		result+=TheGame.FONT("的部队未能成功占领","#d2af82",22,SysTalkData.font);
		result+=this.getCityStr();
		result+=TheGame.FONT(",全军覆没","#d2af82",22,SysTalkData.font);
		return result;
	}

	//本局人数不足，您或者与盟友的城池数达到8座获胜。
	__proto.getOnlyMeBeforStart=function(typeT){
		var result=this.getPubStr(typeT);
		result+=TheGame.FONT("本局人数不足，您或者与盟友的城池数达到","#d2af82",22,SysTalkData.font);
		result+=TheGame.FONT(this.cityId+"","#feae24",22,SysTalkData.font);
		result+=TheGame.FONT("座获胜。","#d2af82",22,SysTalkData.font);
		return result;
	}

	//type:true:ui false:mainUI
	__proto.getSysHtml=function(typeT){
		(typeT===void 0)&& (typeT=true);
		var result="";
		switch(this.type){
			case 0:
				result=this.getKaiJuStr(typeT);
				break ;
			case 1:
				result=this.getFaBingStr(typeT);
				break ;
			case 2:
				result=this.getFightStr(typeT);
				break ;
			case 3:
				result=this.getFightWinStr(typeT);
				break ;
			case 4:
				result=this.getFightFailStr(typeT);
				break ;
			case 5:
				result=this.getOnlyMeBeforStart(typeT);
				break ;
			}
		return result;
	}

	SysTalkData.KAIJU=0;
	SysTalkData.FABING=1;
	SysTalkData.FIGHT=2;
	SysTalkData.FIGHT_WIN=3;
	SysTalkData.GIGHT_FAIL=4;
	SysTalkData.ONLY_ME_IN_MAP=5;
	SysTalkData.fontsize=22;
	SysTalkData.pubColor="#d2af82";
	SysTalkData.nameColor="#70be09";
	SysTalkData.contentColor="#d2af82";
	SysTalkData.cityColor="#feae24";
	SysTalkData.CDColor="#e20604";
	SysTalkData.font=null;
	return SysTalkData;
})()


//class huamao.entity.TplayerScorelog
var TplayerScorelog=(function(){
	function TplayerScorelog(){
		// public var playerId:int;
		this.type=0;
		// 类型
		this.name=null;
		this.lv=0;
		// 等级
		this.job=0;
		// 官职
		this.jobScore=0;
		// 官职积分
		this.exp=0;
		// 君主经验
		this.straight=0;
		// 连败
		this.addTime=0;
	}

	__class(TplayerScorelog,'huamao.entity.TplayerScorelog');
	return TplayerScorelog;
})()


//class huamao.entity.ViewPlayerMesData
var ViewPlayerMesData=(function(){
	function ViewPlayerMesData(){
		this.playerId=0;
		this.playerName=null;
		this.playerLv=0;
		this.tortoise=0;
		// 霸王
		this.mars=0;
		// 战神
		this.wise=0;
		// 智者
		this.defeat=0;
		// 惜败
		this.playerJob=0;
		//当前职位
		this.heroNum=0;
		//武将数量
		this.gameTimes=0;
		// 参与局数
		this.winTimes=0;
		// 统一次数
		this.style=0;
	}

	__class(ViewPlayerMesData,'huamao.entity.ViewPlayerMesData');
	return ViewPlayerMesData;
})()


//class huamao.entity.WanH5Data
var WanH5Data=(function(){
	function WanH5Data(){
		this.pkey=0;
		this.gkey=0;
		this.openid="";
		this.time=0;
		this.guest=0;
		this.issubscribe=0;
		this.sign="";
	}

	__class(WanH5Data,'huamao.entity.WanH5Data');
	return WanH5Data;
})()


//class huamao.entity.XuYangData
var XuYangData=(function(){
	function XuYangData(){
		this.accountName=null;
		this.uid=null;
		this.token=null;
		this.sdkVersionCode=null;
		this.gid=null;
		this.sign=null;
	}

	__class(XuYangData,'huamao.entity.XuYangData');
	return XuYangData;
})()


//class huamao.entity.ZhanBaoData
var ZhanBaoData=(function(){
	function ZhanBaoData(){
		this.battleId=NaN;
		this.startTime=0;
		this.cityId=0;
		this.isAttack=0;
		this.secondName=null;
		this.isWin=0;
		/**0未读1已读*/
		this.isRead=0;
	}

	__class(ZhanBaoData,'huamao.entity.ZhanBaoData');
	return ZhanBaoData;
})()


//class huamao.entity.ZuduiPlayerData
var ZuduiPlayerData=(function(){
	function ZuduiPlayerData(){
		this.playerId=0;
		this.playerName=null;
		this.style=0;
		this.head=0;
		this.isOnLine=0;
		this.isInvited=0;
	}

	__class(ZuduiPlayerData,'huamao.entity.ZuduiPlayerData');
	return ZuduiPlayerData;
})()


//class huamao.Mypanel
var Mypanel=(function(){
	function Mypanel(){}
	__class(Mypanel,'huamao.Mypanel');
	Mypanel.DIALOG_TASK="DIALOG_TASK";
	Mypanel.DIALOG_ZHAO_MU="DIALOG_ZHAO_MU";
	Mypanel.DIALOG_SHOP="DIALOG_SHOP";
	Mypanel.DIALOG_BAG="DIALOG_BAG";
	Mypanel.DIALOG_STRATAGEM="DIALOG_STRATAGEM";
	Mypanel.CITY_BUILD_LVUP="CITY_BUILD_LVUP";
	Mypanel.CITY_BUILD_CREATE="CITY_BUILD_CREATE";
	Mypanel.CITY_BUDUI="CITY_BUDUI";
	Mypanel.CITY_BUDUI_DIAOBING="CITY_BUDUI_DIAOBING";
	Mypanel.CHUZHENG="CHUZHENG";
	Mypanel.REMOVE_BUILD="REMOVE_BUILD";
	Mypanel.WUJIANG="WUJIANG";
	Mypanel.WUJIANGSHUOMING="WUJIANGSHUOMING";
	Mypanel.SELECT_WUJIANG="SELECT_WUJIANG";
	Mypanel.XINGJUN_LIST="XINGJUN_LIST";
	Mypanel.YUNSHU_BINGLI="YUNSHU_BINGLI";
	Mypanel.GAME_OVER="GAME_OVER";
	Mypanel.QINGBAO="QINGBAO";
	Mypanel.WAIJIAO="WAIJIAO";
	Mypanel.WORLDMAP="WORLDMAP";
	Mypanel.ZHANBAO="ZHANBAO";
	Mypanel.JIANBAO="JIANBAO";
	Mypanel.CHENGCHI="CHENGCHI";
	Mypanel.DIANZAN="DIANZAN";
	Mypanel.DIANZAN2="DIANZAN2";
	Mypanel.BINGLIJJ="BINGLIJJ";
	Mypanel.MYMESSAGE="MYMESSAGE";
	Mypanel.MJLPANEL="MJLPANEL";
	Mypanel.MJLSHUOMING="MJLSHUOMING";
	Mypanel.YAOQING_ZUDUI="YAOQING_ZUDUI";
	Mypanel.HAOYOU="HAOYOU";
	Mypanel.ADDHAOYOU="ADDHAOYOU";
	Mypanel.TASK="TASK";
	Mypanel.BEIZHU="BEIZHU";
	Mypanel.ZHENGRONGXUANZE="ZHENGRONGXUANZE";
	Mypanel.SELECTZHENGRONG="SELECTZHENGRONG";
	Mypanel.SHOUCANG="SHOUCANG";
	Mypanel.FENXIANG="FENXIANG";
	Mypanel.SHOUCANG_INFO="SHOUCANG_INFO";
	Mypanel.TONGJI="TONGJI";
	Mypanel.MAILBATTLE="MAILBATTLE";
	Mypanel.RECHARGEPANEL="RECHARGEPANEL";
	Mypanel.HUODONG="HUODONG";
	Mypanel.RANKLIST="RANKLIST";
	Mypanel.SETTING="SETTING";
	Mypanel.XIANGOU="XIANGOU";
	Mypanel.CDKEY="CDKEY";
	Mypanel.SHOUCHONG="SHOUCHONG";
	Mypanel.VIPPANEL="VIPPANEL";
	Mypanel.MEIRIPANEL="MEIRIPANEL";
	Mypanel.CHECK_OTHER_PLAYER="CHECK_OTHER_PLAYER";
	Mypanel.Mail_Battle_Jie_Suan="Mail_Battle_Jie_Suan";
	Mypanel.Shop_Buy_Silver="Shop_Buy_Silver";
	Mypanel.DROPGIFT="DROPGIFT";
	Mypanel.UNIONPANEL="UNIONPANEL";
	Mypanel.NEWUNIONPANEL="NEWUNIONPANEL";
	Mypanel.TZHUANX="TZHUANX";
	Mypanel.DUOBAOJILU="DUOBAOJILU";
	return Mypanel;
})()


//class huamao.panel.activityItem.ActivityTime
var ActivityTime=(function(){
	function ActivityTime(){
		this.activitySession=null;
		this.obj={};
		this.xiangouTime=0;
		App.injOne(this);
		this.init();
	}

	__class(ActivityTime,'huamao.panel.activityItem.ActivityTime');
	var __proto=ActivityTime.prototype;
	__proto.init=function(){
		Laya.timer.loop(1000,this,this.timeFun);
	}

	__proto.addActivity=function(type,label){
		if(this.obj[type])return;
		var time=0;
		var activity=this.activitySession.getTypeActivity(type);
		if(activity)time=activity.endTime-GameUtils.GetServerTime();
		if(time>0){
			this.obj[type]=[time,label];
			label.text=GameUtils.time(time,5);
		}
	}

	__proto.upData=function(){
		for(var type=0 in this.obj){
			var arr=this.obj[type];
			var num=arr[0];
			var activity=this.activitySession.getTypeActivity(type);
			if(num>0 && activity){
				num=activity.endTime-GameUtils.GetServerTime();
				arr[1].text=GameUtils.time(num,5);
				this.obj[type][0]=num;
			}
			else{
				delete this.obj[type];
			}
		}
	}

	__proto.timeFun=function(){
		this.upData();
	}

	return ActivityTime;
})()


//class huamao.panel.bag.BoxData
var BoxData=(function(){
	function BoxData(){
		this.boxId=0;
		this.itemId=0;
		this.startTime=0;
		this.endTime=0;
	}

	__class(BoxData,'huamao.panel.bag.BoxData');
	return BoxData;
})()


//class huamao.panel.cityBuild.PiliangTime
var PiliangTime=(function(){
	function PiliangTime(){}
	__class(PiliangTime,'huamao.panel.cityBuild.PiliangTime');
	PiliangTime.TIME=100;
	return PiliangTime;
})()


//class huamao.panel.dropGift.DropGiftData
var DropGiftData=(function(){
	function DropGiftData(){
		this.cityId=0;
		this.dropTime=0;
		this.dropStr="";
		this.finalNew=0;
	}

	__class(DropGiftData,'huamao.panel.dropGift.DropGiftData');
	return DropGiftData;
})()


//class huamao.panel.duobao.DuoBaoData
var DuoBaoData=(function(){
	function DuoBaoData(){
		this.duoBaoNum=0;
		this.baoXiangNumArr=[];
		/**宝箱是否领取 0 未达到数目1达到数目未领取2已领取*/
		this.isbaoXiangGet=0;
		/**周累计抽取数量*/
		this.weekBaoXiangNum=0;
		/**活动时间*/
		this.activityTime=0;
		/**指针奖品*/
		this.drawAwardLog="";
		/**宝箱奖品奖品*/
		this.drawBoxLog="";
		/**指针奖品*/
		this.drawAwardArr=[];
		this.juanNum=0;
		/**每日免费劵*/
		this.freeJuan=0;
	}

	__class(DuoBaoData,'huamao.panel.duobao.DuoBaoData');
	var __proto=DuoBaoData.prototype;
	__proto.getItem=function(drawId){
		var sys=ConfigManager.getConfig("sys_draw.txt",drawId);
		return sys;
	}

	return DuoBaoData;
})()


//class huamao.panel.haoyou.youjian.MailBattleData
var MailBattleData=(function(){
	function MailBattleData(){
		/**战报ID*/
		this.battleId=0;
		/**战报时间 秒*/
		this.time=0;
		/**0 挑战 1 迎战 回顾0:防守方胜利，1:攻击方胜利*/
		this.type=0;
		/**0 胜利 1 失败*/
		this.result=0;
		/**好友ID*/
		this.friendId=0;
		/**攻击者Id*/
		this.atkId=0;
		/**攻击者*/
		this.atkName=null;
		/**攻击总兵力*/
		this.atkTroops=0;
		/**攻击损失兵力*/
		this.atkLoseReoops=0;
		/**攻击者经验*/
		this.atkExp=0;
		/**攻击者经验*/
		this.newatkExp=0;
		/**防御者Id*/
		this.defenseId=0;
		/**防御者*/
		this.defenseName=null;
		/**防御总兵力*/
		this.defenseTroops=0;
		/**防御损失兵力*/
		this.defenseLoseTroops=0;
		/**防御者经验*/
		this.defenseExp=0;
		/**防御者经验*/
		this.newdefenseExp=0;
		/**1 已读*/
		this.isRead=0;
		/**城池ID*/
		this.cityId=0;
		/**战报地址*/
		this.URL=null;
	}

	__class(MailBattleData,'huamao.panel.haoyou.youjian.MailBattleData');
	return MailBattleData;
})()


//class huamao.panel.haoyou.youjian.MailCityData
var MailCityData=(function(){
	function MailCityData(){
		this.cityId=0;
		this.playerId=0;
		this.sysCity=null;
		this.xx=NaN;
		this.yy=NaN;
	}

	__class(MailCityData,'huamao.panel.haoyou.youjian.MailCityData');
	return MailCityData;
})()


//class huamao.panel.haoyou.youjian.MailCityPlayerData
var MailCityPlayerData=(function(){
	function MailCityPlayerData(){
		this.playerId=0;
		this.playerName=null;
		this.cityFlag=null;
		this.cityId=0;
		this.allyId=0;
		this.startTime=0;
		this.hasBorder=false;
	}

	__class(MailCityPlayerData,'huamao.panel.haoyou.youjian.MailCityPlayerData');
	return MailCityPlayerData;
})()


//class huamao.panel.haoyou.youjian.MailType
var MailType=(function(){
	function MailType(){}
	__class(MailType,'huamao.panel.haoyou.youjian.MailType');
	MailType.ZHANBAO=-1;
	MailType.GM=0;
	MailType.RETROSPECT=1;
	MailType.ACTIVITY=2;
	MailType.CITYDIAOLUO=3;
	return MailType;
})()


//class huamao.panel.haoyou.youjian.PlayerAlly
var PlayerAlly=(function(){
	function PlayerAlly(){
		this.type=2;
		/**玩家ID*/
		this.playerId=0;
		/**玩家ID*/
		this.newPlayerId=0;
		/**行为开始的时间*/
		this.startTime=0;
	}

	__class(PlayerAlly,'huamao.panel.haoyou.youjian.PlayerAlly');
	var __proto=PlayerAlly.prototype;
	__proto.setData=function(byte){
		this.startTime=byte.getInt32();
		this.playerId=byte.getInt32();
		this.newPlayerId=byte.getInt32();
	}

	return PlayerAlly;
})()


//class huamao.panel.haoyou.youjian.PlayerAttack
var PlayerAttack=(function(){
	function PlayerAttack(){
		this.type=3;
		/**玩家ID*/
		this.playerId=0;
		/**城池ID*/
		this.cityId=0;
		/**行为开始的时间*/
		this.startTime=0;
		/**行为结束的时间*/
		this.endTime=0;
		/**是否成功占领 0:未占领 1:成功占领*/
		this.isWin=0;
	}

	__class(PlayerAttack,'huamao.panel.haoyou.youjian.PlayerAttack');
	var __proto=PlayerAttack.prototype;
	__proto.setData=function(byte){
		this.startTime=byte.getInt32();
		this.playerId=byte.getInt32();
		this.cityId=byte.getInt32();
		this.isWin=byte.getByte();
		this.endTime=byte.getInt32();
	}

	return PlayerAttack;
})()


//class huamao.panel.haoyou.youjian.PlayerEnter
var PlayerEnter=(function(){
	function PlayerEnter(){
		this.type=1;
		/**玩家ID*/
		this.playerId=0;
		/**玩家名字*/
		this.playerName=null;
		/**城池ID*/
		this.cityId=0;
		/**行为开始的时间*/
		this.startTime=0;
	}

	__class(PlayerEnter,'huamao.panel.haoyou.youjian.PlayerEnter');
	var __proto=PlayerEnter.prototype;
	__proto.setData=function(byte){
		this.startTime=byte.getInt32();
		this.playerId=byte.getInt32();
		this.playerName=byte.getUTFString();
		this.cityId=byte.getInt32();
	}

	return PlayerEnter;
})()


//class huamao.panel.haoyou.youjian.PlayerResult
var PlayerResult=(function(){
	function PlayerResult(){
		this.type=4;
		/**玩家ID*/
		this.playerId=0;
		/**玩家名字*/
		this.playerName=null;
		/**行为开始的时间*/
		this.startTime=0;
		/**类型
		*开始一局新游戏:0 独统:1 联盟统一:2 被灭失败:3 投降:4 280年独统:5
		*280年联盟统一:6 280年失败:7 280年联盟失败:8 击败XXX:9
		**/
		this.actionType=0;
	}

	__class(PlayerResult,'huamao.panel.haoyou.youjian.PlayerResult');
	var __proto=PlayerResult.prototype;
	__proto.setData=function(byte){
		this.startTime=byte.getInt32();
		this.playerId=byte.getInt32();
		this.actionType=byte.getInt32();
		this.playerName=byte.getUTFString();
	}

	return PlayerResult;
})()


/**
*武将的动作状态
*空闲 0
*行军 1
*驻守 2
*协防 3
*@author Administrator
*
*/
//class huamao.panel.hero.HeroActionState
var HeroActionState=(function(){
	function HeroActionState(){}
	__class(HeroActionState,'huamao.panel.hero.HeroActionState');
	HeroActionState.KONGXIAN=0;
	HeroActionState.XINGJUN=1;
	HeroActionState.ZHUSHOU=2;
	HeroActionState.XIEFANG=3;
	return HeroActionState;
})()


/**
*直接调用老总的牛逼抽武将翻拍特效
*
*/
//class huamao.panel.hero.HeroAnimation
var HeroAnimation=(function(){
	function HeroAnimation(){
		this.zhaomuDirector=null;
		;
		this.init();
	}

	__class(HeroAnimation,'huamao.panel.hero.HeroAnimation');
	var __proto=HeroAnimation.prototype;
	__proto.init=function(){
		this.zhaomuDirector=new ZhaomuDirector();
	}

	/**展示 动画完毕 [id,id,id]*/
	__proto.setData=function(arrstr){
		Dialog.manager.setLockView(null);
		Dialog.manager.lock(true);
		this.zhaomuDirector.reset();
		for (var i=0;i < arrstr.length;i++){
			var hid=parseInt(arrstr[i]);
			var card=new ZhaomuCard(hid,0);
			this.zhaomuDirector.cards.push(card);
		}
		this.zhaomuDirector.play();
		for (i=0;i<this.zhaomuDirector.cards.length;i++){
			App.layerManager.effectLayer.addChild(this.zhaomuDirector.cards[i]);
		}
	}

	return HeroAnimation;
})()


//class huamao.panel.hero.HeroAttr
var HeroAttr=(function(){
	function HeroAttr(){
		this.id=0;
		this.attrName="";
		this.value=0;
	}

	__class(HeroAttr,'huamao.panel.hero.HeroAttr');
	return HeroAttr;
})()


//class huamao.panel.hero.HeroBoxSmall
var HeroBoxSmall=(function(){
	function HeroBoxSmall(){
		this.mainUI=null;
		this.data=null;
	}

	__class(HeroBoxSmall,'huamao.panel.hero.HeroBoxSmall');
	var __proto=HeroBoxSmall.prototype;
	__proto.setMainUI=function(mainUI){
		this.mainUI=mainUI;
	}

	__proto.copy=function(){
		var kaui=new chuzhengkaUI();
		var heroBoxSmall=new HeroBoxSmall();
		heroBoxSmall.setMainUI(kaui);
		heroBoxSmall.setHeroData(this.data);
		return kaui;
	}

	__proto.setHeroData=function(data){
		this.data=data;
		this.mainUI.tiao.skin=GameUtils.getZiDi(data.sysHero.heroColor);
		this.mainUI.box.removeChildren();
		var img=new HeroImage();
		img.setHeroId(data.heroId);
		img.setScaleSize(this.mainUI.box.width,0);
		this.mainUI.box.addChild(img);
		this.mainUI.box.scrollRect=new Rectangle(0,0,this.mainUI.box.width,this.mainUI.box.height);
		for(var i=1;i <=5;i++){
			this.mainUI["xing"+i].visible=i <=data.heroStar;
		}
		this.mainUI.di.skin=GameUtils.getDi(data.sysHero.heroColor);
		this.mainUI.xing.visible=data.heroStar > 0;
		this.mainUI.name0.text=data.sysHero.heroName;
		this.mainUI.dengji.text=data.heroLv+"";
		this.mainUI.txt0.text=data.soldier+"/"+data.soldierMax;
		this.mainUI.binglitiao.value=data.soldier / data.soldierMax;
		this.mainUI.kaung.skin=GameUtils.getKuang(data.sysHero.heroColor);
		this.mainUI.guojia.skin=GameUtils.getCountry(data.sysHero.heroCountry);
	}

	return HeroBoxSmall;
})()


/**
*武将数据
*@author lpf
*
*/
//class huamao.panel.hero.HeroData
var HeroData=(function(){
	function HeroData(){
		/**武将ID*/
		this.heroId=0;
		this.cityId=0;
		/**武将等级*/
		this.heroLv=0;
		this._heroStar=0;
		/**武将获取时间*/
		this.heroTime=0;
		/**勇 */
		this.force=0;
		/**御 */
		this.resist=0;
		/**智 */
		this.wisdom=0;
		/**威 */
		this.might=0;
		/**当前带兵 */
		this.soldier=0;
		/**兵种 */
		this.soldierType=0;
		/**物理攻击 */
		this.attack=0;
		/**物理防御 */
		this.defense=0;
		/**计策攻击 */
		this.stratagemAttack=0;
		/**计策防御 */
		this.stratagemDefense=0;
		/**带兵上限 */
		this.soldierMax=0;
		/**成长值 */
		this.growth=0;
		/**初始怒气 */
		this.initAnger=0;
		/**暴击率（百分比） */
		this.crit=0;
		/**闪避率（百分比） */
		this.dodge=0;
		/**识破率（百分比） */
		this.insight=0;
		/**物伤减免（百分比） */
		this.attackDamageReduce=0;
		/**策伤减免（百分比） */
		this.stratagemDamageReduce=0;
		/**伤害减免（百分比） */
		this.damageReduce=0;
		/**伤害加成（百分比） */
		this.damageAdd=0;
		/**物伤加成（百分比） */
		this.attackDamageAdd=0;
		/**策伤加成（百分比） */
		this.stratagemDamageAdd=0;
		/**格挡 */
		this.parry=0;
		/**勇气成长值 */
		this.growthCourage=0;
		/**防御 成长值 */
		this.growthDef=0;
		/**智成长值*/
		this.growthInt=0;
		/**威成长值 */
		this.growthPrestige=0;
		this.num=0.2;
		this._sysHero=null;
		this.attrArr={};
		this.attName=["force","resist","wisdom","might","attack","defense","stratagemAttack","stratagemDefense","soldierMax","growth","initAnger","crit","dodge","insight","attackDamageReduce","stratagemDamageReduce","damageReduce"];
		this.starAttr=[];
		this.basicsAttr=[];
		this.isXueCang=0;
		//是否雪藏 0：未雪藏 1：雪藏
		this.isResolve=0;
		//是否分解
		this.fight=0;
		this._legion="";
		this._masterId=0;
		this.studyArms=[];
		//已解锁兵种类型
		this.unlockSoldier=[];
		this.assessAry=[];
		this.index=HeroData.maxIndex;
		this._heroState=0;
	}

	__class(HeroData,'huamao.panel.hero.HeroData');
	var __proto=HeroData.prototype;
	/**
	*计算成长值
	*/
	__proto.growthValue=function(){
		this.growthCourage=this.getGrowth(this.sysHero.growthCourage);
		this.growthDef=this.getGrowth(this.sysHero.growthDef);
		this.growthInt=this.getGrowth(this.sysHero.growthInt);
		this.growthPrestige=this.getGrowth(this.sysHero.growthPrestige);
		this.growth=((this.growthCourage*100)+(this.growthDef*100)+(this.growthInt*100)+(this.growthPrestige*100))/100;
	}

	__proto.getGrowth=function(growthValue){
		var num=(1 *0.2 *this._heroStar+1)*growthValue *10;
		var str=(num/100).toFixed(2);
		var starGrowthValue=Number(str);
		return starGrowthValue;
	}

	/**
	*基础属性
	*
	*/
	__proto.refreshAttr=function(){
		this.force=this.getAttrValue(this.sysHero.heroCourage,this.sysHero.growthCourage);
		this.resist=this.getAttrValue(this.sysHero.heroDef,this.sysHero.growthDef);
		this.wisdom=this.getAttrValue(this.sysHero.heroInt,this.sysHero.growthInt);
		this.might=this.getAttrValue(this.sysHero.heroPrestige,this.sysHero.growthPrestige);
		this.resetAttr();
	}

	__proto.getAttrValue=function(baseValue,growthValue){
		var starGrowthValue=(this.heroStar *0.2+1)*growthValue / 10;
		return Math.floor(baseValue+this.heroLv *starGrowthValue);
	}

	/**
	*天赋属性
	*
	*/
	__proto.resetAttr=function(){
		this.attack=this.force *SysAttrName.getAttrTrans(SysAttrName.ATTRID_FORCE,SysAttrName.ATTRID_ATTACK);
		this.defense=this.resist *SysAttrName.getAttrTrans(SysAttrName.ATTRID_RESIST,SysAttrName.ATTRID_DEFENSE);
		this.stratagemAttack=this.wisdom *SysAttrName.getAttrTrans(SysAttrName.ATTRID_WISDOM,SysAttrName.ATTRID_STRATAGEMATTACK);
		this.stratagemDefense=this.wisdom *SysAttrName.getAttrTrans(SysAttrName.ATTRID_WISDOM,SysAttrName.ATTRID_STRATAGEMDEFENSE);
		this.soldierMax=this.might *SysAttrName.getAttrTrans(SysAttrName.ATTRID_MIGHT,SysAttrName.ATTRID_SOLDIERMAX);
		var talenArr=this.sysHero.talentArr;
		for (var i=0;i < this.heroStar;i++){
			var talent=talenArr[i];
			this.addTalentAttr(talent.id,talent.value);
		}
		this.addAttr();
	}

	/*
	*
	*是否雪藏
	*/
	__proto.haveHide=function(){
		return this.isXueCang==1;
	}

	/**
	*是否拥有这个英雄
	*@return
	*/
	__proto.haveHero=function(){
		return this.isResolve==0;
	}

	__proto.addAttr=function(){
		this.starAttr=[];
		this.basicsAttr=[];
		var index=0;
		for(var i=1001;i<1018;i++){
			var att=ConfigManager.getConfig("sys_attr_name.txt",i);
			var heroAtt=new HeroAttr();
			var str=this.attName[index];
			heroAtt.id=i;
			heroAtt.attrName=att.attrName;
			heroAtt.value=this[str];
			index++;
			this.attrArr[i]=heroAtt.value;
			if(i>1004){
				this.starAttr.push(heroAtt);
			}
			else{
				this.basicsAttr.push(heroAtt);
			}
		}
	}

	__proto.addTalentAttr=function(talentId,value){
		switch (talentId){
			case 1001:
				this.initAnger+=value;
				break ;
			case 1002:
				this.soldierMax+=(int)(this.soldierMax / 100 *value);
				break ;
			case 1003:
				this.damageReduce+=value;
				break ;
			case 1004:
				this.stratagemDamageAdd+=value;
				break ;
			case 1005:
				this.stratagemAttack+=(int)(this.stratagemAttack / 100 *value);
				break ;
			case 1006:
				this.damageAdd+=value;
				break ;
			case 1007:
				this.dodge+=value;
				break ;
			case 1008:
				this.attackDamageAdd+=value;
				break ;
			case 1009:
				this.attack+=(int)(this.attack / 100 *value);
				break ;
			case 1010:
				this.attackDamageReduce+=value;
				break ;
			case 1011:
				this.stratagemDamageReduce+=value;
				break ;
			case 1012:
				this.crit+=value;
				break ;
			case 1013:
				this.insight+=value;
				break ;
			case 1014:
				this.stratagemDefense+=(int)(this.stratagemDefense / 100 *value);
				break ;
			case 1015:
				this.defense+=(int)(this.defense / 100 *value);
				break ;
			case 1016:
				this.attack+=(int)(this.attack / 100 *value);
				this.stratagemAttack+=(int)(this.stratagemAttack / 100 *value);
				break ;
			default :
				break ;
			}
	}

	__proto.setStudy=function(study){
		this.studyArms.length=0;
		if(study !=""){
			var arr=study.split(",");
			for (var i=0;i < arr.length;i++){
				this.studyArms.push(parseInt(arr[i]))
			}
		}
	}

	__proto.setSodierUnlock=function(unlock){
		this.unlockSoldier.length=0;
		if(unlock !=""){
			var arr=unlock.split(",");
			for (var i=0;i < arr.length;i++){
				this.unlockSoldier.push(parseInt(arr[i]))
			}
		}
	}

	__proto.setAssess=function(assess){
		this.assessAry.length=0;
		if(assess !=""){
			var arr=assess.split(";");
			for(var i=0;i<arr.length;i++){
				this.assessAry.push(parseInt(arr[i]));
			}
		}
	}

	__proto.getAssessByIndex=function(index){
		return this.assessAry[index]
	}

	/**
	*前端配置武将信息
	*@return
	*
	*/
	__getset(0,__proto,'sysHero',function(){
		if(this._sysHero==null){
			this._sysHero=ConfigManager.getConfig("sys_hero.txt",this.heroId);
		}
		return this._sysHero;
	});

	/**
	*@private
	*/
	/**主将ID*/
	__getset(0,__proto,'masterId',function(){
		return this._masterId;
		},function(value){
		this._masterId=value;
	});

	/**
	*@private
	*/
	/**军团 id,id*/
	__getset(0,__proto,'legion',function(){
		return this._legion;
		},function(value){
		this._legion=value;
	});

	/**
	*@private
	*/
	/**武将星级*/
	__getset(0,__proto,'heroStar',function(){
		return this._heroStar;
		},function(value){
		this._heroStar=value;
		this.growthValue();
	});

	/**
	*@private
	*/
	/**武将状态 空闲 :0 行军:1 驻守 :2 协防 :3*/
	__getset(0,__proto,'heroState',function(){
		return this._heroState;
		},function(value){
		this._heroState=value;
	});

	HeroData.maxIndex=10000;
	return HeroData;
})()


//class huamao.panel.hero.Talent
var Talent=(function(){
	function Talent(){
		this.id=0;
		// 天赋ID
		this.value=0;
	}

	__class(Talent,'huamao.panel.hero.Talent');
	var __proto=Talent.prototype;
	// 天赋属性值
	__proto.getValue=function(){
		if(this.id==1001){
			return this.value+"";
		}
		return this.value+"%";
	}

	return Talent;
})()


//class huamao.panel.huodong.ActivityPicTips
var ActivityPicTips=(function(){
	function ActivityPicTips(){
		;
	}

	__class(ActivityPicTips,'huamao.panel.huodong.ActivityPicTips');
	ActivityPicTips.nameTips=function(img,caller,itemid){img.on("click",caller,ActivityPicTips.imgTips,[itemid]);
	}

	ActivityPicTips.imgTips=function(itemid){
		var sysitem=ConfigManager.getConfig("sys_item.txt",itemid);
		FlyLittleUpTips.setTips(sysitem.itemName);
	}

	ActivityPicTips.heroNameTips=function(img,caller,itemid){img.on("click",caller,ActivityPicTips.heroImgTips,[itemid]);
	}

	ActivityPicTips.heroImgTips=function(itemid){
		var sysitem=ConfigManager.getConfig("sys_hero.txt",itemid);
		FlyLittleUpTips.setTips(sysitem.heroName);
	}

	return ActivityPicTips;
})()


//class huamao.panel.huodong.huoyueDay.HuoyueDayData
var HuoyueDayData=(function(){
	function HuoyueDayData(){
		this.Disbtn=false;
		this.taskId=0;
		this.getOne=0;
		this._isOk=false;
		this.getStatus=0;
		;
	}

	__class(HuoyueDayData,'huamao.panel.huodong.huoyueDay.HuoyueDayData');
	var __proto=HuoyueDayData.prototype;
	/**
	*判断当前进度是否可获取奖励
	*/
	__proto.isGetPrograss=function(){
		if(this.isOk==1){
			this.Disbtn=false;
		}
	}

	__proto.isLing=function(btn0){
		if(this.getStatus==1){
			btn0.disabled=true;
		}
	}

	__getset(0,__proto,'isOk',function(){
		return this._isOk;
		},function(value){
		this._isOk=value;
		if(this.isOk==1){
			this.Disbtn=false;
		}
	});

	HuoyueDayData.getData=function(){
		HuoyueDayData.sysNewArr.length=0;
		var sysArr=ConfigManager.getDataArr("sys_task.txt");
		for (var j=0;j < sysArr.length;j++){
			if(sysArr[j].taskType==4){
				HuoyueDayData.sysNewArr.push(sysArr[j]);
			}
		}
	}

	HuoyueDayData.sysNewArr=[];
	return HuoyueDayData;
})()


//class huamao.panel.huodong.huoyuedu.HuoyueGift
var HuoyueGift=(function(){
	function HuoyueGift(imgPic,imgGou,value,shu,box,clip){
		this.imgPic=null;
		this.imgGou=null;
		this.value=null;
		this.shu=null;
		this.box=null;
		this.clip=null;
		;
		this.imgPic=imgPic;
		this.imgGou=imgGou;
		this.value=value;
		this.shu=shu;
		this.box=box;
		this.clip=clip;
	}

	__class(HuoyueGift,'huamao.panel.huodong.huoyuedu.HuoyueGift');
	var __proto=HuoyueGift.prototype;
	/**
	*@param textValue 奖励物品数量
	*@param textSkin 奖励物品皮肤
	*@param itemsTarget 达到奖励目标值
	*/
	__proto.setData=function(textValue,textSkin,itemsTarget){
		this.value.text=textValue;
		this.imgPic.skin=GameUtils.getItemIconPath(parseInt(textSkin));
		this.shu.text=itemsTarget;
	}

	/**
	*@param value 是否开启特效、对勾
	*/
	__proto.setIsOver=function(value){
		if(value==true){
			this.clip.visible=value;
			this.clip.play();
			}else{
			this.clip.visible=false;
			this.clip.stop();
			this.imgGou.visible=true;
		}
	}

	return HuoyueGift;
})()


//class huamao.panel.huodong.jijin.ActivityData
var ActivityData=(function(){
	function ActivityData(){
		/**活动ID*/
		this.activityId=0;
		/**活动类型*/
		this.activityType=0;
		/**目标ID，目标数量，已完成数量，....*/
		this.tarGetStatus=null;
		/**0未完成 1已完成未领取 2已领取*/
		this.rewardStatus=0;
		/**结束时间（秒）*/
		this.endTime=0;
	}

	__class(ActivityData,'huamao.panel.huodong.jijin.ActivityData');
	var __proto=ActivityData.prototype;
	__proto.getSysData=function(){
		var sys=ConfigManager.getConfig("sys_activity.txt",this.activityId);
		return sys;
	}

	ActivityData.getDate=function(num){
		var sys=ConfigManager.getDataArr("sys_activity.txt");
		for (var i=0;i < sys.length;i++){
			if(sys[i].order==num){
				return sys[i].activityTime;
				break ;
			}
		}
		return "";
	}

	ActivityData.getHuoDongTime=function(num){
		var str=ActivityData.getDate(num);
		var item=str.split("|");
		var timeArr=[];
		for (var i=0;i < item.length;i++){
			var year=item[i].substr(0,4);
			var month=item[i].substr(4,2);
			var day=item[i].substr(6,2);
			timeArr.push(year,month,day);
		};
		var str2=timeArr[0]+"年"+timeArr[1]+"月"+timeArr[2]+"日~"+timeArr[4]+"月"+timeArr[5]+"日";
		console.log("timeArr-->"+timeArr)
		return str2;
	}

	ActivityData.getSys=function(heroId){
		var sys=ConfigManager.getConfig("sys_activity.txt",heroId);
		return sys;
	}

	return ActivityData;
})()


//class huamao.panel.huodong.kaBao.KaBaoData
var KaBaoData=(function(){
	function KaBaoData(){
		this.Disbtn=false;
		this.heroId=0;
		this.getOne=0;
		this.isOk=false;
		this.getStatus=0;
		;
	}

	__class(KaBaoData,'huamao.panel.huodong.kaBao.KaBaoData');
	var __proto=KaBaoData.prototype;
	__proto.getSys=function(heroId){
		var sys=ConfigManager.getConfig("sys_activity.txt",heroId);
		return sys;
	}

	KaBaoData.getDate=function(num){
		var sys=ConfigManager.getDataArr("sys_activity.txt");
		for (var i=0;i < sys.length;i++){
			if(sys[i].order==num){
				return sys[i].activityTime;
				break ;
			}
		}
		return "";
	}

	KaBaoData.getHuoDongTime=function(num){
		var str=KaBaoData.getDate(num);
		var item=str.split("|");
		var timeArr=[];
		for (var i=0;i < item.length;i++){
			var year=item[i].substr(0,4);
			var month=item[i].substr(4,2);
			var day=item[i].substr(6,2);
			timeArr.push(year,month,day);
		};
		var str2=timeArr[0]+"年"+timeArr[1]+"月"+timeArr[2]+"日~"+timeArr[4]+"月"+timeArr[5]+"日";
		return str2;
	}

	return KaBaoData;
})()


//class huamao.panel.huodong.sevenrenwu.SevenData
var SevenData=(function(){
	function SevenData(){
		this.activityId=0;
		this.isLing=0;
		this.programArr=[];
		this.btnDis=false;
		this.actDayArr=[true,true,true,true,true,true,true];
		;
	}

	__class(SevenData,'huamao.panel.huodong.sevenrenwu.SevenData');
	var __proto=SevenData.prototype;
	/**
	*已领取按钮是否显示
	*/
	__proto.isGetGift=function(){
		if(this.isLing==0){
			return false;
			}else{
			return true;
		}
	}

	/**
	*活跃天数获取
	*@param index list序列
	*/
	__proto.getActDay=function(index){
		for (var i=0;i < SevenData.actDay;i++){
			this.actDayArr[i]=false;
		}
		return this.actDayArr[index];
	}

	/**
	*判断当前进度是否可获取奖励
	*@param index list序列
	*/
	__proto.isGetPrograss=function(index){
		var sysArr=ConfigManager.getDataArr("sys_activity.txt");
		if(this.programArr[3]!=null){
			var item1=sysArr[index].activityTarget.split("|");
			var item2=item1[0].split(",");
			var item3=item1[1].split(",");
			if(parseInt(this.programArr[2])>=parseInt(item2[item2.length-1])&&parseInt(this.programArr[3])>=parseInt(item3[item3.length-1])){
				this.btnDis=false;
			}
			}else{
			var item0=sysArr[index].activityTarget.split(",");
			if(parseInt(this.programArr[2])>=parseInt(item0[item0.length-1])){
				this.btnDis=false;
			}
		}
	}

	SevenData.actDay=0;
	return SevenData;
})()


//class huamao.panel.redpoing.RedPointType
var RedPointType=(function(){
	function RedPointType(){}
	__class(RedPointType,'huamao.panel.redpoing.RedPointType');
	RedPointType.GRXX=1;
	RedPointType.JIFEN=2;
	RedPointType.MEIYUE=3;
	RedPointType.MEIR=4;
	RedPointType.GUANZHI=5;
	RedPointType.ZHAOMU=6;
	RedPointType.HAOYIN=7;
	RedPointType.JICE=8;
	RedPointType.HAOYOU=9;
	RedPointType.YOUJIAN=10;
	RedPointType.ZHANBAO=11;
	RedPointType.PENGYOU=12;
	RedPointType.ZUIJIN=13;
	RedPointType.WEIDU=14;
	RedPointType.SHENQING=15;
	RedPointType.HUODONG=16;
	RedPointType.LIANXU=17;
	RedPointType.XINSHOUQITIAN=18;
	RedPointType.MEIHZOUHUOYUE=19;
	RedPointType.CHENGZHANG=20;
	RedPointType.RENWU=21;
	RedPointType.LEIJI=22;
	RedPointType.RIHUOYUE=23;
	RedPointType.NEWLEIJI=24;
	RedPointType.DUOBAO=25;
	return RedPointType;
})()


//class huamao.panel.SmallTaskView
var SmallTaskView=(function(){
	function SmallTaskView(box,clip0,_iconUI){
		this.box=null;
		this.clip0=null;
		this.icon=null;
		this.ae=null;
		this.taskSession=null;
		this.openFunctionSession=null;
		this.mainPlayerSession=null;
		this.lbs=[];
		this.imgArr=[];
		this.item=[];
		this.isDiaoChanView=true;
		this.value=0;
		this.job=0;
		this.colorArr=["#cce70c","#a9e70c","#52e70c"];
		App.injOne(this);
		this.clip0=clip0;
		this.box=box;
		this.icon=_iconUI;
		box.on("click",this,this.clickFun);
		box.cacheAs="bitmap";
		this.box.visible=false;
		this.icon.html.y+=10;
		this.icon.zizu.y+=14;
		this.icon.qipaopao.y-=40;
		this.icon.yincang.visible=this.icon.html.visible=this.icon.tishi.visible=false;
		SmallTaskView.isDiaoChanTip=true;
		this.ae=new AutoEvent(_iconUI);
		this.ae.add("huamao.YouEvent.UPDATA_TASK_DATA",this,this.fun);
		this.ae.add("FUNCTIONNUM",this,this.openFun);
		this.ae.add("FLUSH_PLAYER_JOB",this,this.updataJob);
		App.eventManager.on("SENDDIAOCHANTIP",this,this.sendDiaoChanTip);
		this.ae.addEventNow();
		this.openFun();
		var lb;
		var img;
		for (var i=0;i < 4;i++){
			lb=new Label();
			img=new Image();
			lb.color="#00FF00"
			img.skin="comp/GG/rw_1.png";
			lb.fontSize=18;
			lb.text="任务"
			lb.y=8+(i*(lb.height+4));
			img.y=10+(i*(img.height+4));
			lb.x=67;
			img.x=45;
			this.lbs.push(lb);
			this.imgArr.push(img);
		}
		this.icon.yincang.mouseThrough=true;
		this.icon.qipaopao.mouseThrough=true;
		this.icon.zizu.mouseThrough=true;
		this.icon.html.mouseThrough=true;
		this.show();
	}

	__class(SmallTaskView,'huamao.panel.SmallTaskView');
	var __proto=SmallTaskView.prototype;
	__proto.clearFlashText=function(){
		Laya.timer.clear(this,this.onLoop);
	}

	__proto.updataJob=function(){
		var job=this.mainPlayerSession.mainPlayerData.job;
		if(job!=1001){
			this.icon.yincang.removeSelf();
			Laya.timer.clear(this,this.onLoop);
		}
	}

	//Laya.timer.clear(this,beginTimer);
	__proto.openFun=function(){
		var sys=this.openFunctionSession.getSys("TASK");
		if(this.openFunctionSession.getFun(sys.unlockId)){
			this.icon.box1.addChild(this.box);
			var job=this.mainPlayerSession.mainPlayerData.job;
			if(job==1001){
				this.icon.addChild(this.icon.yincang);
				this.showDiaoChan();
				}else {
				this.icon.yincang.removeSelf();
				SmallTaskView.isDiaoChanTip=false;
			}
			}else {
			this.box.removeSelf();
			this.icon.yincang.removeSelf();
		}
	}

	__proto.sendDiaoChanTip=function(){
		this.icon.qipaopao.visible=false;
		this.clickDiaoChanFun();
	}

	__proto.showDiaoChan=function(){
		if(this.icon.B1.getChildByName("diaochan")!=null){
			return;
		};
		var dragonBonesMc=new DragonBonesMc(false,false);
		dragonBonesMc.setUrl("res/load/diaochan.sk");
		dragonBonesMc.name="diaochan";
		dragonBonesMc.scale(0.5,0.5);
		dragonBonesMc.pos(80,280);
		this.icon.B1.addChild(dragonBonesMc);
		this.icon.yincang.right=0;
		this.icon.yincang.bottom=105;
		this.icon.B1.mouseThrough=false;
		dragonBonesMc.mouseThrough=false;
		var image=new Image();
		image.skin="res/load/zhezhao.png";
		image.pos(-360,-640);
		image.scale(2,2);
		dragonBonesMc.mask=image;
		dragonBonesMc.on("click",this,this.clickDiaoChanFun);
		Laya.stage.on("click",this,this.clickDiaoChanCheck);
	}

	__proto.clickDiaoChanCheck=function(){
		if(this.icon.yincang.parent==null){
			Laya.stage.off("click",this,this.clickDiaoChanCheck);
			return;
		}
		if(this.icon.B1.hitTestPoint(Laya.stage.mouseX,Laya.stage.mouseY)){
			this.clickDiaoChanFun();
		}
	}

	__proto.clickDiaoChanFun=function(){
		this.icon.qipaopao.visible=!this.icon.qipaopao.visible;
	}

	// }
	__proto.fun=function(e){
		this.show();
	}

	__proto.show=function(){
		var lb;
		var img;
		for (var i=0;i < this.lbs.length;i++){
			lb=this.lbs[i];
			lb.removeSelf();
		}
		for (var j=0;j < this.imgArr.length;j++){
			img=this.imgArr[j];
			img.removeSelf();
		};
		var htd=this.taskSession.typeHonour;
		var ktd=this.taskSession.typeKing;
		this.box.visible=(htd.status!=0 || ktd.status!=0);
		this.clip0.autoPlay=this.clip0.visible=(this.box.visible && (htd.isOk || ktd.isOk));
		i=0;
		j=0;
		if(htd.status!=0){
			lb=this.lbs[i++];
			lb.color=htd.isOk?"#00ff00":"#ffffff";
			lb.text=htd.systask.showValue(htd);
			lb.fontSize=22;
			this.box.addChild(lb);
			img=this.imgArr[j++];
			img.skin=htd.isOk?"comp/GG/rw_0.png":"comp/GG/rw_1.png";
			this.box.addChild(img);
		}
		if(ktd.status!=0){
			lb=this.lbs[i++];
			lb.color=ktd.isOk?"#00ff00":"#ffffff";
			lb.text=ktd.systask.showValue(ktd);
			lb.fontSize=22;
			this.box.addChild(lb);
			img=this.imgArr[j++];
			img.skin=ktd.isOk?"comp/GG/rw_0.png":"comp/GG/rw_1.png";
			this.box.addChild(img);
		};
		var ntd=this.taskSession.typeNewplayer;
		var ntdGNew=this.taskSession.gNewplayer;
		var ntdn=this.taskSession.typeNewplayerNo;
		if(ntd!=null && ntd.status!=0){
			lb=this.lbs[i++];
			lb.color=ntd.isOk?"#00ff00":"#ffffff";
			lb.text=ntd.systask.showValue(ntd);
			lb.fontSize=22;
			this.box.addChild(lb);
			img=this.imgArr[j++];
			img.skin=ntd.isOk?"comp/GG/rw_0.png":"comp/GG/rw_1.png";
			this.box.addChild(img);
			this.icon.yincang.visible=this.icon.html.visible=this.box.visible=(this.box.visible || true);
			if(this.icon.qipaopao){
				this.icon.qipaopao.visible=true;
			}
			if(ntdGNew!=null){
				if(!this.clip0.visible)this.clip0.autoPlay=this.clip0.visible=(this.box.visible &&(ntd.isOk||ntdGNew.isOk));
			};
			var arr=ConfigManager.getDataArr("sys_tips.txt");
			var stips=ConfigManager.getConfig("sys_tips.txt",3002);
			this.icon.zizu.wordWrap=true;
			this.icon.zizu.fontSize=20;
			this.icon.html.width=300;
			if(this.clip0.visible){
				this.icon.zizu.text="\n";
				this.playFlashText(stips.tipsDescribe+"");
				}else{
				if(ntdGNew!=null){
					if(ntdGNew.status!=0){
						this.icon.zizu.text=ntdGNew.systask.taskDescription;
						}else{
						this.icon.zizu.text=ntd.systask.taskDescription;
					}
					this.item=this.icon.zizu.text.split("\n");
					this.icon.html.width=this.icon.zizu.width=340;
					this.icon.html.innerHTML="<span style='color:#cce70c;fontSize:20;font:微软雅黑'>"+this.item[0]+"</span>";
					this.icon.zizu.text=""+"\n"+this.item[1];
					this.icon.html.visible=this.icon.zizu.visible;
					var str=this.item[0];
					if(this.icon.html.contextHeight>=40){
						this.icon.zizu.text=""+"\n\n"+this.item[1];
					}
					this.playFlashText(this.item[0]+"");
				}
			}
			this.icon.zizu.height=0;
			this.icon.zizu.autoSize=true;
			this.icon.qipaopao.height=this.icon.zizu.getBounds().height+44;
			if(this.clip0.autoPlay){
				this.icon.qipaopao.height=this.icon.zizu.getBounds().height+14;
			}
		};
		var gtdn=this.taskSession.gNewplayer;
		if(gtdn!=null && gtdn.status!=0){
			lb=this.lbs[i++];
			lb.color=gtdn.isOk?"#00ff00":"#ffffff";
			lb.text=gtdn.systask.showValue(gtdn);
			lb.fontSize=22;
			this.box.addChild(lb);
			img=this.imgArr[j++];
			img.skin=gtdn.isOk?"comp/GG/rw_0.png":"comp/GG/rw_1.png";
			this.box.addChild(img);
			this.icon.yincang.visible=this.icon.qipaopao.visible=this.icon.html.visible=this.box.visible=(this.box.visible || true);
			if(this.icon.qipaopao){
				this.icon.qipaopao.visible=true;
			}
			if(!this.clip0.visible)this.clip0.autoPlay=this.clip0.visible=(this.box.visible && gtdn.isOk);
		}
	}

	__proto.playFlashText=function(str){
		Laya.timer.clear(this,this.onLoop);
		Laya.timer.frameLoop(20,this,this.onLoop,[str]);
		this.job=this.mainPlayerSession.mainPlayerData.job;
	}

	__proto.onLoop=function(str){
		var html="";
		if(this.value>2){
			this.value=0;
		}
		this.icon.html.innerHTML="<span style='color:"+this.colorArr[this.value]+";fontSize:20;font:微软雅黑'>"+str+"</span>";
		this.value++;
		if(this.job!=1001){
			Laya.timer.clear(this,this.onLoop);
			SmallTaskView.isDiaoChanTip=false;
		}
	}

	__proto.clickFun=function(){
		App.dialogManager.openDialogByStr("TASK",null,true,true);
	}

	SmallTaskView.isDiaoChanTip=false;
	SmallTaskView.GirlName="diaochan";
	return SmallTaskView;
})()


//class huamao.panel.talk.MainUIControl
var MainUIControl=(function(){
	function MainUIControl(){
		this.boxAll=null;
		this.imgAll=null;
		this.btnOpen=null;
		this.listLiaoT=null;
		this.openStata=false;
		//true:打开 false:关闭
		this.panel=null;
		this.count=0;
		this.remY=0;
		//无用
		this.posY=0;
		this.talkSession=null;
		this.tt=false;
		this.remCell=[];
		App.injOne(this);
	}

	__class(MainUIControl,'huamao.panel.talk.MainUIControl');
	var __proto=MainUIControl.prototype;
	__proto.setUI=function(boxa,img,btnopen,_talkPanel){
		this.boxAll=boxa;
		this.imgAll=img;
		this.btnOpen=btnopen;
		MainUIControl.talkPanel=_talkPanel;
		this.openStata=false;
		this.init();
	}

	__proto.addFromTeamCB=function(){
		if(!this.tt)return;
		if(TipsTalkSet.PINDAO_DUIWU){
			var len=this.talkSession.aryTeam.length;
			var data=this.talkSession.aryTeam [len-1];
			this.addSentenceCB(data.getSysHtml());
		}
	}

	__proto.addFromSysCB=function(){
		if(!this.tt)return;
		if(TipsTalkSet.PINDAO_XITONG){
			var len=this.talkSession.arySys.length;
			var data=this.talkSession.arySys [len-1];
			this.addSentenceCB(data.getSysHtml(false));
		}
	}

	__proto.addFromWordCB=function(){
		if(!this.tt)return;
		if(TipsTalkSet.PINDAO_SHIJIE){
			var len=this.talkSession.aryWord.length;
			var data=this.talkSession.aryWord [len-1];
			this.addSentenceCB(data.getSysHtml());
		}
	}

	__proto.addFromColleage=function(){
		if(!this.tt)return;
		if(TipsTalkSet.PINDAO_LIANMENG){
			var len=this.talkSession.aryColeage.length;
			var data=this.talkSession.aryColeage [len-1];
			this.addSentenceCB(data.getSysHtml());
		}
	}

	__proto.addFromCurrentCB=function(){
		if(!this.tt)return;
		if(TipsTalkSet.PINDAO_DANGQIAN){
			var len=this.talkSession.aryCurrent.length;
			var data=this.talkSession.aryCurrent [len-1];
			this.addSentenceCB(data.getSysHtml());
		}
	}

	__proto.addSentenceCB=function(str){
		var cell=new SysCell(str);
		var curY=0;
		if(this.remCell.length >=TalkSession.MAXSIZE){
			var fistCell=this.remCell.shift();
			var fistH=fistCell.height;
			fistCell.removeSelf();
			for(var i=0;i<this.remCell.length;i++){
				var cellt=this.remCell [i];
				cellt.y-=fistH;
			}
		}
		if(this.remCell.length > 0){
			var lastCell=(this.remCell [this.remCell.length-1]);
			curY=lastCell.y+lastCell.height;
		}
		cell.pos(0,0);
		this.panel.removeChildren();
		this.panel.addChild(cell);
		this.remCell.push(cell);
	}

	__proto.init=function(){
		this.posY=Laya.stage.height-70;
		this.boxAll.y=this.posY;
		this.boxAll.x=0;
		this.btnOpen.anchorY=0.5;
		this.btnOpen.pos(3,70/2);
		this.btnOpen.on("click",this,this.openTalkPanelCB);
		this.panel=new Panel();
		this.panel.pos(50,10);
		this.panel.size(365,48);
		this.boxAll.addChild(this.panel);
		this.panel.on("click",this,this.openTalkPanelCB);
		if(!this.tt){
			var len=this.talkSession.arySys.length;
			for(var i=0;i<len;i++){
				var data=this.talkSession.arySys [i];
				this.addSentenceCB(data.getSysHtml(false));
			}
			this.tt=true;
			App.eventManager.on("TALK_FLUSH_WORD",this,this.addFromWordCB);
			App.eventManager.on("TALK_FLUSH_CURRENT",this,this.addFromCurrentCB);
			App.eventManager.on("TALK_FLUSH_SYS",this,this.addFromSysCB);
			App.eventManager.on("TALK_FLUSH_TEAM",this,this.addFromTeamCB);
			App.eventManager.on("TALK_FLUSH_COLEAGE",this,this.addFromColleage);
		}
	}

	__proto.openTalkPanelCB=function(){
		var scene=App.sceneManager.getCurrentScene();
		if((scene instanceof MainScene )){
			var mainscene=scene;
			if(MainUIControl.talkPanel==null){
				console.log("加载 TalkPanel --》 ");
				MainUIControl.talkPanel=new TalkPanel();
				Tween.to(MainUIControl.talkPanel,{x:0},500);
				MainUIControl.talkPanel.width=Laya.stage.width;
				MainUIControl.talkPanel.di.width=Laya.stage.width+554;
				mainscene.addChild(MainUIControl.talkPanel);
			}
		}
	}

	__proto.openCB=function(){
		if(this.openStata){
			this.btnOpen.rotation=0;
			this.boxAll.y=this.posY;
			this.boxAll.height=72;
			this.imgAll.height=70;
			this.panel.height=72;
			}else{
			this.btnOpen.rotation=180;
			this.boxAll.y=this.posY-70;
			this.boxAll.height=72+70;
			this.imgAll.height=70+70;
			this.panel.height=72+70;
		}
		this.openStata=!this.openStata;
	}

	MainUIControl.getMe=function(){
		if(MainUIControl.me==null){
			MainUIControl.me=new MainUIControl();
		}
		return MainUIControl.me;
	}

	MainUIControl.closeTalkPanel=function(){
		if(MainUIControl.talkPanel !=null){
			MainUIControl.talkPanel.removeSelf();
			MainUIControl.talkPanel=null;
			console.log("移除 TalkPanel --》 ");
		}
	}

	MainUIControl.me=null;
	MainUIControl.talkPanel=null;
	return MainUIControl;
})()


//class huamao.panel.union.ShenQingData
var ShenQingData=(function(){
	function ShenQingData(){
		this.playerId=0;
		this.playerName=null;
		this.playerLv=0;
		this.job=0;
		this.time=0;
	}

	__class(ShenQingData,'huamao.panel.union.ShenQingData');
	return ShenQingData;
})()


//class huamao.panel.union.UnionData
var UnionData=(function(){
	function UnionData(){
		this.id=0;
		this.unionName=null;
		this.unionLv=0;
		this.Banner=0;
		this.playerNum=0;
		this.notice=null;
		this.mengZhu=null;
		this.job=0;
	}

	__class(UnionData,'huamao.panel.union.UnionData');
	return UnionData;
})()


//class huamao.panel.union.UnionPlayer
var UnionPlayer=(function(){
	function UnionPlayer(){
		this.unionId=0;
		this.playerId=0;
		this.playerName=null;
		this.playerLv=0;
		/**职务 0 成员 8副盟主 9主盟主 */
		this.zhiWu=0;
		this.dayScore=0;
		this.allScore=0;
		this.loginTime=0;
		this.logoutTime=0;
	}

	__class(UnionPlayer,'huamao.panel.union.UnionPlayer');
	var __proto=UnionPlayer.prototype;
	/**0不在线 1在线*/
	__proto.getLine=function(){
		var line=0;
		if(this.loginTime>this.logoutTime){
			line=1;
		}
		return line;
	}

	return UnionPlayer;
})()


//class huamao.panel.worldMap.GameMap
var GameMap=(function(){
	function GameMap(){}
	__class(GameMap,'huamao.panel.worldMap.GameMap');
	GameMap.mapId=10000;
	GameMap.windowScaleX=NaN;
	GameMap.windowScaleY=NaN;
	GameMap.mapWidth=0;
	GameMap.mapHeight=0;
	GameMap.cellWidth=0;
	GameMap.cellHeight=0;
	GameMap.scaleWidth=NaN;
	GameMap.scaleHeight=NaN;
	GameMap.tempX=NaN;
	GameMap.tempY=NaN;
	return GameMap;
})()


//class huamao.panel.wujiangxinxi.OpenData
var OpenData=(function(){
	function OpenData(bigType,arr){
		this.bigType=0;
		this.arr=null;
		this.arr=arr;
		this.bigType=bigType;
	}

	__class(OpenData,'huamao.panel.wujiangxinxi.OpenData');
	var __proto=OpenData.prototype;
	__proto.getLabel=function(){
		var strArr=[];
		for (var i=0;i < this.arr.length;i+=2){
			strArr.push(this.arr[i]);
		}
		return strArr.toString();
	}

	__proto.getType=function(index){
		return this.arr[index*2+1];
	}

	return OpenData;
})()


//class huamao.panel.zhaomu.SoulFly
var SoulFly=(function(){
	function SoulFly(){
		this.mc=null;
		this.sX=0;
		this.sY=0;
		this.eX=0;
		this.eY=0;
		this.lastPo=new Point();
	}

	__class(SoulFly,'huamao.panel.zhaomu.SoulFly');
	var __proto=SoulFly.prototype;
	__proto.run=function(sX,sY,eX,eY){
		this.eY=eY;
		this.eX=eX;
		this.sY=sY;
		this.sX=sX;
		this.mc=new DragonBonesMc(false);
		this.mc.setUrl("res/load/lgtxlastone.sk");
		Laya.stage.addChild(this.mc);
		this.mc.pos(sX,sY);
		this.resetPo();
		Laya.timer.once(100,this,this.delayFun);
	}

	__proto.delayFun=function(){
		var bezierMove=new BezierMove();
		bezierMove.start(1000,new Handler(this,this.comFun),new Handler(this,this.updateFun),this.sX,this.sY,this.eX,this.eY,0);
		var tween=new Tween();
		tween.to(this.mc,{scaleX:0.3,scaleY:0.3},500);
		this.mc.scale(0.75,0.75);
	}

	__proto.comFun=function(){
		var tween=new Tween();
		tween.to(this.mc,{alpha:0},200,null,new Handler(this,this.comFun2));
	}

	__proto.comFun2=function(){
		this.mc.removeSelf();
	}

	__proto.updateFun=function(p){
		this.mc.x=p.x;
		this.mc.y=p.y;
		this.mc.rotation=180 / Math.PI *(Math.atan2(this.mc.y-this.lastPo.y ,this.mc.x-this.lastPo.x))+90;
		this.resetPo();
	}

	__proto.resetPo=function(){
		this.lastPo.setTo(this.mc.x,this.mc.y);
	}

	SoulFly.fly=function(sX,sY,eX,eY){
		var soulFly=new SoulFly();
		soulFly.run(sX,sY,eX,eY);
	}

	return SoulFly;
})()


//class huamao.session.HuoyueDaySession
var HuoyueDaySession=(function(){
	function HuoyueDaySession(){
		this.arrData=[];
		this.giftArr=[];
		this.huoYueDu=0;
		;
	}

	__class(HuoyueDaySession,'huamao.session.HuoyueDaySession');
	return HuoyueDaySession;
})()


//class huamao.session.TaskData
var TaskData=(function(){
	function TaskData(){
		this.taskId=0;
		this.nowValue=0;
		this.maxValue=0;
		this.status=0;
		this.type=0;
		this.systask=null;
		this.isOk=0;
		this.end=0;
	}

	__class(TaskData,'huamao.session.TaskData');
	var __proto=TaskData.prototype;
	__proto.getShowName=function(){
		if(this.systask!=null){
			return this.systask.taskName;
		}
		if(this.type==100){
			var td=ConfigManager.getConfig("sys_task.txt",1001);
			return td.taskName;
		}
		return "-?";
	}

	TaskData.TaskHidden=0;
	TaskData.TaskShow=1;
	TaskData.TaskAccept=2;
	TaskData.TaskComplete=3;
	TaskData.TaskEnd=4;
	TaskData.TypeHonour=100;
	TaskData.TypeKing=101;
	TaskData.TypeNewPlayer=102;
	TaskData.TypeGPlayer=103;
	TaskData.isboxVisble=0;
	return TaskData;
})()


//class huamao.sys.ItemType
var ItemType=(function(){
	function ItemType(){}
	__class(ItemType,'huamao.sys.ItemType');
	ItemType.BING_FU=11;
	return ItemType;
})()


//class huamao.sys.SkillWake
var SkillWake=(function(){
	function SkillWake(){
		this.wakeSkillId=0;
		this.wakeSkillName=null;
		this.wakeSkillLevel=0;
		this.wakeSkillType=0;
		this.wakeSkillActivateLimit=0;
		this.wakeSkillBindChance=0;
		this.wakeSkillDamage=null;
		this.wakeSkillStatus=null;
		this.wakeSkillDescription=null;
	}

	__class(SkillWake,'huamao.sys.SkillWake');
	return SkillWake;
})()


//class huamao.sys.SysActivity
var SysActivity=(function(){
	function SysActivity(){
		this.activityId=0;
		this.activityType=0;
		this.subNumber=0;
		this.activityTarget=null;
		this.activateType=0;
		this.activityTitle=null;
		this.activityDescribe=null;
		this.activityReward=null;
		this.timeType=0;
		this.activityTime=null;
		this.cycle=0;
		this.interval=0;
		this.displayType=0;
		this.order=0;
	}

	__class(SysActivity,'huamao.sys.SysActivity');
	SysActivity.getArrByType=function(type){
		var arr=SysActivity.obj[type];
		if(arr==null){
			SysActivity.obj[type]=[];
			arr=SysActivity.obj[type];
			var bigArr=ConfigManager.getDataArr("sys_activity.txt");
			var sys;
			for(var $each_sys in bigArr){
				sys=bigArr[$each_sys];
				if(sys.activityType==type){
					arr[arr.length]=sys;
				}
			}
			return arr;
		}
		else{
			return arr;
		}
	}

	SysActivity.getSigninData=function(subType){
		var list=[];
		var arr=SysActivity.getArrByType(4);
		var sys;
		for(var $each_sys in arr){
			sys=arr[$each_sys];
			if(sys.cycle==subType){
				list.push(sys);
			}
		}
		list.sort(function(a,b){
			return a.activityId-b.activityId;
		});
		return list;
	}

	__static(SysActivity,
	['obj',function(){return this.obj=new Object();}
	]);
	return SysActivity;
})()


//class huamao.sys.SysActivityCondition
var SysActivityCondition=(function(){
	function SysActivityCondition(){
		this.activityType=0;
		this.activateType=0;
		this.activityCondition=null;
	}

	__class(SysActivityCondition,'huamao.sys.SysActivityCondition');
	return SysActivityCondition;
})()


//class huamao.sys.SysAttrName
var SysAttrName=(function(){
	function SysAttrName(){
		this.attrId=0;
		this.attrName=null;
		this._attrTrans=null;
		this.attrTransArr=null;
	}

	__class(SysAttrName,'huamao.sys.SysAttrName');
	var __proto=SysAttrName.prototype;
	__getset(0,__proto,'attrTrans',function(){
		return this._attrTrans;
		},function(value){
		this.attrTransArr=[];
		this._attrTrans=value;
		var arr=value.split(",");
		for(var i=0;i<arr.length;i++){
			this.attrTransArr.push(parseInt(arr[i]));
		}
	});

	SysAttrName.getAttrTrans=function(mainAttrId,childAttrId){
		var list=ConfigManager.getDataArr("sys_attr_name.txt");
		var attr;
		for(var $each_attr in list){
			attr=list[$each_attr];
			if (attr.attrId !=mainAttrId){
				continue ;
			}
			if (attr.attrTransArr.length==0){
				return 0;
			};
			var len=attr.attrTransArr.length;
			for(var i=0;i<len;i+=2){
				if (attr.attrTransArr[i]==childAttrId){
					return Math.floor(attr.attrTransArr[i+1]);
				}
			}
		}
		return 0;
	}

	SysAttrName.ATTRID_FORCE=1001;
	SysAttrName.ATTRID_RESIST=1002;
	SysAttrName.ATTRID_WISDOM=1003;
	SysAttrName.ATTRID_MIGHT=1004;
	SysAttrName.ATTRID_ATTACK=1005;
	SysAttrName.ATTRID_DEFENSE=1006;
	SysAttrName.ATTRID_STRATAGEMATTACK=1007;
	SysAttrName.ATTRID_STRATAGEMDEFENSE=1008;
	SysAttrName.ATTRID_SOLDIERMAX=1009;
	return SysAttrName;
})()


//class huamao.sys.SysBuff
var SysBuff=(function(){
	function SysBuff(){
		this.buffId=0;
		this.buffName="";
		this.buffDescription="";
		this.buffGain=0;
		this.buffDisplay=0;
		this.buffEffect=0;
	}

	__class(SysBuff,'huamao.sys.SysBuff');
	return SysBuff;
})()


//class huamao.sys.SysBuilding
var SysBuilding=(function(){
	function SysBuilding(){
		this.buildId=0;
		this.buildName=null;
		this.buildType=0;
		this.buildLevel=0;
		this.upgradeCost=0;
		this.upgradeTime=0;
		this.buildOutput=0;
		this.buildAttack=0;
		this.buildDefense=0;
		this.buildText=null;
	}

	__class(SysBuilding,'huamao.sys.SysBuilding');
	SysBuilding.JUMING=1;
	SysBuilding.JISHI=2;
	SysBuilding.NONGTIAN=3;
	return SysBuilding;
})()


//class huamao.sys.SysCity
var SysCity=(function(){
	function SysCity(){
		this.cityId=0;
		this.cityName=null;
		this.cityType=0;
		this.cityRelation=null;
		this.maxMainBuildingLevel=0;
		this.cityFlag=null;
		this.land=0;
		this.cityCamp=0;
		this.cityCircle=0;
		this.cityGuide=0;
	}

	__class(SysCity,'huamao.sys.SysCity');
	return SysCity;
})()


//class huamao.sys.SysCost
var SysCost=(function(){
	function SysCost(){
		this.costId=0;
		this.buildLimit=0;
		this.argentumCost=0;
		this.goldCost=0;
		/**个人贡献*/
		this.contribution=0;
		/**建设值*/
		this.allianceLvup=0;
		this.contributionId=0;
		this.allianceLvupid=0;
	}

	__class(SysCost,'huamao.sys.SysCost');
	return SysCost;
})()


//class huamao.sys.SysDraw
var SysDraw=(function(){
	function SysDraw(){
		this.drawId=0;
		this.drawType=0;
		this.drawNumber=0;
		this.drawRate=0;
		this.drawQuality=0;
		this.drawCount=0;
	}

	__class(SysDraw,'huamao.sys.SysDraw');
	return SysDraw;
})()


//class huamao.sys.SysDrawAward
var SysDrawAward=(function(){
	function SysDrawAward(){
		this.drawAwardId=0;
		this.drawAwardNeed=0;
		this.drawAward=0;
	}

	__class(SysDrawAward,'huamao.sys.SysDrawAward');
	return SysDrawAward;
})()


//class huamao.sys.SysDrop
var SysDrop=(function(){
	function SysDrop(){
		this.dropId=0;
		this.dropType=0;
		this.dropItem=null;
		this.dropWeight=null;
	}

	__class(SysDrop,'huamao.sys.SysDrop');
	var __proto=SysDrop.prototype;
	//必掉物品列表，概率掉落后台发送物品列表
	__proto.getDropList=function(isObj){
		(isObj===void 0)&& (isObj=false);
		var ary=[];
		var aryCount=0;
		var weightR=true;
		var weightAry=this.dropWeight.split(",");
		for(var i=0;i<weightAry.length;i++){
			if(parseInt(weightAry[i])!=10000){
				weightR=false;
				break ;
			}
		}
		if(this.dropType==0 && weightR){
			var itemAry=this.dropItem.split(".");
			for(i=0;i<itemAry.length;i++){
				var itemT=(itemAry [i]).split(",");
				var itemid=parseInt(itemT[0]);
				var minNum=parseInt(itemT[1]);
				var maxNum=parseInt(itemT[2]);
				if(isObj){
					ary[aryCount++]=[itemid,maxNum];
				}
				else{
					ary[aryCount++]=itemid;
					ary[aryCount++]=maxNum;
				}
			}
		}
		return ary;
	}

	return SysDrop;
})()


//class huamao.sys.SysEquip
var SysEquip=(function(){
	function SysEquip(){
		this.equipId=0;
		this.courage=0;
		//勇
		this.defense=0;
		//御
		this.intelligence=0;
		//智
		this.prestiage=0;
		//威
		this.phyAttack=0;
		//物攻
		this.phyDefense=0;
		//物防
		this.magAttack=0;
		//魔攻
		this.magDefense=0;
		//魔防
		this.maxHp=0;
		//血量
		this.crit=0;
		//暴击
		this.miss=0;
		//闪避
		this.seeThrough=0;
		//识破
		this.phyDmgReduce=0;
		//物伤减免
		this.magDmgReduce=0;
		//计策减免
		this.dmgReduce=0;
		//伤害减免
		this.detailType=0;
	}

	__class(SysEquip,'huamao.sys.SysEquip');
	var __proto=SysEquip.prototype;
	//1枪 2刀 3剑 4扇 5甲 6袍 7马
	__proto.getArr=function(){
		var arr=[];
		arr.push(this.courage);
		arr.push(this.defense);
		arr.push(this.intelligence);
		arr.push(this.prestiage);
		arr.push(this.phyAttack);
		arr.push(this.phyDefense);
		arr.push(this.magAttack);
		arr.push(this.magDefense);
		arr.push(this.maxHp);
		arr.push(this.crit);
		arr.push(this.miss);
		arr.push(this.seeThrough);
		arr.push(this.phyDmgReduce);
		arr.push(this.magDmgReduce);
		arr.push(this.dmgReduce);
		return arr;
	}

	__proto.getAry=function(){
		var reslt=[];
		var i=0;
		if(this.courage !=0){reslt[i++]="勇";reslt[i++]=this.courage };
		if(this.defense !=0){reslt[i++]="御";reslt[i++]=this.defense };
		if(this.intelligence !=0){reslt[i++]="智";reslt[i++]=this.intelligence };
		if(this.prestiage !=0){reslt[i++]="威";reslt[i++]=this.prestiage };
		if(this.phyAttack !=0){reslt[i++]="物攻";reslt[i++]=this.phyAttack };
		if(this.phyDefense !=0){reslt[i++]="物防";reslt[i++]=this.phyDefense };
		if(this.magAttack !=0){reslt[i++]="魔攻";reslt[i++]=this.magAttack };
		if(this.magDefense !=0){reslt[i++]="魔防";reslt[i++]=this.magDefense };
		if(this.maxHp !=0){reslt[i++]="血量";reslt[i++]=this.maxHp };
		if(this.crit !=0){reslt[i++]="暴击";reslt[i++]=this.crit };
		if(this.miss !=0){reslt[i++]="闪避";reslt[i++]=this.miss };
		if(this.seeThrough !=0){reslt[i++]="识破";reslt[i++]=this.seeThrough };
		if(this.phyDmgReduce !=0){reslt[i++]="物伤减免";reslt[i++]=this.phyDmgReduce };
		if(this.magDmgReduce !=0){reslt[i++]="计策减免";reslt[i++]=this.magDmgReduce };
		if(this.dmgReduce !=0){reslt[i++]="伤害减免";reslt[i++]=this.dmgReduce };
		return reslt;
	}

	return SysEquip;
})()


//class huamao.sys.SysEstimate
var SysEstimate=(function(){
	function SysEstimate(){
		this.estimate=null;
		this.estimateCondition=null;
	}

	__class(SysEstimate,'huamao.sys.SysEstimate');
	return SysEstimate;
})()


//class huamao.sys.SysForce
var SysForce=(function(){
	function SysForce(){
		this.forceId=0;
		this.forceName="";
		this.forceType=0;
		//1步兵 2骑兵 3弓兵 4特殊兵种
		this.forceLevel=0;
		/**
		*加载自己方向的资源
		*/
		this.forceResource="";
		this.forceBody="";
		this.copperCost=0;
		/**
		*专职时需要消耗的转职书数量
		*/
		this.forceChange=0;
		//转职虎符消耗
		this.forceChangeGold=0;
		//转职元宝消耗
		this.forceDescription="";
		this.forceCondition="";
		this.forceTalent="";
		this.forceStatus="";
		this.forceBook=0;
		//解锁兵书消耗
		this.forceBookGold=0;
		//解锁元宝消耗
		this.forceAtkmode=0;
	}

	__class(SysForce,'huamao.sys.SysForce');
	return SysForce;
})()


//class huamao.sys.SysGuide
var SysGuide=(function(){
	function SysGuide(){
		this.guideType=0;
		//引导类型 0:强制 1触发引导（触发一次就不在触发了）
		this.guideId=0;
		//引导步骤
		this.guideStop=0;
		//1:继续下一引导 0：停止引导
		this.guideStep=0;
		//小步骤
		this.keyStep=0;
		//关键步 0:非关键步 1：关键步
		this.compensateStep=0;
		//补偿步骤
		this.uiType=0;
		//UI类型 1剧情 2事件 3特效
		this.character=null;
		//人物icon 1.玩家自己
		this.characterName=null;
		//人物名字 1.玩家自己的名字
		this.content=null;
		//引导剧情
		this.direction=0;
		//人物方向 1:left 2:right
		this.faceDirection=0;
		//
		this.checkBox=0;
		//选中框 美术资源
		this.arrow=0;
		//箭头 0:不显示 1234:上下左右
		this.scene=0;
		//场景 1城外 2城内
		this.panel=null;
		//界面 "1":地图
		this.button=null;
		//按钮 panel="1" 则代表城市id
		this.event=null;
		this.jump=0;
		//下一步是否打开ui 1：是 0：否
		this.unlockStep=0;
		//需要记录给前端解锁功能
		this.unlockWait=0;
		//是否需要等待特效完成
		this.bubbleContent=null;
		//气泡文字
		this.bubble=0;
	}

	__class(SysGuide,'huamao.sys.SysGuide');
	var __proto=SysGuide.prototype;
	//气泡方向
	__proto.printKey=function(){
		console.log(this.guideId+"_"+this.guideStep+"_"+this.compensateStep);
	}

	SysGuide.initLastStep=function(){
		var bigStep=1;
		var smlStep=1;
		while(true){
			var resultbig=ConfigManager.getConfig("sys_guide.txt",bigStep+"_"+smlStep+"_"+0);
			if(resultbig !=null){
				while(true){
					var resultsml=ConfigManager.getConfig("sys_guide.txt",bigStep+"_"+smlStep+"_"+0);
					if(resultsml !=null){
						SysGuide.map[bigStep]=resultsml;
						smlStep++;
						}else{
						bigStep++;
						smlStep=1;
						break ;
					}
				}
				}else{
				return;
			}
		}
	}

	SysGuide.getLastStep=function(bigstep){
		return (SysGuide.map [bigstep]);
	}

	SysGuide._setStep=function(big,sml,com){
		SysGuide.bigStep=big;
		SysGuide.smlStep=sml;
		SysGuide.comStep=com;
	}

	SysGuide.clearStep=function(){
		SysGuide._setStep(0,0,0);
		SysGuide.setKeyStep(0);
	}

	SysGuide.getGuideViewDongZhuo=function(){
		return SysGuide.bigStep < 1;
	}

	SysGuide.getCurstep=function(){
		return SysGuide.bigStep;
	}

	SysGuide.setCurStep=function(_bigStep){
		SysGuide._setStep(_bigStep,1,0);
	}

	SysGuide.setKeyStep=function(_keyStep){
		SysGuide.KeyStep=_keyStep;
	}

	SysGuide.getKeyStep=function(){
		console.log("当前 KeyStep = "+SysGuide.KeyStep);
		return SysGuide.KeyStep;
	}

	SysGuide.getNormalStep=function(old){
		var result=null;
		if(old==null){
			result=ConfigManager.getConfig("sys_guide.txt",(SysGuide.bigStep+1)+"_"+1+"_"+0);
			if(result !=null){
				SysGuide._setStep(SysGuide.bigStep+1,1,0);
			}
			}else{
			result=ConfigManager.getConfig("sys_guide.txt",SysGuide.bigStep+"_"+(SysGuide.smlStep+1)+"_"+0);
			if(result !=null){
				SysGuide._setStep(SysGuide.bigStep,SysGuide.smlStep+1,0);
				}else{
				result=ConfigManager.getConfig("sys_guide.txt",(SysGuide.bigStep+1)+"_"+1+"_"+0);
				if(result !=null){
					SysGuide._setStep(SysGuide.bigStep+1,1,0);
				}
			}
		}
		return result;
	}

	SysGuide.getCompensateStep=function(old){
		var result=null;
		if(old==null){
			result=ConfigManager.getConfig("sys_guide.txt",(SysGuide.bigStep+1)+"_"+0+"_"+1);
			if(result==null){
				result=SysGuide.getNormalStep(old);
				}else{
				SysGuide._setStep(SysGuide.bigStep+1,0,1);
			}
			}else{
			result=ConfigManager.getConfig("sys_guide.txt",SysGuide.bigStep+"_"+0+"_"+(SysGuide.comStep+1));
			if(result==null){
				SysGuide._setStep(SysGuide.bigStep,0,0);
				result=SysGuide.getNormalStep(old);
				}else{
				SysGuide._setStep(SysGuide.bigStep,0,SysGuide.comStep+1);
			}
		}
		return result;
	}

	SysGuide.getStepSysGuide=function(_bigStep,_smalStep){
		(_smalStep===void 0)&& (_smalStep=1);
		var result=ConfigManager.getConfig("sys_guide.txt",_bigStep+"_"+_smalStep+"_"+0);
		if(result !=null){
			SysGuide.setCurStep(_bigStep);
		}
		return result;
	}

	SysGuide.getNextStep=function(old){
		var result=null;
		if(old==null){
			result=SysGuide.getLastStep(SysGuide.bigStep);
			if(SysGuide.bigStep !=2 && result !=null && result.guideStop==0){
				return null;
			}
			result=SysGuide.getCompensateStep(old);
			}else{
			if(old.guideStop==0){
				return null;
				}else if(old.compensateStep !=0){
				result=SysGuide.getCompensateStep(old);
				}else{
				result=SysGuide.getNormalStep(old);
			}
		}
		return result;
	}

	SysGuide.bigStep=0;
	SysGuide.smlStep=0;
	SysGuide.comStep=0;
	SysGuide.KeyStep=0;
	__static(SysGuide,
	['map',function(){return this.map=new Object();}
	]);
	return SysGuide;
})()


//class huamao.sys.SysHero
var SysHero=(function(){
	function SysHero(){
		this.heroId=0;
		this.heroName=null;
		this.heroColor=0;
		this.heroCountry=0;
		/**勇 */
		this.heroCourage=0;
		/**御 */
		this.heroDef=0;
		/**智 */
		this.heroInt=0;
		/**威 */
		this.heroPrestige=0;
		this.heroPoint=0;
		this.recruit=0;
		this.moneyRecruit=0;
		this.heroSn=0;
		this.growthCourage=0;
		this.growthDef=0;
		this.growthInt=0;
		this.growthPrestige=0;
		this.heroDefaultSkill=0;
		this.heroSpeed=0;
		this.heroAttackSpd=0;
		this._heroTalent=null;
		// 天赋ID，天赋属性值，激活需要武魂数量，激活需要的官职
		this.talentArr=[];
		this.heroResId=0;
		this._heroForce="";
		this._heroMixSkill="";
		this._heroWakeSkill=0;
		/**
		*推荐副将
		*/
		this.viceHero=null;
		/**
		*推荐主将
		*/
		this.mainHero=null;
		this.forceArr=[];
		this.mixSkillArr=[];
	}

	__class(SysHero,'huamao.sys.SysHero');
	var __proto=SysHero.prototype;
	__proto.getForceNameArr=function(){
		var ary=[];
		for(var i=0;i<this.forceArr.length;i++){
			var id=this.forceArr[i];
			var sysForce=ConfigManager.getConfig("sys_force.txt",id);
			ary[i]=sysForce.forceName;
		}
		return ary;
	}

	/**
	*@param star
	*@return
	*得到成长值
	*/
	__proto.getGrowth=function(star){
		if(star==-1){
			return [];
		};
		var arr=[];
		arr.push(this.getAddPer(this.growthCourage,star));
		arr.push(this.getAddPer(this.growthDef,star));
		arr.push(this.getAddPer(this.growthInt,star));
		arr.push(this.getAddPer(this.growthPrestige,star));
		return arr;
	}

	__proto.getAddPer=function(value,star){
		var sys=ConfigManager.getConfig("sys_timetake.txt",36);
		var str=(value *(100+star *sys.timeCd)/ 1000).toFixed(2);
		return parseFloat(str);
	}

	/**
	*@private
	*/
	/**
	*觉醒技能
	*/
	__getset(0,__proto,'heroWakeSkill',function(){
		return this._heroWakeSkill;
		},function(value){
		this._heroWakeSkill=value;
	});

	__getset(0,__proto,'heroForce',function(){
		return this._heroForce;
		},function(value){
		this._heroForce=value;
		var split=value.split(",");
		for (var i=0;i < split.length;i++){
			this.forceArr.push(parseInt(split[i]));
		}
	});

	__getset(0,__proto,'heroMixSkill',function(){
		return this._heroMixSkill;
		},function(value){
		this._heroMixSkill=value;
		if(value==""){
			return;
		};
		var split=value.split(",");
		for (var i=0;i < split.length;i++){
			this.mixSkillArr.push(split[i]);
		}
	});

	__getset(0,__proto,'heroTalent',function(){
		return this._heroTalent;
		},function(value){
		this._heroTalent=value;
		var arr=value.split(",");
		for (var i=0;i < arr.length;i+=2){
			var t=new Talent();
			t.id=parseInt(arr[i]);
			t.value=parseInt(arr[i+1]);
			this.talentArr.push(t);
		}
	});

	__static(SysHero,
	['ColorPng',function(){return this.ColorPng=["comp/zhaomu/ka_lv.png","comp/zhaomu/ka_lan.png","comp/zhaomu/ka_zi.png","comp/zhaomu/ka_jin.png","comp/G/ka_bei.jpg"];},'ColorPng2',function(){return this.ColorPng2=["comp/G/k_lvka.png","comp/G/k_lanka.png","comp/G/k_zika.png","comp/G/k_jinka.png","comp/G/ka_bei.png"];},'GuoUrl',function(){return this.GuoUrl=["comp/GG/0_shuguo.png","comp/GG/0_wuguo.png","comp/GG/0_weiguo.png","comp/GG/0_qunxiong.png","comp/GG/0_shuguo.png"];},'GuoZhong',function(){return this.GuoZhong=["蜀","吴","魏","群","晋"];},'GuoSe',function(){return this.GuoSe=["60fe67","ff8d77","77bdff","ffcb4d","ff0000"];}
	]);
	return SysHero;
})()


//class huamao.sys.SysHeroProgress
var SysHeroProgress=(function(){
	function SysHeroProgress(){
		this.heroColor=0;
		this.heroStar=0;
		this.soulCost=0;
		this.nextStar=0;
		this.titleLimit=0;
		this.heroDecompose=0;
		//分解返还武魂
		this.heroCompose=0;
		this.heroResetCost=0;
		//重置需要消耗的武魂重置丹
		this.heroResetSoul=0;
	}

	__class(SysHeroProgress,'huamao.sys.SysHeroProgress');
	return SysHeroProgress;
})()


//class huamao.sys.SysHeroQueue
var SysHeroQueue=(function(){
	function SysHeroQueue(){
		this.queueId=0;
		this.queueName="";
		this.queueHeroLimit=0;
		this.queueHeroUnlock=0;
	}

	__class(SysHeroQueue,'huamao.sys.SysHeroQueue');
	return SysHeroQueue;
})()


//class huamao.sys.SysHeroReset
var SysHeroReset=(function(){
	function SysHeroReset(){
		this.resetTime=0;
		this.resetCost=0;
	}

	__class(SysHeroReset,'huamao.sys.SysHeroReset');
	return SysHeroReset;
})()


//class huamao.sys.SysItem
var SysItem=(function(){
	function SysItem(){
		//马-空闲
		this.itemId=0;
		this.itemName=null;
		this.itemIcon=0;
		this.itemType=0;
		//1:武器 2:衣服 3:坐骑 4:计策 5:契约 6:宝箱 7:招募令 8:武魂 9:礼包 99:货币道具 12:武将碎片
		this.itemTag=0;
		//0:道具 1:装备 2:宝箱 99:不进包
		this.itemColor=0;
		this.itemDescription=null;
		this.canSell=0;
		this.sellPrice=0;
		this.canUse=0;
		//0:不能使用 1仅对局内背包内用 2仅对局内背包外用 3对局内都可用 4对局内外都可用
		this.useScript=null;
		this.canSuperpose=0;
		//是否可堆叠 0:no 1:yes
		this.itemExpiration=0;
		//时间限制-1永远有效
		this.itemTitleLimit=0;
		//官职限制
		this.canUseAllSuperposition=0;
		//是否可以一次使用多个
		this.itemTipsType=0;
	}

	__class(SysItem,'huamao.sys.SysItem');
	var __proto=SysItem.prototype;
	//能否出售
	__proto.ifCanSell=function(){
		return (this.canSell==1);
	}

	//ifInBag:true:背包内调用 false:被保外调用
	__proto.ifCanUse=function(ifInBag){
		var ifInMap=true;
		var result=false;
		if(this.canUse==0){
			result=false;
			}else if(this.canUse==1){
			if(ifInMap && ifInBag){
				result=true;
			}
			}else if(this.canUse==2){
			if(ifInMap && !ifInBag){
				result=true;
			}
			}else if(this.canUse==3){
			if(ifInMap){
				result=true;
			}
			}else if(this.canUse==4){
			result=true;
		}
		return result;
	}

	//是否可以一次使用多个
	__proto.ifCanUseAllSuperPosition=function(){
		return (this.canUseAllSuperposition==1);
	}

	SysItem.getDataFromItemId=function(itemid){
		return (ConfigManager.getConfig("sys_item.txt",itemid));
	}

	SysItem.ITEM=0;
	SysItem.EQUIP=1;
	SysItem.BOX=2;
	SysItem.CaiYuanGunGun=4001;
	SysItem.WuGuFengDeng=4002;
	SysItem.ZhaoBingMaiMa=4003;
	SysItem.XingJunJiaSu=4004;
	SysItem.NengGongQiaoJiang=4005;
	SysItem.LuBanZaiShi=4006;
	SysItem.QianLiChiYuan=4007;
	SysItem.EquipType_Wu=1;
	SysItem.EquipType_Fang=2;
	SysItem.EquipType_Ma=3;
	SysItem.Qiang=1;
	SysItem.Dao=2;
	SysItem.Jian=3;
	SysItem.Shan=4;
	SysItem.Jia=5;
	SysItem.Pao=6;
	SysItem.All_Ma=7;
	SysItem.Kong_Wu=10;
	SysItem.Kong_Fang=11;
	SysItem.Kong_Ma=12;
	return SysItem;
})()


//class huamao.sys.SysLan
var SysLan=(function(){
	function SysLan(){
		this.key=null;
		this.value=null;
	}

	__class(SysLan,'huamao.sys.SysLan');
	return SysLan;
})()


//class huamao.sys.SysLevelHero
var SysLevelHero=(function(){
	function SysLevelHero(){
		this.heroLevel=0;
		this.heroExp=0;
	}

	__class(SysLevelHero,'huamao.sys.SysLevelHero');
	return SysLevelHero;
})()


//class huamao.sys.SysLevelLord
var SysLevelLord=(function(){
	function SysLevelLord(){
		this.lordLevel=0;
		this.lordExp=0;
	}

	__class(SysLevelLord,'huamao.sys.SysLevelLord');
	return SysLevelLord;
})()


//class huamao.sys.SysLordbody
var SysLordbody=(function(){
	function SysLordbody(){
		this.lordBodyId=0;
		this.lordRes=null;
		this.lordHeadBig=null;
		this.lordHeadSmall=null;
	}

	__class(SysLordbody,'huamao.sys.SysLordbody');
	return SysLordbody;
})()


//class huamao.sys.SysMail
var SysMail=(function(){
	function SysMail(){
		/**
		*id
		*/
		this.mailID=0;
		/**
		*邮件类型
		*/
		this.mailType=0;
		/**
		*内容
		*/
		this.mailContent=null;
		/**
		*图标
		*/
		this.mailIcon=0;
		/**
		*活动类型 只有活动邮件用到了
		*/
		this.activityType=0;
	}

	__class(SysMail,'huamao.sys.SysMail');
	return SysMail;
})()


//class huamao.sys.SysMath
var SysMath=(function(){
	function SysMath(){
		this.titleId=0;
		this.roomName=null;
		this.roomDescribe=null;
		this.roomLevel=0;
		this.roomContent=0;
		this.startGold=0;
		// 开局铜钱
		this.startSupply=0;
		// 开局粮草
		this.startSoldier=0;
		// 开局预备役
		this.maxPlayer=0;
		// 开局最大玩家数
		this.titlePointLostLimit=0;
		// 连败最高扣除积分
		this.killTitlePoint=null;
		// 击杀官职积分奖励(最多城池,积分,最多城池,积分)
		this.battleTimeLordExp=0;
		// 征战时间经验
		this.unifyLordExp=0;
		// 君主统一经验
		this.unifyAloneLordExp=0;
		// 独统经验
		this.beatEnemyLordExp=0;
		// 君主消灭敌对势力经验奖励
		this.maxGameLength=0;
		// 最大对局时长，单位分钟
		this.maxSurrenderLength=0;
		// 允许投降时间，单位分钟
		this.battleChestReward=0;
		// 宝箱奖励，调用奖池ID
		this.dailyLimit=0;
		// 招兵买马每日最大限制
		this.defaultHero=null;
	}

	__class(SysMath,'huamao.sys.SysMath');
	return SysMath;
})()


//class huamao.sys.SysMember
var SysMember=(function(){
	function SysMember(){
		this.memberId=0;
		this.memberType=null;
		this.memberCost=NaN;
		this.memberTime=0;
		this.memberReward=null;
		this.memberBonusPlayerExp=0;
		this.memberBubble=0;
		this.memberDescribe=null;
		this.rechargeChannelStage=null;
		this.memberIcon=0;
		/**国际化*/
		this.rechargeCurrencyType=null;
	}

	__class(SysMember,'huamao.sys.SysMember');
	return SysMember;
})()


//class huamao.sys.SysName
var SysName=(function(){
	function SysName(){
		/**姓名随机四种*/
		this.adjective="";
		this.noun="";
		this.familyName="";
		this.name="";
	}

	__class(SysName,'huamao.sys.SysName');
	return SysName;
})()


//class huamao.sys.SysRecharge
var SysRecharge=(function(){
	function SysRecharge(){
		/**Id*/
		this.rechargeId=0;
		/**充值元宝数量*/
		this.rechargeGold=0;
		/**赠送的物品 id,数量*/
		this.rechargeGift=null;
		/**0：无限制 1：终身一次 2：每日一次 3：每周一次 4：每月一次*/
		this.rechargeLimitType=0;
		/**充值钱数*/
		this.rechargeCost=NaN;
		/**赠送道具显示内容*/
		this.rechargeDescribe=null;
		/**SDK平台*/
		this.rechargeChannelStage=null;
		/**国际化*/
		this.rechargeCurrencyType=null;
	}

	__class(SysRecharge,'huamao.sys.SysRecharge');
	return SysRecharge;
})()


//class huamao.sys.SysRecruitData
var SysRecruitData=(function(){
	function SysRecruitData(){
		this.recruitHero=0;
		this.recruitNormalWeight=0;
		this.recruitFirstNormalWeight="";
		this.recruitFirstFreeWeight=0;
		this.recruitFirstMoneyWeight=0;
		this.recruitMoneyWeight=0;
		this.recruitMoneyRank=0;
		this.recruitGuaranteeWeight=0;
		this.recruitHeroSoul=0;
	}

	__class(SysRecruitData,'huamao.sys.SysRecruitData');
	return SysRecruitData;
})()


//class huamao.sys.SysShop
var SysShop=(function(){
	function SysShop(){
		this.shopItemId=0;
		this.itemPrice=null;
		this.shopWeight=0;
		this.shopFriendPoint=0;
	}

	__class(SysShop,'huamao.sys.SysShop');
	var __proto=SysShop.prototype;
	__proto.getPriceType=function(){
		var ary=this.itemPrice.split(",");
		return parseInt(ary[0]);
	}

	__proto.getPriceNum=function(){
		var ary=this.itemPrice.split(",");
		return parseInt(ary[1]);
	}

	return SysShop;
})()


//class huamao.sys.SysSkill
var SysSkill=(function(){
	function SysSkill(){
		this.skillId=0;
		this.skillName="";
		this.skillRage=0;
		this.skillDescription="";
		this.skillRange=0;
		this.skillDamage="";
		this.skillStatus="";
		this.skillEffect=0;
		this.shake=0;
		this.skillNamePic=0;
	}

	__class(SysSkill,'huamao.sys.SysSkill');
	SysSkill.getSysEffect=function(skillId){
		var sys=ConfigManager.getConfig("sys_skill.txt",skillId);
		return ConfigManager.getConfig("sys_skill_effect.txt",sys.skillEffect);
	}

	return SysSkill;
})()


//class huamao.sys.SysSkillEffect
var SysSkillEffect=(function(){
	function SysSkillEffect(){
		this.effectId=0;
		this.effectAni="";
		/**effectId */
		this.hit=0;
		/**
		*0单体
		*1横排
		*2竖排
		*3全体
		*/
		this.effectRange=0;
		//打击的范围
		this.effectRes="";
		this.effectSound="";
	}

	__class(SysSkillEffect,'huamao.sys.SysSkillEffect');
	SysSkillEffect.SINGLE=0;
	SysSkillEffect.COL=1;
	SysSkillEffect.ROW=2;
	SysSkillEffect.ALL=3;
	return SysSkillEffect;
})()


//class huamao.sys.SysSkillMix
var SysSkillMix=(function(){
	function SysSkillMix(){
		this.mixSkillId=0;
		this.mixSkillName="";
		this._mixSkillHero="";
		this._mixSkillBuff="";
		this.mixHeroArr=[];
		this.property=0;
		this.add=0;
	}

	__class(SysSkillMix,'huamao.sys.SysSkillMix');
	var __proto=SysSkillMix.prototype;
	__getset(0,__proto,'mixSkillBuff',function(){
		return this._mixSkillBuff;
		},function(value){
		this._mixSkillBuff=value;
		var split=value.split(",");
		this.property=parseInt(split[0]);
		this.add=parseInt(split[1]);
	});

	__getset(0,__proto,'mixSkillHero',function(){
		return this._mixSkillHero;
		},function(value){
		this._mixSkillHero=value;
		var split=value.split(",");
		for (var i=0;i < split.length;i++){
			this.mixHeroArr.push(parseInt(split[i]));
		}
	});

	return SysSkillMix;
})()


//class huamao.sys.Syssociety
var Syssociety=(function(){
	function Syssociety(){
		this.societyId=0;
		this.buildCost=0;
		this.flagCost=0;
		this.reallianceCd=0;
		this.messageLimit=0;
		this.charactersLimit=0;
		this.playerLevel=0;
		this.dutiesId=0;
		this.createLevel=0;
		this.createDutiesId=0;
		this.applyLimit=0;
		this.applyNum=0;
	}

	__class(Syssociety,'huamao.sys.Syssociety');
	return Syssociety;
})()


//class huamao.sys.SysSound
var SysSound=(function(){
	function SysSound(){
		this.soundId=null;
		this.soundName=null;
	}

	__class(SysSound,'huamao.sys.SysSound');
	return SysSound;
})()


//class huamao.sys.SysStrategy
var SysStrategy=(function(){
	function SysStrategy(){
		this.strId=0;
		this.strName="";
		this.strCost="";
		this.strItem=0;
		this.strEffect=0;
	}

	__class(SysStrategy,'huamao.sys.SysStrategy');
	var __proto=SysStrategy.prototype;
	__proto.getCostNum=function(){
		var ary=this.strCost.split(",");
		return parseInt(ary[1]);
	}

	return SysStrategy;
})()


//class huamao.sys.SysStrength
var SysStrength=(function(){
	function SysStrength(){
		this.strengthColor=0;
		//道具品质颜色
		this.strengthLv=0;
		//当前强化等级
		this.strengthLordLv=0;
		//强化所需君主等级
		this.strengthItemNum=0;
		//强化所需道具数量
		this.strengthAttrCurrent=0;
		//当前属性加成
		this.strengthAttrBonus=0;
		//强化属性加成 进率1000
		this.strengthDecomposeItemNum=0;
		//分解可得道具数量
		this.strengthDecomposeItemNeed=null;
	}

	__class(SysStrength,'huamao.sys.SysStrength');
	return SysStrength;
})()


//class huamao.sys.SysTalent
var SysTalent=(function(){
	function SysTalent(){
		this.talentId=0;
		this.talentName="";
		this.talentDescription="";
	}

	__class(SysTalent,'huamao.sys.SysTalent');
	SysTalent.getName=function(id){
		var sys=ConfigManager.getConfig("sys_talent.txt",id);
		return sys.talentDescription;
	}

	SysTalent.getValue=function(id,value){
		var sys=ConfigManager.getConfig("sys_talent.txt",id);
		if(sys.talentId==1001){
			return value+"";
			}else{
			return value+"%";
		}
	}

	return SysTalent;
})()


//class huamao.sys.SysTask
var SysTask=(function(){
	function SysTask(){
		this.taskId=0;
		this.taskName="";
		this.taskStart=0;
		this.taskTarget="";
		this.taskDescription="";
		this.taskReward="";
		this.taskNext=0;
		this.taskTargetDisplay="";
		this.taskTargetMap=null;
	}

	__class(SysTask,'huamao.sys.SysTask');
	var __proto=SysTask.prototype;
	__proto.getValue=function(index){
		if(this.taskTargetMap==null){
			this.taskTargetMap=new Dictionary();
			if(this.taskTarget!=""){
				var lv1=this.taskTarget.split("\\.");
				for (var i=0;i < lv1.length;i++){
					var str1=lv1[i];
					var lv2=str1.split(",");
					var int2=[];
					for (var j=0;j < lv2.length-1;j++){
						int2[j]=parseInt(lv2[j+1]);
					}
					this.taskTargetMap[parseInt(lv2[0])]=int2;
				}
			}
		}
		return this.taskTargetMap[index];
	}

	__proto.getKyeValue=function(index){
		var lv1=this.taskTarget.split(",");
		return parseInt(lv1[lv1.length-1]);
	}

	__proto.showValue=function(td){
		if(td.type==100){
			if(td.end==1){
				return "今日功勋任务已经全部完成";
			};
			var nowValue=td.nowValue;
			var maxValue=td.systask.getValue(1)[1];
			var ss=this.taskTargetDisplay;
			if(ss.indexOf("\{\}/")>=0){
				var valuess=(nowValue>maxValue?maxValue:nowValue)+"/"+maxValue;
				ss=ss.replace("\{\}/",valuess);
			}
			return ss;
		}
		if(td.type==101){
			if(td.end==1){
				return "已经全部完成";
			}
			nowValue=td.nowValue;
			var arr=td.systask.getValue(2)
			maxValue=(arr==null?1:arr[1]);
			ss=this.taskTargetDisplay;
			if(ss.indexOf("\{\}/")>=0){
				valuess=(nowValue>maxValue?maxValue:nowValue)+"/"+maxValue;
				ss=ss.replace("\{\}/",valuess);
			}
			return ss;
		}
		if(td.type==102 || td.type==103){
			if(td.end==1){
				return "已经全部完成";
			}
			nowValue=td.nowValue;
			maxValue=td.systask.getKyeValue(1);
			ss=this.taskTargetDisplay;
			if(ss.indexOf("\{\}/")>=0){
				valuess=(nowValue>maxValue?maxValue:nowValue)+"/"+maxValue;
				ss=ss.replace("\{\}/",valuess);
			}
			return ss;
		}
		return "";
	}

	return SysTask;
})()


//class huamao.sys.SysTimeTake
var SysTimeTake=(function(){
	function SysTimeTake(){
		// 新手出证时间
		this.timeType=0;
		this.timeCd=0;
		this.timeMax=0;
		this.diamondCost=0;
		//钻石消耗
		this.supplyCostRatio=0;
	}

	__class(SysTimeTake,'huamao.sys.SysTimeTake');
	SysTimeTake.SHOP=0;
	SysTimeTake.FIGHT_MOVE=1;
	SysTimeTake.YUNSHU_NORMAL=2;
	SysTimeTake.RECRUIT_FREE=3;
	SysTimeTake.STRATAGEM=4;
	SysTimeTake.MYSTERIOUS_SHOP=5;
	SysTimeTake.RECRUT_ONE=6;
	SysTimeTake.RECRUT_FIVE=7;
	SysTimeTake.NIGHT_MARCH=8;
	SysTimeTake.ATK=11;
	SysTimeTake.SKILL=12;
	SysTimeTake.BUFF=13;
	SysTimeTake.JIASU=25;
	SysTimeTake.XINGJUNJIASU=26;
	SysTimeTake.LUBANZAISHI=27;
	SysTimeTake.NENGGONGQIAOJIANG=28;
	SysTimeTake.ZHAOBINGMAIMA=29;
	SysTimeTake.QIANLICHIYUAN=30;
	SysTimeTake.STAR_ADD_PER=36;
	SysTimeTake.EQUIP_STRENGTHEN_PER=37;
	SysTimeTake.MONTH_SALARY_GMAE_TIMES=43;
	SysTimeTake.STRATAGEMBUY=47;
	SysTimeTake.ShopMaxFlush=54;
	SysTimeTake.JunZhuTask=58;
	SysTimeTake.XINSHOU_YUNSHU_NORMAL=61;
	return SysTimeTake;
})()


//class huamao.sys.SysTips
var SysTips=(function(){
	function SysTips(){
		this.tipsId=0
		this.tipsDescribe="";
	}

	__class(SysTips,'huamao.sys.SysTips');
	return SysTips;
})()


//class huamao.sys.SysTitlePlayer
var SysTitlePlayer=(function(){
	function SysTitlePlayer(){
		this.titleId=0;
		this.titleRoom=0;
		//进入的房间
		this.titleName=null;
		//官职名称
		this.titleUpgradePoint=0;
		//升值积分经验
		this.titleMaxLordLv=0;
		//君主等级上限
		this.titleHoldPoint=0;
		//守职所需积分
		this.titleBonusBuilding=0;
		//城市产量加成
		this.titleBonusHeroExp=0;
		//武将经验加成
		this.titleBonusHonorPoint=0;
		//功勋获取加成
		this.titleBonusStrategyPack=null;
		//每日可领取计策锦囊的数量
		this.titlePackage=0;
		//官职礼包
		this.titleSalary=0;
		//月俸 dropid
		this.titileRecruitTime=0;
		//招募时间
		this.titleRight=null;
		//开启特权
		this.titleFreeShopRefresh=0;
		//商店免费刷新次数
		this.titleResetHeroSoul=0;
	}

	__class(SysTitlePlayer,'huamao.sys.SysTitlePlayer');
	var __proto=SysTitlePlayer.prototype;
	__proto.getTitleBounsBuildingString=function(){
		if(this.titleBonusBuilding !=0){
			return TheGame.FONT("城内建筑产量 ",SysTitlePlayer.red,20,null)+TheGame.FONT(" +"+this.titleBonusBuilding+"%",SysTitlePlayer.green,20,null);
		}
		return "";
	}

	__proto.getTitleBonusHeroExpString=function(){
		if(this.titleBonusHeroExp !=0){
			return TheGame.FONT("武将经验获得 ",SysTitlePlayer.red,20,null)+TheGame.FONT(" +"+this.titleBonusHeroExp+"%",SysTitlePlayer.green,20,null);
		}
		return "";
	}

	__proto.getTitleBonusstrategyPackString=function(){
		var array=this.titleBonusStrategyPack.split(",");
		var result="";
		if(array.length > 1){
			result=TheGame.FONT("每日可领计策包 ",SysTitlePlayer.red,20,null)+TheGame.FONT(array[1]+"",SysTitlePlayer.green,20,null)+TheGame.FONT("个 ",SysTitlePlayer.red,20,null);
		}
		if(array.length > 2){
			result+=TheGame.FONT(",元宝 ",SysTitlePlayer.red,20,null)+TheGame.FONT(array[3]+"",SysTitlePlayer.green,20,null)+TheGame.FONT("个 ",SysTitlePlayer.red,20,null);
		}
		return result;
	}

	__proto.getTitleBonusHonorPointString=function(){
		if(this.titleBonusHonorPoint !=0){
			return TheGame.FONT("获取功勋有 ",SysTitlePlayer.red,20,null)+TheGame.FONT(" +"+this.titleBonusHonorPoint+"%",SysTitlePlayer.green,20,null)+TheGame.FONT("加成 ",SysTitlePlayer.red,20,null);
		}
		return "";
	}

	__proto._titlePackageStr=function(itemid,itemnum,type){
		var result="";
		var sysitem=ConfigManager.getConfig("sys_item.txt",itemid);
		var itemName=sysitem.itemName;
		result+=itemName+"x"+itemnum;
		if(type){
			var lbl=new Label();
			lbl.bold=true;
			lbl.fontSize=20;
			lbl.text=" ";
			lbl.text=result;
			while(lbl.textField.textWidth <=150){
				result+=" ";
				lbl.text=result;
			}
		}
		return result;
	}

	__proto.getTitlePackageDropStr=function(){
		var result="";
		var dropId=this.titlePackage;
		var sysdrop=ConfigManager.getConfig("sys_drop.txt",dropId);
		var dropary=sysdrop.getDropList();
		for(var i=0;i<dropary.length;i+=4){
			var itemId=dropary[i];
			var itemnum=dropary[i+1];
			if(i+2 < dropary.length){
				var itemId2=dropary[i+2];
				var itemnum2=dropary[i+3];
				result+=this._titlePackageStr(itemId,itemnum,true)+this._titlePackageStr(itemId2,itemnum2,false)+"\n";
				}else{
				result+=this._titlePackageStr(itemId,itemnum,false);
			}
		}
		return result;
	}

	SysTitlePlayer.red="#9e1812";
	SysTitlePlayer.green="#18b403";
	return SysTitlePlayer;
})()


//class huamao.sys.SysTitleRecord
var SysTitleRecord=(function(){
	function SysTitleRecord(){
		this.recordType=0;
		this.recordDescription=null;
	}

	__class(SysTitleRecord,'huamao.sys.SysTitleRecord');
	return SysTitleRecord;
})()


//class huamao.sys.SysUnion
var SysUnion=(function(){
	function SysUnion(){
		/**联盟等级*/
		this.allianceLv=0;
		/**联盟升级需要经验*/
		this.allianceLvup=0;
		/***/
		this.allianceChairNum=0;
		/**最大人数*/
		this.allianceNum=0;
	}

	__class(SysUnion,'huamao.sys.SysUnion');
	return SysUnion;
})()


//class huamao.sys.SysUnionShop
var SysUnionShop=(function(){
	function SysUnionShop(){
		this.id=0;
		this.shopItemId=0;
		this.itemNum=0;
		this.itemPrice=null;
		this.shopLimit=0;
		this.timeRefresh=null;
		this.societyLevelup=0;
	}

	__class(SysUnionShop,'huamao.sys.SysUnionShop');
	return SysUnionShop;
})()


//class huamao.sys.SysUnlock
var SysUnlock=(function(){
	function SysUnlock(){
		/**面板ID*/
		this.unlockId="";
		/**限制类型 0:没限制 1：引导步数 2官职 3等级*/
		this.unlockType=0;
		/**引导步数 官职 等级*/
		this.unlockCondition="";
		/**提示的文字*/
		this.unlockTips=0;
		/**1有保底限制 0没有保底限制*/
		this.unlockBaseline=0;
		/**功能位置 0就是不管*/
		this.unlockIndex=0;
	}

	__class(SysUnlock,'huamao.sys.SysUnlock');
	return SysUnlock;
})()


//class huamao.sys.SysVice
var SysVice=(function(){
	function SysVice(){
		/**
		*星级
		*/
		this.viceHeroStar=0;
		/**
		*普通武将 系数 /1000乘属性
		*/
		this.commonRatio=0;
		/**
		*推荐武将 系数 /1000乘属性
		*/
		this.recommendedRatio=0;
	}

	__class(SysVice,'huamao.sys.SysVice');
	return SysVice;
})()


//class huamao.utils.CurveMove
var CurveMove=(function(){
	function CurveMove(){
		this.sp=null;
		this.vt=NaN;
		this.itmeArr=[];
		this.sp=new Sprite();
		this.sp.pos(0,0);
		Laya.stage.addChild(this.sp);
	}

	__class(CurveMove,'huamao.utils.CurveMove');
	var __proto=CurveMove.prototype;
	/**
	*@param arr [RewardItem,RewardItem,RewardItem]
	*@param sp 父容器
	*@param _vt 高度
	*@param time 结束时间
	*/
	__proto.curveRoll=function(arr,_vt,time,boo){
		(_vt===void 0)&& (_vt=10);
		(time===void 0)&& (time=1500);
		(boo===void 0)&& (boo=true);
		for(var i=0;i<arr.length;i++){
			if(arr[i].parent){
				var fromPoint=arr[i].localToGlobal(new Point);
				var item=new RewardItem();
				item.setItemId(arr[i].itemId,boo);
				this.sp.addChild(item);
				item.pos(fromPoint.x,fromPoint.y);
				this.itmeArr.push(item);
			}
		}
		this.vt=_vt;
		Laya.timer.frameLoop(1,this,this.onFrame);
		Laya.timer.once(time,this,this.clear);
	}

	__proto.clear=function(){
		Laya.timer.clear(this,this.onFrame);
		for(var i=0;i<this.itmeArr.length;i++){
			var item=this.itmeArr[i];
			item.removeSelf();
			item.destroy();
			item=null;
		}
		this.itmeArr=[];
		this.sp.removeSelf();
		App.eventManager.event("RENWUCOM");
	}

	__proto.onFrame=function(){
		this.vt-=1;
		this.sp.y-=this.vt;
		this.sp.x-=2;
	}

	CurveMove._instance=null;
	return CurveMove;
})()


//class huamao.utils.FlyToBagEffect
var FlyToBagEffect=(function(){
	function FlyToBagEffect(){
		this.target=null;
	}

	__class(FlyToBagEffect,'huamao.utils.FlyToBagEffect');
	var __proto=FlyToBagEffect.prototype;
	__proto.onFly=function(_target){
		this.target=_target;
		var btn=MainScene.instance.mainui.wujiang;
		var fromPoint=this.target.localToGlobal(new Point);
		var toPoint=btn.localToGlobal(new Point);
		this.target.x=fromPoint.x;
		this.target.y=fromPoint.y;
		Laya.stage.addChild(this.target);
		var t=Tween.to(this.target,{x:toPoint.x+80,y:toPoint.y+100,scaleX:0,scaleY:0},500,null,Handler.create(this,this.onOver));
	}

	__proto.onOver=function(){
		this.target.removeSelf();
	}

	FlyToBagEffect.flyToBag=function(sp){
		if(FlyToBagEffect._fly==null){
			FlyToBagEffect._fly=new FlyToBagEffect();
		}
		FlyToBagEffect._fly.onFly(sp);
	}

	FlyToBagEffect._fly=null;
	return FlyToBagEffect;
})()


//class huamao.utils.FramLoad
var FramLoad=(function(){
	function FramLoad(_distime,_dataAry,_dohandler,_overhandler){
		this.distime=0;
		this.dataAry=null;
		this.dohandler=null;
		this.overhandler=null;
		this.distime=_distime;
		this.dataAry=_dataAry;
		this.dohandler=_dohandler;
		this.overhandler=_overhandler;
		this.framCB();
	}

	__class(FramLoad,'huamao.utils.FramLoad');
	var __proto=FramLoad.prototype;
	__proto.framCB=function(){
		var curtime=Browser.now();
		while(true){
			if(this.dataAry.length==0){
				if(this.overhandler !=null){
					this.overhandler.run();
				}
				return;
			}
			if(this.dohandler !=null){
				var data=this.dataAry.shift();
				this.dohandler.runWith(data);
				if(Browser.now()-curtime > this.distime){
					Laya.timer.callLater(this,this.framCB);
					break ;
				}
			}
		}
	}

	__proto.stop=function(){
		this.dataAry.length=0;
		this.dohandler=null;
		this.overhandler=null;
		Laya.timer.clear(this,this.framCB);
	}

	return FramLoad;
})()


//class huamao.utils.GameUtils
var GameUtils=(function(){
	function GameUtils(){}
	__class(GameUtils,'huamao.utils.GameUtils');
	GameUtils.timeFormat=function(value,type){
		(type===void 0)&& (type=1);
		var str;
		GameUtils._date.setTime(value *1000);
		var year=GameUtils._date.getFullYear();
		var month=GameUtils._date.getMonth()+1;
		var day=GameUtils._date.getDate();
		var hours=GameUtils._date.getHours();
		var minutes=GameUtils._date.getMinutes();
		var seconds=GameUtils._date.getSeconds();
		var d_year=""+year;
		var d_month=(month<10)? ("0"+month):(""+month);
		var d_day=(day<10)? ("0"+day):(""+day);
		var d_hours=(hours<10)? ("0"+hours):(""+hours);
		var d_minutes=(minutes<10)? ("0"+minutes):(""+minutes);
		var d_seconds=(seconds<10)? ("0"+seconds):(""+seconds);
		if(type==1){
			str=d_year+"."+d_month+"."+d_day+"  "+d_hours+":"+d_minutes+":"+d_seconds;
			}else if(type==2){
			str=d_year+"-"+d_month+"-"+d_day+"  "+d_hours+":"+d_minutes+":"+d_seconds;
			}else if(type==3){
			str=d_hours+":"+d_minutes;
			}else if(type==4){
			str=d_year+"年"+d_month+"月"+d_day+"日"+d_hours+"时"+d_minutes+"分";
			}else if(type==5){
			str=d_hours+":"+d_minutes+":"+d_seconds;
			}else if(type==6){
			str=d_day+"天"+d_hours+"时"+d_minutes+"分";
			}else if(type==7){
			str=d_year+"年"+d_month+"月"+d_day+"日";
		}
		return str;
	}

	GameUtils.getDayHoursMinutes=function(value){
		var str="";
		var d=value / 86400;
		d=parseInt(""+d);
		var h=value / 3600;
		h=parseInt(""+h);
		var m=(value % 3600)/ 60;
		m=parseInt(""+m);
		if(d>0){
			str=d+"天";
			}else if(h>0){
			str=h+"小时";
			}else if(m>0){
			str=m+"分钟";
			}else{
			str="1分钟";
		}
		return str;
	}

	GameUtils.GetServerTime=function(){
		var tt=(GameUtils.LoginTime+(Browser.now()-GameUtils.LoginGet))/ 1000;
		return parseInt(tt+"");
	}

	GameUtils.time=function(value,isHour){
		(isHour===void 0)&& (isHour=true);
		if(value <=0){
			return "00:00:00";
		};
		var h=value / 3600;
		h=parseInt(""+h);
		var m=(value % 3600)/ 60;
		m=parseInt(""+m);
		var s=(value % 3600)% 60;
		s=parseInt(""+s);
		if(isHour){
			if(h < 1){
				return ("00:"+(m<10?"0"+m:m)+":"+(s<10?"0"+s:s));
			}
		}
		else{
			return ((m<10?"0"+m:m)+":"+(s<10?"0"+s:s));
		}
		return ((h<10?"0"+h:h)+":"+(m<10?"0"+m:m)+":"+(s<10?"0"+s:s));
	}

	GameUtils.getItemIconPath=function(itemid){
		return "res/item/"+itemid+".png";
	}

	GameUtils.getHeroNameColor=function(quality){
		switch(quality){
			case MyGameConst.COLOR_GREEN:
				return "#33AA0F";
			case MyGameConst.COLOR_BLUE:
				return "#3185CA";
			case MyGameConst.COLOR_PURPLE:
				return "#A452DA";
			case MyGameConst.COLOR_YELLOW:
				return "#FB890F";
			}
		return "#ffffff";
	}

	GameUtils.getHeroColorName=function(quality){
		var result="";
		switch(quality){
			case MyGameConst.COLOR_GREEN:
				result="绿";
				break ;
			case MyGameConst.COLOR_BLUE:
				result="蓝";
				break ;
			case MyGameConst.COLOR_PURPLE:
				result="紫";
				break ;
			case MyGameConst.COLOR_YELLOW:
				result="橙";
				break ;
			}
		return result;
	}

	GameUtils.getCountry=function(country){
		return GameUtils.guoUrl[country];
	}

	GameUtils.getKuang=function(quality){
		return "comp/G/k_"+GameUtils.colorArr[quality]+".png";
	}

	GameUtils.getNoKuang=function(quality){
		return "comp/G/k_"+GameUtils.kuangArr[quality]+".png";
	}

	GameUtils.getDi=function(quality){
		return "comp/G/k_"+GameUtils.colorArr[quality]+"_d.jpg";
	}

	GameUtils.getZiDi=function(quality){
		return "comp/G/k_"+GameUtils.colorArr[quality]+"d.png";
	}

	GameUtils.getZi_Di=function(quality){
		return "comp/G/zm_"+GameUtils.colorArr[quality]+".png";
	}

	GameUtils.getKuangColor=function(quality){
		return "comp/G/zm_"+GameUtils.colorArr[quality]+".png";
	}

	GameUtils.getCityColor=function(){
		return "#ffffff";
	}

	GameUtils.getKaKuang=function(view,heroColor){
		var colorArr=["lv","lan","zi","huang"];
		view.you.skin="comp/G/"+colorArr[heroColor-1]+"_kuang_you.png";
		view.zuo.skin="comp/G/"+colorArr[heroColor-1]+"_kuang_zuo.png";
		view.xia.skin="comp/G/"+colorArr[heroColor-1]+"_kuang_xia.png";
		view.shang.skin="comp/G/"+colorArr[heroColor-1]+"_kuang_shang.png";
		view.jiao.skin=view.jiao1.skin="comp/G/"+colorArr[heroColor-1]+"_kuang_jiao.png";
	}

	GameUtils.getKaKuangImg=function(heroColor){
		var colorArr=["lv","lan","zi","ju"];
		return "comp/G/k_"+colorArr[heroColor-1]+".png";
	}

	GameUtils.getBingZhong=function(type){
		return "comp/G/bz_"+GameUtils.bingzhong[type]+".png";
	}

	GameUtils.getMoneyImg=function(moneyId){
		var skin="";
		if(moneyId==MyGameConst.SILVER_ID){
			skin="comp/G/x_yinding.png";
			}else if(moneyId==MyGameConst.GOLD_ID){
			skin="comp/G/x_yuanbao.png";
		}
		return skin;
	}

	GameUtils.getLan=function(key){
		var syslan=ConfigManager.getConfig("sys_lan.txt",key);
		return (syslan !=null)? (syslan.value):"";
	}

	GameUtils.getHeadUrl=function(style,isMax){
		(isMax===void 0)&& (isMax=false);
		var syslordbody=ConfigManager.getConfig("sys_lordbody.txt",style+1);
		if(isMax){
			return "comp/G/"+syslordbody.lordHeadSmall+".png";
			}else{
			return "comp/G/"+syslordbody.lordHeadBig+".png";
		}
	}

	GameUtils.LongGuRoleRes=function(styleId){
		return GameUtils.LongGu[styleId];
	}

	GameUtils.replaceLocaleConfigFH=function(str,valueAry){
		if(!str)return null;
		for (var i=0;i < valueAry.length;i++){
			str=str.replace("{"+i+"}",valueAry[i]);
		}
		return str;
	}

	GameUtils.getHeroSkin=function(heroId){
		var sys=ConfigManager.getConfig("sys_hero.txt",heroId);
		var sysr=ConfigManager.getConfig("sys_recruit_hero.txt",heroId);
		if(sysr && sysr.recruitHeroSoul>0){
			return App.loaderManager.getUrl("HERO",sysr.recruitHero+".png");
		}
		else{
			return App.loaderManager.getUrl("HERO",sys.heroResId+".png");
		}
	}

	GameUtils.getNextOffical=function(id){
		id+=1;
		if(id > 1013){
			id=1013;
		}
		return id;
	}

	GameUtils.getOfficalSkin=function(id){
		var skin;
		switch(id){
			case 1001:
				skin="comp/G/cw_pm.png";
				break ;
			case 1002:
				skin="comp/G/cw_tz.png";
				break ;
			case 1003:
				skin="comp/G/cw_xz.png";
				break ;
			case 1004:
				skin="comp/G/cw_xl.png";
				break ;
			case 1005:
				skin="comp/G/cw_js.png";
				break ;
			case 1006:
				skin="comp/G/cw_cs.png";
				break ;
			case 1007:
				skin="comp/G/cw_zm.png";
				break ;
			case 1008:
				skin="comp/G/cw_ss.png";
				break ;
			case 1009:
				skin="comp/G/cw_tingw.png";
				break ;
			case 1010:
				skin="comp/G/cw_jj.png";
				break ;
			case 1011:
				skin="comp/G/cw_tw.png";
				break ;
			case 1012:
				skin="comp/G/cw_cx.png";
				break ;
			case 1013:
				skin="comp/G/cw_hd.png";
				break ;
			}
		return skin;
	}

	GameUtils.getStringCharLen=function(str){
		var count=0;
		for(var i=0;i<str.length;i++){
			var num=str.charCodeAt(i);
			if(num >=0x0391 && num <=0xFFE5){
				count+=2;
				}else{
				count+=1;
			}
		}
		return count;
	}

	GameUtils.getItemNameTitleSkin=function(fromId){
		var result="";
		switch(fromId){
			case 9002:{
					result="comp/G/t_gxbx_bx.png";
				}
				break ;
			case 9013:{
					result="comp/G/t_gxbx_jn.png";
				}
				break ;
			case 6001:
			case 6002:
			case 6003:
			case 6004:
			case 6005:
			case 6006:{
					result="comp/G/t_gxbx_bx.png";
				}
				break ;
			case 9008:
			case 9009:
			case 9010:
			case 9011:{
					result="comp/G/t_gxbx_lb.png";
				}
				break ;
			}
		return result;
	}

	GameUtils.getShield=function(str){
		if(str && str!=""){
			var i=0
			for (i=0;i < GameUtils.Shield.length;i++){
				str=str.replace(GameUtils.Shield[i],"***");
			}
		}
		return str;
	}

	GameUtils.InitPBZKCfg=function(str){
		GameUtils.Shield=str.split("|");
		while(true){
			var indexOf=GameUtils.Shield.indexOf("");
			if(indexOf !=-1){
				GameUtils.Shield.splice(indexOf,1);
			}
			else{
				break ;
			}
		}
	}

	GameUtils.clone=function(obj){
		var r=new ByteArray();
		r.writeObject(obj);
		r.position=0;
		return r.readObject();
	}

	GameUtils.getSysTipsDes=function(id){
		var sysTips=ConfigManager.getConfig("sys_tips.txt",id);
		var des=sysTips.tipsDescribe;
		return des;
	}

	GameUtils.setFlyToItem=function(arr,_vt,time,boo){
		(_vt===void 0)&& (_vt=15);
		(time===void 0)&& (time=1500);
		(boo===void 0)&& (boo=true);
		var move=new CurveMove();
		move.curveRoll(arr,_vt,time,boo);
	}

	GameUtils.setError=function(errorId,tips){
		(tips===void 0)&& (tips="");
		var sysTips=ConfigManager.getConfig("sys_tips.txt",errorId);
		if(sysTips){
			FlyUpTips.setTips(sysTips.tipsDescribe,1000,"#ffffff",[tips]);
			}else{
			FlyUpTips.setTips("错误ID:"+errorId);
		}
	}

	GameUtils.getTips=function(id){
		var sysTips=ConfigManager.getConfig("sys_tips.txt",id);
		return sysTips.tipsDescribe;
	}

	GameUtils.openBuZu=function(num,type){
		(type===void 0)&& (type=1);
		var mainPlayerSession=App.getSession("mainPlayerSession");
		var panel;
		if(type==1){
			if(mainPlayerSession.mainPlayerData.gold<num){
				GameUtils.open(type);
				return false;
			}
			}else{
			if(mainPlayerSession.mainPlayerData.silver<num){
				GameUtils.open(type);
				return false;
			}
		}
		return true;
	}

	GameUtils.open=function(type){
		var panel=App.dialogManager.showMiniDialog(TipsChongZhi,true,true,false,false);
		panel.upData(type);
	}

	GameUtils.lang=function(tipsId,arr){
		var str="";
		var sys=ConfigManager.getConfig("sys_tips.txt",tipsId);
		str=GameUtils.langTxt(sys.tipsDescribe,arr);
		return str;
	}

	GameUtils.langTxt=function(text,arr){
		for (var i=0;i<arr.length;i++){
			if(arr[i]){
				text=text.replace("{"+i+"}",arr[i]);
				}else{
				break ;
			}
		}
		return text;
	}

	GameUtils.btnChange=function(){
		Laya.stage.on("mousedown",Laya.stage,GameUtils.downBtn);
		Laya.stage.on("mouseup",Laya.stage,GameUtils.upBtn);
		Laya.stage.on("mousemove",Laya.stage,GameUtils.upBtn);
	}

	GameUtils.downBtn=function(event){
		if((event.target instanceof laya.ui.Button )){
			if((event.target).stateNum==1){
				var glowFilter=new GlowFilter("#fff298",8,0,0);
				(event.target).filters=[glowFilter];
			}
		}
	}

	GameUtils.upBtn=function(event){
		if((event.target instanceof laya.ui.Button )){
			(event.target).filters=null;
		}
	}

	GameUtils.PINGBI="";
	GameUtils.LoginTime=NaN;
	GameUtils.LoginGet=NaN;
	GameUtils.HEAD_SIZE=60;
	GameUtils.HEAD_SIZE2=76;
	__static(GameUtils,
	['_date',function(){return this._date=new Date();},'guoUrl',function(){return this.guoUrl=["comp/G/0_shuguo.png","comp/G/0_wuguo.png","comp/G/0_weiguo.png","comp/G/0_qunxiong.png","comp/G/0_shuguo.png"];},'colorArr',function(){return this.colorArr=["","lv","lan","zi","ju"];},'kuangArr',function(){return this.kuangArr=["","lvka","lanka","zika","jinka"];},'bingzhong',function(){return this.bingzhong=["","bu","qi","gong","fa"];},'LongGu',function(){return this.LongGu=["zhujueyi","zhujueer","zhujuesan","juesesi"];},'Shield',function(){return this.Shield=new Array;}
	]);
	return GameUtils;
})()


//class huamao.utils.Md5HttpTool
var Md5HttpTool=(function(){
	function Md5HttpTool(_str,_handler,_type,_obj){
		this.handler=null;
		this.content=null;
		this.type=0;
		this.obj=null;
		(_type===void 0)&& (_type=-1);
		this.handler=_handler;
		this.content=_str;
		this.type=_type;
		this.obj=_obj;
	}

	__class(Md5HttpTool,'huamao.utils.Md5HttpTool');
	var __proto=Md5HttpTool.prototype;
	__proto.send=function(){
		var httpRequest=new HttpRequest();
		httpRequest.once("complete",this ,this.comFun);
		var playerformid=App.configJson["platformId"];
		var url=App.configJson[playerformid]["md5Ip"];
		httpRequest.send(url,this.content,"post");
	}

	__proto.comFun=function(data){
		if(this.handler){
			var ary=[this.type,this.obj,data];
			this.handler.runWith(ary);
		}
	}

	return Md5HttpTool;
})()


//class huamao.utils.TreeNode
var TreeNode=(function(){
	function TreeNode(){
		this.data=null;
		this.isLeaf=false;
		this.parent=null;
		this.value=null;
		this.data={};
		this.isLeaf=true;
	}

	__class(TreeNode,'huamao.utils.TreeNode');
	var __proto=TreeNode.prototype;
	__proto.getChild=function(name){
		return this.data[name];
	}

	__proto.setChild=function(key){
		var node=new TreeNode;
		this.data[key]=node;
		node.value=key;
		node.parent=this;
		return node;
	}

	__proto.getFullWord=function(){
		var rt=this.value;
		var node=this.parent;
		while(node){
			rt=node.value+rt;
			node=node.parent;
		}
		return rt;
	}

	return TreeNode;
})()


//class huamao.utils.WordFilter
var WordFilter=(function(){
	function WordFilter(){
		this.treeRoot=null;
	}

	__class(WordFilter,'huamao.utils.WordFilter');
	var __proto=WordFilter.prototype;
	__proto.regSensitiveWords=function(words){
		this.treeRoot=new TreeNode();
		this.treeRoot.value="";
		var words_len=words.length;
		for(var i=0;i<words_len;i++){
			var word=words[i];
			if(word==""){
				continue ;
			};
			var len=word.length;
			var currentBranch=this.treeRoot;
			for(var c=0;c<len;c++){
				currentBranch.isLeaf=false;
				var char=word.charAt(c);
				var tmp=currentBranch.getChild(char);
				if(tmp){
					if(tmp.isLeaf){
						tmp.isLeaf=true;
						break ;
					}
					currentBranch=tmp;
					}else {
					currentBranch=currentBranch.setChild(char);
				}
			}
			if(!currentBranch.isLeaf){}
				}
	}

	//throw new Error("短词在长词后被注册。已经有以("+word+")开头的敏感词存在,当前正在注册第"+i+"个词");
	__proto.findSensitiveWordsIn=function(og){
		var ptrs=[];
		var len=og.length;
		var tmp;
		for(var c=0;c < len;c++){
			var char=og.charAt(c);
			var p=ptrs.length;
			while(p--){
				var node=ptrs.shift();
				tmp=node.getChild(char);
				if(tmp){
					if(tmp.isLeaf){
						var tmpLength=tmp.getFullWord().length;
						var tmpStr;
						for(var i=0;i < tmpLength;++i){
							tmpStr+="*";
						}
						tmpStr=tmpStr.substr(tmpStr.length-tmpLength,tmpStr.length-1);
						og=og.replace(tmp.getFullWord(),tmpStr);
					}
					ptrs.push(tmp);
				}
			}
			tmp=this.treeRoot.getChild(char);
			if(tmp){
				if(tmp.isLeaf){
					og=og.replace(tmp.getFullWord(),"*");
				}
				ptrs.push(tmp);
			}
		}
		return og;
	}

	/**
	*
	*@param og
	*@return false:有敏感字 true:没有敏感字
	*
	*/
	__proto.IsSensitiveWord=function(og){
		var ptrs=[];
		var len=og.length;
		var boo=true;
		var tmp;
		for(var c=0;c < len;c++){
			var char=og.charAt(c);
			var p=ptrs.length;
			while(p--){
				var node=ptrs.shift();
				tmp=node.getChild(char);
				if(tmp){
					if(tmp.isLeaf){
						var tmpLength=tmp.getFullWord().length;
						var tmpStr;
						for(var i=0;i < tmpLength;++i){
							boo=false;
							return boo;
						}
						tmpStr=tmpStr.substr(tmpStr.length-tmpLength,tmpStr.length-1);
						og=og.replace(tmp.getFullWord(),tmpStr);
					}
					ptrs.push(tmp);
				}
			}
			tmp=this.treeRoot.getChild(char);
			if(tmp){
				if(tmp.isLeaf){
					boo=false;
					return boo;
				}
				ptrs.push(tmp);
			}
		}
		return boo;
	}

	return WordFilter;
})()


//class huamao.YouEvent
var YouEvent=(function(){
	function YouEvent(){}
	__class(YouEvent,'huamao.YouEvent');
	YouEvent.RESIZE_MAP="RESIZE_MAP";
	YouEvent.GOTO_HOMEPAGE="GOTO_HOMEPAGE";
	YouEvent.GOTO_MAPCITY="GOTO_MAPCITY";
	YouEvent.GOTO_CITY_INNER="GOTO_CITY_INNER";
	YouEvent.EXIT_CITY_INNER="EXIT_CITY_INNER";
	YouEvent.GOTO_CITY_INNER2="GOTO_CITY_INNER2";
	YouEvent.EXIT_CITY_INNER2="EXIT_CITY_INNER2";
	YouEvent.SELECT_CHUZHENG_CITY="SELECT_CHUZHENG_CITY";
	YouEvent.BINGLI_YUNSHU="BINGLI_YUNSHU";
	YouEvent.GOTO_GAME_OVER="GAME_OVER";
	YouEvent.SHOW_HEADER="SHOW_HEADER";
	YouEvent.CITY_ZHENCHA="CITY_ZHENCHA";
	YouEvent.BUILD_LVUP_SUCCESS="BUILD_LVUP_SUCCESS";
	YouEvent.SET_SELECT_WUJIANG="SET_SELECT_WUJIANG";
	YouEvent.UPDATE_XINGJUN_LIST="UPDATE_XINGJUN_LIST";
	YouEvent.DELETE_XINGJUN_ITEM="DELETE_XINGJUN_ITEM";
	YouEvent.UPDATE_CITY_INFO="UPDATE_CITY_INFO";
	YouEvent.CANCLE_CHUZHENG="CANCLE_CHUZHENG";
	YouEvent.CANLE_BUZHENG_ITEM="CANLE_BUZHENG_ITEM";
	YouEvent.ADD_CITY_PLAYER="ADD_CITY_PLAYER";
	YouEvent.UPDATE_PLAYER_LIST="UPDATE_PLAYER_LIST";
	YouEvent.REMOVE_CITY_PLAYER="REMVOE_CITY_PLAYER";
	YouEvent.ADD_FIGHT_FIRE="ADD_FIGHT_FIRE";
	YouEvent.REMOVE_FIGHT_FIRE="REMOVE_FIGHT_FIRE";
	YouEvent.DIAOBING_SINGLE="DIAOBING_SINGLE";
	YouEvent.UPDATE_QIAN_LIANG="UPDATE_QIAN_LIANG";
	YouEvent.SET_POSITION="SET_POSITION";
	YouEvent.REMOVE_BAOHUZHAO="REMOVE_BAOHUZHAO";
	YouEvent.ADD_BAOHUZHAO="ADD_BAOHUZHAO";
	YouEvent.UPDATE_TIME="UPDATE_TIME";
	YouEvent.SHOW_CHANLIANG="SHOW_CHANLIANG";
	YouEvent.DELETE_LINE="DELETE_LINE";
	YouEvent.WEIXIAN_UPDATE="WEIXIAN_UPDATE";
	YouEvent.ADD_ZHANBAO="ADD_ZHANBAO";
	YouEvent.SELECT_ZHANBAO="SELECT_ZHANBAO";
	YouEvent.CLEAR_ALL_CITY="CLEAR_ALL_CITY";
	YouEvent.SELECT_JIJIE_CITY="SELECT_JIJIE_CITY";
	YouEvent.SET_SMALL_MAP="SET_SMALL_MAP";
	YouEvent.ZHAOBINGMAIMA_TIMES="ZHAOBINGMAIMA_TIMES";
	YouEvent.FIND_FRIEND_RESULT="FIND_FRIEND_RESULT";
	YouEvent.UPDATE_FRIEND="UPDATE_FRIEND";
	YouEvent.DELETE_FRIEND="DELETE_FRIEND";
	YouEvent.SHOW_MENU_FRIEND="SHOW_MENU_FRIEND";
	YouEvent.ADD_CHAT_MSG="ADD_CHAT_MSG";
	YouEvent.UPDATE_MSG_LIST="UPDATE_MSG_LIST";
	YouEvent.REMOVE_HUIHUA="REMOVE_HUIHUA";
	YouEvent.UPDATE_INVITED_FRIEND="UPDATE_INVITED_FRIEND";
	YouEvent.SWAP_HEROS="SWAP_HEROS";
	YouEvent.SHOUCANG_UPDATE="SHOUCANG_SUCCESS";
	YouEvent.ZHAOMUCHENGGONG="ZHAOMUCHENGGONG";
	YouEvent.ZHAOMUCISHU="ZHAOMUCISHU";
	YouEvent.ZHAOMUCD="ZHAOMUCD";
	YouEvent.SHOP_INTIMACY="SHOP_INTIMACY";
	YouEvent.SHOP_ITEM="SHOP_ITEM";
	YouEvent.SHOP_CD="SHOP_CD";
	YouEvent.STRATAGEM_CD="STRATAGEM_CD";
	YouEvent.STRATAGEM_ORDER="STRATAGEM_ORDER";
	YouEvent.BATTLE="BATTLE";
	YouEvent.BATTLE_INFO="BATTLE_INFO";
	YouEvent.LOAD_BATTLE_FILE="LOAD_BATTLE_FILE";
	YouEvent.BAG_ITEM_FLUSH="BAG_ITEM_FLUSH";
	YouEvent.BAG_EQUIP_FLUSH="BAG_EQUIP_FLUSH";
	YouEvent.BAG_BOX_FLUSH="BAG_BOX_FLUSH";
	YouEvent.FLUSH_PLAYER_LV="FLUSH_PLAYER_LV";
	YouEvent.FLUSH_PLAYER_EXP="FLUSH_PLAYER_EXP";
	YouEvent.FLUSH_PLAYER_GOLD="FLUSH_PLAYER_GOLD";
	YouEvent.FLUSH_PLAYER_SILVER="FLUSH_PLAYER_SILVER";
	YouEvent.FLUSH_PLAYER_HEROEXP="FLUSH_PLAYER_HEROEXP";
	YouEvent.FLUSH_PLAYER_STYLE="FLUSH_PLAYER_STYLE";
	YouEvent.FLUSH_PLAYER_JOB="FLUSH_PLAYER_JOB";
	YouEvent.FLUSH_PLAYER_JOBSCORE="FLUSH_PLAYER_JOBSCORE";
	YouEvent.FLUSH_PLAYER_GAMETIMES="FLUSH_PLAYER_GAMETIMES";
	YouEvent.FLUSH_PLAYER_WINTIMES="FLUSH_PLAYER_WINTIMES";
	YouEvent.FLUSH_PLAYER_TORTOISE="FLUSH_PLAYER_TORTOISE";
	YouEvent.FLUSH_PLAYER_MARS="FLUSH_PLAYER_MARS";
	YouEvent.FLUSH_PLAYER_WISE="FLUSH_PLAYER_WISE";
	YouEvent.FLUSH_PLAYER_DEFEAT="FLUSH_PLAYER_DEFEAT";
	YouEvent.FLUSH_PLAYER_RESET="FLUSH_PLAYER_RESET";
	YouEvent.FLUSH_PLAYER_NAME="FLUSH_PLAYER_NAME";
	YouEvent.FLUSH_MEJCLQZT="FLUSH_MEJCLQZT";
	YouEvent.FLUSH_MONTHSALARY="FLUSH_MONTHSALARY";
	YouEvent.FLUSH_JOB_BOX="FLUSH_JOB_BOX";
	YouEvent.HEROUPDATE="HEROUPDATE";
	YouEvent.SENDDIAOCHANTIP="SENDDIAOCHANTIP";
	YouEvent.WAIJIAO_FLUSH="WAIJIAO_FLUSH";
	YouEvent.XUE_CANG="XUE_CANG";
	YouEvent.SELECT_HERO="SELECT_HERO";
	YouEvent.HERO_LV_UP="HERO_LV_UP";
	YouEvent.HERO_EQUIP_CHANGE="HERO_EQUIP_CHANGE";
	YouEvent.InitEvent="huamao.session.ZhaoMuSession.InitEvent";
	YouEvent.ShowEvent="huamao.session.ZhaoMuSession.ShowEvent";
	YouEvent.RemoveCardEvent="huamao.session.ZhaoMuSession.RemoveCardEvent";
	YouEvent.ZHUAN_ZHI_SUCCESS="ZHUAN_ZHI_SUCCESS";
	YouEvent.STUDY_SUCCESS="STUDY_SUCCESS";
	YouEvent.UNLOCK_SOLDIER_SUCCESS="UNLOCK_SOLDIER_SUCCESS";
	YouEvent.TEAM_CHANGE="TEAM_CHANGE";
	YouEvent.GET_NEW_SCORE="GET_NEW_SCORE";
	YouEvent.TALK_FLUSH_WORD="TALK_FLUSH_WORD";
	YouEvent.TALK_FLUSH_TEAM="TALK_FLUSH_TEAM";
	YouEvent.TALK_FLUSH_CURRENT="TALK_FLUSH_CURRENT";
	YouEvent.TALK_FLUSH_SYS="TALK_FLUSH_SYS";
	YouEvent.TALK_FLUSH_COLEAGE="TALK_FLUSH_COLEAGE";
	YouEvent.ASSESS_VOTE_FLUSH="ASSESS_VOTE_FLUSH";
	YouEvent.SHOWJL="SHOWJL";
	YouEvent.MAILUPDATA="MAILUPDATA";
	YouEvent.MAILLIST="MAILLIST";
	YouEvent.MAILCLICK="MAILCLICK";
	YouEvent.MAILUI="MAILUI";
	YouEvent.READMAIL="READMAIL";
	YouEvent.MAILGETITEM="MAILGETITEM";
	YouEvent.DELETEMAIL="DELETEMAIL";
	YouEvent.DELETEALLMAIL="DELETEALLMAIL";
	YouEvent.UPDATA_CITY_LIST="UPDATA_CITY_LIST";
	YouEvent.READBATTLE="READBATTLE";
	YouEvent.BATTLEUPDATA="BATTLEUPDATA";
	YouEvent.UPDATA_TASK_DATA="huamao.YouEvent.UPDATA_TASK_DATA";
	YouEvent.BATTLEPLAYERUPDATA="BATTLEPLAYERUPDATA";
	YouEvent.BATTLECHAT="BATTLECHAT";
	YouEvent.BATTLEPLAY="BATTLEPLAY";
	YouEvent.BATTLEJINDU="BATTLEJINDU";
	YouEvent.ADDLEGION="ADDLEGION";
	YouEvent.DELETELEGION="DELETELEGION";
	YouEvent.CHAKANZHUJIANG="CHAKANZHUJIANG";
	YouEvent.CHONGZHIUPDATA="CHONGZHIUPDATA";
	YouEvent.LOAD_RES="LOAD_RES";
	YouEvent.QIANDAO_DATA="QIANDAO_DATA";
	YouEvent.ZHAOMUCOM="ZHAOMUCOM";
	YouEvent.CHECK_GUIDE="CHECK_GUIDE";
	YouEvent.SEVENRENWU_DATA="SEVENRENWU_DATA";
	YouEvent.HUOYUEWEEK="HUOYUEWEEK";
	YouEvent.HUOYUEGIFT="HUOYUEGIFT";
	YouEvent.HUOYUEDAY="HUOYUEDAY";
	YouEvent.HUOYUEDAYGIFT="HUOYUEDAYGIFT";
	YouEvent.LEIJINEWCZGIFT="LEIJINEWCZGIFT";
	YouEvent.DUOBAOSEND="DUOBAOSEND";
	YouEvent.DUOBAOBACK="DUOBAOBACK";
	YouEvent.DUOBAOBAOXIANG="DUOBAOBAOXIANG";
	YouEvent.DUOBAOFlUSH="DUOBAOFlUSH";
	YouEvent.DUOBAOADDJUAN="DUOBAOADDJUAN";
	YouEvent.KABAOBUYGIFT="KABAOBUYGIFT";
	YouEvent.CANCELCHA="CANCELCHA";
	YouEvent.TINGBUBIAN="TINGBUBIAN";
	YouEvent.OPENTINGBUBIAN="OPENTINGBUBIAN";
	YouEvent.VICTORYDROPGET="VICTORYDROPGET";
	YouEvent.FLUSHDROPGIFT="FLUSHDROPGIFT";
	YouEvent.VIEWDROPGIFT="VIEWDROPGIFT";
	YouEvent.REMOVEDROPGIFT="REMOVEDROPGIFT";
	YouEvent.REFRESH_RANK="REFRESH_RANK";
	YouEvent.UPDATE_SETTING="UPDATE_SETTING";
	YouEvent.SETTING_INIT="SETTING_INIT";
	YouEvent.HUODONGUPDATA="HUODONGUPDATA";
	YouEvent.EXIT_FIGHT_SCENE="EXIT_FIGHT_SCENE";
	YouEvent.DIANZAN_LIST="DIANZAN_LIST";
	YouEvent.DIANZAN_CHANGE="DIANZAN_CHANGE";
	YouEvent.FUNCTIONNUM="FUNCTIONNUM";
	YouEvent.ADD_GUIDE_LINE="ADD_GUIDE_LINE";
	YouEvent.REMOVE_GUIDE_LINE="REMOVE_GUIDE_LINE";
	YouEvent.ADD_GUIDE_FIRE="ADD_GUIDE_FIRE";
	YouEvent.REMOVE_GUIDE_FIRE="REMOVE_GUIDE_FIRE";
	YouEvent.RESET_GUIDE_CITY="RESET_GUIDE_CITY";
	YouEvent.SHOW_LOADING="SHOW_LOADING";
	YouEvent.CLOSE_LOADING="CLOSE_LOADING";
	YouEvent.LOGIN_MASTER_SERVER_SUCCESS="LOGIN_MASTER_SERVER_SUCCESS";
	YouEvent.LOGIN_BACK_CLOSE_MASK="LOGIN_BACK_CLOSE_MASK";
	YouEvent.ZHAN_BAO_NOT_READ="ZHAN_BAO_NOT_READ";
	YouEvent.HUO_DONG_NOT_READ="HUO_DONG_NOT_READ";
	YouEvent.BATTLE_INFO_IS_READ="BATTLE_INFO_IS_READ";
	YouEvent.JINRUCHENGNEI="JINRUCHENGNEI";
	YouEvent.ENTER_MAP="ENTER_MAP";
	YouEvent.START_NEW_GAME="START_NEW_GAME";
	YouEvent.REAPOINT="REAPOINT";
	YouEvent.CREATE_ROLE_BACK="CREATE_ROLE_BACK";
	YouEvent.OPENYUN="OPENYUN";
	YouEvent.DOT_LOGIN_SDK_SUC="DOT_LOGIN_SDK_SUC";
	YouEvent.DOT_MAIN_SERVER_LOGIN_SUC="DOT_MAIN_SERVER_LOGIN_SUC";
	YouEvent.DOT_CREAT_ROLE_SUC="DOT_CREAT_ROLE_SUC";
	YouEvent.NEW_GUIDE_OPEN="NEW_GUIDE_OPEN";
	YouEvent.YUNOVER="YUNOVER";
	YouEvent.COUNTRYUPDATA="COUNTRYUPDATA";
	YouEvent.ROLLOVER="ROLLOVER";
	YouEvent.MAPROLL="MAPROLL";
	YouEvent.MAINSCENEOVER="MAINSCENEOVER";
	YouEvent.ENTERMAP="ENTERMAP";
	YouEvent.GUIDE_UI_OVER="GUIDE_UI_OVER";
	YouEvent.GUIDE_ENTER_FIGHT="GUIDE_ENTER_FIGHT";
	YouEvent.GUIDE_FIGHT2GUIDE="GUIDE_FIGHT2GUIDE";
	YouEvent.GUIDE_GUIDE2FIGHT="GUIDE_GUIDE2FIGHT";
	YouEvent.OPEN_WAIJIAO="OPEN_WAIJIAO";
	YouEvent.BUZHEN_ANIMI_OVER="BUZHEN_ANIMI_OVER";
	YouEvent.WUJIANGLVCOM="WUJIANGLVCOM";
	YouEvent.RENWUCOM="RENWUCOM";
	YouEvent.FACEBOOK_PAY_BACK="FACEBOOK_PAY_BACK";
	YouEvent.FACEBOOK_CONSUMED="FACEBOOK_CONSUMED";
	YouEvent.VIDEO_OVER="VIDEO_OVER";
	YouEvent.NO_PAY_API="NO_PAY_API";
	YouEvent.MYUNIONUPDATA="MYUNIONUPDATA";
	YouEvent.UNIONUPDATA="UNIONUPDATA";
	YouEvent.UNIONLISTUPDATA="UNIONLISTUPDATA";
	YouEvent.DISSOLVE="DISSOLVE";
	YouEvent.CHUANGJIANCOM="CHUANGJIANCOM";
	YouEvent.PLAYERLIST="PLAYERLIST";
	YouEvent.MENUCLICK="MENUCLICK";
	YouEvent.PLAYERCLICK="PLAYERCLICK";
	YouEvent.SHENQING="SHENQING";
	YouEvent.MYSHENQING="MYSHENQING";
	YouEvent.SHENQINGTONGGUO="SHENQINGTONGGUO";
	YouEvent.TUICHUCHENGGONG="TUICHUCHENGGONG";
	YouEvent.GUANBILIANMENG="GUANBILIANMENG";
	YouEvent.SELEQIZHI="SELEQIZHI";
	YouEvent.QIZHIUPDATA="QIZHIUPDATA";
	YouEvent.SOUSUOLIST="SOUSUOLIST";
	YouEvent.UPDATAGONGGAO="UPDATAGONGGAO";
	YouEvent.UPDATADONGTAI="UPDATADONGTAI";
	YouEvent.UNIONTISHI="UNIONTISHI";
	YouEvent.UNIONEXP="UNIONEXP";
	YouEvent.UNIONMENGZHU="UNIONMENGZHU";
	YouEvent.UNIONRENSHU="UNIONRENSHU";
	YouEvent.HEROLVMC="HEROLVMC";
	YouEvent.LOGIN_SUCCESS="LOGIN_SUCCESS";
	YouEvent.PAY="PAY";
	YouEvent.SDK_INIT="SDK_INIT";
	YouEvent.SIGN_ERROR="SIGN_ERROR";
	YouEvent.ENTER_BATTLE="ENTER_BATTLE";
	return YouEvent;
})()


//class Language
var Language=(function(){
	function Language(){}
	__class(Language,'Language');
	Language.init=function(configString){
		var strary=configString.split("\n");
		for (var i=0;i < strary.length;i++){
			var arr=strary[i].split("\t");
			Language.obj[arr[0]]=arr[1];
		}
		Text.langPacks=Language.obj;
	}

	Language.obj={};
	return Language;
})()


//class LayaSample
var LayaSample=(function(){
	function LayaSample(){
		SocketManager.isReconnection=false;
		SocketManager.MAX_MISS_TIMES=10000000;
		App.CHECK_VIEW_INJECTION=false;
		UIConfig.popupBgAlpha=0.65;
		App.DevelopmentSettings(1280,720,"horizontal");
		if(Browser.window.config !=null && LayaSample.isFaceBook()==false){
			URL.basePath="http://resource-pov.fly99.com/sybin/h5/game/";
		}
		App.dialogManager.displayOtherDialog=true;
		if(Render.isConchApp){
			Laya.stage.scaleMode="fixedheight";
			Browser.window["conch"].setScreenWakeLock(true);
			}else{
			if(!Browser.onPC){
				Laya.stage.fullScreenEnabled=true;
			}
		}
		Dialog.manager.closeEffect=null;
		Dialog.manager.popupEffect=null;
		Dialog.manager.closeEffectHandler=null;
		Dialog.manager.popupEffectHandler=null;
		SoundManager.useAudioMusic=false;
		ResourceVersion.enable("version.json?ver="+Math.random(),Handler.create(this,this.beginLoad),2);
	}

	__class(LayaSample,'LayaSample');
	var __proto=LayaSample.prototype;
	__proto.clickFun3=function(){
		var dragonMc=new DragonMc();
		dragonMc.setUrl("res/load/renzesihai.sk");
		Laya.stage.addChild(dragonMc);
		dragonMc.pos(200,200);
	}

	__proto.beginLoad=function(){
		ProLoadScene.show();
		App.eventManager.once("SYS_CONFIG_OVER",this,this.initFun);
		App.MyInit(MyGameInit);
	}

	__proto.initFun=function(){
		App.loaderManager.load("ATLAS","loading.atlas",new Handler(this,this.comFun));
	}

	__proto.comFun=function(){
		ProLoadScene.close();
		App.layerManager.setLoadUIClass(LoadScene);
		App.sceneManager.setScene("LOGIN_SCENE");
	}

	LayaSample.getPlatformId=function(){
		if(Browser.window.config==null){
			return "1001";
		}
		return Browser.window.config["platformId"];
	}

	LayaSample.isFaceBook=function(){
		return LayaSample.getPlatformId()=="1003" || LayaSample.getPlatformId()==1003;
	}

	return LayaSample;
})()


//class MainUI
var MainUI=(function(){
	function MainUI(icon){
		/**排序游戏上方活动按钮位置*/
		this.mainBtnArr=null;
		/**排序游戏下方按钮位置*/
		this.funUpBtnArr=null;
		/**排序游戏下方按钮位置*/
		this.funDownBtnArr=null;
		this.mainui=null;
		this.activityTime=null;
		this.mainPlayerSession=null;
		this.activitySession=null;
		this.openFunctionSession=null;
		this.unionSession=null;
		this._name="";
		this.mc=null;
		App.injOne(this);
		this.mainui=icon;
		this.init();
	}

	__class(MainUI,'MainUI');
	var __proto=MainUI.prototype;
	__proto.init=function(){
		this.mainui.qilu.visible=false;
		this.activityTime=new ActivityTime();
		this.mainBtnArr=[this.mainui.meiren,this.mainui.shouchong,this.mainui.huohuo,this.mainui.xianxian];
		this.funUpBtnArr=[this.mainui.lianmeng,this.mainui.paihang,this.mainui.waijiao];
		this.funDownBtnArr=[this.mainui.wujiang,this.mainui.shangdian,this.mainui.zhaomu,this.mainui.jice,this.mainui.haoyou,this.mainui.beibao];
		App.eventManager.on("HUODONGUPDATA",this,this.activityUpdata);
		App.eventManager.on("FLUSH_PLAYER_JOB",this,this.updataJob);
		App.eventManager.on("NEW_GUIDE_OPEN",this,this.openFun);
		this.upDataBtnClear();
		this.updataJob();
		this.activityUpdata();
		this.upDateIconPosition();
		this.mainui.lianmeng.on("click",this,this.openUnion);
		App.eventManager.event("REAPOINT",RedPointType.HUODONG);
	}

	__proto.openUnion=function(){
		this.unionSession.openUnion();
	}

	__proto.click=function(){
		this.setDragon("shouchong");
	}

	__proto.openFun=function(key){
		var sys=this.openFunctionSession.unlockObj[key];
		if(sys && sys.unlockType==1){
			var sp=this.mainui[sys.unlockId];
			if(sp){
				if(sys.unlockId=="shouchong"){
					var shouchongdata=this.activitySession.getTypeActivity(5);
					var time=0;
					if(shouchongdata){
						time=shouchongdata.endTime-GameUtils.GetServerTime();
					}
					if(time>0){
						sp.visible=true;
						sp.alpha=0;
						this.upDataBtn(sys);
						this.setDragon(sys.unlockId);
					}
					}else{
					sp.visible=true;
					sp.alpha=0;
					this.upDataBtn(sys);
					this.setDragon(sys.unlockId);
				}
			}
		}
	}

	__proto.upDataBtn=function(sys){
		if(sys.unlockIndex==1){
			this.upDateIconPosition();
			}else if(sys.unlockIndex==2){
			this.upDataUpBtn();
			}else if(sys.unlockIndex==3){
			this.upDataDownBtn();
		}
	}

	__proto.setDragon=function(name){
		if(this.mc){
			var sp1=this.mainui[this._name];
			if(sp1)sp1.alpha=1;
			this.mc.destroy();
			this.mc.removeSelf();
			this.mc=null;
		}
		this._name=name;
		var sp=this.mainui[name];
		this.mc=new DragonBonesMc(false);
		this.mc.playByTimes(1);
		this.mc.setUrl("res/load/NewProject.sk");
		this.mc.x=sp.x+63;
		this.mc.y=sp.y+67;
		this.mc.on("stopped",this,this.comDragon,[name,this.mc]);
		this.mainui.addChild(this.mc);
		Dialog.manager.setLockView(null);
		Dialog.manager.lock(true);
	}

	__proto.comDragon=function(name,_mc){
		var sp=this.mainui[name];
		sp.alpha=1;
		Dialog.manager.lock(false);
		if(name=="shouchong"){
			App.dialogManager.openDialogByStr("SHOUCHONG",null,true,true);
		}
		if(_mc){
			App.eventManager.event("ROLLOVER");
			_mc.destroy();
			_mc.removeSelf();
			_mc=null;
		}
	}

	__proto.upDataBtnClear=function(){
		for(var i=0;i<this.funDownBtnArr.length;i++){
			var sp=this.funDownBtnArr[i];
			var sys=this.openFunctionSession.getSys(sp.name);
			if(sys && sys.unlockType !=0){
				if(sys.unlockType==1){
					if(this.openFunctionSession.getFun(sys.unlockId)==false){
						sp.visible=false;
						}else{
						sp.visible=true;
					}
				}
			}
			else{
				sp.visible=true;
			}
		}
		this.upDataDownBtn();
	}

	__proto.addXinShouBtn=function(){
		var arr=ConfigManager.getDataArr("sys_unlock.txt");
		for(var i=0;i<arr.length;i++){
			var sys=arr[i];
		}
	}

	//}
	__proto.updataJob=function(){
		this.upDataBtnClear();
		var job=this.mainPlayerSession.mainPlayerData.job;
		var systitlepaleyr=ConfigManager.getConfig("sys_title_player.txt",job);
		this.mainui.txt1.text=systitlepaleyr.titleName;
		if(job==1001){
			this.setBoxVisible("paihang",false);
			this.setBoxVisible("waijiao",false);
			}else{
			this.setBoxVisible("paihang",true);
			this.setBoxVisible("waijiao",true);
		};
		var sys=this.openFunctionSession.getSys("lianmeng");
		var n=parseInt(sys.unlockCondition);
		if(job >=n){
			this.setBoxVisible("lianmeng",true);
			}else{
			this.setBoxVisible("lianmeng",false);
		}
		if(GameState.state==1){
			this.setBoxVisible("paihang",false);
			this.setBoxVisible("waijiao",false);
		}
		this.UpdateMeiri();
	}

	__proto.UpdateMeiri=function(){
		if(this.mainPlayerSession.mainPlayerData.job==1001){
			this.setBoxVisible("meiren",false);
			}else{
			this.setBoxVisible("meiren",true);
		}
	}

	/**
	*活动按钮显示隐藏 以及活动时间显示刷新
	*
	*/
	__proto.activityUpdata=function(){
		this.activityTime.addActivity(6,this.mainui.xiangouT);
		var xiangoudata=this.activitySession.getTypeActivity(6);
		this.setVisible(xiangoudata,"xianxian");
		var sys=this.openFunctionSession.getSys("shouchong");
		var shouchongdata=this.activitySession.getTypeActivity(5);
		this.setVisible(shouchongdata,"shouchong",this.openFunctionSession.getFun(sys.unlockId));
	}

	__proto.setVisible=function(data,str,open){
		(open===void 0)&& (open=true);
		if(data && open){
			var time=data.endTime-GameUtils.GetServerTime();
			if(time>0){
				this.setBoxVisible(str,true);
			}
			else{
				this.setBoxVisible(str,false);
			}
		}
		else{
			this.setBoxVisible(str,false);
		}
	}

	/**
	*设置图标显示隐藏
	*@param box名字，显示状态（true false）
	*
	*/
	__proto.setBoxVisible=function(boxName,boo){
		var box=this.mainui[boxName];
		if(box){
			box.visible=boo;
		}
		this.upDateIconPosition();
		this.upDataUpBtn();
		this.upDataDownBtn();
	}

	/**
	*图标有显示更改 就用这个方法刷新位置 活动的按钮
	*/
	__proto.upDateIconPosition=function(){
		var ww=0;
		if(GameState.state==1){
			ww=0;
			}else{
			ww=250;
		};
		var arr=[];
		var i=0;
		for(i=0;i<this.mainBtnArr.length;i++){
			var btn=this.mainBtnArr[i];
			if(btn.visible){
				arr.push(btn);
			}
		};
		var index=0;
		for(i=arr.length-1;i>=0;i--){
			arr[i].x=Laya.stage.width-((115*index+ww)+btn.width+20);
			index++;
		}
	}

	/**
	*中间的按钮
	*
	*/
	__proto.upDataUpBtn=function(){
		var arr=[];
		var i=0;
		for(i=0;i<this.funUpBtnArr.length;i++){
			var btn=this.funUpBtnArr[i];
			if(btn.visible){
				arr.push(btn);
			}
		};
		var index=0;
		for(i=arr.length-1;i>=0;i--){
			arr[i].x=Laya.stage.width-(105*index+120);
			index++;
		}
	}

	/**
	*下面的按钮
	*
	*/
	__proto.upDataDownBtn=function(){
		var arr=[];
		var i=0;
		for(i=0;i<this.funDownBtnArr.length;i++){
			var btn=this.funDownBtnArr[i];
			if(btn.visible){
				arr.push(btn);
			}
		};
		var index=0;
		for(i=arr.length-1;i>=0;i--){
			arr[i].x=Laya.stage.width-(105*index+120);
			index++;
		}
	}

	return MainUI;
})()


//class MainUIStat
var MainUIStat=(function(){
	function MainUIStat(icon){
		this.TOP=["meiren","shouchong","huohuo","xianxian"];
		this.UP_ICON=["lianmeng","paihang","waijiao"];
		this.DOWN_ICON=["wujiang","shangdian","zhaomu","jice","haoyou","beibao"];
		this.CHAT=["lt"];
		this.TOP_NO_TASK=["ren","map","dengji"];
		this.hideMap={};
		this.disMap={};
		this.hideArr=[];
		this.disArr=[];
		this.icon=null;
		this.icon=icon;
		this.regStat(3,[this.TOP,this.UP_ICON,this.DOWN_ICON,this.CHAT,this.TOP_NO_TASK,["box0","box2"]],[["box3"]]);
		this.regStat(4,[this.TOP,this.UP_ICON]);
	}

	__class(MainUIStat,'MainUIStat');
	var __proto=MainUIStat.prototype;
	/**
	*注册 应该隐藏哪些部位
	*@param stat
	*@param arr
	*/
	__proto.regStat=function(stat,hideArr1,disArr){
		this.hideMap[stat]=hideArr1;
		this.disMap[stat]=disArr;
	}

	__proto.setStat=function(stat){
		if(this.hideArr.length > 0 || this.disArr.length > 0){
			this.recover();
		}
		this.makeVisible(this.hideMap[stat] ,false ,this.hideArr);
		this.makeVisible(this.disMap[stat] ,true ,this.disArr);
	}

	/**
	*@param arr
	*@param value 希望他是否显示
	*@param pushArr
	*/
	__proto.makeVisible=function(arr,value,pushArr){
		if(arr==null){
			return;
		}
		for (var i=0;i < arr.length;i++){
			var iconNameArr=arr[i];
			for (var j=0;j < iconNameArr.length;j++){
				var iconName=iconNameArr[j];
				var sp=this.icon [iconName];
				if(sp==null){
					console.log("aaaaaaaaaaaaaaaaaaaa");
				}
				if(value !=sp.visible){
					sp.visible=value;
					pushArr.push(sp);
				}
			}
		}
	}

	/**
	*恢复到之前状态
	*/
	__proto.recover=function(){
		this.setVisible(this.hideArr,true);
		this.setVisible(this.disArr,false);
	}

	__proto.setVisible=function(arr,value){
		for (var i=0;i < arr.length;i++){
			arr[i].visible=value;
		}
		arr.length=0;
	}

	return MainUIStat;
})()


//class map.CityPlayerType
var CityPlayerType=(function(){
	function CityPlayerType(){}
	__class(CityPlayerType,'map.CityPlayerType');
	CityPlayerType.KONG=0;
	CityPlayerType.SELF=1;
	CityPlayerType.FRIEND=2;
	CityPlayerType.ENEMY=3;
	return CityPlayerType;
})()


//class map.GameState
var GameState=(function(){
	function GameState(){}
	__class(GameState,'map.GameState');
	GameState.HOME=1;
	GameState.MAIN=2;
	GameState.CHUZHENG=3;
	GameState.CITY_INNER=4;
	GameState.BINGLI_YUNSHU=5;
	GameState.GAME_OVER=6;
	GameState.state=0;
	return GameState;
})()


//class map.MapArrow
var MapArrow=(function(){
	function MapArrow(){}
	__class(MapArrow,'map.MapArrow');
	MapArrow.drawArrow=function(fromX,fromY,toX,toY,type,parent,ary){
		var deltaX=toX-fromX;
		var deltaY=toY-fromY;
		var isAddX=deltaX > 0 ? 1 :-1;
		var isAddY=deltaY > 0 ? 1 :-1;
		var distance=Math.sqrt(deltaX *deltaX+deltaY *deltaY);
		var angle=Math.atan2(deltaY,deltaX)*(180/Math.PI);
		angle=parseInt(angle+"");
		var content=new MovingBox(fromX,fromY,toX,toY);
		content.cacheAs="bitmap";
		var size=distance / 15;
		size=parseInt(size+"");
		for(var i=0;i < size;i++){
			var cell=ArrowCell.getOne(type);
			cell.pos(i *15,0);
			content.putCell(cell);
		}
		if(ary !=null && ary.length > 0){
			var anglevalue=angle > 0 ? angle :(360+angle);
			var disx=Math.sin(anglevalue*3.14/180)*10;
			var disy=Math.cos((180-anglevalue)*3.14/180)*10;
			console.log("disx = "+disx);
			console.log("disy = "+disy);
			for(i=0;i<ary.length;i++){
				var midline=ary [i];
				midline.pos(midline.fromx+disx,midline.fromy+disy);
			}
			content.pos(fromX-disx,fromY-disy);
			}else{
			content.pos(fromX,fromY);
		}
		content.rotation=angle;
		console.log("angle = "+angle);
		parent && parent.addChild(content);
		content.effectStart();
		return content;
	}

	return MapArrow;
})()


//class MyGameConst
var MyGameConst=(function(){
	function MyGameConst(){}
	__class(MyGameConst,'MyGameConst');
	MyGameConst.MODEL_URL="moxing/";
	MyGameConst.GOLD_ID=9902;
	MyGameConst.SILVER_ID=9903;
	MyGameConst.COLOR_GREEN=1;
	MyGameConst.COLOR_BLUE=2;
	MyGameConst.COLOR_PURPLE=3;
	MyGameConst.COLOR_YELLOW=4;
	MyGameConst.SHU=0;
	MyGameConst.WU=1;
	MyGameConst.WEI=2;
	MyGameConst.QUN=3;
	MyGameConst.JIN=4;
	return MyGameConst;
})()


//class MyGameInit
var MyGameInit=(function(){
	function MyGameInit(){
		ClassUtils.regClass("cityDeff00UI",cityDeff00UI);
		ClassUtils.regClass("10001_2",a10001_2UI);
		ClassUtils.regClass("10001_2_",a10001_3UI);
		ClassUtils.regClass("10002_2",a10002_2UI);
		ClassUtils.regClass("10002_2_",a10002_3UI);
		ClassUtils.regClass("10003_2",a10003_2UI);
		ClassUtils.regClass("10003_2_",a10003_3UI);
		ClassUtils.regClass("10004_2",a10004_2UI);
		ClassUtils.regClass("10004_2_",a10004_3UI);
		ClassUtils.regClass("10005_2",a10005_2UI);
		ClassUtils.regClass("10005_2_",a10005_3UI);
		ClassUtils.regClass("10006_2",a10006_2UI);
		ClassUtils.regClass("10006_2_",a10006_3UI);
		ClassUtils.regClass("10007_2",a10007_2UI);
		ClassUtils.regClass("10007_2_",a10007_3UI);
		ClassUtils.regClass("10008_2",a10008_2UI);
		ClassUtils.regClass("10008_2_",a10008_3UI);
		ClassUtils.regClass("10009_2",a10009_2UI);
		ClassUtils.regClass("10009_2_",a10009_3UI);
		ClassUtils.regClass("10010_2",a10010_2UI);
		ClassUtils.regClass("10010_2_",a10010_3UI);
		ClassUtils.regClass("10011_2",a10011_2UI);
		ClassUtils.regClass("10011_2_",a10011_3UI);
		ClassUtils.regClass("10012_2",a10012_2UI);
		ClassUtils.regClass("10012_2_",a10012_3UI);
		ClassUtils.regClass("10013_2",a10013_2UI);
		ClassUtils.regClass("10013_2_",a10013_3UI);
		ClassUtils.regClass("10014_2",a10014_2UI);
		ClassUtils.regClass("10014_2_",a10014_3UI);
		ClassUtils.regClass("10015_2",a10015_2UI);
		ClassUtils.regClass("10015_2_",a10015_3UI);
		ClassUtils.regClass("10016_2",a10016_2UI);
		ClassUtils.regClass("10016_2_",a10016_3UI);
		ClassUtils.regClass("10017_2",a10017_2UI);
		ClassUtils.regClass("10017_2_",a10017_3UI);
		ClassUtils.regClass("10018_2",a10018_2UI);
		ClassUtils.regClass("10018_2_",a10018_3UI);
		ClassUtils.regClass("10019_2",a10019_2UI);
		ClassUtils.regClass("10019_2_",a10019_3UI);
		ClassUtils.regClass("10020_2",a10020_2UI);
		ClassUtils.regClass("10020_2_",a10020_3UI);
		ClassUtils.regClass("10021_2",a10021_2UI);
		ClassUtils.regClass("10021_2_",a10021_3UI);
		ClassUtils.regClass("10022_2",a10022_2UI);
		ClassUtils.regClass("10022_2_",a10022_3UI);
		ClassUtils.regClass("10023_2",a10023_2UI);
		ClassUtils.regClass("10023_2_",a10023_3UI);
		ClassUtils.regClass("buffHurt1",buffHurt1UI);
		ClassUtils.regClass("buffhurt2",buffhurt2UI);
		ClassUtils.regClass("buffhurt3",buffhurt3UI);
		ClassUtils.regClass("skill1001",skill1001UI);
		ClassUtils.regClass("skill1002",skill1002UI);
		ClassUtils.regClass("skill1003",skill1003UI);
		ClassUtils.regClass("skill1004",skill1004UI);
		ClassUtils.regClass("skill1005",skill1005UI);
		ClassUtils.regClass("skill1006",skill1006UI);
		ClassUtils.regClass("skill1007",skill1007UI);
		ClassUtils.regClass("skill1009",skill1009UI);
		ClassUtils.regClass("skill1010",skill1010UI);
		ClassUtils.regClass("skill1011",skill1011UI);
		ClassUtils.regClass("skill1012",skill1012UI);
		ClassUtils.regClass("skill1013",skill1013UI);
		ClassUtils.regClass("skill1014",skill1014UI);
		ClassUtils.regClass("skill1017",skill1017UI);
		ClassUtils.regClass("skill1020",skill1020UI);
		ClassUtils.regClass("skill1021",skill1021UI);
		ClassUtils.regClass("skill1022",skill1022UI);
		ClassUtils.regClass("skill1023",skill1023UI);
		ClassUtils.regClass("skill1024",skill1024UI);
		ClassUtils.regClass("skill1025",skill1025UI);
		ClassUtils.regClass("skill1026",skill1026UI);
		ClassUtils.regClass("skill1028",skill1028UI);
		ClassUtils.regClass("skill1029",skill1029UI);
		ClassUtils.regClass("skill1030",skill1030UI);
		ClassUtils.regClass("skill1031",skill1031UI);
		ClassUtils.regClass("skill1032",skill1032UI);
		ClassUtils.regClass("skill1033",skill1033UI);
		ClassUtils.regClass("skill2002",skill2002UI);
		ClassUtils.regClass("skill2003",skill2003UI);
		ClassUtils.regClass("skill2007",skill2007UI);
		ClassUtils.regClass("skill2008",skill2008UI);
		ClassUtils.regClass("skill2009",skill2009UI);
		ClassUtils.regClass("skill2010",skill2010UI);
		ClassUtils.regClass("skill2011",skill2011UI);
		ClassUtils.regClass("skill2012",skill2012UI);
		ClassUtils.regClass("skill2013",skill2013UI);
		ClassUtils.regClass("skill3005",skill3005UI);
		ClassUtils.regClass("skill3006",skill3006UI);
		ClassUtils.regClass("skill3007",skill3007UI);
		ClassUtils.regClass("buffSeat1",buffSeat1UI);
		ClassUtils.regClass("buffSeat2",buffSeat2UI);
		ClassUtils.regClass("buffSeat3",buffSeat3UI);
		ClassUtils.regClass("buffSeat4",buffSeat4UI);
		ClassUtils.regClass("buffSeat5",buffSeat5UI);
		ClassUtils.regClass("buffSeat6",buffSeat6UI);
		ClassUtils.regClass("buffSeat7",buffSeat7UI);
		ClassUtils.regClass("buffSeat8",buffSeat8UI);
		ClassUtils.regClass("buffSeat9",buffSeat9UI);
		ClassUtils.regClass("buffSeat10",buffSeat10UI);
		ClassUtils.regClass("buffSeat11",buffSeat11UI);
		ClassUtils.regClass("buffSeat12",buffSeat12UI);
		ClassUtils.regClass("buffSeat13",buffSeat13UI);
		ClassUtils.regClass("buffSeat14",buffSeat14UI);
		ClassUtils.regClass("buffSeat15",buffSeat15UI);
		ClassUtils.regClass("buffSeat16",buffSeat16UI);
		ClassUtils.regClass("buffSeat17",buffSeat17UI);
		ClassUtils.regClass("buffSeat18",buffSeat18UI);
		ClassUtils.regClass("buffSeat19",buffSeat19UI);
		ClassUtils.regClass("buffSeat20",buffSeat20UI);
		ClassUtils.regClass("buffSeat21",buffSeat21UI);
		ClassUtils.regClass("buffDischarge",buffDischargeUI);
		ClassUtils.regClass("buffDischarge_1",buffDischarge_1UI);
		ClassUtils.regClass("SbuffSeat1",SbuffSeat1UI);
		ClassUtils.regClass("SbuffSeat2",SbuffSeat2UI);
		ClassUtils.regClass("SbuffSeat3",SbuffSeat3UI);
		ClassUtils.regClass("SbuffSeat4",SbuffSeat4UI);
		ClassUtils.regClass("SbuffSeat5",SbuffSeat5UI);
		ClassUtils.regClass("SbuffSeat6",SbuffSeat6UI);
		ClassUtils.regClass("SbuffSeat7",SbuffSeat7UI);
		ClassUtils.regClass("SbuffSeat8",SbuffSeat8UI);
		ClassUtils.regClass("SbuffSeat9",SbuffSeat9UI);
		ClassUtils.regClass("SbuffSeat10",SbuffSeat10UI);
		ClassUtils.regClass("SbuffSeat11",SbuffSeat11UI);
		ClassUtils.regClass("SbuffSeat12",SbuffSeat12UI);
		ClassUtils.regClass("SbuffSeat13",SbuffSeat13UI);
		ClassUtils.regClass("SbuffSeat14",SbuffSeat14UI);
		ClassUtils.regClass("SbuffSeat15",SbuffSeat15UI);
		ClassUtils.regClass("jian0",jian0UI);
		ClassUtils.regClass("jian2",jian2UI);
		ClassUtils.regClass("jian4",jian4UI);
		ClassUtils.regClass("jian5",jian5UI);
		ClassUtils.regClass("jian6",jian6UI);
		ClassUtils.regClass("jian7",jian7UI);
		ClassUtils.regClass("jian8",jian8UI);
		ClassUtils.regClass("jian9",jian9UI);
		ClassUtils.regClass("jian10",jian10UI);
		App.voiceManager.setRoot("SOUND");
	}

	__class(MyGameInit,'MyGameInit');
	var __proto=MyGameInit.prototype;
	Laya.imps(__proto,{"game.base.IGameInit":true})
	__proto.initDialog=function(){
		App.dialogManager.regDialog("DIALOG_TASK",RenwuPanel,"task",TaskMediator);
		App.dialogManager.regDialog("DIALOG_ZHAO_MU",ZhaomuPanel,"zhaomu",ZhaoMuMediator);
		App.dialogManager.regDialog("DIALOG_SHOP",ShopPanel,"shangdian",ShopMediator);
		App.dialogManager.regDialog("DIALOG_STRATAGEM",StratagemPanel,"jice",StratagemMediator);
		App.dialogManager.regDialog("DIALOG_BAG",BagPanel,"beibao",null);
		App.dialogManager.regDialog("CITY_BUILD_CREATE",CityBuildCreate,"town",CityBuildCreateMediator);
		App.dialogManager.regDialog("CITY_BUILD_LVUP",CityBuildLvup,"town",CityBuildLvUpMediator);
		App.dialogManager.regDialog("CITY_BUDUI",CityBudui,null,CityBuduiMediator);
		App.dialogManager.regDialog("CITY_BUDUI_DIAOBING",Diaobing,null,DiaobingMediator);
		App.dialogManager.regDialog("REMOVE_BUILD",CityBuildRemove,null,CityBuildRemoveMediator);
		App.dialogManager.regDialog("CHUZHENG",ChuZheng,"chuzheng",ChuzhengMediator);
		App.dialogManager.regDialog("WUJIANG",WuJiangPanel,"wujiang",WuJiangMediator);
		App.dialogManager.regDialog("WUJIANGSHUOMING",HeroInfoTab,"wujiang",WuJiangXinXiMediator);
		App.dialogManager.regDialog("SELECT_WUJIANG",SelectChuzheng,"chuzheng",SelectChuzhengMediator);
		App.dialogManager.regDialog("XINGJUN_LIST",XingjunList,null,XingjunListMediator);
		App.dialogManager.regDialog("YUNSHU_BINGLI",Yunshu,null,YunshuMediator);
		App.dialogManager.regDialog("GAME_OVER",GameOver,"jiesuan",GameOverMediator);
		App.dialogManager.regDialog("QINGBAO",Qingbao,null,QingbaoMediator);
		App.dialogManager.regDialog("WORLDMAP",WorldMap,"ditu",WorldMapMediator);
		App.dialogManager.regDialog("WAIJIAO",WaiJiaoPanel,"waijiao",WaiJiaoMediator);
		App.dialogManager.regDialog("ZHANBAO",ZhanbaoList,"zhanbaolb",ZhanbaoMediator);
		App.dialogManager.regDialog("JIANBAO",ZhanBaoInfo,"jiesuan",ZhanbaoInfoMediator);
		App.dialogManager.regDialog("CHENGCHI",CityPanel,null,CityPanelMediator);
		App.dialogManager.regDialog("BINGLIJJ",Binglijijie,null,CityMediator);
		App.dialogManager.regDialog("MYMESSAGE",MessagePanel,"gerenxinxi",MessageMediator);
		App.dialogManager.regDialog("MJLPANEL",MjlPanel,null,MjlMediator);
		App.dialogManager.regDialog("YAOQING_ZUDUI",YaoqingZudui,null,YaoqingZuduiMediator);
		App.dialogManager.regDialog("MJLSHUOMING",MjlXinxiPanel,null,MjlXinxiMediator);
		App.dialogManager.regDialog("HAOYOU",Haoyou,"haoyou",HaoyouMediator);
		App.dialogManager.regDialog("ADDHAOYOU",AddHaoyou,null,AddHaoyouMediator);
		App.dialogManager.regDialog("TASK",TaskDialog,null,TaskMediator);
		App.dialogManager.regDialog("BEIZHU",Beizhu,null,BeizhuMediator);
		App.dialogManager.regDialog("ZHENGRONGXUANZE",ZhenrongXuanze,null,ZhenrongXuanzeMediator);
		App.dialogManager.regDialog("SELECTZHENGRONG",SelectZhenrong,null,SelectZhenrongMediator);
		App.dialogManager.regDialog("FENXIANG",FenxiangPanel,null,FenxiangMediator);
		App.dialogManager.regDialog("SHOUCANG",ShoucangPanel,null,ShoucangMediator);
		App.dialogManager.regDialog("SHOUCANG_INFO",ShoucangZhanbaoInfo,"jiesuan",ShoucangZhanbaoInfoMediator);
		App.dialogManager.regDialog("TONGJI",TongjiPanel,null,TongjiMediator);
		App.dialogManager.regDialog("MAILBATTLE",MailBattlePanel,"zhanbaolb",MailBattleMediator);
		App.dialogManager.regDialog("RECHARGEPANEL",RechargePanel,"chongzhi",RechargeMediator);
		App.dialogManager.regDialog("HUODONG",HuodongPanel,"huodong",HuodongMediator);
		App.dialogManager.regDialog("RANKLIST",RankList,null,RankMediator);
		App.dialogManager.regDialog("SETTING",SettingPanel,null,SettingMediator);
		App.dialogManager.regDialog("XIANGOU",XianGouPanel,null,XianGouMediator);
		App.dialogManager.regDialog("CDKEY",CDkeyPanel,null,CDkeyMediator);
		App.dialogManager.regDialog("DIANZAN",Dianzan,null,DianzanMediator);
		App.dialogManager.regDialog("DIANZAN2",DianzanView,null,Dianzan2Mediator);
		App.dialogManager.regDialog("VIPPANEL",VipPanel,null,VipMediator);
		App.dialogManager.regDialog("SHOUCHONG",ShouChongPanel,"shouchong",ShouChongMediator);
		App.dialogManager.regDialog("CHECK_OTHER_PLAYER",CheckOtherHero,"wujiang");
		App.dialogManager.regDialog("Mail_Battle_Jie_Suan",MailBattleJieSuan,"jiesuan");
		App.dialogManager.regDialog("Shop_Buy_Silver",TipsBuySilver,null);
		App.dialogManager.regDialog("DROPGIFT",DropGiftPanel,null,DropGiftMediator);
		App.dialogManager.regDialog("UNIONPANEL",UnionPanel,"lianmeng",UnionMediator);
		App.dialogManager.regDialog("NEWUNIONPANEL",NewUnionPanel,"lianmeng",NewUnionMediator);
		App.dialogManager.regDialog("TZHUANX",TZSXZPanel,null,TZSXZMediator);
		App.dialogManager.regDialog("DUOBAOJILU",DuoBaoJiLuPanel,null,DuoBaoJiLuMediator);
		App.dialogManager.regDialog("MEIRIPANEL",HuoyueDayView,"huodong",HuoyueDayMediator);
	}

	/**
	*注册Session
	*/
	__proto.initSession=function(){
		App.regSession(MainPlayerSession);
		App.regSession(ZhaoMuSession);
		App.regSession(ShopSession);
		App.regSession(StratagemSession);
		App.regSession(WuJiangSession);
		App.regSession(BagSession);
		App.regSession(MapCitySession);
		App.regSession(WujiangXinxiSession);
		App.regSession(BattleSession);
		App.regSession(HeroTeamSession);
		App.regSession(PlayerInfoSession);
		App.regSession(FriendSession);
		App.regSession(MailSession);
		App.regSession(TalkSession);
		App.regSession(TaskSession);
		App.regSession(MailBattleSession);
		App.regSession(ShouFenSession);
		App.regSession(RechargeSession);
		App.regSession(SignInSession);
		App.regSession(HeartSession);
		App.regSession(RankSession);
		App.regSession(SettingSession);
		App.regSession(ActivitySession);
		App.regSession(LoginSession);
		App.regSession(SevenrenwuSession);
		App.regSession(HuoyueSession);
		App.regSession(HuoyueDaySession);
		App.regSession(DropGiftSession);
		App.regSession(DuoBaoSession);
		App.regSession(OpenFunctionSession);
		App.regSession(SensitiveSession);
		App.regSession(SoundSession);
		App.regSession(CreateRoleSession);
		App.regSession(VictoryBoxSession);
		App.regSession(DianZanSession);
		App.regSession(LoadSession);
		App.regSession(BtnSoundSession);
		App.regSession(RedPoingSession);
		App.regSession(DotSesion);
		App.regSession(VideoSession);
		App.regSession(GuideSession);
		App.regSession(UnionSession);
		App.regSession(SdkSession);
	}

	/**
	*注册Action
	*/
	__proto.initAction=function(){
		App.regAction(1,ErrorTipsAction);
		App.regAction(2003,InitServerTimeAction);
		App.regAction(3001,ZhaoMuAction);
		App.regAction(1001,LoginAction);
		App.regAction(0,HeartAction);
		App.regAction(2001,ShopAction);
		App.regAction(2002,StratagemAction);
		App.regAction(3002,WuJiangAction);
		App.regAction(1002,MapCityAction);
		App.regAction(3003,HeroTeamAction);
		App.regAction(2004,BagAction);
		App.regAction(2005,FlushPlayerNumAction);
		App.regAction(2006,TalkAction);
		App.regAction(3004,ArmsAction);
		App.regAction(1004,PlayerInfoAction);
		App.regAction(1007,FriendAction);
		App.regAction(1006,MailAction);
		App.regAction(3005,TaskAction);
		App.regAction(1003,ShouFenAction);
		App.regAction(1009,RechargeAction);
		App.regAction(1008,SignInAction);
		App.regAction(2007,GuideAction);
		App.regAction(1005,RankAction);
		App.regAction(1010,SettingAction);
		App.regAction(4001,SevenTaskAction);
		App.regAction(4002,HuoyueDayAction);
		App.regAction(1011,ActivityAction);
		App.regAction(2,ChangeServerAction);
		App.regAction(3006,NewPlayerTaskAction);
		App.regAction(3007,GPlayerTaskAction);
		App.regAction(5001,VictoryBoxAction);
		App.regAction(2008,PaoMaAction);
		App.regAction(3,KickPlayerAction);
		App.regAction(2009,DuoBaoAction);
		App.regAction(1012,Md5Action);
		App.regAction(1013,UnionAction);
		App.regAction(4,BannedAction);
	}

	// App.regAction(ActionId.LEIJICHONGZHI,LeijiNewAction);
	__proto.initCommand=function(){}
	__proto.initDoublePanel=function(){}
	__proto.initScence=function(){
		App.sceneManager.regScene("MAIN_SCENE",MainScene,null,new Handler(MainScene,MainScene.loadResFun));
		var loginArr=[];
		loginArr.push(SceneData.getResData("res/atlas/uiAction/load_dong.atlas",""));
		loginArr.push(MyGameInit.RES("go.atlas"));
		App.sceneManager.regScene("LOGIN_SCENE",LoginScene,LoginSceneMediator,loginArr,false,false,"LOGIN_GROUP");
		App.sceneManager.regScene("CREATE_SCENE",CreateRoleScene,null,[MyGameInit.RES("createRole.atlas")],false,false,"CreateRoleScene");
		App.sceneManager.regScene("BATTLE_FIELD",BattleFileScene,BattleFieldMediator,new Handler(BattleSession,BattleSession.loadResFun),true,true);
	}

	__proto.initGameLoader=function(){
		App.loaderManager.regPath("","");
		App.loaderManager.regPath("ATLAS","res/atlas/comp/");
		App.loaderManager.regPath("PNG","res/png/");
		App.loaderManager.regPath("HERO","res/wujiang/");
		App.loaderManager.regPath("ITEM","res/item");
		App.loaderManager.regPath("CLIP","res/clip/");
		App.loaderManager.regPath("SKILL_EFFECT","res/skill/");
		App.loaderManager.regPath("BATTLE_CLIP","res/atlas/ani2/");
		App.loaderManager.regPath("BATTLE",App.configJson["zhanbao"]);
		App.loaderManager.regPath("BUFFER","res/atlas/skill/buff/");
		App.loaderManager.regPath("SKILL","res/atlas/skill/skill/");
		App.loaderManager.regPath("ZHAN_HUO","res/atlas/skill/");
		App.loaderManager.regPath("BATTLE_ANI","ANI/soldiersAni2/");
		App.loaderManager.regPath("SOUND","res/sound/");
	}

	/**
	*两种形式注册配置文件
	*1.App.configManager.regConfig(sys_hero,SysHero,"heroId");
	2.App.configManager.regConfig(sys_hero,SysHero,function(data:SysHero):Object {
		return data.heroId;
	});

	*/
	__proto.initConfig=function(){
		App.configManager.regConfig("sys_tips.txt",SysTips,"tipsId");
		App.configManager.regConfig("sys_hero.txt",SysHero,"heroId");
		App.configManager.regConfig("sys_city.txt",SysCity,"cityId");
		App.configManager.regConfig("sys_strategy.txt",SysStrategy,"strId");
		App.configManager.regConfig("sys_timetake.txt",SysTimeTake,"timeType");
		App.configManager.regConfig("sys_skill.txt",SysSkill,"skillId");
		App.configManager.regConfig("sys_item.txt",SysItem,"itemId");
		App.configManager.regConfig("sys_building.txt",SysBuilding,function(data){
			return data.buildType+"_"+data.buildLevel;
		});
		App.configManager.regConfig("sys_strength.txt",SysStrength,function(data){
			return data.strengthColor+"_"+data.strengthLv;
		});
		App.configManager.regConfig("sys_equip.txt",SysEquip,"equipId");
		App.configManager.regConfig("sys_attr_name.txt",SysAttrName,"attrId");
		App.configManager.regConfig("sys_title_player.txt",SysTitlePlayer,"titleId");
		App.configManager.regConfig("sys_skill_effect.txt",SysSkillEffect,"effectId");
		App.configManager.regConfig("sys_estimate.txt",SysEstimate,"estimate");
		App.configManager.regConfig("sys_shop.txt",SysShop,"shopItemId");
		App.configManager.regConfig("sys_level_hero.txt",SysLevelHero,"heroLevel");
		App.configManager.regConfig("sys_hero_progress.txt",SysHeroProgress,function(data){
			return data.heroColor+"_"+data.heroStar;
		});
		App.configManager.regConfig("sys_talent.txt",SysTalent,"talentId");
		App.configManager.regConfig("sys_lan.txt",SysLan,"key");
		App.configManager.regConfig("sys_skill_mix.txt",SysSkillMix,"mixSkillId");
		App.configManager.regConfig("sys_force.txt",SysForce,"forceId");
		App.configManager.regConfig("sys_level_lord.txt",SysLevelLord,"lordLevel");
		App.configManager.regConfig("sys_drop.txt",SysDrop,"dropId");
		App.configManager.regConfig("sys_title_record.txt",SysTitleRecord,"recordType");
		App.configManager.regConfig("sys_match.txt",SysMath,"titleId");
		App.configManager.regConfig("sys_hero_queue.txt",SysHeroQueue,"queueId");
		App.configManager.regConfig("sys_buff.txt",SysBuff,"buffId");
		App.configManager.regConfig("sys_skill_wake.txt",SkillWake,"wakeSkillId");
		App.configManager.regConfig("sys_task.txt",SysTask,"taskId");
		App.configManager.regConfig("sys_mail.txt",SysMail,"mailID");
		App.configManager.regConfig("sys_hero_vice.txt",SysVice,"viceHeroStar");
		App.configManager.regConfig("sys_draw.txt",SysDraw,"drawId");
		App.configManager.regConfig("sys_draw_award.txt",SysDrawAward,"drawAwardId");
		App.configManager.regConfig("sys_guide.txt",SysGuide,function(data){
			return data.guideId+"_"+data.guideStep+"_"+data.compensateStep;
		});
		App.configManager.regConfig("sys_activity.txt",SysActivity,"activityId");
		App.configManager.regConfig("sys_recharge_fytx.txt",SysRecharge,"rechargeId");
		App.configManager.regConfig("sys_activity_condition.txt",SysActivityCondition,"activityType");
		App.configManager.regConfig("sys_name.txt",SysName,"adjective");
		App.configManager.regConfig("sys_recruit_hero.txt",SysRecruitData,"recruitHero");
		App.configManager.regConfig("sys_lordbody.txt",SysLordbody,"lordBodyId");
		App.configManager.regConfig("sys_member.txt",SysMember,"memberId");
		App.configManager.regConfig("sys_unlock.txt",SysUnlock,"unlockId");
		App.configManager.regAnalysisFun("pingbiziku.txt",function(str){
			GameUtils.PINGBI=str;
		});
		App.configManager.regConfig("sys_sound.txt",SysSound,"soundId");
		App.configManager.regConfig("sys_society_levelup.txt",SysUnion,"allianceLv");
		App.configManager.regAnalysisFun("lang.txt",Language.init);
		App.configManager.regConfig("sys_hero_reset.txt" ,SysHeroReset,"resetTime");
		App.configManager.regConfig("sys_society_basic.txt" ,Syssociety,"societyId");
		App.configManager.regConfig("sys_society_cost.txt" ,SysCost,"costId");
		App.configManager.regConfig("sys_society_shop.txt" ,SysUnionShop,"id");
	}

	__proto.initPng=function(){
		App.pngManager.regPng(2 ,"comp/zhandou/baoji.png");
		App.pngManager.regPng(3 ,"comp/zhandou/shanbi.png");
		App.pngManager.regPng(4 ,"comp/zhandou/shipo.png");
		App.pngManager.regPng(5 ,"comp/zhandou/r");
		App.pngManager.regPng(6 ,"comp/zhandou/y");
		App.pngManager.regPng(7 ,"comp/zhandou/g");
		App.pngManager.regPng(8 ,"comp/zhandou/shu_");
		App.pngManager.regPng(9,"comp/G/k_");
	}

	MyGameInit.RES=function(res){
		return SceneData.getResData(res,"ATLAS");
	}

	MyGameInit.isFaceBook=function(){
		return App.configJson["platformId"]=="1003";
	}

	MyGameInit.isFlySDK=function(){
		return App.configJson["platformId"]=="1002";
	}

	MyGameInit.isWeb=function(){
		return App.configJson["platformId"]=="1001";
	}

	MyGameInit.isQunHei=function(){
		return App.configJson["platformId"]=="1004";
	}

	MyGameInit.isXuYang=function(){
		return App.configJson["platformId"]=="1005";
	}

	MyGameInit.is360=function(){
		return App.configJson["platformId"]=="1006";
	}

	MyGameInit.getVer=function(){
		return MyGameInit.getConfig("ver");
	}

	MyGameInit.getConfig=function(str){
		var pid=App.configJson["platformId"];
		return App.configJson[pid][str];
	}

	MyGameInit.VER="2018-10-31 14:08:24";
	MyGameInit.MAIN_SCENE="MAIN_SCENE";
	MyGameInit.CREATE_SCENE="CREATE_SCENE";
	MyGameInit.BATTLE_FIELD="BATTLE_FIELD";
	MyGameInit.LOGIN_SCENE="LOGIN_SCENE";
	MyGameInit.ROOT="";
	MyGameInit.BATTLE_RES="BATTLE";
	MyGameInit.HERO="HERO";
	MyGameInit.CLIP="CLIP";
	MyGameInit.ITEM="ITEM";
	MyGameInit.SKILL_EFFECT="SKILL_EFFECT";
	MyGameInit.BATTLE_CLIP="BATTLE_CLIP";
	MyGameInit.BUFFER="BUFFER";
	MyGameInit.SKILL="SKILL";
	MyGameInit.ZHAN_HUO="ZHAN_HUO";
	MyGameInit.BATTLE_ANI="BATTLE_ANI";
	MyGameInit.SOUND="SOUND";
	MyGameInit.sys_hero="sys_hero.txt";
	MyGameInit.sys_city="sys_city.txt";
	MyGameInit.sys_strategy="sys_strategy.txt";
	MyGameInit.sys_timetake="sys_timetake.txt";
	MyGameInit.sys_item="sys_item.txt";
	MyGameInit.sys_skill="sys_skill.txt";
	MyGameInit.sys_strength="sys_strength.txt";
	MyGameInit.sys_equip="sys_equip.txt";
	MyGameInit.sys_building="sys_building.txt";
	MyGameInit.sys_shop="sys_shop.txt";
	MyGameInit.sys_attr_name="sys_attr_name.txt";
	MyGameInit.sys_title_player="sys_title_player.txt";
	MyGameInit.sys_skill_effect="sys_skill_effect.txt";
	MyGameInit.sys_estimate="sys_estimate.txt";
	MyGameInit.sys_level_hero="sys_level_hero.txt";
	MyGameInit.sys_hero_progress="sys_hero_progress.txt";
	MyGameInit.sys_talent="sys_talent.txt";
	MyGameInit.sys_lan="sys_lan.txt";
	MyGameInit.sys_skill_mix="sys_skill_mix.txt";
	MyGameInit.sys_force="sys_force.txt";
	MyGameInit.sys_level_lord="sys_level_lord.txt";
	MyGameInit.sys_drop="sys_drop.txt";
	MyGameInit.sys_title_record="sys_title_record.txt";
	MyGameInit.sys_math="sys_match.txt";
	MyGameInit.sys_hero_queue="sys_hero_queue.txt";
	MyGameInit.sys_buff="sys_buff.txt";
	MyGameInit.sys_skill_wake="sys_skill_wake.txt";
	MyGameInit.sys_task="sys_task.txt";
	MyGameInit.sys_tips="sys_tips.txt";
	MyGameInit.sys_Mail="sys_mail.txt";
	MyGameInit.sys_hero_vice="sys_hero_vice.txt";
	MyGameInit.sys_guide="sys_guide.txt";
	MyGameInit.sys_activity="sys_activity.txt";
	MyGameInit.sys_recharge_fytx="sys_recharge_fytx.txt";
	MyGameInit.sys_activity_condition="sys_activity_condition.txt";
	MyGameInit.sys_name="sys_name.txt";
	MyGameInit.sys_lordbody="sys_lordbody.txt";
	MyGameInit.sys_member="sys_member.txt";
	MyGameInit.sys_unlock="sys_unlock.txt";
	MyGameInit.pingbiziku="pingbiziku.txt";
	MyGameInit.sys_recruit_hero="sys_recruit_hero.txt";
	MyGameInit.sys_sound="sys_sound.txt";
	MyGameInit.lang="lang.txt";
	MyGameInit.sys_society_levelup="sys_society_levelup.txt";
	MyGameInit.sys_hero_reset="sys_hero_reset.txt";
	MyGameInit.sys_draw="sys_draw.txt";
	MyGameInit.sys_draw_award="sys_draw_award.txt";
	MyGameInit.sys_society_basic="sys_society_basic.txt";
	MyGameInit.sys_society_cost="sys_society_cost.txt";
	MyGameInit.sys_society_shop="sys_society_shop.txt";
	MyGameInit.BATTLE_ANGER_DARK="comp/zhandou/btn_nengliang.png";
	MyGameInit.BATTLE_ANGER_LIGHT="comp/zhandou/h1.png";
	MyGameInit.FONT_BAOJI=2;
	MyGameInit.FONT_SHANBI=3;
	MyGameInit.FONT_SHIPO=4;
	MyGameInit.FONT_RED=5;
	MyGameInit.FONT_YELLOW=6;
	MyGameInit.FONT_GREEN=7;
	MyGameInit.FONT_TURN=8;
	MyGameInit.FONT_CARD_FIGHT=9;
	MyGameInit.BATTLE_JIAN="comp/zhandou/jian.png";
	MyGameInit.BATTLE_SPEED="comp/zhandou/z_";
	return MyGameInit;
})()


//class QunHeiData
var QunHeiData=(function(){
	function QunHeiData(){
		this.username=null;
		this.serverid=null;
		this.time=null;
		this.isadult=null;
		this.flag=null;
		this.showbtn=null;
		this.qhchannel=null;
		this.qhchannelid=null;
		this.nname=null;
		this.uimg=null;
	}

	__class(QunHeiData,'QunHeiData');
	return QunHeiData;
})()


//class QunHeiManager
var QunHeiManager=(function(){
	function QunHeiManager(){}
	__class(QunHeiManager,'QunHeiManager');
	QunHeiManager.isQunHei=function(){
		return QunHeiManager.getSDK()!=null;
	}

	QunHeiManager.getSDK=function(){
		return Browser.window.qhsdk;
	}

	QunHeiManager.init=function(){
		var url=Browser.window.location.href;
		var str=url.split("?")[1];
		var split=str.split("&");
		for (var i=0;i < split.length;i++){
			var str1=split[i];
			var split2=str1.split("=");
			QunHeiManager.qunHeiData[ split2[0]]=split2[1];
		};
		var initdata={
			"username":QunHeiManager.qunHeiData.username,
			"gid":QunHeiManager.GAME_ID,
			"qhchannel":QunHeiManager.qunHeiData.qhchannel,
			"qhchannelid":QunHeiManager.qunHeiData.qhchannelid,
			"time":QunHeiManager.qunHeiData.time
		};
		QunHeiManager.getSDK().init(initdata);
		App.eventManager.on("DOT_CREAT_ROLE_SUC",QunHeiManager,QunHeiManager.createFun);
		App.eventManager.on("LOGIN_SUCCESS",QunHeiManager,QunHeiManager.loginFun);
		App.eventManager.on("PAY",QunHeiManager,QunHeiManager.payFun);
	}

	QunHeiManager.payFun=function(rechargeData){
		var paydata={
			"userId":QunHeiManager.qunHeiData.username,
			"gid":QunHeiManager.GAME_ID,
			"roleName":QunHeiManager.roleName,
			'goodsId':rechargeData.product_id,
			"goodsName":rechargeData.product_name,
			"money":rechargeData.product_price,
			"ext":rechargeData.cp_order_id,
			"serverId":QunHeiManager.qunHeiData.serverid,
			"sign":""
		};
		QunHeiManager.getMd5(paydata);
	}

	QunHeiManager.getMd5=function(payData){
		var http=new HttpRequest();
		var json={};
		json["action"]="QunHeiSign";
		json["content"]=payData.money+payData.userId+payData.ext+"";
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",QunHeiManager,QunHeiManager.sendPay,[payData]);
	}

	QunHeiManager.sendPay=function(payData,md5){
		payData.sign=md5;
		QunHeiManager.getSDK().pay(payData,function(code,msg){
		});
	}

	QunHeiManager.loginFun=function(data){
		QunHeiManager.createRole("2",data.playerName,data.playerId,data.Lv);
	}

	QunHeiManager.createFun=function(arr){
		QunHeiManager.createRole("1",arr[1],arr[0],1);
	}

	QunHeiManager.createRole=function(act,roleName,roleId,lv){
		QunHeiManager.roleName=roleName;
		QunHeiManager.roleId=roleId;
		var roledata={
			"act":"1",
			"serverid":QunHeiManager.qunHeiData.serverid,
			"rolename":roleName,
			"roleid":roleId,
			"level":lv
		};
		QunHeiManager.getSDK().role(roledata);
	}

	QunHeiManager.GAME_ID="4068";
	QunHeiManager.roleName=null;
	QunHeiManager.roleId=0;
	__static(QunHeiManager,
	['qunHeiData',function(){return this.qunHeiData=new QunHeiData();}
	]);
	return QunHeiManager;
})()


//class SDKManager
var SDKManager=(function(){
	/**
	*和sdk互动的都在这里
	*/
	function SDKManager(){}
	__class(SDKManager,'SDKManager');
	SDKManager.callSDK=function(string,__args){
		var args=[];for(var i=1,sz=arguments.length;i<sz;i++)args.push(arguments[i]);
		var MainActivity=Laya.PlatformClass.createClass("demo.MainActivity");
		MainActivity.call(string);
	}

	SDKManager.callSDK_ARGS=function(string,data){
		var MainActivity=Laya.PlatformClass.createClass("demo.MainActivity");
		MainActivity.call(string,data);
	}

	SDKManager.playVideo=function(){
		SDKManager.callSDK("MOVIE2");
	}

	SDKManager.videoOver=function(){
		App.eventManager.event("VIDEO_OVER");
	}

	SDKManager.setSdkId=function(id){
		App.eventManager.event("SET_SDK_ID",id);
	}

	SDKManager.payOnSuccess=function(order_id,amount){}
	SDKManager.payOnFail=function(code,errorMsg,order_id,amount){}
	SDKManager.payOnCancel=function(){}
	SDKManager.switchUser=function(id){
		App.eventManager.event("SET_SDK_ID",id);
	}

	SDKManager.exit=function(){
		App.eventManager.event("LOGOUT_SDK");
	}

	SDKManager.loginCancel=function(){
		App.eventManager.event("LOGIN_SDK_CANCEL");
	}

	SDKManager.INIT_SDK="INIT_SDK";
	SDKManager.LOGIN_SDK="LOGIN_SDK";
	SDKManager.PAY_SDK="PAY_SDK";
	return SDKManager;
})()


//class Test
var Test=(function(){
	function Test(){
		this.sprite=null;
		this.speedX=-600;
		this.g=2000;
		//重力加速度
		this.allt=0;
		this.start=0;
		this.spArr=[];
		this.speedY=0;
		this.init();
	}

	__class(Test,'Test');
	var __proto=Test.prototype;
	__proto.init=function(){
		Laya.stage.on("click",this,this.clickFun);
	}

	__proto.clickFun=function(e){
		if(e.ctrlKey==false){
			return;
		}
		if(this.spArr.length==2){
			this.sprite=new Sprite();
			this.sprite.graphics.drawCircle(0,0,20,"#ffffff");
			Laya.stage.addChild(this.sprite);
			var sp1=this.spArr[0];
			this.sprite.pos(sp1.x,sp1.y);
			var sp2=this.spArr[1];
			var w=sp2.x-sp1.x;
			this.allt=Math.abs(w/this.speedX);
			this.speedY=(sp1.y-sp2.y+this.g *this.allt *this.allt / 2)/this.allt;
			Laya.timer.loop(1,this,this.fun1);
			this.start=Browser.now();
			}else{
			var sprite2=new Sprite();
			sprite2.graphics.drawCircle(0,0,10,"#00ffff");
			Laya.stage.addChild(sprite2);
			sprite2.pos(Laya.stage.mouseX,Laya.stage.mouseY);
			this.spArr.push(sprite2);
		}
	}

	__proto.fun1=function(){
		var time=(Browser.now()-this.start)/1000;
		if(time > this.allt){
			Laya.timer.clear(this,this.fun1);
			this.sprite.removeSelf();
			return;
		}
		this.sprite.x=this.spArr[0].x+time *this.speedX;
		this.sprite.y=this.spArr[0].y-(this.speedY *time-this.g *time *time / 2);
	}

	return Test;
})()


/**
*Config 用于配置一些全局参数。如需更改，请在初始化引擎之前设置。
*/
//class Config
var Config=(function(){
	function Config(){}
	__class(Config,'Config');
	Config.WebGLTextCacheCount=500;
	Config.atlasEnable=false;
	Config.showCanvasMark=false;
	Config.animationInterval=50;
	Config.isAntialias=false;
	Config.isAlpha=false;
	Config.premultipliedAlpha=true;
	Config.isStencil=true;
	Config.preserveDrawingBuffer=false;
	return Config;
})()


/**
*@private
*@author ...
*/
//class laya.ani.AnimationContent
var AnimationContent=(function(){
	function AnimationContent(){
		this.nodes=null;
		this.name=null;
		this.playTime=NaN;
		this.bone3DMap=null;
		this.totalKeyframeDatasLength=0;
	}

	__class(AnimationContent,'laya.ani.AnimationContent');
	return AnimationContent;
})()


/**
*@private
*@author ...
*/
//class laya.ani.AnimationNodeContent
var AnimationNodeContent=(function(){
	function AnimationNodeContent(){
		this.name=null;
		this.parentIndex=0;
		this.parent=null;
		this.keyframeWidth=0;
		this.lerpType=0;
		this.interpolationMethod=null;
		this.childs=null;
		this.keyFrame=null;
		//=new Vector.<KeyFramesContent>;
		this.playTime=NaN;
		this.extenData=null;
		this.dataOffset=0;
	}

	__class(AnimationNodeContent,'laya.ani.AnimationNodeContent');
	return AnimationNodeContent;
})()


/**
*@private
*/
//class laya.ani.AnimationParser01
var AnimationParser01=(function(){
	function AnimationParser01(){}
	__class(AnimationParser01,'laya.ani.AnimationParser01');
	AnimationParser01.parse=function(templet,reader){
		var data=reader.__getBuffer();
		var i=0,j=0,k=0,n=0,l=0,m=0,o=0;
		var aniClassName=reader.readUTFString();
		templet._aniClassName=aniClassName;
		var strList=reader.readUTFString().split("\n");
		var aniCount=reader.getUint8();
		var publicDataPos=reader.getUint32();
		var publicExtDataPos=reader.getUint32();
		var publicData;
		if (publicDataPos > 0)
			publicData=data.slice(publicDataPos,publicExtDataPos);
		var publicRead=new Byte(publicData);
		if (publicExtDataPos > 0)
			templet._publicExtData=data.slice(publicExtDataPos,data.byteLength);
		templet._useParent=!!reader.getUint8();
		templet._anis.length=aniCount;
		for (i=0;i < aniCount;i++){
			var ani=templet._anis[i]=new AnimationContent();
			{};
			ani.nodes=new Array;
			var name=ani.name=strList[reader.getUint16()];
			templet._aniMap[name]=i;
			ani.bone3DMap={};
			ani.playTime=reader.getFloat32();
			var boneCount=ani.nodes.length=reader.getUint8();
			ani.totalKeyframeDatasLength=0;
			for (j=0;j < boneCount;j++){
				var node=ani.nodes[j]=new AnimationNodeContent();
				{};
				node.childs=[];
				var nameIndex=reader.getInt16();
				if (nameIndex >=0){
					node.name=strList[nameIndex];
					ani.bone3DMap[node.name]=j;
				}
				node.keyFrame=new Array;
				node.parentIndex=reader.getInt16();
				node.parentIndex==-1 ? node.parent=null :node.parent=ani.nodes[node.parentIndex]
				node.lerpType=reader.getUint8();
				var keyframeParamsOffset=reader.getUint32();
				publicRead.pos=keyframeParamsOffset;
				var keyframeDataCount=node.keyframeWidth=publicRead.getUint16();
				ani.totalKeyframeDatasLength+=keyframeDataCount;
				if (node.lerpType===0 || node.lerpType===1){
					node.interpolationMethod=[];
					node.interpolationMethod.length=keyframeDataCount;
					for (k=0;k < keyframeDataCount;k++)
					node.interpolationMethod[k]=AnimationTemplet.interpolation[publicRead.getUint8()];
				}
				if (node.parent !=null)
					node.parent.childs.push(node);
				var privateDataLen=reader.getUint16();
				if (privateDataLen > 0){
					node.extenData=data.slice(reader.pos,reader.pos+privateDataLen);
					reader.pos+=privateDataLen;
				};
				var keyframeCount=reader.getUint16();
				node.keyFrame.length=keyframeCount;
				var startTime=0;
				var keyFrame;
				for (k=0,n=keyframeCount;k < n;k++){
					keyFrame=node.keyFrame[k]=new KeyFramesContent();
					{};
					keyFrame.duration=reader.getFloat32();
					keyFrame.startTime=startTime;
					if (node.lerpType===2){
						keyFrame.interpolationData=[];
						var interDataLength=reader.getUint8();
						var lerpType=0;
						lerpType=reader.getFloat32();
						switch (lerpType){
							case 254:
								keyFrame.interpolationData.length=keyframeDataCount;
								for (o=0;o < keyframeDataCount;o++)
								keyFrame.interpolationData[o]=0;
								break ;
							case 255:
								keyFrame.interpolationData.length=keyframeDataCount;
								for (o=0;o < keyframeDataCount;o++)
								keyFrame.interpolationData[o]=5;
								break ;
							default :
								keyFrame.interpolationData.push(lerpType);
								for (m=1;m < interDataLength;m++){
									keyFrame.interpolationData.push(reader.getFloat32());
								}
							}
					}
					keyFrame.data=new Float32Array(keyframeDataCount);
					for (l=0;l < keyframeDataCount;l++){
						keyFrame.data[l]=reader.getFloat32();
						if (keyFrame.data[l] >-0.00000001 && keyFrame.data[l] < 0.00000001)keyFrame.data[l]=0;
					}
					startTime+=keyFrame.duration;
				}
				keyFrame.startTime=ani.playTime;
				node.playTime=ani.playTime;
				templet._calculateKeyFrame(node,keyframeCount,keyframeDataCount);
			}
		}
	}

	return AnimationParser01;
})()


/**
*@private
*/
//class laya.ani.AnimationParser02
var AnimationParser02=(function(){
	function AnimationParser02(){}
	__class(AnimationParser02,'laya.ani.AnimationParser02');
	AnimationParser02.READ_DATA=function(){
		AnimationParser02._DATA.offset=AnimationParser02._reader.getUint32();
		AnimationParser02._DATA.size=AnimationParser02._reader.getUint32();
	}

	AnimationParser02.READ_BLOCK=function(){
		var count=AnimationParser02._BLOCK.count=AnimationParser02._reader.getUint16();
		var blockStarts=AnimationParser02._BLOCK.blockStarts=[];
		var blockLengths=AnimationParser02._BLOCK.blockLengths=[];
		for (var i=0;i < count;i++){
			blockStarts.push(AnimationParser02._reader.getUint32());
			blockLengths.push(AnimationParser02._reader.getUint32());
		}
	}

	AnimationParser02.READ_STRINGS=function(){
		var offset=AnimationParser02._reader.getUint32();
		var count=AnimationParser02._reader.getUint16();
		var prePos=AnimationParser02._reader.pos;
		AnimationParser02._reader.pos=offset+AnimationParser02._DATA.offset;
		for (var i=0;i < count;i++)
		AnimationParser02._strings[i]=AnimationParser02._reader.readUTFString();
		AnimationParser02._reader.pos=prePos;
	}

	AnimationParser02.parse=function(templet,reader){
		AnimationParser02._templet=templet;
		AnimationParser02._reader=reader;
		var arrayBuffer=reader.__getBuffer();
		AnimationParser02.READ_DATA();
		AnimationParser02.READ_BLOCK();
		AnimationParser02.READ_STRINGS();
		for (var i=0,n=AnimationParser02._BLOCK.count;i < n;i++){
			var index=reader.getUint16();
			var blockName=AnimationParser02._strings[index];
			var fn=AnimationParser02["READ_"+blockName];
			if (fn==null)
				throw new Error("model file err,no this function:"+index+" "+blockName);
			else
			fn.call();
		}
	}

	AnimationParser02.READ_ANIMATIONS=function(){
		var reader=AnimationParser02._reader;
		var arrayBuffer=reader.__getBuffer();
		var i=0,j=0,k=0,n=0,l=0;
		var keyframeWidth=reader.getUint16();
		var interpolationMethod=[];
		interpolationMethod.length=keyframeWidth;
		for (i=0;i < keyframeWidth;i++)
		interpolationMethod[i]=AnimationTemplet.interpolation[reader.getByte()];
		var aniCount=reader.getUint8();
		AnimationParser02._templet._anis.length=aniCount;
		for (i=0;i < aniCount;i++){
			var ani=AnimationParser02._templet._anis[i]=
			{};
			ani.nodes=new Array;
			var aniName=ani.name=AnimationParser02._strings[reader.getUint16()];
			AnimationParser02._templet._aniMap[aniName]=i;
			ani.bone3DMap={};
			ani.playTime=reader.getFloat32();
			var boneCount=ani.nodes.length=reader.getInt16();
			ani.totalKeyframeDatasLength=0;
			for (j=0;j < boneCount;j++){
				var node=ani.nodes[j]=
				{};
				node.keyframeWidth=keyframeWidth;
				node.childs=[];
				var nameIndex=reader.getUint16();
				if (nameIndex >=0){
					node.name=AnimationParser02._strings[nameIndex];
					ani.bone3DMap[node.name]=j;
				}
				node.keyFrame=new Array;
				node.parentIndex=reader.getInt16();
				node.parentIndex==-1 ? node.parent=null :node.parent=ani.nodes[node.parentIndex]
				ani.totalKeyframeDatasLength+=keyframeWidth;
				node.interpolationMethod=interpolationMethod;
				if (node.parent !=null)
					node.parent.childs.push(node);
				var keyframeCount=reader.getUint16();
				node.keyFrame.length=keyframeCount;
				var keyFrame=null,lastKeyFrame=null;
				for (k=0,n=keyframeCount;k < n;k++){
					keyFrame=node.keyFrame[k]=
					{};
					keyFrame.startTime=reader.getFloat32();
					(lastKeyFrame)&& (lastKeyFrame.duration=keyFrame.startTime-lastKeyFrame.startTime);
					var offset=AnimationParser02._DATA.offset;
					var keyframeDataOffset=reader.getUint32();
					var keyframeDataLength=keyframeWidth *4;
					var keyframeArrayBuffer=arrayBuffer.slice(offset+keyframeDataOffset,offset+keyframeDataOffset+keyframeDataLength);
					keyFrame.data=new Float32Array(keyframeArrayBuffer);
					lastKeyFrame=keyFrame;
				}
				keyFrame.duration=0;
				node.playTime=ani.playTime;
				AnimationParser02._templet._calculateKeyFrame(node,keyframeCount,keyframeWidth);
			}
		}
	}

	AnimationParser02._templet=null;
	AnimationParser02._reader=null;
	AnimationParser02._strings=[];
	__static(AnimationParser02,
	['_BLOCK',function(){return this._BLOCK={count:0};},'_DATA',function(){return this._DATA={offset:0,size:0};}
	]);
	return AnimationParser02;
})()


/**
*@private
*/
//class laya.ani.AnimationState
var AnimationState=(function(){
	function AnimationState(){}
	__class(AnimationState,'laya.ani.AnimationState');
	AnimationState.stopped=0;
	AnimationState.paused=1;
	AnimationState.playing=2;
	return AnimationState;
})()


/**
*@private
*/
//class laya.ani.bone.Bone
var Bone=(function(){
	function Bone(){
		this.name=null;
		this.root=null;
		this.parentBone=null;
		this.length=10;
		this.transform=null;
		this.inheritScale=true;
		this.inheritRotation=true;
		this.rotation=NaN;
		this.resultRotation=NaN;
		this.d=-1;
		this._tempMatrix=null;
		this._sprite=null;
		this.resultTransform=new Transform();
		this.resultMatrix=new Matrix();
		this._children=[];
	}

	__class(Bone,'laya.ani.bone.Bone');
	var __proto=Bone.prototype;
	__proto.setTempMatrix=function(matrix){
		this._tempMatrix=matrix;
		var i=0,n=0;
		var tBone;
		for (i=0,n=this._children.length;i < n;i++){
			tBone=this._children[i];
			tBone.setTempMatrix(this._tempMatrix);
		}
	}

	__proto.update=function(pMatrix){
		this.rotation=this.transform.skX;
		var tResultMatrix;
		if (pMatrix){
			tResultMatrix=this.resultTransform.getMatrix();
			Matrix.mul(tResultMatrix,pMatrix,this.resultMatrix);
			this.resultRotation=this.rotation;
		}
		else {
			this.resultRotation=this.rotation+this.parentBone.resultRotation;
			if (this.parentBone){
				if (this.inheritRotation && this.inheritScale){
					tResultMatrix=this.resultTransform.getMatrix();
					Matrix.mul(tResultMatrix,this.parentBone.resultMatrix,this.resultMatrix);
				}
				else {
					var temp=0;
					var parent=this.parentBone;
					var tAngle=NaN;
					var cos=NaN;
					var sin=NaN;
					var tParentMatrix=this.parentBone.resultMatrix;
					tResultMatrix=this.resultTransform.getMatrix();
					var worldX=tParentMatrix.a *tResultMatrix.tx+tParentMatrix.c *tResultMatrix.ty+tParentMatrix.tx;
					var worldY=tParentMatrix.b *tResultMatrix.tx+tParentMatrix.d *tResultMatrix.ty+tParentMatrix.ty;
					var tTestMatrix=new Matrix();
					if (this.inheritRotation){
						tAngle=Math.atan2(parent.resultMatrix.b,parent.resultMatrix.a);
						cos=Math.cos(tAngle),sin=Math.sin(tAngle);
						tTestMatrix.setTo(cos,sin,-sin,cos,0,0);
						Matrix.mul(this._tempMatrix,tTestMatrix,Matrix.TEMP);
						Matrix.TEMP.copyTo(tTestMatrix);
						tResultMatrix=this.resultTransform.getMatrix();
						Matrix.mul(tResultMatrix,tTestMatrix,this.resultMatrix);
						if (this.resultTransform.scX *this.resultTransform.scY < 0){
							this.resultMatrix.rotate(Math.PI*0.5);
						}
						this.resultMatrix.tx=worldX;
						this.resultMatrix.ty=worldY;
					}
					else if (this.inheritScale){
						tResultMatrix=this.resultTransform.getMatrix();
						Matrix.TEMP.identity();
						Matrix.TEMP.d=this.d;
						Matrix.mul(tResultMatrix,Matrix.TEMP,this.resultMatrix);
						this.resultMatrix.tx=worldX;
						this.resultMatrix.ty=worldY;
					}
					else {
						tResultMatrix=this.resultTransform.getMatrix();
						Matrix.TEMP.identity();
						Matrix.TEMP.d=this.d;
						Matrix.mul(tResultMatrix,Matrix.TEMP,this.resultMatrix);
						this.resultMatrix.tx=worldX;
						this.resultMatrix.ty=worldY;
					}
				}
			}
			else {
				tResultMatrix=this.resultTransform.getMatrix();
				tResultMatrix.copyTo(this.resultMatrix);
			}
		};
		var i=0,n=0;
		var tBone;
		for (i=0,n=this._children.length;i < n;i++){
			tBone=this._children[i];
			tBone.update();
		}
	}

	__proto.updateChild=function(){
		var i=0,n=0;
		var tBone;
		for (i=0,n=this._children.length;i < n;i++){
			tBone=this._children[i];
			tBone.update();
		}
	}

	__proto.setRotation=function(rd){
		if (this._sprite){
			this._sprite.rotation=rd *180 / Math.PI;
		}
	}

	__proto.updateDraw=function(x,y){
		if (!Bone.ShowBones || Bone.ShowBones[this.name]){
			if (this._sprite){
				this._sprite.x=x+this.resultMatrix.tx;
				this._sprite.y=y+this.resultMatrix.ty;
			}
			else {
				this._sprite=new Sprite();
				this._sprite.graphics.drawCircle(0,0,5,"#ff0000");
				this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00");
				this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center");
				Laya.stage.addChild(this._sprite);
				this._sprite.x=x+this.resultMatrix.tx;
				this._sprite.y=y+this.resultMatrix.ty;
			}
		};
		var i=0,n=0;
		var tBone;
		for (i=0,n=this._children.length;i < n;i++){
			tBone=this._children[i];
			tBone.updateDraw(x,y);
		}
	}

	__proto.addChild=function(bone){
		this._children.push(bone);
		bone.parentBone=this;
	}

	__proto.findBone=function(boneName){
		if (this.name==boneName){
			return this;
		}
		else {
			var i=0,n=0;
			var tBone;
			var tResult;
			for (i=0,n=this._children.length;i < n;i++){
				tBone=this._children[i];
				tResult=tBone.findBone(boneName);
				if (tResult){
					return tResult;
				}
			}
		}
		return null;
	}

	__proto.localToWorld=function(local){
		var localX=local[0];
		var localY=local[1];
		local[0]=localX *this.resultMatrix.a+localY *this.resultMatrix.c+this.resultMatrix.tx;
		local[1]=localX *this.resultMatrix.b+localY *this.resultMatrix.d+this.resultMatrix.ty;
	}

	Bone.ShowBones={};
	return Bone;
})()


/**
*@private
*/
//class laya.ani.bone.BoneSlot
var BoneSlot=(function(){
	function BoneSlot(){
		/**插槽名称 */
		this.name=null;
		/**插槽绑定的骨骼名称 */
		this.parent=null;
		/**插糟显示数据数据的名称 */
		this.attachmentName=null;
		/**原始数据的索引 */
		this.srcDisplayIndex=-1;
		/**判断对象是否是原对象 */
		this.type="src";
		/**模板的指针 */
		this.templet=null;
		/**当前插槽对应的数据 */
		this.currSlotData=null;
		/**当前插槽显示的纹理 */
		this.currTexture=null;
		/**显示对象对应的数据 */
		this.currDisplayData=null;
		/**显示皮肤的索引 */
		this.displayIndex=-1;
		/**用户自定义的皮肤 */
		this._diyTexture=null;
		this._parentMatrix=null;
		this._resultMatrix=null;
		/**索引替换表 */
		this._replaceDic={};
		/**当前diyTexture的动画纹理 */
		this._curDiyUV=null;
		this._curDiyVS=null;
		/**实时模式下，复用使用 */
		this._skinSprite=null;
		/**@private 变形动画数据 */
		this.deformData=null;
		this._mVerticleArr=null;
	}

	__class(BoneSlot,'laya.ani.bone.BoneSlot');
	var __proto=BoneSlot.prototype;
	/**
	*设置要显示的插槽数据
	*@param slotData
	*@param disIndex
	*@param freshIndex 是否重置纹理
	*/
	__proto.showSlotData=function(slotData,freshIndex){
		(freshIndex===void 0)&& (freshIndex=true);
		this.currSlotData=slotData;
		if(freshIndex)
			this.displayIndex=this.srcDisplayIndex;
		this.currDisplayData=null;
		this.currTexture=null;
	}

	/**
	*通过名字显示指定对象
	*@param name
	*/
	__proto.showDisplayByName=function(name){
		if (this.currSlotData){
			this.showDisplayByIndex(this.currSlotData.getDisplayByName(name));
		}
	}

	/**
	*替换贴图名
	*@param tarName 要替换的贴图名
	*@param newName 替换后的贴图名
	*/
	__proto.replaceDisplayByName=function(tarName,newName){
		if (!this.currSlotData)return;
		var preIndex=0;
		preIndex=this.currSlotData.getDisplayByName(tarName);
		var newIndex=0;
		newIndex=this.currSlotData.getDisplayByName(newName);
		this.replaceDisplayByIndex(preIndex,newIndex);
	}

	/**
	*替换贴图索引
	*@param tarIndex 要替换的索引
	*@param newIndex 替换后的索引
	*/
	__proto.replaceDisplayByIndex=function(tarIndex,newIndex){
		if (!this.currSlotData)return;
		this._replaceDic[tarIndex]=newIndex;
		if (this.displayIndex==tarIndex){
			this.showDisplayByIndex(tarIndex);
		}
	}

	/**
	*指定显示对象
	*@param index
	*/
	__proto.showDisplayByIndex=function(index){
		if (this._replaceDic[index]!=null)index=this._replaceDic[index];
		if (this.currSlotData && index >-1 && index < this.currSlotData.displayArr.length){
			this.displayIndex=index;
			this.currDisplayData=this.currSlotData.displayArr[index];
			if (this.currDisplayData){
				var tName=this.currDisplayData.name;
				this.currTexture=this.templet.getTexture(tName);
				if (this.currTexture && !Render.isConchApp && this.currDisplayData.type==0 && this.currDisplayData.uvs){
					this.currTexture=this.currDisplayData.createTexture(this.currTexture);
				}
			}
			}else {
			this.displayIndex=-1;
			this.currDisplayData=null;
			this.currTexture=null;
		}
	}

	/**
	*替换皮肤
	*@param _texture
	*/
	__proto.replaceSkin=function(_texture){
		this._diyTexture=_texture;
		if (this._curDiyUV)this._curDiyUV.length=0;
		if (this.currDisplayData&&this._diyTexture==this.currDisplayData.texture){
			this._diyTexture=null;
		}
	}

	/**
	*保存父矩阵的索引
	*@param parentMatrix
	*/
	__proto.setParentMatrix=function(parentMatrix){
		this._parentMatrix=parentMatrix;
	}

	/**
	*把纹理画到Graphics上
	*@param graphics
	*@param noUseSave
	*/
	__proto.draw=function(graphics,boneMatrixArray,noUseSave,alpha){
		(noUseSave===void 0)&& (noUseSave=false);
		(alpha===void 0)&& (alpha=1);
		if ((this._diyTexture==null && this.currTexture==null)|| this.currDisplayData==null){
			if (!(this.currDisplayData && this.currDisplayData.type==3)){
				return;
			}
		};
		var tTexture=this.currTexture;
		if (this._diyTexture)tTexture=this._diyTexture;
		var tSkinSprite;
		switch (this.currDisplayData.type){
			case 0:
				if (graphics){
					var tCurrentMatrix=this.getDisplayMatrix();
					if (this._parentMatrix){
						var tRotateKey=false;
						if (tCurrentMatrix){
							Matrix.mul(tCurrentMatrix,this._parentMatrix,Matrix.TEMP);
							var tResultMatrix;
							if (noUseSave){
								if (this._resultMatrix==null)this._resultMatrix=new Matrix();
								tResultMatrix=this._resultMatrix;
								}else {
								tResultMatrix=new Matrix();
							}
							if ((!Render.isWebGL && this.currDisplayData.uvs)|| (Render.isWebGL && this._diyTexture && this.currDisplayData.uvs)){
								var tTestMatrix=BoneSlot._tempMatrix;
								tTestMatrix.identity();
								if (this.currDisplayData.uvs[1] > this.currDisplayData.uvs[5]){
									tTestMatrix.d=-1;
								}
								if (this.currDisplayData.uvs[0] > this.currDisplayData.uvs[4]
									&& this.currDisplayData.uvs[1] > this.currDisplayData.uvs[5]){
									tRotateKey=true;
									tTestMatrix.rotate(-Math.PI/2);
								}
								Matrix.mul(tTestMatrix,Matrix.TEMP,tResultMatrix);
								}else {
								Matrix.TEMP.copyTo(tResultMatrix);
							}
							if (tRotateKey){
								graphics.drawTexture(tTexture,-this.currDisplayData.height / 2,-this.currDisplayData.width / 2,this.currDisplayData.height,this.currDisplayData.width,tResultMatrix);
								}else {
								graphics.drawTexture(tTexture,-this.currDisplayData.width / 2,-this.currDisplayData.height / 2,this.currDisplayData.width,this.currDisplayData.height,tResultMatrix);
							}
						}
					}
				}
				break ;
			case 1:
				if (noUseSave){
					if (this._skinSprite==null){
						this._skinSprite=BoneSlot.createSkinMesh();
					}
					tSkinSprite=this._skinSprite;
					}else {
					tSkinSprite=BoneSlot.createSkinMesh();
				}
				if (tSkinSprite==null){
					return;
				};
				var tIBArray;
				var tRed=1;
				var tGreed=1;
				var tBlue=1;
				var tAlpha=1;
				if (this.currDisplayData.bones==null){
					var tVertices=this.currDisplayData.weights;
					if (this.deformData){
						tVertices=this.deformData;
					};
					var tUVs;
					if (this._diyTexture){
						if (!this._curDiyUV){
							this._curDiyUV=[];
						}
						if (this._curDiyUV.length==0){
							this._curDiyUV=UVTools.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV);
							this._curDiyUV=UVTools.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV);
						}
						tUVs=this._curDiyUV;
						}else{
						tUVs=this.currDisplayData.uvs;
					}
					this._mVerticleArr=tVertices;
					var tTriangleNum=this.currDisplayData.triangles.length / 3;
					tIBArray=this.currDisplayData.triangles;
					tSkinSprite.init2(tTexture,null ,tIBArray,this._mVerticleArr,tUVs);
					var tCurrentMatrix2=this.getDisplayMatrix();
					if (this._parentMatrix){
						if (tCurrentMatrix2){
							Matrix.mul(tCurrentMatrix2,this._parentMatrix,Matrix.TEMP);
							var tResultMatrix2;
							if (noUseSave){
								if (this._resultMatrix==null)this._resultMatrix=new Matrix();
								tResultMatrix2=this._resultMatrix;
								}else {
								tResultMatrix2=new Matrix();
							}
							Matrix.TEMP.copyTo(tResultMatrix2);
							tSkinSprite.transform=tResultMatrix2;
						}
					}
					}else {
					this.skinMesh(boneMatrixArray,tSkinSprite,alpha);
				}
				graphics.drawSkin(tSkinSprite);
				break ;
			case 2:
				if (noUseSave){
					if (this._skinSprite==null){
						this._skinSprite=BoneSlot.createSkinMesh();
					}
					tSkinSprite=this._skinSprite;
					}else {
					tSkinSprite=BoneSlot.createSkinMesh();
				}
				if (tSkinSprite==null){
					return;
				}
				this.skinMesh(boneMatrixArray,tSkinSprite,alpha);
				graphics.drawSkin(tSkinSprite);
				break ;
			case 3:
				break ;
			}
	}

	/**
	*显示蒙皮动画
	*@param boneMatrixArray 当前帧的骨骼矩阵
	*/
	__proto.skinMesh=function(boneMatrixArray,skinSprite,alpha){
		var tTexture=this.currTexture;
		var tBones=this.currDisplayData.bones;
		var tUvs;
		if (this._diyTexture){
			tTexture=this._diyTexture;
			if (!this._curDiyUV){
				this._curDiyUV=[];
			}
			if (this._curDiyUV.length==0){
				this._curDiyUV=UVTools.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV);
				this._curDiyUV=UVTools.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV);
			}
			tUvs=this._curDiyUV;
			}else{
			tUvs=this.currDisplayData.uvs;
		};
		var tWeights=this.currDisplayData.weights;
		var tTriangles=this.currDisplayData.triangles;
		var tIBArray;
		var tRx=0;
		var tRy=0;
		var nn=0;
		var tMatrix;
		var tX=NaN;
		var tY=NaN;
		var tB=0;
		var tWeight=0;
		var tVertices=[];
		var i=0,j=0,n=0;
		var tRed=1;
		var tGreed=1;
		var tBlue=1;
		var tAlpha=alpha;
		if (this.deformData && this.deformData.length > 0){
			var f=0;
			for (i=0,n=tBones.length;i < n;){
				nn=tBones[i++]+i;
				tRx=0,tRy=0;
				for (;i < nn;i++){
					tMatrix=boneMatrixArray[tBones[i]]
					tX=tWeights[tB]+this.deformData[f++];
					tY=tWeights[tB+1]+this.deformData[f++];
					tWeight=tWeights[tB+2];
					tRx+=(tX *tMatrix.a+tY *tMatrix.c+tMatrix.tx)*tWeight;
					tRy+=(tX *tMatrix.b+tY *tMatrix.d+tMatrix.ty)*tWeight;
					tB+=3;
				}
				tVertices.push(tRx,tRy);
			}
			}else {
			for (i=0,n=tBones.length;i < n;){
				nn=tBones[i++]+i;
				tRx=0,tRy=0;
				for (;i < nn;i++){
					tMatrix=boneMatrixArray[tBones[i]]
					tX=tWeights[tB];
					tY=tWeights[tB+1];
					tWeight=tWeights[tB+2];
					tRx+=(tX *tMatrix.a+tY *tMatrix.c+tMatrix.tx)*tWeight;
					tRy+=(tX *tMatrix.b+tY *tMatrix.d+tMatrix.ty)*tWeight;
					tB+=3;
				}
				tVertices.push(tRx,tRy);
			}
		}
		this._mVerticleArr=tVertices;
		tIBArray=tTriangles;
		skinSprite.init2(tTexture,null,tIBArray,this._mVerticleArr,tUvs);
	}

	/**
	*画骨骼的起始点，方便调试
	*@param graphics
	*/
	__proto.drawBonePoint=function(graphics){
		if (graphics && this._parentMatrix){
			graphics.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000");
		}
	}

	/**
	*得到显示对象的矩阵
	*@return
	*/
	__proto.getDisplayMatrix=function(){
		if (this.currDisplayData){
			return this.currDisplayData.transform.getMatrix();
		}
		return null;
	}

	/**
	*得到插糟的矩阵
	*@return
	*/
	__proto.getMatrix=function(){
		return this._resultMatrix;
	}

	/**
	*用原始数据拷贝出一个
	*@return
	*/
	__proto.copy=function(){
		var tBoneSlot=new BoneSlot();
		tBoneSlot.type="copy";
		tBoneSlot.name=this.name;
		tBoneSlot.attachmentName=this.attachmentName;
		tBoneSlot.srcDisplayIndex=this.srcDisplayIndex;
		tBoneSlot.parent=this.parent;
		tBoneSlot.displayIndex=this.displayIndex;
		tBoneSlot.templet=this.templet;
		tBoneSlot.currSlotData=this.currSlotData;
		tBoneSlot.currTexture=this.currTexture;
		tBoneSlot.currDisplayData=this.currDisplayData;
		return tBoneSlot;
	}

	BoneSlot.createSkinMesh=function(){
		if (Render.isWebGL || Render.isConchApp){
			return RunDriver.skinAniSprite();
			}else{
			if (!Render.isWebGL){
				if (Skeleton.useSimpleMeshInCanvas){
					return new SimpleSkinMeshCanvas();
					}else{
					return new SkinMeshCanvas();
				}
			}
		}
		return null;
	}

	__static(BoneSlot,
	['_tempMatrix',function(){return this._tempMatrix=new Matrix();}
	]);
	return BoneSlot;
})()


/**
*@private
*canvas mesh渲染器
*/
//class laya.ani.bone.canvasmesh.CanvasMeshRender
var CanvasMeshRender=(function(){
	function CanvasMeshRender(){
		/**
		*mesh数据
		*/
		this.mesh=null;
		/**
		*矩阵
		*/
		this.transform=null;
		/**
		*绘图环境
		*/
		this.context=null;
		/**
		*绘制mesh的模式 0:顶点索引模式 1：无顶点索引模式
		*/
		this.mode=0;
	}

	__class(CanvasMeshRender,'laya.ani.bone.canvasmesh.CanvasMeshRender');
	var __proto=CanvasMeshRender.prototype;
	/**
	*将mesh数据渲染到context上面
	*@param context
	*
	*/
	__proto.renderToContext=function(context){
		this.context=context.ctx||context;
		if (this.mesh){
			if (this.mode==0){
				this._renderWithIndexes(this.mesh);
				}else{
				this._renderNoIndexes(this.mesh);
			}
		}
	}

	/**
	*无顶点索引的模式
	*@param mesh
	*
	*/
	__proto._renderNoIndexes=function(mesh){
		var i=0,len=mesh.vertices.length / 2;
		var index=0;
		for (i=0;i < len-2;i++){
			index=i *2;
			this._renderDrawTriangle(mesh,index,(index+2),(index+4));
		}
	}

	/**
	*使用顶点索引模式绘制
	*@param mesh
	*
	*/
	__proto._renderWithIndexes=function(mesh){
		var indexes=mesh.indexes;
		var i=0,len=indexes.length;
		for (i=0;i < len;i+=3){
			var index0=indexes[i] *2;
			var index1=indexes[i+1] *2;
			var index2=indexes[i+2] *2;
			this._renderDrawTriangle(mesh,index0,index1,index2);
		}
	}

	/**
	*绘制三角形
	*@param mesh mesh
	*@param index0 顶点0
	*@param index1 顶点1
	*@param index2 顶点2
	*
	*/
	__proto._renderDrawTriangle=function(mesh,index0,index1,index2){
		var context=this.context;
		var uvs=mesh.uvs;
		var vertices=mesh.vertices;
		var texture=mesh.texture;
		var source=texture.bitmap;
		var textureSource=source.source;
		var textureWidth=texture.width;
		var textureHeight=texture.height;
		var sourceWidth=source.width;
		var sourceHeight=source.height;
		var u0=NaN;
		var u1=NaN;
		var u2=NaN;
		var v0=NaN;
		var v1=NaN;
		var v2=NaN;
		if (mesh.useUvTransform){
			var ut=mesh.uvTransform;
			u0=((uvs[index0] *ut.a)+(uvs[index0+1] *ut.c)+ut.tx)*sourceWidth;
			u1=((uvs[index1] *ut.a)+(uvs[index1+1] *ut.c)+ut.tx)*sourceWidth;
			u2=((uvs[index2] *ut.a)+(uvs[index2+1] *ut.c)+ut.tx)*sourceWidth;
			v0=((uvs[index0] *ut.b)+(uvs[index0+1] *ut.d)+ut.ty)*sourceHeight;
			v1=((uvs[index1] *ut.b)+(uvs[index1+1] *ut.d)+ut.ty)*sourceHeight;
			v2=((uvs[index2] *ut.b)+(uvs[index2+1] *ut.d)+ut.ty)*sourceHeight;
		}
		else {
			u0=uvs[index0] *sourceWidth;
			u1=uvs[index1] *sourceWidth;
			u2=uvs[index2] *sourceWidth;
			v0=uvs[index0+1] *sourceHeight;
			v1=uvs[index1+1] *sourceHeight;
			v2=uvs[index2+1] *sourceHeight;
		};
		var x0=vertices[index0];
		var x1=vertices[index1];
		var x2=vertices[index2];
		var y0=vertices[index0+1];
		var y1=vertices[index1+1];
		var y2=vertices[index2+1];
		if (mesh.canvasPadding > 0){
			var paddingX=mesh.canvasPadding;
			var paddingY=mesh.canvasPadding;
			var centerX=(x0+x1+x2)/ 3;
			var centerY=(y0+y1+y2)/ 3;
			var normX=x0-centerX;
			var normY=y0-centerY;
			var dist=Math.sqrt((normX *normX)+(normY *normY));
			x0=centerX+((normX / dist)*(dist+paddingX));
			y0=centerY+((normY / dist)*(dist+paddingY));
			normX=x1-centerX;
			normY=y1-centerY;
			dist=Math.sqrt((normX *normX)+(normY *normY));
			x1=centerX+((normX / dist)*(dist+paddingX));
			y1=centerY+((normY / dist)*(dist+paddingY));
			normX=x2-centerX;
			normY=y2-centerY;
			dist=Math.sqrt((normX *normX)+(normY *normY));
			x2=centerX+((normX / dist)*(dist+paddingX));
			y2=centerY+((normY / dist)*(dist+paddingY));
		}
		context.save();
		if (this.transform){
			var mt=this.transform;
			context.transform(mt.a,mt.b,mt.c,mt.d,mt.tx,mt.ty);
		}
		context.beginPath();
		context.moveTo(x0,y0);
		context.lineTo(x1,y1);
		context.lineTo(x2,y2);
		context.closePath();
		context.clip();
		var delta=(u0 *v1)+(v0 *u2)+(u1 *v2)-(v1 *u2)-(v0 *u1)-(u0 *v2);
		var dDelta=1 / delta;
		var deltaA=(x0 *v1)+(v0 *x2)+(x1 *v2)-(v1 *x2)-(v0 *x1)-(x0 *v2);
		var deltaB=(u0 *x1)+(x0 *u2)+(u1 *x2)-(x1 *u2)-(x0 *u1)-(u0 *x2);
		var deltaC=(u0 *v1 *x2)+(v0 *x1 *u2)+(x0 *u1 *v2)-(x0 *v1 *u2)-(v0 *u1 *x2)-(u0 *x1 *v2);
		var deltaD=(y0 *v1)+(v0 *y2)+(y1 *v2)-(v1 *y2)-(v0 *y1)-(y0 *v2);
		var deltaE=(u0 *y1)+(y0 *u2)+(u1 *y2)-(y1 *u2)-(y0 *u1)-(u0 *y2);
		var deltaF=(u0 *v1 *y2)+(v0 *y1 *u2)+(y0 *u1 *v2)-(y0 *v1 *u2)-(v0 *u1 *y2)-(u0 *y1 *v2);
		context.transform(deltaA *dDelta,deltaD *dDelta,deltaB *dDelta,deltaE*dDelta,deltaC *dDelta,deltaF *dDelta);
		context.drawImage(textureSource,texture.uv[0]*sourceWidth,texture.uv[1]*sourceHeight,textureWidth,textureHeight,texture.uv[0]*sourceWidth,texture.uv[1]*sourceHeight,textureWidth,textureHeight);
		context.restore();
	}

	return CanvasMeshRender;
})()


/**
*@private
*/
//class laya.ani.bone.canvasmesh.MeshData
var MeshData=(function(){
	function MeshData(){
		/**
		*纹理
		*/
		this.texture=null;
		/**
		*uv数据
		*/
		this.uvs=[0,0,1,0,1,1,0,1];
		/**
		*顶点数据
		*/
		this.vertices=[0,0,100,0,100,100,0,100];
		/**
		*顶点索引
		*/
		this.indexes=[0,1,3,3,1,2];
		/**
		*uv变换矩阵
		*/
		this.uvTransform=null;
		/**
		*是否有uv变化矩阵
		*/
		this.useUvTransform=false;
		/**
		*扩展像素,用来去除黑边
		*/
		this.canvasPadding=1;
	}

	__class(MeshData,'laya.ani.bone.canvasmesh.MeshData');
	var __proto=MeshData.prototype;
	/**
	*计算mesh的Bounds
	*@return
	*
	*/
	__proto.getBounds=function(){
		return Rectangle._getWrapRec(this.vertices);
	}

	return MeshData;
})()


/**
*@private
*/
//class laya.ani.bone.DeformAniData
var DeformAniData=(function(){
	function DeformAniData(){
		this.skinName=null;
		this.deformSlotDataList=[];
	}

	__class(DeformAniData,'laya.ani.bone.DeformAniData');
	return DeformAniData;
})()


/**
*@private
*/
//class laya.ani.bone.DeformSlotData
var DeformSlotData=(function(){
	function DeformSlotData(){
		this.deformSlotDisplayList=[];
	}

	__class(DeformSlotData,'laya.ani.bone.DeformSlotData');
	return DeformSlotData;
})()


/**
*@private
*/
//class laya.ani.bone.DeformSlotDisplayData
var DeformSlotDisplayData=(function(){
	function DeformSlotDisplayData(){
		this.boneSlot=null;
		this.slotIndex=-1;
		this.attachment=null;
		this.deformData=null;
		this.frameIndex=0;
		this.timeList=[];
		this.vectices=[];
		this.tweenKeyList=[];
	}

	__class(DeformSlotDisplayData,'laya.ani.bone.DeformSlotDisplayData');
	var __proto=DeformSlotDisplayData.prototype;
	__proto.binarySearch1=function(values,target){
		var low=0;
		var high=values.length-2;
		if (high==0)
			return 1;
		var current=high >>> 1;
		while (true){
			if (values[Math.floor(current+1)] <=target)
				low=current+1;
			else
			high=current;
			if (low==high)
				return low+1;
			current=(low+high)>>> 1;
		}
		return 0;
	}

	// Can't happen.
	__proto.apply=function(time,boneSlot,alpha){
		(alpha===void 0)&& (alpha=1);
		time+=0.05;
		if (this.timeList.length <=0){
			return;
		};
		var i=0;
		var n=0;
		var tTime=this.timeList[0];
		if (time < tTime){
			return;
		};
		var tVertexCount=this.vectices[0].length;
		var tVertices=[];
		var tFrameIndex=this.binarySearch1(this.timeList,time);
		this.frameIndex=tFrameIndex;
		if (time >=this.timeList[this.timeList.length-1]){
			var lastVertices=this.vectices[this.vectices.length-1];
			if (alpha < 1){
				for (i=0;i < tVertexCount;i++){
					tVertices[i]+=(lastVertices[i]-tVertices[i])*alpha;
				}
				}else {
				for (i=0;i < tVertexCount;i++){
					tVertices[i]=lastVertices[i];
				}
			}
			this.deformData=tVertices;
			return;
		};
		var tTweenKey=this.tweenKeyList[this.frameIndex];
		var tPrevVertices=this.vectices[this.frameIndex-1];
		var tNextVertices=this.vectices[this.frameIndex];
		var tPreFrameTime=this.timeList[this.frameIndex-1];
		var tFrameTime=this.timeList[this.frameIndex];
		if (this.tweenKeyList[tFrameIndex-1]){
			alpha=(time-tPreFrameTime)/ (tFrameTime-tPreFrameTime);
			}else {
			alpha=0;
		};
		var tPrev=NaN;
		for (i=0;i < tVertexCount;i++){
			tPrev=tPrevVertices[i];
			tVertices[i]=tPrev+(tNextVertices[i]-tPrev)*alpha;
		}
		this.deformData=tVertices;
	}

	return DeformSlotDisplayData;
})()


/**
*@private
*/
//class laya.ani.bone.DrawOrderData
var DrawOrderData=(function(){
	function DrawOrderData(){
		this.time=NaN;
		this.drawOrder=[];
	}

	__class(DrawOrderData,'laya.ani.bone.DrawOrderData');
	return DrawOrderData;
})()


/**
*@private
*/
//class laya.ani.bone.EventData
var EventData=(function(){
	function EventData(){
		this.name=null;
		this.intValue=0;
		this.floatValue=NaN;
		this.stringValue=null;
		this.time=NaN;
	}

	__class(EventData,'laya.ani.bone.EventData');
	return EventData;
})()


/**
*@private
*/
//class laya.ani.bone.IkConstraint
var IkConstraint=(function(){
	function IkConstraint(data,bones){
		this._targetBone=null;
		this._bones=null;
		this._data=null;
		this.name=null;
		this.mix=NaN;
		this.bendDirection=NaN;
		this.isSpine=true;
		//debug相关代码
		this._sp=null;
		this.isDebug=false;
		this._data=data;
		this._targetBone=bones[data.targetBoneIndex];
		this.isSpine=data.isSpine;
		if (this._bones==null)this._bones=[];
		this._bones.length=0;
		for (var i=0,n=data.boneIndexs.length;i < n;i++){
			this._bones.push(bones[data.boneIndexs[i]]);
		}
		this.name=data.name;
		this.mix=data.mix;
		this.bendDirection=data.bendDirection;
	}

	__class(IkConstraint,'laya.ani.bone.IkConstraint');
	var __proto=IkConstraint.prototype;
	__proto.apply=function(){
		switch (this._bones.length){
			case 1:
				this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);
				break ;
			case 2:
				if (this.isSpine){
					this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix);
					}else{
					this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix);
				}
				break ;
			}
	}

	__proto._applyIk1=function(bone,targetX,targetY,alpha){
		var pp=bone.parentBone;
		var id=1 / (pp.resultMatrix.a *pp.resultMatrix.d-pp.resultMatrix.b *pp.resultMatrix.c);
		var x=targetX-pp.resultMatrix.tx;
		var y=targetY-pp.resultMatrix.ty;
		var tx=(x *pp.resultMatrix.d-y *pp.resultMatrix.c)*id-bone.transform.x;
		var ty=(y *pp.resultMatrix.a-x *pp.resultMatrix.b)*id-bone.transform.y;
		var rotationIK=Math.atan2(ty,tx)*IkConstraint.radDeg-0-bone.transform.skX;
		if (bone.transform.scX < 0)rotationIK+=180;
		if (rotationIK > 180)
			rotationIK-=360;
		else if (rotationIK <-180)rotationIK+=360;
		bone.transform.skX=bone.transform.skY=bone.transform.skX+rotationIK *alpha;
		bone.update();
	}

	__proto.updatePos=function(x,y){
		if (this._sp){
			this._sp.pos(x,y);
		}
	}

	__proto._applyIk2=function(parent,child,targetX,targetY,bendDir,alpha){
		if (alpha==0){
			return;
		};
		var px=parent.resultTransform.x,py=parent.resultTransform.y;
		var psx=parent.transform.scX,psy=parent.transform.scY;
		var csx=child.transform.scX;
		var os1=0,os2=0,s2=0;
		if (psx < 0){
			psx=-psx;
			os1=180;
			s2=-1;
			}else {
			os1=0;
			s2=1;
		}
		if (psy < 0){
			psy=-psy;
			s2=-s2;
		}
		if (csx < 0){
			csx=-csx;
			os2=180;
			}else {
			os2=0
		};
		var cx=child.resultTransform.x,cy=NaN,cwx=NaN,cwy=NaN;
		var a=parent.resultMatrix.a,b=parent.resultMatrix.c;
		var c=parent.resultMatrix.b,d=parent.resultMatrix.d;
		var u=Math.abs(psx-psy)<=0.0001;
		if (!u){
			cy=0;
			cwx=a *cx+parent.resultMatrix.tx;
			cwy=c *cx+parent.resultMatrix.ty;
			}else {
			cy=child.resultTransform.y;
			cwx=a *cx+b *cy+parent.resultMatrix.tx;
			cwy=c *cx+d *cy+parent.resultMatrix.ty;
		}
		if (this.isDebug){
			if (!this._sp){
				this._sp=new Sprite();
				Laya.stage.addChild(this._sp);
			}
			this._sp.graphics.clear();
			this._sp.graphics.drawCircle(targetX,targetY,15,"#ffff00");
			this._sp.graphics.drawCircle(cwx,cwy,15,"#ff00ff");
		}
		parent.setRotation(Math.atan2(cwy-parent.resultMatrix.ty,cwx-parent.resultMatrix.tx));
		var pp=parent.parentBone;
		a=pp.resultMatrix.a;
		b=pp.resultMatrix.c;
		c=pp.resultMatrix.b;
		d=pp.resultMatrix.d;
		var id=1 / (a *d-b *c);
		var x=targetX-pp.resultMatrix.tx,y=targetY-pp.resultMatrix.ty;
		var tx=(x *d-y *b)*id-px;
		var ty=(y *a-x *c)*id-py;
		x=cwx-pp.resultMatrix.tx;
		y=cwy-pp.resultMatrix.ty;
		var dx=(x *d-y *b)*id-px;
		var dy=(y *a-x *c)*id-py;
		var l1=Math.sqrt(dx *dx+dy *dy);
		var l2=child.length *csx;
		var a1=NaN,a2=NaN;
		if (u){
			l2 *=psx;
			var cos=(tx *tx+ty *ty-l1 *l1-l2 *l2)/ (2 *l1 *l2);
			if (cos <-1)
				cos=-1;
			else if (cos > 1)cos=1;
			a2=Math.acos(cos)*bendDir;
			a=l1+l2 *cos;
			b=l2 *Math.sin(a2);
			a1=Math.atan2(ty *a-tx *b,tx *a+ty *b);
			}else {
			a=psx *l2;
			b=psy *l2;
			var aa=a *a,bb=b *b,dd=tx *tx+ty *ty,ta=Math.atan2(ty,tx);
			c=bb *l1 *l1+aa *dd-aa *bb;
			var c1=-2 *bb *l1,c2=bb-aa;
			d=c1 *c1-4 *c2 *c;
			if (d > 0){
				var q=Math.sqrt(d);
				if (c1 < 0)q=-q;
				q=-(c1+q)/ 2;
				var r0=q / c2,r1=c / q;
				var r=Math.abs(r0)< Math.abs(r1)? r0 :r1;
				if (r *r <=dd){
					y=Math.sqrt(dd-r *r)*bendDir;
					a1=ta-Math.atan2(y,r);
					a2=Math.atan2(y / psy,(r-l1)/ psx);
				}
			};
			var minAngle=0,minDist=Number.MAX_VALUE,minX=0,minY=0;
			var maxAngle=0,maxDist=0,maxX=0,maxY=0;
			x=l1+a;
			d=x *x;
			if (d > maxDist){
				maxAngle=0;
				maxDist=d;
				maxX=x;
			}
			x=l1-a;
			d=x *x;
			if (d < minDist){
				minAngle=Math.PI;
				minDist=d;
				minX=x;
			};
			var angle=Math.acos(-a *l1 / (aa-bb));
			x=a *Math.cos(angle)+l1;
			y=b *Math.sin(angle);
			d=x *x+y *y;
			if (d < minDist){
				minAngle=angle;
				minDist=d;
				minX=x;
				minY=y;
			}
			if (d > maxDist){
				maxAngle=angle;
				maxDist=d;
				maxX=x;
				maxY=y;
			}
			if (dd <=(minDist+maxDist)/ 2){
				a1=ta-Math.atan2(minY *bendDir,minX);
				a2=minAngle *bendDir;
				}else {
				a1=ta-Math.atan2(maxY *bendDir,maxX);
				a2=maxAngle *bendDir;
			}
		};
		var os=Math.atan2(cy,cx)*s2;
		var rotation=parent.resultTransform.skX;
		a1=(a1-os)*IkConstraint.radDeg+os1-rotation;
		if (a1 > 180)
			a1-=360;
		else if (a1 <-180)a1+=360;
		parent.resultTransform.x=px;
		parent.resultTransform.y=py;
		parent.resultTransform.skX=parent.resultTransform.skY=rotation+a1 *alpha;
		rotation=child.resultTransform.skX;
		rotation=rotation % 360;
		a2=((a2+os)*IkConstraint.radDeg-0)*s2+os2-rotation;
		if (a2 > 180)
			a2-=360;
		else if (a2 <-180)a2+=360;
		child.resultTransform.x=cx;
		child.resultTransform.y=cy;
		child.resultTransform.skX=child.resultTransform.skY=child.resultTransform.skY+a2 *alpha;
		parent.update();
	}

	__proto._applyIk3=function(parent,child,targetX,targetY,bendDir,alpha){
		if (alpha==0){
			return;
		};
		var cwx=NaN,cwy=NaN;
		var x=child.resultMatrix.a *child.length;
		var y=child.resultMatrix.b *child.length;
		var lLL=x *x+y *y;
		var lL=Math.sqrt(lLL);
		var parentX=parent.resultMatrix.tx;
		var parentY=parent.resultMatrix.ty;
		var childX=child.resultMatrix.tx;
		var childY=child.resultMatrix.ty;
		var dX=childX-parentX;
		var dY=childY-parentY;
		var lPP=dX *dX+dY *dY;
		var lP=Math.sqrt(lPP);
		dX=targetX-parent.resultMatrix.tx;
		dY=targetY-parent.resultMatrix.ty;
		var lTT=dX *dX+dY *dY;
		var lT=Math.sqrt(lTT);
		var ikRadianA=0;
		if (lL+lP <=lT || lT+lL <=lP || lT+lP <=lL){
			var rate=NaN;
			if (lL+lP <=lT){
				rate=1;
				}else{
				rate=-1;
			}
			childX=parentX+rate*(targetX-parentX)*lP / lT;
			childY=parentY+rate*(targetY-parentY)*lP / lT;
		}
		else{
			var h=(lPP-lLL+lTT)/ (2 *lTT);
			var r=Math.sqrt(lPP-h *h *lTT)/ lT;
			var hX=parentX+(dX *h);
			var hY=parentY+(dY *h);
			var rX=-dY *r;
			var rY=dX *r;
			if (bendDir>0){
				childX=hX-rX;
				childY=hY-rY;
			}
			else{
				childX=hX+rX;
				childY=hY+rY;
			}
		}
		cwx=childX;
		cwy=childY;
		if (this.isDebug){
			if (!this._sp){
				this._sp=new Sprite();
				Laya.stage.addChild(this._sp);
			}
			this._sp.graphics.clear();
			this._sp.graphics.drawCircle(parentX,parentY,15,"#ff00ff");
			this._sp.graphics.drawCircle(targetX,targetY,15,"#ffff00");
			this._sp.graphics.drawCircle(cwx,cwy,15,"#ff00ff");
		};
		var pRotation=NaN;
		pRotation=Math.atan2(cwy-parent.resultMatrix.ty,cwx-parent.resultMatrix.tx);
		parent.setRotation(pRotation);
		var pTarMatrix;
		pTarMatrix=IkConstraint._tempMatrix;
		pTarMatrix.identity();
		pTarMatrix.rotate(pRotation);
		pTarMatrix.scale(parent.resultMatrix.getScaleX(),parent.resultMatrix.getScaleY());
		pTarMatrix.translate(parent.resultMatrix.tx,parent.resultMatrix.ty);
		pTarMatrix.copyTo(parent.resultMatrix);
		parent.updateChild();
		var childRotation=NaN;
		childRotation=Math.atan2(targetY-cwy,targetX-cwx);
		child.setRotation(childRotation);
		var childTarMatrix;
		childTarMatrix=IkConstraint._tempMatrix;
		childTarMatrix.identity();
		childTarMatrix.rotate(childRotation);
		childTarMatrix.scale(child.resultMatrix.getScaleX(),child.resultMatrix.getScaleY());
		childTarMatrix.translate(cwx,cwy);
		pTarMatrix.copyTo(child.resultMatrix);
		child.updateChild();
	}

	__static(IkConstraint,
	['radDeg',function(){return this.radDeg=180 / Math.PI;},'degRad',function(){return this.degRad=Math.PI / 180;},'_tempMatrix',function(){return this._tempMatrix=new Matrix();}
	]);
	return IkConstraint;
})()


/**
*@private
*/
//class laya.ani.bone.IkConstraintData
var IkConstraintData=(function(){
	function IkConstraintData(){
		this.name=null;
		this.targetBoneName=null;
		this.bendDirection=1;
		this.mix=1;
		this.isSpine=true;
		this.targetBoneIndex=-1;
		this.boneNames=[];
		this.boneIndexs=[];
	}

	__class(IkConstraintData,'laya.ani.bone.IkConstraintData');
	return IkConstraintData;
})()


/**
*@private
*Mesh数据处理工具
*@version 1.0
*
*@created 2017-4-28 下午2:46:23
*/
//class laya.ani.bone.MeshTools
var MeshTools=(function(){
	function MeshTools(){}
	__class(MeshTools,'laya.ani.bone.MeshTools');
	MeshTools.findEdge=function(verticles,offI,min){
		(offI===void 0)&& (offI=0);
		(min===void 0)&& (min=true);
		var i=0,len=0;
		var tIndex=0;
		len=verticles.length;
		tIndex=-1;
		for (i=0;i < len;i+=2){
			if (tIndex < 0 || (min==(verticles[tIndex+offI] < verticles[i+offI]))){
				tIndex=i;
			}
		}
		return tIndex;
	}

	MeshTools.findBestTriangle=function(verticles){
		var topI=0;
		topI=MeshTools.findEdge(verticles,1,true);
		var bottomI=0;
		bottomI=MeshTools.findEdge(verticles,1,false);
		var leftI=0;
		leftI=MeshTools.findEdge(verticles,0,true);
		var rightI=0;
		rightI=MeshTools.findEdge(verticles,0,false);
		var rst;
		rst=MeshTools._bestTriangle;
		rst.length=0;
		rst.push(leftI,rightI);
		if (rst.indexOf(topI)< 0)rst.push(topI);
		if (rst.indexOf(bottomI)< 0)rst.push(bottomI);
		return rst;
	}

	MeshTools.solveMesh=function(mesh,rst){
		rst=rst||[];
		rst.length=0;
		var mUv;
		mUv=mesh.uvs;
		var mVer;
		mVer=mesh.vertices;
		var uvAbs;
		var indexs;
		indexs=MeshTools.findBestTriangle(mUv);
		var index0=0;
		var index1=0;
		var index2=0;
		index0=indexs[0];
		index1=indexs[1];
		index2=indexs[2];
		MeshTools._absArr.length=0;
		var newVerticles;
		if (MeshTools.isNormalUV(mesh.texture.uv)){
			MeshTools.adptTexture(mesh);
		}
		uvAbs=MeshTools.solvePoints(mesh.texture.uv,mUv[index0],mUv[index0+1],mUv[index1]-mUv[index0],mUv[index1+1]-mUv[index0+1],mUv[index2]-mUv[index0],mUv[index2+1]-mUv[index0+1],MeshTools._absArr);
		newVerticles=MeshTools.transPoints(uvAbs,mVer[index0],mVer[index0+1],mVer[index1]-mVer[index0],mVer[index1+1]-mVer[index0+1],mVer[index2]-mVer[index0],mVer[index2+1]-mVer[index0+1],rst);
		return newVerticles;
	}

	MeshTools.findWrapRect=function(verticles){
		var topI=0;
		topI=MeshTools.findEdge(verticles,1,true);
		var bottomI=0;
		bottomI=MeshTools.findEdge(verticles,1,false);
		var leftI=0;
		leftI=MeshTools.findEdge(verticles,0,true);
		var rightI=0;
		rightI=MeshTools.findEdge(verticles,0,false);
		var left=NaN;
		left=verticles[leftI];
		var right=NaN;
		right=verticles[rightI];
		var top=NaN;
		top=verticles[topI+1];
		var bottom=NaN;
		bottom=verticles[bottomI+1];
		var rst;
		return [right,bottom,left-right,top-bottom];
	}

	MeshTools.adptTexture=function(mesh){
		var rec;
		rec=MeshTools.findWrapRect(mesh.uvs);
		var oTex;
		var nTex;
		oTex=mesh.texture;
		var oWidth=oTex.width;
		var oHeight=oTex.height;
		nTex=Texture.create(oTex,rec[0] *oWidth,rec[1] *oHeight,rec[2] *oWidth,rec[3] *oHeight);
		mesh.texture=nTex;
	}

	MeshTools.isNormalUV=function(uv){
		return uv[0]==0 && uv[1]==0 && uv[4]==1 && uv[5]==1;
	}

	MeshTools.solvePoints=function(pointList,oX,oY,v1x,v1y,v2x,v2y,rst){
		rst=rst||[];
		var i=0,len=0;
		len=pointList.length;
		var tRst;
		for (i=0;i < len;i+=2){
			tRst=MeshTools.solve2(pointList[i],pointList[i+1],oX,oY,v1x,v1y,v2x,v2y);
			rst.push(tRst[0],tRst[1]);
		}
		return rst;
	}

	MeshTools.transPoints=function(abs,oX,oY,v1x,v1y,v2x,v2y,rst){
		rst=rst|| [];
		var i=0,len=0;
		len=abs.length;
		var tRst;
		for (i=0;i < len;i+=2){
			tRst=MeshTools.transPoint(abs[i],abs[i+1],oX,oY,v1x,v1y,v2x,v2y,rst);
		}
		return rst;
	}

	MeshTools.transPoint=function(a,b,oX,oY,v1x,v1y,v2x,v2y,rst){
		rst=rst|| [];
		var nX=NaN;
		var nY=NaN;
		nX=oX+v1x *a+v2x *b;
		nY=oY+v1y *a+v2y *b;
		rst.push(nX,nY)
		return rst;
	}

	MeshTools.solve2=function(rx,ry,oX,oY,v1x,v1y,v2x,v2y,rv,rst){
		(rv===void 0)&& (rv=false);
		rst=rst||[];
		var a=NaN,b=NaN;
		if (v1x==0){
			return MeshTools.solve2(rx,ry,oX,oY,v2x,v2y,v1x,v1y,true,rst);
		};
		var dX=NaN;
		var dY=NaN;
		dX=rx-oX;
		dY=ry-oY;
		b=(dY-dX *v1y / v1x)/ (v2y-v2x *v1y / v1x);
		a=(dX-b *v2x)/ v1x;
		if(rv){
			rst.push(b,a);
			}else{
			rst.push(a,b);
		}
		return rst;
	}

	MeshTools.solve=function(pointC,point0,v1,v2){
		return MeshTools.solve2(pointC.x,pointC.y,point0.x,point0.y,v1.x,v1.y,v2.x,v2.y);
	}

	MeshTools._bestTriangle=[];
	MeshTools._absArr=[];
	return MeshTools;
})()


/**
*@private
*路径作用器
*1，生成根据骨骼计算控制点
*2，根据控制点生成路径，并计算路径上的节点
*3，根据节点，重新调整骨骼位置
*/
//class laya.ani.bone.PathConstraint
var PathConstraint=(function(){
	function PathConstraint(data,bones){
		this.target=null;
		this.data=null;
		this.bones=null;
		this.position=NaN;
		this.spacing=NaN;
		this.rotateMix=NaN;
		this.translateMix=NaN;
		this._debugKey=false;
		this._spaces=null;
		this._segments=[];
		this._curves=[];
		this.data=data;
		this.position=data.position;
		this.spacing=data.spacing;
		this.rotateMix=data.rotateMix;
		this.translateMix=data.translateMix;
		this.bones=[];
		var tBoneIds=this.data.bones;
		for (var i=0,n=tBoneIds.length;i < n;i++){
			this.bones.push(bones[tBoneIds[i]]);
		}
	}

	__class(PathConstraint,'laya.ani.bone.PathConstraint');
	var __proto=PathConstraint.prototype;
	/**
	*计算骨骼在路径上的节点
	*@param boneSlot
	*@param boneMatrixArray
	*@param graphics
	*/
	__proto.apply=function(boneList,graphics){
		if (!this.target)
			return;
		var tTranslateMix=this.translateMix;
		var tRotateMix=this.translateMix;
		var tTranslate=tTranslateMix > 0;
		var tRotate=tRotateMix > 0;
		var tSpacingMode=this.data.spacingMode;
		var tLengthSpacing=tSpacingMode=="length";
		var tRotateMode=this.data.rotateMode;
		var tTangents=tRotateMode=="tangent";
		var tScale=tRotateMode=="chainScale";
		var lengths=[];
		var boneCount=this.bones.length;
		var spacesCount=tTangents ? boneCount :boneCount+1;
		var spaces=[];
		this._spaces=spaces;
		spaces[0]=this.position;
		var spacing=this.spacing;
		if (tScale || tLengthSpacing){
			for (var i=0,n=spacesCount-1;i < n;){
				var bone=this.bones[i];
				var length=bone.length;
				var x=length *bone.resultMatrix.a;
				var y=length *bone.resultMatrix.b;
				length=Math.sqrt(x *x+y *y);
				if (tScale)
					lengths[i]=length;
				spaces[++i]=tLengthSpacing ? Math.max(0,length+spacing):spacing;
			}
		}
		else {
			for (i=1;i < spacesCount;i++){
				spaces[i]=spacing;
			}
		};
		var positions=this.computeWorldPositions(this.target,boneList,graphics,spacesCount,tTangents,this.data.positionMode=="percent",tSpacingMode=="percent");
		if (this._debugKey){
			for (i=0;i < positions.length;i++){
				graphics.drawCircle(positions[i++],positions[i++],5,"#00ff00");
			};
			var tLinePos=[];
			for (i=0;i < positions.length;i++){
				tLinePos.push(positions[i++],positions[i++]);
			}
			graphics.drawLines(0,0,tLinePos,"#ff0000");
		};
		var skeletonX=NaN;
		var skeletonY=NaN;
		var boneX=positions[0];
		var boneY=positions[1];
		var offsetRotation=this.data.offsetRotation;
		var tip=tRotateMode=="chain" && offsetRotation==0;
		var p=NaN;
		for (i=0,p=3;i < boneCount;i++,p+=3){
			bone=this.bones[i];
			bone.resultMatrix.tx+=(boneX-bone.resultMatrix.tx)*tTranslateMix;
			bone.resultMatrix.ty+=(boneY-bone.resultMatrix.ty)*tTranslateMix;
			x=positions[p];
			y=positions[p+1];
			var dx=x-boneX,dy=y-boneY;
			if (tScale){
				length=lengths[i];
				if (length !=0){
					var s=(Math.sqrt(dx *dx+dy *dy)/ length-1)*tRotateMix+1;
					bone.resultMatrix.a *=s;
					bone.resultMatrix.c *=s;
				}
			}
			boneX=x;
			boneY=y;
			if (tRotate){
				var a=bone.resultMatrix.a;
				var b=bone.resultMatrix.c;
				var c=bone.resultMatrix.b;
				var d=bone.resultMatrix.d;
				var r=NaN;
				var cos=NaN;
				var sin=NaN;
				if (tTangents){
					r=positions[p-1];
				}
				else if (spaces[i+1]==0){
					r=positions[p+2];
				}
				else {
					r=Math.atan2(dy,dx);
				}
				r-=Math.atan2(c,a)-offsetRotation / 180 *Math.PI;
				if (tip){
					cos=Math.cos(r);
					sin=Math.sin(r);
					length=bone.length;
					boneX+=(length *(cos *a-sin *c)-dx)*tRotateMix;
					boneY+=(length *(sin *a+cos *c)-dy)*tRotateMix;
				}
				if (r > Math.PI){
					r-=(Math.PI *2);
				}
				else if (r <-Math.PI){
					r+=(Math.PI *2);
				}
				r *=tRotateMix;
				cos=Math.cos(r);
				sin=Math.sin(r);
				bone.resultMatrix.a=cos *a-sin *c;
				bone.resultMatrix.c=cos *b-sin *d;
				bone.resultMatrix.b=sin *a+cos *c;
				bone.resultMatrix.d=sin *b+cos *d;
			}
		}
	}

	/**
	*计算顶点的世界坐标
	*@param boneSlot
	*@param boneList
	*@param start
	*@param count
	*@param worldVertices
	*@param offset
	*/
	__proto.computeWorldVertices2=function(boneSlot,boneList,start,count,worldVertices,offset){
		var tBones=boneSlot.currDisplayData.bones;
		var tWeights=boneSlot.currDisplayData.weights;
		var tTriangles=boneSlot.currDisplayData.triangles;
		var tMatrix;
		var i=0;
		var v=0;
		var skip=0;
		var n=0;
		var w=0;
		var b=0;
		var wx=0;
		var wy=0;
		var vx=0;
		var vy=0;
		var bone;
		var len=0;
		if (tBones==null){
			if (!tTriangles)tTriangles=tWeights;
			if (boneSlot.deformData)
				tTriangles=boneSlot.deformData;
			var parentName;
			parentName=boneSlot.parent;
			if (boneList){
				len=boneList.length;
				for (i=0;i < len;i++){
					if (boneList[i].name==parentName){
						bone=boneList[i];
						break ;
					}
				}
			};
			var tBoneMt;
			if (bone){
				tBoneMt=bone.resultMatrix;
			}
			if (!tBoneMt)tBoneMt=PathConstraint._tempMt;
			var x=tBoneMt.tx;
			var y=tBoneMt.ty;
			var a=tBoneMt.a,bb=tBoneMt.b,c=tBoneMt.c,d=tBoneMt.d;
			if(bone)d*=bone.d;
			for (v=start,w=offset;w < count;v+=2,w+=2){
				vx=tTriangles[v],vy=tTriangles[v+1];
				worldVertices[w]=vx *a+vy *bb+x;
				worldVertices[w+1]=-(vx *c+vy *d+y);
			}
			return;
		}
		for (i=0;i < start;i+=2){
			n=tBones[v];
			v+=n+1;
			skip+=n;
		};
		var skeletonBones=boneList;
		for (w=offset,b=skip *3;w < count;w+=2){
			wx=0,wy=0;
			n=tBones[v++];
			n+=v;
			for (;v < n;v++,b+=3){
				tMatrix=skeletonBones[tBones[v]].resultMatrix;
				vx=tWeights[b];
				vy=tWeights[b+1];
				var weight=tWeights[b+2];
				wx+=(vx *tMatrix.a+vy *tMatrix.c+tMatrix.tx)*weight;
				wy+=(vx *tMatrix.b+vy *tMatrix.d+tMatrix.ty)*weight;
			}
			worldVertices[w]=wx;
			worldVertices[w+1]=wy;
		}
	}

	/**
	*计算路径上的节点
	*@param boneSlot
	*@param boneList
	*@param graphics
	*@param spacesCount
	*@param tangents
	*@param percentPosition
	*@param percentSpacing
	*@return
	*/
	__proto.computeWorldPositions=function(boneSlot,boneList,graphics,spacesCount,tangents,percentPosition,percentSpacing){
		var tBones=boneSlot.currDisplayData.bones;
		var tWeights=boneSlot.currDisplayData.weights;
		var tTriangles=boneSlot.currDisplayData.triangles;
		var tRx=0;
		var tRy=0;
		var nn=0;
		var tMatrix;
		var tX=NaN;
		var tY=NaN;
		var tB=0;
		var tWeight=0;
		var tVertices=[];
		var i=0,j=0,n=0;
		var verticesLength=boneSlot.currDisplayData.verLen;
		var target=boneSlot;
		var position=this.position;
		var spaces=this._spaces;
		var world=[];
		var out=[];
		var closed=false;
		var curveCount=verticesLength / 6;
		var prevCurve=-1;
		var pathLength=NaN;
		var o=0,curve=0;
		var p=NaN;
		var space=NaN;
		var prev=NaN;
		var length=NaN;
		if (!true){
			var lengths=boneSlot.currDisplayData.lengths;
			curveCount-=closed ? 1 :2;
			pathLength=lengths[curveCount];
			if (percentPosition)
				position *=pathLength;
			if (percentSpacing){
				for (i=0;i < spacesCount;i++)
				spaces[i] *=pathLength;
			}
			world.length=8;
			for (i=0,o=0,curve=0;i < spacesCount;i++,o+=3){
				space=spaces[i];
				position+=space;
				p=position;
				if (closed){
					p %=pathLength;
					if (p < 0)
						p+=pathLength;
					curve=0;
				}
				else if (p < 0){
					if (prevCurve !=PathConstraint.BEFORE){
						prevCurve=PathConstraint.BEFORE;
						this.computeWorldVertices2(target,boneList,2,4,world,0);
					}
					this.addBeforePosition(p,world,0,out,o);
					continue ;
				}
				else if (p > pathLength){
					if (prevCurve !=PathConstraint.AFTER){
						prevCurve=PathConstraint.AFTER;
						this.computeWorldVertices2(target,boneList,verticesLength-6,4,world,0);
					}
					this.addAfterPosition(p-pathLength,world,0,out,o);
					continue ;
				}
				for (;;curve++){
					length=lengths[curve];
					if (p > length)
						continue ;
					if (curve==0)
						p /=length;
					else {
						prev=lengths[curve-1];
						p=(p-prev)/ (length-prev);
					}
					break ;
				}
				if (curve !=prevCurve){
					prevCurve=curve;
					if (closed && curve==curveCount){
						this.computeWorldVertices2(target,boneList,verticesLength-4,4,world,0);
						this.computeWorldVertices2(target,boneList,0,4,world,4);
					}
					else
					this.computeWorldVertices2(target,boneList,curve *6+2,8,world,0);
				}
				this.addCurvePosition(p,world[0],world[1],world[2],world[3],world[4],world[5],world[6],world[7],out,o,tangents || (i > 0 && space==0));
			}
			return out;
		}
		if (closed){
			verticesLength+=2;
			world[verticesLength-2]=world[0];
			world[verticesLength-1]=world[1];
		}
		else {
			curveCount--;
			verticesLength-=4;
			this.computeWorldVertices2(boneSlot,boneList,2,verticesLength,tVertices,0);
			if (this._debugKey){
				for (i=0;i < tVertices.length;){
					graphics.drawCircle(tVertices[i++],tVertices[i++],10,"#ff0000");
				}
			}
			world=tVertices;
		}
		this._curves.length=curveCount;
		var curves=this._curves;
		pathLength=0;
		var x1=world[0],y1=world[1],cx1=0,cy1=0,cx2=0,cy2=0,x2=0,y2=0;
		var tmpx=NaN,tmpy=NaN,dddfx=NaN,dddfy=NaN,ddfx=NaN,ddfy=NaN,dfx=NaN,dfy=NaN;
		var w=0;
		for (i=0,w=2;i < curveCount;i++,w+=6){
			cx1=world[w];
			cy1=world[w+1];
			cx2=world[w+2];
			cy2=world[w+3];
			x2=world[w+4];
			y2=world[w+5];
			tmpx=(x1-cx1 *2+cx2)*0.1875;
			tmpy=(y1-cy1 *2+cy2)*0.1875;
			dddfx=((cx1-cx2)*3-x1+x2)*0.09375;
			dddfy=((cy1-cy2)*3-y1+y2)*0.09375;
			ddfx=tmpx *2+dddfx;
			ddfy=tmpy *2+dddfy;
			dfx=(cx1-x1)*0.75+tmpx+dddfx *0.16666667;
			dfy=(cy1-y1)*0.75+tmpy+dddfy *0.16666667;
			pathLength+=Math.sqrt(dfx *dfx+dfy *dfy);
			dfx+=ddfx;
			dfy+=ddfy;
			ddfx+=dddfx;
			ddfy+=dddfy;
			pathLength+=Math.sqrt(dfx *dfx+dfy *dfy);
			dfx+=ddfx;
			dfy+=ddfy;
			pathLength+=Math.sqrt(dfx *dfx+dfy *dfy);
			dfx+=ddfx+dddfx;
			dfy+=ddfy+dddfy;
			pathLength+=Math.sqrt(dfx *dfx+dfy *dfy);
			curves[i]=pathLength;
			x1=x2;
			y1=y2;
		}
		if (percentPosition)
			position *=pathLength;
		if (percentSpacing){
			for (i=0;i < spacesCount;i++)
			spaces[i] *=pathLength;
		};
		var segments=this._segments;
		var curveLength=0;
		var segment=0;
		for (i=0,o=0,curve=0,segment=0;i < spacesCount;i++,o+=3){
			space=spaces[i];
			position+=space;
			p=position;
			if (closed){
				p %=pathLength;
				if (p < 0)
					p+=pathLength;
				curve=0;
			}
			else if (p < 0){
				this.addBeforePosition(p,world,0,out,o);
				continue ;
			}
			else if (p > pathLength){
				this.addAfterPosition(p-pathLength,world,verticesLength-4,out,o);
				continue ;
			}
			for (;;curve++){
				length=curves[curve];
				if (p > length)
					continue ;
				if (curve==0)
					p /=length;
				else {
					prev=curves[curve-1];
					p=(p-prev)/ (length-prev);
				}
				break ;
			}
			if (curve !=prevCurve){
				prevCurve=curve;
				var ii=curve *6;
				x1=world[ii];
				y1=world[ii+1];
				cx1=world[ii+2];
				cy1=world[ii+3];
				cx2=world[ii+4];
				cy2=world[ii+5];
				x2=world[ii+6];
				y2=world[ii+7];
				tmpx=(x1-cx1 *2+cx2)*0.03;
				tmpy=(y1-cy1 *2+cy2)*0.03;
				dddfx=((cx1-cx2)*3-x1+x2)*0.006;
				dddfy=((cy1-cy2)*3-y1+y2)*0.006;
				ddfx=tmpx *2+dddfx;
				ddfy=tmpy *2+dddfy;
				dfx=(cx1-x1)*0.3+tmpx+dddfx *0.16666667;
				dfy=(cy1-y1)*0.3+tmpy+dddfy *0.16666667;
				curveLength=Math.sqrt(dfx *dfx+dfy *dfy);
				segments[0]=curveLength;
				for (ii=1;ii < 8;ii++){
					dfx+=ddfx;
					dfy+=ddfy;
					ddfx+=dddfx;
					ddfy+=dddfy;
					curveLength+=Math.sqrt(dfx *dfx+dfy *dfy);
					segments[ii]=curveLength;
				}
				dfx+=ddfx;
				dfy+=ddfy;
				curveLength+=Math.sqrt(dfx *dfx+dfy *dfy);
				segments[8]=curveLength;
				dfx+=ddfx+dddfx;
				dfy+=ddfy+dddfy;
				curveLength+=Math.sqrt(dfx *dfx+dfy *dfy);
				segments[9]=curveLength;
				segment=0;
			}
			p *=curveLength;
			for (;;segment++){
				length=segments[segment];
				if (p > length)
					continue ;
				if (segment==0)
					p /=length;
				else {
					prev=segments[segment-1];
					p=segment+(p-prev)/ (length-prev);
				}
				break ;
			}
			this.addCurvePosition(p *0.1,x1,y1,cx1,cy1,cx2,cy2,x2,y2,out,o,tangents || (i > 0 && space==0));
		}
		return out;
	}

	__proto.addBeforePosition=function(p,temp,i,out,o){
		var x1=temp[i],y1=temp[i+1],dx=temp[i+2]-x1,dy=temp[i+3]-y1,r=Math.atan2(dy,dx);
		out[o]=x1+p *Math.cos(r);
		out[o+1]=y1+p *Math.sin(r);
		out[o+2]=r;
	}

	__proto.addAfterPosition=function(p,temp,i,out,o){
		var x1=temp[i+2],y1=temp[i+3],dx=x1-temp[i],dy=y1-temp[i+1],r=Math.atan2(dy,dx);
		out[o]=x1+p *Math.cos(r);
		out[o+1]=y1+p *Math.sin(r);
		out[o+2]=r;
	}

	__proto.addCurvePosition=function(p,x1,y1,cx1,cy1,cx2,cy2,x2,y2,out,o,tangents){
		if (p==0)
			p=0.0001;
		var tt=p *p,ttt=tt *p,u=1-p,uu=u *u,uuu=uu *u;
		var ut=u *p,ut3=ut *3,uut3=u *ut3,utt3=ut3 *p;
		var x=x1 *uuu+cx1 *uut3+cx2 *utt3+x2 *ttt,y=y1 *uuu+cy1 *uut3+cy2 *utt3+y2 *ttt;
		out[o]=x;
		out[o+1]=y;
		if (tangents){
			out[o+2]=Math.atan2(y-(y1 *uu+cy1 *ut *2+cy2 *tt),x-(x1 *uu+cx1 *ut *2+cx2 *tt));
		}
		else {
			out[o+2]=0;
		}
	}

	PathConstraint.NONE=-1;
	PathConstraint.BEFORE=-2;
	PathConstraint.AFTER=-3;
	__static(PathConstraint,
	['_tempMt',function(){return this._tempMt=new Matrix();}
	]);
	return PathConstraint;
})()


/**
*@private
*/
//class laya.ani.bone.PathConstraintData
var PathConstraintData=(function(){
	function PathConstraintData(){
		this.name=null;
		this.target=null;
		this.positionMode=null;
		this.spacingMode=null;
		this.rotateMode=null;
		this.offsetRotation=NaN;
		this.position=NaN;
		this.spacing=NaN;
		this.rotateMix=NaN;
		this.translateMix=NaN;
		this.bones=[];
	}

	__class(PathConstraintData,'laya.ani.bone.PathConstraintData');
	return PathConstraintData;
})()


/**
*@private
*/
//class laya.ani.bone.SkinData
var SkinData=(function(){
	function SkinData(){
		this.name=null;
		this.slotArr=[];
	}

	__class(SkinData,'laya.ani.bone.SkinData');
	return SkinData;
})()


/**
*@private
*/
//class laya.ani.bone.SkinSlotDisplayData
var SkinSlotDisplayData=(function(){
	function SkinSlotDisplayData(){
		this.name=null;
		this.attachmentName=null;
		this.type=0;
		this.transform=null;
		this.width=NaN;
		this.height=NaN;
		this.texture=null;
		this.bones=null;
		this.uvs=null;
		this.weights=null;
		this.triangles=null;
		this.vertices=null;
		this.lengths=null;
		this.verLen=0;
	}

	__class(SkinSlotDisplayData,'laya.ani.bone.SkinSlotDisplayData');
	var __proto=SkinSlotDisplayData.prototype;
	__proto.createTexture=function(currTexture){
		if (this.texture)return this.texture;
		this.texture=new Texture(currTexture.bitmap,this.uvs);
		if (this.uvs[0] > this.uvs[4]
			&& this.uvs[1] > this.uvs[5]){
			this.texture.width=currTexture.height;
			this.texture.height=currTexture.width;
			this.texture.offsetX=-currTexture.offsetX;
			this.texture.offsetY=-currTexture.offsetY;
			this.texture.sourceWidth=currTexture.sourceHeight;
			this.texture.sourceHeight=currTexture.sourceWidth;
			}else {
			this.texture.width=currTexture.width;
			this.texture.height=currTexture.height;
			this.texture.offsetX=-currTexture.offsetX;
			this.texture.offsetY=-currTexture.offsetY;
			this.texture.sourceWidth=currTexture.sourceWidth;
			this.texture.sourceHeight=currTexture.sourceHeight;
		}
		if (!Render.isWebGL){
			if (this.uvs[1] > this.uvs[5]){
				this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY;
			}
		}
		return this.texture;
	}

	__proto.destory=function(){
		if (this.texture)this.texture.destroy();
	}

	return SkinSlotDisplayData;
})()


/**
*@private
*/
//class laya.ani.bone.SlotData
var SlotData=(function(){
	function SlotData(){
		this.name=null;
		this.displayArr=[];
	}

	__class(SlotData,'laya.ani.bone.SlotData');
	var __proto=SlotData.prototype;
	__proto.getDisplayByName=function(name){
		var tDisplay;
		for (var i=0,n=this.displayArr.length;i < n;i++){
			tDisplay=this.displayArr[i];
			if (tDisplay.attachmentName==name){
				return i;
			}
		}
		return-1;
	}

	return SlotData;
})()


/**
*@private
*/
//class laya.ani.bone.TfConstraint
var TfConstraint=(function(){
	function TfConstraint(data,bones){
		this._data=null;
		this._bones=null;
		this.target=null;
		this.rotateMix=NaN;
		this.translateMix=NaN;
		this.scaleMix=NaN;
		this.shearMix=NaN;
		this._temp=__newvec(2,0);
		this._data=data;
		if (this._bones==null){
			this._bones=[];
		}
		this.target=bones[data.targetIndex];
		var j=0,n=0;
		for (j=0,n=data.boneIndexs.length;j < n;j++){
			this._bones.push(bones[data.boneIndexs[j]]);
		}
		this.rotateMix=data.rotateMix;
		this.translateMix=data.translateMix;
		this.scaleMix=data.scaleMix;
		this.shearMix=data.shearMix;
	}

	__class(TfConstraint,'laya.ani.bone.TfConstraint');
	var __proto=TfConstraint.prototype;
	__proto.apply=function(){
		var tTfBone;
		var ta=this.target.resultMatrix.a,tb=this.target.resultMatrix.b,tc=this.target.resultMatrix.c,td=this.target.resultMatrix.d;
		for (var j=0,n=this._bones.length;j < n;j++){
			tTfBone=this._bones[j];
			if (this.rotateMix > 0){
				var a=tTfBone.resultMatrix.a,b=tTfBone.resultMatrix.b,c=tTfBone.resultMatrix.c,d=tTfBone.resultMatrix.d;
				var r=Math.atan2(tc,ta)-Math.atan2(c,a)+this._data.offsetRotation *Math.PI / 180;
				if (r > Math.PI)
					r-=Math.PI *2;
				else if (r <-Math.PI)r+=Math.PI *2;
				r *=this.rotateMix;
				var cos=Math.cos(r),sin=Math.sin(r);
				tTfBone.resultMatrix.a=cos *a-sin *c;
				tTfBone.resultMatrix.b=cos *b-sin *d;
				tTfBone.resultMatrix.c=sin *a+cos *c;
				tTfBone.resultMatrix.d=sin *b+cos *d;
			}
			if (this.translateMix){
				this._temp[0]=this._data.offsetX;
				this._temp[1]=this._data.offsetY;
				this.target.localToWorld(this._temp);
				tTfBone.resultMatrix.tx+=(this._temp[0]-tTfBone.resultMatrix.tx)*this.translateMix;
				tTfBone.resultMatrix.ty+=(this._temp[1]-tTfBone.resultMatrix.ty)*this.translateMix;
				tTfBone.updateChild();
			}
			if (this.scaleMix > 0){
				var bs=Math.sqrt(tTfBone.resultMatrix.a *tTfBone.resultMatrix.a+tTfBone.resultMatrix.c *tTfBone.resultMatrix.c);
				var ts=Math.sqrt(ta *ta+tc *tc);
				var s=bs > 0.00001 ? (bs+(ts-bs+this._data.offsetScaleX)*this.scaleMix)/ bs :0;
				tTfBone.resultMatrix.a *=s;
				tTfBone.resultMatrix.c *=s;
				bs=Math.sqrt(tTfBone.resultMatrix.b *tTfBone.resultMatrix.b+tTfBone.resultMatrix.d *tTfBone.resultMatrix.d);
				ts=Math.sqrt(tb *tb+td *td);
				s=bs > 0.00001 ? (bs+(ts-bs+this._data.offsetScaleY)*this.scaleMix)/ bs :0;
				tTfBone.resultMatrix.b *=s;
				tTfBone.resultMatrix.d *=s;
			}
			if (this.shearMix > 0){
				b=tTfBone.resultMatrix.b,d=tTfBone.resultMatrix.d;
				var by=Math.atan2(d,b);
				r=Math.atan2(td,tb)-Math.atan2(tc,ta)-(by-Math.atan2(tTfBone.resultMatrix.c,tTfBone.resultMatrix.a));
				if (r > Math.PI)
					r-=Math.PI *2;
				else if (r <-Math.PI)r+=Math.PI *2;
				r=by+(r+this._data.offsetShearY *Math.PI / 180)*this.shearMix;
				s=Math.sqrt(b *b+d *d);
				tTfBone.resultMatrix.b=Math.cos(r)*s;
				tTfBone.resultMatrix.d=Math.sin(r)*s;
			}
		}
	}

	return TfConstraint;
})()


/**
*@private
*/
//class laya.ani.bone.TfConstraintData
var TfConstraintData=(function(){
	function TfConstraintData(){
		this.name=null;
		this.targetIndex=0;
		this.rotateMix=NaN;
		this.translateMix=NaN;
		this.scaleMix=NaN;
		this.shearMix=NaN;
		this.offsetRotation=NaN;
		this.offsetX=NaN;
		this.offsetY=NaN;
		this.offsetScaleX=NaN;
		this.offsetScaleY=NaN;
		this.offsetShearY=NaN;
		this.boneIndexs=[];
	}

	__class(TfConstraintData,'laya.ani.bone.TfConstraintData');
	return TfConstraintData;
})()


/**
*@private
*/
//class laya.ani.bone.Transform
var Transform=(function(){
	function Transform(){
		this.skX=0;
		this.skY=0;
		this.scX=1;
		this.scY=1;
		this.x=0;
		this.y=0;
		this.skewX=0;
		this.skewY=0;
		this.mMatrix=null;
	}

	__class(Transform,'laya.ani.bone.Transform');
	var __proto=Transform.prototype;
	__proto.initData=function(data){
		if (data.x !=undefined){
			this.x=data.x;
		}
		if (data.y !=undefined){
			this.y=data.y;
		}
		if (data.skX !=undefined){
			this.skX=data.skX;
		}
		if (data.skY !=undefined){
			this.skY=data.skY;
		}
		if (data.scX !=undefined){
			this.scX=data.scX;
		}
		if (data.scY !=undefined){
			this.scY=data.scY;
		}
	}

	__proto.getMatrix=function(){
		var tMatrix;
		if (this.mMatrix){
			tMatrix=this.mMatrix;
			}else {
			tMatrix=this.mMatrix=new Matrix();
		}
		tMatrix.identity();
		tMatrix.scale(this.scX,this.scY);
		if (this.skewX || this.skewY){
			this.skew(tMatrix,this.skewX *Math.PI / 180,this.skewY *Math.PI / 180);
		}
		tMatrix.rotate(this.skX *Math.PI / 180);
		tMatrix.translate(this.x,this.y);
		return tMatrix;
	}

	__proto.skew=function(m,x,y){
		var sinX=Math.sin(y);
		var cosX=Math.cos(y);
		var sinY=Math.sin(x);
		var cosY=Math.cos(x);
		m.setTo(m.a *cosY-m.b *sinX,
		m.a *sinY+m.b *cosX,
		m.c *cosY-m.d *sinX,
		m.c *sinY+m.d *cosX,
		m.tx *cosY-m.ty *sinX,
		m.tx *sinY+m.ty *cosX);
		return m;
	}

	return Transform;
})()


/**
*用于UV转换的工具类
*@private
*/
//class laya.ani.bone.UVTools
var UVTools=(function(){
	function UVTools(){}
	__class(UVTools,'laya.ani.bone.UVTools');
	UVTools.getRelativeUV=function(bigUV,smallUV,rst){
		var startX=bigUV[0];
		var width=bigUV[2]-bigUV[0];
		var startY=bigUV[1];
		var height=bigUV[5]-bigUV[1];
		if(!rst)rst=[];
		rst.length=smallUV.length;
		var i=0,len=0;
		len=rst.length;
		var dWidth=1 / width;
		var dHeight=1 / height;
		for (i=0;i < len;i+=2){
			rst[i]=(smallUV[i]-startX)*dWidth;
			rst[i+1]=(smallUV[i+1]-startY)*dHeight;
		}
		return rst;
	}

	UVTools.getAbsoluteUV=function(bigUV,smallUV,rst){
		if (bigUV[0]==0 && bigUV[1]==0 && bigUV[4]==1 && bigUV[5]==1){
			if (rst){
				Utils.copyArray(rst,smallUV);
				return rst;
				}else{
				return smallUV;
			}
		};
		var startX=bigUV[0];
		var width=bigUV[2]-bigUV[0];
		var startY=bigUV[1];
		var height=bigUV[5]-bigUV[1];
		if(!rst)rst=[];
		rst.length=smallUV.length;
		var i=0,len=0;
		len=rst.length;
		for (i=0;i < len;i+=2){
			rst[i]=smallUV[i]*width+startX;
			rst[i+1]=smallUV[i+1]*height+startY;
		}
		return rst;
	}

	return UVTools;
})()


/**
*<code>Graphics</code> 类用于创建绘图显示对象。Graphics可以同时绘制多个位图或者矢量图，还可以结合save，restore，transform，scale，rotate，translate，alpha等指令对绘图效果进行变化。
*Graphics以命令流方式存储，可以通过cmds属性访问所有命令流。Graphics是比Sprite更轻量级的对象，合理使用能提高应用性能(比如把大量的节点绘图改为一个节点的Graphics命令集合，能减少大量节点创建消耗)。
*@see laya.display.Sprite#graphics
*/
//class laya.display.Graphics
var Graphics=(function(){
	function Graphics(){
		/**@private */
		//this._sp=null;
		/**@private */
		this._one=null;
		/**@private */
		this._cmds=null;
		/**@private */
		//this._vectorgraphArray=null;
		/**@private */
		//this._graphicBounds=null;
		this._render=this._renderEmpty;
		if (Render.isConchNode){
			var _this_=this;
			_this_._nativeObj=new (window)._conchGraphics();
			_this_.id=_this_._nativeObj.conchID;
		}
	}

	__class(Graphics,'laya.display.Graphics');
	var __proto=Graphics.prototype;
	/**
	*<p>销毁此对象。</p>
	*/
	__proto.destroy=function(){
		this.clear();
		if (this._graphicBounds)this._graphicBounds.destroy();
		this._graphicBounds=null;
		this._vectorgraphArray=null;
		this._sp && (this._sp._renderType=0);
		this._sp=null;
	}

	/**
	*<p>清空绘制命令。</p>
	*@param recoverCmds 是否回收绘图指令
	*/
	__proto.clear=function(recoverCmds){
		(recoverCmds===void 0)&& (recoverCmds=false);
		var i=0,len=0;
		if (recoverCmds){
			var tCmd=this._one;
			if (this._cmds){
				len=this._cmds.length;
				for (i=0;i < len;i++){
					tCmd=this._cmds[i];
					if (tCmd && (tCmd.callee===Render._context._drawTexture || tCmd.callee===Render._context._drawTextureWithTransform)){
						tCmd[0]=null;
						Graphics._cache.push(tCmd);
					}
				}
				this._cmds.length=0;
				}else if (tCmd){
				if (tCmd && (tCmd.callee===Render._context._drawTexture || tCmd.callee===Render._context._drawTextureWithTransform)){
					tCmd[0]=null;
					Graphics._cache.push(tCmd);
				}
			}
			}else {
			this._cmds=null;
		}
		this._one=null;
		this._render=this._renderEmpty;
		this._sp && (this._sp._renderType &=~0x01 & ~0x200);
		this._repaint();
		if (this._vectorgraphArray){
			for (i=0,len=this._vectorgraphArray.length;i < len;i++){
				VectorGraphManager.getInstance().deleteShape(this._vectorgraphArray[i]);
			}
			this._vectorgraphArray.length=0;
		}
	}

	/**@private */
	__proto._clearBoundsCache=function(){
		if (this._graphicBounds)this._graphicBounds.reset();
	}

	/**@private */
	__proto._initGraphicBounds=function(){
		if (!this._graphicBounds){
			this._graphicBounds=new GraphicsBounds();
			this._graphicBounds._graphics=this;
		}
	}

	/**
	*@private
	*重绘此对象。
	*/
	__proto._repaint=function(){
		this._clearBoundsCache();
		this._sp && this._sp.repaint();
	}

	/**@private */
	__proto._isOnlyOne=function(){
		return !this._cmds || this._cmds.length===0;
	}

	/**
	*获取位置及宽高信息矩阵(比较耗CPU，频繁使用会造成卡顿，尽量少用)。
	*@param realSize （可选）使用图片的真实大小，默认为false
	*@return 位置与宽高组成的 一个 Rectangle 对象。
	*/
	__proto.getBounds=function(realSize){
		(realSize===void 0)&& (realSize=false);
		this._initGraphicBounds();
		return this._graphicBounds.getBounds(realSize);
	}

	/**
	*@private
	*@param realSize （可选）使用图片的真实大小，默认为false
	*获取端点列表。
	*/
	__proto.getBoundPoints=function(realSize){
		(realSize===void 0)&& (realSize=false);
		this._initGraphicBounds();
		return this._graphicBounds.getBoundPoints(realSize);
	}

	__proto._addCmd=function(a){
		this._cmds=this._cmds || [];
		a.callee=a.shift();
		this._cmds.push(a);
	}

	__proto.setFilters=function(fs){
		this._saveToCmd(Render._context._setFilters,fs);
	}

	/**
	*绘制纹理。
	*@param tex 纹理。
	*@param x （可选）X轴偏移量。
	*@param y （可选）Y轴偏移量。
	*@param width （可选）宽度。
	*@param height （可选）高度。
	*@param m （可选）矩阵信息。
	*@param alpha （可选）透明度。
	*/
	__proto.drawTexture=function(tex,x,y,width,height,m,alpha){
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		(alpha===void 0)&& (alpha=1);
		if (!tex || alpha < 0.01)return null;
		if (!width)width=tex.sourceWidth;
		if (!height)height=tex.sourceHeight;
		alpha=alpha < 0 ? 0 :(alpha > 1 ? 1 :alpha);
		var offset=(!Render.isWebGL && (Browser.onFirefox || Browser.onEdge||Browser.onIE||Browser.onSafari))? 0.5 :0;
		var wRate=width / tex.sourceWidth;
		var hRate=height / tex.sourceHeight;
		width=tex.width *wRate;
		height=tex.height *hRate;
		if (tex.loaded && (width <=0 || height <=0))return null;
		x+=tex.offsetX *wRate;
		y+=tex.offsetY *hRate;
		this._sp && (this._sp._renderType |=0x200);
		var args;
		x-=offset;
		y-=offset;
		width+=2 *offset;
		height+=2 *offset;
		if (Graphics._cache.length){
			args=Graphics._cache.pop();
			args[0]=tex;
			args[1]=x;
			args[2]=y;
			args[3]=width;
			args[4]=height;
			args[5]=m;
			args[6]=alpha;
			}else {
			args=[tex,x,y,width,height,m,alpha];
		}
		args.callee=(m || alpha !=1)? Render._context._drawTextureWithTransform :Render._context._drawTexture;
		if (this._one==null && !m && alpha==1){
			this._one=args;
			this._render=this._renderOneImg;
			}else {
			this._saveToCmd(args.callee,args);
		}
		if (!tex.loaded){
			tex.once("loaded",this,this._textureLoaded,[tex,args]);
		}
		this._repaint();
		return args;
	}

	/**
	*@private 清理贴图并替换为最新的
	*@param tex
	*/
	__proto.cleanByTexture=function(tex,x,y,width,height){
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		if (!tex)return this.clear();
		if (this._one && this._render===this._renderOneImg){
			if (!width)width=tex.sourceWidth;
			if (!height)height=tex.sourceHeight;
			var wRate=width / tex.sourceWidth;
			var hRate=height / tex.sourceHeight;
			width=tex.width *wRate;
			height=tex.height *hRate;
			x+=tex.offsetX *wRate;
			y+=tex.offsetY *hRate;
			this._one[0]=tex;
			this._one[1]=x;
			this._one[2]=y;
			this._one[3]=width;
			this._one[4]=height;
			}else {
			this.clear();
			tex && this.drawTexture(tex,x,y,width,height);
		}
	}

	/**
	*批量绘制同样纹理。
	*@param tex 纹理。
	*@param pos 绘制坐标。
	*/
	__proto.drawTextures=function(tex,pos){
		if (!tex)return;
		this._saveToCmd(Render._context._drawTextures,[tex,pos]);
	}

	/**
	*用texture填充。
	*@param tex 纹理。
	*@param x X轴偏移量。
	*@param y Y轴偏移量。
	*@param width （可选）宽度。
	*@param height （可选）高度。
	*@param type （可选）填充类型 repeat|repeat-x|repeat-y|no-repeat
	*@param offset （可选）贴图纹理偏移
	*/
	__proto.fillTexture=function(tex,x,y,width,height,type,offset){
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		(type===void 0)&& (type="repeat");
		if (!tex)return;
		var args=[tex,x,y,width,height,type,offset || Point.EMPTY,{}];
		if (!tex.loaded){
			tex.once("loaded",this,this._textureLoaded,[tex,args]);
		}
		this._saveToCmd(Render._context._fillTexture,args);
	}

	__proto._textureLoaded=function(tex,param){
		param[3]=param[3] || tex.width;
		param[4]=param[4] || tex.height;
		this._repaint();
	}

	/**
	*填充一个圆形。这是一个临时函数，以后会删除，建议用户自己实现。
	*@param x
	*@param y
	*@param tex
	*@param cx 圆心位置。
	*@param cy
	*@param radius
	*@param segNum 分段数，越大越平滑。
	*/
	__proto.fillCircle=function(x,y,tex,cx,cy,radius,segNum){
		tex.bitmap.enableMerageInAtlas=false;
		var verts=new Float32Array((segNum+1)*2);
		var uvs=new Float32Array((segNum+1)*2);
		var indices=new Uint16Array(segNum*3);
		var dang=2 *Math.PI / segNum;
		var cang=0;
		verts[0]=cx;
		verts[1]=cy;
		uvs[0]=cx / tex.width;
		uvs[1]=cy / tex.height;
		var idx=2;
		for (var i=0;i < segNum;i++){
			var px=radius *Math.cos(cang)+cx;
			var py=radius *Math.sin(cang)+cy;
			verts[idx]=px;
			verts[idx+1]=py;
			uvs[idx]=px / tex.width;
			uvs[idx+1]=py / tex.height;
			cang+=dang;
			idx+=2;
		}
		idx=0;
		for (i=0;i < segNum;i++){
			indices[idx++]=0;
			indices[idx++]=i+1;
			indices[idx++]=(i+2 >=segNum+1)?1:(i+2);
		}
		this.drawTriangles(tex,x,y,verts,uvs,indices);
	}

	/**
	*绘制一组三角形
	*@param texture 纹理。
	*@param x X轴偏移量。
	*@param y Y轴偏移量。
	*@param vertices 顶点数组。
	*@param indices 顶点索引。
	*@param uvData UV数据。
	*@param matrix 缩放矩阵。
	*@param alpha alpha
	*@param color 颜色变换
	*@param blendMode blend模式
	*/
	__proto.drawTriangles=function(texture,x,y,vertices,uvs,indices,matrix,alpha,color,blendMode){
		(alpha===void 0)&& (alpha=1);
		this._saveToCmd(Render._context.drawTriangles,[texture,x,y,vertices,uvs,indices,matrix,alpha,color,blendMode]);
	}

	/**
	*@private
	*保存到命令流。
	*/
	__proto._saveToCmd=function(fun,args){
		this._sp && (this._sp._renderType |=0x200);
		if (this._one==null){
			this._one=args;
			this._render=this._renderOne;
			}else {
			this._sp && (this._sp._renderType &=~0x01);
			this._render=this._renderAll;
			(this._cmds || (this._cmds=[])).length===0 && this._cmds.push(this._one);
			this._cmds.push(args);
		}
		args.callee=fun;
		this._repaint();
		return args;
	}

	/**
	*设置剪裁区域，超出剪裁区域的坐标不显示。
	*@param x X 轴偏移量。
	*@param y Y 轴偏移量。
	*@param width 宽度。
	*@param height 高度。
	*/
	__proto.clipRect=function(x,y,width,height){
		this._saveToCmd(Render._context._clipRect,[x,y,width,height]);
	}

	/**
	*在画布上绘制文本。
	*@param text 在画布上输出的文本。
	*@param x 开始绘制文本的 x 坐标位置（相对于画布）。
	*@param y 开始绘制文本的 y 坐标位置（相对于画布）。
	*@param font 定义字号和字体，比如"20px Arial"。
	*@param color 定义文本颜色，比如"#ff0000"。
	*@param textAlign 文本对齐方式，可选值："left"，"center"，"right"。
	*/
	__proto.fillText=function(text,x,y,font,color,textAlign,underLine){
		(underLine===void 0)&& (underLine=0);
		this._saveToCmd(Render._context._fillText,[text,x,y,font || Font.defaultFont,color,textAlign]);
	}

	/**
	*在画布上绘制“被填充且镶边的”文本。
	*@param text 在画布上输出的文本。
	*@param x 开始绘制文本的 x 坐标位置（相对于画布）。
	*@param y 开始绘制文本的 y 坐标位置（相对于画布）。
	*@param font 定义字体和字号，比如"20px Arial"。
	*@param fillColor 定义文本颜色，比如"#ff0000"。
	*@param borderColor 定义镶边文本颜色。
	*@param lineWidth 镶边线条宽度。
	*@param textAlign 文本对齐方式，可选值："left"，"center"，"right"。
	*/
	__proto.fillBorderText=function(text,x,y,font,fillColor,borderColor,lineWidth,textAlign){
		this._saveToCmd(Render._context._fillBorderText,[text,x,y,font || Font.defaultFont,fillColor,borderColor,lineWidth,textAlign]);
	}

	/**
	*在画布上绘制文本（没有填色）。文本的默认颜色是黑色。
	*@param text 在画布上输出的文本。
	*@param x 开始绘制文本的 x 坐标位置（相对于画布）。
	*@param y 开始绘制文本的 y 坐标位置（相对于画布）。
	*@param font 定义字体和字号，比如"20px Arial"。
	*@param color 定义文本颜色，比如"#ff0000"。
	*@param lineWidth 线条宽度。
	*@param textAlign 文本对齐方式，可选值："left"，"center"，"right"。
	*/
	__proto.strokeText=function(text,x,y,font,color,lineWidth,textAlign){
		this._saveToCmd(Render._context._strokeText,[text,x,y,font || Font.defaultFont,color,lineWidth,textAlign]);
	}

	/**
	*设置透明度。
	*@param value 透明度。
	*/
	__proto.alpha=function(value){
		value=value < 0 ? 0 :(value > 1 ? 1 :value);
		this._saveToCmd(Render._context._alpha,[value]);
	}

	/**
	*设置当前透明度。
	*@param value 透明度。
	*/
	__proto.setAlpha=function(value){
		value=value < 0 ? 0 :(value > 1 ? 1 :value);
		this._saveToCmd(Render._context._setAlpha,[value]);
	}

	/**
	*替换绘图的当前转换矩阵。
	*@param mat 矩阵。
	*@param pivotX （可选）水平方向轴心点坐标。
	*@param pivotY （可选）垂直方向轴心点坐标。
	*/
	__proto.transform=function(matrix,pivotX,pivotY){
		(pivotX===void 0)&& (pivotX=0);
		(pivotY===void 0)&& (pivotY=0);
		this._saveToCmd(Render._context._transform,[matrix,pivotX,pivotY]);
	}

	/**
	*旋转当前绘图。(推荐使用transform，性能更高)
	*@param angle 旋转角度，以弧度计。
	*@param pivotX （可选）水平方向轴心点坐标。
	*@param pivotY （可选）垂直方向轴心点坐标。
	*/
	__proto.rotate=function(angle,pivotX,pivotY){
		(pivotX===void 0)&& (pivotX=0);
		(pivotY===void 0)&& (pivotY=0);
		this._saveToCmd(Render._context._rotate,[angle,pivotX,pivotY]);
	}

	/**
	*缩放当前绘图至更大或更小。(推荐使用transform，性能更高)
	*@param scaleX 水平方向缩放值。
	*@param scaleY 垂直方向缩放值。
	*@param pivotX （可选）水平方向轴心点坐标。
	*@param pivotY （可选）垂直方向轴心点坐标。
	*/
	__proto.scale=function(scaleX,scaleY,pivotX,pivotY){
		(pivotX===void 0)&& (pivotX=0);
		(pivotY===void 0)&& (pivotY=0);
		this._saveToCmd(Render._context._scale,[scaleX,scaleY,pivotX,pivotY]);
	}

	/**
	*重新映射画布上的 (0,0)位置。
	*@param x 添加到水平坐标（x）上的值。
	*@param y 添加到垂直坐标（y）上的值。
	*/
	__proto.translate=function(x,y){
		this._saveToCmd(Render._context._translate,[x,y]);
	}

	/**
	*保存当前环境的状态。
	*/
	__proto.save=function(){
		this._saveToCmd(Render._context._save,[]);
	}

	/**
	*返回之前保存过的路径状态和属性。
	*/
	__proto.restore=function(){
		this._saveToCmd(Render._context._restore,[]);
	}

	/**
	*@private
	*替换文本内容。
	*@param text 文本内容。
	*@return 替换成功则值为true，否则值为flase。
	*/
	__proto.replaceText=function(text){
		this._repaint();
		var cmds=this._cmds;
		if (!cmds){
			if (this._one && this._isTextCmd(this._one.callee)){
				if (this._one[0].toUpperCase)this._one[0]=text;
				else this._one[0].setText(text);
				return true;
			}
			}else {
			for (var i=cmds.length-1;i >-1;i--){
				if (this._isTextCmd(cmds[i].callee)){
					if (cmds[i][0].toUpperCase)cmds[i][0]=text;
					else cmds[i][0].setText(text);
					return true;
				}
			}
		}
		return false;
	}

	/**@private */
	__proto._isTextCmd=function(fun){
		return fun===Render._context._fillText || fun===Render._context._fillBorderText || fun===Render._context._strokeText;
	}

	/**
	*@private
	*替换文本颜色。
	*@param color 颜色。
	*/
	__proto.replaceTextColor=function(color){
		this._repaint();
		var cmds=this._cmds;
		if (!cmds){
			if (this._one && this._isTextCmd(this._one.callee)){
				this._one[4]=color;
				if (!this._one[0].toUpperCase)this._one[0].changed=true;
			}
			}else {
			for (var i=cmds.length-1;i >-1;i--){
				if (this._isTextCmd(cmds[i].callee)){
					cmds[i][4]=color;
					if (!cmds[i][0].toUpperCase)cmds[i][0].changed=true;
				}
			}
		}
	}

	/**
	*加载并显示一个图片。
	*@param url 图片地址。
	*@param x （可选）显示图片的x位置。
	*@param y （可选）显示图片的y位置。
	*@param width （可选）显示图片的宽度，设置为0表示使用图片默认宽度。
	*@param height （可选）显示图片的高度，设置为0表示使用图片默认高度。
	*@param complete （可选）加载完成回调。
	*/
	__proto.loadImage=function(url,x,y,width,height,complete){
		var _$this=this;
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		var tex=Loader.getRes(url);
		if (tex)onloaded(tex);
		else Laya.loader.load(url,Handler.create(null,onloaded),null,"image");
		function onloaded (tex){
			if (tex){
				_$this.drawTexture(tex,x,y,width,height);
				if (complete !=null)complete.call(_$this._sp,tex);
			}
		}
	}

	/**
	*@private
	*/
	__proto._renderEmpty=function(sprite,context,x,y){}
	/**
	*@private
	*/
	__proto._renderAll=function(sprite,context,x,y){
		var cmds=this._cmds,cmd;
		for (var i=0,n=cmds.length;i < n;i++){
			(cmd=cmds[i]).callee.call(context,x,y,cmd);
		}
	}

	/**
	*@private
	*/
	__proto._renderOne=function(sprite,context,x,y){
		this._one.callee.call(context,x,y,this._one);
	}

	/**
	*@private
	*/
	__proto._renderOneImg=function(sprite,context,x,y){
		this._one.callee.call(context,x,y,this._one);
		if (sprite._renderType!==2305){
			sprite._renderType |=0x01;
		}
	}

	/**
	*绘制一条线。
	*@param fromX X轴开始位置。
	*@param fromY Y轴开始位置。
	*@param toX X轴结束位置。
	*@param toY Y轴结束位置。
	*@param lineColor 颜色。
	*@param lineWidth （可选）线条宽度。
	*/
	__proto.drawLine=function(fromX,fromY,toX,toY,lineColor,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var tId=0;
		if (Render.isWebGL){
			tId=VectorGraphManager.getInstance().getId();
			if (this._vectorgraphArray==null)this._vectorgraphArray=[];
			this._vectorgraphArray.push(tId);
		};
		var offset=lineWidth % 2===0 ? 0 :0.5;
		var arr=[fromX+offset,fromY+offset,toX+offset,toY+offset,lineColor,lineWidth,tId];
		this._saveToCmd(Render._context._drawLine,arr);
	}

	/**
	*绘制一系列线段。
	*@param x 开始绘制的X轴位置。
	*@param y 开始绘制的Y轴位置。
	*@param points 线段的点集合。格式:[x1,y1,x2,y2,x3,y3...]。
	*@param lineColor 线段颜色，或者填充绘图的渐变对象。
	*@param lineWidth （可选）线段宽度。
	*/
	__proto.drawLines=function(x,y,points,lineColor,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var tId=0;
		if (!points || points.length < 4)return;
		if (Render.isWebGL){
			tId=VectorGraphManager.getInstance().getId();
			if (this._vectorgraphArray==null)this._vectorgraphArray=[];
			this._vectorgraphArray.push(tId);
		};
		var offset=lineWidth % 2===0 ? 0 :0.5;
		var arr=[x+offset,y+offset,points,lineColor,lineWidth,tId];
		this._saveToCmd(Render._context._drawLines,arr);
	}

	/**
	*绘制一系列曲线。
	*@param x 开始绘制的 X 轴位置。
	*@param y 开始绘制的 Y 轴位置。
	*@param points 线段的点集合，格式[startx,starty,ctrx,ctry,startx,starty...]。
	*@param lineColor 线段颜色，或者填充绘图的渐变对象。
	*@param lineWidth （可选）线段宽度。
	*/
	__proto.drawCurves=function(x,y,points,lineColor,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var arr=[x,y,points,lineColor,lineWidth];
		this._saveToCmd(Render._context._drawCurves,arr);
	}

	/**
	*绘制矩形。
	*@param x 开始绘制的 X 轴位置。
	*@param y 开始绘制的 Y 轴位置。
	*@param width 矩形宽度。
	*@param height 矩形高度。
	*@param fillColor 填充颜色，或者填充绘图的渐变对象。
	*@param lineColor （可选）边框颜色，或者填充绘图的渐变对象。
	*@param lineWidth （可选）边框宽度。
	*/
	__proto.drawRect=function(x,y,width,height,fillColor,lineColor,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var offset=lineColor ? lineWidth / 2 :0;
		var lineOffset=lineColor ? lineWidth :0;
		var arr=[x+offset,y+offset,width-lineOffset,height-lineOffset,fillColor,lineColor,lineWidth];
		this._saveToCmd(Render._context._drawRect,arr);
	}

	/**
	*绘制圆形。
	*@param x 圆点X 轴位置。
	*@param y 圆点Y 轴位置。
	*@param radius 半径。
	*@param fillColor 填充颜色，或者填充绘图的渐变对象。
	*@param lineColor （可选）边框颜色，或者填充绘图的渐变对象。
	*@param lineWidth （可选）边框宽度。
	*/
	__proto.drawCircle=function(x,y,radius,fillColor,lineColor,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var offset=lineColor ? lineWidth / 2 :0;
		var tId=0;
		if (Render.isWebGL){
			tId=VectorGraphManager.getInstance().getId();
			if (this._vectorgraphArray==null)this._vectorgraphArray=[];
			this._vectorgraphArray.push(tId);
		};
		var arr=[x,y,radius-offset,fillColor,lineColor,lineWidth,tId];
		this._saveToCmd(Render._context._drawCircle,arr);
	}

	/**
	*绘制扇形。
	*@param x 开始绘制的 X 轴位置。
	*@param y 开始绘制的 Y 轴位置。
	*@param radius 扇形半径。
	*@param startAngle 开始角度。
	*@param endAngle 结束角度。
	*@param fillColor 填充颜色，或者填充绘图的渐变对象。
	*@param lineColor （可选）边框颜色，或者填充绘图的渐变对象。
	*@param lineWidth （可选）边框宽度。
	*/
	__proto.drawPie=function(x,y,radius,startAngle,endAngle,fillColor,lineColor,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var offset=lineColor ? lineWidth / 2 :0;
		var lineOffset=lineColor ? lineWidth :0;
		var tId=0;
		if (Render.isWebGL){
			tId=VectorGraphManager.getInstance().getId();
			if (this._vectorgraphArray==null)this._vectorgraphArray=[];
			this._vectorgraphArray.push(tId);
		};
		var arr=[x+offset,y+offset,radius-lineOffset,startAngle,endAngle,fillColor,lineColor,lineWidth,tId];
		arr[3]=Utils.toRadian(startAngle);
		arr[4]=Utils.toRadian(endAngle);
		this._saveToCmd(Render._context._drawPie,arr);
	}

	/**
	*绘制多边形。
	*@param x 开始绘制的 X 轴位置。
	*@param y 开始绘制的 Y 轴位置。
	*@param points 多边形的点集合。
	*@param fillColor 填充颜色，或者填充绘图的渐变对象。
	*@param lineColor （可选）边框颜色，或者填充绘图的渐变对象。
	*@param lineWidth （可选）边框宽度。
	*/
	__proto.drawPoly=function(x,y,points,fillColor,lineColor,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var tId=0;
		var tIsConvexPolygon=false;
		if (Render.isWebGL){
			tId=VectorGraphManager.getInstance().getId();
			if (this._vectorgraphArray==null)this._vectorgraphArray=[];
			this._vectorgraphArray.push(tId);
			if (points.length > 6){
				tIsConvexPolygon=false;
				}else {
				tIsConvexPolygon=true;
			}
		};
		var offset=lineColor ? (lineWidth % 2===0 ? 0 :0.5):0;
		var arr=[x+offset,y+offset,points,fillColor,lineColor,lineWidth,tId,tIsConvexPolygon];
		this._saveToCmd(Render._context._drawPoly,arr);
	}

	/**
	*绘制路径。
	*@param x 开始绘制的 X 轴位置。
	*@param y 开始绘制的 Y 轴位置。
	*@param paths 路径集合，路径支持以下格式：[["moveTo",x,y],["lineTo",x,y,x,y,x,y],["arcTo",x1,y1,x2,y2,r],["closePath"]]。
	*@param brush （可选）刷子定义，支持以下设置{fillStyle}。
	*@param pen （可选）画笔定义，支持以下设置{strokeStyle,lineWidth,lineJoin,lineCap,miterLimit}。
	*/
	__proto.drawPath=function(x,y,paths,brush,pen){
		var arr=[x,y,paths,brush,pen];
		this._saveToCmd(Render._context._drawPath,arr);
	}

	/**
	*@private
	*命令流。存储了所有绘制命令。
	*/
	__getset(0,__proto,'cmds',function(){
		return this._cmds;
		},function(value){
		this._sp && (this._sp._renderType |=0x200);
		this._cmds=value;
		this._render=this._renderAll;
		this._repaint();
	});

	Graphics.__init__=function(){
		if (Render.isConchNode){
			var from=laya.display.Graphics.prototype;
			var to=Browser.window.ConchGraphics.prototype;
			var list=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"];
			for (var i=0,len=list.length;i <=len;i++){
				var temp=list[i];
				from[temp]=to[temp];
			}
			from._saveToCmd=null;
			if (to.drawImageS){
				from.drawTextures=function (tex,pos){
					if (!tex)return;
					if (!(tex.loaded && tex.bitmap && tex.source)){
						return;
					};
					var uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;
					this.drawImageS(tex.bitmap.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,tex.offsetX,tex.offsetY,tex.width,tex.height,pos);
				}
			}
			from.drawTexture=function (tex,x,y,width,height,m,alpha){
				(x===void 0)&& (x=0);
				(y===void 0)&& (y=0);
				(width===void 0)&& (width=0);
				(height===void 0)&& (height=0);
				(alpha===void 0)&& (alpha=1);
				if (!tex)return;
				if (!tex.loaded){
					tex.once("loaded",this,function(){
						this.drawTexture(tex,x,y,width,height,m);
					});
					return;
				}
				if (!(tex.loaded && tex.bitmap && tex.source)){
					return;
				}
				if (!width)width=tex.sourceWidth;
				if (!height)height=tex.sourceHeight;
				alpha=alpha < 0 ? 0 :(alpha > 1 ? 1 :alpha);
				width=width-tex.sourceWidth+tex.width;
				height=height-tex.sourceHeight+tex.height;
				if (width <=0 || height <=0)return;
				x+=tex.offsetX;
				y+=tex.offsetY;
				var uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;
				this.drawImageM(tex.bitmap.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,x,y,width,height,m,alpha);
				this._repaint();
			}
			from.fillTexture=function (tex,x,y,width,height,type,offset){
				(width===void 0)&& (width=0);
				(height===void 0)&& (height=0);
				(type===void 0)&& (type="repeat");
				if (!tex)return;
				if (tex.loaded){
					var ctxi=Render._context.ctx;
					var w=tex.bitmap.width,h=tex.bitmap.height,uv=tex.uv;
					var pat;
					if (tex.uv !=Texture.DEF_UV){
						pat=ctxi.createPattern(tex.bitmap.source,type,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h);
						}else {
						pat=ctxi.createPattern(tex.bitmap.source,type);
					};
					var sX=0,sY=0;
					if (offset){
						x+=offset.x % tex.width;
						y+=offset.y % tex.height;
						sX-=offset.x % tex.width;
						sY-=offset.y % tex.height;
					}
					this._fillImage(pat,x,y,sX,sY,width,height);
				}
			}
		}
	}

	Graphics._cache=[];
	return Graphics;
})()


/**
*@private
*@author ...
*/
//class laya.ani.KeyFramesContent
var KeyFramesContent=(function(){
	function KeyFramesContent(){
		this.startTime=NaN;
		this.duration=NaN;
		this.interpolationData=null;
		//私有插值方式 [type0(插值类型),Data0(插值数据,可为空)，type1(插值类型),Data1(插值数据,可为空)] 注意：254全线性插值，255全不插值
		this.data=null;
		//=new Float32Array();
		this.nextData=null;
	}

	__class(KeyFramesContent,'laya.ani.KeyFramesContent');
	return KeyFramesContent;
})()


/**
*@private
*...
*@author ww
*/
//class laya.ani.math.BezierLerp
var BezierLerp=(function(){
	function BezierLerp(){}
	__class(BezierLerp,'laya.ani.math.BezierLerp');
	BezierLerp.getBezierRate=function(t,px0,py0,px1,py1){
		var key=BezierLerp._getBezierParamKey(px0,py0,px1,py1);
		var vKey=key *100+t;
		if (BezierLerp._bezierResultCache[vKey])return BezierLerp._bezierResultCache[vKey];
		var points=BezierLerp._getBezierPoints(px0,py0,px1,py1,key);
		var i=0,len=0;
		len=points.length;
		for (i=0;i < len;i+=2){
			if (t <=points[i]){
				BezierLerp._bezierResultCache[vKey]=points[i+1];
				return points[i+1];
			}
		}
		BezierLerp._bezierResultCache[vKey]=1;
		return 1;
	}

	BezierLerp._getBezierParamKey=function(px0,py0,px1,py1){
		return (((px0 *100+py0)*100+px1)*100+py1)*100;
	}

	BezierLerp._getBezierPoints=function(px0,py0,px1,py1,key){
		if (BezierLerp._bezierPointsCache[key])return BezierLerp._bezierPointsCache[key];
		var controlPoints;
		controlPoints=[0,0,px0,py0,px1,py1,1,1];
		var bz;
		bz=new Bezier();
		var points;
		points=bz.getBezierPoints(controlPoints,100,3);
		BezierLerp._bezierPointsCache[key]=points;
		return points;
	}

	BezierLerp._bezierResultCache={};
	BezierLerp._bezierPointsCache={};
	return BezierLerp;
})()


/**
*@private
*<code>ShaderCompile</code> 类用于实现Shader编译。
*/
//class laya.webgl.utils.ShaderCompile
var ShaderCompile=(function(){
	var ShaderNode,InlcudeFile;
	function ShaderCompile(name,vs,ps,nameMap,defs){
		//this._nameMap=null;
		//this._VS=null;
		//this._PS=null;
		var _$this=this;
		function _compile (script){
			var includefiles=[];
			var top=new ShaderNode(includefiles);
			_$this._compileToTree(top,script.split('\n'),0,includefiles,defs);
			return top;
		};
		var startTime=Browser.now();
		this._VS=_compile(vs);
		this._PS=_compile(ps);
		this._nameMap=nameMap;
		if ((Browser.now()-startTime)> 2)
			console.log("ShaderCompile use time:"+(Browser.now()-startTime)+"  size:"+vs.length+"/"+ps.length);
	}

	__class(ShaderCompile,'laya.webgl.utils.ShaderCompile');
	var __proto=ShaderCompile.prototype;
	__proto._compileToTree=function(parent,lines,start,includefiles,defs){
		var node,preNode;
		var text,name,fname;
		var ofs=0,words,noUseNode;
		var i=0,n=0,j=0;
		for (i=start;i < lines.length;i++){
			text=lines[i];
			if (text.length < 1)continue ;
			ofs=text.indexOf("//");
			if (ofs===0)continue ;
			if (ofs >=0)text=text.substr(0,ofs);
			node=noUseNode || new ShaderNode(includefiles);
			noUseNode=null;
			node.text=text;
			node.noCompile=true;
			if ((ofs=text.indexOf("#"))>=0){
				name="#";
				for (j=ofs+1,n=text.length;j < n;j++){
					var c=text.charAt(j);
					if (c===' ' || c==='\t' || c==='?')break ;
					name+=c;
				}
				node.name=name;
				switch (name){
					case "#ifdef":
					case "#ifndef":
						node.src=text;
						node.noCompile=text.match(/[!&|()=<>]/)!=null;
						if (!node.noCompile){
							words=text.replace(/^\s*/,'').split(/\s+/);
							node.setCondition(words[1],name==="#ifdef" ? 1 :2);
							node.text="//"+node.text;
							}else {
							console.log("function():Boolean{return "+text.substr(ofs+node.name.length)+"}");
						}
						node.setParent(parent);
						parent=node;
						if (defs){
							words=text.substr(j).split(ShaderCompile._splitToWordExps3);
							for (j=0;j < words.length;j++){
								text=words[j];
								text.length && (defs[ text]=true);
							}
						}
						continue ;
					case "#if":
						node.src=text;
						node.noCompile=true;
						node.setParent(parent);
						parent=node;
						if (defs){
							words=text.substr(j).split(ShaderCompile._splitToWordExps3);
							for (j=0;j < words.length;j++){
								text=words[j];
								text.length && text!="defined" && (defs[ text]=true);
							}
						}
						continue ;
					case "#else":
						node.src=text;
						parent=parent.parent;
						preNode=parent.childs[parent.childs.length-1];
						node.noCompile=preNode.noCompile
						if (!(node.noCompile)){
							node.condition=preNode.condition;
							node.conditionType=preNode.conditionType==1 ? 2 :1;
							node.text="//"+node.text+" "+preNode.text+" "+node.conditionType;
						}
						node.setParent(parent);
						parent=node;
						continue ;
					case "#endif":
						parent=parent.parent;
						preNode=parent.childs[parent.childs.length-1];
						node.noCompile=preNode.noCompile;
						if (!(node.noCompile)){
							node.text="//"+node.text;
						}
						node.setParent(parent);
						continue ;
					case "#include":
						words=ShaderCompile.splitToWords(text,null);
						var inlcudeFile=ShaderCompile.includes[words[1]];
						if (!inlcudeFile){
							throw "ShaderCompile error no this include file:"+words[1];
							return;
						}
						if ((ofs=words[0].indexOf("?"))< 0){
							node.setParent(parent);
							text=inlcudeFile.getWith(words[2]=='with' ? words[3] :null);
							this._compileToTree(node,text.split('\n'),0,includefiles,defs);
							node.text="";
							continue ;
						}
						node.setCondition(words[0].substr(ofs+1),1);
						node.text=inlcudeFile.getWith(words[2]=='with' ? words[3] :null);
						break ;
					case "#import":
						words=ShaderCompile.splitToWords(text,null);
						fname=words[1];
						includefiles.push({node:node,file:ShaderCompile.includes[fname],ofs:node.text.length});
						continue ;
					}
				}else {
				preNode=parent.childs[parent.childs.length-1];
				if (preNode && !preNode.name){
					includefiles.length > 0 && ShaderCompile.splitToWords(text,preNode);
					noUseNode=node;
					preNode.text+="\n"+text;
					continue ;
				}
				includefiles.length > 0 && ShaderCompile.splitToWords(text,node);
			}
			node.setParent(parent);
		}
	}

	__proto.createShader=function(define,shaderName,createShader){
		var defMap={};
		var defineStr="";
		if (define){
			for (var i in define){
				defineStr+="#define "+i+"\n";
				defMap[i]=true;
			}
		};
		var vs=this._VS.toscript(defMap,[]);
		var ps=this._PS.toscript(defMap,[]);
		return (createShader || Shader.create)(defineStr+vs.join('\n'),defineStr+ps.join('\n'),shaderName,this._nameMap);
	}

	ShaderCompile._parseOne=function(attributes,uniforms,words,i,word,b){
		var one={type:ShaderCompile.shaderParamsMap[words[i+1]],name:words[i+2],size:isNaN(parseInt(words[i+3]))? 1 :parseInt(words[i+3])};
		if (b){
			if (word=="attribute"){
				attributes.push(one);
				}else {
				uniforms.push(one);
			}
		}
		if (words[i+3]==':'){
			one.type=words[i+4];
			i+=2;
		}
		i+=2;
		return i;
	}

	ShaderCompile.addInclude=function(fileName,txt){
		if (!txt || txt.length===0)
			throw new Error("add shader include file err:"+fileName);
		if (ShaderCompile.includes[fileName])
			throw new Error("add shader include file err, has add:"+fileName);
		ShaderCompile.includes[fileName]=new InlcudeFile(txt);
	}

	ShaderCompile.preGetParams=function(vs,ps){
		var text=[vs,ps];
		var result={};
		var attributes=[];
		var uniforms=[];
		var definesInfo={};
		var definesName=[];
		result.attributes=attributes;
		result.uniforms=uniforms;
		result.defines=definesInfo;
		var i=0,n=0,one;
		for (var s=0;s < 2;s++){
			text[s]=text[s].replace(ShaderCompile._removeAnnotation,"");
			var words=text[s].match(ShaderCompile._reg);
			var tempelse;
			for (i=0,n=words.length;i < n;i++){
				var word=words[i];
				if (word !="attribute" && word !="uniform"){
					if (word=="#define"){
						word=words[++i];
						definesName[word]=1;
						continue ;
						}else if (word=="#ifdef"){
						tempelse=words[++i];
						var def=definesInfo[tempelse]=definesInfo[tempelse] || [];
						for (i++;i < n;i++){
							word=words[i];
							if (word !="attribute" && word !="uniform"){
								if (word=="#else"){
									for (i++;i < n;i++){
										word=words[i];
										if (word !="attribute" && word !="uniform"){
											if (word=="#endif"){
												break ;
											}
											continue ;
										}
										i=ShaderCompile._parseOne(attributes,uniforms,words,i,word,!definesName[tempelse]);
									}
								}
								continue ;
							}
							i=ShaderCompile._parseOne(attributes,uniforms,words,i,word,definesName[tempelse]);
						}
					}
					continue ;
				}
				i=ShaderCompile._parseOne(attributes,uniforms,words,i,word,true);
			}
		}
		return result;
	}

	ShaderCompile.splitToWords=function(str,block){
		var out=[];
		var c;
		var ofs=-1;
		var word;
		for (var i=0,n=str.length;i < n;i++){
			c=str.charAt(i);
			if (" \t=+-*/&%!<>()'\",;".indexOf(c)>=0){
				if (ofs >=0 && (i-ofs)> 1){
					word=str.substr(ofs,i-ofs);
					out.push(word);
				}
				if (c=='"' || c=="'"){
					var ofs2=str.indexOf(c,i+1);
					if (ofs2 < 0){
						throw "Sharder err:"+str;
					}
					out.push(str.substr(i+1,ofs2-i-1));
					i=ofs2;
					ofs=-1;
					continue ;
				}
				if (c=='(' && block && out.length > 0){
					word=out[out.length-1]+";";
					if ("vec4;main;".indexOf(word)< 0)
						block.useFuns+=word;
				}
				ofs=-1;
				continue ;
			}
			if (ofs < 0)ofs=i;
		}
		if (ofs < n && (n-ofs)> 1){
			word=str.substr(ofs,n-ofs);
			out.push(word);
		}
		return out;
	}

	ShaderCompile.IFDEF_NO=0;
	ShaderCompile.IFDEF_YES=1;
	ShaderCompile.IFDEF_ELSE=2;
	ShaderCompile.IFDEF_PARENT=3;
	ShaderCompile._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g");
	ShaderCompile._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g");
	ShaderCompile._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%\(\),;])","g");
	ShaderCompile.includes={};
	__static(ShaderCompile,
	['shaderParamsMap',function(){return this.shaderParamsMap={"float":0x1406,"int":0x1404,"bool":0x8B56,"vec2":0x8B50,"vec3":0x8B51,"vec4":0x8B52,"ivec2":0x8B53,"ivec3":0x8B54,"ivec4":0x8B55,"bvec2":0x8B57,"bvec3":0x8B58,"bvec4":0x8B59,"mat2":0x8B5A,"mat3":0x8B5B,"mat4":0x8B5C,"sampler2D":0x8B5E,"samplerCube":0x8B60};},'_splitToWordExps3',function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%\(\),;\\|]","g");}
	]);
	ShaderCompile.__init$=function(){
		//class ShaderNode
		ShaderNode=(function(){
			function ShaderNode(includefiles){
				this.childs=[];
				this.text="";
				this.parent=null;
				this.name=null;
				this.noCompile=false;
				this.includefiles=null;
				this.condition=null;
				this.conditionType=0;
				this.useFuns="";
				this.z=0;
				this.src=null;
				this.includefiles=includefiles;
			}
			__class(ShaderNode,'');
			var __proto=ShaderNode.prototype;
			__proto.setParent=function(parent){
				parent.childs.push(this);
				this.z=parent.z+1;
				this.parent=parent;
			}
			__proto.setCondition=function(condition,type){
				if (condition){
					this.conditionType=type;
					condition=condition.replace(/(\s*$)/g,"");
					this.condition=function (){
						return this[condition];
					}
					this.condition.__condition=condition;
				}
			}
			__proto.toscript=function(def,out){
				return this._toscript(def,out,++ShaderNode.__id);
			}
			__proto._toscript=function(def,out,id){
				if (this.childs.length < 1 && !this.text)return out;
				var outIndex=out.length;
				if (this.condition){
					var ifdef=!!this.condition.call(def);
					this.conditionType===2 && (ifdef=!ifdef);
					if (!ifdef)return out;
				}
				this.text && out.push(this.text);
				this.childs.length > 0 && this.childs.forEach(function(o,index,arr){
					o._toscript(def,out,id);
				});
				if (this.includefiles.length > 0 && this.useFuns.length > 0){
					var funsCode;
					for (var i=0,n=this.includefiles.length;i < n;i++){
						if (this.includefiles[i].curUseID==id){
							continue ;
						}
						funsCode=this.includefiles[i].file.getFunsScript(this.useFuns);
						if (funsCode.length > 0){
							this.includefiles[i].curUseID=id;
							out[0]=funsCode+out[0];
						}
					}
				}
				return out;
			}
			ShaderNode.__id=1;
			return ShaderNode;
		})()
		//class InlcudeFile
		InlcudeFile=(function(){
			function InlcudeFile(txt){
				this.script=null;
				this.codes={};
				this.funs={};
				this.curUseID=-1;
				this.funnames="";
				this.script=txt;
				var begin=0,ofs=0,end=0;
				while (true){
					begin=txt.indexOf("#begin",begin);
					if (begin < 0)break ;
					end=begin+5;
					while (true){
						end=txt.indexOf("#end",end);
						if (end < 0)break ;
						if (txt.charAt(end+4)==='i')
							end+=5;
						else break ;
					}
					if (end < 0){
						throw "add include err,no #end:"+txt;
						return;
					}
					ofs=txt.indexOf('\n',begin);
					var words=ShaderCompile.splitToWords(txt.substr(begin,ofs-begin),null);
					if (words[1]=='code'){
						this.codes[words[2]]=txt.substr(ofs+1,end-ofs-1);
						}else if (words[1]=='function'){
						ofs=txt.indexOf("function",begin);
						ofs+="function".length;
						this.funs[words[3]]=txt.substr(ofs+1,end-ofs-1);
						this.funnames+=words[3]+";";
					}
					begin=end+1;
				}
			}
			__class(InlcudeFile,'');
			var __proto=InlcudeFile.prototype;
			__proto.getWith=function(name){
				var r=name ? this.codes[name] :this.script;
				if (!r){
					throw "get with error:"+name;
				}
				return r;
			}
			__proto.getFunsScript=function(funsdef){
				var r="";
				for (var i in this.funs){
					if (funsdef.indexOf(i+";")>=0){
						r+=this.funs[i];
					}
				}
				return r;
			}
			return InlcudeFile;
		})()
	}

	return ShaderCompile;
})()


//class laya.debug.data.Base64AtlasManager
var Base64AtlasManager=(function(){
	function Base64AtlasManager(){}
	__class(Base64AtlasManager,'laya.debug.data.Base64AtlasManager');
	Base64AtlasManager.replaceRes=function(uiO){
		Base64AtlasManager.base64.replaceRes(uiO);
	}

	__static(Base64AtlasManager,
	['dataO',function(){return this.dataO={"comp/button1.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGIAAABRCAYAAAApS3MNAAABSUlEQVR4Xu3a0QmFMADFUJ1JXM0h3moPZ6qg4AoNeLqAIenFn65jjLE40w2sQkxvcAMI0eggRKSDEEJUDEQ4/COEiBiIYFiEEBEDEQyLECJiIIJhEUJEDEQwLEKIiIEIhkUIETEQwbAIISIGIhgWIUTEQATDIoSIGIhgWIQQEQMRDIsQImIggnEvYvv9IzjfxDiP/XlgJsTcCyDEXP/v14UQImIggmERQkQMRDAsQoiIgQiGRQgRMRDBsAghIgYiGBYhRMRABMMihIgYiGBYhBARAxEMixAiYiCCYRFCRAxEMCxCiIiBCMa7iAjPpzG8fY3kF0KIiIEIhkUIETEQwbAIISIGIhgWIUTEQATDIoSIGIhgWIQQEQMRDIsQImIggmERQkQMRDAsQoiIgQiGRQgRMRDBsAghIgYiGBYhRMRABMMihIgYiGBcGJiOHTRZjZAAAAAASUVORK5CYII=","comp/line2.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAAG0lEQVQYV2NkoDJgpLJ5DIxtra3/qWko1V0IAJvgApS1libIAAAAAElFTkSuQmCC","view/create.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAkCAYAAAC9itu8AAAAdElEQVQ4T2NkwAIWLFjwH5t4QkICIyM2CXQxmAHka/j///9mXDYxMjL6YtgwBDUg+w8crIT8MBQ0oEca55JvWNPS9xgu4tISzADyNfz///8MnrRkgmHDENSALWng9fRQ0DA40xLecglbWhpqGoZCMUNKUQkANAHAJVkE5XwAAAAASUVORK5CYII=","view/rendertime.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAkCAYAAAC9itu8AAABeUlEQVQ4T+2Uv0tCURSAvyNdcwiXBlsaaomWFgeHlqAtCPsDJHwIiUtDSxERtErtmQ6CjkHo4FpDBQ0tbVFR0BYE0eQvOnFF7T17QlOTd3m88873OD8+rtA9uVzOBIPBlIisAwvd8B1QajQahXQ63bIx6QHFYrEEJHrv7qeqZhzHOfYA+Xw+Yow5B+YHoGwymdxW1QAQEFWNAk8i8uEDuZM3gUcLZIEJYNcNqWrVcZyd7p9t8jLwYIFTYBx47UHlcjmcSCQ+B5JtpU0LnAFj3br7kE+yTalb4BCYczVqoT3AjteW4T73FlgFNgY+1IGQz4hPLGCAI2DGbweu2Auw1Vmcqk4C+8DsEOgZOBCR9/6mVdU2vgIsAdOuIVwANRFpezatuahpTYVSop1m+y6pasm8NQqSvvW61KwslkSHuCRkgvErr0taiUXaal1Sr0siWRO/9HfpF+RN9nfpB/qqmrXrv7mktVhYVm5GLo1cct9LI5e8d84/3UvfAgdlKH0EO7MAAAAASUVORK5CYII=","view/cache.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAkCAYAAABSSLCCAAAAcElEQVQ4T2NcsGDB/4SEBEYGBgYGYtmMxCpENhhsA6mA8f///5tHNTEwkBcQpIYcSD15kUtWigi51vR/jVYdOGUQy2YkViGywWSnvTOkhiAonkY1gZIRqSEHTntkRe4g10RWQIyWe5Bgo2O5R7dkBADztyP+yFzirAAAAABJRU5ErkJggg==","comp/clip_selectBox.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAoCAYAAAAIeF9DAAAAsElEQVRoQ+3ZQQ0AMQzEwAuqEgh/Sj2pKObhIrBsrfLonHPu12MMTEGYFg+kIFaPgmA9ClIQzQDG0w0pCGYAw2khBcEMYDgtpCCYAQynhRQEM4DhtJCCYAYwnBZSEMwAhtNCCoIZwHBmd/tTh6IUBIrx/tRbiFWkIFaPFoL1KEhBNAMYTzekIJgBDKeFFAQzgOG0kIJgBjCcFlIQzACG00IKghnAcFpIQTADGE4LwYL8U/BE1dCJ3PsAAAAASUVORK5CYII=","comp/label.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAASCAYAAACQCxruAAAAmElEQVRoQ+3aMQqAQBBDUef+hx4Zq1mrbPnhWylECHmghVZ397OOqqp97TlugdNzgEXFIaaFuwROt0LmBEay5aXb920+FjIpMJItLy1wvhUyKTCSLS8tcL4VMikwki0vLXC+FTIpMJItLy1wvhUyKTCSLS89wPP1Qeh8M0zy+84gMMbruqjA15OxbtjAu7mPa5bj0fb/A8cLgD4n/wQKNiIAAAAASUVORK5CYII=","comp/clip_tree_arrow.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAQCAYAAAArij59AAAAwUlEQVQoU5WRPRKCMBCFWUt6vYQeB06RUDpoBbFDa7yDwm30FGi9dHnOMiQDBgvT5c3b7+0PRVEUlVV9A3NmzL6T//SRfMz5CgCdtVafjlmzaHAigAbM2tE8YVo1pf0yvABoc9D3wACgBbMKIgD4qqDJsqqlMV8VGL5n/88geCJKlijSMBXFZUNx/CSi9WwX1r7R99thzKKqkxXRbMUWSE2u2sEwHsxHCbrMVSq6N4xRD9HAvJstylEkarhurlqnfQC58YP5+CvQNwAAAABJRU5ErkJggg==","view/bg_panel.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAMUlEQVRYR+3QQREAAAjDMGZk/l2CDD6pgl7SduexGCBAgAABAgQIECBAgAABAgS+BQ4oyStBhXcy5AAAAABJRU5ErkJggg==","view/bg_top.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAMUlEQVRYR+3QQREAAAjDMKZp/rWBDD6pgl7SduexGCBAgAABAgQIECBAgAABAgS+BQ6WyDMhXMLeQgAAAABJRU5ErkJggg==","view/clickselect.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAqCAYAAACDdWrxAAACfElEQVRIS8WVO2iTYRSGn5OWqpMOurg0VRBdVVCsg7GgDjpZECyirl4GEYfSgBlaB5VSpApdxCJIoeKgg7dKC21ALahIiyiKKUjxAiI4qCH1lRP/hPhfAnHpGZPv+c4573nP95ukO/xHmINmtq8RtswsPiipB/gAPAFem5nCbcSWKukIsD84/A2YBh4DL8ysWLkk0qOkDcD5GLF+Ac+Ap35ZHGjAdWB5gtJvgZFYVSWdBHaFwBlg1Mw8K0ngFiAbAm+a2XBij/6HpBbgBrAEmAVeAZ1AFU40QDCWrcBZL0/S4Vq4HtgB7DWzU5XyauDBMhhWz70ryVVdb2ZuhGpI2g1MODjfiMFrxZk3s9WNwJ6snHFxQUlXgXfAPeC5mf2O2Y5oqZLcMceCw1+AseCSSTP7mSiOpM3A7RixfvgYgAd+WUQcSSnfPWBlgtIvgf5YVSVdBA6GQF/mS2bmWcvbERmHJF+payFw0MzO1TWApKXBViwL3h5/Pk4AVTjRAMFY9njJXl6wLccrcD3wAHDUzBwuRw18JtbkbkFJruomM7sf2o4u4Jals/mFRgxeFcfBQm97UyOwM+WMiwums/k3QnMps+HWpuLIRC5TCrcRW2pbT35MRiY4XDRsVmiU5uJQIZfxb0k5Ij229eQPySJ287MLGO8Rd1M0XY6AO3LjzYVSy3fAH+VICL4a6o9VtTWbnzbYGKI+IrtQ6Ns2EFuq/5jOTnWD9f4DikeFvvbqhyg2Yzo3voJSy2fAjfEJMYPRQQ2caAAfC7AW2WkvrzU79dCwnRW4Hjgg6JrrbV9VKbkKw1Csyd2Ca7on1y2krHOub3t16//2n79SarbsH7BKtfejoCjmAAAAAElFTkSuQmCC","view/resize.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAqCAYAAACDdWrxAAABeUlEQVRIS+2UvUpdURCFvxXRKJpIEBURsVAIiiBoaaGCjY2VLyH4MBaCPoWlnQlpI6SxsQmkURQL5eK/6JK57iuRnMPZtxAkuOFUhzWz96xvjcg8tluAT5LOQqJMHba/AgPAD0nOEtruAOaB6Lon6U+ucAoYTLe7Bb5XCm1/BCaAXqAVOAHyOkYn27PA5/TGWmXHxvBeT2i7TVIM4MUp7ZhGPlY3V/pVKUxEjAIjyac74LIAjK70PwCoyfYXYDJwyqDoHtiRdFOfql0naBgIrILF/ZIi1yH6h1XbYXCPpKOq7s34GEX7JB00m445YBzYlPSQ1dF2N7CaWN2W9DNXuJxAj1uGVeuVQtvh32LyuR34DexWCv+CfAXoBzYkHb8Boe1OSRcFkBdfNY18IQiUtFUpTJjNAPEFHVfAaQFyjZ3zNBzbQ8BSWkZViEbk1uIpjXR8AKbT7jwEvpVUqEk6L0pHLN5hSWWxeq7XjI/v6Sgz0vZ7Ov7DdDwCkcb1m86tSukAAAAASUVORK5CYII=","view/clickanalyse.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAqCAYAAACDdWrxAAAC7UlEQVRIS5WWT2hUZxTFfyfGFolkoUVKrHQiEaX+IfgHa54UQzUqpWYhLbQU6ULNwgYXuog6yiiTgK2LgtAu6yqbFkpRBEURQzJEBN200NqKkxoDLnQhFUrizJU7vje8SSbzZr7FwDy+c75z7z3nfU80uMxMDin9JC0zewvYAHwIrAH65wWaWQuwOdy8CVgUHnBd0sUKoJktBbYC24B1QHMVNeck3ZWZrYhtXpUg/3/gS0kzDnT2/cDqpFqBUUnnK5pjZutDgo01Tr0g6XbVrprZypBgO9AUU/EK+ErSyzLQzC5XkTkCfBR7fl/Smeh/qasOlPRp9DAkOgp8H5P9o6SriUAnMrOzgNdswNeSntcL9IYNAQ8kHYuXU5Y6u8ZIupldAO5I+nkOsNb8wjk/ljTZKFCSvMbSMrPSiOpNx9uAz3UP4IbfWSsdrcDH4eZuYHF46LCk47PT8S6wG9gbJmRhlfoPSLrhJvdERJs7E+S73dZKmnagsx8JB50UEHdY3+x0dIUEO2qcekTSr/OlY21I4N5dEJMwA6yX9CKejqkqGn8DemPPb0v6YrZXpyS1xYbsRD3AtZjsk5IuJQKdyMyGAa/ZnbNR0tN6gd6wXwAP8SfV0jGnxki6mV1xyf4ubdTkPue/Jf3TEJCMNZFRMQLtyNwqvaTrSkdHZry1MFM8bLLPgY5U8/SyeYHvncotb5b1A/t8c2QGg3sT2WBLBbD95PiGogr9Ej0Gbap8r4ZJ5kR+MPhW7WdGd5npEFaa15IE+YWW5uklf2S6/1N7OnfasG+Ad5KiAfyVzwYfVDQnlc71YTaA8Ntrvtq/y2eDgapdTZ0a60UMhjdvmcCgWDClJge7npSBqfRYYY5M6U/M/NqO1mQ+G7xf4VUH5rNBOXtviLQfzH0afizop0fZroOJQCdKpcfyUKrZFhTpfDgU/F4nMNcH9gPwLJ8Nls3xarUaI+mp9NhTg5GJbPBZQyb3OReayP17rutmHPga1PpCOk+zrlEAAAAASUVORK5CYII=","view/res.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAoCAYAAAD6xArmAAADwUlEQVRIS+3WT2gcdRQH8O/b2SwNC7l4MAEPvbilUkoPOUmLjSDrZn4hxYKH/kGwyB4tQogiu/N+GymyoWguhVBQKKkHQTHsW9fUQwqKp4AgtMXkInhILl4CkoTdmSe/6XZp2pntLli8uMedt9/3mze/33yW8Jw+9Jxy0TeYmV8FcFVVTxPRiwA6AP5U1TvZbHapUqn8nrawxGBVJWvtNVWdJ6K05h1V/dhaW08KT/wRM1sAVQCRqn5JRLdyudw9Iora7faJKIrKqnrBNSWiahAEC0+GHwpm5utEdD+KopsuBMDbzPxt0oqstRdV9Za7lslkzlar1Z8erzsUHATBJhG93C34fmJi4ly5XG6nzTEIgjoRzanqkrX2amowM98F8Fq3wK34PWb+Ii14cXExv7e3V6hWq78+axQrANwt/kVEl5j5h0G2IzMfUdWCtfa3R/VPzvhTAG8AOM/MfwwYehTANwB+ZOYPE4ODIDhJRJvMvD9IqLW2GEXRbSJ6AcBtZr6UGPzoS2Y+lc/nt+bm5v5Oa2CtvaKqywC8bs06M7+eGszMn7nTBqDOzPNpwcvLyyPb29vfAZh2Naq6Za0tpAbXarUzURS53eGKL1trv0oKZ+a3AHytqplMJlOOoui4tfaDvqOw1lZUtabubBOtqOqN0dHRB/v7++62XwHwDoB33dkAUGPmoO92e/yitXZeVT8BkE1acbdpPQiCj4hIBw52hQsLC8c6nc77AN4E8FK3yQ4R/Qzgc2b+Je0ZDPU+fjiZp1eXFD5U8CB7u+/DGybgXxnFMA3/m1GISGwegNMAeuYBuON53lKpVBrePBG5RkTuSPc1b2ZmZnDzRKRnHoDYvIODg3u5XM69/E8AKAO40G1aNcb0N6/ZbF5X1fsAbjpInXnGmETzGo3GRdew+0DPGmPSzRORTQA988bHx89NTk6mmtdoNGLziGjJ9/1085rN5l1VPWSeMSbVvLW1tXwYhoXp6en+5olIbB6A2Dzf9wcyb319/cju7m5hdnY22TwRic3zPO98qVQayLxWq3U0DMPYPGNMsnmrq6snx8bGNqempgYyT0SKzjoAsXnGmP7mNZvNU9lsdqtYLKaaJyJXABwyzxiTbp6IxOYRUd33/VTzNjY2RnZ2dnrmAdgyxqSbJyJnAMTmEdFl3/cTzROR2DzHk6qWiei4Maa/eSJScZY99FRXPM+7MTIy8iAMQ6/dbsfmEVHPPGPM4OaJiBtDqnmuqfuL4Pv+8Oa1Wq1jYRg+ZR6A2DxjzP/mPRupfwAf56Q4urCh6QAAAABJRU5ErkJggg==","view/tab_panel.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAABICAYAAADyMAW8AAAAcUlEQVRYR+3WsQ3AMAhE0TCMeyTvP1tShRQo7lxYegxA8fUPLuac97VhwuKXKhTlFxRQ9GPDClawYvGEDwxIZu7pFRZXr4ACinY1ghWsYMX/NxWQr22edyvGGHt6hcV1NqGAon8QVrCCFYteISDnBuQB3xJuQcDkEngAAAAASUVORK5CYII=","view/btn_close.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAYAAACz+XvQAAACmUlEQVRIS7WWS0/bUBCFz7mJmyZxENm06mNVoVZC7LqGn9FNqy55/BSWSEhs2/4uuqFVoA150JLKJvGdaiIH2TfXNoKQpeP5PHPO3GMTK/5xxTwsAUWkBeBZ+qAByb/Zh4pIA8CL9NqY5Dj7vw9YA/ABwDsAfwB8ITnUIhF5CuATgNcAfgH4RnJSCkwLl6AA/lXBtLZQQxFxoTr6q6LOFl2WmuJAtcY7ZuXIixsczfRyTlPfhpSN7BpwBeBtFdQLFJE2gI8AXi7GBBBl3Fdnv5L87XbpWxuFfQbw3NXM0dQLLdrDIH3ylGTiLLYB8CS9lpCc3tmU+xzL1Z9lEXl/n06KavjowCiK1uM4fqMd1Ov1s3a7fZntZjabtSeTiQYHgiC4aLVavZwpbofT6TQYDAaH1tod3bMwDHc7nc5PLZrNZmG/3z8WkS1jzGm32z1oNBqjUqD+6YM2m81xFWyeNkUaulAAlyKyWdTZbdqUmZKFakEVrLRDV7P5zY6m3rQp6tA1AMC5tXY7he51Op0fdwbGcdwdDodHWc2MMdcL9wGM1tbW9sMw/L6UNm6HChuNRifW2g1XM0dTL3TJZS1KkkTDFbVaLQqCIJcm6k0URRpxuvg39Xo9rtzDh5zt1Z/lXq+32rR5dKC1dt0YM08bAGd65BxN1ZB52ojIBcl82rgdWmsDkocAdgDoW22X5DxtSIZJkhyT3AJwCuCAZD5tfCP7oMaYcRVs/tAiDT1QHX2zqLPbtCkzxYFqjXfM3GKXAR3NtC6nqTccioAeA84BbCuU5B4Af9r4gCLSBXCU1UxErjPuj0Rk3xiznDYuMIWdANhwNXM09UKXXNai9LtQ9y4yxuS/XUijr9L0lXBDMp82j370HhJdWvsftiHJYFPSIqEAAAAASUVORK5CYII=","comp/combobox.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAABCCAYAAAA476rKAAACfElEQVR4Xu3bMYsTURQF4PMmExgIWkgEU5hskyJYxGYKY5VS7NzCylL8Bftj3NbKQjuxTBWbaUwhKdIYLCJotlACA5m8kQTZZZkkeN9dbuNJOXPPu/DN5ZHkMa7dbpfgx0TAEdvEedeE2HbWxDa0JjaxLQUMe3HPJrahQECrNE3RarUOJheLBbIsq9znZAdgJ0mC4XCIer1eSa/Xa4xGI+R5TuwA272RTqeDfr9fuTeZTDCfz/dmONkK/cFggGazebnCcrnEeDw+uCKxFdiNRmO3nURRBO/9bvtYrVbEVpgejXa7XfR6PUynU8xms6O1nGzlU3DO7fbu7V5dlsf/0yO2ElsSJ7ZES1lLbCWgJE5siZaylthKQEmc2BItZS2xlYCSOLElWspaYisBJXFiS7SUtcRWAkrixJZoKWuJrQSUxIkt0VLWElsJKIkTW6L1t5an6wFooRGerofKBeZ4uh4IFxrj6XqoXECOp+sBaJoIT9c1esIsT9eFYFbl/J5tJc13agyliU1sWwHDbtyziW0oYNiKk22JfXJ6xnfXjcDdFttnb43a/b9tovQ5iG30/IltBL1tQ2xiGwoYtuJkE9tQILBV/ugl4rh2MF1sPJJP59fuc7IDsTe37mHz8Bki+MoKHhFqn9+j9vs7sQN9K7G89xRx837levHzG5Lph8p1TrZK3iF//ApxdLVI4YFk/BpA9Uc5sVXYwObOCfyDJ3AoUcIh+vIRtYuve1clthJ7G8/7p4hv30Xx6weSybuDKxL7BrARxcjTF0iyN4AviH0Tpto1ONlaQUGe2AIsbSmxtYKCPLEFWNpSYmsFBXliC7C0pZfY2oWY/zeBP8uaLni/AFTVAAAAAElFTkSuQmCC","comp/textinput.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAAAWCAYAAACv8OArAAAAZElEQVRYR+3UQQkAMAwEwcZI/LtsoSL2NTGwMByZ3b3HJQIDO3H+EdidNezQGjbsUiBs+dmwQ4EwZdmwQ4EwZdmwQ4EwZdmwQ4EwZdmwQ4EwZdmwQ4EwZdmwQ4EwZdmwQ4Ew9QBe0R29X9x+dwAAAABJRU5ErkJggg==","comp/vscroll.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAhCAYAAAA/F0BXAAAAOklEQVRIS2N8+OzVf2YWFgYmJiYGcgHjqCEYQTcaJpipaTRMRsOEmDJmNJ2MppPRdEJMCIymE2JCCQAYonwDuu2VMAAAAABJRU5ErkJggg==","comp/vscroll$down.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAzCAYAAABxCePHAAAC/klEQVRIS+2WS0wTURSG/zszBcrLFVvjio0LiAqRRDAmGpRodFE1MQQQkOKGqBujRo3ExLjB4MaKgDzUaGQhvoJGYwAjYoioERcuDGxYEIwPkBY6nWvObXuLnXZaSklYOIu5M/fxzZn/nvPPsInJKa5qGhRFQaIH+w8xSbcymtTd+gBFYXAdyjM9sf7ORxgGR0t5/j9jpkhq2t5B0xQwBrgqNsnJ9V0j4BzQdQNtNYXWkKz0NDiaXkBTFTCFoaWmCHVtQ+AGh+4z0HNiO2bmPNYQGiXQvkuPoaqqiIgi8Pl8eHBqtwlA86MKS6Cy8z1gjIFzjqcXHBEBlpBgRNuOd+HVlYqogJiQIChcg/BtW5k8SaSSkxPJ5PRPTttHfkI7kcghIpn8NYfp33NLXp+TnYG1OWvA3ox9499nPSjdkCsgHJxOIjc43VMrugL9dEUD4Oj/PA4CsUfDX/jOjbmisHTDCCzi4t4QgLDrQF+qTYOmqhgYGw9BvLpv0ZNjQwieaU9b7ZCDriFhSt3VBSZNartHA6aUJ7SK+jqO5n5pSp1HiqSw1e3Di0ypwBpiU1XsudwnTanraDEqrg2GmZLbGkJh2jQVZY29JlPqPe03JX/uxLE7Nk3DjjP3pCn1Ne7HrNsjdYoLQsmWYtNQ3NCBgeZKzLrn/foEoogbQgvSUmz4454P7VQikGhpHzGSZdVOUqqYTGli6gemZ9yJ+0lSTalk/TrxtQOYaBnESbTinokev4UG+p+9/xoyJQKQn8x7vf7JjEFZ1FJBBvuC12RINIdAwtkIQuksnxgHhKBUZ6scQtLSNyiWJpav47z9STjbjfJ8k5iVN0eEs911bhZjUTWpbR+RztZ6uFBERNCq1rfS2e43lFhDsjPscDS9lM7W4dyCquuvpbM9PFkq0iHm7mSl2yP+bj05uxdeXZe5FHOL6Xdr17nQ79bziwew4NXFqwUTMiaEtKBPwtZjnRi8WgXPglfqsyQITc60pwpAeNpH1GRZtRM0pWVVcTJM6S+dYaRsIf025wAAAABJRU5ErkJggg==","comp/vscroll$bar.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAA/CAYAAAAGyyO8AAABYElEQVRYR+2Wv0sDMRTH30tarCg6dRWnQnFT6OiqoP+tk+Cig+AiHayDiNSlg+jgD47K1US+Lwm5s4o/mkElN1xy73KfcF/efTi+Ht3Y0X1Btw8FffdoLy3QSnuZ+HhwZe+exrS13hGGJYsTWSszN0rJ1zHDDbJ0eDYkgHjv5Nxub3TIGEsTY/xDVq6NAN7MfW2u2aCG1nQ0GEZIOXmp7Pw5BPDF+VaGIGQfbM6k0ng5kw8/wF/eJzP5JInZkjg2CSS8zk6vCys7Wb8r5qqsncAP+pdR1Lu9rvgVT4uYg+3F+PCtAzjzu/taKdKKBSS2/wkEMBg/Q+rB50zqzZb7ZPoD/GeZ1HySxGxJHJsEEl5nc22VmCFalpFJTjLKNUtFxlDfP72IogYAP8PPZekWM5OqjErFWpjjbxprABJRA/JYjOOOX4Bgo6bWGYKsfMg5k+lmy5n8uUxm8kkSs6Vw7Cstibc9Fv5vWQAAAABJRU5ErkJggg==","comp/vscroll$up.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAzCAYAAABxCePHAAADF0lEQVRIS92WTUhUURTHz31vPv0KKmkXrtxUGNomkCANLdCUpEatJFuIClIEFRl9kGH0BYWQElLpotGKEJXAtKQooYUFpi1axLQZMCyyZJqv926cM2/uTM288emoUHfx3v16v3fuuef+72Hume/c7/cBAwaLKWaLBZjLPc0Zk0CSJGBs4SDOObDP7i9ckuXkIbLJRJDFFrJk2SGNvZNwy7ExoZEJLWnqfQ+4SlUFaHNs0gXpQhq6x0GWGe0Y7oCicGivyYsLigup7XgFJlkCJjFwNm2HqrZR4CqHoKLC3fr8GFAMpPLqEJhMoZjpay6Bnx4vpKfYoLx1kCwKBlXoOV78BygGsudCH1nwtNVBgHBBUFFzL1n0+Gx5YghOxhINiAbFG1uZODESxf+bJShKrulv8HUusp1G/IBz1qTZIGvdamBjU584Aopzs+lbDhwfFFgc2/imLq0fazgAHF5MumBtuh3YwJsPfGdeNqgY1qqqfcSprRLgr7rWZzWbwCTL8HLKFYEEgkrUn+eHIDzNbltBSG33O+jcnxNZmrYcw5Yc7hoXotRenRPyz0IgBzrGYkTp9qEtxiEV10eEKD08Wgh7bzwTonSvIV/soK5jd53rE6I0eGY3/PL5wWYxQ+nFgShRKqK6LqTwhJNEafRKNQHCcWK3WmDHqR5NlMoSQzAWUV+9vkBMsKXYLCSbs3Oe+SGqqupGrIL3h3YclifYkjo7yZ7izIzUUGrhnvXAzA+PURkR8xCwPnMVsCUVpW0bsiCUKOH9S0980JvaLJSQUTal9Q+9/RgRJQSgnvgCgdBkxkCKektSpC9cR0HCOQgiZUMI3njijwYg+COzLP9rkLr7E3Dn4Gbhp7BPDC+n0TkhlK2zJpccuSBIfVdsutVdt9U4pLbjtVC2B0cKYN/N50LZHh0rFGGguztV14aFsvWfLiVhSrVboaSlXyjbk/NlBNKFVLT0k7INX3KAx+sXfkBlKzjpJItGLlcmhmSkptAB83h9MTuCICxBRUkMwUmY5+uFPY7LmJ7GW05SZycsSos9xUsmSr8BfgGeWI6+BgEAAAAASUVORK5CYII=","comp/button.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE0AAABFCAYAAAAPWmvdAAABA0lEQVR4Xu3ZMRGDUBRFwXwfKSgxFhfRgAbUxEakkCEO3qmX+p9m5w7NW9v7cz18I4EFbeT1fwxtbgYtmEGDVgRC458GLQiExNKgBYGQWBq0IBASS4MWBEJiadCCQEgsDVoQCImlQQsCIbE0aEEgJJZW0Pbj64Q3hFvQhmL3CQ8atLlAKCwNWhAIiaVBCwIhsTRoQSAklgYtCITE0qAFgZBYGrQgEBJLgxYEQmJp0IJASCwNWhAIiaUVtOfrdMIbwi1oQ7H7hAcN2lwgFJYGLQiExNKgBYGQWBq0IBASS4MWBEJiadCCQEgsDVoQCImlQQsCIbE0aEEgJJYGLQiExNIC2g/MxaMp6CSauwAAAABJRU5ErkJggg==","view/bg_tool.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAMklEQVRYR+3QQREAAAjDMCYG/DsEGXxSBb2ke7YeiwECBAgQIECAAAECBAgQIEDgW+AAAeIuAVS/mngAAAAASUVORK5CYII=","comp/minBtn.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAA8CAYAAAB1odqiAAAArUlEQVRYR+3X0QmAMAwE0GQN19B9nM193CmiIH7ZXOAoRc/fpjl8jVDdOj/eOc8USBcXqUjLAtDQRMSOdHb3JatTYCZUXodIy10bGxTI1Lx6/YA0Ima6W2tKFcjmdpGKtCow7NBAdxozy+804Gfx/cDqbLzWDzs0ekNY4B9nOMEehMKTVIEEyKeFSKmc18+MppRtipJuYPCa1SkwEyqvo6Tlxm8bFEijvBt9n/QA/fOPydLHcUIAAAAASUVORK5CYII=","view/zoom_out.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAoCAYAAAD6xArmAAACy0lEQVRIS92WQU8TQRTH/28oQkj0CL0QOMAJQkz4DkS6A+GA+A00Hrhj0uy8NiTwEdBPAOrB0Fnq3U8g6gkOSjxUjpCQCu08M5u2qaVAt7YmOqfNZPa3b9/+Z35L6NOgPnHx98Gbm5sTlUplA0AGQBpACcBBKpXazmaz3+5607YVM/MjEXlNRPdbASJyTkRrzPz+Nvg1MDNPAvgI4AGA10qpvHPuSCk17ZwLAazV4HPM/PUmeDvwSwBPAbxl5sf+RmYWZo7XMvOehwPYYebnScAnAMaVUrNhGH5pBefz+Rnn3GcAJ8w8kQT8E8A9AEMA/HXrqM9fMrO/bjvataJvFdd7/IaZfS9/67ExZpeIngB4xczPklQ8KSKHPmoispdKpXKjo6PHp6enU5VKxXhoV6moVXhnjpVS5wDOwjD81K7qG7e033lXV1cviMjvvDEAP0TkYHBwcKtarT4UkXcALolo1RhTaIV3dVYYY9aIyOfZDw9fMcYUm+FdgWvtYgCmBisrpRbCMPxQh3cNbgM3zJzvCdhDcrncuojMA8gy8/eegTvO8U0Lk87/UY9ve9h/BI6iyJ+1GyLScB4RHQDYDoKgO+dFURSfFQCuOQ9A7LwgCJI5r1gsTlar1YbznHP5crl8NDw8PK2Uip3n4QMDA3OLi4udO89a23Ce1jp2nrVWtNbxh7bWxs4jop0gCDp3XhRFJyIy7pybXV5ejp3XDN7f359RSsXO01p37jxrbey8i4uLoZGRkWvOa5q/1Fp37rx+VtxwntY6dl5zK6Io2hWR2Hla686dV0vFoY+aP8xFJJdOp49LpdIUEZkaNHkqfIWd5JiIzkXkLAiCZM7zO09EYueJyBgRxc4joi0ADeeJyOrS0lJvnBdFkf8xbDhPKbWSyWR647xCocC+53XnAVjQWvfGeS1wo7XunfOstesA5pVS2Uwm8w877xeHf444cscwYAAAAABJRU5ErkJggg==","view/refresh2.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAA/CAYAAAAPIIPGAAAEIElEQVRYR+2XTUhjVxTH/+fGpBrGT/xoBQdFFMMQLNLNbLooLbaFzqKMUhCSZwsuhGG6KCNd6DuRLgqzmGVxUd8LUrpoYWZTKO1yNi2F1oVtceEHflSLqNEav8bklPuqgsl75sUPSsucTQj33v895+R/7y+XcA1B16CJ/6GoYRiDItKfzWZjExMTv5/XtoLlx2Kxm0qp1wH0AHgTwC4RfWRZ1mdewp6ig4ODN9Lp9CMieh+AchH41Lbtj92EXUUHBgaCh4eH3wJ4zSObGSLqtSzrZ9+ihmF8CODR8YIflFL3MplMNxF9IiJWIBC4Pz4+/ldR5RuG8QuAlwGsAWi3bTsVj8dvAWhOJpPfFPK2a/mGYewDeAHAV7Zt9+aK9PX1VYRCoVcApNxa4CX6J4B6AE9t2341V9QwjO8AvAFg27btytxxL9EvAbynJxNRj2VZX58sjMfjd4joyT9D9NiyrHf9iup+/gggBCALQPfxVwARAO8cWywD4LZt2z/5EtWT+vv774rIBIBSlx/mmT5dyWTyC9+WOpkYi8XalVIPRKQbwItEpHv9PRE9tCzrt6IsVcgyhcYLnv1CAkWXfxFBxzEXXXipq+8imz7P9CJdO3+N754y86A+vYFAIDY8PHw58DHzTQB54DNNs3jwMfONY6R4go+Z/YNvbGwsuLKyci74APQys3/wMfMZ8InIPaVUt4g44AuHw/eHhoaKAx8znwEfM6dGR0dviUizaZoXA59pmvtE5ICPmfPAx8wVABzwubXA1VLM7IBPRJ4mEok88DHzKfiY2R/4mPkUfCLSk0gkTsHHzHdE5Immnog8TiQS/sDHzK7gE5EIEZ2CTyl1e2RkxD/4TNO8S0Su4BORZ0qpftM0iwefaZrtAB4QkQM+AA74ADxk5ufgc78CfV99xdy61yMajUbfAvA5gJeKycZj7gqADygajf5xRYIn+6xoUbmCDM9I/LuidXV1qK2txdzcHPb39ZPAOwpmGgqFUFFRgerqauczm81iaWkJa2v64eLhU6+eKqXQ1NTkZOcWq6urWF5edh1zzZSI0NbWhvLyctdFBwcHmJ2dxe7urn/R+vp6J0sd6XQaCwsLqKysRGNjI9bX17G4uIhMRr8jiig/EokgHA7j6OgIU1NTjkBZWRl0f7e2tgo60LX8rq4u/UjC5uamU2ZuBAIBZ1O9mVsLXEU7OztRUlKCnZ0dTE9P54nqfmsnaNHJycm8cVfRlpYW1NTUOJN1pjrjk6iqqkJra6vzNZVKYWZmxp+oLq2jo8NpgQ7dx729PZSWlkKL6hARpwr9Q+aGp/m12Zubm6H9mhtacH5+HhsbG/4tdTJTZ9bQ0OD0LxgMOm7Y3t6GNv55R7XgMS3oH5cJ/y3Rq775V3X5bx8zSv8DuWzoa2vgb5tumbHGlerDAAAAAElFTkSuQmCC","view/settings2.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAA/CAYAAAAPIIPGAAAD2ElEQVRYR+1Xz08bRxT+ZjAGYQoH4rS9IBJBQJEsUC8VKNdQtamUE0fLayqhKHeOaGbFkT8gFVLZtXzk1qqKSs4NUg8RXCIQVoOQ2jRFHHCwBRj2VW+zttY/14BXVaPOyR7NfPN9771536xACEOEgImPDHRhYaHv/Pz8kEMVjUbjq6urxVZhayo/lUo9chzndTabfWMYxkMAGx7QrG3bL5LJ5B0p5f1MJvNz7QENQdPp9LdE9CMAZrcHYAaoxJ8AvARwD8AtAI9t2/7JD9wQdH5+/q7jOLzx04DqeCelnFlbW/s9EJQXGIbxq8eQ//4mhPieiJjlEwBf8qQQYtOyLFZRNeqYJpPJWCQSeUBEzz3JrwqFwvT6+vo575ybm4vGYrFNAF8AICnlbKlU2sxms4Uych2oYRh5AJ9UFggxb1mW5aeSTqfTRLTmm3tv2/bAVUCfWpb1zA9qGAaHwD/XGjQU+WVGHU0Ug4ZSUjXFnwMwXVP8nP1RAPG2i5/Z+q9pKpWaFUL8wvNE9FUmk9m48jWtLWavofztNZTb124oN2neH1mTvmoo/pcfHDGtdZ9nLbw4rrW+nvGZpvlISvl6aWnpjWmaD4nINT4hxKxS6sXy8vIdx3HuK6XaMz6ttWt8QohDInKNTwjhJtWzlJdCiHtEdEtK+VgpFWx8Wuu7RMQbWxofEb0TQsxordszPq11Q+MjoidCCNf4AGxqrYONb2VlJVYsFh84jvPck/yKW5/W2jU+rXWUwdj4OBQcYzbCxcXF5sanlMoLIaqMTylVZXymaVYZHxG9N02zufE1AH2qlKoyPqUUh6AyFwgaivzyVehoorxkdL6k/MUPIEdE0/7i5zcUGx8Rxdsufmbrv6ZKqSrjM01z48rXtLbFeA3FNT4At6/dUIJ7V/MV/6HOn0gkvgbwA4DPbyLZ2/sWwHcikUj82SHAMqe3DMrv+I6Ofw9USonJyUlXzfb2NhzHaamsKdPBwUGcnp7i7OwMAwMDGBsbc4H29vaQz+fR09OD3t5eHB8f1x3QEJQBR0dHcXFx4QL39/dXbTw5OXEBI5EIcrlcHXBDUGYxPj6O7u7uljJLpRJ2d3ddNf7RVD6DlhkWCgUcHrof0YjH44jFYu5vnt/Z2QmWz0lhsHIMi8Wiu/HDF6T7mMDExAT6+vjR8iHGHA5/8uqYTk1Noaurq3L6/v4+jo6OqtgMDQ1hZGSkMnd5eYmtra3K/0DQg4ODivTyLg7B8PBw+6ChyC8f39FEMWgoJRVK8TPbjl/T2mruWEO5SYMNo/P/xaDfeB712U3YeXv/ALDwD+TbY8Dbd9BBAAAAAElFTkSuQmCC","view/setting.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAkCAYAAAC9itu8AAACAklEQVQ4T5XUS4iOcRTH8c9xCeVeiiiXhSJRJFIusRO2lEtZKFlgY6GxZDUrk2TFwii22JJLlERRLKRQJmXBkHIb8+hM/2d6ememed93957n93v+55zf9/mHll9VVTNxopTPR8T3piTyT1VVs7AL9zEd+4roOn5gK25HxLfacAjL8A8TWw6ta28jorc2LMLhIu7Ds2Jah4XlRVci4mNUVTUDadiLFF/G5GL4iyOYjxsYMnQ1BDfxujk0VmJPecFAO4bV2Nk05Bqzz3Za6ut86JJDx2vN4Hbj3hjBbcOt4eCaQZXUj5daT4pGoNFimI1zpdYVEf2jsTQX+5MX5NaOFdFFJHzJ2bWI+FJv6SRWYACTWliqa68ioqc2LMWpwtJ7PCymzVhSWOqOiHeZdPachqNIcXdBJV/2B6cLa5cwZLjQYOkqnuNsOeEM1uJgE43xDBsaH9QQfJ21VNBoHfpBaWHLiKGLoeO1ZnAHkpcxgkvOeoeDa0FjTnNLEfF1PJamYkcR3YmIX6OxNA35Kb7BFKwvoqf4jeV4GRE/azQ2Yh4GMaGFpbr2OSKe1Ibse1MRJ84fimkxMqc0Pc55MrjsOYvZRoofNW6/vPUSwEQ+2+tPQ14h9fX4Ap+aQ2MB1pQTB9sx5K24qmnorKWCRvtDF0PHa+0suBaW0ry91O5mus3n/wHmQwUTIH+tVgAAAABJRU5ErkJggg==","view/refresh.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAkCAYAAAC9itu8AAACiElEQVQ4T4WVS4iPYRTGf4/7/X6XcivXcktEUhTKQkqyYCOKjWyUhezFThbIlJ3LYrIRkoWGUhhhTMko4zJujYRpxgxHj9737/P3zfh239c57/uc5/zO+UQ3T0QsBRYCtZI+5jBVx0fEcGA6MA+YCXQCVyXddWwlISL6ARuARcXvhQPrJF3/nRARvYHtwLRuFLYCFyW15ITl6XTHvwIuJzlrgHrgiqSOiqSI2ANMAL4BxyW1R8RYYKSkp8Vb8w2HgD7AE0kXSozoD0wC2nPCAWAw0CyppiRhBzAD6MgJW4D5KdDFNeSkiJgFbEvONeYE698N2K0ArPsDMAZwguN+AmeKfZgLbAb6llj7A7gk6eFfnY6I0cDKpNc1tQFNwG1JvvFPp0sKXQ2sAGokveuJpVHAHGBJ4ul76vLNapbs9dYk6R8oU7driyztA2Z3w5L1n5LUnBPWptMd/xw4l+RscsHAeeNSZMloTAG+AIcltUXERPdB0qMylk4klu5LOlni2ABgqm3Oko4BQ4Fnko6WJOxPzlXg2wV4hv2czuOYhmsBsDf1rD7fYP0HkyyzZN0twHjACZmlI0WWFgM7e2DprKQ71SyNA9YDBnFYcq0RuOZ5/h9LdsVS6yV97YmlgYDn2X3wjUa7QdKLapY8015ePrWMJVtembhewLI0YWU4eZvck/Q525pXo4M/AY+TLMP40u+SuooseVjsitm/IakzItz5QcXhKSZsBCyrpdjlwuZwfSO8mLOkdYAHqFXSrRKWvErtXFdOcJcnp0AX96ZwuldQ5uxtTrD+VUmWWXqfujwk8eQ4f68rsuRG+d/gZVb9eIk9kPS6miXvIv91rNc12TXPc5MkTyO/AFhJCujHqZlCAAAAAElFTkSuQmCC","comp/checkbox.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAqCAYAAACDdWrxAAABbUlEQVRIS+2TP0gCURzHv88GRYsrExyOo5cEQVEtWdQQpE4N0R+HxmirXXCrKYigqMF2IRqCQByaLJqNIFpyUIzu4rIwpExODy88ITD/cJ603Rsf7/OGz+/zI5TSEAE20cZRgBMySKni8XrbwICrWAwG2ESZIadFS53J0R25brCyHZNud1vbcRuPV7fDAOu9GXJatNSZHN2R6wb/PfJCrxOZCR8Gbk6hWc6Xg8PrcgBETMIVPdIGSjYG/NoOSHcfkLqDK3qsBSRIrgRAuBF1quUPEUPhYGMwb2dhywrqQ3F0Dt++jSokJMBdhmDO52pB2WwFP7OK8rgH9os99IgppNf3QWwMFP4RNHKALrmoflIj53l6CaWpRcBkgiIkYHl6gDTrh5JJg57v/kJ1YOUixw7jfWELxMpAKUmAXAR7tg3LZ7am3IbjKDBOvPiDqkUmcoj+9H1d7k3nmHdweBubB70ON9wRzQH8pVVQb+Q/zZAEfpwDCU4AAAAASUVORK5CYII=","comp/btn_close.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAA8CAYAAAB1odqiAAAE6UlEQVRYR+3Y30+bVRgH8G/T0t/0Jy0USrIsC0E2GMKAVYcRpmSbEzIGZhqyxCxeceGVF3pjvJl/wYyJWZYY4hZBFnBuBBUW2ewYAxlsSMiyLKH8aEt/0vZtSxvM+562We15C6jlxr53zfO8z+ec5z2nOTmCk598tY19fAQs+Hlvz76QX1zpAwd+1NMNXzieU1QtFeKbvn4CXvqgC95wLKegRirC1e8GCPjh+53wMnRwedkG54aLG4yhSI/ycnPawHaKJ5M1MhGuXR8k4MX3OnjBx3NPcLX3DPfepSu3odfrYC4r5X7bVlbhcrnT4kdrjlA7xYLffj9EwJ6udnhCW9TEJ08XUgWTqE6n5XLdbk9G7MjhKmodrbwAfQPDBLxw7h1ecH3dDq/Xm1GYrZqceXIgGo0GJSXFvOCNmz8RsLv9NNyhKO+icTqc8Pl8acDLyWyr1Wo1DEYDbw2dXIz+4TsE7DzbBneQH2SruDZc8Pv9GSiLqVQq6Iv0WVe5TiHG4K1RAnaceguuYCTrCx63G4FAgAoqlUpodbqs7+sVEgyN/ELAs20t2Ajwgz6vF6FgMGtL5QoF1BoNL1qklODW6DgBT518gxcM+P1gQqFdLRqZXA6lSkVFWXDk198I2NZyAs7NMDXR7XRmYBKZjMuNMEzmljHQF46hUIrR8XsEbG228IJ+T/rGFkskkMoVHBgOBRGNRNI2vkpL/5YsODZhJeCbJ47D4WeoM4wyDLai5PsWiCUQJ2aXTN4pnswzqmS4e+8BAZstDbxg1qW3hyALTlinCPh6Uz1C0Rg2w/S/tz3UpaYWSgsgF4twf3IagvOXr297PR5YGuv+bd2s71sfzkCj1ULQe+3u9vraGlg0lw+LlZhMEIzUNu7vmYYFmz/9LJeTS9We+PIymaGl6wLizo2cokJDEawDNxLg+W7EHTkGjUWw/tBPwOMdnYg7nNQZep4/Q2B9jYspS0zQHjyUlrdTPJksNBrwYGiQgE3vtiNup4O2SSuOzk5y7z2ubYKyuBiaAwe5394XzxGw29Pi5iYLdeDCYgMmfxxOgKfPIG53UBNt049SBVNo4g864HRmxMz1x3hAIybv3CZg49ttiK/bqYneFRuCLldGYTY5OfPkQBR6PTRl6cfIVEtLivHw51ECNrS2Ir62zrtKfWtrCHo8acDLyWyrFVot1CYTbw2hqQRTY2MJsLk5K8hW8TkcCPp8GSiHqdVQG41ZtxUHTkwQ8NhrFsRXyUrke3wuF0L+TSooVxVCrc9+iBKWmvDodysB65saEFtZ5cX8Hi+YQDBrS2VKBVRa/jONqKwU05NTBKyrexWxlRUquOnfBBNidrVoZHIZClWF1DqisjLMzPxBwNraasRsdHDD6c7ApDIJVzTMRDJiRQb6EUNkLsPs7DwBa6qrELPZqCNzu/1pG1siEUOhkHK5wWAYkUg0La7T0U9tIrMZc/MLBKw+XImtZTrIMBFEouQkIBEXQJaYXXJ0O8WTeQXlZsw/XSRg1SsVvGDWpbuHIAsu/LlEwMrKCsQDAcQ93j2U2H2qUKuBUKnE4uISBF9f/Hj7wJwVhyordl/hH2Q+W1zCixoLOdNUj98Ei+byYbH5lnPkmJhL6O+18/c0/1m38/c0qVbm72nYVuTvadgu5O9pUtsif0+Tv6dhF8P/657mLz4NfQVdLmZiAAAAAElFTkSuQmCC","comp/textarea.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAAAXCAYAAABkrDOOAAAA4klEQVRoQ+3ZvQrCMBiF4e9rU+sPOErRqxDRe/KG9Fp0EAc3VzuIg1ML4uDmlkaaquDenMUTyJoDD+8W3ZyKlaoshSeogHOy1m1euOmoI1EU+auqQUf/8XHnnBzLp3jsWdaVJEnEGEPsADXU2Ifro8Gej/uSpqnHruvmaVegqirZX+4N9mIy8Nh13XEct7vE18RaK7vzjdiIFoiNUH5vEJvYQAHgFMsmNlAAOMWyiQ0UAE6xbGIDBYBTLJvYQAHgFMsmNlAAOMWyiQ0UAE79lM2fmrDy358a/q6Hhf68ng175QueKdEXxUGVVwAAAABJRU5ErkJggg==","view/re.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAoCAYAAAD6xArmAAACpklEQVRIS+WWPUgcQRiG3+8O70QEUwTB1EJgsTGdRRrhOMjOtEtSRbBIBMFKuCtkZleES2uRQoWQJggKKW7Of7GyTRvBLkVShhS73OXMfWGOU85Es7uXs0m2XeZh+OZ95xnCHX10R1ykBvu+P5fP59+VSqVvf9pUarBS6jWAR0Q0rbWOboP3BCaiOQAHAKTW+vtN8L8BW96W4zjPPM/78Ss8FlypVEYajYbHzALAJIAHALJdoDWl1Esi4m74rWBmpiAI5pk5AHAvJj0VrXU5Fmyhvu+/AfA8YRxfaa1LsWDf92eZeSMJlJnXtdYvEo1Ca30G4GEH/ImI1lqt1nE+nz9vNBrLnVTY39uO4zxNdHgrKytjzWbzs13FzKfDw8PFxcXF8HL3Nscd8BEAN3HcgiCYbLVaHyyIiGaUUm+7R9JzQZRSo0T0BUCGmRd831/tBttK53K5zXK5/DV1pZVSG0Q0C2BXa/0kySEmKojWeoiZD4hoKpvNTiwtLX1MC7+1IFrrQWZeJaJxx3EKN5186lF0LwiC4DEz31dKvU+z69i7Ig0stnm9wv4zsDGm7bxCodBf5xlj2s5j5mkpZf+c1wHPEdFBGIbS87z+OO8S3EnAVhRFvTnv8PBwpF6ve0QkiGiSmX9znuu66ZxXq9XmAcQ6j5krUspkzqvVaqmcJ4SId54xxl6ZiZwHYN113WTOq1arZ0R05TwAa5lM5rher5/ncrllAPYl1HZeFEXJnLe3tzd2cXHRdh6A04GBgWKxWLxyXlcqjqIochPHbWdn58p5AGaEENec13NB9vf3R5vNZtt5RLTguu4159lKA9gUQqR3njHGHpx9tOxKKfvnvGq1OmQrC2AKwIQQon/OOzk5GQzD0I5hPIqi/jvPGNN2npTyH3feTzoJOzgswwlqAAAAAElFTkSuQmCC","view/search.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAqCAYAAABcOxDuAAABX0lEQVRIS+3VsUrEQBAG4H9HiDZiJQg+gJVaiKAoWClYXWeZ7D6CtbWFr5Ai2ayQxkLQRgsLGwtBUQsRC6sDCxHxEIvIZSRwxRGSu83pNUe23c0H+89kR2AISwzBxAiinuctCSH2AawD+AFwRkR7QRC85CO0ur5SaoOZzwGM54A3IlrJw1aolPIewEJJUY+01jvde31RKeUMgNceXdLSWk9VQl3XnSWiZhnKzF9RFE1WQrPDUsonAHNFsBDiJAzDRmXUdd1tIjoFMJaDW0KI1TAMH61RpdQ0Mx8z8zMzHxLRAYBlAG0Al2ma7hpjHqxbqgNeAJgHcKW1XutEMeE4Ttv3/axXC1dh9XPgbZqmW8aYd9t3ohCVUt4BWARwkyTJZhzHH7Zgdq4MvQbw7ThOw/f9zypgKVoVsS7UX+C+v+kgeI0Oklrvb0Yw03rwlZW8Hnz14OvqjXrw1e/pPyfwCww91CttlMG7AAAAAElFTkSuQmCC","view/save.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAoCAYAAAD6xArmAAAA1klEQVRIS+2VzQ3DIAyFwxwdoMMAA/VQ8ZByyEBhmA7QOVxxKLIaOcIoSZUfrlifHw/wM91Ky6zE7SZgANTaDEDhzYJ5odSMC7nA5U7+b4X2dVQr3ic4hHCTlMcY33xPZUUGcwBvdEJwjcfGGIQQ4rd2qenWA3hyAUuABwCP31NtN+i1v02qP4DicRybM885J2ceB/NCyUupfuLxBS4WbmKF9rNUv4p9gq21d0l5SunF91RWZDAH8EYnBNd4nDPPWitnXst0I6Leez+feVowEQ3e+wNk3ge7C/Qp3GfwkgAAAABJRU5ErkJggg=="};},'base64',function(){return this.base64=new Base64Atlas(Base64AtlasManager.dataO);}
	]);
	return Base64AtlasManager;
})()


/**
*...
*@author ww
*/
//class laya.debug.DebugPanel
var DebugPanel=(function(){
	function DebugPanel(){
		this.tShowObj=null;
		this.preValueO={};
		this.div=null;
		this.debug_view=null;
		this.height=300;
		this.clickedHandler=null;
		this.fromMe=false;
		this._treeDataList=null;
		this._init();
	}

	__class(DebugPanel,'laya.debug.DebugPanel');
	var __proto=DebugPanel.prototype;
	__proto.removeNoDisplayKeys=function(arr){
		var i=0;
		for (i=arr.length-1;i >=0;i--){
			if (DebugPanel.noDisplayKeys[arr[i]]){
				arr.splice(i,1);
			}
		}
	}

	__proto.updateShowKeys=function(){
		DebugPanel.tObjKeys.length=0;
		if (!this.tShowObj)
			return;
		DebugPanel.tObjKeys=ClassTool.getObjectDisplayAbleKeys(this.tShowObj,DebugPanel.tObjKeys);
		if (this.tShowObj==Laya.stage){
			this.removeNoDisplayKeys(DebugPanel.tObjKeys);
		}
		DebugPanel.tObjKeys.sort(MathUtil.sortSmallFirst);
	}

	__proto._init=function(){
		var _$this=this;
		this.div=Browser.document.createElement('div');
		Browser.document.body.appendChild(this.div);
		this.clickedHandler=new Handler(this,this.onClickSelected);
		this.debug_view=Browser.window.layaair_debug_view;
		this.debug_view.initLayaAirDebugView(this.div);
		this.debug_view.tree.attachEvent("onSelect",function(id){
			var dataO;
			dataO=_$this.getDataByID(id,_$this._treeDataList[0]);
			if (dataO.target){
				DebugTool.showDisBound(dataO.target);
				_$this.showTargetInfo(dataO.target);
			}
		});
		this.debug_view.setValueChangeHandler(function(data,new_value){
			_$this.onValueChange(data,new_value);
		});
		this.debug_view.onRefresh(function(){
			DebugPanel.I.setRoot(Laya.stage);
		});
		this.debug_view.onInspectElement(function(){
			ClickSelectTool.I.beginClickSelect(_$this.clickedHandler);
		});
		this.debug_view.onLogInfo(function(){
			console.log(_$this.tShowObj);
		});
		this.debug_view.onPrintEnabledNodeChain(function(){
			DebugTool.traceDisMouseEnable(_$this.tShowObj);
		});
		this.debug_view.onPrintSizeChain(function(){
			DebugTool.traceDisSizeChain(_$this.tShowObj);
		});
		this.debug_view.onToggleVisibility(function(selectd){
			if (_$this.tShowObj){
				_$this.tShowObj.visible=_$this.debug_view.getVisibility();
			}
		});
		this.debug_view.onToggleDebugBorder(function(selectd){
			if (!_$this.tShowObj)
				return;
			SpriteRenderHook.showDisplayBorder(_$this.tShowObj,_$this.debug_view.getShowDebugBorder());
		});
		this.debug_view.onToggleShowCurrentCache(function(selectd){
			CacheAnalyser.showRecacheSprite=_$this.debug_view.getShowCurrentCache();
		});
		this.debug_view.onToggleShowAllCache(function(selectd){
			CacheAnalyser.showCacheSprite=_$this.debug_view.getShowAllCache();
		});
		this.debug_view.onToggleShowAtlas(function(selectd){
			console.log("toggle show atlas:",_$this.debug_view.getShowAtlas());
			if (_$this.debug_view.getShowAtlas()){
				AtlasTools.getInstance().start();
			}
			else {
				AtlasTools.getInstance().end();
			}
		});
		JSTools.showToBody(this.div,0,0);
		Laya.stage.on("resize",this,this.adptPos);
		this.adptPos();
	}

	__proto.onClickSelected=function(target){
		var dataO;
		if (!this._treeDataList)
			return;
		this.debug_view.tree.selectItem(IDTools.getObjID(target));
		this.debug_view.bounceUpInspectButton();
	}

	__proto.updateLoop=function(){
		if (this.tShowObj){
			this.showTargetInfo(this.tShowObj);
		}
	}

	__proto.onSelectItem=function(obj){
		var tTarget;
		tTarget=obj.target;
		this.showTargetInfo(tTarget);
	}

	__proto.onValueChange=function(obj,newValue){
		if (obj["type"]=="number"){
			newValue=DebugPanel.mParseFloat(newValue);
		}
		if (obj["type"]=="boolean"){
			newValue=newValue.toString()=="true";
		}
		if (this.tShowObj){
			var key;
			key=obj["key"];
			this.preValueO[key]=this.tShowObj[key]=newValue;
		}
	}

	__proto.showTargetInfo=function(tTarget){
		if (!tTarget)
			return;
		this.debug_view.setVisibility(tTarget.visible);
		this.debug_view.setShowDebugBorder(SpriteRenderHook.isDisplayShowBorder(tTarget));
		var i=0,len=0;
		len=DebugPanel.tObjKeys.length;
		var key;
		if (this.tShowObj==tTarget){
			for (i=0;i < len;i++){
				key=DebugPanel.tObjKeys[i];
				if (this.preValueO[key] !=tTarget[key]){
					this.debug_view.changeValueByLabel(key,tTarget[key]);
				}
			}
		}
		else {
			this.tShowObj=tTarget;
			this.updateShowKeys();
			var dataList;
			dataList=DebugPanel.getObjectData(tTarget);
			this.debug_view.setContents(dataList);
		}
		for (i=0;i < len;i++){
			key=DebugPanel.tObjKeys[i];
			this.preValueO[key]=tTarget[key];
		}
	}

	__proto.adptPos=function(){
		if (this.fromMe)return;
		this.fromMe=true;
		JSTools.setPos(this.div,0,Browser.clientHeight-this.height);
		this.debug_view.resize(Browser.clientWidth,this.height);
		if (!DebugPanel.overlay){
			Laya.stage.setScreenSize(Browser.clientWidth *Browser.pixelRatio,(Browser.clientHeight-this.height)*Browser.pixelRatio);
		}
		this.fromMe=false;
	}

	__proto.setRoot=function(sprite){
		var mtreeo;
		mtreeo=DebugPanel.getSpriteTreeArr(sprite);
		this._treeDataList=[mtreeo];
		var wraped;
		wraped={};
		wraped.id=0;
		wraped.item=[mtreeo];
		this.debug_view.setTree(wraped);
		Laya.timer.loop(500,this,this.updateLoop);
	}

	__proto.getDataByID=function(targetID,nodeO){
		if (!nodeO)
			return null;
		if (targetID==nodeO.id)
			return nodeO;
		var childs;
		childs=nodeO["item"];
		if (!childs)
			return null;
		var i=0,len=0;
		len=childs.length;
		var tRst;
		for (i=0;i < len;i++){
			tRst=this.getDataByID(targetID,childs[i]);
			if (tRst)
				return tRst;
		}
		return null;
	}

	__proto.getDataByTarget=function(target,nodeO){
		if (!nodeO)
			return null;
		if (target==nodeO.target)
			return nodeO;
		var childs;
		childs=nodeO["item"];
		if (!childs)
			return null;
		var i=0,len=0;
		len=childs.length;
		var tRst;
		for (i=0;i < len;i++){
			tRst=this.getDataByTarget(target,childs[i]);
			if (tRst)
				return tRst;
		}
		return null;
	}

	DebugPanel.init=function(underGame,bgColor){
		(underGame===void 0)&& (underGame=true);
		(bgColor===void 0)&& (bgColor="#ffffff");
		if (!DebugPanel.I){
			DebugPanel.overlay=!underGame;
			DivScripts.init();
			DebugTool.initBasicFunctions();
			RenderSpriteHook.init();
			SpriteRenderHook.init();
			DebugPanel.I=new DebugPanel();
			DebugPanel.I.setRoot(Laya.stage);
			CacheAnalyser.showRecacheSprite=false;
			if (bgColor){
				DebugPanel.I.div.style.background=bgColor;
			}
		}
	}

	DebugPanel.getSpriteTreeArr=function(sprite){
		var rst;
		rst={};
		rst["text"]=""+ClassTool.getNodeClassAndName(sprite);
		rst.target=sprite;
		IDTools.idObj(sprite);
		rst.id=IDTools.getObjID(sprite);
		var childs;
		childs=sprite._childs;
		var i=0,len=0;
		len=childs.length;
		var tchild;
		var childsList;
		childsList=[];
		rst["item"]=childsList;
		for (i=0;i < len;i++){
			childsList.push(DebugPanel.getSpriteTreeArr(childs[i]));
		}
		return rst;
	}

	DebugPanel.getObjectData=function(data){
		var dataList;
		var tData;
		var key;
		var tValue;
		var tType;
		dataList=[];
		var keys;
		keys=DebugPanel.tObjKeys;
		var i=0,len=0;
		len=keys.length;
		for (i=0;i < len;i++){
			key=keys[i];
			tValue=data[key];
			tType=typeof(tValue);
			if (key.charAt(0)=="_")
				continue ;
			if (DebugPanel.displayTypes[tType]){
				tData={};
				tData["key"]=key;
				tData["value"]=tValue;
				tData["type"]=tType;
				dataList.push(tData);
			}
		}
		return dataList;
	}

	DebugPanel.mParseFloat=function(v){
		var rst=NaN;
		rst=parseFloat(v);
		if (isNaN(rst))
			return 0;
		return rst;
	}

	DebugPanel.I=null;
	DebugPanel.overlay=false;
	DebugPanel.ChildrenSign="item";
	DebugPanel.LabelSign="text";
	DebugPanel.tObjKeys=[];
	__static(DebugPanel,
	['displayTypes',function(){return this.displayTypes={"boolean":true,"number":true,"string":true};},'displayKeys',function(){return this.displayKeys=[["x","number"],["y","number"],["width","number"],["width","number"],["width","number"],["width","number"],["width","number"],["width","number"],["width","number"],["width","number"],["width","number"],];},'noDisplayKeys',function(){return this.noDisplayKeys={"desginWidth":true,"desginHeight":true };}
	]);
	return DebugPanel;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-9-24 下午3:00:38
*/
//class laya.debug.DebugTool
var DebugTool=(function(){
	function DebugTool(){}
	__class(DebugTool,'laya.debug.DebugTool');
	__getset(1,DebugTool,'target',function(){
		return DebugTool._target;
		},function(v){
		DebugTool._target=v;
	});

	__getset(1,DebugTool,'isThisShow',function(){
		return false;
	});

	/**
	*设置是否显示帧率信息
	*@param value 是否显示true|false
	*/
	__getset(1,DebugTool,'showStatu',null,function(value){
		if (value){
			Stat.show();
		}
		else{
			Stat.hide();
			DebugTool.clearDebugLayer();
		}
	});

	/**
	*是否自动显示点击对象的边框
	*@param value
	*/
	__getset(1,DebugTool,'showBound',function(){
		return DebugTool._showBound;
		},function(value){
		DebugTool._showBound=value;
		if (!DebugTool._showBound){
			DebugTool.clearDebugLayer();
		}
	});

	DebugTool.getMenuShowEvent=function(){
		if (Browser.onMobile){
			return "doubleclick";
			}else{
			return "rightclick";
		}
	}

	DebugTool.init=function(cacheAnalyseEnable,loaderAnalyseEnable,createAnalyseEnable,renderAnalyseEnable,showCacheRec){
		(cacheAnalyseEnable===void 0)&& (cacheAnalyseEnable=true);
		(loaderAnalyseEnable===void 0)&& (loaderAnalyseEnable=true);
		(createAnalyseEnable===void 0)&& (createAnalyseEnable=true);
		(renderAnalyseEnable===void 0)&& (renderAnalyseEnable=true);
		(showCacheRec===void 0)&& (showCacheRec=false);
		DebugTool.enableCacheAnalyse=cacheAnalyseEnable;
		if (DebugTool.enableCacheAnalyse){
			RenderSpriteHook.init();
		}
		if (renderAnalyseEnable){
			SpriteRenderHook.init();
		}
		DebugTool.enableNodeCreateAnalyse=createAnalyseEnable;
		if (DebugTool.enableNodeCreateAnalyse){
			ClassCreateHook.I.hookClass(Node);
		}
		if (loaderAnalyseEnable){
			LoaderHook.init();
		}
		CacheAnalyser.showCacheSprite=showCacheRec;
		NodeInfoPanel.init();
		DebugTool.initBasicFunctions();
	}

	DebugTool.initBasicFunctions=function(){
		DisplayHook.initMe();
		if (!DebugTool.debugLayer){
			DebugInfoLayer.init();
			DebugTool.debugLayer=DebugInfoLayer.I.graphicLayer;
			DebugTool.debugLayer.mouseEnabled=false;
			DebugTool.debugLayer.mouseThrough=true;
			DebugTool.showStatu=true;
			Laya.stage.on("keydown",null,DebugTool.keyHandler);
			DebugTool.cmdToTypeO[0x01]="IMAGE";
			DebugTool.cmdToTypeO[0x02]="ALPHA";
			DebugTool.cmdToTypeO[0x04]="TRANSFORM";
			DebugTool.cmdToTypeO[0x10]="CANVAS";
			DebugTool.cmdToTypeO[0x200]="GRAPHICS";
			DebugTool.cmdToTypeO[0x400]="CUSTOM";
			DebugTool.cmdToTypeO[0x800]="CHILDS";
			DebugExport.export();
		}
	}

	DebugTool.dTrace=function(str){
		if (DebugTool._traceFun !=null){
			DebugTool._traceFun(str);
		}
		console.log(str);
	}

	DebugTool.keyHandler=function(e){
		var key;
		key=String.fromCharCode(e.keyCode);
		if (!e.altKey)
			return;
		switch (e.keyCode){
			case 38:
				DebugTool.showParent();
				break ;
			case 40:
				DebugTool.showChild();
				break ;
			case 37:
				DebugTool.showBrother(DebugTool.target,1);
				break ;
			case 39:
				DebugTool.showBrother(DebugTool.target,-1);
				break ;
			}
		DebugTool.dealCMDKey(key);
	}

	DebugTool.dealCMDKey=function(key){
		switch (key){
			case "上":
				DebugTool.showParent();
				break ;
			case "下":
				DebugTool.showChild();
				break ;
			case "左":
				DebugTool.showBrother(DebugTool.target,1);
				break ;
			case "右":
				DebugTool.showBrother(DebugTool.target,-1);
				break ;
			case "B":
				DebugTool.showAllBrother();
				break ;
			case "C":
				DebugTool.showAllChild();
				break ;
			case "E":
				DebugTool.traceDisMouseEnable();
				break ;
			case "S":
				DebugTool.traceDisSizeChain();
				break ;
			case "D":
				DisControlTool.downDis(DebugTool.target);
				break ;
			case "U":
				DisControlTool.upDis(DebugTool.target);
				break ;
			case "N":
				DebugTool.getNodeInfo();
				break ;
			case "M":
				DebugTool.showAllUnderMosue();
				break ;
			case "I":
				break ;
			case "O":
				ObjectCreateView.I.show();
				break ;
			case "L":
				DisController.I.switchType();
				break ;
			case "Q":
				DebugTool.showNodeInfo();
				break ;
			case "F":
				DebugTool.showToolPanel();
				break ;
			case "P":
				DebugTool.showToolFilter();
				break ;
			case "V":
				DebugTool.selectNodeUnderMouse();
				break ;
			case "A":
				if (NodeToolView.I.target){
					MouseEventAnalyser.analyseNode(NodeToolView.I.target);
				}
				break ;
			case "K":
				NodeUtils.traceStage();
				break ;
			case "T":
				DebugTool.switchNodeTree();
				break ;
			case "R":
				RenderCostRankView.I.show();
				break ;
			case "X":
				NodeTree.I.fresh();
				break ;
			case "mCMD":
				DebugTool.traceCMD();
				break ;
			case "allCMD":
				DebugTool.traceCMDR();
				break ;
			}
	}

	DebugTool.switchNodeTree=function(){
		ToolPanel.I.switchShow("Tree");
	}

	DebugTool.analyseMouseHit=function(){
		if (DebugTool.target)
			MouseEventAnalyser.analyseNode(DebugTool.target);
	}

	DebugTool.selectNodeUnderMouse=function(){
		DisplayHook.instance.selectDisUnderMouse();
		DebugTool.showDisBound();
		return;
	}

	DebugTool.showToolPanel=function(){
		ToolPanel.I.switchShow("Find");
	}

	DebugTool.showToolFilter=function(){
		ToolPanel.I.switchShow("Filter");
	}

	DebugTool.showNodeInfo=function(){
		if (NodeInfoPanel.I.isWorkState){
			NodeInfoPanel.I.recoverNodes();
		}
		else{
			NodeInfoPanel.I.showDisInfo(DebugTool.target);
		}
	}

	DebugTool.switchDisController=function(){
		if (DisController.I.target){
			DisController.I.target=null;
		}
		else{
			if (DebugTool.target){
				DisController.I.target=DebugTool.target;
			}
		}
	}

	DebugTool.showParent=function(sprite){
		if (!sprite)
			sprite=DebugTool.target;
		if (!sprite){
			console.log("no targetAvalible");
			return null;
		}
		DebugTool.target=sprite.parent;
		DebugTool.autoWork();
	}

	DebugTool.showChild=function(sprite){
		if (!sprite)
			sprite=DebugTool.target;
		if (!sprite){
			console.log("no targetAvalible");
			return null;
		}
		if (sprite.numChildren > 0){
			DebugTool.target=sprite.getChildAt(0);
			DebugTool.autoWork();
		}
	}

	DebugTool.showAllChild=function(sprite){
		if (!sprite)
			sprite=DebugTool.target;
		if (!sprite){
			console.log("no targetAvalible");
			return null;
		}
		DebugTool.selectedNodes=DisControlTool.getAllChild(sprite);
		DebugTool.showSelected();
	}

	DebugTool.showAllUnderMosue=function(){
		DebugTool.selectedNodes=DisControlTool.getObjectsUnderGlobalPoint(Laya.stage);
		DebugTool.showSelected();
	}

	DebugTool.showParentChain=function(sprite){
		if (!sprite)
			return;
		DebugTool.selectedNodes=[];
		var tar;
		tar=sprite.parent;
		while (tar){
			DebugTool.selectedNodes.push(tar);
			tar=tar.parent;
		}
		DebugTool.showSelected();
	}

	DebugTool.showAllBrother=function(sprite){
		if (!sprite)
			sprite=DebugTool.target;
		if (!sprite){
			console.log("no targetAvalible");
			return null;
		}
		if (!sprite.parent)
			return;
		DebugTool.selectedNodes=DisControlTool.getAllChild(sprite.parent);
		DebugTool.showSelected();
	}

	DebugTool.showBrother=function(sprite,dID){
		(dID===void 0)&& (dID=1);
		if (!sprite)
			sprite=DebugTool.target;
		if (!sprite){
			console.log("no targetAvalible");
			return null;
		};
		var p;
		p=sprite.parent;
		if (!p)
			return;
		var n=0;
		n=p.getChildIndex(sprite);
		n+=dID;
		if (n < 0)
			n+=p.numChildren;
		if (n >=p.numChildren)
			n-=p.numChildren;
		DebugTool.target=p.getChildAt(n);
		DebugTool.autoWork();
	}

	DebugTool.clearDebugLayer=function(){
		if (DebugTool.debugLayer.graphics)
			DebugTool.debugLayer.graphics.clear();
	}

	DebugTool.showSelected=function(){
		if (!DebugTool.autoShowSelected)
			return;
		if (!DebugTool.selectedNodes || DebugTool.selectedNodes.length < 1)
			return;
		console.log("selected:",DebugTool.selectedNodes);
		var i=0;
		var len=0;
		len=DebugTool.selectedNodes.length;
		DebugTool.clearDebugLayer();
		for (i=0;i < len;i++){
			DebugTool.showDisBound(DebugTool.selectedNodes[i],false);
		}
	}

	DebugTool.getClassCreateInfo=function(className){
		return RunProfile.getRunInfo(className);
	}

	DebugTool.autoWork=function(){
		if (!DebugTool.isThisShow)
			return;
		if (DebugTool.showBound)
			DebugTool.showDisBound();
		if (DebugTool.autoTraceSpriteInfo && DebugTool.target){
			TraceTool.traceSpriteInfo(DebugTool.target,DebugTool.autoTraceBounds,DebugTool.autoTraceSize,DebugTool.autoTraceTree);
		}
		if (!DebugTool.target)
			return;
		if (DebugTool.autoTraceCMD){
			DebugTool.traceCMD();
		}
		if (DebugTool.autoTraceCMDR){
			DebugTool.traceCMDR();
		}
		if (DebugTool.autoTraceEnable){
			DebugTool.traceDisMouseEnable(DebugTool.target);
		}
	}

	DebugTool.traceDisMouseEnable=function(tar){
		console.log("----------------traceDisMouseEnable--------------------");
		if (!tar)
			tar=DebugTool.target;
		if (!tar){
			console.log("no targetAvalible");
			return null;
		};
		var strArr;
		strArr=[];
		DebugTool.selectedNodes=[];
		while (tar){
			strArr.push(ClassTool.getNodeClassAndName(tar)+": mouseEnabled:"+tar.mouseEnabled+" hitFirst:"+tar.hitTestPrior);
			DebugTool.selectedNodes.push(tar);
			tar=tar.parent;
		}
		console.log(strArr.join("\n"));
		DebugTool.showSelected();
		return strArr.join("\n");
	}

	DebugTool.traceDisSizeChain=function(tar){
		console.log("---------------------traceDisSizeChain-------------------");
		if (!tar)
			tar=DebugTool.target;
		if (!tar){
			console.log("no targetAvalible");
			return null;
		}
		DebugTool.selectedNodes=[];
		var strArr;
		strArr=[];
		while (tar){
			strArr.push(ClassTool.getNodeClassAndName(tar)+": x:"+tar.x+" y:"+tar.y+" w:"+tar.width+" h:"+tar.height+" scaleX:"+tar.scaleX+" scaleY:"+tar.scaleY);
			DebugTool.selectedNodes.push(tar);
			tar=tar.parent;
		}
		console.log(strArr.join("\n"));
		DebugTool.showSelected();
		return strArr.join("\n");
	}

	DebugTool.showDisBound=function(sprite,clearPre,color){
		(clearPre===void 0)&& (clearPre=true);
		(color===void 0)&& (color="#ff0000");
		if (!sprite)
			sprite=DebugTool.target;
		if (!sprite){
			console.log("no targetAvalible");
			return null;
		}
		if (clearPre)
			DebugTool.clearDebugLayer();
		var pointList;
		pointList=sprite._getBoundPointsM(true);
		if (!pointList || pointList.length < 1)
			return;
		pointList=GrahamScan.pListToPointList(pointList,true);
		WalkTools.walkArr(pointList,sprite.localToGlobal,sprite);
		pointList=GrahamScan.pointListToPlist(pointList);
		DebugTool._disBoundRec=Rectangle._getWrapRec(pointList,DebugTool._disBoundRec);
		DebugTool.debugLayer.graphics.drawRect(DebugTool._disBoundRec.x,DebugTool._disBoundRec.y,DebugTool._disBoundRec.width,DebugTool._disBoundRec.height,null,color);
		DebugInfoLayer.I.setTop();
	}

	DebugTool.showDisBoundToSprite=function(sprite,graphicSprite,color,lineWidth){
		(color===void 0)&& (color="#ff0000");
		(lineWidth===void 0)&& (lineWidth=1);
		var pointList;
		pointList=sprite._getBoundPointsM(true);
		if (!pointList || pointList.length < 1)
			return;
		pointList=GrahamScan.pListToPointList(pointList,true);
		WalkTools.walkArr(pointList,sprite.localToGlobal,sprite);
		pointList=GrahamScan.pointListToPlist(pointList);
		DebugTool._disBoundRec=Rectangle._getWrapRec(pointList,DebugTool._disBoundRec);
		graphicSprite.graphics.drawRect(DebugTool._disBoundRec.x,DebugTool._disBoundRec.y,DebugTool._disBoundRec.width,DebugTool._disBoundRec.height,null,color,lineWidth);
	}

	DebugTool.getNodeInfo=function(){
		DebugTool.counter.reset();
		WalkTools.walkTarget(Laya.stage,DebugTool.addNodeInfo);
		console.log("node info:");
		DebugTool.counter.traceSelf();
		return DebugTool.counter.data;
	}

	DebugTool.findByClass=function(className){
		DebugTool._classList=[];
		DebugTool._tFindClass=className;
		WalkTools.walkTarget(Laya.stage,DebugTool.addClassNode);
		DebugTool.selectedNodes=DebugTool._classList;
		DebugTool.showSelected();
		return DebugTool._classList;
	}

	DebugTool.addClassNode=function(node){
		var type;
		type=node["constructor"].name;
		if (type==DebugTool._tFindClass){
			DebugTool._classList.push(node);
		}
	}

	DebugTool.traceCMD=function(sprite){
		if (!sprite)
			sprite=DebugTool.target;
		if (!sprite){
			console.log("no targetAvalible");
			return null;
		}
		console.log("self CMDs:");
		console.log(sprite.graphics.cmds);
		var renderSprite;
		renderSprite=RenderSprite.renders[sprite._renderType];
		console.log("renderSprite:",renderSprite);
		DebugTool._rSpList.length=0;
		while (renderSprite && renderSprite["_sign"] > 0){
			DebugTool._rSpList.push(DebugTool.cmdToTypeO[renderSprite["_sign"]]);
			renderSprite=renderSprite._next;
		}
		console.log("fun:",DebugTool._rSpList.join(","));
		DebugTool.counter.reset();
		DebugTool.addCMDs(sprite.graphics.cmds);
		DebugTool.counter.traceSelf();
		return DebugTool.counter.data;
	}

	DebugTool.addCMDs=function(cmds){
		WalkTools.walkArr(cmds,DebugTool.addCMD);
	}

	DebugTool.addCMD=function(cmd){
		DebugTool.counter.add(cmd.callee);
	}

	DebugTool.traceCMDR=function(sprite){
		if (!sprite)
			sprite=DebugTool.target;
		if (!sprite){
			console.log("no targetAvalible");
			return 0;
		}
		DebugTool.counter.reset();
		WalkTools.walkTarget(sprite,DebugTool.getCMdCount);
		console.log("cmds include children");
		DebugTool.counter.traceSelf();
		return DebugTool.counter.data;
	}

	DebugTool.getCMdCount=function(target){
		if (!target)
			return 0;
		if (! (target instanceof laya.display.Sprite ))
			return 0;
		if (!target.graphics.cmds)
			return 0;
		DebugTool.addCMDs(target.graphics.cmds);
		var rst=target.graphics.cmds.length;
		return rst;
	}

	DebugTool.addNodeInfo=function(node){
		var type;
		type=node["constructor"].name;
		DebugTool.counter.add(type);
	}

	DebugTool.find=function(filter,ifShowSelected){
		(ifShowSelected===void 0)&& (ifShowSelected=true);
		var rst;
		rst=DebugTool.findTarget(Laya.stage,filter);
		DebugTool.selectedNodes=rst;
		if (DebugTool.selectedNodes){
			DebugTool.target=DebugTool.selectedNodes[0];
		}
		if (ifShowSelected)
			DebugTool.showSelected();
		return rst;
	}

	DebugTool.findByName=function(name){
		DebugTool.nameFilter.name=name;
		return DebugTool.find(DebugTool.nameFilter);
	}

	DebugTool.findNameStartWith=function(startStr){
		DebugTool.nameFilter.name=DebugTool.getStartWithFun(startStr);
		return DebugTool.find(DebugTool.nameFilter);
	}

	DebugTool.findNameHas=function(hasStr,showSelected){
		(showSelected===void 0)&& (showSelected=true);
		DebugTool.nameFilter.name=DebugTool.getHasFun(hasStr);
		return DebugTool.find(DebugTool.nameFilter,showSelected);
	}

	DebugTool.getStartWithFun=function(startStr){
		var rst=function (str){
			if (!str)
				return false;
			if (str.indexOf(startStr)==0)
				return true;
			return false;
		};
		return rst;
	}

	DebugTool.getHasFun=function(hasStr){
		var rst=function (str){
			if (!str)
				return false;
			if (str.indexOf(hasStr)>=0)
				return true;
			return false;
		};
		return rst;
	}

	DebugTool.findTarget=function(target,filter){
		var rst=[];
		if (DebugTool.isFit(target,filter))
			rst.push(target);
		var i=0;
		var len=0;
		var tChild;
		len=target.numChildren;
		for (i=0;i < len;i++){
			tChild=target.getChildAt(i);
			if ((tChild instanceof laya.display.Sprite )){
				rst=rst.concat(DebugTool.findTarget(tChild,filter));
			}
		}
		return rst;
	}

	DebugTool.findClassHas=function(target,str){
		var rst=[];
		if (ClassTool.getClassName(target).indexOf(str)>=0)
			rst.push(target);
		var i=0;
		var len=0;
		var tChild;
		len=target.numChildren;
		for (i=0;i < len;i++){
			tChild=target.getChildAt(i);
			if ((tChild instanceof laya.display.Sprite )){
				rst=rst.concat(DebugTool.findClassHas(tChild,str));
			}
		}
		return rst;
	}

	DebugTool.isFit=function(tar,filter){
		if (!tar)
			return false;
		if (!filter)
			return true;
		if ((typeof filter=='function')){
			return (filter)(tar);
		};
		var key;
		for (key in filter){
			if ((typeof (filter[key])=='function')){
				if (!filter[key](tar[key]))
					return false;
			}
			else{
				if (tar[key] !=filter[key])
					return false;
			}
		}
		return true;
	}

	DebugTool.log=function(__args){
		var args=arguments;
		var arr;
		arr=DTrace.getArgArr(args);
		if (DebugTool._logFun!=null){
			DebugTool._logFun(arr.join(" "));
		}
	}

	DebugTool.enableCacheAnalyse=false;
	DebugTool.enableNodeCreateAnalyse=true;
	DebugTool._traceFun=null;
	DebugTool.debugLayer=null;
	DebugTool._target=null;
	DebugTool.selectedNodes=[];
	DebugTool.autoShowSelected=true;
	DebugTool._showBound=true;
	DebugTool._disBoundRec=null;
	DebugTool.autoTraceEnable=false;
	DebugTool.autoTraceBounds=false;
	DebugTool.autoTraceSize=false;
	DebugTool.autoTraceTree=true;
	DebugTool.autoTraceCMD=true;
	DebugTool.autoTraceCMDR=false;
	DebugTool.autoTraceSpriteInfo=true;
	DebugTool._classList=null;
	DebugTool._tFindClass=null;
	DebugTool._rSpList=[];
	DebugTool._logFun=null;
	__static(DebugTool,
	['text',function(){return this.text=new Stat();},'cmdToTypeO',function(){return this.cmdToTypeO={
	};},'counter',function(){return this.counter=new CountTool();},'nameFilter',function(){return this.nameFilter={"name":"name"};}

	]);
	return DebugTool;
})()


/**
*...
*@author ww
*/
//class laya.debug.divui.DivScripts
var DivScripts=(function(){
	function DivScripts(){}
	__class(DivScripts,'laya.debug.divui.DivScripts');
	DivScripts.init=function(){
		var script;
		script=Base64Tool.decodeToByte(DivScripts.data).readUTFBytes();
		Laya._runScript(script);
	}

	DivScripts.data="ZnVuY3Rpb24gZGh0bWx4RXZlbnQoZSx0LGkpe2UuYWRkRXZlbnRMaXN0ZW5lcj9lLmFkZEV2ZW50TGlzdGVuZXIodCxpLCExKTplLmF0dGFjaEV2ZW50JiZlLmF0dGFjaEV2ZW50KCJvbiIrdCxpKX1mdW5jdGlvbiBkaHRtbFhUcmVlT2JqZWN0KGUsdCxpLG4pe2lmKGRodG1seEV2ZW50LmluaXRUb3VjaCYmZGh0bWx4RXZlbnQuaW5pdFRvdWNoKCksX2lzSUUpdHJ5e2RvY3VtZW50LmV4ZWNDb21tYW5kKCJCYWNrZ3JvdW5kSW1hZ2VDYWNoZSIsITEsITApfWNhdGNoKG8pe30ib2JqZWN0IiE9dHlwZW9mIGU/dGhpcy5wYXJlbnRPYmplY3Q9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk6dGhpcy5wYXJlbnRPYmplY3Q9ZSx0aGlzLnBhcmVudE9iamVjdC5zdHlsZS5vdmVyZmxvdz0iaGlkZGVuIix0aGlzLl9pdGltX2RnPSEwLHRoaXMuZGxtdHI9IiwiLHRoaXMuZHJvcExvd2VyPSExLHRoaXMuZW5hYmxlSUVJbWFnZUZpeCghMCksdGhpcy54bWxzdGF0ZT0wLHRoaXMubXl0eXBlPSJ0cmVlIix0aGlzLnNtY2hlY2s9ITAsdGhpcy53aWR0aD10LHRoaXMuaGVpZ2h0PWksdGhpcy5yb290SWQ9bix0aGlzLmNoaWxkQ2FsYz1udWxsLHRoaXMuZGVmX2ltZ194PSIxOHB4Iix0aGlzLmRlZl9pbWdfeT0iMThweCIsdGhpcy5kZWZfbGluZV9pbWdfeD0iMThweCIsdGhpcy5kZWZfbGluZV9pbWdfeT0iMjRweCIsdGhpcy5fZHJhZ2dlZD1uZXcgQXJyYXksdGhpcy5fc2VsZWN0ZWQ9bmV3IEFycmF5LHRoaXMuc3R5bGVfcG9pbnRlcj0icG9pbnRlciIsdGhpcy5fYWltZ3M9ITAsdGhpcy5odG1sY0E9IiBbIix0aGlzLmh0bWxjQj0iXSIsdGhpcy5sV2luPXdpbmRvdyx0aGlzLmNNZW51PTAsdGhpcy5tbGl0ZW1zPTAsdGhpcy5pY29uVVJMPSIiLHRoaXMuZGFkbW9kZT0wLHRoaXMuc2xvd1BhcnNlPSExLHRoaXMuYXV0b1Njcm9sbD0hMCx0aGlzLmhmTW9kZT0wLHRoaXMubm9kZUN1dD1uZXcgQXJyYXksdGhpcy5YTUxzb3VyY2U9MCx0aGlzLlhNTGxvYWRpbmdXYXJuaW5nPTAsdGhpcy5faWRwdWxsPXt9LHRoaXMuX3B1bGxTaXplPTAsdGhpcy50cmVlTGluZXNPbj0hMCx0aGlzLnRzY2hlY2s9ITEsdGhpcy50aW1nZW49ITAsdGhpcy5kcGNweT0hMSx0aGlzLl9sZF9pZD1udWxsLHRoaXMuX2R5bkRlbGV0ZUJyYW5jaGVzPXt9LHRoaXMuX29pZV9vblhMRT1bXSx0aGlzLmltUGF0aD13aW5kb3cuZGh4X2dsb2JhbEltZ1BhdGh8fCIiLHRoaXMuY2hlY2tBcnJheT1uZXcgQXJyYXkoImljb25VbmNoZWNrQWxsLmdpZiIsImljb25DaGVja0FsbC5naWYiLCJpY29uQ2hlY2tHcmF5LmdpZiIsImljb25VbmNoZWNrRGlzLmdpZiIsImljb25DaGVja0Rpcy5naWYiLCJpY29uQ2hlY2tEaXMuZ2lmIiksdGhpcy5yYWRpb0FycmF5PW5ldyBBcnJheSgicmFkaW9fb2ZmLmdpZiIsInJhZGlvX29uLmdpZiIsInJhZGlvX29uLmdpZiIsInJhZGlvX29mZi5naWYiLCJyYWRpb19vbi5naWYiLCJyYWRpb19vbi5naWYiKSx0aGlzLmxpbmVBcnJheT1uZXcgQXJyYXkoImxpbmUyLmdpZiIsImxpbmUzLmdpZiIsImxpbmU0LmdpZiIsYmxhbmtfYmFzZTY0LGJsYW5rX2Jhc2U2NCwibGluZTEuZ2lmIiksdGhpcy5taW51c0FycmF5PW5ldyBBcnJheSgibWludXMyLmdpZiIsIm1pbnVzMy5naWYiLCJtaW51czQuZ2lmIiwiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoRWdBWUFKRUNBTEd2clo2ZG5mVDA5QUFBQUNINUJBRUFBQUlBTEFBQUFBQVNBQmdBQUFJY2xJK3B5KzBQbzV5MFdoc0NEV0IzbUdYZnd3SG1oYWJxeXJaVEFRQTciLCJtaW51czUuZ2lmIiksdGhpcy5wbHVzQXJyYXk9bmV3IEFycmF5KCJwbHVzMi5naWYiLCJwbHVzMy5naWYiLCJwbHVzNC5naWYiLCJkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhFZ0FZQUpFQ0FLR2duN0d2cmZUMDlBQUFBQ0g1QkFFQUFBSUFMQUFBQUFBU0FCZ0FBQUljbEkrcHkrMFBvNXkwVW5CRHlIc0NMUUZmT0U2ZGhhYnF5clpKQVFBNyIsInBsdXM1LmdpZiIpLHRoaXMuaW1hZ2VBcnJheT1uZXcgQXJyYXkoImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEVnQVNBS0VDQUplWGw3R3ZyZi8vLy8vLy95SDVCQUVLQUFJQUxBQUFBQUFTQUJJQUFBSXpsSStwQXUyOURBaTAxamlUWFJuTm0zVEhCNDVCYUoyZXVsQm94TENTL0s2d09OODBYcHQ2citCOUhrU2FJSVdFS1EwRkFEcz0iLCJkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhFZ0FTQUtFQ0FKZVhsN0d2cmYvLy8vLy8veUg1QkFFS0FBSUFMQUFBQUFBU0FCSUFBQUl6bEkrcHl3Y1BtM21oV2drQ3NqQk92VmtpbUVsRzlabENCbFhkKzJYampMS2c1R3FvZVpYcXZzT1FYSy9palVaVEtWVUZBRHM9IiwiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoRWdBU0FLRUNBSmVYbDdHdnJmLy8vLy8vL3lINUJBRUtBQUlBTEFBQUFBQVNBQklBQUFJd2xJK3B5d2NQbTNtaFdna0NzakJPdlZraW1FbEc5WmxDdVlJWTZUWXMrNmJtSERPNGlnZmREM0dOaGhlVjBWUUFBRHM9IiksdGhpcy5jdXRJbWc9bmV3IEFycmF5KDAsMCwwKSx0aGlzLmN1dEltYWdlPSJidXRfY3V0LmdpZiIsZGh4NC5fZXZlbnRhYmxlKHRoaXMpLHRoaXMuaHRtbE5vZGU9bmV3IGRodG1sWFRyZWVJdGVtT2JqZWN0KHRoaXMucm9vdElkLCIiLDAsdGhpcyksdGhpcy5odG1sTm9kZS5odG1sTm9kZS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMF0uc3R5bGUuZGlzcGxheT0ibm9uZSIsdGhpcy5odG1sTm9kZS5odG1sTm9kZS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1swXS5jbGFzc05hbWU9ImhpZGRlblJvdyIsdGhpcy5hbGxUcmVlPXRoaXMuX2NyZWF0ZVNlbGYoKSx0aGlzLmFsbFRyZWUuYXBwZW5kQ2hpbGQodGhpcy5odG1sTm9kZS5odG1sTm9kZSksZGh0bWx4LiRjdXN0b21TY3JvbGwmJmRodG1seC5DdXN0b21TY3JvbGwuZW5hYmxlKHRoaXMpLF9pc0ZGJiYodGhpcy5hbGxUcmVlLmNoaWxkTm9kZXNbMF0ud2lkdGg9IjEwMCUiLHRoaXMuYWxsVHJlZS5jaGlsZE5vZGVzWzBdLnN0eWxlLm92ZXJmbG93PSJoaWRkZW4iKTt2YXIgcj10aGlzO2lmKHRoaXMuYWxsVHJlZS5vbnNlbGVjdHN0YXJ0PW5ldyBGdW5jdGlvbigicmV0dXJuIGZhbHNlOyIpLF9pc01hY09TJiYodGhpcy5hbGxUcmVlLm9uY29udGV4dG1lbnU9ZnVuY3Rpb24oZSl7cmV0dXJuIHIuX2RvQ29udENsaWNrKGV8fHdpbmRvdy5ldmVudCwhMCl9KSx0aGlzLmFsbFRyZWUub25tb3VzZWRvd249ZnVuY3Rpb24oZSl7cmV0dXJuIHIuX2RvQ29udENsaWNrKGV8fHdpbmRvdy5ldmVudCl9LHRoaXMuWE1MTG9hZGVyPXRoaXMuX3BhcnNlWE1MVHJlZSxfaXNJRSYmdGhpcy5wcmV2ZW50SUVDYXNoaW5nKCEwKSx0aGlzLnNlbGVjdGlvbkJhcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJESVYiKSx0aGlzLnNlbGVjdGlvbkJhci5jbGFzc05hbWU9InNlbGVjdGlvbkJhciIsdGhpcy5zZWxlY3Rpb25CYXIuaW5uZXJIVE1MPSImbmJzcDsiLHRoaXMuc2VsZWN0aW9uQmFyLnN0eWxlLmRpc3BsYXk9Im5vbmUiLHRoaXMuYWxsVHJlZS5hcHBlbmRDaGlsZCh0aGlzLnNlbGVjdGlvbkJhciksd2luZG93LmFkZEV2ZW50TGlzdGVuZXImJndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJ1bmxvYWQiLGZ1bmN0aW9uKCl7dHJ5e3IuZGVzdHJ1Y3RvcigpfWNhdGNoKGUpe319LCExKSx3aW5kb3cuYXR0YWNoRXZlbnQmJndpbmRvdy5hdHRhY2hFdmVudCgib251bmxvYWQiLGZ1bmN0aW9uKCl7dHJ5e3IuZGVzdHJ1Y3RvcigpfWNhdGNoKGUpe319KSx0aGlzLnNldEltYWdlc1BhdGg9dGhpcy5zZXRJbWFnZVBhdGgsdGhpcy5zZXRJY29uc1BhdGg9dGhpcy5zZXRJY29uUGF0aCx0aGlzLnNldFNraW4oIm1hdGVyaWFsIiksZGh0bWx4LmltYWdlX3BhdGgpe3ZhciBsPWRodG1seC5pbWFnZV9wYXRoLHM9dGhpcy5wYXJlbnRPYmplY3QuY2xhc3NOYW1lLm1hdGNoKC9kaHh0cmVlX2RoeF8oW2Etel9dKikvaSk7bnVsbCE9cyYmbnVsbCE9c1sxXSYmKGwrPSJkaHh0cmVlXyIrc1sxXSsiLyIpLHRoaXMuc2V0SW1hZ2VQYXRoKGwpfXJldHVybiB0aGlzfWZ1bmN0aW9uIGNPYmplY3QoKXtyZXR1cm4gdGhpc31mdW5jdGlvbiBkaHRtbFhUcmVlSXRlbU9iamVjdChlLHQsaSxuLG8scil7cmV0dXJuIHRoaXMuaHRtbE5vZGU9IiIsdGhpcy5hY29sb3I9IiIsdGhpcy5zY29sb3I9IiIsdGhpcy50cj0wLHRoaXMuY2hpbGRzQ291bnQ9MCx0aGlzLnRlbXBET01NPTAsdGhpcy50ZW1wRE9NVT0wLHRoaXMuZHJhZ1NwYW49MCx0aGlzLmRyYWdNb3ZlPTAsdGhpcy5zcGFuPTAsdGhpcy5jbG9zZWJsZT0xLHRoaXMuY2hpbGROb2Rlcz1uZXcgQXJyYXksdGhpcy51c2VyRGF0YT1uZXcgY09iamVjdCx0aGlzLmNoZWNrc3RhdGU9MCx0aGlzLnRyZWVOb2Q9bix0aGlzLmxhYmVsPXQsdGhpcy5wYXJlbnRPYmplY3Q9aSx0aGlzLmFjdGlvbkhhbmRsZXI9byx0aGlzLmltYWdlcz1uZXcgQXJyYXkobi5pbWFnZUFycmF5WzBdLG4uaW1hZ2VBcnJheVsxXSxuLmltYWdlQXJyYXlbMl0pLHRoaXMuaWQ9bi5fZ2xvYmFsSWRTdG9yYWdlQWRkKGUsdGhpcyksdGhpcy50cmVlTm9kLmNoZWNrQm94T2ZmP3RoaXMuaHRtbE5vZGU9dGhpcy50cmVlTm9kLl9jcmVhdGVJdGVtKDEsdGhpcyxyKTp0aGlzLmh0bWxOb2RlPXRoaXMudHJlZU5vZC5fY3JlYXRlSXRlbSgwLHRoaXMsciksdGhpcy5odG1sTm9kZS5vYmpCZWxvbmc9dGhpcyx0aGlzfWZ1bmN0aW9uIGpzb25Qb2ludGVyKGUsdCl7dGhpcy5kPWUsdGhpcy5kcD10fWZ1bmN0aW9uIGRoeF9pbml0X3RyZWVzKCl7Zm9yKHZhciBlPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJkaXYiKSx0PTA7dDxlLmxlbmd0aDt0KyspImRodG1seFRyZWUiPT1lW3RdLmNsYXNzTmFtZSYmZGh0bWxYVHJlZUZyb21IVE1MKGVbdF0pfXZhciBibGFua19iYXNlNjQ9ImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEVnQVNBSUFBQVAvLy8vLy8veUg1QkFVVUFBRUFMQUFBQUFBU0FCSUFBQUlQakkrcHkrMFBvNXkwMm91ejNwd1hBRHM9IjsidW5kZWZpbmVkIj09dHlwZW9mIHdpbmRvdy5kaHgmJih3aW5kb3cuZGh4PXdpbmRvdy5kaHg0PXt2ZXJzaW9uOiI1LjAiLHNraW46bnVsbCxsYXN0SWQ6MSxuZXdJZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxhc3RJZCsrfSx6aW06e2RhdGE6e30sc3RlcDo1LGZpcnN0OmZ1bmN0aW9uKCl7cmV0dXJuIDEwMH0sbGFzdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZmlyc3QoKTtmb3IodmFyIHQgaW4gdGhpcy5kYXRhKWU9TWF0aC5tYXgoZSx0aGlzLmRhdGFbdF0pO3JldHVybiBlfSxyZXNlcnZlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmRhdGFbZV09dGhpcy5sYXN0KCkrdGhpcy5zdGVwLHRoaXMuZGF0YVtlXX0sY2xlYXI6ZnVuY3Rpb24oZSl7bnVsbCE9dGhpcy5kYXRhW2VdJiYodGhpcy5kYXRhW2VdPW51bGwsZGVsZXRlIHRoaXMuZGF0YVtlXSl9fSxzMmI6ZnVuY3Rpb24oZSl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiBlJiYoZT1lLnRvTG93ZXJDYXNlKCkpLDE9PWV8fDE9PWV8fCJ0cnVlIj09ZXx8IjEiPT1lfHwieWVzIj09ZXx8InkiPT1lfHwib24iPT1lfSxzMmo6ZnVuY3Rpb24ocyl7dmFyIG9iaj1udWxsO2RoeDQudGVtcD1udWxsO3RyeXtldmFsKCJkaHg0LnRlbXA9IitzKX1jYXRjaChlKXtkaHg0LnRlbXA9bnVsbH1yZXR1cm4gb2JqPWRoeDQudGVtcCxkaHg0LnRlbXA9bnVsbCxvYmp9LGFic0xlZnQ6ZnVuY3Rpb24oZSl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiBlJiYoZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKSksdGhpcy5nZXRPZmZzZXQoZSkubGVmdH0sYWJzVG9wOmZ1bmN0aW9uKGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZSYmKGU9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSkpLHRoaXMuZ2V0T2Zmc2V0KGUpLnRvcH0sX2FPZnM6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTAsaT0wO2U7KXQrPXBhcnNlSW50KGUub2Zmc2V0VG9wKSxpKz1wYXJzZUludChlLm9mZnNldExlZnQpLGU9ZS5vZmZzZXRQYXJlbnQ7cmV0dXJue3RvcDp0LGxlZnQ6aX19LF9hT2ZzUmVjdDpmdW5jdGlvbihlKXt2YXIgdD1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGk9ZG9jdW1lbnQuYm9keSxuPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxvPXdpbmRvdy5wYWdlWU9mZnNldHx8bi5zY3JvbGxUb3B8fGkuc2Nyb2xsVG9wLHI9d2luZG93LnBhZ2VYT2Zmc2V0fHxuLnNjcm9sbExlZnR8fGkuc2Nyb2xsTGVmdCxsPW4uY2xpZW50VG9wfHxpLmNsaWVudFRvcHx8MCxzPW4uY2xpZW50TGVmdHx8aS5jbGllbnRMZWZ0fHwwLGE9dC50b3Arby1sLGQ9dC5sZWZ0K3ItcztyZXR1cm57dG9wOk1hdGgucm91bmQoYSksbGVmdDpNYXRoLnJvdW5kKGQpfX0sZ2V0T2Zmc2V0OmZ1bmN0aW9uKGUpe3JldHVybiBlLmdldEJvdW5kaW5nQ2xpZW50UmVjdD90aGlzLl9hT2ZzUmVjdChlKTp0aGlzLl9hT2ZzKGUpfSxfaXNPYmo6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJiJvYmplY3QiPT10eXBlb2YgZSYmInVuZGVmaW5lZCI9PXR5cGVvZiBlLmxlbmd0aH0sX2NvcHlPYmo6ZnVuY3Rpb24oZSl7aWYodGhpcy5faXNPYmooZSkpe3ZhciB0PXt9O2Zvcih2YXIgaSBpbiBlKSJvYmplY3QiPT10eXBlb2YgZVtpXSYmbnVsbCE9ZVtpXT90W2ldPXRoaXMuX2NvcHlPYmooZVtpXSk6dFtpXT1lW2ldfWVsc2UgZm9yKHZhciB0PVtdLGk9MDtpPGUubGVuZ3RoO2krKykib2JqZWN0Ij09dHlwZW9mIGVbaV0mJm51bGwhPWVbaV0/dFtpXT10aGlzLl9jb3B5T2JqKGVbaV0pOnRbaV09ZVtpXTtyZXR1cm4gdH19LHdpbmRvdy5kaHg0LmlzSUU9bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIik+PTB8fG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiVHJpZGVudCIpPj0wLHdpbmRvdy5kaHg0LmlzSUU2PW51bGw9PXdpbmRvdy5YTUxIdHRwUmVxdWVzdCYmbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIik+PTAsd2luZG93LmRoeDQuaXNJRTc9bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDcuMCIpPj0wJiZuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIlRyaWRlbnQiKTwwLHdpbmRvdy5kaHg0LmlzSUU4PW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTVNJRSA4LjAiKT49MCYmbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJUcmlkZW50Iik+PTAsd2luZG93LmRoeDQuaXNJRTk9bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDkuMCIpPj0wJiZuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIlRyaWRlbnQiKT49MCx3aW5kb3cuZGh4NC5pc0lFMTA9bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDEwLjAiKT49MCYmbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJUcmlkZW50Iik+PTAmJjEhPXdpbmRvdy5uYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQsd2luZG93LmRoeDQuaXNJRTExPW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiVHJpZGVudCIpPj0wJiYxPT13aW5kb3cubmF2aWdhdG9yLnBvaW50ZXJFbmFibGVkLHdpbmRvdy5kaHg0LmlzRWRnZT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIkVkZ2UiKT49MCx3aW5kb3cuZGh4NC5pc09wZXJhPW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiT3BlcmEiKT49MCx3aW5kb3cuZGh4NC5pc0Nocm9tZT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIkNocm9tZSIpPj0wJiYhd2luZG93LmRoeDQuaXNFZGdlLHdpbmRvdy5kaHg0LmlzS0hUTUw9KG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiU2FmYXJpIik+PTB8fG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiS29ucXVlcm9yIik+PTApJiYhd2luZG93LmRoeDQuaXNFZGdlLHdpbmRvdy5kaHg0LmlzRkY9bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJGaXJlZm94Iik+PTAsd2luZG93LmRoeDQuaXNJUGFkPW5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKC9pUGFkL2dpKT49MCx3aW5kb3cuZGh4NC5kbmQ9e2V2czp7fSxwX2VuOih3aW5kb3cuZGh4NC5pc0lFfHx3aW5kb3cuZGh4NC5pc0VkZ2UpJiYod2luZG93Lm5hdmlnYXRvci5wb2ludGVyRW5hYmxlZHx8d2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkKSxfbVRvdWNoOmZ1bmN0aW9uKGUpe3JldHVybiB3aW5kb3cuZGh4NC5pc0lFMTAmJmUucG9pbnRlclR5cGU9PWUuTVNQT0lOVEVSX1RZUEVfTU9VU0V8fHdpbmRvdy5kaHg0LmlzSUUxMSYmIm1vdXNlIj09ZS5wb2ludGVyVHlwZXx8d2luZG93LmRoeDQuaXNFZGdlJiYibW91c2UiPT1lLnBvaW50ZXJUeXBlfSxfdG91Y2hPbjpmdW5jdGlvbihlKXtudWxsPT1lJiYoZT1kb2N1bWVudC5ib2R5KSxlLnN0eWxlLnRvdWNoQWN0aW9uPWUuc3R5bGUubXNUb3VjaEFjdGlvbj0iIixlPW51bGx9LF90b3VjaE9mZjpmdW5jdGlvbihlKXtudWxsPT1lJiYoZT1kb2N1bWVudC5ib2R5KSxlLnN0eWxlLnRvdWNoQWN0aW9uPWUuc3R5bGUubXNUb3VjaEFjdGlvbj0ibm9uZSIsZT1udWxsfX0sMT09d2luZG93Lm5hdmlnYXRvci5wb2ludGVyRW5hYmxlZD93aW5kb3cuZGh4NC5kbmQuZXZzPXtzdGFydDoicG9pbnRlcmRvd24iLG1vdmU6InBvaW50ZXJtb3ZlIixlbmQ6InBvaW50ZXJ1cCJ9OjE9PXdpbmRvdy5uYXZpZ2F0b3IubXNQb2ludGVyRW5hYmxlZD93aW5kb3cuZGh4NC5kbmQuZXZzPXtzdGFydDoiTVNQb2ludGVyRG93biIsbW92ZToiTVNQb2ludGVyTW92ZSIsZW5kOiJNU1BvaW50ZXJVcCJ9OiJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93LmFkZEV2ZW50TGlzdGVuZXImJih3aW5kb3cuZGh4NC5kbmQuZXZzPXtzdGFydDoidG91Y2hzdGFydCIsbW92ZToidG91Y2htb3ZlIixlbmQ6InRvdWNoZW5kIn0pKSwidW5kZWZpbmVkIj09dHlwZW9mIHdpbmRvdy5kaHg0Ll9ldmVudGFibGUmJih3aW5kb3cuZGh4NC5fZXZlbnRhYmxlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuImNsZWFyIj09dD8oZS5kZXRhY2hBbGxFdmVudHMoKSxlLmRoeGV2cz1udWxsLGUuYXR0YWNoRXZlbnQ9bnVsbCxlLmRldGFjaEV2ZW50PW51bGwsZS5jaGVja0V2ZW50PW51bGwsZS5jYWxsRXZlbnQ9bnVsbCxlLmRldGFjaEFsbEV2ZW50cz1udWxsLHZvaWQoZT1udWxsKSk6KGUuZGh4ZXZzPXtkYXRhOnt9fSxlLmF0dGFjaEV2ZW50PWZ1bmN0aW9uKGUsdCl7ZT1TdHJpbmcoZSkudG9Mb3dlckNhc2UoKSx0aGlzLmRoeGV2cy5kYXRhW2VdfHwodGhpcy5kaHhldnMuZGF0YVtlXT17fSk7dmFyIGk9d2luZG93LmRoeDQubmV3SWQoKTtyZXR1cm4gdGhpcy5kaHhldnMuZGF0YVtlXVtpXT10LGl9LGUuZGV0YWNoRXZlbnQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIHRoaXMuZGh4ZXZzLmRhdGEpe3ZhciBpPTA7Zm9yKHZhciBuIGluIHRoaXMuZGh4ZXZzLmRhdGFbdF0pbj09ZT8odGhpcy5kaHhldnMuZGF0YVt0XVtuXT1udWxsLGRlbGV0ZSB0aGlzLmRoeGV2cy5kYXRhW3RdW25dKTppKys7MD09aSYmKHRoaXMuZGh4ZXZzLmRhdGFbdF09bnVsbCxkZWxldGUgdGhpcy5kaHhldnMuZGF0YVt0XSl9fSxlLmNoZWNrRXZlbnQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9U3RyaW5nKGUpLnRvTG93ZXJDYXNlKCksbnVsbCE9dGhpcy5kaHhldnMuZGF0YVtlXX0sZS5jYWxsRXZlbnQ9ZnVuY3Rpb24oZSx0KXtpZihlPVN0cmluZyhlKS50b0xvd2VyQ2FzZSgpLG51bGw9PXRoaXMuZGh4ZXZzLmRhdGFbZV0pcmV0dXJuITA7dmFyIGk9ITA7Zm9yKHZhciBuIGluIHRoaXMuZGh4ZXZzLmRhdGFbZV0paT10aGlzLmRoeGV2cy5kYXRhW2VdW25dLmFwcGx5KHRoaXMsdCkmJmk7cmV0dXJuIGl9LGUuZGV0YWNoQWxsRXZlbnRzPWZ1bmN0aW9uKCl7Zm9yKHZhciBlIGluIHRoaXMuZGh4ZXZzLmRhdGEpe2Zvcih2YXIgdCBpbiB0aGlzLmRoeGV2cy5kYXRhW2VdKXRoaXMuZGh4ZXZzLmRhdGFbZV1bdF09bnVsbCxkZWxldGUgdGhpcy5kaHhldnMuZGF0YVtlXVt0XTt0aGlzLmRoeGV2cy5kYXRhW2VdPW51bGwsZGVsZXRlIHRoaXMuZGh4ZXZzLmRhdGFbZV19fSx2b2lkKGU9bnVsbCkpfSxkaHg0Ll9ldmVudGFibGUoZGh4NCkpLCJ1bmRlZmluZWQiPT10eXBlb2Ygd2luZG93LmRodG1seCYmKHdpbmRvdy5kaHRtbHg9e2V4dGVuZDpmdW5jdGlvbihlLHQpe2Zvcih2YXIgaSBpbiB0KWVbaV18fChlW2ldPXRbaV0pO3JldHVybiBlfSxleHRlbmRfYXBpOmZ1bmN0aW9uKGUsdCxpKXt2YXIgbj13aW5kb3dbZV07biYmKHdpbmRvd1tlXT1mdW5jdGlvbihlKXtpZihlJiYib2JqZWN0Ij09dHlwZW9mIGUmJiFlLnRhZ05hbWUpe3ZhciBpPW4uYXBwbHkodGhpcyx0Ll9pbml0P3QuX2luaXQoZSk6YXJndW1lbnRzKTtmb3IodmFyIG8gaW4gZGh0bWx4KXRbb10mJnRoaXNbdFtvXV0oZGh0bWx4W29dKTtmb3IodmFyIG8gaW4gZSl0W29dP3RoaXNbdFtvXV0oZVtvXSk6MD09PW8uaW5kZXhPZigib24iKSYmdGhpcy5hdHRhY2hFdmVudChvLGVbb10pfWVsc2UgdmFyIGk9bi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHQuX3BhdGNoJiZ0Ll9wYXRjaCh0aGlzKSxpfHx0aGlzfSx3aW5kb3dbZV0ucHJvdG90eXBlPW4ucHJvdG90eXBlLGkmJmRodG1seC5leHRlbmQod2luZG93W2VdLnByb3RvdHlwZSxpKSl9LHVybDpmdW5jdGlvbihlKXtyZXR1cm4tMSE9ZS5pbmRleE9mKCI/Iik/IiYiOiI/In19KSxfaXNGRj0hMSxfaXNJRT0hMSxfaXNPcGVyYT0hMSxfaXNLSFRNTD0hMSxfaXNNYWNPUz0hMSxfaXNDaHJvbWU9ITEsX0ZGcnY9ITEsX0tIVE1McnY9ITEsX09wZXJhUnY9ITEsLTEhPW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTWFjaW50b3NoIikmJihfaXNNYWNPUz0hMCksbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoImNocm9tZSIpPi0xJiYoX2lzQ2hyb21lPSEwKSwtMSE9bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJTYWZhcmkiKXx8LTEhPW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiS29ucXVlcm9yIik/KF9LSFRNTHJ2PXBhcnNlRmxvYXQobmF2aWdhdG9yLnVzZXJBZ2VudC5zdWJzdHIobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJTYWZhcmkiKSs3LDUpKSxfS0hUTUxydj41MjU/KF9pc0ZGPSEwLF9GRnJ2PTEuOSk6X2lzS0hUTUw9ITApOi0xIT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIk9wZXJhIik/KF9pc09wZXJhPSEwLF9PcGVyYVJ2PXBhcnNlRmxvYXQobmF2aWdhdG9yLnVzZXJBZ2VudC5zdWJzdHIobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJPcGVyYSIpKzYsMykpKTotMSE9bmF2aWdhdG9yLmFwcE5hbWUuaW5kZXhPZigiTWljcm9zb2Z0Iik/KF9pc0lFPSEwLCgtMSE9bmF2aWdhdG9yLmFwcFZlcnNpb24uaW5kZXhPZigiTVNJRSA4LjAiKXx8LTEhPW5hdmlnYXRvci5hcHBWZXJzaW9uLmluZGV4T2YoIk1TSUUgOS4wIil8fC0xIT1uYXZpZ2F0b3IuYXBwVmVyc2lvbi5pbmRleE9mKCJNU0lFIDEwLjAiKXx8ZG9jdW1lbnQuZG9jdW1lbnRNb2RlPjcpJiYiQmFja0NvbXBhdCIhPWRvY3VtZW50LmNvbXBhdE1vZGUmJihfaXNJRT04KSk6Ik5ldHNjYXBlIj09bmF2aWdhdG9yLmFwcE5hbWUmJi0xIT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIlRyaWRlbnQiKT9faXNJRT04OihfaXNGRj0hMCxfRkZydj1wYXJzZUZsb2F0KG5hdmlnYXRvci51c2VyQWdlbnQuc3BsaXQoInJ2OiIpWzFdKSksInVuZGVmaW5lZCI9PXR5cGVvZiB3aW5kb3cuZGh0bWx4RXZlbnQsbnVsbD09ZGh0bWx4RXZlbnQudG91Y2hEZWxheSYmKGRodG1seEV2ZW50LnRvdWNoRGVsYXk9MmUzKSwidW5kZWZpbmVkIj09dHlwZW9mIGRodG1seEV2ZW50LmluaXRUb3VjaCYmKGRodG1seEV2ZW50LmluaXRUb3VjaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtpZihpKXt2YXIgZT1kb2N1bWVudC5jcmVhdGVFdmVudCgiSFRNTEV2ZW50cyIpO2UuaW5pdEV2ZW50KCJkYmxjbGljayIsITAsITApLGkuZGlzcGF0Y2hFdmVudChlKSx0PWk9bnVsbH19dmFyIHQsaSxuLG87ZGh0bWx4RXZlbnQoZG9jdW1lbnQuYm9keSwidG91Y2hzdGFydCIsZnVuY3Rpb24ocil7aT1yLnRvdWNoZXNbMF0udGFyZ2V0LG49ci50b3VjaGVzWzBdLmNsaWVudFgsbz1yLnRvdWNoZXNbMF0uY2xpZW50WSx0PXdpbmRvdy5zZXRUaW1lb3V0KGUsZGh0bWx4RXZlbnQudG91Y2hEZWxheSl9KSxkaHRtbHhFdmVudChkb2N1bWVudC5ib2R5LCJ0b3VjaG1vdmUiLGZ1bmN0aW9uKGUpe3QmJihNYXRoLmFicyhlLnRvdWNoZXNbMF0uY2xpZW50WC1uKT41MHx8TWF0aC5hYnMoZS50b3VjaGVzWzBdLmNsaWVudFktbyk+NTApJiYod2luZG93LmNsZWFyVGltZW91dCh0KSx0PWk9ITEpfSksZGh0bWx4RXZlbnQoZG9jdW1lbnQuYm9keSwidG91Y2hlbmQiLGZ1bmN0aW9uKGUpe3QmJih3aW5kb3cuY2xlYXJUaW1lb3V0KHQpLHQ9aT0hMSl9KSxkaHRtbHhFdmVudC5pbml0VG91Y2g9ZnVuY3Rpb24oKXt9fSksZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2RvQ29udENsaWNrPWZ1bmN0aW9uKGUsdCl7aWYoIXQmJjIhPWUuYnV0dG9uKXJldHVybiB0aGlzLl9hY01lbnUmJih0aGlzLl9hY01lbnUuaGlkZUNvbnRleHRNZW51P3RoaXMuX2FjTWVudS5oaWRlQ29udGV4dE1lbnUoKTp0aGlzLmNNZW51Ll9jb250ZXh0RW5kKCkpLCEwO2Zvcih2YXIgaT1faXNJRT9lLnNyY0VsZW1lbnQ6ZS50YXJnZXQ7aSYmIkJPRFkiIT1pLnRhZ05hbWUmJiFpLnBhcmVudE9iamVjdDspaT1pLnBhcmVudE5vZGU7aWYoIWl8fCFpLnBhcmVudE9iamVjdClyZXR1cm4hMDt2YXIgbj1pLnBhcmVudE9iamVjdDtpZih0aGlzLmNhbGxFdmVudCgib25SaWdodENsaWNrIixbbi5pZCxlXSl8fCgoZS5zcmNFbGVtZW50fHxlLnRhcmdldCkub25jb250ZXh0bWVudT1mdW5jdGlvbihlKXtyZXR1cm4oZXx8ZXZlbnQpLmNhbmNlbEJ1YmJsZT0hMCwhMX0pLHRoaXMuX2FjTWVudT1uLmNNZW51fHx0aGlzLmNNZW51LHRoaXMuX2FjTWVudSl7aWYoIXRoaXMuY2FsbEV2ZW50KCJvbkJlZm9yZUNvbnRleHRNZW51Iixbbi5pZF0pKXJldHVybiEwO2lmKF9pc01hY09TfHwoKGUuc3JjRWxlbWVudHx8ZS50YXJnZXQpLm9uY29udGV4dG1lbnU9ZnVuY3Rpb24oZSl7cmV0dXJuKGV8fGV2ZW50KS5jYW5jZWxCdWJibGU9ITAsITF9KSx0aGlzLl9hY01lbnUuc2hvd0NvbnRleHRNZW51KXt2YXIgbz13aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LHI9d2luZG93LmRvY3VtZW50LmJvZHksbD1uZXcgQXJyYXkoby5zY3JvbGxMZWZ0fHxyLnNjcm9sbExlZnQsby5zY3JvbGxUb3B8fHIuc2Nyb2xsVG9wKTtpZihfaXNJRSl2YXIgcz1lLmNsaWVudFgrbFswXSxhPWUuY2xpZW50WStsWzFdO2Vsc2UgdmFyIHM9ZS5wYWdlWCxhPWUucGFnZVk7dGhpcy5fYWNNZW51LnNob3dDb250ZXh0TWVudShzLTEsYS0xKSx0aGlzLmNvbnRleHRJRD1uLmlkLGUuY2FuY2VsQnViYmxlPSEwLHRoaXMuX2FjTWVudS5fc2tpcF9oaWRlPSEwfWVsc2UgaS5jb250ZXh0TWVudUlkPW4uaWQsaS5jb250ZXh0TWVudT10aGlzLl9hY01lbnUsaS5hPXRoaXMuX2FjTWVudS5fY29udGV4dFN0YXJ0LGkuYShpLGUpLGkuYT1udWxsO3JldHVybiExfXJldHVybiEwfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5lbmFibGVJRUltYWdlRml4PWZ1bmN0aW9uKGUpe2U/KHRoaXMuX2dldEltZz1mdW5jdGlvbigpe3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIkRJViIpO3JldHVybiBlLmlubmVySFRNTD0iJm5ic3A7IixlLmNsYXNzTmFtZT0iZGh4X2JnX2ltZ19maXgiLGV9LHRoaXMuX3NldFNyYz1mdW5jdGlvbihlLHQpe2Uuc3R5bGUuYmFja2dyb3VuZEltYWdlPSJ1cmwoIit0KyIpIn0sdGhpcy5fZ2V0U3JjPWZ1bmN0aW9uKGUpe3ZhciB0PWUuc3R5bGUuYmFja2dyb3VuZEltYWdlO3JldHVybiB0LnN1YnN0cig0LHQubGVuZ3RoLTUpLnJlcGxhY2UoLyheIil8KCIkKS9nLCIiKX0pOih0aGlzLl9nZXRJbWc9ZnVuY3Rpb24oZSl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZT09dGhpcy5yb290SWQ/ImRpdiI6ImltZyIpfSx0aGlzLl9zZXRTcmM9ZnVuY3Rpb24oZSx0KXtlLnNyYz10fSx0aGlzLl9nZXRTcmM9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuc3JjfSl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLmRlc3RydWN0b3I9ZnVuY3Rpb24oKXtmb3IodmFyIGUgaW4gdGhpcy5faWRwdWxsKXt2YXIgdD10aGlzLl9pZHB1bGxbZV07dCYmKHQucGFyZW50T2JqZWN0PW51bGwsdC50cmVlTm9kPW51bGwsdC5jaGlsZE5vZGVzPW51bGwsdC5zcGFuPW51bGwsdC50ci5ub2RlbT1udWxsLHQudHI9bnVsbCx0Lmh0bWxOb2RlLm9iakJlbG9uZz1udWxsLHQuaHRtbE5vZGU9bnVsbCx0aGlzLl9pZHB1bGxbZV09bnVsbCl9dGhpcy5wYXJlbnRPYmplY3QuaW5uZXJIVE1MPSIiLHRoaXMuYWxsVHJlZS5vbnNlbGVjdHN0YXJ0PW51bGwsdGhpcy5hbGxUcmVlLm9uY29udGV4dG1lbnU9bnVsbCx0aGlzLmFsbFRyZWUub25tb3VzZWRvd249bnVsbDtmb3IodmFyIGUgaW4gdGhpcyl0aGlzW2VdPW51bGx9LGNPYmplY3QucHJvdG90eXBlPW5ldyBPYmplY3QsY09iamVjdC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlLnByb3RvdHlwZT10aGlzLG5ldyBlfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fZ2xvYmFsSWRTdG9yYWdlQWRkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2dsb2JhbElkU3RvcmFnZUZpbmQoZSwxLDEpPyhlPWUrIl8iKyhuZXcgRGF0ZSkudmFsdWVPZigpLHRoaXMuX2dsb2JhbElkU3RvcmFnZUFkZChlLHQpKToodGhpcy5faWRwdWxsW2VdPXQsdGhpcy5fcHVsbFNpemUrKyxlKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2dsb2JhbElkU3RvcmFnZVN1Yj1mdW5jdGlvbihlKXt0aGlzLl9pZHB1bGxbZV0mJih0aGlzLl91bnNlbGVjdEl0ZW0odGhpcy5faWRwdWxsW2VdKSx0aGlzLl9pZHB1bGxbZV09bnVsbCx0aGlzLl9wdWxsU2l6ZS0tKSx0aGlzLl9sb2NrZXImJnRoaXMuX2xvY2tlcltlXSYmKHRoaXMuX2xvY2tlcltlXT0hMSl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLl9nbG9iYWxJZFN0b3JhZ2VGaW5kPWZ1bmN0aW9uKGUsdCxpLG4pe3ZhciBvPXRoaXMuX2lkcHVsbFtlXTtpZihvKXtpZihvLnVuUGFyc2VkJiYhaSYmdGhpcy5yZVBhcnNlKG8sMCksdGhpcy5fc3JuZCYmIW8uaHRtbE5vZGUmJnRoaXMuX2J1aWxkU1JORChvLGkpLG4mJnRoaXMuX2Vkc2Jwc0EpZm9yKHZhciByPTA7cjx0aGlzLl9lZHNicHNBLmxlbmd0aDtyKyspaWYodGhpcy5fZWRzYnBzQVtyXVsyXT09ZSlyZXR1cm4gZGh4NC5jYWxsRXZlbnQoIm9uZ2V0SXRlbUVycm9yIixbIlJlcXVlc3RlZCBpdGVtIHN0aWxsIGluIHBhcnNpbmcgcHJvY2Vzcy4iLGVdKSxudWxsO3JldHVybiBvfXJldHVybiB0aGlzLnNsb3dQYXJzZSYmMCE9ZSYmIXQ/dGhpcy5wcmVQYXJzZShlKTpudWxsfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fZHJhd05ld1RyPWZ1bmN0aW9uKGUsdCl7dmFyIGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidHIiKSxuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIiksbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZCIpO3JldHVybiBuLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCIgIikpLG8uY29sU3Bhbj0zLG8uYXBwZW5kQ2hpbGQoZSksaS5hcHBlbmRDaGlsZChuKSxpLmFwcGVuZENoaWxkKG8pLGl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLnBhcnNlPWZ1bmN0aW9uKGUsdCxpKXtpZigic3RyaW5nIj09dHlwZW9mIHQmJihpPXQsdD1udWxsKSwianNvbiI9PT1pKXJldHVybiB0aGlzLl9sb2FkSlNPTk9iamVjdChlLHQpO2lmKCJjc3YiPT09aSlyZXR1cm4gdGhpcy5fbG9hZENTVlN0cmluZyhlLHQpO2lmKCJqc2FycmF5Ij09PWkpcmV0dXJuIHRoaXMuX2xvYWRKU0FycmF5KGUsdCk7dmFyIG49dGhpczt0aGlzLnBhcnNDb3VudHx8dGhpcy5jYWxsRXZlbnQoIm9uWExTIixbbixudWxsXSksdGhpcy54bWxzdGF0ZT0xLHRoaXMuWE1MTG9hZGVyKHtyZXNwb25zZVhNTDpkaHg0LmFqYXgucGFyc2UoZSl9LHQpfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fYXR0YWNoQ2hpbGROb2RlPWZ1bmN0aW9uKGUsdCxpLG4sbyxyLGwscyxhLGQsaCl7ZCYmZC5wYXJlbnRPYmplY3QmJihlPWQucGFyZW50T2JqZWN0KSwwPT1lLlhNTGxvYWQmJnRoaXMuWE1Mc291cmNlJiYhdGhpcy5YTUxsb2FkaW5nV2FybmluZyYmKGUuWE1MbG9hZD0xLHRoaXMuX2xvYWREeW5YTUwoZS5pZCkpO3ZhciBjPWUuY2hpbGRzQ291bnQsdT1lLmNoaWxkTm9kZXM7aWYoaCYmaC50ci5wcmV2aW91c1NpYmxpbmcmJihoLnRyLnByZXZpb3VzU2libGluZy5wcmV2aW91c1NpYmxpbmc/ZD1oLnRyLnByZXZpb3VzU2libGluZy5ub2RlbTpzPXMucmVwbGFjZSgiVE9QIiwiIikrIixUT1AiKSxkKXt2YXIgcCxfO2ZvcihwPTA7Yz5wO3ArKylpZih1W3BdPT1kKXtmb3IoXz1jO18hPXA7Xy0tKXVbMStfXT11W19dO2JyZWFrfXArKyxjPXB9aWYocylmb3IodmFyIG09cy5zcGxpdCgiLCIpLGc9MDtnPG0ubGVuZ3RoO2crKylzd2l0Y2gobVtnXSl7Y2FzZSJUT1AiOmZvcihlLmNoaWxkc0NvdW50PjAmJihkPW5ldyBPYmplY3QsZC50cj1lLmNoaWxkTm9kZXNbMF0udHIucHJldmlvdXNTaWJsaW5nKSxlLl9oYXNfdG9wPSEwLHA9YztwPjA7cC0tKXVbcF09dVtwLTFdO2M9MH12YXIgZjsoZj10aGlzLl9pZHB1bGxbdF0pJiYtMT09Zi5zcGFufHwoZj11W2NdPW5ldyBkaHRtbFhUcmVlSXRlbU9iamVjdCh0LGksZSx0aGlzLG4sMSksdD11W2NdLmlkLGUuY2hpbGRzQ291bnQrKyksZi5odG1sTm9kZXx8KGYubGFiZWw9aSxmLmh0bWxOb2RlPXRoaXMuX2NyZWF0ZUl0ZW0odGhpcy5jaGVja0JveE9mZj8xOjAsZiksZi5odG1sTm9kZS5vYmpCZWxvbmc9ZiksbyYmKGYuaW1hZ2VzWzBdPW8pLHImJihmLmltYWdlc1sxXT1yKSxsJiYoZi5pbWFnZXNbMl09bCk7dmFyIGI9dGhpcy5fZHJhd05ld1RyKGYuaHRtbE5vZGUpO2lmKCh0aGlzLlhNTGxvYWRpbmdXYXJuaW5nfHx0aGlzLl9oQWRJKSYmKGYuaHRtbE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnN0eWxlLmRpc3BsYXk9Im5vbmUiKSxkJiZkLnRyJiZkLnRyLm5leHRTaWJsaW5nP2UuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5pbnNlcnRCZWZvcmUoYixkLnRyLm5leHRTaWJsaW5nKTp0aGlzLnBhcnNpbmdPbj09ZS5pZD90aGlzLnBhcnNlZEFycmF5W3RoaXMucGFyc2VkQXJyYXkubGVuZ3RoXT1iOmUuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5hcHBlbmRDaGlsZChiKSxkJiYhZC5zcGFuJiYoZD1udWxsKSx0aGlzLlhNTHNvdXJjZSYmKGEmJjAhPWE/Zi5YTUxsb2FkPTA6Zi5YTUxsb2FkPTEpLGYudHI9YixiLm5vZGVtPWYsMD09ZS5pdGVtSWQmJihiLmNoaWxkTm9kZXNbMF0uY2xhc3NOYW1lPSJoaWRkZW5Sb3ciKSwoZS5fcl9sb2dpY3x8dGhpcy5fZnJidHIpJiZ0aGlzLl9zZXRTcmMoZi5odG1sTm9kZS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1sxXS5jaGlsZE5vZGVzWzBdLHRoaXMuaW1QYXRoK3RoaXMucmFkaW9BcnJheVswXSkscylmb3IodmFyIG09cy5zcGxpdCgiLCIpLGc9MDtnPG0ubGVuZ3RoO2crKylzd2l0Y2gobVtnXSl7Y2FzZSJTRUxFQ1QiOnRoaXMuc2VsZWN0SXRlbSh0LCExKTticmVhaztjYXNlIkNBTEwiOnRoaXMuc2VsZWN0SXRlbSh0LCEwKTticmVhaztjYXNlIkNISUxEIjpmLlhNTGxvYWQ9MDticmVhaztjYXNlIkNIRUNLRUQiOnRoaXMuWE1MbG9hZGluZ1dhcm5pbmc/dGhpcy5zZXRDaGVja0xpc3QrPXRoaXMuZGxtdHIrdDp0aGlzLnNldENoZWNrKHQsMSk7YnJlYWs7Y2FzZSJIQ0hFQ0tFRCI6dGhpcy5fc2V0Q2hlY2soZiwidW5zdXJlIik7YnJlYWs7Y2FzZSJPUEVOIjpmLm9wZW5NZT0xfWlmKCF0aGlzLlhNTGxvYWRpbmdXYXJuaW5nJiYodGhpcy5fZ2V0T3BlblN0YXRlKGUpPDAmJiF0aGlzLl9oQWRJJiZ0aGlzLm9wZW5JdGVtKGUuaWQpLGQmJih0aGlzLl9jb3JyZWN0UGx1cyhkKSx0aGlzLl9jb3JyZWN0TGluZShkKSksdGhpcy5fY29ycmVjdFBsdXMoZSksdGhpcy5fY29ycmVjdExpbmUoZSksdGhpcy5fY29ycmVjdFBsdXMoZiksZS5jaGlsZHNDb3VudD49MiYmKHRoaXMuX2NvcnJlY3RQbHVzKHVbZS5jaGlsZHNDb3VudC0yXSksdGhpcy5fY29ycmVjdExpbmUodVtlLmNoaWxkc0NvdW50LTJdKSksMiE9ZS5jaGlsZHNDb3VudCYmdGhpcy5fY29ycmVjdFBsdXModVswXSksdGhpcy50c2NoZWNrJiZ0aGlzLl9jb3JyZWN0Q2hlY2tTdGF0ZXMoZSksdGhpcy5fb25yYWRoKSlpZigxPT10aGlzLnhtbHN0YXRlKXt2YXIgdj10aGlzLm9uWExFO3RoaXMub25YTEU9ZnVuY3Rpb24oZSl7dGhpcy5fb25yYWRoKHQpLHYmJnYoZSl9fWVsc2UgdGhpcy5fb25yYWRoKHQpO3JldHVybiBmfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fcGFyc2VJdGVtPWZ1bmN0aW9uKGUsdCxpLG4pe3ZhciBvO2lmKHRoaXMuX3NybmQmJighdGhpcy5faWRwdWxsW289ZS5nZXQoImlkIildfHwhdGhpcy5faWRwdWxsW29dLnNwYW4pKXJldHVybiB2b2lkIHRoaXMuX2FkZEl0ZW1TUk5EKHQuaWQsbyxlKTt2YXIgcj1lLmdldF9hbGwoKTtpZigib2JqZWN0Ij09dHlwZW9mIHRoaXMud2FpdFVwZGF0ZVhNTCYmIXRoaXMud2FpdFVwZGF0ZVhNTFtyLmlkXSlyZXR1cm4gdm9pZCB0aGlzLl9wYXJzZShlLHIuaWQsMSk7bnVsbCE9PXIudGV4dCYmInVuZGVmaW5lZCIhPXR5cGVvZiByLnRleHR8fChyLnRleHQ9ZS5zdWIoIml0ZW10ZXh0Iiksci50ZXh0JiYoci50ZXh0PXIudGV4dC5jb250ZW50KCkpKTt2YXIgbD1bXTtpZihyLnNlbGVjdCYmbC5wdXNoKCJTRUxFQ1QiKSxyLnRvcCYmbC5wdXNoKCJUT1AiKSxyLmNhbGwmJih0aGlzLm5vZGVBc2tpbmdDYWxsPXIuaWQpLC0xPT1yLmNoZWNrZWQ/bC5wdXNoKCJIQ0hFQ0tFRCIpOnIuY2hlY2tlZCYmbC5wdXNoKCJDSEVDS0VEIiksci5vcGVuJiZsLnB1c2goIk9QRU4iKSx0aGlzLndhaXRVcGRhdGVYTUwpaWYodGhpcy5fZ2xvYmFsSWRTdG9yYWdlRmluZChyLmlkKSl2YXIgcz10aGlzLnVwZGF0ZUl0ZW0oci5pZCxyLnRleHQsci5pbTAsci5pbTEsci5pbTIsci5jaGVja2VkLHIuY2hpbGQpO2Vsc2V7MD09dGhpcy5ucGw/bC5wdXNoKCJUT1AiKTppPXQuY2hpbGROb2Rlc1t0aGlzLm5wbF07dmFyIHM9dGhpcy5fYXR0YWNoQ2hpbGROb2RlKHQsci5pZCxyLnRleHQsMCxyLmltMCxyLmltMSxyLmltMixsLmpvaW4oIiwiKSxyLmNoaWxkLDAsaSk7ci5pZD1zLmlkLGk9bnVsbH1lbHNlIHZhciBzPXRoaXMuX2F0dGFjaENoaWxkTm9kZSh0LHIuaWQsci50ZXh0LDAsci5pbTAsci5pbTEsci5pbTIsbC5qb2luKCIsIiksci5jaGlsZCxufHwwLGkpO2lmKHIudG9vbHRpcCYmKHMuc3Bhbi5wYXJlbnROb2RlLnBhcmVudE5vZGUudGl0bGU9ci50b29sdGlwKSxyLnN0eWxlJiYocy5zcGFuLnN0eWxlLmNzc1RleHQ/cy5zcGFuLnN0eWxlLmNzc1RleHQrPSI7IityLnN0eWxlOnMuc3Bhbi5zZXRBdHRyaWJ1dGUoInN0eWxlIixzLnNwYW4uZ2V0QXR0cmlidXRlKCJzdHlsZSIpKyI7ICIrci5zdHlsZSkpLHIucmFkaW8mJihzLl9yX2xvZ2ljPSEwKSxyLm5vY2hlY2tib3gpe3ZhciBhPXMuc3Bhbi5wYXJlbnROb2RlLnByZXZpb3VzU2libGluZy5wcmV2aW91c1NpYmxpbmc7YS5zdHlsZS5kaXNwbGF5PSJub25lIixzLm5vY2hlY2tib3g9ITB9ci5kaXNhYmxlZCYmKG51bGwhPXIuY2hlY2tlZCYmdGhpcy5fc2V0Q2hlY2socyxyLmNoZWNrZWQpLHRoaXMuZGlzYWJsZUNoZWNrYm94KHMsMSkpLHMuX2FjYz1yLmNoaWxkfHwwLHRoaXMucGFyc2VyRXh0ZW5zaW9uJiZ0aGlzLnBhcnNlckV4dGVuc2lvbi5fcGFyc2VFeHRlbnNpb24uY2FsbCh0aGlzLGUscix0P3QuaWQ6MCksdGhpcy5zZXRJdGVtQ29sb3IocyxyLmFDb2wsci5zQ29sKSwiMSI9PXIubG9ja2VkJiZ0aGlzLmxvY2tJdGVtKHMuaWQsITAsITApLChyLmltd2lkdGh8fHIuaW1oZWlnaHQpJiZ0aGlzLnNldEljb25TaXplKHIuaW13aWR0aCxyLmltaGVpZ2h0LHMpLCIwIiE9ci5jbG9zZWFibGUmJiIxIiE9ci5jbG9zZWFibGV8fHRoaXMuc2V0SXRlbUNsb3NlYWJsZShzLHIuY2xvc2VhYmxlKTt2YXIgZD0iIjtyLnRvcG9mZnNldCYmdGhpcy5zZXRJdGVtVG9wT2Zmc2V0KHMsci50b3BvZmZzZXQpLHRoaXMuc2xvd1BhcnNlJiYib2JqZWN0IiE9dHlwZW9mIHRoaXMud2FpdFVwZGF0ZVhNTD8oIXMuY2hpbGRzQ291bnQmJmUuc3ViX2V4aXN0cygiaXRlbSIpJiYocy51blBhcnNlZD1lLmNsb25lKCkpLGUuZWFjaCgidXNlcmRhdGEiLGZ1bmN0aW9uKGUpe3RoaXMuc2V0VXNlckRhdGEoci5pZCxlLmdldCgibmFtZSIpLGUuY29udGVudCgpKX0sdGhpcykpOmUuc3ViX2V4aXN0cygiaXRlbSIpJiYoZD10aGlzLl9wYXJzZShlLHIuaWQsMSkpLCIiIT1kJiYodGhpcy5ub2RlQXNraW5nQ2FsbD1kKSxlLmVhY2goInVzZXJkYXRhIixmdW5jdGlvbih0KXt0aGlzLnNldFVzZXJEYXRhKGUuZ2V0KCJpZCIpLHQuZ2V0KCJuYW1lIiksdC5jb250ZW50KCkpfSx0aGlzKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX3BhcnNlPWZ1bmN0aW9uKGUsdCxpLG4pe2lmKHRoaXMuX3NybmQmJiF0aGlzLnBhcmVudE9iamVjdC5vZmZzZXRIZWlnaHQpe3ZhciBvPXRoaXM7cmV0dXJuIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7by5fcGFyc2UoZSx0LGksbil9LDEwMCl9aWYoZS5leGlzdHMoKSl7aWYodGhpcy5za2lwTG9jaz0hMCwhdCl7dD1lLmdldCgiaWQiKSx0aGlzLl9keW5EZWxldGVCcmFuY2hlc1t0XSYmKHRoaXMuZGVsZXRlQ2hpbGRJdGVtcyh0KSx0aGlzLl9keW5EZWxldGVCcmFuY2hlc1t0XS0tLHRoaXMuX2R5bkRlbGV0ZUJyYW5jaGVzW3RdfHxkZWxldGUgdGhpcy5fZHluRGVsZXRlQnJhbmNoZXNbdF0pO3ZhciByPWUuZ2V0KCJkaHhfc2VjdXJpdHkiKTtyJiYoZGh0bWx4LnNlY3VyaXR5X2tleT1yKSxlLmdldCgicmFkaW8iKSYmKHRoaXMuaHRtbE5vZGUuX3JfbG9naWM9ITApLHRoaXMucGFyc2luZ09uPXQsdGhpcy5wYXJzZWRBcnJheT1uZXcgQXJyYXksdGhpcy5zZXRDaGVja0xpc3Q9IiIsdGhpcy5ub2RlQXNraW5nQ2FsbD0iIn12YXIgbD10aGlzLl9nbG9iYWxJZFN0b3JhZ2VGaW5kKHQpO2lmKCFsKXJldHVybiBkaHg0LmNhbGxFdmVudCgib25EYXRhU3RydWN0dXJlRXJyb3IiLFsiWE1MIHJlZmVycyB0byBub3QgZXhpc3RpbmcgcGFyZW50Il0pO2lmKHRoaXMucGFyc0NvdW50PXRoaXMucGFyc0NvdW50P3RoaXMucGFyc0NvdW50KzE6MSx0aGlzLlhNTGxvYWRpbmdXYXJuaW5nPTEsIWwuY2hpbGRzQ291bnR8fG58fHRoaXMuX2Vkc2Jwc3x8bC5faGFzX3RvcCl2YXIgcz0wO2Vsc2UgdmFyIHM9MDtpZih0aGlzLm5wbD0wLGUuZWFjaCgiaXRlbSIsZnVuY3Rpb24obixvKXtyZXR1cm4gbC5YTUxsb2FkPTEsdGhpcy5fcGFyc2VJdGVtKG4sbCwwLHMpLHRoaXMuX2Vkc2JwcyYmdGhpcy5ucGw9PXRoaXMuX2Vkc2Jwc0M/KHRoaXMuX2Rpc3RyaWJ1dGVkU3RhcnQoZSxvKzEsdCxpLGwuY2hpbGRzQ291bnQpLC0xKTp2b2lkIHRoaXMubnBsKyt9LHRoaXMsbiksIWkpe2lmKGUuZWFjaCgidXNlcmRhdGEiLGZ1bmN0aW9uKHQpe3RoaXMuc2V0VXNlckRhdGEoZS5nZXQoImlkIiksdC5nZXQoIm5hbWUiKSx0LmNvbnRlbnQoKSl9LHRoaXMpLGwuWE1MbG9hZD0xLHRoaXMud2FpdFVwZGF0ZVhNTCl7dGhpcy53YWl0VXBkYXRlWE1MPSExO2Zvcih2YXIgYT1sLmNoaWxkc0NvdW50LTE7YT49MDthLS0pbC5jaGlsZE5vZGVzW2FdLl9kbWFyayYmdGhpcy5kZWxldGVJdGVtKGwuY2hpbGROb2Rlc1thXS5pZCl9Zm9yKHZhciBhPSh0aGlzLl9nbG9iYWxJZFN0b3JhZ2VGaW5kKHRoaXMucGFyc2luZ09uKSwwKTthPHRoaXMucGFyc2VkQXJyYXkubGVuZ3RoO2ErKylsLmh0bWxOb2RlLmNoaWxkTm9kZXNbMF0uYXBwZW5kQ2hpbGQodGhpcy5wYXJzZWRBcnJheVthXSk7dGhpcy5wYXJzZWRBcnJheT1bXSx0aGlzLmxhc3RMb2FkZWRYTUxJZD10LHRoaXMuWE1MbG9hZGluZ1dhcm5pbmc9MDtmb3IodmFyIGQ9dGhpcy5zZXRDaGVja0xpc3Quc3BsaXQodGhpcy5kbG10ciksaD0wO2g8ZC5sZW5ndGg7aCsrKWRbaF0mJnRoaXMuc2V0Q2hlY2soZFtoXSwxKTt0aGlzLlhNTHNvdXJjZSYmdGhpcy50c2NoZWNrJiZ0aGlzLnNtY2hlY2smJmwuaWQhPXRoaXMucm9vdElkJiYoMD09PWwuY2hlY2tzdGF0ZT90aGlzLl9zZXRTdWJDaGVja2VkKDAsbCk6MT09PWwuY2hlY2tzdGF0ZSYmdGhpcy5fc2V0U3ViQ2hlY2tlZCgxLGwpKSx0aGlzLl9yZWRyYXdGcm9tKHRoaXMsbnVsbCxuKSxlLmdldCgib3JkZXIiKSYmIm5vbmUiIT1lLmdldCgib3JkZXIiKSYmdGhpcy5fcmVvcmRlckJyYW5jaChsLGUuZ2V0KCJvcmRlciIpLCEwKSwiIiE9dGhpcy5ub2RlQXNraW5nQ2FsbCYmdGhpcy5jYWxsRXZlbnQoIm9uQ2xpY2siLFt0aGlzLm5vZGVBc2tpbmdDYWxsLHRoaXMuZ2V0U2VsZWN0ZWRJdGVtSWQoKV0pLHRoaXMuX2JyYW5jaFVwZGF0ZSYmdGhpcy5fYnJhbmNoVXBkYXRlTmV4dChlKX1pZigxPT10aGlzLnBhcnNDb3VudCl7aWYodGhpcy5wYXJzaW5nT249bnVsbCx0aGlzLl9zcm5kJiZsLmlkIT10aGlzLnJvb3RJZCYmKHRoaXMucHJlcGFyZVNSKGwuaWQpLHRoaXMuWE1Mc291cmNlJiZ0aGlzLm9wZW5JdGVtKGwuaWQpKSxlLnRocm91Z2goIml0ZW0iLCJvcGVuIixudWxsLGZ1bmN0aW9uKGUpe3RoaXMub3Blbkl0ZW0oZS5nZXQoImlkIikpfSx0aGlzKSwhdGhpcy5fZWRzYnBzfHwhdGhpcy5fZWRzYnBzQS5sZW5ndGgpe3ZhciBjPXRoaXM7d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtjLmNhbGxFdmVudCgib25YTEUiLFtjLHRdKX0sMSksdGhpcy54bWxzdGF0ZT0wfXRoaXMuc2tpcExvY2s9ITF9dGhpcy5wYXJzQ291bnQtLTt2YXIgYz10aGlzO3JldHVybiB0aGlzLl9lZHNicHMmJndpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Yy5fZGlzdHJpYnV0ZWRTdGVwKHQpfSx0aGlzLl9lZHNicHNEKSwhaSYmdGhpcy5vblhMRSYmdGhpcy5vblhMRSh0aGlzLHQpLHRoaXMubm9kZUFza2luZ0NhbGx9fSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fcmVkcmF3RnJvbT1mdW5jdGlvbihlLHQsaSxuKXtpZih0KW89dDtlbHNle3ZhciBvPWUuX2dsb2JhbElkU3RvcmFnZUZpbmQoZS5sYXN0TG9hZGVkWE1MSWQpO2lmKGUubGFzdExvYWRlZFhNTElkPS0xLCFvKXJldHVybiAwfWZvcih2YXIgcj0wLGw9aT9pLTE6MDtsPG8uY2hpbGRzQ291bnQ7bCsrKWlmKHRoaXMuX2JyYW5jaFVwZGF0ZSYmMSE9dGhpcy5fZ2V0T3BlblN0YXRlKG8pfHx0JiYxIT1ufHwoby5jaGlsZE5vZGVzW2xdLmh0bWxOb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5zdHlsZS5kaXNwbGF5PSIiKSwxPT1vLmNoaWxkTm9kZXNbbF0ub3Blbk1lJiYodGhpcy5fb3Blbkl0ZW0oby5jaGlsZE5vZGVzW2xdKSxvLmNoaWxkTm9kZXNbbF0ub3Blbk1lPTApLGUuX3JlZHJhd0Zyb20oZSxvLmNoaWxkTm9kZXNbbF0pLG51bGwhPXRoaXMuY2hpbGRDYWxjKXtpZigoby5jaGlsZE5vZGVzW2xdLnVuUGFyc2VkfHwhby5jaGlsZE5vZGVzW2xdLlhNTGxvYWQmJnRoaXMuWE1Mc291cmNlKSYmKG8uY2hpbGROb2Rlc1tsXS5fYWNjP28uY2hpbGROb2Rlc1tsXS5zcGFuLmlubmVySFRNTD1vLmNoaWxkTm9kZXNbbF0ubGFiZWwrdGhpcy5odG1sY0Erby5jaGlsZE5vZGVzW2xdLl9hY2MrdGhpcy5odG1sY0I6by5jaGlsZE5vZGVzW2xdLnNwYW4uaW5uZXJIVE1MPW8uY2hpbGROb2Rlc1tsXS5sYWJlbCksby5jaGlsZE5vZGVzW2xdLmNoaWxkTm9kZXMubGVuZ3RoJiZ0aGlzLmNoaWxkQ2FsYyl7aWYoMT09dGhpcy5jaGlsZENhbGMmJihvLmNoaWxkTm9kZXNbbF0uc3Bhbi5pbm5lckhUTUw9by5jaGlsZE5vZGVzW2xdLmxhYmVsK3RoaXMuaHRtbGNBK28uY2hpbGROb2Rlc1tsXS5jaGlsZHNDb3VudCt0aGlzLmh0bWxjQiksMj09dGhpcy5jaGlsZENhbGMpe3ZhciBzPW8uY2hpbGROb2Rlc1tsXS5jaGlsZHNDb3VudC0oby5jaGlsZE5vZGVzW2xdLnB1cmVDaGlsZHN8fDApO3MmJihvLmNoaWxkTm9kZXNbbF0uc3Bhbi5pbm5lckhUTUw9by5jaGlsZE5vZGVzW2xdLmxhYmVsK3RoaXMuaHRtbGNBK3MrdGhpcy5odG1sY0IpLG8ucHVyZUNoaWxkcz9vLnB1cmVDaGlsZHMrKzpvLnB1cmVDaGlsZHM9MX1pZigzPT10aGlzLmNoaWxkQ2FsYyYmKG8uY2hpbGROb2Rlc1tsXS5zcGFuLmlubmVySFRNTD1vLmNoaWxkTm9kZXNbbF0ubGFiZWwrdGhpcy5odG1sY0Erby5jaGlsZE5vZGVzW2xdLl9hY2MrdGhpcy5odG1sY0IpLDQ9PXRoaXMuY2hpbGRDYWxjKXt2YXIgcz1vLmNoaWxkTm9kZXNbbF0uX2FjYztzJiYoby5jaGlsZE5vZGVzW2xdLnNwYW4uaW5uZXJIVE1MPW8uY2hpbGROb2Rlc1tsXS5sYWJlbCt0aGlzLmh0bWxjQStzK3RoaXMuaHRtbGNCKX19ZWxzZSA0PT10aGlzLmNoaWxkQ2FsYyYmcisrO3IrPW8uY2hpbGROb2Rlc1tsXS5fYWNjLDM9PXRoaXMuY2hpbGRDYWxjJiZyKyt9by51blBhcnNlZHx8IW8uWE1MbG9hZCYmdGhpcy5YTUxzb3VyY2V8fChvLl9hY2M9ciksZS5fY29ycmVjdExpbmUobyksZS5fY29ycmVjdFBsdXMobyksdGhpcy5jaGlsZENhbGMmJiF0JiZlLl9maXhDaGlsZENvdW50TGFiZWwobyl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLl9jcmVhdGVTZWxmPWZ1bmN0aW9uKCl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7cmV0dXJuIGUuY2xhc3NOYW1lPSJjb250YWluZXJUYWJsZVN0eWxlIixlLnN0eWxlLndpZHRoPXRoaXMud2lkdGgsZS5zdHlsZS5oZWlnaHQ9dGhpcy5oZWlnaHQsdGhpcy5wYXJlbnRPYmplY3QuYXBwZW5kQ2hpbGQoZSksZX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX3hjbG9zZUFsbD1mdW5jdGlvbihlKXtpZighZS51blBhcnNlZCl7aWYodGhpcy5yb290SWQhPWUuaWQpe2lmKCFlLmh0bWxOb2RlKXJldHVybjtmb3IodmFyIHQ9ZS5odG1sTm9kZS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXMsaT10Lmxlbmd0aCxuPTE7aT5uO24rKyl0W25dLnN0eWxlLmRpc3BsYXk9Im5vbmUiO3RoaXMuX2NvcnJlY3RQbHVzKGUpfWZvcih2YXIgbj0wO248ZS5jaGlsZHNDb3VudDtuKyspZS5jaGlsZE5vZGVzW25dLmNoaWxkc0NvdW50JiZ0aGlzLl94Y2xvc2VBbGwoZS5jaGlsZE5vZGVzW25dKX19LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLl94b3BlbkFsbD1mdW5jdGlvbihlKXt0aGlzLl9IaWRlU2hvdyhlLDIpO2Zvcih2YXIgdD0wO3Q8ZS5jaGlsZHNDb3VudDt0KyspdGhpcy5feG9wZW5BbGwoZS5jaGlsZE5vZGVzW3RdKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2NvcnJlY3RQbHVzPWZ1bmN0aW9uKGUpe2lmKGUuaHRtbE5vZGUpe3ZhciB0PWUuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMF0ubGFzdENoaWxkLGk9ZS5odG1sTm9kZS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1syXS5jaGlsZE5vZGVzWzBdLG49dGhpcy5saW5lQXJyYXk7aWYodGhpcy5YTUxzb3VyY2UmJiFlLlhNTGxvYWQpe3ZhciBuPXRoaXMucGx1c0FycmF5O2lmKHRoaXMuX3NldFNyYyhpLHRoaXMuaWNvblVSTCtlLmltYWdlc1syXSksdGhpcy5fdHh0aW1nKXJldHVybiB0LmlubmVySFRNTD0iWytdIn1lbHNlIGlmKGUuY2hpbGRzQ291bnR8fGUudW5QYXJzZWQpaWYoZS5odG1sTm9kZS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMV0mJiJub25lIiE9ZS5odG1sTm9kZS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMV0uc3R5bGUuZGlzcGxheSl7aWYoIWUud3NpZ24pdmFyIG49dGhpcy5taW51c0FycmF5O2lmKHRoaXMuX3NldFNyYyhpLHRoaXMuaWNvblVSTCtlLmltYWdlc1sxXSksdGhpcy5fdHh0aW1nKXJldHVybiB0LmlubmVySFRNTD0iWy1dIn1lbHNle2lmKCFlLndzaWduKXZhciBuPXRoaXMucGx1c0FycmF5O2lmKHRoaXMuX3NldFNyYyhpLHRoaXMuaWNvblVSTCtlLmltYWdlc1syXSksdGhpcy5fdHh0aW1nKXJldHVybiB0LmlubmVySFRNTD0iWytdIn1lbHNlIHRoaXMuX3NldFNyYyhpLHRoaXMuaWNvblVSTCtlLmltYWdlc1swXSk7dmFyIG89MjtlLnRyZWVOb2QudHJlZUxpbmVzT24/KGUucGFyZW50T2JqZWN0JiYobz10aGlzLl9nZXRDb3VudFN0YXR1cyhlLmlkLGUucGFyZW50T2JqZWN0KSksdGhpcy5fc2V0U3JjKHQsdGhpcy5pbVBhdGgrbltvXSkpOnRoaXMuX3NldFNyYyh0LHRoaXMuaW1QYXRoK25bM10pfX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2NvcnJlY3RMaW5lPWZ1bmN0aW9uKGUpe2lmKGUuaHRtbE5vZGUpe3ZhciB0PWUucGFyZW50T2JqZWN0O2lmKHQpaWYoMCE9dGhpcy5fZ2V0TGluZVN0YXR1cyhlLmlkLHQpJiZ0aGlzLnRyZWVMaW5lc09uKWZvcih2YXIgaT0xO2k8PWUuY2hpbGRzQ291bnQmJmUuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzW2ldO2krKyllLmh0bWxOb2RlLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1tpXS5jaGlsZE5vZGVzWzBdLnN0eWxlLmJhY2tncm91bmRJbWFnZT0idXJsKCIrdGhpcy5pbVBhdGgrdGhpcy5saW5lQXJyYXlbNV0rIikiLGUuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzW2ldLmNoaWxkTm9kZXNbMF0uc3R5bGUuYmFja2dyb3VuZFJlcGVhdD0icmVwZWF0LXkiO2Vsc2UgZm9yKHZhciBpPTE7aTw9ZS5jaGlsZHNDb3VudCYmZS5odG1sTm9kZS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbaV07aSsrKWUuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzW2ldLmNoaWxkTm9kZXNbMF0uc3R5bGUuYmFja2dyb3VuZEltYWdlPSIiLGUuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzW2ldLmNoaWxkTm9kZXNbMF0uc3R5bGUuYmFja2dyb3VuZFJlcGVhdD0iIn19LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLl9nZXRMaW5lU3RhdHVzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQuY2hpbGROb2Rlc1t0LmNoaWxkc0NvdW50LTFdLmlkPT1lPzA6MX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX0hpZGVTaG93PWZ1bmN0aW9uKGUsdCl7aWYoIXRoaXMuX2xvY2tlcnx8dGhpcy5za2lwTG9ja3x8IXRoaXMuX2xvY2tlcltlLmlkXSl7aWYodGhpcy5YTUxzb3VyY2UmJiFlLlhNTGxvYWQpe2lmKDE9PXQpcmV0dXJuO3JldHVybiBlLlhNTGxvYWQ9MSx2b2lkIHRoaXMuX2xvYWREeW5YTUwoZS5pZCl9ZS51blBhcnNlZCYmdGhpcy5yZVBhcnNlKGUpO3ZhciBpPWUuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzLG49aS5sZW5ndGg7aWYobj4xKXsibm9uZSI9PWlbMV0uc3R5bGUuZGlzcGxheSYmMSE9dHx8Mj09dD9ub2Rlc3R5bGU9IiI6KHRoaXMuYWxsVHJlZS5jaGlsZE5vZGVzWzBdLmJvcmRlcj0iMSIsdGhpcy5hbGxUcmVlLmNoaWxkTm9kZXNbMF0uYm9yZGVyPSIwIixub2Rlc3R5bGU9Im5vbmUiKTtmb3IodmFyIG89MTtuPm87bysrKWlbb10uc3R5bGUuZGlzcGxheT1ub2Rlc3R5bGV9dGhpcy5fY29ycmVjdFBsdXMoZSl9fSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fZ2V0T3BlblN0YXRlPWZ1bmN0aW9uKGUpe2lmKCFlLmh0bWxOb2RlKXJldHVybiAwO3ZhciB0PWUuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzO3JldHVybiB0Lmxlbmd0aDw9MT8wOiJub25lIiE9dFsxXS5zdHlsZS5kaXNwbGF5PzE6LTF9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLm9uUm93Q2xpY2syPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5wYXJlbnRPYmplY3QudHJlZU5vZDtyZXR1cm4gZS5jYWxsRXZlbnQoIm9uRGJsQ2xpY2siLFt0aGlzLnBhcmVudE9iamVjdC5pZCxlXSk/KHRoaXMucGFyZW50T2JqZWN0LmNsb3NlYmxlJiYiMCIhPXRoaXMucGFyZW50T2JqZWN0LmNsb3NlYmxlP2UuX0hpZGVTaG93KHRoaXMucGFyZW50T2JqZWN0KTplLl9IaWRlU2hvdyh0aGlzLnBhcmVudE9iamVjdCwyKSxlLmNoZWNrRXZlbnQoIm9uT3BlbkVuZCIpJiYoZS54bWxzdGF0ZT8oZS5fb2llX29uWExFLnB1c2goZS5vblhMRSksZS5vblhMRT1lLl9lcG5GSGUpOmUuY2FsbEV2ZW50KCJvbk9wZW5FbmQiLFt0aGlzLnBhcmVudE9iamVjdC5pZCxlLl9nZXRPcGVuU3RhdGUodGhpcy5wYXJlbnRPYmplY3QpXSkpLCExKTohMX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUub25Sb3dDbGljaz1mdW5jdGlvbigpe3ZhciBlPXRoaXMucGFyZW50T2JqZWN0LnRyZWVOb2Q7cmV0dXJuIGUuY2FsbEV2ZW50KCJvbk9wZW5TdGFydCIsW3RoaXMucGFyZW50T2JqZWN0LmlkLGUuX2dldE9wZW5TdGF0ZSh0aGlzLnBhcmVudE9iamVjdCldKT8odGhpcy5wYXJlbnRPYmplY3QuY2xvc2VibGUmJiIwIiE9dGhpcy5wYXJlbnRPYmplY3QuY2xvc2VibGU/ZS5fSGlkZVNob3codGhpcy5wYXJlbnRPYmplY3QpOmUuX0hpZGVTaG93KHRoaXMucGFyZW50T2JqZWN0LDIpLHZvaWQoZS5jaGVja0V2ZW50KCJvbk9wZW5FbmQiKSYmKGUueG1sc3RhdGU/KGUuX29pZV9vblhMRS5wdXNoKGUub25YTEUpLGUub25YTEU9ZS5fZXBuRkhlKTplLmNhbGxFdmVudCgib25PcGVuRW5kIixbdGhpcy5wYXJlbnRPYmplY3QuaWQsZS5fZ2V0T3BlblN0YXRlKHRoaXMucGFyZW50T2JqZWN0KV0pKSkpOjB9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLmdldFNlbGVjdGVkSXRlbUlkPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPW5ldyBBcnJheSx0PTA7dDx0aGlzLl9zZWxlY3RlZC5sZW5ndGg7dCsrKWVbdF09dGhpcy5fc2VsZWN0ZWRbdF0uaWQ7cmV0dXJuIGUuam9pbih0aGlzLmRsbXRyKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX3NlbGVjdEl0ZW09ZnVuY3Rpb24oZSx0KXtpZih0aGlzLmNoZWNrRXZlbnQoIm9uU2VsZWN0IikmJih0aGlzLl9vblNTQ0ZvbGQ9dGhpcy5nZXRTZWxlY3RlZEl0ZW1JZCgpKSx0aGlzLl9hbXNlbCYmdCYmKHQuY3RybEtleXx8dC5tZXRhS2V5fHx0LnNoaWZ0S2V5KXx8dGhpcy5fdW5zZWxlY3RJdGVtcygpLGUuaV9zZWwmJnRoaXMuX2Ftc2VsJiZ0JiYodC5jdHJsS2V5fHx0Lm1ldGFLZXkpKXRoaXMuX3Vuc2VsZWN0SXRlbShlKTtlbHNlIGlmKCEoZS5pX3NlbHx8dGhpcy5fYW1zZWxTJiYwIT10aGlzLl9zZWxlY3RlZC5sZW5ndGgmJnRoaXMuX3NlbGVjdGVkWzBdLnBhcmVudE9iamVjdCE9ZS5wYXJlbnRPYmplY3QpKWlmKHRoaXMuX2Ftc2VsJiZ0JiZ0LnNoaWZ0S2V5JiYwIT10aGlzLl9zZWxlY3RlZC5sZW5ndGgmJnRoaXMuX3NlbGVjdGVkW3RoaXMuX3NlbGVjdGVkLmxlbmd0aC0xXS5wYXJlbnRPYmplY3Q9PWUucGFyZW50T2JqZWN0KXt2YXIgaT10aGlzLl9nZXRJbmRleCh0aGlzLl9zZWxlY3RlZFt0aGlzLl9zZWxlY3RlZC5sZW5ndGgtMV0pLG49dGhpcy5fZ2V0SW5kZXgoZSk7aWYoaT5uKXt2YXIgbz1pO2k9bixuPW99Zm9yKHZhciByPWk7bj49cjtyKyspZS5wYXJlbnRPYmplY3QuY2hpbGROb2Rlc1tyXS5pX3NlbHx8dGhpcy5fbWFya0l0ZW0oZS5wYXJlbnRPYmplY3QuY2hpbGROb2Rlc1tyXSl9ZWxzZSB0aGlzLl9tYXJrSXRlbShlKTtpZih0aGlzLmNoZWNrRXZlbnQoIm9uU2VsZWN0Iikpe3ZhciBsPXRoaXMuZ2V0U2VsZWN0ZWRJdGVtSWQoKTtsIT10aGlzLl9vblNTQ0ZvbGQmJnRoaXMuY2FsbEV2ZW50KCJvblNlbGVjdCIsW2xdKX19LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLl9tYXJrSXRlbT1mdW5jdGlvbihlKXtlLnNjb2xvciYmKGUuc3Bhbi5zdHlsZS5jb2xvcj1lLnNjb2xvciksZS5zcGFuLmNsYXNzTmFtZT0ic2VsZWN0ZWRUcmVlUm93IixlLnNwYW4ucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTmFtZT0ic2VsZWN0ZWRUcmVlUm93RnVsbCIsZS5pX3NlbD0hMCx0aGlzLl9zZWxlY3RlZFt0aGlzLl9zZWxlY3RlZC5sZW5ndGhdPWV9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLmdldEluZGV4QnlJZD1mdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nbG9iYWxJZFN0b3JhZ2VGaW5kKGUpO3JldHVybiB0P3RoaXMuX2dldEluZGV4KHQpOm51bGx9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLl9nZXRJbmRleD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5wYXJlbnRPYmplY3QsaT0wO2k8dC5jaGlsZHNDb3VudDtpKyspaWYodC5jaGlsZE5vZGVzW2ldPT1lKXJldHVybiBpfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fdW5zZWxlY3RJdGVtPWZ1bmN0aW9uKGUpe2lmKGUmJmUuaV9zZWwpe2Uuc3Bhbi5jbGFzc05hbWU9InN0YW5kYXJ0VHJlZVJvdyIsZS5zcGFuLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc05hbWU9IiIsZS5hY29sb3ImJihlLnNwYW4uc3R5bGUuY29sb3I9ZS5hY29sb3IpLGUuaV9zZWw9ITE7Zm9yKHZhciB0PTA7dDx0aGlzLl9zZWxlY3RlZC5sZW5ndGg7dCsrKWlmKCF0aGlzLl9zZWxlY3RlZFt0XS5pX3NlbCl7dGhpcy5fc2VsZWN0ZWQuc3BsaWNlKHQsMSk7YnJlYWt9fX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX3Vuc2VsZWN0SXRlbXM9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPHRoaXMuX3NlbGVjdGVkLmxlbmd0aDtlKyspe3ZhciB0PXRoaXMuX3NlbGVjdGVkW2VdO3Quc3Bhbi5jbGFzc05hbWU9InN0YW5kYXJ0VHJlZVJvdyIsdC5zcGFuLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc05hbWU9IiIsdC5hY29sb3ImJih0LnNwYW4uc3R5bGUuY29sb3I9dC5hY29sb3IpLHQuaV9zZWw9ITF9dGhpcy5fc2VsZWN0ZWQ9bmV3IEFycmF5fSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5vblJvd1NlbGVjdD1mdW5jdGlvbihlLHQsaSl7ZT1lfHx3aW5kb3cuZXZlbnQ7dmFyIG49dGhpcy5wYXJlbnRPYmplY3Q7dCYmKG49dC5wYXJlbnRPYmplY3QpO3ZhciBvPW4udHJlZU5vZCxyPW8uZ2V0U2VsZWN0ZWRJdGVtSWQoKTtlJiZlLnNraXBVblNlbHx8by5fc2VsZWN0SXRlbShuLGUpLGl8fChuLmFjdGlvbkhhbmRsZXI/bi5hY3Rpb25IYW5kbGVyKG4uaWQscik6by5jYWxsRXZlbnQoIm9uQ2xpY2siLFtuLmlkLHJdKSl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLl9jcmVhdGVJdGVtPWZ1bmN0aW9uKGUsdCxpKXt2YXIgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0YWJsZSIpO24uY2VsbFNwYWNpbmc9MCxuLmNlbGxQYWRkaW5nPTAsbi5ib3JkZXI9MCx0aGlzLmhmTW9kZSYmKG4uc3R5bGUudGFibGVMYXlvdXQ9ImZpeGVkIiksbi5zdHlsZS5tYXJnaW49MCxuLnN0eWxlLnBhZGRpbmc9MDt2YXIgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpLHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidHIiKSxsPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRkIik7aWYobC5jbGFzc05hbWU9InN0YW5kYXJ0VHJlZUltYWdlIix0aGlzLl90eHRpbWcpe3ZhciBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2wuYXBwZW5kQ2hpbGQocykscy5jbGFzc05hbWU9ImRoeF90cmVlX3RleHRTaWduIn1lbHNle3ZhciBzPXRoaXMuX2dldEltZyh0LmlkKTtzLmJvcmRlcj0iMCIsIklNRyI9PXMudGFnTmFtZSYmKHMuYWxpZ249ImFic21pZGRsZSIpLGwuYXBwZW5kQ2hpbGQocykscy5zdHlsZS5wYWRkaW5nPTAscy5zdHlsZS5tYXJnaW49MCxzLnN0eWxlLndpZHRoPXRoaXMuZGVmX2xpbmVfaW1nX3h9dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKSxkPXRoaXMuX2dldEltZyh0aGlzLmNCUk9mP3RoaXMucm9vdElkOnQuaWQpO2QuY2hlY2tlZD0wLHRoaXMuX3NldFNyYyhkLHRoaXMuaW1QYXRoK3RoaXMuY2hlY2tBcnJheVswXSksZC5zdHlsZS53aWR0aD0iMThweCIsZC5zdHlsZS5oZWlnaHQ9IjE4cHgiLGV8fChhLnN0eWxlLmRpc3BsYXk9Im5vbmUiKSxhLmFwcGVuZENoaWxkKGQpLHRoaXMuY0JST2Z8fCJJTUciIT1kLnRhZ05hbWV8fChkLmFsaWduPSJhYnNtaWRkbGUiKSxkLm9uY2xpY2s9dGhpcy5vbkNoZWNrQm94Q2xpY2ssZC50cmVlTm9kPXRoaXMsZC5wYXJlbnRPYmplY3Q9dCx3aW5kb3cuX0tIVE1McnY/YS53aWR0aD0iMTZweCI6YS53aWR0aD0iMjBweCI7dmFyIGg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKTtoLmNsYXNzTmFtZT0ic3RhbmRhcnRUcmVlSW1hZ2UiO3ZhciBjPXRoaXMuX2dldEltZyh0aGlzLnRpbWdlbj90LmlkOnRoaXMucm9vdElkKTtjLm9ubW91c2Vkb3duPXRoaXMuX3ByZXZlbnROc0RyYWcsYy5vbmRyYWdzdGFydD10aGlzLl9wcmV2ZW50TnNEcmFnLGMuYm9yZGVyPSIwIix0aGlzLl9haW1ncyYmKGMucGFyZW50T2JqZWN0PXQsCiJJTUciPT1jLnRhZ05hbWUmJihjLmFsaWduPSJhYnNtaWRkbGUiKSxjLm9uY2xpY2s9dGhpcy5vblJvd1NlbGVjdCksaXx8dGhpcy5fc2V0U3JjKGMsdGhpcy5pY29uVVJMK3RoaXMuaW1hZ2VBcnJheVswXSksaC5hcHBlbmRDaGlsZChjKSxjLnN0eWxlLnBhZGRpbmc9MCxjLnN0eWxlLm1hcmdpbj0wLHRoaXMudGltZ2VuPyhoLnN0eWxlLndpZHRoPWMuc3R5bGUud2lkdGg9dGhpcy5kZWZfaW1nX3gsYy5zdHlsZS5oZWlnaHQ9dGhpcy5kZWZfaW1nX3kpOihjLnN0eWxlLndpZHRoPSIwcHgiLGMuc3R5bGUuaGVpZ2h0PSIwcHgiLChfaXNPcGVyYXx8d2luZG93Ll9LSFRNTHJ2KSYmKGguc3R5bGUuZGlzcGxheT0ibm9uZSIpKTt2YXIgdT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZCIpO3JldHVybiB1LmNsYXNzTmFtZT0iZGh4VGV4dENlbGwgc3RhbmRhcnRUcmVlUm93Iix0LnNwYW49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpLHQuc3Bhbi5jbGFzc05hbWU9InN0YW5kYXJ0VHJlZVJvdyIsdGhpcy5tbGl0ZW1zPyh0LnNwYW4uc3R5bGUud2lkdGg9dGhpcy5tbGl0ZW1zLHQuc3Bhbi5zdHlsZS5kaXNwbGF5PSJibG9jayIpOnUubm9XcmFwPSEwLGRoeDQuaXNJRTg/dS5zdHlsZS53aWR0aD0iOTk5OTlweCI6d2luZG93Ll9LSFRNTHJ2fHwodS5zdHlsZS53aWR0aD0iMTAwJSIpLHQuc3Bhbi5pbm5lckhUTUw9dC5sYWJlbCx1LmFwcGVuZENoaWxkKHQuc3BhbiksdS5wYXJlbnRPYmplY3Q9dCxsLnBhcmVudE9iamVjdD10LHUub25jbGljaz10aGlzLm9uUm93U2VsZWN0LGwub25jbGljaz10aGlzLm9uUm93Q2xpY2ssdS5vbmRibGNsaWNrPXRoaXMub25Sb3dDbGljazIsdGhpcy5ldHRpcCYmKHIudGl0bGU9dC5sYWJlbCksdGhpcy5kcmFnQW5kRHJvcE9mZiYmKHRoaXMuX2FpbWdzJiYodGhpcy5kcmFnZ2VyLmFkZERyYWdnYWJsZUl0ZW0oaCx0aGlzKSxoLnBhcmVudE9iamVjdD10KSx0aGlzLmRyYWdnZXIuYWRkRHJhZ2dhYmxlSXRlbSh1LHRoaXMpKSx0LnNwYW4uc3R5bGUucGFkZGluZ0xlZnQ9IjVweCIsdC5zcGFuLnN0eWxlLnBhZGRpbmdSaWdodD0iNXB4Iix1LnN0eWxlLnZlcnRpY2FsQWxpZ249IiIsdS5zdHlsZS5mb250U2l6ZT0iMTBwdCIsdS5zdHlsZS5jdXJzb3I9dGhpcy5zdHlsZV9wb2ludGVyLHIuYXBwZW5kQ2hpbGQobCksci5hcHBlbmRDaGlsZChhKSxyLmFwcGVuZENoaWxkKGgpLHIuYXBwZW5kQ2hpbGQodSksby5hcHBlbmRDaGlsZChyKSxuLmFwcGVuZENoaWxkKG8pLCh0aGlzLmVobHR8fHRoaXMuY2hlY2tFdmVudCgib25Nb3VzZUluIil8fHRoaXMuY2hlY2tFdmVudCgib25Nb3VzZU91dCIpKSYmKHIub25tb3VzZW1vdmU9dGhpcy5faXRlbU1vdXNlSW4scltfaXNJRT8ib25tb3VzZWxlYXZlIjoib25tb3VzZW91dCJdPXRoaXMuX2l0ZW1Nb3VzZU91dCksbn0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuc2V0T25SaWdodENsaWNrSGFuZGxlcj1mdW5jdGlvbihlKXt0aGlzLmF0dGFjaEV2ZW50KCJvblJpZ2h0Q2xpY2siLGUpfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5zZXRPbkNsaWNrSGFuZGxlcj1mdW5jdGlvbihlKXt0aGlzLmF0dGFjaEV2ZW50KCJvbkNsaWNrIixlKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuc2V0T25TZWxlY3RTdGF0ZUNoYW5nZT1mdW5jdGlvbihlKXt0aGlzLmF0dGFjaEV2ZW50KCJvblNlbGVjdCIsZSl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLnNldFhNTEF1dG9Mb2FkaW5nPWZ1bmN0aW9uKGUpe3RoaXMuWE1Mc291cmNlPWV9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLnNldE9uQ2hlY2tIYW5kbGVyPWZ1bmN0aW9uKGUpe3RoaXMuYXR0YWNoRXZlbnQoIm9uQ2hlY2siLGUpfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5zZXRPbk9wZW5IYW5kbGVyPWZ1bmN0aW9uKGUpe3RoaXMuYXR0YWNoRXZlbnQoIm9uT3BlblN0YXJ0IixlKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuc2V0T25PcGVuU3RhcnRIYW5kbGVyPWZ1bmN0aW9uKGUpe3RoaXMuYXR0YWNoRXZlbnQoIm9uT3BlblN0YXJ0IixlKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuc2V0T25PcGVuRW5kSGFuZGxlcj1mdW5jdGlvbihlKXt0aGlzLmF0dGFjaEV2ZW50KCJvbk9wZW5FbmQiLGUpfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5zZXRPbkRibENsaWNrSGFuZGxlcj1mdW5jdGlvbihlKXt0aGlzLmF0dGFjaEV2ZW50KCJvbkRibENsaWNrIixlKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUub3BlbkFsbEl0ZW1zPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dsb2JhbElkU3RvcmFnZUZpbmQoZSk7cmV0dXJuIHQ/dm9pZCB0aGlzLl94b3BlbkFsbCh0KTowfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5nZXRPcGVuU3RhdGU9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2xvYmFsSWRTdG9yYWdlRmluZChlKTtyZXR1cm4gdD90aGlzLl9nZXRPcGVuU3RhdGUodCk6IiJ9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLmNsb3NlQWxsSXRlbXM9ZnVuY3Rpb24oZSl7ZT09PXdpbmRvdy51bmRlZmluZWQmJihlPXRoaXMucm9vdElkKTt2YXIgdD10aGlzLl9nbG9iYWxJZFN0b3JhZ2VGaW5kKGUpO3JldHVybiB0Pyh0aGlzLl94Y2xvc2VBbGwodCksdGhpcy5hbGxUcmVlLmNoaWxkTm9kZXNbMF0uYm9yZGVyPSIxIix2b2lkKHRoaXMuYWxsVHJlZS5jaGlsZE5vZGVzWzBdLmJvcmRlcj0iMCIpKTowfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5zZXRVc2VyRGF0YT1mdW5jdGlvbihlLHQsaSl7dmFyIG49dGhpcy5fZ2xvYmFsSWRTdG9yYWdlRmluZChlLDAsITApO24mJigiaGludCI9PXQmJihuLmh0bWxOb2RlLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1swXS50aXRsZT1pKSwidW5kZWZpbmVkIj09dHlwZW9mIG4udXNlckRhdGFbInRfIit0XSYmKG4uX3VzZXJkYXRhbGlzdD9uLl91c2VyZGF0YWxpc3QrPSIsIit0Om4uX3VzZXJkYXRhbGlzdD10KSxuLnVzZXJEYXRhWyJ0XyIrdF09aSl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLmdldFVzZXJEYXRhPWZ1bmN0aW9uKGUsdCl7dmFyIGk9dGhpcy5fZ2xvYmFsSWRTdG9yYWdlRmluZChlLDAsITApO2lmKGkpcmV0dXJuIGkudXNlckRhdGFbInRfIit0XX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuZ2V0SXRlbUNvbG9yPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dsb2JhbElkU3RvcmFnZUZpbmQoZSk7aWYoIXQpcmV0dXJuIDA7dmFyIGk9bmV3IE9iamVjdDtyZXR1cm4gdC5hY29sb3ImJihpLmFjb2xvcj10LmFjb2xvciksdC5zY29sb3ImJihpLnNjb2xvcj10LnNjb2xvciksaX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuc2V0SXRlbUNvbG9yPWZ1bmN0aW9uKGUsdCxpKXtpZihlJiZlLnNwYW4pdmFyIG49ZTtlbHNlIHZhciBuPXRoaXMuX2dsb2JhbElkU3RvcmFnZUZpbmQoZSk7cmV0dXJuIG4/KG4uaV9zZWw/KGl8fHQpJiYobi5zcGFuLnN0eWxlLmNvbG9yPWl8fHQpOnQmJihuLnNwYW4uc3R5bGUuY29sb3I9dCksaSYmKG4uc2NvbG9yPWkpLHQmJihuLmFjb2xvcj10KSx2b2lkIDApOjB9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLnNldE9uTW91c2VJbkhhbmRsZXI9ZnVuY3Rpb24oZSl7dGhpcy5laGx0PSEwLHRoaXMuYXR0YWNoRXZlbnQoIm9uTW91c2VJbiIsZSl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLnNldE9uTW91c2VPdXRIYW5kbGVyPWZ1bmN0aW9uKGUpe3RoaXMuZWhsdD0hMCx0aGlzLmF0dGFjaEV2ZW50KCJvbk1vdXNlT3V0IixlKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuZW5hYmxlVHJlZUxpbmVzPWZ1bmN0aW9uKGUpe3RoaXMudHJlZUxpbmVzT249ZGh4NC5zMmIoZSl9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLm9wZW5JdGVtPWZ1bmN0aW9uKGUpe3RoaXMuc2tpcExvY2s9ITA7dmFyIHQ9dGhpcy5fZ2xvYmFsSWRTdG9yYWdlRmluZChlKTtyZXR1cm4gdD90aGlzLl9vcGVuSXRlbSh0KTowfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fb3Blbkl0ZW09ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2V0T3BlblN0YXRlKGUpO2lmKDA+dHx8dGhpcy5YTUxzb3VyY2UmJiFlLlhNTGxvYWQpe2lmKCF0aGlzLmNhbGxFdmVudCgib25PcGVuU3RhcnQiLFtlLmlkLHRdKSlyZXR1cm4gMDt0aGlzLl9IaWRlU2hvdyhlLDIpLHRoaXMuY2hlY2tFdmVudCgib25PcGVuRW5kIikmJih0aGlzLm9uWExFPT10aGlzLl9lcG5GSGUmJnRoaXMuX2VwbkZIZSh0aGlzLGUuaWQsITApLHRoaXMueG1sc3RhdGUmJnRoaXMuWE1Mc291cmNlPyh0aGlzLl9vaWVfb25YTEUucHVzaCh0aGlzLm9uWExFKSx0aGlzLm9uWExFPXRoaXMuX2VwbkZIZSk6dGhpcy5jYWxsRXZlbnQoIm9uT3BlbkVuZCIsW2UuaWQsdGhpcy5fZ2V0T3BlblN0YXRlKGUpXSkpfWVsc2UgdGhpcy5fc3JuZCYmdGhpcy5fSGlkZVNob3coZSwyKTtlLnBhcmVudE9iamVjdCYmIXRoaXMuX3NraXBfb3Blbl9wYXJlbnQmJnRoaXMuX29wZW5JdGVtKGUucGFyZW50T2JqZWN0KX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2dldEFsbEZhdEl0ZW1zPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0iIixpPTA7aTxlLmNoaWxkc0NvdW50O2krKylpZihlLmNoaWxkTm9kZXNbaV0udW5QYXJzZWR8fGUuY2hpbGROb2Rlc1tpXS5jaGlsZHNDb3VudD4wKXtpZih0P3QrPXRoaXMuZGxtdHIrZS5jaGlsZE5vZGVzW2ldLmlkOnQ9IiIrZS5jaGlsZE5vZGVzW2ldLmlkLGUuY2hpbGROb2Rlc1tpXS51blBhcnNlZCl2YXIgbj10aGlzLl9nZXRBbGxGYXRJdGVtc1hNTChlLmNoaWxkTm9kZXNbaV0udW5QYXJzZWQsMSk7ZWxzZSB2YXIgbj10aGlzLl9nZXRBbGxGYXRJdGVtcyhlLmNoaWxkTm9kZXNbaV0pO24mJih0Kz10aGlzLmRsbXRyK24pfXJldHVybiB0fSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5zZWxlY3RJdGVtPWZ1bmN0aW9uKGUsdCxpKXt0PWRoeDQuczJiKHQpO3ZhciBuPXRoaXMuX2dsb2JhbElkU3RvcmFnZUZpbmQoZSk7aWYoIW58fCFuLnBhcmVudE9iamVjdClyZXR1cm4gMDt0aGlzLlhNTGxvYWRpbmdXYXJuaW5nP24ucGFyZW50T2JqZWN0Lm9wZW5NZT0xOnRoaXMuX29wZW5JdGVtKG4ucGFyZW50T2JqZWN0KTt2YXIgbz1udWxsO2kmJihvPW5ldyBPYmplY3Qsby5jdHJsS2V5PSEwLG4uaV9zZWwmJihvLnNraXBVblNlbD0hMCkpLHQ/dGhpcy5vblJvd1NlbGVjdChvLG4uaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbM10sITEpOnRoaXMub25Sb3dTZWxlY3QobyxuLmh0bWxOb2RlLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzNdLCEwKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2NvbXByZXNzQ2hpbGRMaXN0PWZ1bmN0aW9uKGUsdCl7ZS0tO2Zvcih2YXIgaT0wO2U+aTtpKyspMD09dFtpXSYmKHRbaV09dFtpKzFdLHRbaSsxXT0wKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2RlbGV0ZU5vZGU9ZnVuY3Rpb24oZSx0LGkpe2lmKCF0fHwhdC5wYXJlbnRPYmplY3QpcmV0dXJuIDA7dmFyIG49MCxvPTA7dC50ci5uZXh0U2libGluZyYmKG49dC50ci5uZXh0U2libGluZy5ub2RlbSksdC50ci5wcmV2aW91c1NpYmxpbmcmJihvPXQudHIucHJldmlvdXNTaWJsaW5nLm5vZGVtKTtmb3IodmFyIHI9dC5wYXJlbnRPYmplY3QsbD1yLmNoaWxkc0NvdW50LHM9ci5jaGlsZE5vZGVzLGE9MDtsPmE7YSsrKWlmKHNbYV0uaWQ9PWUpe2l8fHIuaHRtbE5vZGUuY2hpbGROb2Rlc1swXS5yZW1vdmVDaGlsZChzW2FdLnRyKSxzW2FdPTA7YnJlYWt9dGhpcy5fY29tcHJlc3NDaGlsZExpc3QobCxzKSxpfHxyLmNoaWxkc0NvdW50LS0sbiYmKHRoaXMuX2NvcnJlY3RQbHVzKG4pLHRoaXMuX2NvcnJlY3RMaW5lKG4pKSxvJiYodGhpcy5fY29ycmVjdFBsdXMobyksdGhpcy5fY29ycmVjdExpbmUobykpLHRoaXMudHNjaGVjayYmdGhpcy5fY29ycmVjdENoZWNrU3RhdGVzKHIpLGl8fHRoaXMuX2dsb2JhbElkU3RvcmFnZVJlY1N1Yih0KX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuZGVsZXRlQ2hpbGRJdGVtcz1mdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nbG9iYWxJZFN0b3JhZ2VGaW5kKGUpO2lmKHQpZm9yKHZhciBpPXQuY2hpbGRzQ291bnQsbj0wO2k+bjtuKyspdGhpcy5fZGVsZXRlTm9kZSh0LmNoaWxkTm9kZXNbMF0uaWQsdC5jaGlsZE5vZGVzWzBdKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2dsb2JhbElkU3RvcmFnZVJlY1N1Yj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PGUuY2hpbGRzQ291bnQ7dCsrKXRoaXMuX2dsb2JhbElkU3RvcmFnZVJlY1N1YihlLmNoaWxkTm9kZXNbdF0pLHRoaXMuX2dsb2JhbElkU3RvcmFnZVN1YihlLmNoaWxkTm9kZXNbdF0uaWQpO3RoaXMuX2dsb2JhbElkU3RvcmFnZVN1YihlLmlkKTt2YXIgaT1lO2kuc3Bhbj1udWxsLGkudHIubm9kZW09bnVsbCxpLnRyPW51bGwsaS5odG1sTm9kZT1udWxsfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5fYXV0b1Njcm9sbD1mdW5jdGlvbihlLHQsaSl7dGhpcy5hdXRvU2Nyb2xsJiYoZSYmKHQ9ZGh4NC5hYnNUb3AoZSksaT1kaHg0LmFic1RvcCh0aGlzLmFsbFRyZWUpLXRoaXMuYWxsVHJlZS5zY3JvbGxUb3ApLHQtaS1wYXJzZUludCh0aGlzLmFsbFRyZWUuc2Nyb2xsVG9wKT5wYXJzZUludCh0aGlzLmFsbFRyZWUub2Zmc2V0SGVpZ2h0KS01MCYmKHRoaXMuYWxsVHJlZS5zY3JvbGxUb3A9cGFyc2VJbnQodGhpcy5hbGxUcmVlLnNjcm9sbFRvcCkrMjApLHQtaTxwYXJzZUludCh0aGlzLmFsbFRyZWUuc2Nyb2xsVG9wKSszMCYmKHRoaXMuYWxsVHJlZS5zY3JvbGxUb3A9cGFyc2VJbnQodGhpcy5hbGxUcmVlLnNjcm9sbFRvcCktMjApKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuZW5hYmxlVGV4dFNpZ25zPWZ1bmN0aW9uKGUpe3RoaXMuX3R4dGltZz1kaHg0LnMyYihlKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUucHJldmVudElFQ2FjaGluZz1mdW5jdGlvbihlKXtkaHg0LmFqYXguY2FjaGU9IWV9LGRodG1sWFRyZWVPYmplY3QucHJvdG90eXBlLnByZXZlbnRJRUNhc2hpbmc9ZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUucHJldmVudElFQ2FjaGluZyxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5zZXRJY29uU2l6ZT1mdW5jdGlvbihlLHQsaSl7aWYoaSl7aWYoaSYmaS5zcGFuKXZhciBuPWk7ZWxzZSB2YXIgbj10aGlzLl9nbG9iYWxJZFN0b3JhZ2VGaW5kKGkpO2lmKCFuKXJldHVybiAwO3ZhciBvPW4uc3Bhbi5wYXJlbnROb2RlLnByZXZpb3VzU2libGluZy5jaGlsZE5vZGVzWzBdO2UmJihvLnN0eWxlLndpZHRoPWUrInB4Iix3aW5kb3cuX0tIVE1McnYmJihvLnBhcmVudE5vZGUuc3R5bGUud2lkdGg9ZSsicHgiKSksdCYmKG8uc3R5bGUuaGVpZ2h0PXQrInB4Iix3aW5kb3cuX0tIVE1McnYmJihvLnBhcmVudE5vZGUuc3R5bGUuaGVpZ2h0PXQrInB4IikpfWVsc2UgdGhpcy5kZWZfaW1nX3g9ZSsicHgiLHRoaXMuZGVmX2ltZ195PXQrInB4In0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuZW5hYmxlU2luZ2xlUmFkaW9Nb2RlPWZ1bmN0aW9uKGUpe3RoaXMuX2ZyYnRycz1kaHg0LnMyYihlKX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUub3Blbk9uSXRlbUFkZGVkPWZ1bmN0aW9uKGUpe3RoaXMuX2hBZEk9IWRoeDQuczJiKGUpfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5vcGVuT25JdGVtQWRkaW5nPWZ1bmN0aW9uKGUpe3RoaXMuX2hBZEk9IWRoeDQuczJiKGUpfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5nZXRBbGxJdGVtc1dpdGhLaWRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldEFsbEZhdEl0ZW1zKHRoaXMuaHRtbE5vZGUpfSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5zZXRTa2luPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMucGFyZW50T2JqZWN0LmNsYXNzTmFtZS5yZXBsYWNlKC9kaHh0cmVlX1teIF0qL2dpLCIiKTt0aGlzLnBhcmVudE9iamVjdC5jbGFzc05hbWU9dCsiIGRoeHRyZWVfIitlLCJkaHhfdGVycmFjZSIhPWUmJiJkaHhfd2ViIiE9ZSYmIm1hdGVyaWFsIiE9ZXx8dGhpcy5lbmFibGVUcmVlTGluZXMoITEpLCJtYXRlcmlhbCI9PWUmJnRoaXMuc2V0SWNvblNpemUoIjI1IiwiMjUiKX0sanNvblBvaW50ZXIucHJvdG90eXBlPXt0ZXh0OmZ1bmN0aW9uKCl7dmFyIGU9ZnVuY3Rpb24oZSl7Zm9yKHZhciBpPVtdLG49MDtuPGUubGVuZ3RoO24rKylpLnB1c2goInsiK3QoZVtuXSkrIn0iKTtyZXR1cm4gaS5qb2luKCIsIil9LHQ9ZnVuY3Rpb24oaSl7dmFyIG49W107Zm9yKHZhciBvIGluIGkpIm9iamVjdCI9PXR5cGVvZiBpW29dP28ubGVuZ3RoP24ucHVzaCgnIicrbysnIjpbJytlKGlbb10pKyJdIik6bi5wdXNoKCciJytvKyciOnsnK3QoaVtvXSkrIn0iKTpuLnB1c2goJyInK28rJyI6IicraVtvXSsnIicpO3JldHVybiBuLmpvaW4oIiwiKX07cmV0dXJuInsiK3QodGhpcy5kKSsifSJ9LGdldDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5kW2VdfSxleGlzdHM6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuZH0sY29udGVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmQuY29udGVudH0sZWFjaDpmdW5jdGlvbihlLHQsaSl7dmFyIG49dGhpcy5kW2VdLG89bmV3IGpzb25Qb2ludGVyO2lmKG4pZm9yKHZhciByPTA7cjxuLmxlbmd0aDtyKyspby5kPW5bcl0sdC5hcHBseShpLFtvLHJdKX0sZ2V0X2FsbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmR9LHN1YjpmdW5jdGlvbihlKXtyZXR1cm4gbmV3IGpzb25Qb2ludGVyKHRoaXMuZFtlXSx0aGlzLmQpfSxzdWJfZXhpc3RzOmZ1bmN0aW9uKGUpe3JldHVybiEhdGhpcy5kW2VdfSxlYWNoX3g6ZnVuY3Rpb24oZSx0LGksbixvKXt2YXIgcj10aGlzLmRbZV0sbD1uZXcganNvblBvaW50ZXIoMCx0aGlzLmQpO2lmKHIpZm9yKG89b3x8MDtvPHIubGVuZ3RoO28rKylpZihyW29dW3RdJiYobC5kPXJbb10sLTE9PWkuYXBwbHkobixbbCxvXSkpKXJldHVybn0sdXA6ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBqc29uUG9pbnRlcih0aGlzLmRwLHRoaXMuZCl9LHNldDpmdW5jdGlvbihlLHQpe3RoaXMuZFtlXT10fSxjbG9uZTpmdW5jdGlvbihlKXtyZXR1cm4gbmV3IGpzb25Qb2ludGVyKHRoaXMuZCx0aGlzLmRwKX0sdGhyb3VnaDpmdW5jdGlvbihlLHQsaSxuLG8pe3ZhciByPXRoaXMuZFtlXTtpZihyLmxlbmd0aClmb3IodmFyIGw9MDtsPHIubGVuZ3RoO2wrKyl7aWYobnVsbCE9cltsXVt0XSYmIiIhPXJbbF1bdF0mJighaXx8cltsXVt0XT09aSkpe3ZhciBzPW5ldyBqc29uUG9pbnRlcihyW2xdLHRoaXMuZCk7bi5hcHBseShvLFtzLGxdKX12YXIgYT10aGlzLmQ7dGhpcy5kPXJbbF0sdGhpcy5zdWJfZXhpc3RzKGUpJiZ0aGlzLnRocm91Z2goZSx0LGksbixvKSx0aGlzLmQ9YX19fSxkaHRtbFhUcmVlT2JqZWN0LnByb3RvdHlwZS5sb2FkSlNPTk9iamVjdD1mdW5jdGlvbihlLHQpe3JldHVybiB3aW5kb3cuY29uc29sZSYmd2luZG93LmNvbnNvbGUuaW5mbyYmd2luZG93LmNvbnNvbGUuaW5mbygibG9hZEpTT05PYmplY3Qgd2FzIGRlcHJlY2F0ZWQiLCJodHRwOi8vZG9jcy5kaHRtbHguY29tL21pZ3JhdGlvbl9faW5kZXguaHRtbCNtaWdyYXRpb25mcm9tNDN0bzQ0IiksdGhpcy5fbG9hZEpTT05PYmplY3QoZSx0KX0sZGh0bWxYVHJlZU9iamVjdC5wcm90b3R5cGUuX2xvYWRKU09OT2JqZWN0PWZ1bmN0aW9uKGUsdCl7dGhpcy5wYXJzQ291bnR8fHRoaXMuY2FsbEV2ZW50KCJvblhMUyIsW3RoaXMsbnVsbF0pLHRoaXMueG1sc3RhdGU9MTt2YXIgaT1uZXcganNvblBvaW50ZXIoZSk7dGhpcy5fcGFyc2UoaSksdGhpcy5fcD1pLHQmJnQoKX0sd2luZG93LmFkZEV2ZW50TGlzdGVuZXI/d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLGRoeF9pbml0X3RyZWVzLCExKTp3aW5kb3cuYXR0YWNoRXZlbnQmJndpbmRvdy5hdHRhY2hFdmVudCgib25sb2FkIixkaHhfaW5pdF90cmVlcyk7dmFyIHN0eWxlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7c3R5bGUuaW5uZXJIVE1MPSdAa2V5ZnJhbWVzIGRoeF9sb2FkZXJfcm90YXRlezEwMCV7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO319QGtleWZyYW1lcyBkaHhfbG9hZGVyX2Rhc2h7MCV7c3Ryb2tlLWRhc2hhcnJheToxLDIwMDtzdHJva2UtZGFzaG9mZnNldDowO301MCV7c3Ryb2tlLWRhc2hhcnJheTo4OSwyMDA7c3Ryb2tlLWRhc2hvZmZzZXQ6LTM1cHg7fTEwMCV7c3Ryb2tlLWRhc2hhcnJheTo4OSwyMDA7c3Ryb2tlLWRhc2hvZmZzZXQ6LTEyNHB4O319LmRodG1seE1lbnVfbWF0ZXJpYWxfTWlkZGxle3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDoyOHB4O2xpbmUtaGVpZ2h0OjI4cHg7YmFja2dyb3VuZC1jb2xvcjojZjVmNWY1O292ZXJmbG93OmhpZGRlbjtib3JkZXI6bm9uZTtmb250LXNpemU6MTRweDtmb250LWZhbWlseTpSb2JvdG8sQXJpYWwsSGVsdmV0aWNhO2NvbG9yOiM0MDQwNDA7LXdlYmtpdC11c2VyLXNlbGVjdDpub25lOy1raHRtbC11c2VyLXNlbGVjdDpub25lOy1tb3otdXNlci1zZWxlY3Q6bm9uZTstbXMtdXNlci1zZWxlY3Q6bm9uZTstby11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmU7fS5kaHRtbHhNZW51X21hdGVyaWFsX01pZGRsZSBkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9Ub3BMZXZlbF9JdGVtX05vcm1hbCwuZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfVG9wTGV2ZWxfSXRlbV9EaXNhYmxlZCwuZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfVG9wTGV2ZWxfSXRlbV9TZWxlY3RlZHtwb3NpdGlvbjpyZWxhdGl2ZTtmbG9hdDpsZWZ0O2ZvbnQ6aW5oZXJpdDtoZWlnaHQ6MjhweDtsaW5lLWhlaWdodDoyOHB4O21hcmdpbjowO3BhZGRpbmc6MCA4cHg7Y3Vyc29yOmRlZmF1bHQ7d2hpdGUtc3BhY2U6bm93cmFwOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7LW8tdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lO30uZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfVG9wTGV2ZWxfSXRlbV9Ob3JtYWwgZGl2LnRvcF9sZXZlbF90ZXh0LC5kaHRtbHhNZW51X21hdGVyaWFsX01pZGRsZSBkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9Ub3BMZXZlbF9JdGVtX0Rpc2FibGVkIGRpdi50b3BfbGV2ZWxfdGV4dCwuZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfVG9wTGV2ZWxfSXRlbV9TZWxlY3RlZCBkaXYudG9wX2xldmVsX3RleHR7ZmxvYXQ6bGVmdDttYXJnaW46MCAzcHg7fS5kaHRtbHhNZW51X21hdGVyaWFsX01pZGRsZSBkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9Ub3BMZXZlbF9JdGVtX05vcm1hbCBpLC5kaHRtbHhNZW51X21hdGVyaWFsX01pZGRsZSBkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9Ub3BMZXZlbF9JdGVtX0Rpc2FibGVkIGksLmRodG1seE1lbnVfbWF0ZXJpYWxfTWlkZGxlIGRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1RvcExldmVsX0l0ZW1fU2VsZWN0ZWQgaXtoZWlnaHQ6aW5oZXJpdDtsaW5lLWhlaWdodDppbmhlcml0O2Zsb2F0OmxlZnQ7Y29sb3I6aW5oZXJpdDttYXJnaW46MCA0cHg7Zm9udC1zaXplOjEuMmVtO30uZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfVG9wTGV2ZWxfSXRlbV9EaXNhYmxlZHtjb2xvcjojYTZhNmE2O30uZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfVG9wTGV2ZWxfSXRlbV9TZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOiNlYmViZWI7fS5kaHRtbHhNZW51X21hdGVyaWFsX01pZGRsZSBpbWcuZGh0bWx4TWVudV9Ub3BMZXZlbF9JdGVtX0ljb257ZmxvYXQ6bGVmdDttYXJnaW46NXB4IDNweCAwIDNweDt3aWR0aDoxOHB4O2hlaWdodDoxOHB4O2N1cnNvcjpkZWZhdWx0O30uZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LnRvcF9zZXB7cG9zaXRpb246cmVsYXRpdmU7ZmxvYXQ6bGVmdDtoZWlnaHQ6MjJweDt3aWR0aDowO2JvcmRlci1sZWZ0OjFweCBzb2xpZCAjZGZkZmRmO21hcmdpbjozcHggOHB4IDAgOHB4O2ZvbnQtc2l6ZToxcHg7b3ZlcmZsb3c6aGlkZGVuO2N1cnNvcjpkZWZhdWx0Oy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7LW8tdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lO30uZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfVG9wTGV2ZWxfVGV4dF9yaWdodCwuZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfVG9wTGV2ZWxfVGV4dF9sZWZ0e3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2hlaWdodDoyOHB4O2xpbmUtaGVpZ2h0OjI4cHg7Y3Vyc29yOmRlZmF1bHQ7Zm9udC1zaXplOjE0cHg7Zm9udC1mYW1pbHk6Um9ib3RvLEFyaWFsLEhlbHZldGljYTtjb2xvcjojNDA0MDQwOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7LW8tdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lO30uZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUgZGl2LmRodG1seE1lbnVfVG9wTGV2ZWxfVGV4dF9yaWdodHtyaWdodDo2cHg7fS5kaHRtbHhNZW51X21hdGVyaWFsX01pZGRsZSBkaXYuZGh0bWx4TWVudV9Ub3BMZXZlbF9UZXh0X2xlZnR7bGVmdDo2cHg7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29ue3Bvc2l0aW9uOmFic29sdXRlO3BhZGRpbmc6NXB4IDA7YmFja2dyb3VuZC1jb2xvcjojZmFmYWZhO292ZXJmbG93OmhpZGRlbjtjdXJzb3I6ZGVmYXVsdDtsaW5lLWhlaWdodDpub3JtYWw7b3ZlcmZsb3cteTphdXRvOy13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOnRvdWNoOy13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjpyZ2JhKDAsMCwwLDApO2JveC1zaGFkb3c6MCAxcHggM3B4IHJnYmEoMCwwLDAsMC4xMiksMCAxcHggMnB4IHJnYmEoMCwwLDAsMC4yNCk7LXdlYmtpdC11c2VyLXNlbGVjdDpub25lOy1raHRtbC11c2VyLXNlbGVjdDpub25lOy1tb3otdXNlci1zZWxlY3Q6bm9uZTstbXMtdXNlci1zZWxlY3Q6bm9uZTstby11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmU7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRke3BhZGRpbmc6MDttYXJnaW46MDtsaW5lLWhlaWdodDpub3JtYWw7d2hpdGUtc3BhY2U6bm93cmFwO2ZvbnQtc2l6ZToxNHB4O2ZvbnQtZmFtaWx5OlJvYm90byxBcmlhbCxIZWx2ZXRpY2E7Y29sb3I6IzQwNDA0MDt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gdGQuc3ViX2l0ZW1faWNvbnt3aWR0aDoxOHB4O3RleHQtYWxpZ246Y2VudGVyO31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ZC5zdWJfaXRlbV9pY29uIGltZy5zdWJfaWNvbnttYXJnaW46NHB4IDZweCAwIDZweDt3aWR0aDoxOHB4O2hlaWdodDoxOHB4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ZC5zdWJfaXRlbV9pY29uIGl7d2lkdGg6MThweDtoZWlnaHQ6MzBweDtsaW5lLWhlaWdodDoyOXB4O21hcmdpbjowIDZweDtmb250LXNpemU6MS4yZW07dGV4dC1hbGlnbjpjZW50ZXI7Y29sb3I6aW5oZXJpdDt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gdGQuc3ViX2l0ZW1faWNvbiBkaXYuc3ViX2ljb257bWFyZ2luOjAgNnB4O3dpZHRoOjE4cHg7aGVpZ2h0OjMwcHg7bGluZS1oZWlnaHQ6MzBweDtiYWNrZ3JvdW5kLXBvc2l0aW9uOjAgNXB4O2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDtiYWNrZ3JvdW5kLWltYWdlOnVybCgiaW1ncy9kaHhtZW51X21hdGVyaWFsL2RoeG1lbnVfY2hyZC5wbmciKTt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gdGQuc3ViX2l0ZW1faWNvbiBkaXYuc3ViX2ljb24uY2hieF8we2JhY2tncm91bmQtcG9zaXRpb246MCA1cHg7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRkLnN1Yl9pdGVtX2ljb24gZGl2LnN1Yl9pY29uLmNoYnhfMXtiYWNrZ3JvdW5kLXBvc2l0aW9uOi0xOHB4IDVweDt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gdGQuc3ViX2l0ZW1faWNvbiBkaXYuc3ViX2ljb24ucmRidF8we2JhY2tncm91bmQtcG9zaXRpb246LTcycHggNXB4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ZC5zdWJfaXRlbV9pY29uIGRpdi5zdWJfaWNvbi5yZGJ0XzF7YmFja2dyb3VuZC1wb3NpdGlvbjotOTBweCA1cHg7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRkLnN1Yl9pdGVtX3RleHQgZGl2LnN1Yl9pdGVtX3RleHR7cG9zaXRpb246cmVsYXRpdmU7aGVpZ2h0OjMwcHg7bGluZS1oZWlnaHQ6MzBweDtwYWRkaW5nOjAgMjJweCAwIDFweDtvdmVyZmxvdzpoaWRkZW47fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRkLnN1Yl9pdGVtX2hre3BhZGRpbmc6MCAxMHB4IDAgOHB4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ZC5zdWJfaXRlbV9oayBkaXYuc3ViX2l0ZW1faGt7Y29sb3I6IzhkOGQ4ZDtmb250LXNpemU6MTJweDt0ZXh0LWFsaWduOnJpZ2h0O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ZCBkaXYuY29tcGxleF9hcnJvd3tmbG9hdDpyaWdodDt3aWR0aDoxMHB4O21hcmdpbjowIDFweCAwIDExcHg7aGVpZ2h0OjMwcHg7bGluZS1oZWlnaHQ6MzBweDtiYWNrZ3JvdW5kLWltYWdlOnVybCgiaW1ncy9kaHhtZW51X21hdGVyaWFsL2RoeG1lbnVfc3ViYXIucG5nIik7YmFja2dyb3VuZC1yZXBlYXQ6bm8tcmVwZWF0O2JhY2tncm91bmQtcG9zaXRpb246MCAxMHB4O292ZXJmbG93OmhpZGRlbjtmb250LXNpemU6MXB4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ZCBkaXYuY29tcGxleF9hcnJvd19sb2FkaW5ne3dpZHRoOjE2cHg7aGVpZ2h0OjMwcHg7bGluZS1oZWlnaHQ6MzBweDtiYWNrZ3JvdW5kLXBvc2l0aW9uOmNlbnRlciBjZW50ZXI7YmFja2dyb3VuZC1yZXBlYXQ6bm8tcmVwZWF0O2JhY2tncm91bmQtaW1hZ2U6dXJsKCJpbWdzL2RoeG1lbnVfbWF0ZXJpYWwvZGh4bWVudV9sb2FkZXIuZ2lmIik7ZmxvYXQ6cmlnaHQ7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRyLnN1Yl9pdGVtX3NlbGVjdGVkIHRke2JhY2tncm91bmQtY29sb3I6I2ViZWJlYjt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gdHIuc3ViX2l0ZW1fc2VsZWN0ZWQgdGQgZGl2LmNvbXBsZXhfYXJyb3d7YmFja2dyb3VuZC1wb3NpdGlvbjotMTBweCAxMHB4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ci5zdWJfaXRlbV9kaXMgdGQuc3ViX2l0ZW1faGsgZGl2LnN1Yl9pdGVtX2hre2NvbG9yOiNjMGMwYzA7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRyLnN1Yl9pdGVtX2RpcyB0ZCBkaXYuc3ViX2l0ZW1fdGV4dCxkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ci5zdWJfaXRlbV9kaXMgdGQgdGQuc3ViX2l0ZW1faWNvbiBpe2NvbG9yOiNhNmE2YTY7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRyLnN1Yl9pdGVtX2RpcyB0ZCBkaXYuY29tcGxleF9hcnJvd3tiYWNrZ3JvdW5kLXBvc2l0aW9uOi0yMHB4IDEwcHg7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRyLnN1Yl9pdGVtX2RpcyB0ZCBkaXYuc3ViX2ljb24uY2hieF8we2JhY2tncm91bmQtcG9zaXRpb246LTM2cHggNXB4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ci5zdWJfaXRlbV9kaXMgdGQgZGl2LnN1Yl9pY29uLmNoYnhfMXtiYWNrZ3JvdW5kLXBvc2l0aW9uOi01NHB4IDVweDt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gdHIuc3ViX2l0ZW1fZGlzIHRkIGRpdi5zdWJfaWNvbi5yZGJ0XzB7YmFja2dyb3VuZC1wb3NpdGlvbjotMTA4cHggNXB4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ci5zdWJfaXRlbV9kaXMgdGQgZGl2LnN1Yl9pY29uLnJkYnRfMXtiYWNrZ3JvdW5kLXBvc2l0aW9uOi0xMjZweCA1cHg7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRyLnN1Yl9pdGVtX2RpcyB0ZCBpe2NvbG9yOiNhNmE2YTY7fWRpdi5kaHRtbHhNZW51X21hdGVyaWFsX1N1YkxldmVsQXJlYV9Qb2x5Z29uIHRyLnN1Yl9zZXAgdGR7cGFkZGluZzo1cHggM3B4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiB0ci5zdWJfc2VwIHRkIGRpdi5zdWJfc2Vwe3Bvc2l0aW9uOnJlbGF0aXZlO2ZvbnQtc2l6ZToxcHg7bGluZS1oZWlnaHQ6MXB4O2hlaWdodDowO3dpZHRoOjEwMCU7Ym9yZGVyLXRvcDoxcHggc29saWQgI2RmZGZkZjt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX0Fycm93VXAsZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX0Fycm93VXBfT3ZlcixkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiBkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfQXJyb3dVcF9EaXNhYmxlZHtwb3NpdGlvbjpyZWxhdGl2ZTtmb250LXNpemU6MXB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNkZmRmZGY7YmFja2dyb3VuZC1pbWFnZTp1cmwoImltZ3MvZGh4bWVudV9tYXRlcmlhbC9kaHhtZW51X2Fycm93X3VwLnBuZyIpO2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDtiYWNrZ3JvdW5kLXBvc2l0aW9uOmNlbnRlciAycHg7cGFkZGluZzo4cHggMDttYXJnaW4tYm90dG9tOjNweDt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX0Fycm93VXBfRGlzYWJsZWR7YmFja2dyb3VuZC1pbWFnZTp1cmwoImltZ3MvZGh4bWVudV9tYXRlcmlhbC9kaHhtZW51X2Fycm93X3VwX2Rpcy5wbmciKTt9ZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX0Fycm93RG93bixkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiBkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfQXJyb3dEb3duX092ZXIsZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX1BvbHlnb24gZGl2LmRodG1seE1lbnVfbWF0ZXJpYWxfU3ViTGV2ZWxBcmVhX0Fycm93RG93bl9EaXNhYmxlZHtwb3NpdGlvbjpyZWxhdGl2ZTtmb250LXNpemU6MXB4O2JvcmRlci10b3A6MXB4IHNvbGlkICNkZmRmZGY7YmFja2dyb3VuZC1pbWFnZTp1cmwoImltZ3MvZGh4bWVudV9tYXRlcmlhbC9kaHhtZW51X2Fycm93X2Rvd24ucG5nIik7YmFja2dyb3VuZC1yZXBlYXQ6bm8tcmVwZWF0O2JhY2tncm91bmQtcG9zaXRpb246Y2VudGVyIDZweDtwYWRkaW5nOjhweCAwO21hcmdpbi10b3A6M3B4O31kaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfUG9seWdvbiBkaXYuZGh0bWx4TWVudV9tYXRlcmlhbF9TdWJMZXZlbEFyZWFfQXJyb3dEb3duX0Rpc2FibGVke2JhY2tncm91bmQtaW1hZ2U6dXJsKCJpbWdzL2RoeG1lbnVfbWF0ZXJpYWwvZGh4bWVudV9hcnJvd19kb3duX2Rpcy5wbmciKTt9aWZyYW1lLmRodG1seE1lbnVfSUU2Q292ZXJGaXhfbWF0ZXJpYWx7cG9zaXRpb246YWJzb2x1dGU7Ym9yZGVyOm5vbmU7YmFja2dyb3VuZDojMDAwO2ZpbHRlcjpwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuQWxwaGEob3BhY2l0eT0xMDApO30uZGh0bWx4TWVudV9tYXRlcmlhbF9NaWRkbGUuZGlyX2xlZnQgZGl2LmFsaWduX2xlZnR7ZmxvYXQ6bGVmdDt9LmRodG1seE1lbnVfbWF0ZXJpYWxfTWlkZGxlLmRpcl9sZWZ0IGRpdi5hbGlnbl9yaWdodHtmbG9hdDpyaWdodDt9LmRoeG1lbnVfc2tpbl9kZXRlY3R7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3RvcDotMTAwcHg7bWFyZ2luOjA7cGFkZGluZzowO2JvcmRlcjowIHNvbGlkIHdoaXRlO3dpZHRoOjQwcHg7aGVpZ2h0OjEwcHg7b3ZlcmZsb3c6aGlkZGVuO31Aa2V5ZnJhbWVzIGRoeF9sb2FkZXJfcm90YXRlezEwMCV7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpO319QGtleWZyYW1lcyBkaHhfbG9hZGVyX2Rhc2h7MCV7c3Ryb2tlLWRhc2hhcnJheToxLDIwMDtzdHJva2UtZGFzaG9mZnNldDowO301MCV7c3Ryb2tlLWRhc2hhcnJheTo4OSwyMDA7c3Ryb2tlLWRhc2hvZmZzZXQ6LTM1cHg7fTEwMCV7c3Ryb2tlLWRhc2hhcnJheTo4OSwyMDA7c3Ryb2tlLWRhc2hvZmZzZXQ6LTEyNHB4O319LmRlZmF1bHRUcmVlVGFibGV7bWFyZ2luOjA7cGFkZGluZzowO2JvcmRlcjowO30uY29udGFpbmVyVGFibGVTdHlsZXtvdmVyZmxvdzphdXRvOy13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOnRvdWNoO3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDowO2ZvbnQtc2l6ZToxMnB4Oy1raHRtbC11c2VyLXNlbGVjdDpub25lO30uY29udGFpbmVyVGFibGVTdHlsZVJUTCBzcGFue2RpcmVjdGlvbjpydGw7dW5pY29kZS1iaWRpOmJpZGktb3ZlcnJpZGU7fS5jb250YWluZXJUYWJsZVN0eWxlUlRMe2RpcmVjdGlvbjpydGw7b3ZlcmZsb3c6YXV0bztwb3NpdGlvbjpyZWxhdGl2ZTt0b3A6MDtmb250LXNpemU6MTJweDt9LnN0YW5kYXJ0VHJlZVJvd3tmb250LWZhbWlseTpSb2JvdG8sQXJpYWwsSGVsdmV0aWNhO2ZvbnQtc2l6ZTo7LW1vei11c2VyLXNlbGVjdDpub25lO2xpbmUtaGVpZ2h0OjI0cHg7fS5zZWxlY3RlZFRyZWVSb3d7Zm9udC1mYW1pbHk6Um9ib3RvLEFyaWFsLEhlbHZldGljYTtmb250LXNpemU6Oy1tb3otdXNlci1zZWxlY3Q6bm9uZTtiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Y29sb3I6IzM5Yzt9LmRoeHRyZWVfbWF0ZXJpYWwgLnNlbGVjdGVkVHJlZVJvd0Z1bGwgLmRoeFRleHRDZWxse2JhY2tncm91bmQtY29sb3I6I2VlZTtjb2xvcjojMzljO30uZHJhZ0FuZERyb3BSb3d7Y29sb3I6IzM5Yzt9LnN0YW5kYXJ0VHJlZVJvd19sb3J7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTtiYWNrZ3JvdW5kLWNvbG9yOjtmb250LWZhbWlseTpSb2JvdG8sQXJpYWwsSGVsdmV0aWNhO2ZvbnQtc2l6ZTo7LW1vei11c2VyLXNlbGVjdDpub25lO30uc3RhbmRhcnRUcmVlSW1hZ2V7aGVpZ2h0OjI0cHg7b3ZlcmZsb3c6aGlkZGVuO2JvcmRlcjowO3BhZGRpbmc6MDttYXJnaW46MDtmb250LXNpemU6MXB4O30uc3RhbmRhcnRUcmVlSW1hZ2UgaW1ne3dpZHRoOjE4cHg7aGVpZ2h0OjI0cHg7YmFja2dyb3VuZC1wb3NpdGlvbjpjZW50ZXIgY2VudGVyO2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDtib3JkZXI6MDtwYWRkaW5nOjA7bWFyZ2luOjA7Zm9udC1zaXplOjFweDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7LWtodG1sLXVzZXItc2VsZWN0Om5vbmU7LW1vei11c2VyLXNlbGVjdDpub25lOy1tcy11c2VyLXNlbGVjdDpub25lOy1vLXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTt9LmhpZGRlblJvd3t3aWR0aDoxcHg7b3ZlcmZsb3c6aGlkZGVuO30uZHJhZ1NwYW5EaXYsLmRyYWdTcGFuRGl2IHRke2ZvbnQtZmFtaWx5OlJvYm90byxBcmlhbCxIZWx2ZXRpY2E7Zm9udC1zaXplOjtsaW5lLWhlaWdodDo7dmVydGljYWwtYWxpZ246Y2VudGVyO2JhY2tncm91bmQtY29sb3I6d2hpdGU7ei1pbmRleDo5OTk7fS5kcmFnU3BhbkRpdiB0ZHtwYWRkaW5nOjVweDt9LmFfZGh4X2hpZGRlbl9pbnB1dHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6LTFweDtsZWZ0Oi0xcHg7d2lkdGg6MXB4O2hlaWdodDoxcHg7Ym9yZGVyOm5vbmU7YmFja2dyb3VuZDpub25lO30uYV9kaHhfaGlkZGVuX2lucHV0e3Bvc2l0aW9uOmFic29sdXRlO3RvcDotMXB4O2xlZnQ6LTFweDt3aWR0aDoxcHg7aGVpZ2h0OjFweDtib3JkZXI6bm9uZTtiYWNrZ3JvdW5kOm5vbmU7fS5zZWxlY3Rpb25CYXJ7dG9wOjA7YmFja2dyb3VuZC1jb2xvcjpibGFjaztwb3NpdGlvbjphYnNvbHV0ZTtvdmVyZmxvdzpoaWRkZW47aGVpZ2h0OjJweDt6LWluZGV4OjExO30uaW50cmVlZWRpdFJvd3tmb250LXNpemU6OHB0O2hlaWdodDoxNnB4O2JvcmRlcjoxcHggc29saWQgc2lsdmVyO3BhZGRpbmc6MDttYXJnaW46MDttYXJnaW4tbGVmdDo0cHg7LW1vei11c2VyLXNlbGVjdDp0ZXh0Oy1raHRtbC11c2VyLXNlbGVjdDp0ZXh0O30uZGh4X3RyZWVfdGV4dFNpZ257Zm9udC1zaXplOjhwdDtmb250LWZhbWlseTptb25vc3BhY2U7d2lkdGg6MjFweDtjb2xvcjo7cGFkZGluZzowO21hcmdpbjowO2N1cnNvcjpwb2ludGVyO3RleHQtYWxpZ246Y2VudGVyO30uZGh4X3RyZWVfb3BhY2l0eXtvcGFjaXR5OjA7ZmlsdGVyOnByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYShvcGFjaXR5PTApOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7LW8tdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lO30uZGh4X2JnX2ltZ19maXh7d2lkdGg6MThweDtoZWlnaHQ6MjRweDtiYWNrZ3JvdW5kLXJlcGVhdDpuby1yZXBlYXQ7YmFja2dyb3VuZC1wb3NpdGlvbjpjZW50ZXI7YmFja2dyb3VuZC1wb3NpdGlvbi14OmNlbnRlcjtiYWNrZ3JvdW5kLXBvc2l0aW9uLXk6Y2VudGVyO30uZGh4dHJlZV9za2luX2RldGVjdHtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7dG9wOi0xMDBweDttYXJnaW46MDtwYWRkaW5nOjA7Ym9yZGVyOjAgc29saWQgd2hpdGU7d2lkdGg6NDBweDtoZWlnaHQ6MTBweDtvdmVyZmxvdzpoaWRkZW47fScsZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7dmFyIGxheWFhaXJfZGVidWdfdmlldz17fTt3aW5kb3cubGF5YWFpcl9kZWJ1Z192aWV3PWxheWFhaXJfZGVidWdfdmlldyxsYXlhYWlyX2RlYnVnX3ZpZXcuaW5pdExheWFBaXJEZWJ1Z1ZpZXc9ZnVuY3Rpb24oZSl7ZS5zdHlsZS5ib3JkZXI9IjFweCBzb2xpZCBibGFjayI7dmFyIHQ9TWF0aC5taW4oMjUwLC4zKmUub2Zmc2V0V2lkdGgpLGk9JzxkaXYgY2xhc3M9InRvcC1iYW5uZXIiPlxuPC9kaXY+XG48ZGl2PlxuPGRpdiBzdHlsZT0ib3ZlcmZsb3c6aGlkZGVuOyBib3JkZXItYm90dG9tOjFweCBzb2xpZCAjNDQ0OyBwYWRkaW5nOjVweCI+XG48ZGl2IHN0eWxlPSJmbG9hdDpsZWZ0Ij5cbjxidXR0b24gaWQ9Im5vZGVfZnVuY3Rpb25hbGl0eV9jb250cm9sIj7lrqHmn6XlhYPntKA8L2J1dHRvbj5cbjxidXR0b24gaWQ9InJlZnJlc2hfY29udHJvbCI+5Yi35pawPC9idXR0b24+XG48L2Rpdj5cbjxkaXYgc3R5bGU9ImZsb2F0OnJpZ2h0Ij5cbjxpbnB1dCB0eXBlPSJjaGVja2JveCIgaWQ9InNob3dfY3VycmVudF9jYWNoZV9jb250cm9sIj7mmL7npLrlvZPliY1jYWNoZemHjee7mDwvaW5wdXQ+XG48aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJzaG93X2FsbF9jYWNoZV9jb250cm9sIj7mmL7npLrmiYDmnIljYWNoZeWMuuWfnzwvaW5wdXQ+XG48aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJzaG93X2F0bGFzX2NvbnRyb2wiPuaYvuekuuWkp+WbvuWQiOmbhjwvaW5wdXQ+XG48L2Rpdj5cbjwvZGl2PlxuPGRpdiBjbGFzcz0iaGdyb3VwIj5cbjxkaXYgc3R5bGU9ImZsb2F0OmxlZnQ7d2lkdGg6Jyt0KydweDsgYm9yZGVyLXJpZ2h0OjFweCBzb2xpZCBibGFjayIgaWQ9InRyZWVfY29udGFpbmVyIj48L2Rpdj5cbjxkaXYgc3R5bGU9Im92ZXJmbG93OmhpZGRlbiI+XG48ZGl2IGlkPSJjb250ZW50X3Rvb2xiYXIiIHN0eWxlPSJ3aWR0aDoxMDAlO21hcmdpbjoxMHB4Ij48aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJ2aXNpYmlsaXR5X2NvbnRyb2wiPuWPr+ingTwvaW5wdXQ+XG48aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJzaG93X2JvcmRlcl9jb250cm9sIj7mmL7npLrovrnmoYY8L2lucHV0PlxuPGJ1dHRvbiBpZD0ibG9nX2luZm9fY29udHJvbCI+5omT5Y2w5Yiw5o6n5Yi25Y+wPC9idXR0b24+XG48YnV0dG9uIGlkPSJlbmFibGVkX25vZGVfY2hhaW5fY29udHJvbCI+ZW5hYmxl6ZO+PC9idXR0b24+XG48YnV0dG9uIGlkPSJzaXplX2NoYWluX2NvbnRyb2wiPnNpemXpk748L2J1dHRvbj5cbjwvZGl2PjxkaXYgc3R5bGU9Im92ZXJmbG93OmF1dG8iPjx0YWJsZSBpZD0iY29udGVudF90YWJsZSIgc3R5bGU9ImJvcmRlcjoxcHggc29saWQgI2NjY2NjYztib3JkZXItY29sbGFwc2U6Y29sbGFwc2UiPjwvdGFibGU+XG48L2Rpdj48L2Rpdj5cbjwvZGl2PlxuPC9kaXY+JztlLmlubmVySFRNTD1pLHRoaXMuY29udGFpbmVyPWUsdGhpcy50cmVlPW5ldyBkaHRtbFhUcmVlT2JqZWN0KHRyZWVfY29udGFpbmVyLCIxMDAlIiwiMTAwJSIsMCksbm9kZV9mdW5jdGlvbmFsaXR5X2NvbnRyb2wub25jbGljaz1mdW5jdGlvbihlKXtlLnN0b3BQcm9wYWdhdGlvbigpLGxheWFhaXJfZGVidWdfdmlldy5vbl9pbnNwZWN0X2VsZW1lbnRfY2FsbGJhY2soKSxub2RlX2Z1bmN0aW9uYWxpdHlfY29udHJvbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9IiNGRkYiLG5vZGVfZnVuY3Rpb25hbGl0eV9jb250cm9sLnN0eWxlLmNvbG9yPSJyZ2IoMTA3LCAxNjMsIDI1NSkifX0sbGF5YWFpcl9kZWJ1Z192aWV3LnNldFRyZWU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXRoaXMudHJlZS5nZXRBbGxJdGVtc1dpdGhLaWRzKCkuc3BsaXQoIiwiKSxpPVtdLG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIG89dFtuXSxyPXRoaXMudHJlZS5nZXRPcGVuU3RhdGUobyk7MT09ciYmaS5wdXNoKG8pfXRoaXMudHJlZS5kZWxldGVDaGlsZEl0ZW1zKDApLHRoaXMudHJlZS5wYXJzZShlLCJqc29uIik7Zm9yKHZhciBuPTA7bjxpLmxlbmd0aDtuKyspdGhpcy50cmVlLm9wZW5JdGVtKGlbbl0pfSxsYXlhYWlyX2RlYnVnX3ZpZXcucmVzaXplPWZ1bmN0aW9uKGUsdCl7dGhpcy5jb250YWluZXIuc3R5bGUud2lkdGg9ZSsicHgiLHRoaXMuY29udGFpbmVyLnN0eWxlLmhlaWdodD10KyJweCI7dmFyIGk9dGhpcy5jb250YWluZXIub2Zmc2V0SGVpZ2h0LXRyZWVfY29udGFpbmVyLm9mZnNldFRvcDt0cmVlX2NvbnRhaW5lci5zdHlsZS5oZWlnaHQ9aSsicHgiLGNvbnRlbnRfdG9vbGJhci5zdHlsZS53aWR0aD1lLXRyZWVfY29udGFpbmVyLm9mZnNldFdpZHRoKyJweCIsY29udGVudF90YWJsZS5wYXJlbnRFbGVtZW50LnN0eWxlLmhlaWdodD1pLWNvbnRlbnRfdG9vbGJhci5vZmZzZXRIZWlnaHQtMjErInB4Iixjb250ZW50X3RhYmxlLnN0eWxlLndpZHRoPWUtdHJlZV9jb250YWluZXIub2Zmc2V0V2lkdGgtMTYrInB4In0sbGF5YWFpcl9kZWJ1Z192aWV3LmJvdW5jZVVwSW5zcGVjdEJ1dHRvbj1mdW5jdGlvbigpe25vZGVfZnVuY3Rpb25hbGl0eV9jb250cm9sLnN0eWxlLmJhY2tncm91bmRDb2xvcj0iYnV0dG9uZmFjZSIsbm9kZV9mdW5jdGlvbmFsaXR5X2NvbnRyb2wuc3R5bGUuY29sb3I9ImJsYWNrIn0sbGF5YWFpcl9kZWJ1Z192aWV3LnNldFZhbHVlSW5wdXRIYW5kbGVyPWZ1bmN0aW9uKGUpe3RoaXMudmFsdWVfaW5wdXRfY2FsbGJhY2s9ZX0sbGF5YWFpcl9kZWJ1Z192aWV3LnNldFZhbHVlQ2hhbmdlSGFuZGxlcj1mdW5jdGlvbihlKXt0aGlzLnZhbHVlX2NoYW5nZV9jYWxsYmFjaz1lfSxsYXlhYWlyX2RlYnVnX3ZpZXcuYWRkQ29udGVudD1mdW5jdGlvbihlKXt2YXIgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ciIpO3QuaW5uZXJIVE1MPSc8dGQgc3R5bGU9IndpZHRoOjEwMHB4O2ZvbnQtc2l6ZToxM3B4O2JvcmRlcjoxcHggc29saWQgI0NDQztwYWRkaW5nLWxlZnQ6MTBweCI+JytlLmtleSsnPC90ZD5cbjx0ZCBzdHlsZT0id2lkdGg6MjAwcHg7Ym9yZGVyOjFweCBzb2xpZCAjQ0NDOyI+PGlucHV0IHN0eWxlPSJib3JkZXI6bm9uZTt3aWR0aDoxMDAlO2hlaWdodDoyNXB4O3BhZGRpbmctbGVmdDoxMHB4OyIgdmFsdWU9JytlLnZhbHVlKyI+PC90ZD4iLGNvbnRlbnRfdGFibGUuYXBwZW5kQ2hpbGQodCk7dmFyIGk9dC5sYXN0RWxlbWVudENoaWxkLmxhc3RFbGVtZW50Q2hpbGQ7aS5kYXRhPWUsaS5vbmlucHV0PWZ1bmN0aW9uKGUpe3RoaXMudmFsdWVfaW5wdXRfY2FsbGJhY2smJnRoaXMudmFsdWVfaW5wdXRfY2FsbGJhY2soZS50YXJnZXQuZGF0YSxlLnRhcmdldC52YWx1ZSl9LmJpbmQodGhpcyksaS5vbmNoYW5nZT1mdW5jdGlvbihlKXt0aGlzLnZhbHVlX2NoYW5nZV9jYWxsYmFjayYmdGhpcy52YWx1ZV9jaGFuZ2VfY2FsbGJhY2soZS50YXJnZXQuZGF0YSxlLnRhcmdldC52YWx1ZSl9LmJpbmQodGhpcyl9LGxheWFhaXJfZGVidWdfdmlldy5zZXRDb250ZW50cz1mdW5jdGlvbihlKXtjb250ZW50X3RhYmxlLmlubmVySFRNTD0iIjtmb3IodmFyIHQ9MDt0PGUubGVuZ3RoO3QrKyl7dmFyIGk9ZVt0XTt0aGlzLmFkZENvbnRlbnQoaSl9fSxsYXlhYWlyX2RlYnVnX3ZpZXcuY2hhbmdlVmFsdWVBdD1mdW5jdGlvbihlLHQpe2NvbnRlbnRfdGFibGUuY2hpbGRyZW5bZV0ubGFzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZC52YWx1ZT10fSxsYXlhYWlyX2RlYnVnX3ZpZXcuY2hhbmdlVmFsdWVCeUxhYmVsPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBpPWNvbnRlbnRfdGFibGUuY2hpbGRyZW4ubGVuZ3RoLTE7aT49MDtpLS0paWYoY29udGVudF90YWJsZS5jaGlsZHJlbltpXS5maXJzdEVsZW1lbnRDaGlsZC5pbm5lclRleHQ9PWUpe2NvbnRlbnRfdGFibGUuY2hpbGRyZW5baV0ubGFzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZC52YWx1ZT10O2JyZWFrfX0sbGF5YWFpcl9kZWJ1Z192aWV3LnNldFZpc2liaWxpdHk9ZnVuY3Rpb24oZSl7dmlzaWJpbGl0eV9jb250cm9sLmNoZWNrZWQ9ISFlfSxsYXlhYWlyX2RlYnVnX3ZpZXcuc2V0U2hvd0RlYnVnQm9yZGVyPWZ1bmN0aW9uKGUpe3Nob3dfYm9yZGVyX2NvbnRyb2wuY2hlY2tlZD0hIWV9LGxheWFhaXJfZGVidWdfdmlldy5nZXRWaXNpYmlsaXR5PWZ1bmN0aW9uKCl7cmV0dXJuIHZpc2liaWxpdHlfY29udHJvbC5jaGVja2VkfSxsYXlhYWlyX2RlYnVnX3ZpZXcuZ2V0U2hvd0RlYnVnQm9yZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHNob3dfYm9yZGVyX2NvbnRyb2wuY2hlY2tlZH0sbGF5YWFpcl9kZWJ1Z192aWV3LmdldFNob3dDdXJyZW50Q2FjaGU9ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd19jdXJyZW50X2NhY2hlX2NvbnRyb2wuY2hlY2tlZH0sbGF5YWFpcl9kZWJ1Z192aWV3LmdldFNob3dBbGxDYWNoZT1mdW5jdGlvbigpe3JldHVybiBzaG93X2FsbF9jYWNoZV9jb250cm9sLmNoZWNrZWR9LGxheWFhaXJfZGVidWdfdmlldy5nZXRTaG93QXRsYXM9ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd19hdGxhc19jb250cm9sLmNoZWNrZWR9LGxheWFhaXJfZGVidWdfdmlldy5vbkluc3BlY3RFbGVtZW50PWZ1bmN0aW9uKGUpe3RoaXMub25faW5zcGVjdF9lbGVtZW50X2NhbGxiYWNrPWV9LGxheWFhaXJfZGVidWdfdmlldy5vbkxvZ0luZm89ZnVuY3Rpb24oZSl7bG9nX2luZm9fY29udHJvbC5vbmNsaWNrPWV9LGxheWFhaXJfZGVidWdfdmlldy5vblJlZnJlc2g9ZnVuY3Rpb24oZSl7cmVmcmVzaF9jb250cm9sLm9uY2xpY2s9ZX0sbGF5YWFpcl9kZWJ1Z192aWV3Lm9uUHJpbnRFbmFibGVkTm9kZUNoYWluPWZ1bmN0aW9uKGUpe2VuYWJsZWRfbm9kZV9jaGFpbl9jb250cm9sLm9uY2xpY2s9ZX0sbGF5YWFpcl9kZWJ1Z192aWV3Lm9uUHJpbnRTaXplQ2hhaW49ZnVuY3Rpb24oZSl7c2l6ZV9jaGFpbl9jb250cm9sLm9uY2xpY2s9ZX0sbGF5YWFpcl9kZWJ1Z192aWV3Lm9uVG9nZ2xlVmlzaWJpbGl0eT1mdW5jdGlvbihlKXt2aXNpYmlsaXR5X2NvbnRyb2wub25jaGFuZ2U9ZX0sbGF5YWFpcl9kZWJ1Z192aWV3Lm9uVG9nZ2xlRGVidWdCb3JkZXI9ZnVuY3Rpb24oZSl7c2hvd19ib3JkZXJfY29udHJvbC5vbmNoYW5nZT1lfSxsYXlhYWlyX2RlYnVnX3ZpZXcub25Ub2dnbGVTaG93Q3VycmVudENhY2hlPWZ1bmN0aW9uKGUpe3Nob3dfY3VycmVudF9jYWNoZV9jb250cm9sLm9uY2hhbmdlPWV9LGxheWFhaXJfZGVidWdfdmlldy5vblRvZ2dsZVNob3dBbGxDYWNoZT1mdW5jdGlvbihlKXtzaG93X2FsbF9jYWNoZV9jb250cm9sLm9uY2hhbmdlPWV9LGxheWFhaXJfZGVidWdfdmlldy5vblRvZ2dsZVNob3dBdGxhcz1mdW5jdGlvbihlKXtzaG93X2F0bGFzX2NvbnRyb2wub25jaGFuZ2U9ZX07";
	return DivScripts;
})()


/**
*tianpeng
*@author
*/
//class laya.debug.tools.AtlasTools
var AtlasTools=(function(){
	function AtlasTools(){
		this.mSprite=null;
		this.mIndex=0;
		this.mTextureDic={};
	}

	__class(AtlasTools,'laya.debug.tools.AtlasTools');
	var __proto=AtlasTools.prototype;
	__proto.start=function(){
		if (!Render.isWebGL)return;
		if (this.mSprite==null){
			this.mSprite=new Sprite();
		}
		Laya.stage.addChild(this.mSprite);
		this.showNext();
	}

	__proto.end=function(){
		if (!Render.isWebGL)return;
		if (this.mSprite){
			Laya.stage.removeChild(this.mSprite);
		}
	}

	__proto.showNext=function(){
		if (!Render.isWebGL)return;
		if (this.mSprite==null){
			this.mSprite=new Sprite();
		}
		Laya.stage.addChild(this.mSprite);
		this.mIndex++;
		var resManager;
		resManager=laya.webgl.atlas.AtlasResourceManager.instance;;
		var tCount=resManager.getAtlaserCount();
		if (this.mIndex >=tCount){
			this.mIndex=0;
		};
		var tTexture;
		if (this.mTextureDic[this.mIndex]){
			tTexture=this.mTextureDic[this.mIndex];
			}else {
			var tAtlaser=resManager.getAtlaserByIndex(this.mIndex);
			if (tAtlaser && tAtlaser.texture){
				tTexture=new Texture(tAtlaser.texture,null);
				this.mTextureDic[this.mIndex]=tTexture;
			}
		}
		if (tTexture){
			this.mSprite.graphics.clear();
			this.mSprite.graphics.save();
			this.mSprite.graphics.alpha(0.9);
			this.mSprite.graphics.drawRect(0,0,1024,1024,"#efefefe");
			this.mSprite.graphics.restore();
			this.mSprite.graphics.drawTexture(tTexture,0,0,1024,1024);
			this.mSprite.graphics.fillText((this.mIndex+1).toString()+"/"+tCount.toString(),25,100,"40px Arial","#ff0000","left");
		}
	}

	AtlasTools.getInstance=function(){
		return AtlasTools.mInstance=AtlasTools.mInstance|| new AtlasTools();
	}

	AtlasTools.mInstance=null;
	return AtlasTools;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.Base64Atlas
var Base64Atlas=(function(){
	function Base64Atlas(data,idKey){
		this.data=null;
		this.replaceO=null;
		this.idKey=null;
		this._loadedHandler=null;
		this.data=data;
		if (!idKey)idKey=Math.random()+"key";
		this.idKey=idKey;
		this.init();
	}

	__class(Base64Atlas,'laya.debug.tools.Base64Atlas');
	var __proto=Base64Atlas.prototype;
	//preLoad();
	__proto.init=function(){
		this.replaceO={};
		var key;
		for (key in this.data){
			this.replaceO[key]=this.idKey+"/"+key;
		}
	}

	__proto.getAdptUrl=function(url){
		return this.replaceO[url];
	}

	__proto.preLoad=function(completeHandler){
		this._loadedHandler=completeHandler;
		Laya.loader.load(Base64ImageTool.getPreloads(this.data),new Handler(this,this.preloadEnd));
	}

	__proto.preloadEnd=function(){
		var key;
		for (key in this.data){
			var tx;
			tx=Laya.loader.getRes(this.data[key]);
			Loader.cacheRes(this.replaceO[key],tx);
		}
		if (this._loadedHandler){
			this._loadedHandler.run();
		}
	}

	__proto.replaceRes=function(uiObj){
		ObjectTools.replaceValue(uiObj,this.replaceO);
	}

	return Base64Atlas;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.Base64ImageTool
var Base64ImageTool=(function(){
	function Base64ImageTool(){}
	__class(Base64ImageTool,'laya.debug.tools.Base64ImageTool');
	Base64ImageTool.getCanvasPic=function(img){
		img=img.bitmap;
		var canvas=Browser.createElement("canvas");
		var ctx=canvas.getContext('2d');
		canvas.height=img.height;
		canvas.width=img.width;
		ctx.drawImage(img.source,0,0);
		return canvas;
	}

	Base64ImageTool.getBase64Pic=function(img){
		return Base64ImageTool.getCanvasPic(img).toDataURL("image/png");
	}

	Base64ImageTool.getPreloads=function(base64Data){
		var rst;
		rst=[];
		var key;
		for (key in base64Data){
			rst.push({url:base64Data[key],type:"image" });
		}
		return rst;
	}

	return Base64ImageTool;
})()


/**
*base64编码解码类
*@author ww
*/
//class laya.debug.tools.Base64Tool
var Base64Tool=(function(){
	function Base64Tool(){}
	__class(Base64Tool,'laya.debug.tools.Base64Tool');
	Base64Tool.init=function(){
		if (Base64Tool.lookup)
			return;
		Base64Tool.lookup=new Uint8Array(256)
		for (var i=0;i < Base64Tool.chars.length;i++){
			Base64Tool.lookup[Base64Tool.chars.charCodeAt(i)]=i;
		}
	}

	Base64Tool.encode=function(arraybuffer){
		var bytes=new Uint8Array(arraybuffer),i=0,len=bytes.length,base64="";
		for (i=0;i < len;i+=3){
			base64+=Base64Tool.chars[bytes[i] >> 2];
			base64+=Base64Tool.chars[((bytes[i] & 3)<< 4)| (bytes[i+1] >> 4)];
			base64+=Base64Tool.chars[((bytes[i+1] & 15)<< 2)| (bytes[i+2] >> 6)];
			base64+=Base64Tool.chars[bytes[i+2] & 63];
		}
		if ((len % 3)===2){
			base64=base64.substring(0,base64.length-1)+"=";
		}
		else if (len % 3===1){
			base64=base64.substring(0,base64.length-2)+"==";
		}
		return base64;
	}

	Base64Tool.encodeStr=function(str){
		var byte;
		byte=new Byte();
		byte.writeUTFString(str);
		return Base64Tool.encodeByte(byte);
	}

	Base64Tool.encodeStr2=function(str){
		var byte;
		byte=new Byte();
		byte.writeUTFBytes(str);
		return Base64Tool.encodeByte(byte);
	}

	Base64Tool.encodeByte=function(byte,start,end){
		(start===void 0)&& (start=0);
		(end===void 0)&& (end=-1);
		if (end < 0){
			end=byte.length;
		}
		return Base64Tool.encode(byte.buffer.slice(start,end));
	}

	Base64Tool.decodeToByte=function(base64){
		return new Byte(Base64Tool.decode(base64));
	}

	Base64Tool.decode=function(base64){
		Base64Tool.init();
		var bufferLength=base64.length *0.75,len=base64.length,i=0,p=0,encoded1=0,encoded2=0,encoded3=0,encoded4=0;
		if (base64[base64.length-1]==="="){
			bufferLength--;
			if (base64[base64.length-2]==="="){
				bufferLength--;
			}
		};
		var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);
		for (i=0;i < len;i+=4){
			encoded1=Base64Tool.lookup[base64.charCodeAt(i)];
			encoded2=Base64Tool.lookup[base64.charCodeAt(i+1)];
			encoded3=Base64Tool.lookup[base64.charCodeAt(i+2)];
			encoded4=Base64Tool.lookup[base64.charCodeAt(i+3)];
			bytes[p++]=(encoded1 << 2)| (encoded2 >> 4);
			bytes[p++]=((encoded2 & 15)<< 4)| (encoded3 >> 2);
			bytes[p++]=((encoded3 & 3)<< 6)| (encoded4 & 63);
		}
		return arraybuffer;
	}

	Base64Tool.chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
	Base64Tool.lookup=null;
	return Base64Tool;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.CacheAnalyser
var CacheAnalyser=(function(){
	function CacheAnalyser(){}
	__class(CacheAnalyser,'laya.debug.tools.CacheAnalyser');
	var __proto=CacheAnalyser.prototype;
	__proto.renderCanvas=function(sprite,time){
		(time===void 0)&& (time=0);
		if (!CacheAnalyser.showCacheSprite)return;
		if (DebugInfoLayer.I.isDebugItem(sprite))return;
		DebugTool.showDisBoundToSprite(sprite,DebugInfoLayer.I.cacheViewLayer,DebugConsts.CANVAS_REC_COLOR,4);
	}

	__proto.reCacheCanvas=function(sprite,time){
		(time===void 0)&& (time=0);
		if (!CacheAnalyser.showRecacheSprite)return;
		if (DebugInfoLayer.I.isDebugItem(sprite))return;
		var info;
		info=CacheAnalyser.getNodeInfoByNode(sprite);
		info.addCount(time);
		CacheAnalyser.counter.addTime(sprite,time);
		if (!info.parent){
			DebugInfoLayer.I.nodeRecInfoLayer.addChild(info);
		}
	}

	CacheAnalyser.renderLoopBegin=function(){
		DebugInfoLayer.I.cacheViewLayer.graphics.clear();
	}

	CacheAnalyser.getNodeInfoByNode=function(node){
		IDTools.idObj(node);
		var key=0;
		key=IDTools.getObjID(node);
		if (!CacheAnalyser._nodeInfoDic[key]){
			CacheAnalyser._nodeInfoDic[key]=new ReCacheRecInfo();
		}
		(CacheAnalyser._nodeInfoDic [key]).setTarget(node);
		return CacheAnalyser._nodeInfoDic[key];
	}

	CacheAnalyser._nodeInfoDic={};
	CacheAnalyser.showCacheSprite=false;
	CacheAnalyser.showRecacheSprite=true;
	__static(CacheAnalyser,
	['counter',function(){return this.counter=new ObjTimeCountTool();},'I',function(){return this.I=new CacheAnalyser();}
	]);
	return CacheAnalyser;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.CanvasTools
var CanvasTools=(function(){
	function CanvasTools(){}
	__class(CanvasTools,'laya.debug.tools.CanvasTools');
	CanvasTools.createCanvas=function(width,height){
		var rst=new HTMLCanvas("2D");
		rst.getContext('2d');
		rst.size(width,height);
		return rst;
	}

	CanvasTools.renderSpriteToCanvas=function(sprite,canvas,offsetX,offsetY){
		RenderSprite.renders[sprite._renderType]._fun(sprite,canvas.context,offsetX,offsetY);
	}

	CanvasTools.getImageDataFromCanvas=function(canvas,x,y,width,height){
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		if (width <=0)
			width=canvas.width;
		if (height <=0)
			height=canvas.height;
		var imgdata=canvas.context.getImageData(x,y,width,height);
		return imgdata;
	}

	CanvasTools.getImageDataFromCanvasByRec=function(canvas,rec){
		var imgdata=canvas.context.getImageData(rec.x,rec.y,rec.width,rec.height);
		return imgdata;
	}

	CanvasTools.getDifferCount=function(imageData1,imageData2){
		var data1=imageData1.data;
		var data2=imageData2.data;
		var differCount=0;
		differCount=0;
		CanvasTools.walkImageData(imageData1,myWalkFun);
		return differCount;
		function myWalkFun (i,j,tarPos,data){
			if (!CanvasTools.isPoinSame(tarPos,data1,data2))differCount++;
		}
	}

	CanvasTools.getDifferRate=function(imageData1,imageData2){
		return CanvasTools.getDifferCount(imageData1,imageData2)/(imageData1.width *imageData1.height);
	}

	CanvasTools.getCanvasDisRec=function(canvas){
		var rst;
		rst=new Rectangle;
		var imgdata;
		imgdata=CanvasTools.getImageDataFromCanvas(canvas,0,0);
		var maxX=0;
		var minX=0;
		var maxY=0;
		var minY=0;
		maxX=maxY=0;
		minX=imgdata.width;
		minY=imgdata.height;
		var i=0,iLen=0;
		var j=0,jLen=0;
		iLen=imgdata.width;
		jLen=imgdata.height;
		var data;
		data=imgdata.data;
		var tarPos=0;
		for (j=0;j < jLen;j++){
			for (i=0;i < iLen;i++){
				if (!CanvasTools.isEmptyPoint(data,tarPos)){
					if (minX > i)
						minX=i;
					if (maxX < i)
						maxX=i;
					if (minY > j)
						minY=j;
					if (maxY < j)
						maxY=j;
				}
				tarPos+=4;
			}
		}
		rst.setTo(minX,minY,maxX-minX+1,maxY-minY+1);
		return rst;
	}

	CanvasTools.fillCanvasRec=function(canvas,rec,color){
		var ctx=canvas.context;
		ctx.fillStyle=color;
		ctx.fillRect(rec.x,rec.y,rec.width,rec.height);
	}

	CanvasTools.isEmptyPoint=function(data,pos){
		if (data[pos]==0 && data[pos+1]==0 && data[pos+2]==0 && data[pos+3]==0){
			return true;
		}
		else{
			return false;
		}
	}

	CanvasTools.isPoinSame=function(pos,data1,data2){
		if (data1[pos]==data2[pos] && data1[pos+1]==data2[pos+1] && data1[pos+2]==data2[pos+2] && data1[pos+3]==data2[pos+3]){
			return true;
		}
		else{
			return false;
		}
	}

	CanvasTools.walkImageData=function(imgdata,walkFun){
		var i=0,iLen=0;
		var j=0,jLen=0;
		iLen=imgdata.width;
		jLen=imgdata.height;
		var tarPos=0;
		var data=imgdata.data;
		for (i=0;i < iLen;i++){
			for (j=0;j < jLen;j++){
				walkFun(i,j,tarPos,data);
				tarPos+=4;
			}
		}
	}

	CanvasTools.getSpriteByCanvas=function(canvas){
		var rst;
		rst=new Sprite();
		rst.graphics.drawTexture(new Texture(canvas),0,0,canvas.width,canvas.height);
		return rst;
	}

	CanvasTools.renderSpritesToCanvas=function(canvas,sprites,offx,offy,startIndex){
		(offx===void 0)&& (offx=0);
		(offy===void 0)&& (offy=0);
		(startIndex===void 0)&& (startIndex=0);
		var i=0,len=0;
		len=sprites.length;
		for (i=startIndex;i < len;i++){
			CanvasTools.renderSpriteToCanvas(sprites[i],canvas,offx,offy);
		}
	}

	CanvasTools.clearCanvas=function(canvas){
		var preWidth=NaN;
		var preHeight=NaN;
		preWidth=canvas.width;
		preHeight=canvas.height;
		canvas.size(preWidth+1,preHeight);
		canvas.size(preWidth,preHeight);
	}

	CanvasTools.getImagePixels=function(x,y,width,data,colorLen){
		(colorLen===void 0)&& (colorLen=4);
		var pos=0;
		pos=(x *width+y)*colorLen;
		var i=0,len=0;
		var rst;
		rst=[];
		len=colorLen;
		for (i=0;i < len;i++){
			rst.push(data[pos+i]);
		}
		return rst;
	}

	return CanvasTools;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-10-23 下午2:24:04
*/
//class laya.debug.tools.ClassTool
var ClassTool=(function(){
	function ClassTool(){}
	__class(ClassTool,'laya.debug.tools.ClassTool');
	ClassTool.defineProperty=function(obj,name,des){
		Object.defineProperty(obj,name,des);;
	}

	ClassTool.getOwnPropertyDescriptor=function(obj,name){
		var rst;
		rst=Object.getOwnPropertyDescriptor(obj,name);;
		return rst;
	}

	ClassTool.getOwnPropertyDescriptors=function(obj){
		var rst;
		rst=Object.getOwnPropertyDescriptors(obj);;
		return rst;
	}

	ClassTool.getOwnPropertyNames=function(obj){
		var rst;
		rst=Object.getOwnPropertyNames(obj);;
		return rst;
	}

	ClassTool.getObjectGetSetKeys=function(obj,rst){
		if (!rst)rst=[];
		var keys;
		keys=laya.debug.tools.ClassTool.getOwnPropertyNames(obj);
		var key;
		for (key in keys){
			key=keys[key];
			if (key.indexOf("_$get_")>=0){
				key=key.replace("_$get_","");
				rst.push(key);
			}
		}
		if (obj["__proto__"]){
			ClassTool.getObjectGetSetKeys(obj["__proto__"],rst);
		}
		return rst;
	}

	ClassTool.getObjectDisplayAbleKeys=function(obj,rst){
		if (!rst)rst=[];
		var key;
		var tValue;
		var tType;
		for (key in obj){
			tValue=obj[key];
			tType=typeof(tValue);
			if (key.charAt(0)=="_")continue ;
			rst.push(key);
		}
		ClassTool.getObjectGetSetKeys(obj,rst);
		rst=ObjectTools.getNoSameArr(rst);
		return rst;
	}

	ClassTool.getClassName=function(tar){
		if ((typeof tar=='function'))return tar.name;
		return tar["constructor"].name;
	}

	ClassTool.getNodeClassAndName=function(tar){
		if (!tar)return "null";
		var rst;
		if (tar.name){
			rst=ClassTool.getClassName(tar)+"("+tar.name+")";
			}else{
			rst=ClassTool.getClassName(tar);
		}
		return rst;
	}

	ClassTool.getClassNameByClz=function(clz){
		return clz["name"];
	}

	ClassTool.getClassByName=function(className){
		var rst;
		rst=Laya._runScript(className);
		return rst;
	}

	ClassTool.createObjByName=function(className){
		var clz;
		clz=ClassTool.getClassByName(className);
		return new clz();
	}

	__static(ClassTool,
	['displayTypes',function(){return this.displayTypes={"boolean":true,"number":true,"string":true };}
	]);
	return ClassTool;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.ClickSelectTool
var ClickSelectTool=(function(){
	function ClickSelectTool(){
		this.completeHandler=null;
		this.tSelectTar=null;
		this._selectTip=new Sprite();
		this._selectTip.setBounds(new Rectangle(0,0,0,0));
		Notice.listen("ItemClicked",this,this.itemClicked);
	}

	__class(ClickSelectTool,'laya.debug.tools.ClickSelectTool');
	var __proto=ClickSelectTool.prototype;
	__proto.beginClickSelect=function(complete){
		this.completeHandler=complete;
		ClickSelectTool.isClickSelectState=true;
		this.clickSelectChange();
	}

	__proto.clickSelectChange=function(){
		if (!Browser.onPC)return;
		this.tSelectTar=null;
		this.clearSelectTip();
		if (ClickSelectTool.isClickSelectState){
			Laya.timer.loop(200,this,this.updateSelectTar,null,true);
			}else{
			Laya.timer.clear(this,this.updateSelectTar);
		}
	}

	__proto.clearSelectTip=function(){
		this._selectTip.removeSelf();
	}

	__proto.updateSelectTar=function(){
		this.clearSelectTip();
		this.tSelectTar=DisplayHook.instance.getDisUnderMouse();
		if (!this.tSelectTar){
			return;
		}
		if (DebugInfoLayer.I.isDebugItem(this.tSelectTar))return;
		var g;
		g=this._selectTip.graphics;
		g.clear();
		var rec;
		rec=NodeUtils.getGRec(this.tSelectTar);
		DebugInfoLayer.I.popLayer.addChild(this._selectTip);
		g.drawRect(0,0,rec.width,rec.height,null,DebugConsts.CLICK_SELECT_COLOR,2);
		this._selectTip.pos(rec.x,rec.y);
	}

	__proto.itemClicked=function(tar){
		if (!ClickSelectTool.isClickSelectState)return;
		if (ClickSelectTool.ignoreDebugTool){
			if (DebugInfoLayer.I.isDebugItem(tar))return;
		}
		if ((tar instanceof laya.debug.uicomps.ContextMenuItem )|| (tar.parent instanceof laya.debug.uicomps.ContextMenuItem )){
			return;
		}
		DebugTool.showDisBound(tar);
		if (this.completeHandler){
			this.completeHandler.runWith(tar);
		}
		ClickSelectTool.isClickSelectState=false;
		this.clickSelectChange();
	}

	__getset(1,ClickSelectTool,'I',function(){
		if (!ClickSelectTool._I)ClickSelectTool._I=new ClickSelectTool();
		return ClickSelectTool._I;
	});

	ClickSelectTool._I=null;
	ClickSelectTool.isClickSelectState=false;
	ClickSelectTool.ignoreDebugTool=false;
	return ClickSelectTool;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.ColorTool
var ColorTool=(function(){
	function ColorTool(){
		this.red=NaN;
		this.green=NaN;
		this.blue=NaN;
	}

	__class(ColorTool,'laya.debug.tools.ColorTool');
	ColorTool.toHexColor=function(color){
		return Utils.toHexColor(color);
	}

	ColorTool.getRGBByRGBStr=function(str){
		str.charAt(0)=='#' && (str=str.substr(1));
		var color=parseInt(str,16);
		var flag=(str.length==8);
		var _color;
		_color=[((0x00FF0000 & color)>> 16),((0x0000FF00 & color)>> 8),(0x000000FF & color)];
		return _color;
	}

	ColorTool.getColorBit=function(value){
		var rst;
		rst=Math.floor(value).toString(16);
		rst=rst.length > 1 ? rst :"0"+rst;
		return rst;
	}

	ColorTool.getRGBStr=function(rgb){
		return "#"+ColorTool.getColorBit(rgb[0])+ColorTool.getColorBit(rgb[1])+ColorTool.getColorBit(rgb[2]);
	}

	ColorTool.traseHSB=function(hsb){
		console.log("hsb:",hsb[0],hsb[1],hsb[2]);
	}

	ColorTool.rgb2hsb=function(rgbR,rgbG,rgbB){
		var rgb=[rgbR,rgbG,rgbB];
		rgb.sort(MathTools.sortNumSmallFirst);
		var max=rgb[2];
		var min=rgb[0];
		var hsbB=max / 255.0;
		var hsbS=max==0 ? 0 :(max-min)/ max;
		var hsbH=0;
		if(max==min){
			hsbH=1;
		}
		else
		if (rgbR==0 && rgbG==0&&rgbB==0){
		}else
		if (max==rgbR && rgbG >=rgbB){
			hsbH=(rgbG-rgbB)*60 / (max-min)+0;
		}
		else if (max==rgbR && rgbG < rgbB){
			hsbH=(rgbG-rgbB)*60 / (max-min)+360;
		}
		else if (max==rgbG){
			hsbH=(rgbB-rgbR)*60 / (max-min)+120;
		}
		else if (max==rgbB){
			hsbH=(rgbR-rgbG)*60 / (max-min)+240;
		}
		return [hsbH,hsbS,hsbB];
	}

	ColorTool.hsb2rgb=function(h,s,v){
		var r=0,g=0,b=0;
		var i=Math.floor((h / 60)% 6);
		var f=(h / 60)-i;
		var p=v *(1-s);
		var q=v *(1-f *s);
		var t=v *(1-(1-f)*s);
		switch (i){
			case 0:
				r=v;
				g=t;
				b=p;
				break ;
			case 1:
				r=q;
				g=v;
				b=p;
				break ;
			case 2:
				r=p;
				g=v;
				b=t;
				break ;
			case 3:
				r=p;
				g=q;
				b=v;
				break ;
			case 4:
				r=t;
				g=p;
				b=v;
				break ;
			case 5:
				r=v;
				g=p;
				b=q;
				break ;
			default :
				break ;
			}
		return [Math.floor(r *255.0),Math.floor(g *255.0),Math.floor(b *255.0)];
	}

	return ColorTool;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-9-24 下午6:37:56
*/
//class laya.debug.tools.CountTool
var CountTool=(function(){
	function CountTool(){
		this.data={};
		this.preO={};
		this.changeO={};
		this.count=0;
	}

	__class(CountTool,'laya.debug.tools.CountTool');
	var __proto=CountTool.prototype;
	__proto.reset=function(){
		this.data={};
		this.count=0;
	}

	__proto.add=function(name,num){
		(num===void 0)&& (num=1);
		this.count++;
		if(!this.data.hasOwnProperty(name)){
			this.data[name]=0;
		}
		this.data[name]=this.data[name]+num;
	}

	__proto.getKeyCount=function(key){
		if(!this.data.hasOwnProperty(key)){
			this.data[key]=0;
		}
		return this.data[key];
	}

	__proto.getKeyChange=function(key){
		if (!this.changeO[key])return 0;
		return this.changeO[key];
	}

	__proto.record=function(){
		var key;
		for (key in this.changeO){
			this.changeO[key]=0;
		}
		for (key in this.data){
			if (!this.preO[key])this.preO[key]=0;
			this.changeO[key]=this.data[key]-this.preO[key];
			this.preO[key]=this.data[key]
		}
	}

	__proto.getCount=function(dataO){
		var rst=0;
		var key;
		for (key in dataO){
			rst+=dataO[key];
		}
		return rst;
	}

	__proto.traceSelf=function(dataO){
		if (!dataO)dataO=this.data;
		var tCount=0;
		tCount=this.getCount(dataO);
		console.log("total:"+tCount);
		return "total:"+tCount+"\n"+TraceTool.traceObj(dataO);
	}

	__proto.traceSelfR=function(dataO){
		if (!dataO)dataO=this.data;
		var tCount=0;
		tCount=this.getCount(dataO);
		console.log("total:"+tCount);
		return "total:"+tCount+"\n"+TraceTool.traceObjR(dataO);
	}

	return CountTool;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.DebugConsts
var DebugConsts=(function(){
	function DebugConsts(){}
	__class(DebugConsts,'laya.debug.tools.DebugConsts');
	DebugConsts.CLICK_SELECT_COLOR="#ff0000";
	DebugConsts.CANVAS_REC_COLOR="#FF00FF";
	DebugConsts.RECACHE_REC_COLOR="#00ff00";
	DebugConsts.SPRITE_REC_COLOR="#ff0000";
	DebugConsts.SPRITE_REC_LINEWIDTH=2;
	return DebugConsts;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-10-31 下午3:35:16
*/
//class laya.debug.tools.DebugExport
var DebugExport=(function(){
	function DebugExport(){}
	__class(DebugExport,'laya.debug.tools.DebugExport');
	DebugExport.export=function(){
		var _window;
		_window=window;;
		var key;
		for(key in DebugExport._exportsDic){
			_window[key]=DebugExport._exportsDic[key];
		}
	}

	__static(DebugExport,
	['_exportsDic',function(){return this._exportsDic={
			"DebugTool":DebugTool,
			"Watcher":Watcher
	};}

	]);
	return DebugExport;
})()


/**
*本类用于显示对象值变化过程
*@author ww
*@version 1.0
*
*@created 2015-10-23 上午10:41:50
*/
//class laya.debug.tools.DifferTool
var DifferTool=(function(){
	function DifferTool(sign,autoTrace){
		this.autoTrace=true;
		this.sign="";
		this.obj=null;
		(sign===void 0)&& (sign="");
		(autoTrace===void 0)&& (autoTrace=true);
		this.sign=sign;
		this.autoTrace=autoTrace;
	}

	__class(DifferTool,'laya.debug.tools.DifferTool');
	var __proto=DifferTool.prototype;
	__proto.update=function(data,msg){
		if(msg){
			console.log(msg);
		};
		var tObj=ObjectTools.copyObj(data);
		if(!this.obj)this.obj={};
		var rst;
		rst=ObjectTools.differ(this.obj,tObj);
		this.obj=tObj;
		if(this.autoTrace){
			console.log(this.sign+" differ:");
			ObjectTools.traceDifferObj(rst);
		}
		return rst;
	}

	DifferTool.differ=function(sign,data,msg){
		if(!DifferTool._differO[sign])DifferTool._differO[sign]=new DifferTool(sign,true);
		var tDiffer;
		tDiffer=DifferTool._differO[sign];
		return tDiffer.update(data,msg);
	}

	DifferTool._differO={};
	return DifferTool;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2016-1-14 下午4:32:47
*/
//class laya.debug.tools.DisController
var DisController=(function(){
	function DisController(){
		this.arrowAxis=null;
		this._target=null;
		this.recInfo=null;
		DisController.init();
		this.arrowAxis=new Axis();
		this.arrowAxis.mouseEnabled=true;
	}

	__class(DisController,'laya.debug.tools.DisController');
	var __proto=DisController.prototype;
	__proto.switchType=function(){
		this.arrowAxis.switchType();
	}

	__proto.updateMe=function(){
		if(!this._target)return;
		this.recInfo=RecInfo.getGlobalRecInfo(this._target,0,0,1,0,0,1);
		console.log("rotation:",this.recInfo.rotation);
		console.log("pos:",this.recInfo.x,this.recInfo.y);
		console.log("scale:",this.recInfo.width,this.recInfo.height);
		this.arrowAxis.x=this.recInfo.x;
		this.arrowAxis.y=this.recInfo.y;
		this.arrowAxis.rotation=this.recInfo.rotation;
		this.arrowAxis.yAxis.rotation=this.recInfo.rotationV-this.recInfo.rotation;
	}

	__getset(0,__proto,'target',function(){
		return this._target;
		},function(target){
		this._target=target;
		if(target){
			DisController._container.addChild(this.arrowAxis);
			Laya.timer.loop(100,this,this.updateMe);
			}else{
			this.arrowAxis.removeSelf();
			Laya.timer.clear(this,this.updateMe);
		}
		this.arrowAxis.target=target;
		this.updateMe();
	});

	__getset(0,__proto,'type',function(){
		return this.arrowAxis.type;
		},function(lenType){
		this.arrowAxis.type=lenType;
	});

	DisController.init=function(){
		if (DisController._container){
			DisControlTool.setTop(DisController._container);
			return;
		};
		DisController._container=new Sprite();
		DisController._container.mouseEnabled=true;
		Laya.stage.addChild(DisController._container);
	}

	DisController._container=null;
	__static(DisController,
	['I',function(){return this.I=new DisController();}
	]);
	return DisController;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-9-25 下午7:19:44
*/
//class laya.debug.tools.DisControlTool
var DisControlTool=(function(){
	function DisControlTool(){}
	__class(DisControlTool,'laya.debug.tools.DisControlTool');
	DisControlTool.getObjectsUnderPoint=function(sprite,x,y,rst,filterFun){
		rst=rst?rst:[];
		if(filterFun!=null&&!filterFun(sprite))return rst;
		if (sprite.getBounds().contains(x,y)){
			rst.push(sprite);
			var tS;
			var tempP=new Point();
			tempP.setTo(x,y);
			tempP=sprite.fromParentPoint(tempP);
			x=tempP.x;
			y=tempP.y;
			for (var i=sprite._childs.length-1;i >-1;i--){
				var child=sprite._childs[i];
				if((child instanceof laya.display.Sprite ))
					DisControlTool.getObjectsUnderPoint(child,x,y,rst,filterFun);
			}
		}
		return rst;
	}

	DisControlTool.getObjectsUnderGlobalPoint=function(sprite,filterFun){
		var point=new Point();
		point.setTo(Laya.stage.mouseX,Laya.stage.mouseY);
		if(sprite.parent)
			point=(sprite.parent).globalToLocal(point);
		return DisControlTool.getObjectsUnderPoint(sprite,point.x,point.y,null,filterFun);
	}

	DisControlTool.findFirstObjectsUnderGlobalPoint=function(){
		var disList;
		disList=DisControlTool.getObjectsUnderGlobalPoint(Laya.stage);
		if (!disList)return null;
		var i=0,len=0;
		var tDis;
		len=disList.length;
		for (i=len-1;i>=0;i--){
			tDis=disList[i];
			if (tDis && tDis.numChildren < 1){
				return tDis;
			}
		}
		return tDis;
	}

	DisControlTool.visibleAndEnableObjFun=function(tar){
		return tar.visible&&tar.mouseEnabled;
	}

	DisControlTool.visibleObjFun=function(tar){
		return tar.visible;
	}

	DisControlTool.getMousePoint=function(sprite){
		var point=new Point();
		point.setTo(Laya.stage.mouseX,Laya.stage.mouseY);
		point=sprite.globalToLocal(point);
		return point;
	}

	DisControlTool.isChildE=function(parent,child){
		if (!parent)return false;
		while (child){
			if (child.parent==parent)return true;
			child=child.parent;
		}
		return false;
	}

	DisControlTool.isInTree=function(pNode,child){
		return pNode==child || DisControlTool.isChildE(pNode,child);
	}

	DisControlTool.setTop=function(tar){
		if(tar&&tar.parent){
			var tParent;
			tParent=tar.parent;
			tParent.setChildIndex(tar,tParent.numChildren-1);
		}
	}

	DisControlTool.clearItemRelativeInfo=function(item){
		var Nan="NaN";
		item.getLayout().left=Nan;
		item.getLayout().right=Nan;
		item.getLayout().top=Nan;
		item.getLayout().bottom=Nan;
	}

	DisControlTool.swap=function(tarA,tarB){
		if (tarA==tarB)return;
		var iA=0;
		iA=tarA.parent.getChildIndex(tarA);
		var iB=0;
		iB=tarB.parent.getChildIndex(tarB);
		var bP;
		bP=tarB.parent;
		tarA.parent.addChildAt(tarB,iA);
		bP.addChildAt(tarA,iB);
	}

	DisControlTool.insertToTarParent=function(tarA,tars,after){
		(after===void 0)&& (after=false);
		var tIndex=0;
		var parent;
		if(!tarA)return;
		parent=tarA.parent;
		if(!parent)return;
		tIndex=parent.getChildIndex(tarA);
		if(after)tIndex++;
		DisControlTool.insertToParent(parent,tars,tIndex);
	}

	DisControlTool.insertToParent=function(parent,tars,index){
		(index===void 0)&& (index=-1);
		if(!parent)return;
		if(index<0)index=parent.numChildren;
		var i=0,len=0;
		len=tars.length;
		for(i=0;i<len;i++){
			DisControlTool.transParent(tars[i],parent);
			parent.addChildAt(tars[i],index);
		}
	}

	DisControlTool.transParent=function(tar,newParent){
		if(!tar||!newParent)return;
		if(!tar.parent)return;
		var preParent;
		preParent=tar.parent;
		var pos;
		pos=new Point(tar.x,tar.y);
		pos=preParent.localToGlobal(pos);
		pos=newParent.globalToLocal(pos);
		tar.pos(pos.x,pos.y);
	}

	DisControlTool.transPoint=function(nowParent,tarParent,point){
		point=nowParent.localToGlobal(point);
		point=tarParent.globalToLocal(point);
		return point;
	}

	DisControlTool.removeItems=function(itemList){
		var i=0,len=0;
		len=itemList.length;
		for (i=0;i < len;i++){
			(itemList [i]).removeSelf();
		}
	}

	DisControlTool.addItems=function(itemList,parent){
		var i=0,len=0;
		len=itemList.length;
		for (i=0;i < len;i++){
			parent.addChild(itemList[i]);
		}
	}

	DisControlTool.getAllChild=function(tar){
		if(!tar)return [];
		var i=0;
		var len=0;
		var rst=[];
		len=tar.numChildren;
		for(i=0;i<len;i++){
			rst.push(tar.getChildAt(i));
		}
		return rst;
	}

	DisControlTool.upDis=function(child){
		if(child&&child.parent){
			var tParent;
			tParent=child.parent;
			var newIndex=0;
			newIndex=tParent.getChildIndex(child)+1;
			if(newIndex>=tParent.numChildren){
				newIndex=tParent.numChildren-1;
			}
			console.log("setChildIndex:"+newIndex);
			tParent.setChildIndex(child,newIndex);
		}
	}

	DisControlTool.downDis=function(child){
		if(child&&child.parent){
			var tParent;
			tParent=child.parent;
			var newIndex=0;
			newIndex=tParent.getChildIndex(child)-1;
			if(newIndex<0)newIndex=0;
			console.log("setChildIndex:"+newIndex);
			tParent.setChildIndex(child,newIndex);
		}
	}

	DisControlTool.setResizeAbleEx=function(node){
		var clickItem;
		clickItem=node.getChildByName("resizeBtn");
		if (clickItem){
			SimpleResizer.setResizeAble(clickItem,node);
		}
	}

	DisControlTool.setResizeAble=function(node){
		node.on("click",null,DisControlTool.resizeHandler,[node]);
	}

	DisControlTool.resizeHandler=function(tar){
		DisResizer.setUp(tar);
	}

	DisControlTool.setDragingItem=function(dragBar,tar){
		dragBar.on("mousedown",null,DisControlTool.dragingHandler,[tar]);
		tar.on("dragend",null,DisControlTool.dragingEnd,[tar]);
	}

	DisControlTool.dragingHandler=function(tar){
		if (tar){
			tar.startDrag();
		}
	}

	DisControlTool.dragingEnd=function(tar){
		DisControlTool.intFyDisPos(tar);
		console.log(tar.x,tar.y);
	}

	DisControlTool.showToStage=function(dis,offX,offY){
		(offX===void 0)&& (offX=0);
		(offY===void 0)&& (offY=0);
		var rec=dis.getBounds();
		dis.x=Laya.stage.mouseX+offX;
		dis.y=Laya.stage.mouseY+offY;
		if (dis.x+rec.width > Laya.stage.width){
			dis.x-=rec.width+offX;
		}
		if (dis.y+rec.height > Laya.stage.height){
			dis.y-=rec.height+offY;
		}
		DisControlTool.intFyDisPos(dis);
	}

	DisControlTool.intFyDisPos=function(dis){
		if (!dis)return;
		dis.x=Math.round(dis.x);
		dis.y=Math.round(dis.y);
	}

	DisControlTool.showOnly=function(disList,showItem){
		var i=0,len=0;
		len=disList.length;
		for (i=0;i < len;i++){
			disList[i].visible=disList[i]==showItem;
		}
	}

	DisControlTool.showOnlyByIndex=function(disList,index){
		DisControlTool.showOnly(disList,disList[index]);
	}

	DisControlTool.addOnly=function(disList,showItem,parent){
		var i=0,len=0;
		len=disList.length;
		for (i=0;i < len;i++){
			if (disList[i] !=showItem){
				disList[i].removeSelf();
				}else{
				parent.addChild(disList[i]);
			}
		}
	}

	DisControlTool.addOnlyByIndex=function(disList,index,parent){
		DisControlTool.addOnly(disList,disList[index],parent);
	}

	__static(DisControlTool,
	['tempP',function(){return this.tempP=new Point();}
	]);
	return DisControlTool;
})()


/**
*调试拾取显示对象类
*@author ww
*/
//class laya.debug.tools.DisplayHook
var DisplayHook=(function(){
	function DisplayHook(){
		this.mouseX=NaN;
		this.mouseY=NaN;
		this._stage=null;
		this._target=null;
		this.isGetting=false;
		this._matrix=new Matrix();
		this._point=new Point();
		this._rect=new Rectangle();
		this._event=Event.EMPTY;
		this._stage=Laya.stage;
		this.init(Render.context.canvas);
	}

	__class(DisplayHook,'laya.debug.tools.DisplayHook');
	var __proto=DisplayHook.prototype;
	__proto.init=function(canvas){
		var _$this=this;
		if (Browser.window.navigator.msPointerEnabled){
			canvas.style['-ms-content-zooming']='none';
			canvas.style['-ms-touch-action']='none';
		};
		var _this=this;
		Browser.document.addEventListener('mousedown',function(e){
			_$this._event._stoped=false;
			DisplayHook.isFirst=true;
			_this.check(_this._stage,e.offsetX,e.offsetY,_this.onMouseDown,true,false);
		},true);
		Browser.document.addEventListener('touchstart',function(e){
			_$this._event._stoped=false;
			DisplayHook.isFirst=true;
			var touches=e.changedTouches;
			for (var i=0,n=touches.length;i < n;i++){
				var touch=touches[i];
				initEvent(touch,e);
				_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseDown,true,false);
			}
		},true);
		function initEvent (e,event){
			_this._event._stoped=false;
			_this._event.nativeEvent=event || e;
			_this._target=null;
			if (e.offsetX){
				_this.mouseX=e.offsetX;
				_this.mouseY=e.offsetY;
				}else {
				_this.mouseX=e.clientX-Laya.stage.offset.x;
				_this.mouseY=e.clientY-Laya.stage.offset.y;
			}
		}
	}

	__proto.onMouseMove=function(ele,hit){
		this.sendEvent(ele,"mousemove");
		return;
		if (hit && ele !=this._stage && ele!==this._target){
			if (this._target){
				if (this._target.$_MOUSEOVER){
					this._target.$_MOUSEOVER=false;
					this._target.event("mouseout");
				}
			}
			this._target=ele;
			if (!ele.$_MOUSEOVER){
				ele.$_MOUSEOVER=true;
				this.sendEvent(ele,"mouseover");
			}
			}else if (!hit && this._target && ele===this._target){
			this._target=null;
			if (ele.$_MOUSEOVER){
				ele.$_MOUSEOVER=false;
				this.sendEvent(ele,"mouseout");
			}
		}
	}

	__proto.onMouseUp=function(ele,hit){
		hit && this.sendEvent(ele,"mouseup");
	}

	__proto.onMouseDown=function(ele,hit){
		if (hit){
			ele.$_MOUSEDOWN=true;
			this.sendEvent(ele,"mousedown");
		}
	}

	__proto.sendEvent=function(ele,type){
		if (!this._event._stoped){
			ele.event(type,this._event.setTo(type,ele,ele));
			if (type==="mouseup" && ele.$_MOUSEDOWN){
				ele.$_MOUSEDOWN=false;
				ele.event("click",this._event.setTo("click",ele,ele));
			}
		}
	}

	__proto.selectDisUnderMouse=function(){
		DisplayHook.isFirst=true;
		this.check(Laya.stage,Laya.stage.mouseX,Laya.stage.mouseY,null,true,false);
		SelectInfosView.I.setSelectTarget(DebugTool.target);
	}

	__proto.getDisUnderMouse=function(){
		this.isGetting=true;
		DisplayHook.isFirst=true;
		DebugTool.target=null;
		this.check(Laya.stage,Laya.stage.mouseX,Laya.stage.mouseY,null,true,false);
		this.isGetting=false;
		return DebugTool.target;
	}

	__proto.check=function(sp,mouseX,mouseY,callBack,hitTest,mouseEnable){
		if (sp==DebugTool.debugLayer)return false;
		if (sp==DebugInfoLayer.I)return false;
		if (this.isGetting && sp==DebugInfoLayer.I)return false;
		if (!sp.visible || sp.getSelfBounds().width<=0)return false;
		var isHit=false;
		mouseEnable=true
		if (mouseEnable){
			var graphicHit=false;
			if (hitTest){
				this._rect=sp.getBounds();
				isHit=this._rect.contains(mouseX,mouseY);
				this._point.setTo(mouseX,mouseY);
				sp.fromParentPoint(this._point);
				mouseX=this._point.x;
				mouseY=this._point.y;
			}
			if (isHit){
				var flag=false;
				for (var i=sp._childs.length-1;i >-1;i--){
					var child=sp._childs[i];
					(flag=this.check(child,mouseX,mouseY,callBack,hitTest,true));
					if (flag)break ;
				}
				graphicHit=sp.getGraphicBounds().contains(mouseX,mouseY);
				isHit=flag||graphicHit;
				if(isHit&&!flag&&DisplayHook.isFirst){
					DisplayHook.isFirst=false;
					if(! ((sp instanceof laya.debug.tools.debugUI.DButton ))){
						DebugTool.target=sp;
						if (!this.isGetting){
							DebugTool.autoWork();
							Notice.notify("ItemClicked",sp);
						}
					}
				}
			}
		}
		return isHit;
	}

	DisplayHook.initMe=function(){
		if(!DisplayHook.instance){
			DisplayHook.instance=new DisplayHook();
		}
	}

	DisplayHook.ITEM_CLICKED="ItemClicked";
	DisplayHook.instance=null;
	DisplayHook.isFirst=false;
	return DisplayHook;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-9-28 上午10:39:47
*/
//class laya.debug.tools.DTrace
var DTrace=(function(){
	function DTrace(){}
	__class(DTrace,'laya.debug.tools.DTrace');
	DTrace.getArgArr=function(arg){
		var rst;
		rst=[];
		var i=0,len=arg.length;
		for(i=0;i<len;i++){
			rst.push(arg[i]);
		}
		return rst;
	}

	DTrace.dTrace=function(__arg){
		var arg=arguments;
		arg=DTrace.getArgArr(arg);
		arg.push(TraceTool.getCallLoc(2));
		console.log.apply(console,arg);
		var str;
		str=arg.join(" ");
	}

	DTrace.timeStart=function(sign){
		console.time(sign);;
	}

	DTrace.timeEnd=function(sign){
		console.timeEnd(sign);;
	}

	DTrace.traceTable=function(data){
		console.table(data);;
	}

	return DTrace;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.enginehook.ClassCreateHook
var ClassCreateHook=(function(){
	function ClassCreateHook(){
		this.createInfo={};
	}

	__class(ClassCreateHook,'laya.debug.tools.enginehook.ClassCreateHook');
	var __proto=ClassCreateHook.prototype;
	__proto.hookClass=function(clz){
		var _$this=this;
		if (ClassCreateHook.isInited)return;
		ClassCreateHook.isInited=true;
		var createFun=function (sp){
			_$this.classCreated(sp,clz);
		}
		FunHook.hook(clz,"call",createFun);
	}

	__proto.classCreated=function(clz,oClass){
		var key;
		key=ClassTool.getNodeClassAndName(clz);
		var depth=0;
		var tClz;
		tClz=clz;
		while (tClz && tClz !=oClass){
			tClz=tClz.__super;
			depth++;
		}
		if (!ClassCreateHook.I.createInfo[key]){
			ClassCreateHook.I.createInfo[key]=0;
		}
		ClassCreateHook.I.createInfo[key]=ClassCreateHook.I.createInfo[key]+1;
		RunProfile.run(key,depth+6);
	}

	__proto.getClassCreateInfo=function(clz){
		var key;
		key=ClassTool.getClassName(clz);
		return RunProfile.getRunInfo(key);
	}

	ClassCreateHook.isInited=false;
	__static(ClassCreateHook,
	['I',function(){return this.I=new ClassCreateHook();}
	]);
	return ClassCreateHook;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.enginehook.RenderSpriteHook
var RenderSpriteHook=(function(){
	function RenderSpriteHook(){
		/**@private */
		//this._next=null;
		/**@private */
		//this._fun=null;
		//this._oldCanvas=null;
	}

	__class(RenderSpriteHook,'laya.debug.tools.enginehook.RenderSpriteHook');
	var __proto=RenderSpriteHook.prototype;
	__proto.createRenderSprite=function(type,next){
		var rst;
		rst=RenderSpriteHook._preCreateFun(type,next);
		if (type==0x10){
			rst["_oldCanvas"]=rst._fun;
			rst._fun=RenderSpriteHook.I._canvas;
		}
		return rst;
	}

	__proto._canvas=function(sprite,context,x,y){
		if (!SpriteRenderForVisibleAnalyse.allowRendering)return;
		var _cacheCanvas=sprite._$P.cacheCanvas;
		var _next=this._next;
		if (!_cacheCanvas||SpriteRenderForVisibleAnalyse.isVisibleTesting){
			_next._fun.call(_next,sprite,context,x,y);
			return;
		};
		var preTime;
		preTime=Browser.now();
		var tx=_cacheCanvas.ctx;
		var _repaint=sprite._needRepaint()|| (!tx);
		this._oldCanvas(sprite,context,x,y);
		if (Config.showCanvasMark){
		}
		if (_repaint){
			CacheAnalyser.I.reCacheCanvas(sprite,Browser.now()-preTime);
			}else{
			CacheAnalyser.I.renderCanvas(sprite,Browser.now()-preTime);
		}
	}

	RenderSpriteHook.init=function(){
		if (RenderSpriteHook.I)return;
		RenderSpriteHook.I=new RenderSpriteHook();
		RenderSpriteHook._preCreateFun=RunDriver.createRenderSprite;
		RunDriver.createRenderSprite=RenderSpriteHook.I.createRenderSprite;
	}

	RenderSpriteHook.IMAGE=0x01;
	RenderSpriteHook.FILTERS=0x02;
	RenderSpriteHook.ALPHA=0x04;
	RenderSpriteHook.TRANSFORM=0x08;
	RenderSpriteHook.CANVAS=0x10;
	RenderSpriteHook.BLEND=0x20;
	RenderSpriteHook.CLIP=0x40;
	RenderSpriteHook.STYLE=0x80;
	RenderSpriteHook.GRAPHICS=0x100;
	RenderSpriteHook.CUSTOM=0x200;
	RenderSpriteHook.ENABLERENDERMERGE=0x400;
	RenderSpriteHook.CHILDS=0x800;
	RenderSpriteHook.INIT=0x11111;
	RenderSpriteHook.renders=[];
	RenderSpriteHook.I=null;
	RenderSpriteHook._preCreateFun=null;
	return RenderSpriteHook;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse
var SpriteRenderForVisibleAnalyse=(function(){
	function SpriteRenderForVisibleAnalyse(){
		/**@private */
		this._repaint=1;
		this._renderType=1;
		this._x=0;
		this._y=0;
		this.target=null;
		this.isTargetRenderd=false;
		this.preFun=null;
		this._next=null;
		this.pgraphic=RenderSprite["prototype"]["_graphics"];
		this.pimage=RenderSprite["prototype"]["_image"];
		this.pimage2=RenderSprite["prototype"]["_image2"];
	}

	__class(SpriteRenderForVisibleAnalyse,'laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse');
	var __proto=SpriteRenderForVisibleAnalyse.prototype;
	__proto.setRenderHook=function(){
		Sprite["prototype"]["render"]=SpriteRenderForVisibleAnalyse.I.render;
	}

	/**
	*更新、呈现显示对象。
	*@param context 渲染的上下文引用。
	*@param x X轴坐标。
	*@param y Y轴坐标。
	*/
	__proto.render=function(context,x,y){
		var me;
		me=this;
		if (DebugInfoLayer.I.isDebugItem(me))return;
		if (me==laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse.I.target){
			laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse.allowRendering=true;
			laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse.I.isTargetRenderd=true;
			CanvasTools.clearCanvas(SpriteRenderForVisibleAnalyse.mainCanvas);
		}
		RenderSprite.renders[this._renderType]._fun(this,context,x+this._x,y+this._y);
		if (me==laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse.I.target){
			SpriteRenderForVisibleAnalyse.tarRec=CanvasTools.getCanvasDisRec(laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse.mainCanvas);
			console.log("rec",SpriteRenderForVisibleAnalyse.tarRec.toString());
			if (SpriteRenderForVisibleAnalyse.tarRec.width >0&& SpriteRenderForVisibleAnalyse.tarRec.height > 0){
				SpriteRenderForVisibleAnalyse.isTarRecOK=true;
				SpriteRenderForVisibleAnalyse.preImageData=CanvasTools.getImageDataFromCanvasByRec(SpriteRenderForVisibleAnalyse.mainCanvas,SpriteRenderForVisibleAnalyse.tarRec);
				SpriteRenderForVisibleAnalyse.tarImageData=CanvasTools.getImageDataFromCanvasByRec(SpriteRenderForVisibleAnalyse.mainCanvas,SpriteRenderForVisibleAnalyse.tarRec);
				}else{
				console.log("tarRec Not OK:",SpriteRenderForVisibleAnalyse.tarRec);
			}
			}else{
			if (SpriteRenderForVisibleAnalyse.isTarRecOK){
				SpriteRenderForVisibleAnalyse.tImageData=CanvasTools.getImageDataFromCanvasByRec(SpriteRenderForVisibleAnalyse.mainCanvas,SpriteRenderForVisibleAnalyse.tarRec);
				var dRate=NaN;
				dRate=CanvasTools.getDifferRate(SpriteRenderForVisibleAnalyse.preImageData,SpriteRenderForVisibleAnalyse.tImageData);
				SpriteRenderForVisibleAnalyse.preImageData=SpriteRenderForVisibleAnalyse.tImageData;
				if (dRate > 0){
					VisibleAnalyser.addCoverNode(me,dRate);
				}
			}
		}
	}

	__proto.analyseNode=function(node){
		VisibleAnalyser.resetCoverList();
		if (Sprite["prototype"]["render"] !=SpriteRenderForVisibleAnalyse.I.render){
			this.preFun=Sprite["prototype"]["render"];
		}
		this.target=node;
		Sprite["prototype"]["render"]=this.render;
		if (!SpriteRenderForVisibleAnalyse.tarCanvas)
			SpriteRenderForVisibleAnalyse.tarCanvas=CanvasTools.createCanvas(Laya.stage.width,Laya.stage.height);
		if (!SpriteRenderForVisibleAnalyse.mainCanvas)
			SpriteRenderForVisibleAnalyse.mainCanvas=CanvasTools.createCanvas(Laya.stage.width,Laya.stage.height);
		this.isTargetRenderd=false;
		SpriteRenderForVisibleAnalyse.isVisibleTesting=true;
		SpriteRenderForVisibleAnalyse.allowRendering=false;
		CanvasTools.clearCanvas(SpriteRenderForVisibleAnalyse.mainCanvas);
		CanvasTools.clearCanvas(SpriteRenderForVisibleAnalyse.tarCanvas);
		SpriteRenderForVisibleAnalyse.isTarRecOK=false;
		var ctx=new RenderContext(SpriteRenderForVisibleAnalyse.mainCanvas.width,SpriteRenderForVisibleAnalyse.mainCanvas.height,SpriteRenderForVisibleAnalyse.mainCanvas);
		SpriteRenderForVisibleAnalyse.mainCanvas=ctx.canvas;
		this.render.call(Laya.stage,ctx,0,0);
		if (!SpriteRenderForVisibleAnalyse.isTarRecOK){
			SpriteRenderForVisibleAnalyse.coverRate=0;
			}else{
			SpriteRenderForVisibleAnalyse.coverRate=CanvasTools.getDifferRate(SpriteRenderForVisibleAnalyse.preImageData,SpriteRenderForVisibleAnalyse.tarImageData);
		}
		VisibleAnalyser.coverRate=SpriteRenderForVisibleAnalyse.coverRate;
		VisibleAnalyser.isTarRecOK=SpriteRenderForVisibleAnalyse.isTarRecOK;
		console.log("coverRate:",SpriteRenderForVisibleAnalyse.coverRate);
		this.isTargetRenderd=false;
		SpriteRenderForVisibleAnalyse.isVisibleTesting=false;
		SpriteRenderForVisibleAnalyse.allowRendering=true;
		Sprite["prototype"]["render"]=this.preFun;
	}

	__proto.noRenderMode=function(){
		return;
		RenderSprite["prototype"]["_graphics"]=this.m_graphics;
		RenderSprite["prototype"]["_image"]=this.m_image;
		RenderSprite["prototype"]["_image2"]=this.m_image2;
	}

	__proto.normalMode=function(){
		RenderSprite["prototype"]["_graphics"]=this.pgraphic;
		RenderSprite["prototype"]["_image"]=this.pimage;
		RenderSprite["prototype"]["_image2"]=this.pimage2;
	}

	__proto.inits=function(){
		this.noRenderMode();
	}

	__proto.m_graphics=function(sprite,context,x,y){
		if (laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse.allowRendering){
			var tf=sprite._style._tf;
			sprite._graphics && sprite._graphics._render(sprite,context,x-tf.translateX,y-tf.translateY);
		};
		var next=this._next;
		next._fun.call(next,sprite,context,x,y);
	}

	__proto.m_image=function(sprite,context,x,y){
		if (laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse.allowRendering){
			var style=sprite._style;
			context.ctx.drawTexture2(x,y,style._tf.translateX,style._tf.translateY,sprite.transform,style.alpha,style.blendMode,sprite._graphics._one);
		}
	}

	__proto.m_image2=function(sprite,context,x,y){
		if (laya.debug.tools.enginehook.SpriteRenderForVisibleAnalyse.allowRendering){
			var tf=sprite._style._tf;
			context.ctx.drawTexture2(x,y,tf.translateX,tf.translateY,sprite.transform,1,null,sprite._graphics._one);
		}
	}

	SpriteRenderForVisibleAnalyse.tarCanvas=null;
	SpriteRenderForVisibleAnalyse.mainCanvas=null;
	SpriteRenderForVisibleAnalyse.preImageData=null;
	SpriteRenderForVisibleAnalyse.tImageData=null;
	SpriteRenderForVisibleAnalyse.tarImageData=null;
	SpriteRenderForVisibleAnalyse.tarRec=null;
	SpriteRenderForVisibleAnalyse.isTarRecOK=false;
	SpriteRenderForVisibleAnalyse.isVisibleTesting=false;
	SpriteRenderForVisibleAnalyse.allowRendering=true;
	SpriteRenderForVisibleAnalyse.coverRate=NaN;
	__static(SpriteRenderForVisibleAnalyse,
	['I',function(){return this.I=new SpriteRenderForVisibleAnalyse();}
	]);
	return SpriteRenderForVisibleAnalyse;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.enginehook.SpriteRenderHook
var SpriteRenderHook=(function(){
	function SpriteRenderHook(){
		/**@private */
		this._repaint=1;
		this._renderType=1;
		this._x=0;
		this._y=0;
	}

	__class(SpriteRenderHook,'laya.debug.tools.enginehook.SpriteRenderHook');
	var __proto=SpriteRenderHook.prototype;
	/**
	*更新、呈现显示对象。
	*@param context 渲染的上下文引用。
	*@param x X轴坐标。
	*@param y Y轴坐标。
	*/
	__proto.render=function(context,x,y){
		if ((this)==Laya.stage){
			CacheAnalyser.renderLoopBegin();
		};
		var preTime=0;
		preTime=Browser.now();
		Stat.spriteCount++;
		if (this["ShowBorderSign"]){
			DebugTool.showDisBoundToSprite(this,DebugInfoLayer.I.cacheViewLayer,DebugConsts.SPRITE_REC_COLOR,DebugConsts.SPRITE_REC_LINEWIDTH);
		}
		RenderSprite.renders[this._renderType]._fun(this,context,x+this._x,y+this._y);
		this._repaint=0;
		RenderAnalyser.I.render(this,Browser.now()-preTime);
	}

	SpriteRenderHook.init=function(){
		if (SpriteRenderHook.I)return;
		SpriteRenderHook.I=new SpriteRenderHook();
		SpriteRenderHook.setRenderHook();
	}

	SpriteRenderHook.setRenderHook=function(){
		Sprite["prototype"]["render"]=SpriteRenderHook.I.render;
	}

	SpriteRenderHook.showDisplayBorder=function(sprite,ifShowBorder){
		(ifShowBorder===void 0)&& (ifShowBorder=true);
		sprite["ShowBorderSign"]=ifShowBorder;
	}

	SpriteRenderHook.isDisplayShowBorder=function(sprite){
		return sprite["ShowBorderSign"];
	}

	SpriteRenderHook.I=null;
	SpriteRenderHook.ShowBorderSign="ShowBorderSign";
	return SpriteRenderHook;
})()


/**
*本类用于在对象的函数上挂钩子
*@author ww
*@version 1.0
*
*@created 2015-10-23 下午1:13:13
*/
//class laya.debug.tools.hook.FunHook
var FunHook=(function(){
	function FunHook(){}
	__class(FunHook,'laya.debug.tools.hook.FunHook');
	FunHook.hook=function(obj,funName,preFun,aftFun){
		FunHook.hookFuns(obj,funName,[preFun,obj[funName],aftFun],1);
	}

	FunHook.hookAllFun=function(obj){
		var key;
		var arr;
		arr=ClassTool.getOwnPropertyNames(obj);
		for(key in arr){
			key=arr[key];
			if (FunHook.special[key])continue ;
			console.log("try hook:",key);
			if((typeof (obj[key])=='function')){
				console.log("hook:",key);
				FunHook.hookFuns(obj,key,[FunHook.getTraceMsg("call:"+key),obj[key]],1);
			}
		}
		if(obj["__proto__"]){
			FunHook.hookAllFun(obj["__proto__"]);
			}else{
			console.log("end:",obj);
		}
	}

	FunHook.getTraceMsg=function(msg){
		var rst;
		rst=function (){
			console.log(msg);
		}
		return rst;
	}

	FunHook.hookFuns=function(obj,funName,funList,rstI){
		(rstI===void 0)&& (rstI=-1);
		var _preFun=obj[funName];
		var newFun;
		newFun=function (__args){
			var args=arguments;
			var rst;
			var i=0;
			var len=0;
			len=funList.length;
			for(i=0;i<len;i++){
				if(!funList[i])continue ;
				if(i==rstI){
					rst=funList[i].apply(this,args);
					}else{
					funList[i].apply(this,args);
				}
			}
			return rst;
		};
		newFun["pre"]=_preFun;
		obj[funName]=newFun;
	}

	FunHook.removeHook=function(obj,funName){
		if(obj[funName].pre!=null){
			obj[funName]=obj[funName].pre;
		}
	}

	FunHook.debugHere=function(){
		debugger;;
	}

	FunHook.traceLoc=function(level,msg){
		(level===void 0)&& (level=0);
		(msg===void 0)&& (msg="");
		console.log(msg,"fun loc:",TraceTool.getCallLoc(3+level));
	}

	FunHook.getLocFun=function(level,msg){
		(level===void 0)&& (level=0);
		(msg===void 0)&& (msg="");
		level+=1;
		var rst;
		rst=function (){
			FunHook.traceLoc(level,msg);
		}
		return rst;
	}

	__static(FunHook,
	['special',function(){return this.special={
			"length":true,
			"name":true,
			"arguments":true,
			"caller":true,
			"prototype":true,
			"is":true,
			"isExtensible":true,
			"isFrozen":true,
			"isSealed":true,
			"preventExtensions":true,
			"seal":true,
			"unobserve":true,
			"apply":true,
			"call":true,
			"bind":true,
			"freeze":true,
			"unobserve":true
	};}

	]);
	return FunHook;
})()


/**
*本类用于监控对象 set get 函数的调用
*@author ww
*@version 1.0
*
*@created 2015-10-23 下午2:52:48
*/
//class laya.debug.tools.hook.VarHook
var VarHook=(function(){
	function VarHook(){}
	__class(VarHook,'laya.debug.tools.hook.VarHook');
	VarHook.hookVar=function(obj,name,setHook,getHook){
		if(!setHook)setHook=[];
		if(!getHook)getHook=[];
		var preO=obj;
		var preValue=obj[name];
		var des;
		des=ClassTool.getOwnPropertyDescriptor(obj,name);
		var ndes={};
		var mSet=function (value){
			console.log("var hook set "+name+":",value);
			preValue=value;
		};
		var mGet=function (){
			console.log("var hook get"+name+":",preValue);
			return preValue;
		}
		if(des){
			ndes.set=mSet;
			ndes.get=mGet;
			ndes.enumerable=des.enumerable;
			setHook.push(ndes.set);
			getHook.push(ndes.get);
			FunHook.hookFuns(ndes,"set",setHook);
			FunHook.hookFuns(ndes,"get",getHook,getHook.length-1);
			ClassTool.defineProperty(obj,name,ndes);
			return;
		}
		while(!des&&obj["__proto__"]){
			obj=obj["__proto__"];
			des=ClassTool.getOwnPropertyDescriptor(obj,name);
		}
		if (des){
			ndes.set=des.set?des.set:mSet;
			ndes.get=des.get?des.get:mGet;
			ndes.enumerable=des.enumerable;
			setHook.push(ndes.set);
			getHook.push(ndes.get);
			FunHook.hookFuns(ndes,"set",setHook);
			FunHook.hookFuns(ndes,"get",getHook,getHook.length-1);
			ClassTool.defineProperty(preO,name,ndes);
		}
		if(!des){
			console.log("get des fail add directly");
			ndes.set=mSet;
			ndes.get=mGet;
			setHook.push(ndes.set);
			getHook.push(ndes.get);
			FunHook.hookFuns(ndes,"set",setHook);
			FunHook.hookFuns(ndes,"get",getHook,getHook.length-1);
			ClassTool.defineProperty(obj,name,ndes);
		}
	}

	VarHook.getLocFun=function(msg,level){
		(msg===void 0)&& (msg="");
		(level===void 0)&& (level=0);
		level+=1;
		var rst;
		rst=function (){
			FunHook.traceLoc(level,msg);
		}
		return rst;
	}

	return VarHook;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-10-29 上午9:45:33
*/
//class laya.debug.tools.IDTools
var IDTools=(function(){
	function IDTools(){
		this.tID=1;
	}

	__class(IDTools,'laya.debug.tools.IDTools');
	var __proto=IDTools.prototype;
	__proto.getID=function(){
		return this.tID++;
	}

	IDTools.getAID=function(){
		return IDTools._ID.getID();
	}

	IDTools.idObjE=function(obj,sign){
		(sign===void 0)&& (sign="default");
		if (obj["_M_id_"])return obj;
		if(!sign){
			sign="default";
		}
		if(!IDTools._idDic[sign]){
			IDTools._idDic[sign]=new IDTools();
		}
		obj["_M_id_"]=IDTools._idDic[sign].getAID();
		return obj;
	}

	IDTools.setObjID=function(obj,id){
		obj["_M_id_"]=id;
		return obj;
	}

	IDTools.idObj=function(obj){
		if (obj["_M_id_"])return obj;
		obj["_M_id_"]=IDTools.getAID();
		return obj;
	}

	IDTools.getObjID=function(obj){
		if(!obj)return-1;
		return obj["_M_id_"];
	}

	IDTools.idSign="_M_id_";
	__static(IDTools,
	['_ID',function(){return this._ID=new IDTools();},'_idDic',function(){return this._idDic={"default":new IDTools()};}
	]);
	return IDTools;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-11-27 上午9:58:59
*/
//class laya.debug.tools.JsonTool
var JsonTool=(function(){
	function JsonTool(){}
	__class(JsonTool,'laya.debug.tools.JsonTool');
	JsonTool.getJsonString=function(obj,singleLine,split,depth,Width){
		(singleLine===void 0)&& (singleLine=true);
		(split===void 0)&& (split="\n");
		(depth===void 0)&& (depth=0);
		(Width===void 0)&& (Width=4);
		var preStr="";
		preStr=JsonTool.getEmptyStr(depth*Width);
		var rst;
		var keyValues;
		keyValues={};
		var tKey;
		var tValue;
		var type;
		var keys;
		keys=[];
		for(tKey in obj){
			keys.push(tKey);
			tValue=obj[tKey];
			if(JsonTool.singleLineKey[tKey]){
				keyValues[tKey]=JsonTool.getValueStr(tValue,true,split,depth+1,Width);
				}else{
				keyValues[tKey]=JsonTool.getValueStr(tValue,singleLine,split,depth+1,Width);
			}
		};
		var i=0,len=0;
		len=keys.length;
		keys.sort();
		keys=keys.reverse();
		var keyPreStr;
		keyPreStr=JsonTool.getEmptyStr((depth+1)*Width);
		if(singleLine){
			split="";
			preStr="";
			keyPreStr="";
		};
		var keyValueStrArr;
		keyValueStrArr=[];
		for(i=0;i<len;i++){
			tKey=keys[i];
			keyValueStrArr.push(keyPreStr+JsonTool.wrapValue(tKey)+":"+keyValues[tKey]);
		}
		rst="{"+split+keyValueStrArr.join(","+split)+split+preStr+"}";
		return rst;
	}

	JsonTool.wrapValue=function(value,wraper){
		(wraper===void 0)&& (wraper="\"");
		return wraper+value+wraper;
	}

	JsonTool.getArrStr=function(arr,singleLine,split,depth,Width){
		(singleLine===void 0)&& (singleLine=true);
		(split===void 0)&& (split="\n");
		(depth===void 0)&& (depth=0);
		(Width===void 0)&& (Width=4);
		var rst;
		var i=0,len=0;
		len=arr.length;
		var valueStrArr;
		valueStrArr=[];
		for(i=0;i<len;i++){
			valueStrArr.push(JsonTool.getValueStr(arr[i],singleLine,split,depth+1,Width));
		};
		var preStr="";
		preStr=JsonTool.getEmptyStr((depth+1)*Width);
		if(singleLine){
			split="";
			preStr="";
		}
		rst="["+split+preStr+valueStrArr.join(","+split+preStr)+"]";
		return rst;
	}

	JsonTool.quote=function(string){
		JsonTool.escapable.lastIndex=0;
		return JsonTool.escapable.test(string)? '"'+string.replace(JsonTool.escapable,function(a){
			var c=JsonTool.meta[a];
			return typeof c==='string' ? c :
			'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);
		})+'"' :'"'+string+'"';
	}

	JsonTool.getValueStr=function(tValue,singleLine,split,depth,Width){
		(singleLine===void 0)&& (singleLine=true);
		(split===void 0)&& (split="\n");
		(depth===void 0)&& (depth=0);
		(Width===void 0)&& (Width=0);
		var rst;
		if((typeof tValue=='string')){
			rst=JsonTool.quote(tValue);
			}else if(tValue==null){
			rst="null";
			}else if((typeof tValue=='number')|| ((typeof tValue=='number')&& Math.floor(tValue)==tValue)|| (typeof tValue=='boolean')){
			rst=tValue;
			}else if((tValue instanceof Array)){
			rst=JsonTool.getArrStr(tValue,singleLine,split,depth,Width);
			}else if((typeof tValue=='object')){
			rst=JsonTool.getJsonString(tValue,singleLine,split,depth,Width);
			}else{
			rst=tValue;
		}
		return rst;
	}

	JsonTool.getEmptyStr=function(width){
		if(!JsonTool.emptyDic.hasOwnProperty(width)){
			var i=0;
			var len=0;
			len=width;
			var rst;
			rst="";
			for(i=0;i<len;i++){
				rst+=" ";
			}
			JsonTool.emptyDic[width]=rst;
		}
		return JsonTool.emptyDic[width];
	}

	JsonTool.emptyDic={};
	__static(JsonTool,
	['singleLineKey',function(){return this.singleLineKey={
			"props":true
		};},'escapable',function(){return this.escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;},'meta',function(){return this.meta = {
		'\b':'\\b',
		'\t':'\\t',
		'\n':'\\n',
		'\f':'\\f',
		'\r':'\\r',
		'"' :'\\"',
		'\\':'\\\\'
};}


]);
return JsonTool;
})()


/**
*本类用于操作html对象
*@author ww
*/
//class laya.debug.tools.JSTools
var JSTools=(function(){
	function JSTools(){}
	__class(JSTools,'laya.debug.tools.JSTools');
	JSTools.showToBody=function(el,x,y){
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		Browser.document.body.appendChild(el);
		var style;
		style=el.style;
		style.position="absolute";
		style.top=y+"px";
		style.left=x+"px";
	}

	JSTools.showToParent=function(el,x,y,parent){
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		parent.appendChild(el);
		var style;
		style=el.style;
		style.position="absolute";
		style.top=y+"px";
		style.left=x+"px";
	}

	JSTools.addToBody=function(el){
		Browser.document.body.appendChild(el);
	}

	JSTools.setPos=function(el,x,y){
		var style;
		style=el.style;
		style.top=y+"px";
		style.left=x+"px";
	}

	JSTools.setSize=function(el,width,height){
		var style;
		style=el.style;
		style.width=width+"px";
		style.height=height+"px";
	}

	JSTools.setTransform=function(el,mat){
		var style;
		style=el.style;
		style.transformOrigin=style.webkitTransformOrigin=style.msTransformOrigin=style.mozTransformOrigin=style.oTransformOrigin="0px 0px 0px";
		style.transform=style.webkitTransform=style.msTransform=style.mozTransform=style.oTransform="matrix("+mat.toString()+")";
	}

	JSTools.noMouseEvent=function(el){
		var style;
		style=el.style;
		style["pointer-events"]="none";
	}

	JSTools.setMouseEnable=function(el,enable){
		var style;
		style=el.style;
		style["pointer-events"]=enable?"auto":"none";
	}

	JSTools.setZIndex=function(el,zIndex){
		var style;
		style=el.style;
		style["z-index"]=zIndex;
	}

	JSTools.showAboveSprite=function(el,sprite,dx,dy){
		(dx===void 0)&& (dx=0);
		(dy===void 0)&& (dy=0);
		var pos;
		pos=new Point();
		pos=sprite.localToGlobal(pos);
		pos.x+=dx;
		pos.y+=dy;
		pos.x+=Laya.stage.offset.x;
		pos.y+=Laya.stage.offset.y;
		JSTools.showToBody(el,pos.x,pos.y);
	}

	JSTools.removeElement=function(el){
		Browser.removeElement(el);
	}

	JSTools.isElementInDom=function(el){
		return el && el.parentNode;
	}

	JSTools.getImageSpriteByFile=function(file,width,height){
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		var reader;
		reader=new FileReader();;
		reader.readAsDataURL(file);
		var sprite;
		sprite=new Sprite();
		reader.onload=function (e){
			var txt;
			txt=new Texture();
			txt.load(reader.result);
			sprite.graphics.drawTexture(txt,0,0,width,height);
		}
		return sprite;
	}

	JSTools.getPixelRatio=function(){
		if (JSTools._pixelRatio > 0)return JSTools._pixelRatio;
		var canvas=Browser.createElement("canvas");
		var context=canvas.getContext('2d');
		var devicePixelRatio=Browser.window.devicePixelRatio || 1;
		var backingStoreRatio=context.webkitBackingStorePixelRatio ||
		context.mozBackingStorePixelRatio ||
		context.msBackingStorePixelRatio ||
		context.oBackingStorePixelRatio ||
		context.backingStorePixelRatio || 1;
		var ratio=devicePixelRatio / backingStoreRatio;
		console.log("pixelRatioc:",ratio);
		JSTools._pixelRatio=ratio;
		return ratio;
	}

	JSTools._pixelRatio=-1;
	return JSTools;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.MathTools
var MathTools=(function(){
	function MathTools(){}
	__class(MathTools,'laya.debug.tools.MathTools');
	MathTools.sortBigFirst=function(a,b){
		if (a==b)
			return 0;
		return b > a ? 1 :-1;
	}

	MathTools.sortSmallFirst=function(a,b){
		if (a==b)
			return 0;
		return b > a ?-1 :1;
	}

	MathTools.sortNumBigFirst=function(a,b){
		return parseFloat(b)-parseFloat(a);
	}

	MathTools.sortNumSmallFirst=function(a,b){
		return parseFloat(a)-parseFloat(b);
	}

	MathTools.sortByKey=function(key,bigFirst,forceNum){
		(bigFirst===void 0)&& (bigFirst=false);
		(forceNum===void 0)&& (forceNum=true);
		var _sortFun;
		if (bigFirst){
			_sortFun=forceNum ? MathTools.sortNumBigFirst :MathTools.sortBigFirst;
			}else {
			_sortFun=forceNum ? MathTools.sortNumSmallFirst :MathTools.sortSmallFirst;
		}
		return function (a,b){
			return _sortFun(a[key],b[key]);
		};
	}

	return MathTools;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.MouseEventAnalyser
var MouseEventAnalyser=(function(){
	function MouseEventAnalyser(){}
	__class(MouseEventAnalyser,'laya.debug.tools.MouseEventAnalyser');
	MouseEventAnalyser.analyseNode=function(node){
		DebugTool.showDisBound(node,true);
		var _node;
		_node=node;
		ObjectTools.clearObj(MouseEventAnalyser.infoO);
		ObjectTools.clearObj(MouseEventAnalyser.nodeO);
		ObjectTools.clearObj(MouseEventAnalyser.hitO);
		var nodeList;
		nodeList=[];
		while (node){
			IDTools.idObj(node);
			MouseEventAnalyser.nodeO[IDTools.getObjID(node)]=node;
			nodeList.push(node);
			node=node.parent;
		}
		MouseEventAnalyser.check(Laya.stage,Laya.stage.mouseX,Laya.stage.mouseY,null);
		var canStr;
		if (MouseEventAnalyser.hitO[IDTools.getObjID(_node)]){
			console.log("can hit");
			canStr="can hit";
		}
		else{
			console.log("can't hit");
			canStr="can't hit";
		};
		var i=0,len=0;
		nodeList=nodeList.reverse();
		len=nodeList.length;
		var rstTxts;
		rstTxts=["[分析对象]:"+ClassTool.getNodeClassAndName(_node)+":"+canStr];
		for (i=0;i < len;i++){
			node=nodeList[i];
			if (MouseEventAnalyser.hitO[IDTools.getObjID(node)]){
				console.log("can hit:",ClassTool.getNodeClassAndName(node));
				console.log("原因:",MouseEventAnalyser.infoO[IDTools.getObjID(node)]);
				rstTxts.push("can hit:"+" "+ClassTool.getNodeClassAndName(node));
				rstTxts.push("原因:"+" "+MouseEventAnalyser.infoO[IDTools.getObjID(node)]);
			}
			else{
				console.log("can't hit:"+ClassTool.getNodeClassAndName(node));
				console.log("原因:",MouseEventAnalyser.infoO[IDTools.getObjID(node)] ? MouseEventAnalyser.infoO[IDTools.getObjID(node)] :"鼠标事件在父级已停止派发");
				rstTxts.push("can't hit:"+" "+ClassTool.getNodeClassAndName(node));
				rstTxts.push("原因:"+" "+(MouseEventAnalyser.infoO[IDTools.getObjID(node)] ? MouseEventAnalyser.infoO[IDTools.getObjID(node)] :"鼠标事件在父级已停止派发"));
			}
		};
		var rstStr;
		rstStr=rstTxts.join("\n");
		ToolPanel.I.showTxtInfo(rstStr);
	}

	MouseEventAnalyser.check=function(sp,mouseX,mouseY,callBack){
		IDTools.idObj(sp);
		var isInAnlyseChain=false;
		isInAnlyseChain=MouseEventAnalyser.nodeO[IDTools.getObjID(sp)];
		MouseEventAnalyser._point.setTo(mouseX,mouseY);
		sp.fromParentPoint(MouseEventAnalyser._point);
		mouseX=MouseEventAnalyser._point.x;
		mouseY=MouseEventAnalyser._point.y;
		var scrollRect=sp.scrollRect;
		if (scrollRect){
			MouseEventAnalyser._rect.setTo(scrollRect.x,scrollRect.y,scrollRect.width,scrollRect.height);
			var isHit=MouseEventAnalyser._rect.contains(mouseX,mouseY);
			if (!isHit){
				if (isInAnlyseChain){
					MouseEventAnalyser.infoO[IDTools.getObjID(sp)]="scrollRect没有包含鼠标"+MouseEventAnalyser._rect.toString()+":"+mouseX+","+mouseY;
				}
				return false;
			}
		};
		var i=0,len=0;
		var cList;
		cList=sp._childs;
		len=cList.length;
		var child;
		var childInChain;
		childInChain=null;
		for (i=0;i < len;i++){
			child=cList[i];
			IDTools.idObj(child);
			if (MouseEventAnalyser.nodeO[IDTools.getObjID(child)]){
				childInChain=child;
				break ;
			}
		};
		var coverByOthers=false;
		coverByOthers=childInChain ? true :false;
		var flag=false;
		if (sp.hitTestPrior && !sp.mouseThrough && !MouseEventAnalyser.hitTest(sp,mouseX,mouseY)){
			MouseEventAnalyser.infoO[IDTools.getObjID(sp)]="hitTestPrior=true，宽高区域不包含鼠标:"+":"+mouseX+","+mouseY+" size:"+sp.width+","+sp.height;
			return false;
		}
		for (i=sp._childs.length-1;i >-1;i--){
			child=sp._childs[i];
			if (child==childInChain){
				if (!childInChain.mouseEnabled){
					MouseEventAnalyser.infoO[IDTools.getObjID(childInChain)]="mouseEnabled=false";
				}
				if (!childInChain.visible){
					MouseEventAnalyser.infoO[IDTools.getObjID(childInChain)]="visible=false";
				}
				coverByOthers=false;
			}
			if (child.mouseEnabled && child.visible){
				flag=MouseEventAnalyser.check(child,mouseX ,mouseY,callBack);
				if (flag){
					MouseEventAnalyser.hitO[IDTools.getObjID(sp)]=true;
					MouseEventAnalyser.infoO[IDTools.getObjID(sp)]="子对象被击中";
					if (child==childInChain){
						MouseEventAnalyser.infoO[IDTools.getObjID(sp)]="子对象被击中,"+"击中对象在分析链中";
					}
					else{
						MouseEventAnalyser.infoO[IDTools.getObjID(sp)]="子对象被击中,"+"击中对象不在分析链中";
						if (coverByOthers){
							MouseEventAnalyser.infoO[IDTools.getObjID(childInChain)]="被兄弟节点挡住,兄弟节点信息:"+ClassTool.getNodeClassAndName(child)+","+child.getBounds().toString();
							DebugTool.showDisBound(child,false,"#ffff00");
						}
					}
					return true;
				}
				else{
					if (child==childInChain){
						coverByOthers=false;
					}
				}
			}
		};
		var mHitRect=new Rectangle();
		var graphicHit=false;
		graphicHit=sp.getGraphicBounds().contains(mouseX,mouseY);
		if (sp.width > 0 && sp.height > 0){
			var hitRect=MouseEventAnalyser._rect;
			if (!sp.mouseThrough){
				if (sp.hitArea)
					hitRect=sp.hitArea;
				else
				hitRect.setTo(0,0,sp.width,sp.height);
				mHitRect.copyFrom(hitRect);
				isHit=hitRect.contains(mouseX,mouseY);
			}
			else{
				isHit=graphicHit;
				mHitRect.copyFrom(sp.getGraphicBounds());
			}
			if (isHit){
				MouseEventAnalyser.hitO[IDTools.getObjID(sp)]=true;
			}
			}else{
		}
		if (!isHit){
			if (graphicHit){
				MouseEventAnalyser.infoO[IDTools.getObjID(sp)]="子对象未包含鼠标，实际绘图区域包含鼠标，设置的宽高区域不包含鼠标:"+":"+mouseX+","+mouseY+" hitRec:"+mHitRect.toString()+" graphicBounds:"+sp.getGraphicBounds().toString()+"，设置mouseThrough=true或将宽高设置到实际绘图区域可解决问题";
				}else{
				MouseEventAnalyser.infoO[IDTools.getObjID(sp)]="子对象未包含鼠标，实际绘图区域不包含鼠标，设置的宽高区域不包含鼠标:"+":"+mouseX+","+mouseY+" hitRec:"+mHitRect.toString()+" graphicBounds:"+sp.getGraphicBounds().toString();
			}
		}
		else{
			MouseEventAnalyser.infoO[IDTools.getObjID(sp)]="自身区域被击中";
		}
		return isHit;
	}

	MouseEventAnalyser.hitTest=function(sp,mouseX,mouseY){
		var isHit=false;
		if ((sp.hitArea instanceof laya.utils.HitArea )){
			return sp.hitArea.isHit(mouseX,mouseY);
		}
		if (sp.width > 0 && sp.height > 0 || sp.mouseThrough || sp.hitArea){
			var hitRect=MouseEventAnalyser._rect;
			if (!sp.mouseThrough){
				if (sp.hitArea)hitRect=sp.hitArea;
				else hitRect.setTo(0,0,sp.width,sp.height);
				isHit=hitRect.contains(mouseX,mouseY);
				}else {
				isHit=sp.getGraphicBounds().contains(mouseX,mouseY);
			}
		}
		return isHit;
	}

	MouseEventAnalyser.infoO={};
	MouseEventAnalyser.nodeO={};
	MouseEventAnalyser.hitO={};
	__static(MouseEventAnalyser,
	['_matrix',function(){return this._matrix=new Matrix();},'_point',function(){return this._point=new Point();},'_rect',function(){return this._rect=new Rectangle();}
	]);
	return MouseEventAnalyser;
})()


/**
*本类提供obj相关的一些操作
*@author ww
*@version 1.0
*
*@created 2015-10-21 下午2:03:36
*/
//class laya.debug.tools.ObjectTools
var ObjectTools=(function(){
	function ObjectTools(){}
	__class(ObjectTools,'laya.debug.tools.ObjectTools');
	ObjectTools.getFlatKey=function(tKey,aKey){
		if(tKey=="")return aKey;
		return tKey+ObjectTools.sign+aKey;
	}

	ObjectTools.flatObj=function(obj,rst,tKey){
		(tKey===void 0)&& (tKey="");
		rst=rst?rst:{};
		var key;
		var tValue;
		for(key in obj){
			if((typeof (obj[key])=='object')){
				ObjectTools.flatObj(obj[key],rst,ObjectTools.getFlatKey(tKey,key));
				}else{
				tValue=obj[key];
				rst[ObjectTools.getFlatKey(tKey,key)]=obj[key];
			}
		}
		return rst;
	}

	ObjectTools.recoverObj=function(obj){
		var rst={};
		var tKey;
		for(tKey in obj){
			ObjectTools.setKeyValue(rst,tKey,obj[tKey]);
		}
		return rst;
	}

	ObjectTools.differ=function(objA,objB){
		var tKey;
		var valueA;
		var valueB;
		objA=ObjectTools.flatObj(objA);
		objB=ObjectTools.flatObj(objB);
		var rst={};
		for(tKey in objA){
			if(!objB.hasOwnProperty(tKey)){
				rst[tKey]="被删除";
			}
		}
		for(tKey in objB){
			if(objB[tKey]!=objA[tKey]){
				rst[tKey]={"pre":objA[tKey],"now":objB[tKey]};
			}
		}
		return rst;
	}

	ObjectTools.traceDifferObj=function(obj){
		var key;
		var tO;
		for(key in obj){
			if((typeof (obj[key])=='string')){
				console.log(key+":",obj[key]);
				}else{
				tO=obj[key];
				console.log(key+":","now:",tO["now"],"pre:",tO["pre"]);
			}
		}
	}

	ObjectTools.setKeyValue=function(obj,flatKey,value){
		if(flatKey.indexOf(ObjectTools.sign)>=0){
			var keys=flatKey.split(ObjectTools.sign);
			var tKey;
			while(keys.length>1){
				tKey=keys.shift();
				if(!obj[tKey]){
					obj[tKey]={};
					console.log("addKeyObj:",tKey);
				}
				obj=obj[tKey];
				if(!obj){
					console.log("wrong flatKey:",flatKey);
					return;
				}
			}
			obj[keys.shift()]=value;
			}else{
			obj[flatKey]=value;
		}
	}

	ObjectTools.clearObj=function(obj){
		var key;
		for (key in obj){
			delete obj[key];
		}
	}

	ObjectTools.copyObjFast=function(obj){
		var jsStr;
		jsStr=laya.debug.tools.ObjectTools.getJsonString(obj);
		return laya.debug.tools.ObjectTools.getObj(jsStr);
	}

	ObjectTools.copyObj=function(obj){
		if((obj instanceof Array))return ObjectTools.copyArr(obj);
		var rst={};
		var key;
		for(key in obj){
			if(obj[key]===null||obj[key]===undefined){
				rst[key]=obj[key];
			}else
			if(((obj[key])instanceof Array)){
				rst[key]=ObjectTools.copyArr(obj[key]);
			}
			else
			if((typeof (obj[key])=='object')){
				rst[key]=ObjectTools.copyObj(obj[key]);
				}else{
				rst[key]=obj[key];
			}
		}
		return rst;
	}

	ObjectTools.copyArr=function(arr){
		var rst;
		rst=[];
		var i=0,len=0;
		len=arr.length;
		for(i=0;i<len;i++){
			rst.push(ObjectTools.copyObj(arr[i]));
		}
		return rst;
	}

	ObjectTools.concatArr=function(src,a){
		if (!a)return src;
		if (!src)return a;
		var i=0,len=a.length;
		for (i=0;i < len;i++){
			src.push(a[i]);
		}
		return src;
	}

	ObjectTools.insertArrToArr=function(src,insertArr,pos){
		(pos===void 0)&& (pos=0);
		if (pos < 0)pos=0;
		if (pos > src.length)pos=src.length;
		var preLen=src.length;
		var i=0,len=0;
		src.length+=insertArr.length;
		var moveLen=0;
		moveLen=insertArr.length;
		for (i=src.length-1;i >=pos;i--){
			src[i]=src[i-moveLen];
		}
		len=insertArr.length;
		for (i=0;i < len;i++){
			src[pos+i]=insertArr[i];
		}
		return src;
	}

	ObjectTools.clearArr=function(arr){
		if (!arr)return arr;
		arr.length=0;
		return arr;
	}

	ObjectTools.removeFromArr=function(arr,item){
		var i=0,len=0;
		len=arr.length;
		for(i=0;i<len;i++){
			if(arr[i]==item){
				arr[i].splice(i,1);
				return;
			}
		}
	}

	ObjectTools.setValueArr=function(src,v){
		src || (src=[]);
		src.length=0;
		return ObjectTools.concatArr(src,v);
	}

	ObjectTools.getFrom=function(rst,src,count){
		var i=0;
		for (i=0;i < count;i++){
			rst.push(src[i]);
		}
		return rst;
	}

	ObjectTools.getFromR=function(rst,src,count){
		var i=0;
		for (i=0;i < count;i++){
			rst.push(src.pop());
		}
		return rst;
	}

	ObjectTools.enableDisplayTree=function(dis){
		while (dis){
			dis.mouseEnabled=true;
			dis=dis.parent;
		}
	}

	ObjectTools.getJsonString=function(obj){
		var rst;
		rst=JSON.stringify(obj);
		return rst;
	}

	ObjectTools.getObj=function(jsonStr){
		var rst;
		rst=JSON.parse(jsonStr);
		return rst;
	}

	ObjectTools.getKeyArr=function(obj){
		var rst;
		var key;
		rst=[];
		for(key in obj){
			rst.push(key);
		}
		return rst;
	}

	ObjectTools.getObjValues=function(dataList,key){
		var rst;
		var i=0,len=0;
		len=dataList.length;
		rst=[];
		for(i=0;i<len;i++){
			rst.push(dataList[i][key]);
		}
		return rst;
	}

	ObjectTools.hasKeys=function(obj,keys){
		var i=0,len=0;
		len=keys.length;
		for(i=0;i<len;i++){
			if(!obj.hasOwnProperty(keys[i]))return false;
		}
		return true;
	}

	ObjectTools.copyValueByArr=function(tar,src,keys){
		var i=0,len=keys.length;
		for(i=0;i<len;i++){
			if(!(src[keys[i]]===null))
				tar[keys[i]]=src[keys[i]];
		}
	}

	ObjectTools.getNoSameArr=function(arr){
		var i=0,len=0;
		var rst;
		rst=[];
		var tItem;
		len=arr.length;
		for (i=0;i < len;i++){
			tItem=arr[i];
			if (rst.indexOf(tItem)< 0){
				rst.push(tItem);
			}
		}
		return rst;
	}

	ObjectTools.insertValue=function(tar,src){
		var key;
		for (key in src){
			tar[key]=src[key];
		}
	}

	ObjectTools.replaceValue=function(obj,replaceO){
		var key;
		for(key in obj){
			if(replaceO.hasOwnProperty(obj[key])){
				obj[key]=replaceO[obj[key]];
			}
			if((typeof (obj[key])=='object')){
				ObjectTools.replaceValue(obj[key],replaceO);
			}
		}
	}

	ObjectTools.setKeyValues=function(items,key,value){
		var i=0,len=0;
		len=items.length;
		for(i=0;i<len;i++){
			items[i][key]=value;
		}
	}

	ObjectTools.findItemPos=function(items,sign,value){
		var i=0,len=0;
		len=items.length;
		for(i=0;i<len;i++){
			if(items[i][sign]==value){
				return i;
			}
		}
		return-1;
	}

	ObjectTools.setObjValue=function(obj,key,value){
		obj[key]=value;
		return obj;
	}

	ObjectTools.setAutoTypeValue=function(obj,key,value){
		if(obj.hasOwnProperty(key)){
			if(ObjectTools.isNumber(obj[key])){
				obj[key]=parseFloat(value);
				}else{
				obj[key]=value;
			}
			}else{
			obj[key]=value;
		}
		return obj;
	}

	ObjectTools.getAutoValue=function(value){
		var tFloat=parseFloat(value);
		if(typeof(value)=="string"){
			if(tFloat+""===StringTool.trimSide(value))return tFloat;
		}
		return value;
	}

	ObjectTools.isNumber=function(value){
		return (parseFloat(value)==value);
	}

	ObjectTools.isNaNS=function(value){
		return (value.toString()=="NaN");
	}

	ObjectTools.isNaN=function(value){
		if(typeof(value)=="number")return false;
		if(typeof(value)=="string"){
			if(parseFloat(value).toString()!="NaN"){
				if(parseFloat(value)==value){
					return false;
				}
			}
		}
		return true;
	}

	ObjectTools.getStrTypedValue=function(value){
		if(value=="false"){
			return false;
		}else
		if(value=="true"){
			return true;
		}else
		if(value=="null"){
			return null;
		}else
		if(value=="undefined"){
			return null;
			}else{
			return ObjectTools.getAutoValue(value);
		}
	}

	ObjectTools.createKeyValueDic=function(dataList,keySign){
		var rst;
		rst={};
		var i=0,len=0;
		len=dataList.length;
		var tItem;
		var tKey;
		for(i=0;i<len;i++){
			tItem=dataList[i];
			tKey=tItem[keySign];
			rst[tKey]=tItem;
		}
		return rst;
	}

	ObjectTools.sign="_";
	return ObjectTools;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.ObjTimeCountTool
var ObjTimeCountTool=(function(){
	function ObjTimeCountTool(){
		this.timeDic={};
		this.resultDic={};
		this.countDic={};
		this.resultCountDic={};
		this.nodeDic={};
		this.resultNodeDic={};
	}

	__class(ObjTimeCountTool,'laya.debug.tools.ObjTimeCountTool');
	var __proto=ObjTimeCountTool.prototype;
	__proto.addTime=function(sprite,time){
		IDTools.idObj(sprite);
		var key=0;
		key=IDTools.getObjID(sprite);
		if (!this.timeDic.hasOwnProperty(key)){
			this.timeDic[key]=0;
		}
		this.timeDic[key]=this.timeDic[key]+time;
		if (!this.countDic.hasOwnProperty(key)){
			this.countDic[key]=0;
		}
		this.countDic[key]=this.countDic[key]+1;
		this.nodeDic[key]=sprite;
	}

	__proto.getTime=function(sprite){
		IDTools.idObj(sprite);
		var key=0;
		key=IDTools.getObjID(sprite);
		if (!this.resultDic[key])return 0;
		return this.resultDic[key];
	}

	__proto.getCount=function(sprite){
		IDTools.idObj(sprite);
		var key=0;
		key=IDTools.getObjID(sprite);
		return this.resultCountDic[key];
	}

	__proto.reset=function(){
		var key;
		for (key in this.timeDic){
			this.timeDic[key]=0;
			this.countDic[key]=0;
		}
		ObjectTools.clearObj(this.nodeDic);
	}

	__proto.updates=function(){
		ObjectTools.clearObj(this.resultDic);
		ObjectTools.insertValue(this.resultDic,this.timeDic);
		ObjectTools.clearObj(this.resultCountDic);
		ObjectTools.insertValue(this.resultCountDic,this.countDic);
		ObjectTools.insertValue(this.resultNodeDic,this.nodeDic);
		this.reset();
	}

	return ObjTimeCountTool;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-12-23 下午12:00:48
*/
//class laya.debug.tools.RecInfo
var RecInfo=(function(){
	function RecInfo(){
		this.oX=0;
		this.oY=0;
		this.hX=1;
		this.hY=0;
		this.vX=0;
		this.vY=1;
	}

	__class(RecInfo,'laya.debug.tools.RecInfo');
	var __proto=RecInfo.prototype;
	__proto.initByPoints=function(oPoint,ePoint,vPoint){
		this.oX=oPoint.x;
		this.oY=oPoint.y;
		this.hX=ePoint.x;
		this.hY=ePoint.y;
		this.vX=vPoint.x;
		this.vY=vPoint.y;
	}

	__getset(0,__proto,'rotation',function(){
		return this.rotationRad/Math.PI*180;
	});

	__getset(0,__proto,'width',function(){
		return Math.sqrt((this.hX-this.oX)*(this.hX-this.oX)+(this.hY-this.oY)*(this.hY-this.oY));
	});

	__getset(0,__proto,'x',function(){
		return this.oX;
	});

	__getset(0,__proto,'rotationRadV',function(){
		var dx=this.vX-this.oX;
		var dy=this.vY-this.oY;
		return Math.atan2(dy,dx);
	});

	__getset(0,__proto,'y',function(){
		return this.oY;
	});

	__getset(0,__proto,'rotationRad',function(){
		var dx=this.hX-this.oX;
		var dy=this.hY-this.oY;
		return Math.atan2(dy,dx);
	});

	__getset(0,__proto,'height',function(){
		return Math.sqrt((this.vX-this.oX)*(this.vX-this.oX)+(this.vY-this.oY)*(this.vY-this.oY));
	});

	__getset(0,__proto,'rotationV',function(){
		return this.rotationRadV/Math.PI*180;
	});

	RecInfo.createByPoints=function(oPoint,ePoint,vPoint){
		var rst;
		rst=new RecInfo();
		rst.initByPoints(oPoint,ePoint,vPoint);
		return rst;
	}

	RecInfo.getGlobalPoints=function(sprite,x,y){
		return sprite.localToGlobal(new Point(x,y));
	}

	RecInfo.getGlobalRecInfo=function(sprite,x0,y0,x1,y1,x2,y2){
		(x0===void 0)&& (x0=0);
		(y0===void 0)&& (y0=0);
		(x1===void 0)&& (x1=1);
		(y1===void 0)&& (y1=0);
		(x2===void 0)&& (x2=0);
		(y2===void 0)&& (y2=1);
		return RecInfo.createByPoints(RecInfo.getGlobalPoints(sprite,x0,y0),RecInfo.getGlobalPoints(sprite,x1,y1),RecInfo.getGlobalPoints(sprite,x2,y2));
	}

	return RecInfo;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.RenderAnalyser
var RenderAnalyser=(function(){
	function RenderAnalyser(){
		this.timeDic={};
		this.resultDic={};
		this.countDic={};
		this.resultCountDic={};
		this.nodeDic={};
		this.isWorking=false;
		this.working=true;
	}

	__class(RenderAnalyser,'laya.debug.tools.RenderAnalyser');
	var __proto=RenderAnalyser.prototype;
	__proto.render=function(sprite,time){
		this.addTime(sprite,time);
	}

	__proto.addTime=function(sprite,time){
		IDTools.idObj(sprite);
		var key=0;
		key=IDTools.getObjID(sprite);
		if (!this.timeDic.hasOwnProperty(key)){
			this.timeDic[key]=0;
		}
		this.timeDic[key]=this.timeDic[key]+time;
		if (!this.countDic.hasOwnProperty(key)){
			this.countDic[key]=0;
		}
		this.countDic[key]=this.countDic[key]+1;
		this.nodeDic[key]=sprite;
	}

	__proto.getTime=function(sprite){
		IDTools.idObj(sprite);
		var key=0;
		key=IDTools.getObjID(sprite);
		if (!this.resultDic[key])return 0;
		return this.resultDic[key];
	}

	__proto.getCount=function(sprite){
		IDTools.idObj(sprite);
		var key=0;
		key=IDTools.getObjID(sprite);
		return this.resultCountDic[key];
	}

	__proto.reset=function(){
		var key;
		for (key in this.timeDic){
			this.timeDic[key]=0;
			this.countDic[key]=0;
		}
		ObjectTools.clearObj(this.nodeDic);
	}

	__proto.updates=function(){
		ObjectTools.clearObj(this.resultDic);
		ObjectTools.insertValue(this.resultDic,this.timeDic);
		ObjectTools.clearObj(this.resultCountDic);
		ObjectTools.insertValue(this.resultCountDic,this.countDic);
		this.reset();
	}

	__getset(0,__proto,'working',null,function(v){
		this.isWorking=v;
		if (v){
			Laya.timer.loop(NodeConsts.RenderCostMaxTime,this,this.updates);
			}else{
			Laya.timer.clear(this,this.updates);
		}
	});

	__static(RenderAnalyser,
	['I',function(){return this.I=new RenderAnalyser();}
	]);
	return RenderAnalyser;
})()


/**
*本类用于调整对象的宽高以及坐标
*@author ww
*/
//class laya.debug.tools.resizer.DisResizer
var DisResizer=(function(){
	function DisResizer(){}
	__class(DisResizer,'laya.debug.tools.resizer.DisResizer');
	DisResizer.init=function(){
		if (DisResizer._up)return;
		DisResizer._up=new AutoFillRec("T");
		DisResizer._up.height=2;
		DisResizer._up.type=0;
		DisResizer._down=new AutoFillRec("T");
		DisResizer._down.height=2;
		DisResizer._down.type=0;
		DisResizer._left=new AutoFillRec("R");
		DisResizer._left.width=2;
		DisResizer._left.type=1;
		DisResizer._right=new AutoFillRec("R");
		DisResizer._right.width=2;
		DisResizer._right.type=1;
		DisResizer._barList=[DisResizer._up,DisResizer._down,DisResizer._left,DisResizer._right];
		DisResizer.addEvent();
	}

	DisResizer.stageDown=function(e){
		var target;
		target=e.target;
		if (DisResizer._tar && DisControlTool.isInTree(DisResizer._tar,target)){
			return;
		}
		DisResizer.clear();
	}

	DisResizer.clear=function(){
		DisResizer._tar=null;
		Laya.stage.off("mouseup",null,DisResizer.stageDown);
		DisControlTool.removeItems(DisResizer._barList);
		DisResizer.clearDragEvents();
	}

	DisResizer.addEvent=function(){
		var i=0,len=0;
		var tBar;
		len=DisResizer._barList.length;
		for (i=0;i < len;i++){
			tBar=DisResizer._barList[i];
			tBar.on("mousedown",null,DisResizer.barDown);
		}
	}

	DisResizer.barDown=function(e){
		DisResizer.clearDragEvents();
		DisResizer.tBar=e.target;
		if (!DisResizer.tBar)return;
		var area;
		area=new Rectangle();
		if (DisResizer.tBar.type==0){
			area.x=DisResizer.tBar.x;
			area.width=0;
			area.y=DisResizer.tBar.y-200;
			area.height=400;
			}else{
			area.x=DisResizer.tBar.x-200;
			area.width=400;
			area.y=0;
			area.height=0;
		};
		var option;
		option={};
		option.area=area;
		DisResizer.tBar.record();
		DisResizer.tBar.startDrag(area);
		DisResizer.tBar.on("dragmove",null,DisResizer.draging);
		DisResizer.tBar.on("dragend",null,DisResizer.dragEnd);
	}

	DisResizer.draging=function(e){
		console.log("draging");
		if (!DisResizer.tBar)return;
		if (!DisResizer._tar)return;
		switch(DisResizer.tBar){
			case DisResizer._left:
				DisResizer._tar.x+=DisResizer.tBar.getDx();
				DisResizer._tar.width-=DisResizer.tBar.getDx();
				DisResizer._up.width-=DisResizer.tBar.getDx();
				DisResizer._down.width-=DisResizer.tBar.getDx();
				DisResizer._right.x-=DisResizer.tBar.getDx();
				DisResizer.tBar.x-=DisResizer.tBar.getDx();
				break ;
			case DisResizer._right:
				DisResizer._tar.width+=DisResizer.tBar.getDx();
				DisResizer._up.width+=DisResizer.tBar.getDx();
				DisResizer._down.width+=DisResizer.tBar.getDx();
				break ;
			case DisResizer._up:
				DisResizer._tar.y+=DisResizer.tBar.getDy();
				DisResizer._tar.height-=DisResizer.tBar.getDy();
				DisResizer._right.height-=DisResizer.tBar.getDy();
				DisResizer._left.height-=DisResizer.tBar.getDy();
				DisResizer._down.y-=DisResizer.tBar.getDy();
				DisResizer.tBar.y-=DisResizer.tBar.getDy();
				break ;
			case DisResizer._down:
				DisResizer._tar.height+=DisResizer.tBar.getDy();
				DisResizer._right.height+=DisResizer.tBar.getDy();
				DisResizer._left.height+=DisResizer.tBar.getDy();
				break ;
			}
		DisResizer.tBar.record();
	}

	DisResizer.dragEnd=function(e){
		console.log("dragEnd");
		DisResizer.clearDragEvents();
		DisResizer.updates();
	}

	DisResizer.clearDragEvents=function(){
		if (!DisResizer.tBar)return;
		DisResizer.tBar.off("dragmove",null,DisResizer.draging);
		DisResizer.tBar.off("dragend",null,DisResizer.dragEnd);
	}

	DisResizer.setUp=function(dis,force){
		(force===void 0)&& (force=false);
		if (force && dis==DisResizer._tar){
			return;
		};
		DisControlTool.removeItems(DisResizer._barList);
		if (DisResizer._tar==dis){
			DisResizer._tar=null;
			DisResizer.clearDragEvents();
			if(!force)
				return;
		}
		DisResizer._tar=dis;
		DisResizer.updates();
		DisControlTool.addItems(DisResizer._barList,dis);
		Laya.stage.off("mouseup",null,DisResizer.stageDown);
		Laya.stage.on("mouseup",null,DisResizer.stageDown);
	}

	DisResizer.updates=function(){
		var dis;
		dis=DisResizer._tar;
		if(!dis)return;
		var bounds;
		bounds=new Rectangle(0,0,dis.width,dis.height);
		DisResizer._up.x=bounds.x;
		DisResizer._up.y=bounds.y;
		DisResizer._up.width=bounds.width;
		DisResizer._down.x=bounds.x;
		DisResizer._down.y=bounds.y+bounds.height-2;
		DisResizer._down.width=bounds.width;
		DisResizer._left.x=bounds.x;
		DisResizer._left.y=bounds.y;
		DisResizer._left.height=bounds.height;
		DisResizer._right.x=bounds.x+bounds.width-2;
		DisResizer._right.y=bounds.y;
		DisResizer._right.height=bounds.height;
	}

	DisResizer.Side=2;
	DisResizer.Vertical=1;
	DisResizer.Horizon=0;
	DisResizer._up=null;
	DisResizer._down=null;
	DisResizer._left=null;
	DisResizer._right=null;
	DisResizer._barList=null;
	DisResizer._tar=null;
	DisResizer.barWidth=2;
	DisResizer.useGetBounds=false;
	DisResizer.tBar=null;
	return DisResizer;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.resizer.SimpleResizer
var SimpleResizer=(function(){
	function SimpleResizer(){}
	__class(SimpleResizer,'laya.debug.tools.resizer.SimpleResizer');
	SimpleResizer.setResizeAble=function(clickItem,tar,minWidth,minHeight){
		(minWidth===void 0)&& (minWidth=150);
		(minHeight===void 0)&& (minHeight=150);
		clickItem.on("mousedown",null,SimpleResizer.onMouseDown,[tar,minWidth,minHeight]);
	}

	SimpleResizer.onMouseDown=function(tar,minWidth,minHeight,e){
		SimpleResizer.clearEvents();
		if (!tar)return;
		SimpleResizer.preMousePoint.setTo(Laya.stage.mouseX,Laya.stage.mouseY);
		SimpleResizer.preTarSize.setTo(tar.width,tar.height);
		SimpleResizer.preScale.setTo(1,1);
		var rTar;
		rTar=tar;
		while (rTar&&rTar!=Laya.stage){
			SimpleResizer.preScale.x *=rTar.scaleX;
			SimpleResizer.preScale.y *=rTar.scaleY;
			rTar=rTar.parent;
		}
		Laya.stage.on("mouseup",null,SimpleResizer.onMouseMoveEnd);
		Laya.timer.loop(100,null,SimpleResizer.onMouseMoving,[tar,minWidth,minHeight]);
	}

	SimpleResizer.onMouseMoving=function(tar,minWidth,minHeight,e){
		var tWidth=(Laya.stage.mouseX-SimpleResizer.preMousePoint.x)/ SimpleResizer.preScale.x+SimpleResizer.preTarSize.x;
		var tHeight=(Laya.stage.mouseY-SimpleResizer.preMousePoint.y)/SimpleResizer.preScale.y+SimpleResizer.preTarSize.y;
		tar.width=tWidth > minWidth?tWidth:minWidth;
		tar.height=tHeight>minHeight?tHeight:minHeight;
	}

	SimpleResizer.onMouseMoveEnd=function(e){
		SimpleResizer.clearEvents();
	}

	SimpleResizer.clearEvents=function(){
		Laya.timer.clear(null,SimpleResizer.onMouseMoving);
		Laya.stage.off("mouseup",null,SimpleResizer.onMouseMoveEnd);
	}

	__static(SimpleResizer,
	['preMousePoint',function(){return this.preMousePoint=new Point();},'preTarSize',function(){return this.preTarSize=new Point();},'preScale',function(){return this.preScale=new Point();}
	]);
	return SimpleResizer;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.ResTools
var ResTools=(function(){
	function ResTools(){}
	__class(ResTools,'laya.debug.tools.ResTools');
	ResTools.getCachedResList=function(){
		if (Render.isWebGL){
			return ResTools.getWebGlResList();
			}else{
			return ResTools.getCanvasResList();
		}
	}

	ResTools.getWebGlResList=function(){
		var rst;
		rst=[];
		var tResource;
		var _resources;
		_resources=ResourceManager.currentResourceManager["_resources"];
		for(var i=0;i <_resources.length;i++){
			tResource=_resources[i];
			if(ClassTool.getClassName(tResource)=="WebGLImage"){
				var url=tResource["src"];
				if(url&&url.indexOf("data:image/png;base64")<0)
					rst.push(url);
			}
		}
		return rst;
	}

	ResTools.getCanvasResList=function(){
		var picDic;
		picDic={};
		var dataO;
		dataO=Loader.loadedMap;
		ResTools.collectPics(dataO,picDic);
		return ResTools.getArrFromDic(picDic);
	}

	ResTools.getArrFromDic=function(dic){
		var key;
		var rst;
		rst=[];
		for (key in dic){
			rst.push(key);
		}
		return rst;
	}

	ResTools.collectPics=function(dataO,picDic){
		if (!dataO)return;
		var key;
		var tTexture;
		for (key in dataO){
			tTexture=dataO[key];
			if (tTexture){
				if (tTexture.bitmap&&tTexture.bitmap.src){
					var url=tTexture.bitmap.src;
					if(url.indexOf("data:image/png;base64")<0)
						picDic[tTexture.bitmap.src]=true;
				}
			}
		}
	}

	return ResTools;
})()


/**
*类实例创建分析工具
*@author ww
*@version 1.0
*
*@created 2015-9-25 下午3:31:46
*/
//class laya.debug.tools.RunProfile
var RunProfile=(function(){
	function RunProfile(){}
	__class(RunProfile,'laya.debug.tools.RunProfile');
	RunProfile.run=function(funName,callLen){
		(callLen===void 0)&& (callLen=3);
		var tCount;
		if(!RunProfile.infoDic.hasOwnProperty(funName)){
			RunProfile.infoDic[funName]=new CountTool();
		}
		tCount=RunProfile.infoDic[funName];
		var msg;
		msg=TraceTool.getCallLoc(callLen)+"\n"+TraceTool.getCallStack(1,callLen-3);
		tCount.add(msg);
		if(RunProfile._runShowDic[funName]){
			console.log("Create:"+funName);
			console.log(msg);
		}
	}

	RunProfile.showClassCreate=function(funName){
		RunProfile._runShowDic[funName]=true;
	}

	RunProfile.hideClassCreate=function(funName){
		RunProfile._runShowDic[funName]=false;
	}

	RunProfile.getRunInfo=function(funName){
		var rst;
		rst=RunProfile.infoDic[funName];
		if(rst){
		}
		return RunProfile.infoDic[funName];
	}

	RunProfile.runTest=function(fun,count,sign){
		(sign===void 0)&& (sign="runTest");
		DTrace.timeStart(sign);
		var i=0;
		for(i=0;i<count;i++){
			fun();
		}
		DTrace.timeEnd(sign);
	}

	RunProfile.runTest2=function(fun,count,sign){
		(sign===void 0)&& (sign="runTest");
		var preTime=NaN;
		preTime=Browser.now();
		var i=0;
		for(i=0;i<count;i++){
			fun();
		}
		return Browser.now()-preTime;
	}

	RunProfile.infoDic={};
	RunProfile._runShowDic={};
	return RunProfile;
})()


/**
*一些字符串操作函数
*@author ww
*
*/
//class laya.debug.tools.StringTool
var StringTool=(function(){
	function StringTool(){}
	__class(StringTool,'laya.debug.tools.StringTool');
	StringTool.toUpCase=function(str){
		return str.toUpperCase();
	}

	StringTool.toLowCase=function(str){
		return str.toLowerCase();
	}

	StringTool.toUpHead=function(str){
		var rst;
		if(str.length<=1)return str.toUpperCase();
		rst=str.charAt(0).toUpperCase()+str.substr(1);
		return rst;
	}

	StringTool.toLowHead=function(str){
		var rst;
		if(str.length<=1)return str.toLowerCase();
		rst=str.charAt(0).toLowerCase()+str.substr(1);
		return rst;
	}

	StringTool.packageToFolderPath=function(packageName){
		var rst;
		rst=packageName.replace(".","/");
		return rst;
	}

	StringTool.insert=function(str,iStr,index){
		return str.substring(0,index)+iStr+str.substr(index);
	}

	StringTool.insertAfter=function(str,iStr,tarStr,isLast){
		(isLast===void 0)&& (isLast=false);
		var i=0;
		if(isLast){
			i=str.lastIndexOf(tarStr);
			}else{
			i=str.indexOf(tarStr);
		}
		if(i>=0){
			return StringTool.insert(str,iStr,i+tarStr.length);
		}
		return str;
	}

	StringTool.insertBefore=function(str,iStr,tarStr,isLast){
		(isLast===void 0)&& (isLast=false);
		var i=0;
		if(isLast){
			i=str.lastIndexOf(tarStr);
			}else{
			i=str.indexOf(tarStr);
		}
		if(i>=0){
			return StringTool.insert(str,iStr,i);
		}
		return str;
	}

	StringTool.insertParamToFun=function(funStr,params){
		var oldParam;
		oldParam=StringTool.getParamArr(funStr);
		var inserStr;
		inserStr=params.join(",");
		if(oldParam.length>0){
			inserStr=","+inserStr;
		}
		return StringTool.insertBefore(funStr,inserStr,")",true);
	}

	StringTool.trim=function(str,vList){
		if(!vList){
			vList=[" ","\r","\n","\t",String.fromCharCode(65279)];
		};
		var rst;
		var i=0;
		var len=0;
		rst=str;
		len=vList.length;
		for(i=0;i<len;i++){
			rst=StringTool.getReplace(rst,vList[i],"");
		}
		return rst;
	}

	StringTool.isEmpty=function(str){
		if(str.length<1)return true;
		return StringTool.emptyStrDic.hasOwnProperty(str);
	}

	StringTool.trimLeft=function(str){
		var i=0;
		i=0;
		var len=0;
		len=str.length;
		while(StringTool.isEmpty(str.charAt(i))&&i<len){
			i++;
		}
		if(i<len){
			return str.substr(i);
		}
		return "";
	}

	StringTool.trimRight=function(str){
		var i=0;
		i=str.length-1;
		while(StringTool.isEmpty(str.charAt(i))&&i>=0){
			i--;
		};
		var rst;
		rst=str.substring(0,i)
		if(i>=0){
			return str.substring(0,i+1);
		}
		return "";
	}

	StringTool.trimSide=function(str){
		var rst;
		rst=StringTool.trimLeft(str);
		rst=StringTool.trimRight(rst);
		return rst;
	}

	StringTool.isOkFileName=function(fileName){
		if(laya.debug.tools.StringTool.trimSide(fileName)=="")return false;
		var i=0,len=0;
		len=fileName.length;
		for(i=0;i<len;i++){
			if(StringTool.specialChars[fileName.charAt(i)])return false;
		}
		return true;
	}

	StringTool.trimButEmpty=function(str){
		return StringTool.trim(str,["\r","\n","\t"]);
	}

	StringTool.removeEmptyStr=function(strArr){
		var i=0;
		i=strArr.length-1;
		var str;
		for(i=i;i>=0;i--){
			str=strArr[i];
			str=laya.debug.tools.StringTool.trimSide(str);
			if(StringTool.isEmpty(str)){
				strArr.splice(i,1);
				}else{
				strArr[i]=str;
			}
		}
		return strArr;
	}

	StringTool.ifNoAddToTail=function(str,sign){
		if(str.indexOf(sign)>=0){
			return str;
		}
		return str+sign;
	}

	StringTool.trimEmptyLine=function(str){
		var i=0;
		var len=0;
		var tLines;
		var tLine;
		tLines=str.split("\n");
		for(i=tLines.length-1;i>=0;i--){
			tLine=tLines[i];
			if(StringTool.isEmptyLine(tLine)){
				tLines.splice(i,1);
			}
		}
		return tLines.join("\n");
	}

	StringTool.isEmptyLine=function(str){
		str=laya.debug.tools.StringTool.trim(str);
		if(str=="")return true;
		return false;
	}

	StringTool.removeCommentLine=function(lines){
		var rst;
		rst=[];
		var i=0;
		var tLine;
		var adptLine;
		i=0;
		var len=0;
		var index=0;
		len=lines.length;
		while(i<len){
			adptLine=tLine=lines[i];
			index=tLine.indexOf("/**");
			if(index>=0){
				adptLine=tLine.substring(0,index-1);
				StringTool.addIfNotEmpty(rst,adptLine);
				while(i<len){
					tLine=lines[i];
					index=tLine.indexOf("*/");
					if(index>=0){
						adptLine=tLine.substring(index+2);
						StringTool.addIfNotEmpty(rst,adptLine);
						break ;
					}
					i++;
				}
				}else if(tLine.indexOf("//")>=0){
				if(laya.debug.tools.StringTool.trim(tLine).indexOf("//")==0){
					}else{
					StringTool.addIfNotEmpty(rst,adptLine);
				}
				}else{
				StringTool.addIfNotEmpty(rst,adptLine);
			}
			i++;
		}
		return rst;
	}

	StringTool.addIfNotEmpty=function(arr,str){
		if(!str)return;
		var tStr;
		tStr=StringTool.trim(str);
		if(tStr!=""){
			arr.push(str);
		}
	}

	StringTool.trimExt=function(str,vars){
		var rst;
		rst=StringTool.trim(str);
		var i=0;
		var len=0;
		len=vars.length;
		for(i=0;i<len;i++){
			rst=StringTool.getReplace(rst,vars[i],"");
		}
		return rst;
	}

	StringTool.getBetween=function(str,left,right,ifMax){
		(ifMax===void 0)&& (ifMax=false);
		if(!str)return "";
		if(!left)return "";
		if(!right)return "";
		var lId=0;
		var rId=0;
		lId=str.indexOf(left);
		if(lId<0)return"";
		if(ifMax){
			rId=str.lastIndexOf(right);
			if(rId<lId)return "";
			}else{
			rId=str.indexOf(right,lId+1);
		}
		if(rId<0)return "";
		return str.substring(lId+left.length,rId);
	}

	StringTool.getSplitLine=function(line,split){
		(split===void 0)&& (split=" ");
		return line.split(split);
	}

	StringTool.getLeft=function(str,sign){
		var i=0;
		i=str.indexOf(sign);
		return str.substr(0,i);
	}

	StringTool.getRight=function(str,sign){
		var i=0;
		i=str.indexOf(sign);
		return str.substr(i+1);
	}

	StringTool.delelteItem=function(arr){
		while (arr.length>0){
			if(arr[0]==""){
				arr.shift();
				}else{
				break ;
			}
		}
	}

	StringTool.getWords=function(line){
		var rst=StringTool.getSplitLine(line);
		StringTool.delelteItem(rst);
		return rst;
	}

	StringTool.getLinesI=function(startLine,endLine,lines){
		var i=0;
		var rst=[];
		for(i=startLine;i<=endLine;i++){
			rst.push(lines[i]);
		}
		return rst;
	}

	StringTool.structfy=function(str,inWidth,removeEmpty){
		(inWidth===void 0)&& (inWidth=4);
		(removeEmpty===void 0)&& (removeEmpty=true);
		if(removeEmpty){
			str=laya.debug.tools.StringTool.trimEmptyLine(str);
		};
		var lines;
		var tIn=0;
		tIn=0;
		var tInStr;
		tInStr=StringTool.getEmptyStr(0);
		lines=str.split("\n");
		var i=0;
		var len=0;
		var tLineStr;
		len=lines.length;
		for(i=0;i<len;i++){
			tLineStr=lines[i];
			tLineStr=laya.debug.tools.StringTool.trimLeft(tLineStr);
			tLineStr=laya.debug.tools.StringTool.trimRight(tLineStr);
			tIn+=StringTool.getPariCount(tLineStr);
			if(tLineStr.indexOf("}")>=0){
				tInStr=StringTool.getEmptyStr(tIn*inWidth);
			}
			tLineStr=tInStr+tLineStr;
			lines[i]=tLineStr;
			tInStr=StringTool.getEmptyStr(tIn*inWidth);
		}
		return lines.join("\n");
	}

	StringTool.getEmptyStr=function(width){
		if(!StringTool.emptyDic.hasOwnProperty(width)){
			var i=0;
			var len=0;
			len=width;
			var rst;
			rst="";
			for(i=0;i<len;i++){
				rst+=" ";
			}
			StringTool.emptyDic[width]=rst;
		}
		return StringTool.emptyDic[width];
	}

	StringTool.getPariCount=function(str,inChar,outChar){
		(inChar===void 0)&& (inChar="{");
		(outChar===void 0)&& (outChar="}");
		var varDic;
		varDic={};
		varDic[inChar]=1;
		varDic[outChar]=-1;
		var i=0;
		var len=0;
		var tChar;
		len=str.length;
		var rst=0;
		rst=0;
		for(i=0;i<len;i++){
			tChar=str.charAt(i);
			if(varDic.hasOwnProperty(tChar)){
				rst+=varDic[tChar];
			}
		}
		return rst;
	}

	StringTool.readInt=function(str,startI){
		(startI===void 0)&& (startI=0);
		var rst=NaN;
		rst=0;
		var tNum=0;
		var tC;
		var i=0;
		var isBegin=false;
		isBegin=false;
		var len=0;
		len=str.length;
		for(i=startI;i<len;i++){
			tC=str.charAt(i);
			if(Number(tC)>0||tC=="0"){
				rst=10*rst+Number(tC);
				if(rst>0)isBegin=true;
				}else{
				if(isBegin)return rst;
			}
		}
		return rst;
	}

	StringTool.getReplace=function(str,oStr,nStr){
		if(!str)return "";
		var rst;
		rst=str.replace(new RegExp(oStr,"g"),nStr);
		return rst;
	}

	StringTool.getWordCount=function(str,findWord){
		var rg=new RegExp(findWord,"g")
		return str.match(rg).length;
	}

	StringTool.getResolvePath=function(path,basePath){
		if(StringTool.isAbsPath(path)){
			return path;
		};
		var tSign;
		tSign="\\";
		if(basePath.indexOf("/")>=0){
			tSign="/";
		}
		if(basePath.charAt(basePath.length-1)==tSign){
			basePath=basePath.substr(0,basePath.length-1);
		};
		var parentSign;
		parentSign=".."+tSign;
		var tISign;
		tISign="."+tSign;
		var pCount=0;
		pCount=StringTool.getWordCount(path,parentSign);
		path=laya.debug.tools.StringTool.getReplace(path,parentSign,"");
		path=laya.debug.tools.StringTool.getReplace(path,tISign,"");
		var i=0;
		var len=0;
		len=pCount;
		var iPos=0;
		for(i=0;i<len;i++){
			basePath=StringTool.removeLastSign(path,tSign);
		}
		return basePath+tSign+path;
	}

	StringTool.isAbsPath=function(path){
		if(path.indexOf(":")>=0)return true;
		return false;
	}

	StringTool.removeLastSign=function(str,sign){
		var iPos=0;
		iPos=str.lastIndexOf(sign);
		str=str.substring(0,iPos);
		return str;
	}

	StringTool.getParamArr=function(str){
		var paramStr;
		paramStr=laya.debug.tools.StringTool.getBetween(str,"(",")",true);
		if(StringTool.trim(paramStr).length<1)return [];
		return paramStr.split(",");
	}

	StringTool.copyStr=function(str){
		return str.substring();
	}

	StringTool.ArrayToString=function(arr){
		var rst;
		rst="[{items}]".replace(new RegExp("\\{items\\}","g"),StringTool.getArrayItems(arr));
		return rst;
	}

	StringTool.getArrayItems=function(arr){
		var rst;
		if(arr.length<1)return "";
		rst=StringTool.parseItem(arr[0]);
		var i=0;
		var len=0;
		len=arr.length;
		for(i=1;i<len;i++){
			rst+=","+StringTool.parseItem(arr[i]);
		}
		return rst;
	}

	StringTool.parseItem=function(item){
		var rst;
		rst="\""+item+"\"";
		return "";
	}

	StringTool.initAlphaSign=function(){
		if (StringTool.alphaSigns)return;
		StringTool.alphaSigns={};
		StringTool.addSign("a","z",StringTool.alphaSigns);
		StringTool.addSign("A","Z",StringTool.alphaSigns);
		StringTool.addSign("0","9",StringTool.alphaSigns);
	}

	StringTool.addSign=function(ss,e,tar){
		var i=0;
		var len=0;
		var s=0;
		s=ss.charCodeAt(0);
		len=e.charCodeAt(0);
		for(i=s;i<=len;i++){
			tar[String.fromCharCode(i)]=true;
			console.log("add :"+String.fromCharCode(i));
		}
	}

	StringTool.isPureAlphaNum=function(str){
		StringTool.initAlphaSign();
		if (!str)return true;
		var i=0,len=0;
		len=str.length;
		for (i=0;i < len;i++){
			if (!StringTool.alphaSigns[str.charAt(i)])return false;
		}
		return true;
	}

	StringTool.emptyDic={};
	StringTool.alphaSigns=null;
	__static(StringTool,
	['emptyStrDic',function(){return this.emptyStrDic={
			" ":true,
			"\r":true,
			"\n":true,
			"\t":true
	};},'specialChars',function(){return this.specialChars={"*":true,"&":true,"%":true,"#":true,"?":true};}

	]);
	return StringTool;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-9-25 上午10:48:54
*/
//class laya.debug.tools.TraceTool
var TraceTool=(function(){
	function TraceTool(){}
	__class(TraceTool,'laya.debug.tools.TraceTool');
	TraceTool.closeAllLog=function(){
		var logFun;
		logFun=TraceTool.emptyLog;
		Browser.window.console.log=logFun;
	}

	TraceTool.emptyLog=function(){}
	TraceTool.traceObj=function(obj){
		TraceTool.tempArr.length=0;
		var key;
		for(key in obj){
			TraceTool.tempArr.push(key+":"+obj[key]);
		};
		var rst;
		rst=TraceTool.tempArr.join("\n");
		console.log(rst);
		return rst;
	}

	TraceTool.traceObjR=function(obj){
		TraceTool.tempArr.length=0;
		var key;
		for(key in obj){
			TraceTool.tempArr.push(obj[key]+":"+key);
		};
		var rst;
		rst=TraceTool.tempArr.join("\n");
		console.log(rst);
		return rst;
	}

	TraceTool.traceSize=function(tar){
		DebugTool.dTrace("Size: x:"+tar.x+" y:"+tar.y+" w:"+tar.width+" h:"+tar.height+" scaleX:"+tar.scaleX+" scaleY:"+tar.scaleY);
	}

	TraceTool.traceSplit=function(msg){
		console.log("---------------------"+msg+"---------------------------");
	}

	TraceTool.group=function(gName){
		console.group(gName);;
	}

	TraceTool.groupEnd=function(){
		console.groupEnd();;
	}

	TraceTool.getCallStack=function(life,s){
		(life===void 0)&& (life=1);
		(s===void 0)&& (s=1);
		var caller;
		caller=TraceTool.getCallStack;
		caller=caller.caller.caller;
		var msg;
		msg="";
		while(caller&&life>0){
			if(s<=0){
				msg+=caller+"<-";
				life--;
				}else{
			}
			caller=caller.caller;
			s--;
		}
		return msg;
	}

	TraceTool.getCallLoc=function(index){
		(index===void 0)&& (index=2);
		var loc;
		try {
			TraceTool.Erroer.i++;
			}catch (e){
			var arr;
			arr=e.stack.replace(/Error\n/).split(/\n/);
			if (arr[index]){
				loc=arr[index].replace(/^\s+|\s+$/,"");
				}else{
				loc="unknow";
			}
		}
		return loc;
	}

	TraceTool.traceCallStack=function(){
		var loc;
		try {
			TraceTool.Erroer.i++;
			}catch (e){
			loc=e.stack;
		}
		console.log(loc);
		return loc;
	}

	TraceTool.getPlaceHolder=function(len){
		if(!TraceTool.holderDic.hasOwnProperty(len)){
			var rst;
			rst="";
			var i=0;
			for(i=0;i<len;i++){
				rst+="-";
			}
			TraceTool.holderDic[len]=rst;
		}
		return TraceTool.holderDic[len];
	}

	TraceTool.traceTree=function(tar,depth,isFirst){
		(depth===void 0)&& (depth=0);
		(isFirst===void 0)&& (isFirst=true);
		if(isFirst){
			console.log("traceTree");
		}
		if(!tar)return;
		var i=0;
		var len=0;
		if(tar.numChildren<1){
			console.log(tar);
			return;
		}
		TraceTool.group(tar);
		len=tar.numChildren;
		depth++;
		for(i=0;i<len;i++){
			TraceTool.traceTree(tar.getChildAt(i),depth,false);
		}
		TraceTool.groupEnd();
	}

	TraceTool.getClassName=function(tar){
		return tar["constructor"].name;
	}

	TraceTool.traceSpriteInfo=function(tar,showBounds,showSize,showTree){
		(showBounds===void 0)&& (showBounds=true);
		(showSize===void 0)&& (showSize=true);
		(showTree===void 0)&& (showTree=true);
		if(!((tar instanceof laya.display.Sprite ))){
			console.log("not Sprite");
			return;
		}
		if(!tar){
			console.log("null Sprite");
			return;
		}
		TraceTool.traceSplit("traceSpriteInfo");
		DebugTool.dTrace(laya.debug.tools.TraceTool.getClassName(tar)+":"+tar.name);
		if(showTree){
			TraceTool.traceTree(tar);
			}else{
			console.log(tar);
		}
		if(showSize){
			TraceTool.traceSize(tar);
		}
		if(showBounds){
			console.log("bounds:"+tar.getBounds());
		}
	}

	TraceTool.tempArr=[];
	TraceTool.Erroer=null;
	TraceTool.holderDic={};
	return TraceTool;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-12-30 下午5:12:53
*/
//class laya.debug.tools.ValueChanger
var ValueChanger=(function(){
	function ValueChanger(){
		this.target=null;
		this.key=null;
		this._tValue=NaN;
		this.preValue=0;
	}

	__class(ValueChanger,'laya.debug.tools.ValueChanger');
	var __proto=ValueChanger.prototype;
	__proto.record=function(){
		this.preValue=this.value;
	}

	__proto.showValueByAdd=function(addValue){
		this.value=this.preValue+addValue;
	}

	__proto.showValueByScale=function(scale){
		this.value=this.preValue *scale;
	}

	__proto.recover=function(){
		this.value=this.preValue;
	}

	__proto.dispose=function(){
		this.target=null;
	}

	__getset(0,__proto,'value',function(){
		if(this.target){
			this._tValue=this.target[this.key];
		}
		return this._tValue;
		},function(nValue){
		this._tValue=nValue;
		if(this.target){
			this.target[this.key]=nValue;
		}
	});

	__getset(0,__proto,'dValue',function(){
		return this.value-this.preValue;
	});

	__getset(0,__proto,'scaleValue',function(){
		return this.value/this.preValue;
	});

	ValueChanger.create=function(target,key){
		var rst;
		rst=new ValueChanger();
		rst.target=target;
		rst.key=key;
		return rst;
	}

	return ValueChanger;
})()


/**
*...
*@author ww
*/
//class laya.debug.tools.VisibleAnalyser
var VisibleAnalyser=(function(){
	function VisibleAnalyser(){}
	__class(VisibleAnalyser,'laya.debug.tools.VisibleAnalyser');
	VisibleAnalyser.analyseTarget=function(node){
		var isInstage=false;
		isInstage=node.displayedInStage;
		var gRec;
		gRec=NodeUtils.getGRec(node);
		var stageRec=new Rectangle();
		stageRec.setTo(0,0,Laya.stage.width,Laya.stage.height);
		var isInVisibleRec=false;
		var visibleRec;
		visibleRec=stageRec.intersection(gRec);
		if (visibleRec.width > 0 && visibleRec.height > 0){
			isInVisibleRec=true;
		}
		else{
			isInVisibleRec=false;
		};
		var gAlpha=NaN;
		gAlpha=NodeUtils.getGAlpha(node);
		var gVisible=false;
		gVisible=NodeUtils.getGVisible(node);
		var msg;
		msg="";
		msg+="isInstage:"+isInstage+"\n";
		msg+="isInVisibleRec:"+isInVisibleRec+"\n";
		msg+="gVisible:"+gVisible+"\n";
		msg+="gAlpha:"+gAlpha+"\n";
		if (isInstage && isInVisibleRec && gVisible && gAlpha > 0){
			if (Render.isWebGL){
				VisibleAnalyser.anlyseRecVisible(node);
				}else{
				SpriteRenderForVisibleAnalyse.I.analyseNode(node);
			}
			msg+="coverRate:"+VisibleAnalyser.coverRate+"\n";
			if (VisibleAnalyser._coverList.length > 0){
				Laya.timer.once(1000,null,VisibleAnalyser.showListLater);
			}
		}
		console.log(msg);
		OutPutView.I.showTxt(msg);
	}

	VisibleAnalyser.showListLater=function(){
		NodeListPanelView.I.showList(VisibleAnalyser._coverList);
	}

	VisibleAnalyser.isCoverByBrother=function(node){
		var parent=node.parent;
		if (!parent)
			return;
		var _childs;
		_childs=parent._childs;
		var index=0;
		index=_childs.indexOf(node);
		if (index < 0)
			return;
		var i=0,len=0;
		var canvas;
		var rec;
		rec=parent.getSelfBounds();
		if (rec.width <=0 || rec.height <=0)
			return;
	}

	VisibleAnalyser.anlyseRecVisible=function(node){
		VisibleAnalyser.isNodeWalked=false;
		VisibleAnalyser._analyseTarget=node;
		if (!VisibleAnalyser.mainCanvas)
			VisibleAnalyser.mainCanvas=CanvasTools.createCanvas(Laya.stage.width,Laya.stage.height);
		CanvasTools.clearCanvas(VisibleAnalyser.mainCanvas);
		VisibleAnalyser.tColor=1;
		VisibleAnalyser.resetCoverList();
		WalkTools.walkTargetEX(Laya.stage,VisibleAnalyser.recVisibleWalker,null,VisibleAnalyser.filterFun);
		if (!VisibleAnalyser.isTarRecOK){
			VisibleAnalyser.coverRate=0;
		}
		else{
			VisibleAnalyser.coverRate=CanvasTools.getDifferRate(VisibleAnalyser.preImageData,VisibleAnalyser.tarImageData);
		}
		console.log("coverRate:",VisibleAnalyser.coverRate);
	}

	VisibleAnalyser.getRecArea=function(rec){
		return rec.width *rec.height;
	}

	VisibleAnalyser.addCoverNode=function(node,coverRate){
		var data;
		data={};
		data.path=node;
		data.label=ClassTool.getNodeClassAndName(node)+":"+coverRate;
		data.coverRate=coverRate;
		VisibleAnalyser._coverList.push(data);
		console.log("coverByNode:",node,coverRate);
	}

	VisibleAnalyser.resetCoverList=function(){
		VisibleAnalyser._coverList.length=0;
	}

	VisibleAnalyser.recVisibleWalker=function(node){
		if (node==VisibleAnalyser._analyseTarget){
			VisibleAnalyser.isNodeWalked=true;
			VisibleAnalyser.tarRec.copyFrom(NodeUtils.getGRec(node));
			console.log("tarRec:",VisibleAnalyser.tarRec.toString());
			if (VisibleAnalyser.tarRec.width > 0 && VisibleAnalyser.tarRec.height > 0){
				VisibleAnalyser.isTarRecOK=true;
				VisibleAnalyser.tColor++;
				CanvasTools.fillCanvasRec(VisibleAnalyser.mainCanvas,VisibleAnalyser.tarRec,ColorTool.toHexColor(VisibleAnalyser.tColor));
				VisibleAnalyser.preImageData=CanvasTools.getImageDataFromCanvasByRec(VisibleAnalyser.mainCanvas,VisibleAnalyser.tarRec);
				VisibleAnalyser.tarImageData=CanvasTools.getImageDataFromCanvasByRec(VisibleAnalyser.mainCanvas,VisibleAnalyser.tarRec);
			}
			else{
				console.log("tarRec Not OK:",VisibleAnalyser.tarRec);
			}
		}
		else{
			if (VisibleAnalyser.isTarRecOK){
				var tRec;
				tRec=NodeUtils.getGRec(node);
				VisibleAnalyser.interRec=VisibleAnalyser.tarRec.intersection(tRec,VisibleAnalyser.interRec);
				if (VisibleAnalyser.interRec && VisibleAnalyser.interRec.width > 0 && VisibleAnalyser.interRec.height > 0){
					VisibleAnalyser.tColor++;
					CanvasTools.fillCanvasRec(VisibleAnalyser.mainCanvas,tRec,ColorTool.toHexColor(VisibleAnalyser.tColor));
					VisibleAnalyser.tImageData=CanvasTools.getImageDataFromCanvasByRec(VisibleAnalyser.mainCanvas,VisibleAnalyser.tarRec);
					var dRate=NaN;
					dRate=CanvasTools.getDifferRate(VisibleAnalyser.preImageData,VisibleAnalyser.tImageData);
					VisibleAnalyser.preImageData=VisibleAnalyser.tImageData;
					VisibleAnalyser.addCoverNode(node,dRate);
				}
			}
		}
	}

	VisibleAnalyser.filterFun=function(node){
		if (node.visible==false)
			return false;
		if (node.alpha < 0)
			return false;
		if (DebugInfoLayer.I.isDebugItem(node))return false;
		return true;
	}

	VisibleAnalyser.isNodeWalked=false;
	VisibleAnalyser._analyseTarget=null;
	VisibleAnalyser.isTarRecOK=false;
	VisibleAnalyser.mainCanvas=null;
	VisibleAnalyser.preImageData=null;
	VisibleAnalyser.tImageData=null;
	VisibleAnalyser.tarImageData=null;
	VisibleAnalyser.coverRate=NaN;
	VisibleAnalyser.tColor=0;
	VisibleAnalyser._coverList=[];
	__static(VisibleAnalyser,
	['tarRec',function(){return this.tarRec=new Rectangle();},'interRec',function(){return this.interRec=new Rectangle();}
	]);
	return VisibleAnalyser;
})()


/**
*
*@author ww
*@version 1.0
*
*@created 2015-9-24 下午6:15:01
*/
//class laya.debug.tools.WalkTools
var WalkTools=(function(){
	function WalkTools(){}
	__class(WalkTools,'laya.debug.tools.WalkTools');
	WalkTools.walkTarget=function(target,fun,_this){
		fun.apply(_this,[target]);
		var i=0;
		var len=0;
		var tChild;
		len=target.numChildren;
		for(i=0;i<len;i++){
			tChild=target.getChildAt(i);
			WalkTools.walkTarget(tChild,fun,tChild);
		}
	}

	WalkTools.walkTargetEX=function(target,fun,_this,filterFun){
		if (filterFun !=null && !filterFun(target))return;
		fun.apply(_this,[target]);
		var i=0;
		var len=0;
		var tChild;
		var childs;
		childs=target._childs;
		len=childs.length;
		for(i=0;i<len;i++){
			tChild=childs[i];
			WalkTools.walkTarget(tChild,fun,tChild);
		}
	}

	WalkTools.walkChildren=function(target,fun,_this){
		if(!target||target.numChildren<1)return;
		WalkTools.walkArr(DisControlTool.getAllChild(target),fun,_this);
	}

	WalkTools.walkArr=function(arr,fun,_this){
		if(!arr)return;
		var i=0;
		var len=0;
		len=arr.length;
		for(i=0;i<len;i++){
			fun.apply(_this,[arr[i],i]);
		}
	}

	return WalkTools;
})()


/**
*本类用于监控对象值变化
*@author ww
*@version 1.0
*
*@created 2015-10-23 下午4:18:27
*/
//class laya.debug.tools.Watcher
var Watcher=(function(){
	function Watcher(){}
	__class(Watcher,'laya.debug.tools.Watcher');
	Watcher.watch=function(obj,name,funs){
		VarHook.hookVar(obj,name,funs);
	}

	Watcher.traceChange=function(obj,name,sign){
		(sign===void 0)&& (sign="var changed:");
		VarHook.hookVar(obj,name,[Watcher.getTraceValueFun(name),VarHook.getLocFun(sign)]);
	}

	Watcher.debugChange=function(obj,name){
		VarHook.hookVar(obj,name,[VarHook.getLocFun("debug loc"),FunHook.debugHere]);
	}

	Watcher.differChange=function(obj,name,sign,msg){
		(msg===void 0)&& (msg="");
		VarHook.hookVar(obj,name,[Watcher.getDifferFun(obj,name,sign,msg)]);
	}

	Watcher.getDifferFun=function(obj,name,sign,msg){
		(msg===void 0)&& (msg="");
		var rst;
		rst=function (){
			DifferTool.differ(sign,obj[name],msg);
		}
		return rst;
	}

	Watcher.traceValue=function(value){
		console.log("value:",value);
	}

	Watcher.getTraceValueFun=function(name){
		var rst;
		rst=function (value){
			console.log("set "+name+" :",value);
		}
		return rst;
	}

	return Watcher;
})()


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.menus.NodeMenu
var NodeMenu=(function(){
	function NodeMenu(){
		this._tar=null;
		this._menu=null;
		this._shareBtns=[
		"信息面板",
		"边框",
		"进入节点",
		"树定位",
		"Enable链",
		"Size链",
		"节点工具",
		"可见分析",
		"输出到控制台"];
		this._menuItems=["隐藏节点"];
		this._menuHide=null;
		this._menuItemsHide=["显示节点"];
		this._menu1=null;
		this._menuItems1=["输出到控制台"];
	}

	__class(NodeMenu,'laya.debug.view.nodeInfo.menus.NodeMenu');
	var __proto=NodeMenu.prototype;
	__proto.showNodeMenu=function(node){
		if (!node._style){
			DebugTool.log("该节点已不存在，请刷新列表");
			return;
		}
		this._tar=node;
		if (!this._menu){
			this._menuItems=this._menuItems.concat(this._shareBtns);
			this._menu=ContextMenu.createMenuByArray(this._menuItems);
			this._menu.on("select",this,this.onEmunSelect);
			this._menuItemsHide=this._menuItemsHide.concat(this._shareBtns);
			this._menuHide=ContextMenu.createMenuByArray(this._menuItemsHide);
			this._menuHide.on("select",this,this.onEmunSelect);
		}
		if (node.visible){
			this._menu.show();
		}
		else{
			this._menuHide.show();
		}
	}

	__proto.nodeDoubleClick=function(node){
		NodeToolView.I.showByNode(node);
	}

	__proto.setNodeListDoubleClickAction=function(list){
		if (Browser.onMobile)return;
		list.on("doubleclick",this,this.onListDoubleClick,[list]);
	}

	__proto.onListDoubleClick=function(list){
		if (list.selectedItem){
			var tarNode;
			tarNode=list.selectedItem.path;
			laya.debug.view.nodeInfo.menus.NodeMenu.I.nodeDoubleClick(tarNode);
		}
	}

	__proto.setNodeListAction=function(list){
		list.on(DebugTool.getMenuShowEvent(),this,this.onListRightClick,[list]);
	}

	//setNodeListDoubleClickAction(list);
	__proto.onListRightClick=function(list){
		if (list.selectedItem){
			var tarNode;
			tarNode=list.selectedItem.path;
			laya.debug.view.nodeInfo.menus.NodeMenu.I.objRightClick(tarNode);
		}
	}

	__proto.objRightClick=function(obj){
		if ((obj instanceof laya.display.Sprite )){
			laya.debug.view.nodeInfo.menus.NodeMenu.I.showNodeMenu(obj);
		}
		else if ((typeof obj=='object')){
			laya.debug.view.nodeInfo.menus.NodeMenu.I.showObjectMenu(obj);
		}
	}

	__proto.showObjectMenu=function(obj){
		this._tar=obj;
		if (!this._menu1){
			this._menu1=ContextMenu.createMenuByArray(this._menuItems1);
			this._menu1.on("select",this,this.onEmunSelect);
		}
		this._menu1.show();
	}

	__proto.onEmunSelect=function(e){
		var data=(e.target).data;
		if ((typeof data=='string')){
			var key;
			key=data;
			switch (key){
				case "信息面板":
					ObjectInfoView.showObject(this._tar);
					break ;
				case "边框":
					DebugTool.showDisBound(this._tar);
					break ;
				case "输出到控制台":
					console.log(this._tar);
					break ;
				case "树节点":
					ToolPanel.I.showNodeTree(this._tar);
					break ;
				case "进入节点":
					ToolPanel.I.showNodeTree(this._tar);
					break ;
				case "树定位":
					ToolPanel.I.showSelectInStage(this._tar);
					break ;
				case "Enable链":
					OutPutView.I.dTrace(DebugTool.traceDisMouseEnable(this._tar));
					SelectInfosView.I.setSelectList(DebugTool.selectedNodes);
					break ;
				case "Size链":
					OutPutView.I.dTrace(DebugTool.traceDisSizeChain(this._tar));
					SelectInfosView.I.setSelectList(DebugTool.selectedNodes);
					break ;
				case "节点工具":
					NodeToolView.I.showByNode(this._tar);
					break ;
				case "显示节点":
					this._tar.visible=true;
					break ;
				case "隐藏节点":
					this._tar.visible=false;
					break ;
				case "可见分析":
					if (this._tar){
						VisibleAnalyser.analyseTarget(this._tar);
					}
					break ;
				}
		}
	}

	__getset(1,NodeMenu,'I',function(){
		if (!NodeMenu._I)
			NodeMenu._I=new NodeMenu();
		return NodeMenu._I;
	});

	NodeMenu._I=null;
	return NodeMenu;
})()


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.NodeConsts
var NodeConsts=(function(){
	function NodeConsts(){}
	__class(NodeConsts,'laya.debug.view.nodeInfo.NodeConsts');
	NodeConsts.defaultFitlerStr="x,y,width,height,scaleX,scaleY,alpha,renderCost";
	NodeConsts.RenderCostMaxTime=3000;
	return NodeConsts;
})()


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.NodeUtils
var NodeUtils=(function(){
	function NodeUtils(){}
	__class(NodeUtils,'laya.debug.view.nodeInfo.NodeUtils');
	NodeUtils.getFilterdTree=function(sprite,keys){
		if (!keys)
			keys=NodeUtils.defaultKeys;
		var me;
		me={};
		var key;
		var i=0,len=0;
		len=keys.length;
		for (i=0;i < len;i++){
			key=keys[i];
			me[key]=sprite[key];
		};
		var cList;
		var tChild;
		cList=sprite._childs;
		len=cList.length;
		var mClist;
		mClist=[];
		for (i=0;i < len;i++){
			tChild=cList[i];
			mClist.push(NodeUtils.getFilterdTree(tChild,keys));
		}
		me.childs=mClist;
		return me;
	}

	NodeUtils.getPropertyDesO=function(tValue,keys){
		if (!keys)
			keys=NodeUtils.defaultKeys;
		var rst={};
		if ((typeof tValue=='object')){
			rst.label=""+ClassTool.getNodeClassAndName(tValue);
		}
		else{
			rst.label=""+tValue;
		}
		rst.type="";
		rst.path=tValue;
		rst.childs=[];
		rst.isDirectory=false;
		var key;
		var i=0,len=0;
		var tChild;
		if ((tValue instanceof laya.display.Node )){
			rst.des=ClassTool.getNodeClassAndName(tValue);
			rst.isDirectory=true;
			len=keys.length;
			for (i=0;i < len;i++){
				key=keys[i];
				tChild=NodeUtils.getPropertyDesO(tValue[key],keys);
				if (tValue.hasOwnProperty(key)){
					tChild.label=""+key+":"+tChild.des;
				}
				else{
					tChild.label=""+key+":"+ObjectInfoView.getNodeValue(tValue,key);
				}
				rst.childs.push(tChild);
			}
			key="_childs";
			tChild=NodeUtils.getPropertyDesO(tValue[key],keys);
			tChild.label=""+key+":"+tChild.des;
			tChild.isChilds=true;
			rst.childs.push(tChild);
		}
		else if ((tValue instanceof Array)){
			rst.des="Array["+(tValue).length+"]";
			rst.isDirectory=true;
			var tList;
			tList=tValue;
			len=tList.length;
			for (i=0;i < len;i++){
				tChild=NodeUtils.getPropertyDesO(tList[i],keys);
				tChild.label=""+i+":"+tChild.des;
				rst.childs.push(tChild);
			}
		}
		else if ((typeof tValue=='object')){
			rst.des=ClassTool.getNodeClassAndName(tValue);
			rst.isDirectory=true;
			for (key in tValue){
				tChild=NodeUtils.getPropertyDesO(tValue[key],keys);
				tChild.label=""+key+":"+tChild.des;
				rst.childs.push(tChild);
			}
		}
		else{
			rst.des=""+tValue;
		}
		rst.hasChild=rst.childs.length > 0;
		return rst;
	}

	NodeUtils.adptShowKeys=function(keys){
		var i=0,len=0;
		len=keys.length;
		for (i=len-1;i >=0;i--){
			keys[i]=StringTool.trimSide(keys[i]);
			if (keys[i].length < 1){
				keys.splice(i,1);
			}
		}
		return keys;
	}

	NodeUtils.getNodeTreeData=function(sprite,keys){
		NodeUtils.adptShowKeys(keys);
		var treeO;
		treeO=NodeUtils.getPropertyDesO(sprite,keys);
		var treeArr;
		treeArr=[];
		NodeUtils.getTreeArr(treeO,treeArr);
		return treeArr;
	}

	NodeUtils.getTreeArr=function(treeO,arr,add){
		(add===void 0)&& (add=true);
		if (add)
			arr.push(treeO);
		var tArr=treeO.childs;
		var i=0,len=tArr.length;
		for (i=0;i < len;i++){
			if (!add){
				tArr[i].nodeParent=null;
			}
			else{
				tArr[i].nodeParent=treeO;
			}
			if (tArr[i].isDirectory){
				NodeUtils.getTreeArr(tArr[i],arr);
			}
			else{
				arr.push(tArr[i]);
			}
		}
	}

	NodeUtils.traceStage=function(){
		console.log(NodeUtils.getFilterdTree(Laya.stage,null));
		console.log("treeArr:",NodeUtils.getNodeTreeData(Laya.stage,null));
	}

	NodeUtils.getNodeCount=function(node,visibleRequire){
		(visibleRequire===void 0)&& (visibleRequire=false);
		if (visibleRequire){
			if (!node.visible)return 0;
		};
		var rst=0;
		rst=1;
		var i=0,len=0;
		var cList;
		cList=node._childs;
		len=cList.length;
		for (i=0;i < len;i++){
			rst+=NodeUtils.getNodeCount(cList[i],visibleRequire);
		}
		return rst;
	}

	NodeUtils.getGVisible=function(node){
		while (node){
			if (!node.visible)return false;
			node=node.parent;
		}
		return true;
	}

	NodeUtils.getGAlpha=function(node){
		var rst=NaN;
		rst=1;
		while (node){
			rst *=node.alpha;
			node=node.parent;
		}
		return rst;
	}

	NodeUtils.getGPos=function(node){
		var point;
		point=new Point();
		node.localToGlobal(point);
		return point;
	}

	NodeUtils.getGRec=function(node){
		var pointList;
		pointList=node._getBoundPointsM(true);
		if (!pointList || pointList.length < 1)
			return Rectangle.TEMP.setTo(0,0,0,0);
		pointList=GrahamScan.pListToPointList(pointList,true);
		WalkTools.walkArr(pointList,node.localToGlobal,node);
		pointList=GrahamScan.pointListToPlist(pointList);
		var _disBoundRec;
		_disBoundRec=Rectangle._getWrapRec(pointList,_disBoundRec);
		return _disBoundRec;
	}

	NodeUtils.getGGraphicRec=function(node){
		var pointList;
		pointList=node.getGraphicBounds()._getBoundPoints();
		if (!pointList || pointList.length < 1)
			return Rectangle.TEMP.setTo(0,0,0,0);
		pointList=GrahamScan.pListToPointList(pointList,true);
		WalkTools.walkArr(pointList,node.localToGlobal,node);
		pointList=GrahamScan.pointListToPlist(pointList);
		var _disBoundRec;
		_disBoundRec=Rectangle._getWrapRec(pointList,_disBoundRec);
		return _disBoundRec;
	}

	NodeUtils.getNodeCmdCount=function(node){
		var rst=0;
		if (node.graphics){
			if (node.graphics.cmds){
				rst=node.graphics.cmds.length;
			}
			else{
				if (node.graphics._one){
					rst=1;
				}
				else{
					rst=0;
				}
			}
		}
		else{
			rst=0;
		}
		return rst;
	}

	NodeUtils.getNodeCmdTotalCount=function(node){
		var rst=0;
		var i=0,len=0;
		var cList;
		cList=node._childs;
		len=cList.length;
		rst=NodeUtils.getNodeCmdCount(node);
		for (i=0;i < len;i++){
			rst+=NodeUtils.getNodeCmdTotalCount(cList[i]);
		}
		return rst;
	}

	NodeUtils.getRenderNodeCount=function(node){
		if (node.cacheAs !="none")return 1;
		var rst=0;
		var i=0,len=0;
		var cList;
		cList=node._childs;
		len=cList.length;
		rst=1;
		for (i=0;i < len;i++){
			rst+=NodeUtils.getRenderNodeCount(cList[i]);
		}
		return rst;
	}

	NodeUtils.getReFreshRenderNodeCount=function(node){
		var rst=0;
		var i=0,len=0;
		var cList;
		cList=node._childs;
		len=cList.length;
		rst=1;
		for (i=0;i < len;i++){
			rst+=NodeUtils.getRenderNodeCount(cList[i]);
		}
		return rst;
	}

	NodeUtils.showCachedSpriteRecs=function(){
		NodeUtils.g=DebugInfoLayer.I.graphicLayer.graphics;
		NodeUtils.g.clear();
		WalkTools.walkTarget(Laya.stage,NodeUtils.drawCachedBounds,null);
	}

	NodeUtils.drawCachedBounds=function(sprite){
		if (sprite.cacheAs=="none")return;
		if (DebugInfoLayer.I.isDebugItem(sprite))return;
		var rec;
		rec=NodeUtils.getGRec(sprite);
		NodeUtils.g.drawRect(rec.x,rec.y,rec.width,rec.height,null,"#0000ff",2);
	}

	NodeUtils.g=null;
	__static(NodeUtils,
	['defaultKeys',function(){return this.defaultKeys=["x","y","width","height"];}
	]);
	return NodeUtils;
})()


/**
*...
*@author ww
*/
//class laya.debug.view.StyleConsts
var StyleConsts=(function(){
	function StyleConsts(){}
	__class(StyleConsts,'laya.debug.view.StyleConsts');
	StyleConsts.setViewScale=function(view){
		view.scaleX=view.scaleY=StyleConsts.PanelScale;
	}

	__static(StyleConsts,
	['PanelScale',function(){return this.PanelScale=Browser.onPC?1:Browser.pixelRatio;}
	]);
	return StyleConsts;
})()


/**
*<code>BitmapFont</code> 是位图字体类，用于定义位图字体信息。
*/
//class laya.display.BitmapFont
var BitmapFont=(function(){
	function BitmapFont(){
		this._texture=null;
		this._fontCharDic={};
		this._fontWidthMap={};
		this._complete=null;
		this._path=null;
		this._maxWidth=0;
		this._spaceWidth=10;
		this._padding=null;
		/**当前位图字体字号。*/
		this.fontSize=12;
		/**表示是否根据实际使用的字体大小缩放位图字体大小。*/
		this.autoScaleSize=false;
		/**字符间距（以像素为单位）。*/
		this.letterSpacing=0;
	}

	__class(BitmapFont,'laya.display.BitmapFont');
	var __proto=BitmapFont.prototype;
	/**
	*通过指定位图字体文件路径，加载位图字体文件，加载完成后会自动解析。
	*@param path 位图字体文件的路径。
	*@param complete 加载并解析完成的回调。如果成功返回this,如果失败返回null
	*/
	__proto.loadFont=function(path,complete){
		this._path=path;
		this._complete=complete;
		Laya.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],Handler.create(this,this.onLoaded));
	}

	/**
	*@private
	*/
	__proto.onLoaded=function(){
		this.parseFont(Loader.getRes(this._path),Loader.getRes(this._path.replace(".fnt",".png")));
		this._complete && this._complete.runWith(this._texture?this:null);
	}

	/**
	*解析字体文件。
	*@param xml 字体文件XML。
	*@param texture 字体的纹理。
	*/
	__proto.parseFont=function(xml,texture){
		if (xml==null || texture==null)return;
		this._texture=texture;
		var tX=0;
		var tScale=1;
		var tInfo=xml.getElementsByTagName("info");
		if (!tInfo[0].getAttributeNode){
			return this.parseFont2(xml,texture);
		}
		this.fontSize=parseInt(tInfo[0].getAttributeNode("size").nodeValue);
		var tPadding=tInfo[0].getAttributeNode("padding").nodeValue;
		var tPaddingArray=tPadding.split(",");
		this._padding=[parseInt(tPaddingArray[0]),parseInt(tPaddingArray[1]),parseInt(tPaddingArray[2]),parseInt(tPaddingArray[3])];
		var chars;
		chars=xml.getElementsByTagName("char");
		var i=0;
		for (i=0;i < chars.length;i++){
			var tAttribute=chars[i];
			var tId=parseInt(tAttribute.getAttributeNode("id").nodeValue);
			var xOffset=parseInt(tAttribute.getAttributeNode("xoffset").nodeValue)/ tScale;
			var yOffset=parseInt(tAttribute.getAttributeNode("yoffset").nodeValue)/ tScale;
			var xAdvance=parseInt(tAttribute.getAttributeNode("xadvance").nodeValue)/ tScale;
			var region=new Rectangle();
			region.x=parseInt(tAttribute.getAttributeNode("x").nodeValue);
			region.y=parseInt(tAttribute.getAttributeNode("y").nodeValue);
			region.width=parseInt(tAttribute.getAttributeNode("width").nodeValue);
			region.height=parseInt(tAttribute.getAttributeNode("height").nodeValue);
			var tTexture=Texture.create(texture,region.x,region.y,region.width,region.height,xOffset,yOffset);
			this._maxWidth=Math.max(this._maxWidth,xAdvance+this.letterSpacing);
			this._fontCharDic[tId]=tTexture;
			this._fontWidthMap[tId]=xAdvance;
		}
	}

	/**
	*@private
	*解析字体文件。
	*@param xml 字体文件XML。
	*@param texture 字体的纹理。
	*/
	__proto.parseFont2=function(xml,texture){
		if (xml==null || texture==null)return;
		this._texture=texture;
		var tX=0;
		var tScale=1;
		var tInfo=xml.getElementsByTagName("info");
		this.fontSize=parseInt(tInfo[0].attributes["size"].nodeValue);
		var tPadding=tInfo[0].attributes["padding"].nodeValue;
		var tPaddingArray=tPadding.split(",");
		this._padding=[parseInt(tPaddingArray[0]),parseInt(tPaddingArray[1]),parseInt(tPaddingArray[2]),parseInt(tPaddingArray[3])];
		var chars=xml.getElementsByTagName("char");
		var i=0;
		for (i=0;i < chars.length;i++){
			var tAttribute=chars[i].attributes;
			var tId=parseInt(tAttribute["id"].nodeValue);
			var xOffset=parseInt(tAttribute["xoffset"].nodeValue)/ tScale;
			var yOffset=parseInt(tAttribute["yoffset"].nodeValue)/ tScale;
			var xAdvance=parseInt(tAttribute["xadvance"].nodeValue)/ tScale;
			var region=new Rectangle();
			region.x=parseInt(tAttribute["x"].nodeValue);
			region.y=parseInt(tAttribute["y"].nodeValue);
			region.width=parseInt(tAttribute["width"].nodeValue);
			region.height=parseInt(tAttribute["height"].nodeValue);
			var tTexture=Texture.create(texture,region.x,region.y,region.width,region.height,xOffset,yOffset);
			this._maxWidth=Math.max(this._maxWidth,xAdvance+this.letterSpacing);
			this._fontCharDic[tId]=tTexture;
			this._fontWidthMap[tId]=xAdvance;
		}
	}

	/**
	*获取指定字符的字体纹理对象。
	*@param char 字符。
	*@return 指定的字体纹理对象。
	*/
	__proto.getCharTexture=function(char){
		return this._fontCharDic[char.charCodeAt(0)];
	}

	/**
	*销毁位图字体，调用Text.unregisterBitmapFont 时，默认会销毁。
	*/
	__proto.destroy=function(){
		if (this._texture){
			for (var p in this._fontCharDic){
				var tTexture=this._fontCharDic[p];
				if (tTexture)tTexture.destroy();
			}
			this._texture.destroy();
			this._fontCharDic=null;
			this._fontWidthMap=null;
			this._texture=null;
		}
	}

	/**
	*设置空格的宽（如果字体库有空格，这里就可以不用设置了）。
	*@param spaceWidth 宽度，单位为像素。
	*/
	__proto.setSpaceWidth=function(spaceWidth){
		this._spaceWidth=spaceWidth;
	}

	/**
	*获取指定字符的宽度。
	*@param char 字符。
	*@return 宽度。
	*/
	__proto.getCharWidth=function(char){
		var code=char.charCodeAt(0);
		if (this._fontWidthMap[code])return this._fontWidthMap[code]+this.letterSpacing;
		if (char==" ")return this._spaceWidth+this.letterSpacing;
		return 0;
	}

	/**
	*获取指定文本内容的宽度。
	*@param text 文本内容。
	*@return 宽度。
	*/
	__proto.getTextWidth=function(text){
		var tWidth=0;
		for (var i=0,n=text.length;i < n;i++){
			tWidth+=this.getCharWidth(text.charAt(i));
		}
		return tWidth;
	}

	/**
	*获取最大字符宽度。
	*/
	__proto.getMaxWidth=function(){
		return this._maxWidth;
	}

	/**
	*获取最大字符高度。
	*/
	__proto.getMaxHeight=function(){
		return this.fontSize;
	}

	/**
	*@private
	*将指定的文本绘制到指定的显示对象上。
	*/
	__proto.drawText=function(text,sprite,drawX,drawY,align,width){
		var tWidth=this.getTextWidth(text);
		var tTexture;
		var dx=0;
		align==="center" && (dx=(width-tWidth)/ 2);
		align==="right" && (dx=(width-tWidth));
		var tX=0;
		for (var i=0,n=text.length;i < n;i++){
			tTexture=this.getCharTexture(text.charAt(i));
			if (tTexture){
				sprite.graphics.drawTexture(tTexture,drawX+tX+dx,drawY);
				tX+=this.getCharWidth(text.charAt(i));
			}
		}
	}

	return BitmapFont;
})()


/**
*@private
*<code>Style</code> 类是元素样式定义类。
*/
//class laya.display.css.Style
var Style=(function(){
	function Style(){
		/**透明度。*/
		this.alpha=1;
		/**表示是否显示。*/
		this.visible=true;
		/**表示滚动区域。*/
		this.scrollRect=null;
		/**混合模式。*/
		this.blendMode=null;
		/**@private */
		this._type=0;
		this._tf=Style._TF_EMPTY;
	}

	__class(Style,'laya.display.css.Style');
	var __proto=Style.prototype;
	__proto.getTransform=function(){
		return this._tf;
	}

	__proto.setTransform=function(value){
		this._tf=value==='none' || !value ? Style._TF_EMPTY :value;
	}

	__proto.setTranslateX=function(value){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.translateX=value;
	}

	__proto.setTranslateY=function(value){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.translateY=value;
	}

	__proto.setScaleX=function(value){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.scaleX=value;
	}

	__proto.setScale=function(x,y){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.scaleX=x;
		this._tf.scaleY=y;
	}

	__proto.setScaleY=function(value){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.scaleY=value;
	}

	__proto.setRotate=function(value){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.rotate=value;
	}

	__proto.setSkewX=function(value){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.skewX=value;
	}

	__proto.setSkewY=function(value){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.skewY=value;
	}

	/**销毁此对象。*/
	__proto.destroy=function(){
		this.scrollRect=null;
	}

	/**@private */
	__proto.render=function(sprite,context,x,y){}
	/**@private */
	__proto.getCSSStyle=function(){
		return CSSStyle.EMPTY;
	}

	/**@private */
	__proto._enableLayout=function(){
		return false;
	}

	/**X 轴缩放值。*/
	__getset(0,__proto,'scaleX',function(){
		return this._tf.scaleX;
		},function(value){
		this.setScaleX(value);
	});

	/**元素应用的 2D 或 3D 转换的值。该属性允许我们对元素进行旋转、缩放、移动或倾斜。*/
	__getset(0,__proto,'transform',function(){
		return this.getTransform();
		},function(value){
		this.setTransform(value);
	});

	/**定义转换，只是用 X 轴的值。*/
	__getset(0,__proto,'translateX',function(){
		return this._tf.translateX;
		},function(value){
		this.setTranslateX(value);
	});

	/**定义转换，只是用 Y 轴的值。*/
	__getset(0,__proto,'translateY',function(){
		return this._tf.translateY;
		},function(value){
		this.setTranslateY(value);
	});

	/**Y 轴缩放值。*/
	__getset(0,__proto,'scaleY',function(){
		return this._tf.scaleY;
		},function(value){
		this.setScaleY(value);
	});

	/**表示元素是否显示为块级元素。*/
	__getset(0,__proto,'block',function(){
		return (this._type & 0x1)!=0;
	});

	/**定义沿着 Y 轴的 2D 倾斜转换。*/
	__getset(0,__proto,'skewY',function(){
		return this._tf.skewY;
		},function(value){
		this.setSkewY(value);
	});

	/**定义旋转角度。*/
	__getset(0,__proto,'rotate',function(){
		return this._tf.rotate;
		},function(value){
		this.setRotate(value);
	});

	/**定义沿着 X 轴的 2D 倾斜转换。*/
	__getset(0,__proto,'skewX',function(){
		return this._tf.skewX;
		},function(value){
		this.setSkewX(value);
	});

	/**表示元素的左内边距。*/
	__getset(0,__proto,'paddingLeft',function(){
		return 0;
	});

	/**表示元素的上内边距。*/
	__getset(0,__proto,'paddingTop',function(){
		return 0;
	});

	/**是否为绝对定位。*/
	__getset(0,__proto,'absolute',function(){
		return true;
	});

	Style.__init__=function(){
		Style._TF_EMPTY=new TransformInfo();
		Style.EMPTY=new Style();
	}

	Style.EMPTY=null;
	Style._TF_EMPTY=null;
	return Style;
})()


/**
*@private
*<code>Font</code> 类是字体显示定义类。
*/
//class laya.display.css.Font
var Font=(function(){
	function Font(src){
		this._type=0;
		this._weight=0;
		this._decoration=null;
		this._text=null;
		/**
		*首行缩进 （以像素为单位）。
		*/
		this.indent=0;
		this._color=Color$1.create(Font.defaultColor);
		this.family=Font.defaultFamily;
		this.stroke=Font._STROKE;
		this.size=Font.defaultSize;
		src && src!==Font.EMPTY && src.copyTo(this);
	}

	__class(Font,'laya.display.css.Font');
	var __proto=Font.prototype;
	/**
	*字体样式字符串。
	*/
	__proto.set=function(value){
		this._text=null;
		var strs=value.split(' ');
		for (var i=0,n=strs.length;i < n;i++){
			var str=strs[i];
			switch (str){
				case 'italic':
					this.italic=true;
					continue ;
				case 'bold':
					this.bold=true;
					continue ;
				}
			if (str.indexOf('px')> 0){
				this.size=parseInt(str);
				this.family=strs[i+1];
				i++;
				continue ;
			}
		}
	}

	/**
	*返回字体样式字符串。
	*@return 字体样式字符串。
	*/
	__proto.toString=function(){
		this._text=""
		this.italic && (this._text+="italic ");
		this.bold && (this._text+="bold ");
		return this._text+=this.size+"px "+this.family;
	}

	/**
	*将当前的属性值复制到传入的 <code>Font</code> 对象。
	*@param dec 一个 Font 对象。
	*/
	__proto.copyTo=function(dec){
		dec._type=this._type;
		dec._text=this._text;
		dec._weight=this._weight;
		dec._color=this._color;
		dec.family=this.family;
		dec.stroke=this.stroke !=Font._STROKE ? this.stroke.slice():Font._STROKE;
		dec.indent=this.indent;
		dec.size=this.size;
	}

	/**
	*表示是否为密码格式。
	*/
	__getset(0,__proto,'password',function(){
		return (this._type & 0x400)!==0;
		},function(value){
		value ? (this._type |=0x400):(this._type &=~0x400);
	});

	/**
	*表示颜色字符串。
	*/
	__getset(0,__proto,'color',function(){
		return this._color.strColor;
		},function(value){
		this._color=Color$1.create(value);
	});

	/**
	*表示是否为斜体。
	*/
	__getset(0,__proto,'italic',function(){
		return (this._type & 0x200)!==0;
		},function(value){
		value ? (this._type |=0x200):(this._type &=~0x200);
	});

	/**
	*表示是否为粗体。
	*/
	__getset(0,__proto,'bold',function(){
		return (this._type & 0x800)!==0;
		},function(value){
		value ? (this._type |=0x800):(this._type &=~0x800);
	});

	/**
	*文本的粗细。
	*/
	__getset(0,__proto,'weight',function(){
		return ""+this._weight;
		},function(value){
		var weight=0;
		switch (value){
			case 'normal':
				break ;
			case 'bold':
				this.bold=true;
				weight=700;
				break ;
			case 'bolder':
				weight=800;
				break ;
			case 'lighter':
				weight=100;
				break ;
			default :
				weight=parseInt(value);
			}
		this._weight=weight;
		this._text=null;
	});

	/**
	*规定添加到文本的修饰。
	*/
	__getset(0,__proto,'decoration',function(){
		return this._decoration ? this._decoration.value :"none";
		},function(value){
		var strs=value.split(' ');
		this._decoration || (this._decoration={});
		switch (strs[0]){
			case '_':
				this._decoration.type='underline'
				break ;
			case '-':
				this._decoration.type='line-through'
				break ;
			case 'overline':
				this._decoration.type='overline'
				break ;
			default :
				this._decoration.type=strs[0];
			}
		strs[1] && (this._decoration.color=Color$1.create(strs));
		this._decoration.value=value;
	});

	Font.__init__=function(){
		Font.EMPTY=new Font(null);
	}

	Font.EMPTY=null;
	Font.defaultColor="#000000";
	Font.defaultSize=12;
	Font.defaultFamily="Arial";
	Font.defaultFont="12px Arial";
	Font._STROKE=[0,"#000000"];
	Font._ITALIC=0x200;
	Font._PASSWORD=0x400;
	Font._BOLD=0x800;
	return Font;
})()


/**
*@private
*/
//class laya.display.css.TransformInfo
var TransformInfo=(function(){
	function TransformInfo(){
		this.translateX=0;
		this.translateY=0;
		this.scaleX=1;
		this.scaleY=1;
		this.rotate=0;
		this.skewX=0;
		this.skewY=0;
	}

	__class(TransformInfo,'laya.display.css.TransformInfo');
	return TransformInfo;
})()


/**
*@private
*Graphic bounds数据类
*/
//class laya.display.GraphicsBounds
var GraphicsBounds=(function(){
	function GraphicsBounds(){
		/**@private */
		//this._temp=null;
		/**@private */
		//this._bounds=null;
		/**@private */
		//this._rstBoundPoints=null;
		/**@private */
		this._cacheBoundsType=false;
		/**@private */
		//this._graphics=null;
	}

	__class(GraphicsBounds,'laya.display.GraphicsBounds');
	var __proto=GraphicsBounds.prototype;
	/**
	*销毁
	*/
	__proto.destroy=function(){
		this._graphics=null;
		this._temp=null;
		this._rstBoundPoints=null;
		this._bounds=null;
	}

	/**
	*重置数据
	*/
	__proto.reset=function(){
		this._temp && (this._temp.length=0);
	}

	/**
	*获取位置及宽高信息矩阵(比较耗CPU，频繁使用会造成卡顿，尽量少用)。
	*@param realSize （可选）使用图片的真实大小，默认为false
	*@return 位置与宽高组成的 一个 Rectangle 对象。
	*/
	__proto.getBounds=function(realSize){
		(realSize===void 0)&& (realSize=false);
		if (!this._bounds || !this._temp || this._temp.length < 1 || realSize !=this._cacheBoundsType){
			this._bounds=Rectangle._getWrapRec(this.getBoundPoints(realSize),this._bounds)
		}
		this._cacheBoundsType=realSize;
		return this._bounds;
	}

	/**
	*@private
	*@param realSize （可选）使用图片的真实大小，默认为false
	*获取端点列表。
	*/
	__proto.getBoundPoints=function(realSize){
		(realSize===void 0)&& (realSize=false);
		if (!this._temp || this._temp.length < 1 || realSize !=this._cacheBoundsType)
			this._temp=this._getCmdPoints(realSize);
		this._cacheBoundsType=realSize;
		return this._rstBoundPoints=Utils.copyArray(this._rstBoundPoints,this._temp);
	}

	__proto._getCmdPoints=function(realSize){
		(realSize===void 0)&& (realSize=false);
		var context=Render._context;
		var cmds=this._graphics.cmds;
		var rst;
		rst=this._temp || (this._temp=[]);
		rst.length=0;
		if (!cmds && this._graphics._one !=null){
			GraphicsBounds._tempCmds.length=0;
			GraphicsBounds._tempCmds.push(this._graphics._one);
			cmds=GraphicsBounds._tempCmds;
		}
		if (!cmds)
			return rst;
		var matrixs;
		matrixs=GraphicsBounds._tempMatrixArrays;
		matrixs.length=0;
		var tMatrix=GraphicsBounds._initMatrix;
		tMatrix.identity();
		var tempMatrix=GraphicsBounds._tempMatrix;
		var cmd;
		var tex;
		var wRate=NaN;
		var hRate=NaN;
		var oWidth=NaN;
		var oHeight=NaN;
		var offX=NaN;
		var offY=NaN;
		for (var i=0,n=cmds.length;i < n;i++){
			cmd=cmds[i];
			if (!cmd.callee)continue ;
			switch (cmd.callee){
				case context._save:
				case 7:
					matrixs.push(tMatrix);
					tMatrix=tMatrix.clone();
					break ;
				case context._restore:
				case 8:
					tMatrix=matrixs.pop();
					break ;
				case context._scale:
				case 5:
					tempMatrix.identity();
					tempMatrix.translate(-cmd[2],-cmd[3]);
					tempMatrix.scale(cmd[0],cmd[1]);
					tempMatrix.translate(cmd[2],cmd[3]);
					this._switchMatrix(tMatrix,tempMatrix);
					break ;
				case context._rotate:
				case 3:
					tempMatrix.identity();
					tempMatrix.translate(-cmd[1],-cmd[2]);
					tempMatrix.rotate(cmd[0]);
					tempMatrix.translate(cmd[1],cmd[2]);
					this._switchMatrix(tMatrix,tempMatrix);
					break ;
				case context._translate:
				case 6:
					tempMatrix.identity();
					tempMatrix.translate(cmd[0],cmd[1]);
					this._switchMatrix(tMatrix,tempMatrix);
					break ;
				case context._transform:
				case 4:
					tempMatrix.identity();
					tempMatrix.translate(-cmd[1],-cmd[2]);
					tempMatrix.concat(cmd[0]);
					tempMatrix.translate(cmd[1],cmd[2]);
					this._switchMatrix(tMatrix,tempMatrix);
					break ;
				case 16:
				case 24:
					GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[0],cmd[1],cmd[2],cmd[3]),tMatrix);
					break ;
				case 17:
					tMatrix.copyTo(tempMatrix);
					tempMatrix.concat(cmd[4]);
					GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[0],cmd[1],cmd[2],cmd[3]),tempMatrix);
					break ;
				case context._drawTexture:
					tex=cmd[0];
					if (realSize){
						if (cmd[3] && cmd[4]){
							GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],cmd[3],cmd[4]),tMatrix);
							}else {
							tex=cmd[0];
							GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],tex.width,tex.height),tMatrix);
						}
						}else {
						wRate=(cmd[3] || tex.sourceWidth)/ tex.width;
						hRate=(cmd[4] || tex.sourceHeight)/ tex.height;
						oWidth=wRate *tex.sourceWidth;
						oHeight=hRate *tex.sourceHeight;
						offX=tex.offsetX > 0 ? tex.offsetX :0;
						offY=tex.offsetY > 0 ? tex.offsetY :0;
						offX *=wRate;
						offY *=hRate;
						GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1]-offX,cmd[2]-offY,oWidth,oHeight),tMatrix);
					}
					break ;
				case context._fillTexture:
					if (cmd[3] && cmd[4]){
						GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],cmd[3],cmd[4]),tMatrix);
						}else {
						tex=cmd[0];
						GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],tex.width,tex.height),tMatrix);
					}
					break ;
				case context._drawTextureWithTransform:;
					var drawMatrix;
					if (cmd[5]){
						tMatrix.copyTo(tempMatrix);
						tempMatrix.concat(cmd[5]);
						drawMatrix=tempMatrix;
						}else {
						drawMatrix=tMatrix;
					}
					if (realSize){
						if (cmd[3] && cmd[4]){
							GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],cmd[3],cmd[4]),drawMatrix);
							}else {
							tex=cmd[0];
							GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],tex.width,tex.height),drawMatrix);
						}
						}else {
						tex=cmd[0];
						wRate=(cmd[3] || tex.sourceWidth)/ tex.width;
						hRate=(cmd[4] || tex.sourceHeight)/ tex.height;
						oWidth=wRate *tex.sourceWidth;
						oHeight=hRate *tex.sourceHeight;
						offX=tex.offsetX > 0 ? tex.offsetX :0;
						offY=tex.offsetY > 0 ? tex.offsetY :0;
						offX *=wRate;
						offY *=hRate;
						GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1]-offX,cmd[2]-offY,oWidth,oHeight),drawMatrix);
					}
					break ;
				case context._drawRect:
				case 13:
					GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[0],cmd[1],cmd[2],cmd[3]),tMatrix);
					break ;
				case context._drawCircle:
				case context._fillCircle:
				case 14:
					GraphicsBounds._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[0]-cmd[2],cmd[1]-cmd[2],cmd[2]+cmd[2],cmd[2]+cmd[2]),tMatrix);
					break ;
				case context._drawLine:
				case 20:
					GraphicsBounds._tempPoints.length=0;
					var lineWidth=NaN;
					lineWidth=cmd[5] *0.5;
					if (cmd[0]==cmd[2]){
						GraphicsBounds._tempPoints.push(cmd[0]+lineWidth,cmd[1],cmd[2]+lineWidth,cmd[3],cmd[0]-lineWidth,cmd[1],cmd[2]-lineWidth,cmd[3]);
						}else if (cmd[1]==cmd[3]){
						GraphicsBounds._tempPoints.push(cmd[0],cmd[1]+lineWidth,cmd[2],cmd[3]+lineWidth,cmd[0],cmd[1]-lineWidth,cmd[2],cmd[3]-lineWidth);
						}else {
						GraphicsBounds._tempPoints.push(cmd[0],cmd[1],cmd[2],cmd[3]);
					}
					GraphicsBounds._addPointArrToRst(rst,GraphicsBounds._tempPoints,tMatrix);
					break ;
				case context._drawCurves:
				case 22:
					GraphicsBounds._addPointArrToRst(rst,Bezier.I.getBezierPoints(cmd[2]),tMatrix,cmd[0],cmd[1]);
					break ;
				case context._drawPoly:
				case context._drawLines:
				case 18:
					GraphicsBounds._addPointArrToRst(rst,cmd[2],tMatrix,cmd[0],cmd[1]);
					break ;
				case context._drawPath:
				case 19:
					GraphicsBounds._addPointArrToRst(rst,this._getPathPoints(cmd[2]),tMatrix,cmd[0],cmd[1]);
					break ;
				case context._drawPie:
				case 15:
					GraphicsBounds._addPointArrToRst(rst,this._getPiePoints(cmd[0],cmd[1],cmd[2],cmd[3],cmd[4]),tMatrix);
					break ;
				}
		}
		if (rst.length > 200){
			rst=Utils.copyArray(rst,Rectangle._getWrapRec(rst)._getBoundPoints());
		}else if (rst.length > 8)
		rst=GrahamScan.scanPList(rst);
		return rst;
	}

	__proto._switchMatrix=function(tMatix,tempMatrix){
		tempMatrix.concat(tMatix);
		tempMatrix.copyTo(tMatix);
	}

	__proto._getPiePoints=function(x,y,radius,startAngle,endAngle){
		var rst=GraphicsBounds._tempPoints;
		GraphicsBounds._tempPoints.length=0;
		rst.push(x,y);
		var delta=(endAngle-startAngle)% (2 *Math.PI);
		var segnum=10;
		var step=delta / segnum;
		var i=NaN;
		var angle=startAngle;
		for (i=0;i <=segnum;i++){
			rst.push(x+radius *Math.cos(angle),y+radius *Math.sin(angle));
			angle+=step;
		}
		return rst;
	}

	__proto._getPathPoints=function(paths){
		var i=0,len=0;
		var rst=GraphicsBounds._tempPoints;
		rst.length=0;
		len=paths.length;
		var tCMD;
		for (i=0;i < len;i++){
			tCMD=paths[i];
			if (tCMD.length > 1){
				rst.push(tCMD[1],tCMD[2]);
				if (tCMD.length > 3){
					rst.push(tCMD[3],tCMD[4]);
				}
			}
		}
		return rst;
	}

	GraphicsBounds._addPointArrToRst=function(rst,points,matrix,dx,dy){
		(dx===void 0)&& (dx=0);
		(dy===void 0)&& (dy=0);
		var i=0,len=0;
		len=points.length;
		for (i=0;i < len;i+=2){
			GraphicsBounds._addPointToRst(rst,points[i]+dx,points[i+1]+dy,matrix);
		}
	}

	GraphicsBounds._addPointToRst=function(rst,x,y,matrix){
		var _tempPoint=Point.TEMP;
		_tempPoint.setTo(x ? x :0,y ? y :0);
		matrix.transformPoint(_tempPoint);
		rst.push(_tempPoint.x,_tempPoint.y);
	}

	GraphicsBounds._tempPoints=[];
	GraphicsBounds._tempMatrixArrays=[];
	GraphicsBounds._tempCmds=[];
	__static(GraphicsBounds,
	['_tempMatrix',function(){return this._tempMatrix=new Matrix();},'_initMatrix',function(){return this._initMatrix=new Matrix();}
	]);
	return GraphicsBounds;
})()


/**
*<code>Event</code> 是事件类型的集合。一般当发生事件时，<code>Event</code> 对象将作为参数传递给事件侦听器。
*/
//class laya.events.Event
var Event=(function(){
	function Event(){
		/**事件类型。*/
		//this.type=null;
		/**原生浏览器事件。*/
		//this.nativeEvent=null;
		/**事件目标触发对象。*/
		//this.target=null;
		/**事件当前冒泡对象。*/
		//this.currentTarget=null;
		/**@private */
		//this._stoped=false;
		/**分配给触摸点的唯一标识号（作为 int）。*/
		//this.touchId=0;
		/**键盘值*/
		//this.keyCode=0;
		/**滚轮滑动增量*/
		//this.delta=0;
	}

	__class(Event,'laya.events.Event');
	var __proto=Event.prototype;
	/**
	*设置事件数据。
	*@param type 事件类型。
	*@param currentTarget 事件目标触发对象。
	*@param target 事件当前冒泡对象。
	*@return 返回当前 Event 对象。
	*/
	__proto.setTo=function(type,currentTarget,target){
		this.type=type;
		this.currentTarget=currentTarget;
		this.target=target;
		return this;
	}

	/**
	*阻止对事件流中当前节点的后续节点中的所有事件侦听器进行处理。此方法不会影响当前节点 (currentTarget)中的任何事件侦听器。
	*/
	__proto.stopPropagation=function(){
		this._stoped=true;
	}

	/**鼠标在 Stage 上的 Y 轴坐标*/
	__getset(0,__proto,'stageY',function(){
		return Laya.stage.mouseY;
	});

	/**
	*包含按下或释放的键的字符代码值。字符代码值为英文键盘值。
	*/
	__getset(0,__proto,'charCode',function(){
		return this.nativeEvent.charCode;
	});

	/**
	*触摸点列表。
	*/
	__getset(0,__proto,'touches',function(){
		var arr=this.nativeEvent.touches;
		if (arr){
			var stage=Laya.stage;
			for (var i=0,n=arr.length;i < n;i++){
				var e=arr[i];
				var point=Point.TEMP;
				point.setTo(e.clientX,e.clientY);
				stage._canvasTransform.invertTransformPoint(point);
				stage.transform.invertTransformPoint(point);
				e.stageX=point.x;
				e.stageY=point.y;
			}
		}
		return arr;
	});

	/**
	*表示键在键盘上的位置。这对于区分在键盘上多次出现的键非常有用。<br>
	*例如，您可以根据此属性的值来区分左 Shift 键和右 Shift 键：左 Shift 键的值为 KeyLocation.LEFT，右 Shift 键的值为 KeyLocation.RIGHT。另一个示例是区分标准键盘 (KeyLocation.STANDARD)与数字键盘 (KeyLocation.NUM_PAD)上按下的数字键。
	*/
	__getset(0,__proto,'keyLocation',function(){
		return this.nativeEvent.keyLocation;
	});

	/**
	*表示 Ctrl 键是处于活动状态 (true)还是非活动状态 (false)。
	*/
	__getset(0,__proto,'ctrlKey',function(){
		return this.nativeEvent.ctrlKey;
	});

	/**
	*表示 Alt 键是处于活动状态 (true)还是非活动状态 (false)。
	*/
	__getset(0,__proto,'altKey',function(){
		return this.nativeEvent.altKey;
	});

	/**
	*表示 Shift 键是处于活动状态 (true)还是非活动状态 (false)。
	*/
	__getset(0,__proto,'shiftKey',function(){
		return this.nativeEvent.shiftKey;
	});

	/**鼠标在 Stage 上的 X 轴坐标*/
	__getset(0,__proto,'stageX',function(){
		return Laya.stage.mouseX;
	});

	Event.EMPTY=new Event();
	Event.MOUSE_DOWN="mousedown";
	Event.MOUSE_UP="mouseup";
	Event.CLICK="click";
	Event.RIGHT_MOUSE_DOWN="rightmousedown";
	Event.RIGHT_MOUSE_UP="rightmouseup";
	Event.RIGHT_CLICK="rightclick";
	Event.MOUSE_MOVE="mousemove";
	Event.MOUSE_OVER="mouseover";
	Event.MOUSE_OUT="mouseout";
	Event.MOUSE_WHEEL="mousewheel";
	Event.ROLL_OVER="mouseover";
	Event.ROLL_OUT="mouseout";
	Event.DOUBLE_CLICK="doubleclick";
	Event.CHANGE="change";
	Event.CHANGED="changed";
	Event.RESIZE="resize";
	Event.ADDED="added";
	Event.REMOVED="removed";
	Event.DISPLAY="display";
	Event.UNDISPLAY="undisplay";
	Event.ERROR="error";
	Event.COMPLETE="complete";
	Event.LOADED="loaded";
	Event.PROGRESS="progress";
	Event.INPUT="input";
	Event.RENDER="render";
	Event.OPEN="open";
	Event.MESSAGE="message";
	Event.CLOSE="close";
	Event.KEY_DOWN="keydown";
	Event.KEY_PRESS="keypress";
	Event.KEY_UP="keyup";
	Event.FRAME="enterframe";
	Event.DRAG_START="dragstart";
	Event.DRAG_MOVE="dragmove";
	Event.DRAG_END="dragend";
	Event.ENTER="enter";
	Event.SELECT="select";
	Event.BLUR="blur";
	Event.FOCUS="focus";
	Event.VISIBILITY_CHANGE="visibilitychange";
	Event.FOCUS_CHANGE="focuschange";
	Event.PLAYED="played";
	Event.PAUSED="paused";
	Event.STOPPED="stopped";
	Event.START="start";
	Event.END="end";
	Event.ENABLE_CHANGED="enablechanged";
	Event.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged";
	Event.COMPONENT_ADDED="componentadded";
	Event.COMPONENT_REMOVED="componentremoved";
	Event.LAYER_CHANGED="layerchanged";
	Event.HIERARCHY_LOADED="hierarchyloaded";
	Event.RECOVERED="recovered";
	Event.RELEASED="released";
	Event.LINK="link";
	Event.LABEL="label";
	Event.FULL_SCREEN_CHANGE="fullscreenchange";
	Event.DEVICE_LOST="devicelost";
	Event.MESH_CHANGED="meshchanged";
	Event.MATERIAL_CHANGED="materialchanged";
	Event.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged";
	Event.ANIMATION_CHANGED="animationchanged";
	Event.TRIGGER_ENTER="triggerenter";
	Event.TRIGGER_STAY="triggerstay";
	Event.TRIGGER_EXIT="triggerexit";
	Event.TRAIL_FILTER_CHANGE="trailfilterchange";
	Event.DOMINO_FILTER_CHANGE="dominofilterchange";
	return Event;
})()


/**
*<code>Keyboard</code> 类的属性是一些常数，这些常数表示控制游戏时最常用的键。
*/
//class laya.events.Keyboard
var Keyboard=(function(){
	function Keyboard(){}
	__class(Keyboard,'laya.events.Keyboard');
	Keyboard.NUMBER_0=48;
	Keyboard.NUMBER_1=49;
	Keyboard.NUMBER_2=50;
	Keyboard.NUMBER_3=51;
	Keyboard.NUMBER_4=52;
	Keyboard.NUMBER_5=53;
	Keyboard.NUMBER_6=54;
	Keyboard.NUMBER_7=55;
	Keyboard.NUMBER_8=56;
	Keyboard.NUMBER_9=57;
	Keyboard.A=65;
	Keyboard.B=66;
	Keyboard.C=67;
	Keyboard.D=68;
	Keyboard.E=69;
	Keyboard.F=70;
	Keyboard.G=71;
	Keyboard.H=72;
	Keyboard.I=73;
	Keyboard.J=74;
	Keyboard.K=75;
	Keyboard.L=76;
	Keyboard.M=77;
	Keyboard.N=78;
	Keyboard.O=79;
	Keyboard.P=80;
	Keyboard.Q=81;
	Keyboard.R=82;
	Keyboard.S=83;
	Keyboard.T=84;
	Keyboard.U=85;
	Keyboard.V=86;
	Keyboard.W=87;
	Keyboard.X=88;
	Keyboard.Y=89;
	Keyboard.Z=90;
	Keyboard.F1=112;
	Keyboard.F2=113;
	Keyboard.F3=114;
	Keyboard.F4=115;
	Keyboard.F5=116;
	Keyboard.F6=117;
	Keyboard.F7=118;
	Keyboard.F8=119;
	Keyboard.F9=120;
	Keyboard.F10=121;
	Keyboard.F11=122;
	Keyboard.F12=123;
	Keyboard.F13=124;
	Keyboard.F14=125;
	Keyboard.F15=126;
	Keyboard.NUMPAD=21;
	Keyboard.NUMPAD_0=96;
	Keyboard.NUMPAD_1=97;
	Keyboard.NUMPAD_2=98;
	Keyboard.NUMPAD_3=99;
	Keyboard.NUMPAD_4=100;
	Keyboard.NUMPAD_5=101;
	Keyboard.NUMPAD_6=102;
	Keyboard.NUMPAD_7=103;
	Keyboard.NUMPAD_8=104;
	Keyboard.NUMPAD_9=105;
	Keyboard.NUMPAD_ADD=107;
	Keyboard.NUMPAD_DECIMAL=110;
	Keyboard.NUMPAD_DIVIDE=111;
	Keyboard.NUMPAD_ENTER=108;
	Keyboard.NUMPAD_MULTIPLY=106;
	Keyboard.NUMPAD_SUBTRACT=109;
	Keyboard.SEMICOLON=186;
	Keyboard.EQUAL=187;
	Keyboard.COMMA=188;
	Keyboard.MINUS=189;
	Keyboard.PERIOD=190;
	Keyboard.SLASH=191;
	Keyboard.BACKQUOTE=192;
	Keyboard.LEFTBRACKET=219;
	Keyboard.BACKSLASH=220;
	Keyboard.RIGHTBRACKET=221;
	Keyboard.QUOTE=222;
	Keyboard.ALTERNATE=18;
	Keyboard.BACKSPACE=8;
	Keyboard.CAPS_LOCK=20;
	Keyboard.COMMAND=15;
	Keyboard.CONTROL=17;
	Keyboard.DELETE=46;
	Keyboard.ENTER=13;
	Keyboard.ESCAPE=27;
	Keyboard.PAGE_UP=33;
	Keyboard.PAGE_DOWN=34;
	Keyboard.END=35;
	Keyboard.HOME=36;
	Keyboard.LEFT=37;
	Keyboard.UP=38;
	Keyboard.RIGHT=39;
	Keyboard.DOWN=40;
	Keyboard.SHIFT=16;
	Keyboard.SPACE=32;
	Keyboard.TAB=9;
	Keyboard.INSERT=45;
	return Keyboard;
})()


/**
*<p><code>KeyBoardManager</code> 是键盘事件管理类。该类从浏览器中接收键盘事件，并派发该事件。</p>
*<p>派发事件时若 Stage.focus 为空则只从 Stage 上派发该事件，否则将从 Stage.focus 对象开始一直冒泡派发该事件。所以在 Laya.stage 上监听键盘事件一定能够收到，如果在其他地方监听，则必须处在Stage.focus的冒泡链上才能收到该事件。</p>
*<p>用户可以通过代码 Laya.stage.focus=someNode 的方式来设置focus对象。</p>
*<p>用户可统一的根据事件对象中 e.keyCode 来判断按键类型，该属性兼容了不同浏览器的实现。</p>
*/
//class laya.events.KeyBoardManager
var KeyBoardManager=(function(){
	function KeyBoardManager(){}
	__class(KeyBoardManager,'laya.events.KeyBoardManager');
	KeyBoardManager.__init__=function(){
		KeyBoardManager._addEvent("keydown");
		KeyBoardManager._addEvent("keypress");
		KeyBoardManager._addEvent("keyup");
	}

	KeyBoardManager._addEvent=function(type){
		Browser.document.addEventListener(type,function(e){
			laya.events.KeyBoardManager._dispatch(e,type);
		},true);
	}

	KeyBoardManager._dispatch=function(e,type){
		if (!KeyBoardManager.enabled)return;
		KeyBoardManager._event._stoped=false;
		KeyBoardManager._event.nativeEvent=e;
		KeyBoardManager._event.keyCode=e.keyCode || e.which || e.charCode;
		if (type==="keydown")KeyBoardManager._pressKeys[KeyBoardManager._event.keyCode]=true;
		else if (type==="keyup")KeyBoardManager._pressKeys[KeyBoardManager._event.keyCode]=null;
		var target=(Laya.stage.focus && (Laya.stage.focus.event !=null)&& Laya.stage.focus.displayedInStage)? Laya.stage.focus :Laya.stage;
		var ct=target;
		while (ct){
			ct.event(type,KeyBoardManager._event.setTo(type,ct,target));
			ct=ct.parent;
		}
	}

	KeyBoardManager.hasKeyDown=function(key){
		return KeyBoardManager._pressKeys[key];
	}

	KeyBoardManager._pressKeys={};
	KeyBoardManager.enabled=true;
	__static(KeyBoardManager,
	['_event',function(){return this._event=new Event();}
	]);
	return KeyBoardManager;
})()


/**
*<p><code>MouseManager</code> 是鼠标、触摸交互管理器。</p>
*<p>鼠标事件流包括捕获阶段、目标阶段、冒泡阶段。<br/>
*捕获阶段：此阶段引擎会从stage开始递归检测stage及其子对象，直到找到命中的目标对象或者未命中任何对象；<br/>
*目标阶段：找到命中的目标对象；<br/>
*冒泡阶段：事件离开目标对象，按节点层级向上逐层通知，直到到达舞台的过程。</p>
*/
//class laya.events.MouseManager
var MouseManager=(function(){
	function MouseManager(){
		/**canvas 上的鼠标X坐标。*/
		this.mouseX=0;
		/**canvas 上的鼠标Y坐标。*/
		this.mouseY=0;
		/**是否禁用除 stage 以外的鼠标事件检测。*/
		this.disableMouseEvent=false;
		/**鼠标按下的时间。单位为毫秒。*/
		this.mouseDownTime=0;
		/**鼠标移动精度。*/
		this.mouseMoveAccuracy=2;
		this._stage=null;
		this._target=null;
		this._lastMoveTimer=0;
		this._isLeftMouse=false;
		this._eventList=[];
		this._touchIDs={};
		this._id=1;
		this._tTouchID=0;
		this._event=new Event();
		this._matrix=new Matrix();
		this._point=new Point();
		this._rect=new Rectangle();
		this._prePoint=new Point();
		this._curTouchID=NaN;
	}

	__class(MouseManager,'laya.events.MouseManager');
	var __proto=MouseManager.prototype;
	/**
	*@private
	*初始化。
	*/
	__proto.__init__=function(stage,canvas){
		var _$this=this;
		this._stage=stage;
		var _this=this;
		var list=this._eventList;
		canvas.oncontextmenu=function (e){
			if (MouseManager.enabled)return false;
		}
		canvas.addEventListener('mousedown',function(e){
			if (MouseManager.enabled){
				if(!Browser.onIE)e.preventDefault();
				list.push(e);
				_this.mouseDownTime=Browser.now();
			}
		});
		canvas.addEventListener('mouseup',function(e){
			if (MouseManager.enabled){
				e.preventDefault();
				list.push(e);
				_this.mouseDownTime=-Browser.now();
			}
		},true);
		canvas.addEventListener('mousemove',function(e){
			if (MouseManager.enabled){
				e.preventDefault();
				var now=Browser.now();
				if (now-_this._lastMoveTimer < 10)return;
				_this._lastMoveTimer=now;
				list.push(e);
			}
		},true);
		canvas.addEventListener("mouseout",function(e){
			if (MouseManager.enabled)list.push(e);
		})
		canvas.addEventListener("mouseover",function(e){
			if (MouseManager.enabled)list.push(e);
		})
		canvas.addEventListener("touchstart",function(e){
			if (MouseManager.enabled){
				list.push(e);
				if (!MouseManager._isFirstTouch&&!Input.isInputting)e.preventDefault();
				_this.mouseDownTime=Browser.now();
			}
		});
		canvas.addEventListener("touchend",function(e){
			if (MouseManager.enabled){
				if (!MouseManager._isFirstTouch&&!Input.isInputting)e.preventDefault();
				MouseManager._isFirstTouch=false;
				list.push(e);
				_this.mouseDownTime=-Browser.now();
				}else {
				_$this._curTouchID=NaN;
			}
		},true);
		canvas.addEventListener("touchmove",function(e){
			if (MouseManager.enabled){
				e.preventDefault();
				list.push(e);
			}
		},true);
		canvas.addEventListener("touchcancel",function(e){
			if (MouseManager.enabled){
				e.preventDefault();
				list.push(e);
				}else {
				_$this._curTouchID=NaN;
			}
		},true);
		canvas.addEventListener('mousewheel',function(e){
			if (MouseManager.enabled)list.push(e);
		});
		canvas.addEventListener('DOMMouseScroll',function(e){
			if (MouseManager.enabled)list.push(e);
		});
	}

	__proto.initEvent=function(e,nativeEvent){
		var _this=this;
		_this._event._stoped=false;
		_this._event.nativeEvent=nativeEvent || e;
		_this._target=null;
		this._point.setTo(e.pageX || e.clientX,e.pageY || e.clientY);
		this._stage._canvasTransform.invertTransformPoint(this._point);
		_this.mouseX=this._point.x;
		_this.mouseY=this._point.y;
		_this._event.touchId=e.identifier || 0;
		this._tTouchID=_this._event.touchId;
		var evt;
		evt=TouchManager.I._event;
		evt._stoped=false;
		evt.nativeEvent=_this._event.nativeEvent;
		evt.touchId=_this._event.touchId;
	}

	__proto.checkMouseWheel=function(e){
		this._event.delta=e.wheelDelta ? e.wheelDelta *0.025 :-e.detail;
		var _lastOvers=TouchManager.I.getLastOvers();
		for (var i=0,n=_lastOvers.length;i < n;i++){
			var ele=_lastOvers[i];
			ele.event("mousewheel",this._event.setTo("mousewheel",ele,this._target));
		}
	}

	// _stage.event(Event.MOUSE_WHEEL,_event.setTo(Event.MOUSE_WHEEL,_stage,_target));
	__proto.onMouseMove=function(ele){
		TouchManager.I.onMouseMove(ele,this._tTouchID);
	}

	__proto.onMouseDown=function(ele){
		if (Input.isInputting && Laya.stage.focus && Laya.stage.focus["focus"] && !Laya.stage.focus.contains(this._target)){
			var pre_input=Laya.stage.focus['_tf'] || Laya.stage.focus;
			var new_input=ele['_tf'] || ele;
			if ((new_input instanceof laya.display.Input )&& new_input.multiline==pre_input.multiline)
				pre_input['_focusOut']();
			else
			pre_input.focus=false;
		}
		TouchManager.I.onMouseDown(ele,this._tTouchID,this._isLeftMouse);
	}

	__proto.onMouseUp=function(ele){
		TouchManager.I.onMouseUp(ele,this._tTouchID,this._isLeftMouse);
	}

	__proto.check=function(sp,mouseX,mouseY,callBack){
		this._point.setTo(mouseX,mouseY);
		sp.fromParentPoint(this._point);
		mouseX=this._point.x;
		mouseY=this._point.y;
		var scrollRect=sp.scrollRect;
		if (scrollRect){
			this._rect.setTo(scrollRect.x,scrollRect.y,scrollRect.width,scrollRect.height);
			if (!this._rect.contains(mouseX,mouseY))return false;
		}
		if (!this.disableMouseEvent){
			if (sp.hitTestPrior && !sp.mouseThrough && !this.hitTest(sp,mouseX,mouseY)){
				return false;
			}
			for (var i=sp._childs.length-1;i >-1;i--){
				var child=sp._childs[i];
				if (!child.destroyed && child.mouseEnabled && child.visible){
					if (this.check(child,mouseX,mouseY,callBack))return true;
				}
			}
		};
		var isHit=(sp.hitTestPrior && !sp.mouseThrough && !this.disableMouseEvent)? true :this.hitTest(sp,mouseX,mouseY);
		if (isHit){
			this._target=sp;
			callBack.call(this,sp);
			}else if (callBack===this.onMouseUp && sp===this._stage){
			this._target=this._stage;
			callBack.call(this,this._target);
		}
		return isHit;
	}

	__proto.hitTest=function(sp,mouseX,mouseY){
		var isHit=false;
		if (sp.scrollRect){
			mouseX-=sp.scrollRect.x;
			mouseY-=sp.scrollRect.y;
		}
		if ((sp.hitArea instanceof laya.utils.HitArea )){
			return sp.hitArea.isHit(mouseX,mouseY);
		}
		if (sp.width > 0 && sp.height > 0 || sp.mouseThrough || sp.hitArea){
			if (!sp.mouseThrough){
				var hitRect=this._rect;
				if (sp.hitArea)hitRect=sp.hitArea;
				else hitRect.setTo(0,0,sp.width,sp.height);
				isHit=hitRect.contains(mouseX,mouseY);
				}else {
				isHit=sp.getGraphicBounds().contains(mouseX,mouseY);
			}
		}
		return isHit;
	}

	/**
	*执行事件处理。
	*/
	__proto.runEvent=function(){
		var len=this._eventList.length;
		if (!len)return;
		var _this=this;
		var i=0,j=0,n=0,touch;
		while (i < len){
			var evt=this._eventList[i];
			if (evt.type!=='mousemove')this._prePoint.x=this._prePoint.y=-1000000;
			switch (evt.type){
				case 'mousedown':
					this._touchIDs[0]=this._id++;
					if (!MouseManager._isTouchRespond){
						_this._isLeftMouse=evt.button===0;
						_this.initEvent(evt);
						_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseDown);
					}else
					MouseManager._isTouchRespond=false;
					break ;
				case 'mouseup':
					_this._isLeftMouse=evt.button===0;
					_this.initEvent(evt);
					_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseUp);
					break ;
				case 'mousemove':
					if ((Math.abs(this._prePoint.x-evt.clientX)+Math.abs(this._prePoint.y-evt.clientY))>=this.mouseMoveAccuracy){
						this._prePoint.x=evt.clientX;
						this._prePoint.y=evt.clientY;
						_this.initEvent(evt);
						_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseMove);
					}
					break ;
				case "touchstart":
					MouseManager._isTouchRespond=true;
					_this._isLeftMouse=true;
					var touches=evt.changedTouches;
					for (j=0,n=touches.length;j < n;j++){
						touch=touches[j];
						if (MouseManager.multiTouchEnabled || isNaN(this._curTouchID)){
							this._curTouchID=touch.identifier;
							if (this._id % 200===0)this._touchIDs={};
							this._touchIDs[touch.identifier]=this._id++;
							_this.initEvent(touch,evt);
							_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseDown);
						}
					}
					break ;
				case "touchend":
				case "touchcancel":
					MouseManager._isTouchRespond=true;
					_this._isLeftMouse=true;
					var touchends=evt.changedTouches;
					for (j=0,n=touchends.length;j < n;j++){
						touch=touchends[j];
						if (MouseManager.multiTouchEnabled || touch.identifier==this._curTouchID){
							this._curTouchID=NaN;
							_this.initEvent(touch,evt);
							var isChecked=false;
							isChecked=_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseUp);
							if (!isChecked){
								_this.onMouseUp(null);
							}
						}
					}
					break ;
				case "touchmove":;
					var touchemoves=evt.changedTouches;
					for (j=0,n=touchemoves.length;j < n;j++){
						touch=touchemoves[j];
						if (MouseManager.multiTouchEnabled || touch.identifier==this._curTouchID){
							_this.initEvent(touch,evt);
							_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseMove);
						}
					}
					break ;
				case "wheel":
				case "mousewheel":
				case "DOMMouseScroll":
					_this.checkMouseWheel(evt);
					break ;
				case "mouseout":
					TouchManager.I.stageMouseOut();
					break ;
				case "mouseover":
					_this._stage.event("mouseover",_this._event.setTo("mouseover",_this._stage,_this._stage));
					break ;
				}
			i++;
		}
		this._eventList.length=0;
	}

	MouseManager.enabled=true;
	MouseManager.multiTouchEnabled=true;
	MouseManager._isTouchRespond=false;
	MouseManager._isFirstTouch=true;
	__static(MouseManager,
	['instance',function(){return this.instance=new MouseManager();}
	]);
	return MouseManager;
})()


/**
*@private
*Touch事件管理类，处理多点触控下的鼠标事件
*/
//class laya.events.TouchManager
var TouchManager=(function(){
	function TouchManager(){
		/**
		*当前over的touch表
		*/
		this.preOvers=[];
		/**
		*当前down的touch表
		*/
		this.preDowns=[];
		this.preRightDowns=[];
		/**
		*是否启用
		*/
		this.enable=true;
		this._lastClickTime=0;
		this._event=new Event();
	}

	__class(TouchManager,'laya.events.TouchManager');
	var __proto=TouchManager.prototype;
	__proto._clearTempArrs=function(){
		TouchManager._oldArr.length=0;
		TouchManager._newArr.length=0;
		TouchManager._tEleArr.length=0;
	}

	/**
	*从touch表里查找对应touchID的数据
	*@param touchID touch ID
	*@param arr touch表
	*@return
	*
	*/
	__proto.getTouchFromArr=function(touchID,arr){
		var i=0,len=0;
		len=arr.length;
		var tTouchO;
		for (i=0;i < len;i++){
			tTouchO=arr[i];
			if (tTouchO.id==touchID){
				return tTouchO;
			}
		}
		return null;
	}

	/**
	*从touch表里移除一个元素
	*@param touchID touch ID
	*@param arr touch表
	*
	*/
	__proto.removeTouchFromArr=function(touchID,arr){
		var i=0;
		for (i=arr.length-1;i >=0;i--){
			if (arr[i].id==touchID){
				arr.splice(i,1);
			}
		}
	}

	/**
	*创建一个touch数据
	*@param ele 当前的根节点
	*@param touchID touchID
	*@return
	*
	*/
	__proto.createTouchO=function(ele,touchID){
		var rst;
		rst=Pool.getItem("TouchData")|| {};
		rst.id=touchID;
		rst.tar=ele;
		return rst;
	}

	/**
	*处理touchStart
	*@param ele 根节点
	*@param touchID touchID
	*@param isLeft （可选）是否为左键
	*/
	__proto.onMouseDown=function(ele,touchID,isLeft){
		(isLeft===void 0)&& (isLeft=false);
		if (!this.enable)
			return;
		var preO;
		var tO;
		var arrs;
		preO=this.getTouchFromArr(touchID,this.preOvers);
		arrs=this.getEles(ele,null,TouchManager._tEleArr);
		if (!preO){
			tO=this.createTouchO(ele,touchID);
			this.preOvers.push(tO);
			}else {
			preO.tar=ele;
		}
		if (Browser.onMobile)
			this.sendEvents(arrs,"mouseover",touchID);
		var preDowns;
		preDowns=isLeft ? this.preDowns :this.preRightDowns;
		preO=this.getTouchFromArr(touchID,preDowns);
		if (!preO){
			tO=this.createTouchO(ele,touchID);
			preDowns.push(tO);
			}else {
			preO.tar=ele;
		}
		this.sendEvents(arrs,isLeft ? "mousedown" :"rightmousedown",touchID);
		this._clearTempArrs();
	}

	/**
	*派发事件。
	*@param eles 对象列表。
	*@param type 事件类型。
	*@param touchID （可选）touchID，默认为0。
	*/
	__proto.sendEvents=function(eles,type,touchID){
		(touchID===void 0)&& (touchID=0);
		var i=0,len=0;
		len=eles.length;
		this._event._stoped=false;
		var _target;
		_target=eles[0];
		var tE;
		for (i=0;i < len;i++){
			tE=eles[i];
			if (tE.destroyed)return;
			tE.event(type,this._event.setTo(type,tE,_target));
			if (this._event._stoped)
				break ;
		}
	}

	/**
	*获取对象列表。
	*@param start 起始节点。
	*@param end 结束节点。
	*@param rst 返回值。如果此值不为空，则将其赋值为计算结果，从而避免创建新数组；如果此值为空，则创建新数组返回。
	*@return Array 返回节点列表。
	*/
	__proto.getEles=function(start,end,rst){
		if (!rst){
			rst=[];
			}else {
			rst.length=0;
		}
		while (start && start !=end){
			rst.push(start);
			start=start.parent;
		}
		return rst;
	}

	/**
	*touchMove时处理out事件和over时间。
	*@param eleNew 新的根节点。
	*@param elePre 旧的根节点。
	*@param touchID （可选）touchID，默认为0。
	*/
	__proto.checkMouseOutAndOverOfMove=function(eleNew,elePre,touchID){
		(touchID===void 0)&& (touchID=0);
		if (elePre==eleNew)
			return;
		var tar;
		var arrs;
		var i=0,len=0;
		if (elePre.contains(eleNew)){
			arrs=this.getEles(eleNew,elePre,TouchManager._tEleArr);
			this.sendEvents(arrs,"mouseover",touchID);
			}else if (eleNew.contains(elePre)){
			arrs=this.getEles(elePre,eleNew,TouchManager._tEleArr);
			this.sendEvents(arrs,"mouseout",touchID);
			}else {
			arrs=TouchManager._tEleArr;
			arrs.length=0;
			var oldArr;
			oldArr=this.getEles(elePre,null,TouchManager._oldArr);
			var newArr;
			newArr=this.getEles(eleNew,null,TouchManager._newArr);
			len=oldArr.length;
			var tIndex=0;
			for (i=0;i < len;i++){
				tar=oldArr[i];
				tIndex=newArr.indexOf(tar);
				if (tIndex >=0){
					newArr.splice(tIndex,newArr.length-tIndex);
					break ;
					}else {
					arrs.push(tar);
				}
			}
			if (arrs.length > 0){
				this.sendEvents(arrs,"mouseout",touchID);
			}
			if (newArr.length > 0){
				this.sendEvents(newArr,"mouseover",touchID);
			}
		}
	}

	/**
	*处理TouchMove事件
	*@param ele 根节点
	*@param touchID touchID
	*
	*/
	__proto.onMouseMove=function(ele,touchID){
		if (!this.enable)
			return;
		var preO;
		preO=this.getTouchFromArr(touchID,this.preOvers);
		var arrs;
		var tO;
		if (!preO){
			arrs=this.getEles(ele,null,TouchManager._tEleArr);
			this.sendEvents(arrs,"mouseover",touchID);
			this.preOvers.push(this.createTouchO(ele,touchID));
			}else {
			this.checkMouseOutAndOverOfMove(ele,preO.tar);
			preO.tar=ele;
			arrs=this.getEles(ele,null,TouchManager._tEleArr);
		}
		this.sendEvents(arrs,"mousemove",touchID);
		this._clearTempArrs();
	}

	__proto.getLastOvers=function(){
		TouchManager._tEleArr.length=0;
		if (this.preOvers.length > 0 && this.preOvers[0].tar){
			return this.getEles(this.preOvers[0].tar,null,TouchManager._tEleArr);
		}
		TouchManager._tEleArr.push(Laya.stage);
		return TouchManager._tEleArr;
	}

	__proto.stageMouseOut=function(){
		var lastOvers;
		lastOvers=this.getLastOvers();
		this.preOvers.length=0;
		this.sendEvents(lastOvers,"mouseout",0);
	}

	/**
	*处理TouchEnd事件
	*@param ele 根节点
	*@param touchID touchID
	*@param isLeft 是否为左键
	*/
	__proto.onMouseUp=function(ele,touchID,isLeft){
		(isLeft===void 0)&& (isLeft=false);
		if (!this.enable)
			return;
		var preO;
		var tO;
		var arrs;
		var oldArr;
		var i=0,len=0;
		var tar;
		var sendArr;
		var onMobile=Browser.onMobile;
		arrs=this.getEles(ele,null,TouchManager._tEleArr);
		this.sendEvents(arrs,isLeft ? "mouseup" :"rightmouseup",touchID);
		var preDowns;
		preDowns=isLeft ? this.preDowns :this.preRightDowns;
		preO=this.getTouchFromArr(touchID,preDowns);
		if (!preO){
			}else {
			var isDouble=false;
			var now=Browser.now();
			isDouble=now-this._lastClickTime < 300;
			this._lastClickTime=now;
			if (ele==preO.tar){
				sendArr=arrs;
				}else {
				oldArr=this.getEles(preO.tar,null,TouchManager._oldArr);
				sendArr=TouchManager._newArr;
				sendArr.length=0;
				len=oldArr.length;
				for (i=0;i < len;i++){
					tar=oldArr[i];
					if (arrs.indexOf(tar)>=0){
						sendArr.push(tar);
					}
				}
			}
			if (sendArr.length > 0){
				this.sendEvents(sendArr,isLeft ? "click" :"rightclick",touchID);
			}
			if (isLeft && isDouble){
				this.sendEvents(sendArr,"doubleclick",touchID);
			}
			this.removeTouchFromArr(touchID,preDowns);
			preO.tar=null;
			Pool.recover("TouchData",preO);
		}
		preO=this.getTouchFromArr(touchID,this.preOvers);
		if (!preO){
			}else {
			if (onMobile){
				sendArr=this.getEles(preO.tar,null,sendArr);
				if (sendArr && sendArr.length > 0){
					this.sendEvents(sendArr,"mouseout",touchID);
				}
				this.removeTouchFromArr(touchID,this.preOvers);
				preO.tar=null;
				Pool.recover("TouchData",preO);
			}
		}
		this._clearTempArrs();
	}

	TouchManager._oldArr=[];
	TouchManager._newArr=[];
	TouchManager._tEleArr=[];
	__static(TouchManager,
	['I',function(){return this.I=new TouchManager();}
	]);
	return TouchManager;
})()


/**
*<code>Filter</code> 是滤镜基类。
*/
//class laya.filters.Filter
var Filter=(function(){
	function Filter(){
		/**@private */
		this._action=null;
	}

	__class(Filter,'laya.filters.Filter');
	var __proto=Filter.prototype;
	Laya.imps(__proto,{"laya.filters.IFilter":true})
	/**@private */
	__proto.callNative=function(sp){}
	/**@private 滤镜类型。*/
	__getset(0,__proto,'type',function(){return-1});
	/**@private 滤镜动作。*/
	__getset(0,__proto,'action',function(){return this._action });
	Filter.BLUR=0x10;
	Filter.COLOR=0x20;
	Filter.GLOW=0x08;
	Filter._filterStart=null;
	Filter._filterEnd=null;
	Filter._EndTarget=null;
	Filter._recycleScope=null;
	Filter._filter=null;
	Filter._useSrc=null;
	Filter._endSrc=null;
	Filter._useOut=null;
	Filter._endOut=null;
	return Filter;
})()


/**
*@private
*<code>ColorFilterAction</code> 是一个颜色滤镜应用类。
*/
//class laya.filters.ColorFilterAction
var ColorFilterAction=(function(){
	function ColorFilterAction(){
		this.data=null;
	}

	__class(ColorFilterAction,'laya.filters.ColorFilterAction');
	var __proto=ColorFilterAction.prototype;
	Laya.imps(__proto,{"laya.filters.IFilterAction":true})
	/**
	*给指定的对象应用颜色滤镜。
	*@param srcCanvas 需要应用画布对象。
	*@return 应用了滤镜后的画布对象。
	*/
	__proto.apply=function(srcCanvas){
		var ctx=srcCanvas.ctx.ctx;
		var canvas=srcCanvas.ctx.ctx.canvas;
		if (canvas.width==0 || canvas.height==0)return canvas;
		var imgdata=ctx.getImageData(0,0,canvas.width,canvas.height);
		var data=imgdata.data;
		var nData;
		for (var i=0,n=data.length;i < n;i+=4){
			nData=this.getColor(data[i],data[i+1],data[i+2],data[i+3]);
			if (data[i+3]==0)continue ;
			data[i]=nData[0];
			data[i+1]=nData[1];
			data[i+2]=nData[2];
			data[i+3]=nData[3];
		}
		ctx.putImageData(imgdata,0,0);
		return srcCanvas;
	}

	__proto.getColor=function(red,green,blue,alpha){
		var rst=[];
		if (this.data._mat && this.data._alpha){
			var mat=this.data._mat;
			var tempAlpha=this.data._alpha;
			rst[0]=mat[0] *red+mat[1] *green+mat[2] *blue+mat[3] *alpha+tempAlpha[0];
			rst[1]=mat[4] *red+mat[5] *green+mat[6] *blue+mat[7] *alpha+tempAlpha[1];
			rst[2]=mat[8] *red+mat[9] *green+mat[10] *blue+mat[11] *alpha+tempAlpha[2];
			rst[3]=mat[12] *red+mat[13] *green+mat[14] *blue+mat[15] *alpha+tempAlpha[3];
		}
		return rst;
	}

	return ColorFilterAction;
})()


/**
*默认的FILTER,什么都不做
*@private
*/
//class laya.filters.FilterAction
var FilterAction=(function(){
	function FilterAction(){
		this.data=null;
	}

	__class(FilterAction,'laya.filters.FilterAction');
	var __proto=FilterAction.prototype;
	Laya.imps(__proto,{"laya.filters.IFilterAction":true})
	__proto.apply=function(data){
		return null;
	}

	return FilterAction;
})()


//class laya.filters.webgl.FilterActionGL
var FilterActionGL=(function(){
	function FilterActionGL(){}
	__class(FilterActionGL,'laya.filters.webgl.FilterActionGL');
	var __proto=FilterActionGL.prototype;
	Laya.imps(__proto,{"laya.filters.IFilterActionGL":true})
	__proto.setValue=function(shader){}
	__proto.setValueMix=function(shader){}
	__proto.apply3d=function(scope,sprite,context,x,y){return null;}
	__proto.apply=function(srcCanvas){return null;}
	__getset(0,__proto,'typeMix',function(){
		return 0;
	});

	return FilterActionGL;
})()


/**
*@private
*/
//class laya.filters.WebGLFilter
var WebGLFilter=(function(){
	function WebGLFilter(){}
	__class(WebGLFilter,'laya.filters.WebGLFilter');
	WebGLFilter.enable=function(){
		if (WebGLFilter.isInit)return;
		WebGLFilter.isInit=true;
		if (!Render.isWebGL)return;
		RunDriver.createFilterAction=function (type){
			var action;
			switch (type){
				case 0x20:
					action=new ColorFilterActionGL();
					break ;
				case 0x10:
					action=new BlurFilterActionGL();
					break ;
				case 0x08:
					action=new GlowFilterActionGL();
					break ;
				}
			return action;
		}
	}

	WebGLFilter.isInit=false;
	WebGLFilter.__init$=function(){
		BlurFilterActionGL;
		ColorFilterActionGL;
		GlowFilterActionGL;
		Render;
		RunDriver;{
			RunDriver.createFilterAction=function (type){
				var action;
				switch (type){
					case 0x10:
						action=new FilterAction();
						break ;
					case 0x08:
						action=new FilterAction();
						break ;
					case 0x20:
						action=new ColorFilterAction();
						break ;
					}
				return action;
			}
		}
	}

	return WebGLFilter;
})()


/**
*@private
*/
//class laya.html.utils.HTMLParse
var HTMLParse=(function(){
	function HTMLParse(){}
	__class(HTMLParse,'laya.html.utils.HTMLParse');
	HTMLParse.parse=function(ower,xmlString,url){
		xmlString=xmlString.replace(/<br>/g,"<br/>");
		xmlString="<root>"+xmlString+"</root>";
		xmlString=xmlString.replace(HTMLParse.spacePattern,HTMLParse.char255);
		var xml=Utils.parseXMLFromString(xmlString);
		HTMLParse._parseXML(ower,xml.childNodes[0].childNodes,url);
	}

	HTMLParse._parseXML=function(parent,xml,url,href){
		var i=0,n=0;
		if (xml.join || xml.item){
			for (i=0,n=xml.length;i < n;++i){
				HTMLParse._parseXML(parent,xml[i],url,href);
			}
			}else {
			var node;
			var nodeName;
			if (xml.nodeType==3){
				var txt;
				if ((parent instanceof laya.html.dom.HTMLDivElement )){
					if (xml.nodeName==null){
						xml.nodeName="#text";
					}
					nodeName=xml.nodeName.toLowerCase();
					txt=xml.textContent.replace(/^\s+|\s+$/g,'');
					if (txt.length > 0){
						node=ClassUtils.getInstance(nodeName);
						if (node){
							parent.addChild(node);
							((node).innerTEXT=txt.replace(HTMLParse.char255AndOneSpacePattern," "));
						}
					}
					}else {
					txt=xml.textContent.replace(/^\s+|\s+$/g,'');
					if (txt.length > 0){
						((parent).innerTEXT=txt.replace(HTMLParse.char255AndOneSpacePattern," "));
					}
				}
				return;
				}else {
				nodeName=xml.nodeName.toLowerCase();
				if (nodeName=="#comment")return;
				node=ClassUtils.getInstance(nodeName);
				if (node){
					node=parent.addChild(node);
					(node).URI=url;
					(node).href=href;
					var attributes=xml.attributes;
					if (attributes && attributes.length > 0){
						for (i=0,n=attributes.length;i < n;++i){
							var attribute=attributes[i];
							var attrName=attribute.nodeName;
							var value=attribute.value;
							node._setAttributes(attrName,value);
						}
					}
					HTMLParse._parseXML(node,xml.childNodes,url,(node).href);
					}else {
					HTMLParse._parseXML(parent,xml.childNodes,url,href);
				}
			}
		}
	}

	HTMLParse.char255=String.fromCharCode(255);
	HTMLParse.spacePattern=/&nbsp;|&#160;/g;
	HTMLParse.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g");
	return HTMLParse;
})()


/**
*@private
*HTML的布局类
*对HTML的显示对象进行排版
*/
//class laya.html.utils.Layout
var Layout=(function(){
	function Layout(){}
	__class(Layout,'laya.html.utils.Layout');
	Layout.later=function(element){
		if (Layout._will==null){
			Layout._will=[];
			Laya.stage.frameLoop(1,null,function(){
				if (Layout._will.length < 1)
					return;
				for (var i=0;i < Layout._will.length;i++){
					laya.html.utils.Layout.layout(Layout._will[i]);
				}
				Layout._will.length=0;
			});
		}
		Layout._will.push(element);
	}

	Layout.layout=function(element){
		if (!element || !element._style)return null;
		if ((element._style._type & 0x200)===0)
			return null;
		element.getStyle()._type &=~0x200;
		var arr=Layout._multiLineLayout(element);
		if (Render.isConchApp&&element["layaoutCallNative"]){
			(element).layaoutCallNative();
		}
		return arr;
	}

	Layout._multiLineLayout=function(element){
		if (Text.RightToLeft)return Layout._multiLineLayout2(element);
		var elements=new Array;
		element._addChildsToLayout(elements);
		var i=0,n=elements.length,j=0;
		var style=element._getCSSStyle();
		var letterSpacing=style.letterSpacing;
		var leading=style.leading;
		var lineHeight=style.lineHeight;
		var widthAuto=style._widthAuto()|| !style.wordWrap;
		var width=widthAuto ? 999999 :element.width;
		var height=element.height;
		var maxWidth=0;
		var exWidth=style.italic ? style.fontSize / 3 :0;
		var align=style._getAlign();
		var valign=style._getValign();
		var endAdjust=valign!==0 || align!==0 || lineHeight !=0;
		var oneLayout;
		var x=0;
		var y=0;
		var w=0;
		var h=0;
		var tBottom=0;
		var lines=new Array;
		var curStyle;
		var curPadding;
		var curLine=lines[0]=new LayoutLine();
		var newLine=false,nextNewline=false;
		var htmlWord;
		var sprite;
		curLine.h=0;
		if (style.italic)
			width-=style.fontSize / 3;
		var tWordWidth=0;
		var tLineFirstKey=true;
		function addLine (){
			curLine.y=y;
			y+=curLine.h+leading;
			if (curLine.h==0)y+=lineHeight;
			curLine.mWidth=tWordWidth;
			tWordWidth=0;
			curLine=new LayoutLine();
			lines.push(curLine);
			curLine.h=0;
			x=0;
			tLineFirstKey=true;
			newLine=false;
		}
		for (i=0;i < n;i++){
			oneLayout=elements[i];
			if (oneLayout==null){
				if (!tLineFirstKey){
					x+=Layout.DIV_ELEMENT_PADDING;
				}
				curLine.wordStartIndex=curLine.elements.length;
				continue ;
			}
			tLineFirstKey=false;
			if ((oneLayout instanceof laya.html.dom.HTMLBrElement )){
				addLine();
				curLine.y=y;
				continue ;
				}else if (oneLayout._isChar()){
				htmlWord=oneLayout;
				if (!htmlWord.isWord){
					if (lines.length > 0 && (x+w)> width && curLine.wordStartIndex > 0){
						var tLineWord=0;
						tLineWord=curLine.elements.length-curLine.wordStartIndex+1;
						curLine.elements.length=curLine.wordStartIndex;
						i-=tLineWord;
						addLine();
						continue ;
					}
					newLine=false;
					tWordWidth+=htmlWord.width;
					}else {
					newLine=nextNewline || (htmlWord.char==='\n');
					curLine.wordStartIndex=curLine.elements.length;
				}
				w=htmlWord.width+letterSpacing;
				h=htmlWord.height;
				nextNewline=false;
				newLine=newLine || ((x+w)> width);
				newLine && addLine();
				curLine.minTextHeight=Math.min(curLine.minTextHeight,oneLayout.height);
				}else {
				curStyle=oneLayout._getCSSStyle();
				sprite=oneLayout;
				curPadding=curStyle.padding;
				curStyle._getCssFloat()===0 || (endAdjust=true);
				newLine=nextNewline || curStyle.lineElement;
				w=sprite.width *sprite._style._tf.scaleX+curPadding[1]+curPadding[3]+letterSpacing;
				h=sprite.height *sprite._style._tf.scaleY+curPadding[0]+curPadding[2];
				nextNewline=curStyle.lineElement;
				newLine=newLine || ((x+w)> width && curStyle.wordWrap);
				newLine && addLine();
			}
			curLine.elements.push(oneLayout);
			curLine.h=Math.max(curLine.h,h);
			oneLayout.x=x;
			oneLayout.y=y;
			x+=w;
			curLine.w=x-letterSpacing;
			curLine.y=y;
			maxWidth=Math.max(x+exWidth,maxWidth);
		}
		y=curLine.y+curLine.h;
		if (endAdjust){
			var tY=0;
			var tWidth=width;
			if (widthAuto && element.width > 0){
				tWidth=element.width;
			}
			for (i=0,n=lines.length;i < n;i++){
				lines[i].updatePos(0,tWidth,i,tY,align,valign,lineHeight);
				tY+=Math.max(lineHeight,lines[i].h+leading);
			}
			y=tY;
		}
		widthAuto && (element.width=maxWidth);
		(y > element.height)&& (element.height=y);
		return [maxWidth,y];
	}

	Layout._multiLineLayout2=function(element){
		var elements=new Array;
		element._addChildsToLayout(elements);
		var i=0,n=elements.length,j=0;
		var style=element._getCSSStyle();
		var letterSpacing=style.letterSpacing;
		var leading=style.leading;
		var lineHeight=style.lineHeight;
		var widthAuto=style._widthAuto()|| !style.wordWrap;
		var width=widthAuto ? 999999 :element.width;
		var height=element.height;
		var maxWidth=0;
		var exWidth=style.italic ? style.fontSize / 3 :0;
		var align=2-style._getAlign();
		var valign=style._getValign();
		var endAdjust=valign!==0 || align!==0 || lineHeight !=0;
		var oneLayout;
		var x=0;
		var y=0;
		var w=0;
		var h=0;
		var tBottom=0;
		var lines=new Array;
		var curStyle;
		var curPadding;
		var curLine=lines[0]=new LayoutLine();
		var newLine=false,nextNewline=false;
		var htmlWord;
		var sprite;
		curLine.h=0;
		if (style.italic)
			width-=style.fontSize / 3;
		var tWordWidth=0;
		var tLineFirstKey=true;
		function addLine (){
			curLine.y=y;
			y+=curLine.h+leading;
			if (curLine.h==0)y+=lineHeight;
			curLine.mWidth=tWordWidth;
			tWordWidth=0;
			curLine=new LayoutLine();
			lines.push(curLine);
			curLine.h=0;
			x=0;
			tLineFirstKey=true;
			newLine=false;
		}
		for (i=0;i < n;i++){
			oneLayout=elements[i];
			if (oneLayout==null){
				if (!tLineFirstKey){
					x+=Layout.DIV_ELEMENT_PADDING;
				}
				curLine.wordStartIndex=curLine.elements.length;
				continue ;
			}
			tLineFirstKey=false;
			if ((oneLayout instanceof laya.html.dom.HTMLBrElement )){
				addLine();
				curLine.y=y;
				continue ;
				}else if (oneLayout._isChar()){
				htmlWord=oneLayout;
				if (!htmlWord.isWord){
					if (lines.length > 0 && (x+w)> width && curLine.wordStartIndex > 0){
						var tLineWord=0;
						tLineWord=curLine.elements.length-curLine.wordStartIndex+1;
						curLine.elements.length=curLine.wordStartIndex;
						i-=tLineWord;
						addLine();
						continue ;
					}
					newLine=false;
					tWordWidth+=htmlWord.width;
					}else {
					newLine=nextNewline || (htmlWord.char==='\n');
					curLine.wordStartIndex=curLine.elements.length;
				}
				w=htmlWord.width+letterSpacing;
				h=htmlWord.height;
				nextNewline=false;
				newLine=newLine || ((x+w)> width);
				newLine && addLine();
				curLine.minTextHeight=Math.min(curLine.minTextHeight,oneLayout.height);
				}else {
				curStyle=oneLayout._getCSSStyle();
				sprite=oneLayout;
				curPadding=curStyle.padding;
				curStyle._getCssFloat()===0 || (endAdjust=true);
				newLine=nextNewline || curStyle.lineElement;
				w=sprite.width *sprite._style._tf.scaleX+curPadding[1]+curPadding[3]+letterSpacing;
				h=sprite.height *sprite._style._tf.scaleY+curPadding[0]+curPadding[2];
				nextNewline=curStyle.lineElement;
				newLine=newLine || ((x+w)> width && curStyle.wordWrap);
				newLine && addLine();
			}
			curLine.elements.push(oneLayout);
			curLine.h=Math.max(curLine.h,h);
			oneLayout.x=x;
			oneLayout.y=y;
			x+=w;
			curLine.w=x-letterSpacing;
			curLine.y=y;
			maxWidth=Math.max(x+exWidth,maxWidth);
		}
		y=curLine.y+curLine.h;
		if (endAdjust){
			var tY=0;
			var tWidth=width;
			for (i=0,n=lines.length;i < n;i++){
				lines[i].updatePos(0,tWidth,i,tY,align,valign,lineHeight);
				tY+=Math.max(lineHeight,lines[i].h+leading);
			}
			y=tY;
		}
		widthAuto && (element.width=maxWidth);
		(y > element.height)&& (element.height=y);
		for (i=0,n=lines.length;i < n;i++){
			lines[i].revertOrder(width);
		}
		return [maxWidth,y];
	}

	Layout._will=null;
	Layout.DIV_ELEMENT_PADDING=0;
	return Layout;
})()


/**
*@private
*/
//class laya.html.utils.LayoutLine
var LayoutLine=(function(){
	function LayoutLine(){
		this.x=0;
		this.y=0;
		this.w=0;
		this.h=0;
		this.wordStartIndex=0;
		this.minTextHeight=99999;
		this.mWidth=0;
		this.elements=new Array;
	}

	__class(LayoutLine,'laya.html.utils.LayoutLine');
	var __proto=LayoutLine.prototype;
	/**
	*底对齐（默认）
	*@param left
	*@param width
	*@param dy
	*@param align 水平
	*@param valign 垂直
	*@param lineHeight 行高
	*/
	__proto.updatePos=function(left,width,lineNum,dy,align,valign,lineHeight){
		var w=0;
		var one
		if (this.elements.length > 0){
			one=this.elements[this.elements.length-1];
			w=one.x+one.width-this.elements[0].x;
		};
		var dx=0,ddy=NaN;
		align===1 && (dx=(width-w)/ 2);
		align===2 && (dx=(width-w));
		lineHeight===0 || valign !=0 || (valign=1);
		for (var i=0,n=this.elements.length;i < n;i++){
			one=this.elements[i];
			var tCSSStyle=one._getCSSStyle();
			dx!==0 && (one.x+=dx);
			switch (tCSSStyle._getValign()){
				case 0:
					one.y=dy;
					break ;
				case 1:;
					var tMinTextHeight=0;
					if (this.minTextHeight !=99999){
						tMinTextHeight=this.minTextHeight;
					};
					var tBottomLineY=(tMinTextHeight+lineHeight)/ 2;
					tBottomLineY=Math.max(tBottomLineY,this.h);
					if ((one instanceof laya.html.dom.HTMLImageElement )){
						ddy=dy+tBottomLineY-one.height;
						}else {
						ddy=dy+tBottomLineY-one.height;
					}
					one.y=ddy;
					break ;
				case 2:
					one.y=dy+(lineHeight-one.height);
					break ;
				}
		}
	}

	/**
	*布局反向,目前用于将ltr模式布局转为rtl模式布局
	*/
	__proto.revertOrder=function(width){
		var one
		if (this.elements.length > 0){
			var i=0,len=0;
			len=this.elements.length;
			for (i=0;i < len;i++){
				one=this.elements[i];
				one.x=width-one.x-one.width;
			}
		}
	}

	return LayoutLine;
})()


/**
*@private
*/
//class laya.maths.Arith
var Arith=(function(){
	function Arith(){}
	__class(Arith,'laya.maths.Arith');
	Arith.formatR=function(r){
		if (r > Math.PI)r-=Math.PI *2;
		if (r <-Math.PI)r+=Math.PI *2;
		return r;
	}

	Arith.isPOT=function(w,h){
		return (w > 0 && (w & (w-1))===0 && h > 0 && (h & (h-1))===0);
	}

	Arith.setMatToArray=function(mat,array){
		mat.a,mat.b,0,0,mat.c,mat.d,0,0,0,0,1,0,mat.tx+20,mat.ty+20,0,1
		array[0]=mat.a;
		array[1]=mat.b;
		array[4]=mat.c;
		array[5]=mat.d;
		array[12]=mat.tx;
		array[13]=mat.ty;
	}

	return Arith;
})()


/**
*@private
*计算贝塞尔曲线的工具类。
*/
//class laya.maths.Bezier
var Bezier=(function(){
	function Bezier(){
		/**@private */
		this._controlPoints=[new Point(),new Point(),new Point()];
		this._calFun=this.getPoint2;
	}

	__class(Bezier,'laya.maths.Bezier');
	var __proto=Bezier.prototype;
	/**@private */
	__proto._switchPoint=function(x,y){
		var tPoint=this._controlPoints.shift();
		tPoint.setTo(x,y);
		this._controlPoints.push(tPoint);
	}

	/**
	*计算二次贝塞尔点。
	*@param t
	*@param rst
	*
	*/
	__proto.getPoint2=function(t,rst){
		var p1=this._controlPoints[0];
		var p2=this._controlPoints[1];
		var p3=this._controlPoints[2];
		var lineX=Math.pow((1-t),2)*p1.x+2 *t *(1-t)*p2.x+Math.pow(t,2)*p3.x;
		var lineY=Math.pow((1-t),2)*p1.y+2 *t *(1-t)*p2.y+Math.pow(t,2)*p3.y;
		rst.push(lineX,lineY);
	}

	/**
	*计算三次贝塞尔点
	*@param t
	*@param rst
	*
	*/
	__proto.getPoint3=function(t,rst){
		var p1=this._controlPoints[0];
		var p2=this._controlPoints[1];
		var p3=this._controlPoints[2];
		var p4=this._controlPoints[3];
		var lineX=Math.pow((1-t),3)*p1.x+3 *p2.x *t *(1-t)*(1-t)+3 *p3.x *t *t *(1-t)+p4.x *Math.pow(t,3);
		var lineY=Math.pow((1-t),3)*p1.y+3 *p2.y *t *(1-t)*(1-t)+3 *p3.y *t *t *(1-t)+p4.y *Math.pow(t,3);
		rst.push(lineX,lineY);
	}

	/**
	*计算贝塞尔点序列
	*@param count
	*@param rst
	*
	*/
	__proto.insertPoints=function(count,rst){
		var i=NaN;
		count=count > 0 ? count :5;
		var dLen=NaN;
		dLen=1 / count;
		for (i=0;i <=1;i+=dLen){
			this._calFun(i,rst);
		}
	}

	/**
	*获取贝塞尔曲线上的点。
	*@param pList 控制点[x0,y0,x1,y1...]
	*@param inSertCount 每次曲线的插值数量
	*@return
	*
	*/
	__proto.getBezierPoints=function(pList,inSertCount,count){
		(inSertCount===void 0)&& (inSertCount=5);
		(count===void 0)&& (count=2);
		var i=0,len=0;
		len=pList.length;
		if (len < (count+1)*2)return [];
		var rst;
		rst=[];
		switch (count){
			case 2:
				this._calFun=this.getPoint2;
				break ;
			case 3:
				this._calFun=this.getPoint3;
				break ;
			default :
				return [];
			}
		while (this._controlPoints.length <=count){
			this._controlPoints.push(new Point());
		}
		for (i=0;i < count *2;i+=2){
			this._switchPoint(pList[i],pList[i+1]);
		}
		for (i=count *2;i < len;i+=2){
			this._switchPoint(pList[i],pList[i+1]);
			if ((i / 2)% count==0)
				this.insertPoints(inSertCount,rst);
		}
		return rst;
	}

	__static(Bezier,
	['I',function(){return this.I=new Bezier();}
	]);
	return Bezier;
})()


/**
*@private
*凸包算法。
*/
//class laya.maths.GrahamScan
var GrahamScan=(function(){
	function GrahamScan(){}
	__class(GrahamScan,'laya.maths.GrahamScan');
	GrahamScan.multiply=function(p1,p2,p0){
		return ((p1.x-p0.x)*(p2.y-p0.y)-(p2.x-p0.x)*(p1.y-p0.y));
	}

	GrahamScan.dis=function(p1,p2){
		return (p1.x-p2.x)*(p1.x-p2.x)+(p1.y-p2.y)*(p1.y-p2.y);
	}

	GrahamScan._getPoints=function(count,tempUse,rst){
		(tempUse===void 0)&& (tempUse=false);
		if (!GrahamScan._mPointList)GrahamScan._mPointList=[];
		while (GrahamScan._mPointList.length < count)GrahamScan._mPointList.push(new Point());
		if (!rst)rst=[];
		rst.length=0;
		if (tempUse){
			GrahamScan.getFrom(rst,GrahamScan._mPointList,count);
			}else {
			GrahamScan.getFromR(rst,GrahamScan._mPointList,count);
		}
		return rst;
	}

	GrahamScan.getFrom=function(rst,src,count){
		var i=0;
		for (i=0;i < count;i++){
			rst.push(src[i]);
		}
		return rst;
	}

	GrahamScan.getFromR=function(rst,src,count){
		var i=0;
		for (i=0;i < count;i++){
			rst.push(src.pop());
		}
		return rst;
	}

	GrahamScan.pListToPointList=function(pList,tempUse){
		(tempUse===void 0)&& (tempUse=false);
		var i=0,len=pList.length / 2,rst=GrahamScan._getPoints(len,tempUse,GrahamScan._tempPointList);
		for (i=0;i < len;i++){
			rst[i].setTo(pList[i+i],pList[i+i+1]);
		}
		return rst;
	}

	GrahamScan.pointListToPlist=function(pointList){
		var i=0,len=pointList.length,rst=GrahamScan._temPList,tPoint;
		rst.length=0;
		for (i=0;i < len;i++){
			tPoint=pointList[i];
			rst.push(tPoint.x,tPoint.y);
		}
		return rst;
	}

	GrahamScan.scanPList=function(pList){
		return Utils.copyArray(pList,GrahamScan.pointListToPlist(GrahamScan.scan(GrahamScan.pListToPointList(pList,true))));
	}

	GrahamScan.scan=function(PointSet){
		var i=0,j=0,k=0,top=2,tmp,n=PointSet.length,ch;
		var _tmpDic={};
		var key;
		ch=GrahamScan._temArr;
		ch.length=0;
		n=PointSet.length;
		for (i=n-1;i >=0;i--){
			tmp=PointSet[i];
			key=tmp.x+"_"+tmp.y;
			if (!_tmpDic.hasOwnProperty(key)){
				_tmpDic[key]=true;
				ch.push(tmp);
			}
		}
		n=ch.length;
		Utils.copyArray(PointSet,ch);
		for (i=1;i < n;i++)
		if ((PointSet[i].y < PointSet[k].y)|| ((PointSet[i].y==PointSet[k].y)&& (PointSet[i].x < PointSet[k].x)))
			k=i;
		tmp=PointSet[0];
		PointSet[0]=PointSet[k];
		PointSet[k]=tmp;
		for (i=1;i < n-1;i++){
			k=i;
			for (j=i+1;j < n;j++)
			if ((GrahamScan.multiply(PointSet[j],PointSet[k],PointSet[0])> 0)|| ((GrahamScan.multiply(PointSet[j],PointSet[k],PointSet[0])==0)&& (GrahamScan.dis(PointSet[0],PointSet[j])< GrahamScan.dis(PointSet[0],PointSet[k]))))
				k=j;
			tmp=PointSet[i];
			PointSet[i]=PointSet[k];
			PointSet[k]=tmp;
		}
		ch=GrahamScan._temArr;
		ch.length=0;
		if (PointSet.length < 3){
			return Utils.copyArray(ch,PointSet);
		}
		ch.push(PointSet[0],PointSet[1],PointSet[2]);
		for (i=3;i < n;i++){
			while (ch.length >=2 && GrahamScan.multiply(PointSet[i],ch[ch.length-1],ch[ch.length-2])>=0)ch.pop();
			PointSet[i] && ch.push(PointSet[i]);
		}
		return ch;
	}

	GrahamScan._mPointList=null;
	GrahamScan._tempPointList=[];
	GrahamScan._temPList=[];
	GrahamScan._temArr=[];
	return GrahamScan;
})()


/**
*@private
*<code>MathUtil</code> 是一个数据处理工具类。
*/
//class laya.maths.MathUtil
var MathUtil=(function(){
	function MathUtil(){}
	__class(MathUtil,'laya.maths.MathUtil');
	MathUtil.subtractVector3=function(l,r,o){
		o[0]=l[0]-r[0];
		o[1]=l[1]-r[1];
		o[2]=l[2]-r[2];
	}

	MathUtil.lerp=function(left,right,amount){
		return left *(1-amount)+right *amount;
	}

	MathUtil.scaleVector3=function(f,b,e){
		e[0]=f[0] *b;
		e[1]=f[1] *b;
		e[2]=f[2] *b;
	}

	MathUtil.lerpVector3=function(l,r,t,o){
		var ax=l[0],ay=l[1],az=l[2];
		o[0]=ax+t *(r[0]-ax);
		o[1]=ay+t *(r[1]-ay);
		o[2]=az+t *(r[2]-az);
	}

	MathUtil.lerpVector4=function(l,r,t,o){
		var ax=l[0],ay=l[1],az=l[2],aw=l[3];
		o[0]=ax+t *(r[0]-ax);
		o[1]=ay+t *(r[1]-ay);
		o[2]=az+t *(r[2]-az);
		o[3]=aw+t *(r[3]-aw);
	}

	MathUtil.slerpQuaternionArray=function(a,Offset1,b,Offset2,t,out,Offset3){
		var ax=a[Offset1+0],ay=a[Offset1+1],az=a[Offset1+2],aw=a[Offset1+3],bx=b[Offset2+0],by=b[Offset2+1],bz=b[Offset2+2],bw=b[Offset2+3];
		var omega,cosom,sinom,scale0,scale1;
		cosom=ax *bx+ay *by+az *bz+aw *bw;
		if (cosom < 0.0){
			cosom=-cosom;
			bx=-bx;
			by=-by;
			bz=-bz;
			bw=-bw;
		}
		if ((1.0-cosom)> 0.000001){
			omega=Math.acos(cosom);
			sinom=Math.sin(omega);
			scale0=Math.sin((1.0-t)*omega)/ sinom;
			scale1=Math.sin(t *omega)/ sinom;
			}else {
			scale0=1.0-t;
			scale1=t;
		}
		out[Offset3+0]=scale0 *ax+scale1 *bx;
		out[Offset3+1]=scale0 *ay+scale1 *by;
		out[Offset3+2]=scale0 *az+scale1 *bz;
		out[Offset3+3]=scale0 *aw+scale1 *bw;
		return out;
	}

	MathUtil.getRotation=function(x0,y0,x1,y1){
		return Math.atan2(y1-y0,x1-x0)/ Math.PI *180;
	}

	MathUtil.sortBigFirst=function(a,b){
		if (a==b)
			return 0;
		return b > a ? 1 :-1;
	}

	MathUtil.sortSmallFirst=function(a,b){
		if (a==b)
			return 0;
		return b > a ?-1 :1;
	}

	MathUtil.sortNumBigFirst=function(a,b){
		return parseFloat(b)-parseFloat(a);
	}

	MathUtil.sortNumSmallFirst=function(a,b){
		return parseFloat(a)-parseFloat(b);
	}

	MathUtil.sortByKey=function(key,bigFirst,forceNum){
		(bigFirst===void 0)&& (bigFirst=false);
		(forceNum===void 0)&& (forceNum=true);
		var _sortFun;
		if (bigFirst){
			_sortFun=forceNum ? MathUtil.sortNumBigFirst :MathUtil.sortBigFirst;
			}else {
			_sortFun=forceNum ? MathUtil.sortNumSmallFirst :MathUtil.sortSmallFirst;
		}
		return function (a,b){
			return _sortFun(a[key],b[key]);
		}
	}

	return MathUtil;
})()


/**
*<p> <code>Matrix</code> 类表示一个转换矩阵，它确定如何将点从一个坐标空间映射到另一个坐标空间。</p>
*<p>您可以对一个显示对象执行不同的图形转换，方法是设置 Matrix 对象的属性，将该 Matrix 对象应用于 Transform 对象的 matrix 属性，然后应用该 Transform 对象作为显示对象的 transform 属性。这些转换函数包括平移（x 和 y 重新定位）、旋转、缩放和倾斜。</p>
*/
//class laya.maths.Matrix
var Matrix=(function(){
	function Matrix(a,b,c,d,tx,ty){
		/**缩放或旋转图像时影响像素沿 x 轴定位的值。*/
		//this.a=NaN;
		/**旋转或倾斜图像时影响像素沿 y 轴定位的值。*/
		//this.b=NaN;
		/**旋转或倾斜图像时影响像素沿 x 轴定位的值。*/
		//this.c=NaN;
		/**缩放或旋转图像时影响像素沿 y 轴定位的值。*/
		//this.d=NaN;
		/**沿 x 轴平移每个点的距离。*/
		//this.tx=NaN;
		/**沿 y 轴平移每个点的距离。*/
		//this.ty=NaN;
		/**@private 表示此对象是否在对象池中。*/
		this.inPool=false;
		/**@private 是否有改变矩阵的值。*/
		this.bTransform=false;
		(a===void 0)&& (a=1);
		(b===void 0)&& (b=0);
		(c===void 0)&& (c=0);
		(d===void 0)&& (d=1);
		(tx===void 0)&& (tx=0);
		(ty===void 0)&& (ty=0);
		this.a=a;
		this.b=b;
		this.c=c;
		this.d=d;
		this.tx=tx;
		this.ty=ty;
		this._checkTransform();
	}

	__class(Matrix,'laya.maths.Matrix');
	var __proto=Matrix.prototype;
	/**
	*将本矩阵设置为单位矩阵。
	*@return 返回当前矩形。
	*/
	__proto.identity=function(){
		this.a=this.d=1;
		this.b=this.tx=this.ty=this.c=0;
		this.bTransform=false;
		return this;
	}

	/**@private */
	__proto._checkTransform=function(){
		return this.bTransform=(this.a!==1 || this.b!==0 || this.c!==0 || this.d!==1);
	}

	/**
	*设置沿 x 、y 轴平移每个点的距离。
	*@param x 沿 x 轴平移每个点的距离。
	*@param y 沿 y 轴平移每个点的距离。
	*@return 返回对象本身
	*/
	__proto.setTranslate=function(x,y){
		this.tx=x;
		this.ty=y;
		return this;
	}

	/**
	*沿 x 和 y 轴平移矩阵，平移的变化量由 x 和 y 参数指定。
	*@param x 沿 x 轴向右移动的量（以像素为单位）。
	*@param y 沿 y 轴向下移动的量（以像素为单位）。
	*@return 返回此矩形对象。
	*/
	__proto.translate=function(x,y){
		this.tx+=x;
		this.ty+=y;
		return this;
	}

	/**
	*对矩阵应用缩放转换。
	*@param x 用于沿 x 轴缩放对象的乘数。
	*@param y 用于沿 y 轴缩放对象的乘数。
	*/
	__proto.scale=function(x,y){
		this.a *=x;
		this.d *=y;
		this.c *=x;
		this.b *=y;
		this.tx *=x;
		this.ty *=y;
		this.bTransform=true;
	}

	/**
	*对 Matrix 对象应用旋转转换。
	*@param angle 以弧度为单位的旋转角度。
	*/
	__proto.rotate=function(angle){
		var cos=Math.cos(angle);
		var sin=Math.sin(angle);
		var a1=this.a;
		var c1=this.c;
		var tx1=this.tx;
		this.a=a1 *cos-this.b *sin;
		this.b=a1 *sin+this.b *cos;
		this.c=c1 *cos-this.d *sin;
		this.d=c1 *sin+this.d *cos;
		this.tx=tx1 *cos-this.ty *sin;
		this.ty=tx1 *sin+this.ty *cos;
		this.bTransform=true;
	}

	/**
	*对 Matrix 对象应用倾斜转换。
	*@param x 沿着 X 轴的 2D 倾斜弧度。
	*@param y 沿着 Y 轴的 2D 倾斜弧度。
	*@return 当前 Matrix 对象。
	*/
	__proto.skew=function(x,y){
		var tanX=Math.tan(x);
		var tanY=Math.tan(y);
		var a1=this.a;
		var b1=this.b;
		this.a+=tanY *this.c;
		this.b+=tanY *this.d;
		this.c+=tanX *a1;
		this.d+=tanX *b1;
		return this;
	}

	/**
	*对指定的点应用当前矩阵的逆转化并返回此点。
	*@param out 待转化的点 Point 对象。
	*@return 返回out
	*/
	__proto.invertTransformPoint=function(out){
		var a1=this.a;
		var b1=this.b;
		var c1=this.c;
		var d1=this.d;
		var tx1=this.tx;
		var n=a1 *d1-b1 *c1;
		var a2=d1 / n;
		var b2=-b1 / n;
		var c2=-c1 / n;
		var d2=a1 / n;
		var tx2=(c1 *this.ty-d1 *tx1)/ n;
		var ty2=-(a1 *this.ty-b1 *tx1)/ n;
		return out.setTo(a2 *out.x+c2 *out.y+tx2,b2 *out.x+d2 *out.y+ty2);
	}

	/**
	*将 Matrix 对象表示的几何转换应用于指定点。
	*@param out 用来设定输出结果的点。
	*@return 返回out
	*/
	__proto.transformPoint=function(out){
		return out.setTo(this.a *out.x+this.c *out.y+this.tx,this.b *out.x+this.d *out.y+this.ty);
	}

	/**
	*将 Matrix 对象表示的几何转换应用于指定点，忽略tx、ty。
	*@param out 用来设定输出结果的点。
	*@return 返回out
	*/
	__proto.transformPointN=function(out){
		return out.setTo(this.a *out.x+this.c *out.y ,this.b *out.x+this.d *out.y);
	}

	/**
	*@private
	*将 Matrix 对象表示的几何转换应用于指定点。
	*@param data 点集合。
	*@param out 存储应用转化的点的列表。
	*@return 返回out数组
	*/
	__proto.transformPointArray=function(data,out){
		var len=data.length;
		for (var i=0;i < len;i+=2){
			var x=data[i],y=data[i+1];
			out[i]=this.a *x+this.c *y+this.tx;
			out[i+1]=this.b *x+this.d *y+this.ty;
		}
		return out;
	}

	/**
	*@private
	*将 Matrix 对象表示的几何缩放转换应用于指定点。
	*@param data 点集合。
	*@param out 存储应用转化的点的列表。
	*@return 返回out数组
	*/
	__proto.transformPointArrayScale=function(data,out){
		var len=data.length;
		for (var i=0;i < len;i+=2){
			var x=data[i],y=data[i+1];
			out[i]=this.a *x+this.c *y;
			out[i+1]=this.b *x+this.d *y;
		}
		return out;
	}

	/**
	*获取 X 轴缩放值。
	*@return X 轴缩放值。
	*/
	__proto.getScaleX=function(){
		return this.b===0 ? this.a :Math.sqrt(this.a *this.a+this.b *this.b);
	}

	/**
	*获取 Y 轴缩放值。
	*@return Y 轴缩放值。
	*/
	__proto.getScaleY=function(){
		return this.c===0 ? this.d :Math.sqrt(this.c *this.c+this.d *this.d);
	}

	/**
	*执行原始矩阵的逆转换。
	*@return 当前矩阵对象。
	*/
	__proto.invert=function(){
		var a1=this.a;
		var b1=this.b;
		var c1=this.c;
		var d1=this.d;
		var tx1=this.tx;
		var n=a1 *d1-b1 *c1;
		this.a=d1 / n;
		this.b=-b1 / n;
		this.c=-c1 / n;
		this.d=a1 / n;
		this.tx=(c1 *this.ty-d1 *tx1)/ n;
		this.ty=-(a1 *this.ty-b1 *tx1)/ n;
		return this;
	}

	/**
	*将 Matrix 的成员设置为指定值。
	*@param a 缩放或旋转图像时影响像素沿 x 轴定位的值。
	*@param b 旋转或倾斜图像时影响像素沿 y 轴定位的值。
	*@param c 旋转或倾斜图像时影响像素沿 x 轴定位的值。
	*@param d 缩放或旋转图像时影响像素沿 y 轴定位的值。
	*@param tx 沿 x 轴平移每个点的距离。
	*@param ty 沿 y 轴平移每个点的距离。
	*@return 当前矩阵对象。
	*/
	__proto.setTo=function(a,b,c,d,tx,ty){
		this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty;
		return this;
	}

	/**
	*将指定矩阵与当前矩阵连接，从而将这两个矩阵的几何效果有效地结合在一起。
	*@param matrix 要连接到源矩阵的矩阵。
	*@return 当前矩阵。
	*/
	__proto.concat=function(matrix){
		var a=this.a;
		var c=this.c;
		var tx=this.tx;
		this.a=a *matrix.a+this.b *matrix.c;
		this.b=a *matrix.b+this.b *matrix.d;
		this.c=c *matrix.a+this.d *matrix.c;
		this.d=c *matrix.b+this.d *matrix.d;
		this.tx=tx *matrix.a+this.ty *matrix.c+matrix.tx;
		this.ty=tx *matrix.b+this.ty *matrix.d+matrix.ty;
		return this;
	}

	/**
	*@private
	*对矩阵应用缩放转换。反向相乘
	*@param x 用于沿 x 轴缩放对象的乘数。
	*@param y 用于沿 y 轴缩放对象的乘数。
	*/
	__proto.scaleEx=function(x,y){
		var ba=this.a,bb=this.b,bc=this.c,bd=this.d;
		if (bb!==0 || bc!==0){
			this.a=x *ba;
			this.b=x *bb;
			this.c=y *bc;
			this.d=y *bd;
			}else {
			this.a=x *ba;
			this.b=0 *bd;
			this.c=0 *ba;
			this.d=y *bd;
		}
		this.bTransform=true;
	}

	/**
	*@private
	*对 Matrix 对象应用旋转转换。反向相乘
	*@param angle 以弧度为单位的旋转角度。
	*/
	__proto.rotateEx=function(angle){
		var cos=Math.cos(angle);
		var sin=Math.sin(angle);
		var ba=this.a,bb=this.b,bc=this.c,bd=this.d;
		if (bb!==0 || bc!==0){
			this.a=cos *ba+sin *bc;
			this.b=cos *bb+sin *bd;
			this.c=-sin *ba+cos *bc;
			this.d=-sin *bb+cos *bd;
			}else {
			this.a=cos *ba;
			this.b=sin *bd;
			this.c=-sin *ba;
			this.d=cos *bd;
		}
		this.bTransform=true;
	}

	/**
	*返回此 Matrix 对象的副本。
	*@return 与原始实例具有完全相同的属性的新 Matrix 实例。
	*/
	__proto.clone=function(){
		var dec=Matrix.create();
		dec.a=this.a;
		dec.b=this.b;
		dec.c=this.c;
		dec.d=this.d;
		dec.tx=this.tx;
		dec.ty=this.ty;
		dec.bTransform=this.bTransform;
		return dec;
	}

	/**
	*将当前 Matrix 对象中的所有矩阵数据复制到指定的 Matrix 对象中。
	*@param dec 要复制当前矩阵数据的 Matrix 对象。
	*@return 已复制当前矩阵数据的 Matrix 对象。
	*/
	__proto.copyTo=function(dec){
		dec.a=this.a;
		dec.b=this.b;
		dec.c=this.c;
		dec.d=this.d;
		dec.tx=this.tx;
		dec.ty=this.ty;
		dec.bTransform=this.bTransform;
		return dec;
	}

	/**
	*返回列出该 Matrix 对象属性的文本值。
	*@return 一个字符串，它包含 Matrix 对象的属性值：a、b、c、d、tx 和 ty。
	*/
	__proto.toString=function(){
		return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty;
	}

	/**
	*销毁此对象。
	*/
	__proto.destroy=function(){
		if (this.inPool)return;
		var cache=Matrix._cache;
		this.inPool=true;
		cache._length || (cache._length=0);
		cache[cache._length++]=this;
		this.a=this.d=1;
		this.b=this.c=this.tx=this.ty=0;
		this.bTransform=false;
	}

	Matrix.mul=function(m1,m2,out){
		var aa=m1.a,ab=m1.b,ac=m1.c,ad=m1.d,atx=m1.tx,aty=m1.ty;
		var ba=m2.a,bb=m2.b,bc=m2.c,bd=m2.d,btx=m2.tx,bty=m2.ty;
		if (bb!==0 || bc!==0){
			out.a=aa *ba+ab *bc;
			out.b=aa *bb+ab *bd;
			out.c=ac *ba+ad *bc;
			out.d=ac *bb+ad *bd;
			out.tx=ba *atx+bc *aty+btx;
			out.ty=bb *atx+bd *aty+bty;
			}else {
			out.a=aa *ba;
			out.b=ab *bd;
			out.c=ac *ba;
			out.d=ad *bd;
			out.tx=ba *atx+btx;
			out.ty=bd *aty+bty;
		}
		return out;
	}

	Matrix.mul16=function(m1,m2,out){
		var aa=m1.a,ab=m1.b,ac=m1.c,ad=m1.d,atx=m1.tx,aty=m1.ty;
		var ba=m2.a,bb=m2.b,bc=m2.c,bd=m2.d,btx=m2.tx,bty=m2.ty;
		if (bb!==0 || bc!==0){
			out[0]=aa *ba+ab *bc;
			out[1]=aa *bb+ab *bd;
			out[4]=ac *ba+ad *bc;
			out[5]=ac *bb+ad *bd;
			out[12]=ba *atx+bc *aty+btx;
			out[13]=bb *atx+bd *aty+bty;
			}else {
			out[0]=aa *ba;
			out[1]=ab *bd;
			out[4]=ac *ba;
			out[5]=ad *bd;
			out[12]=ba *atx+btx;
			out[13]=bd *aty+bty;
		}
		return out;
	}

	Matrix.mulPre=function(m1,ba,bb,bc,bd,btx,bty,out){
		var aa=m1.a,ab=m1.b,ac=m1.c,ad=m1.d,atx=m1.tx,aty=m1.ty;
		if (bb!==0 || bc!==0){
			out.a=aa *ba+ab *bc;
			out.b=aa *bb+ab *bd;
			out.c=ac *ba+ad *bc;
			out.d=ac *bb+ad *bd;
			out.tx=ba *atx+bc *aty+btx;
			out.ty=bb *atx+bd *aty+bty;
			}else {
			out.a=aa *ba;
			out.b=ab *bd;
			out.c=ac *ba;
			out.d=ad *bd;
			out.tx=ba *atx+btx;
			out.ty=bd *aty+bty;
		}
		return out;
	}

	Matrix.mulPos=function(m1,aa,ab,ac,ad,atx,aty,out){
		var ba=m1.a,bb=m1.b,bc=m1.c,bd=m1.d,btx=m1.tx,bty=m1.ty;
		if (bb!==0 || bc!==0){
			out.a=aa *ba+ab *bc;
			out.b=aa *bb+ab *bd;
			out.c=ac *ba+ad *bc;
			out.d=ac *bb+ad *bd;
			out.tx=ba *atx+bc *aty+btx;
			out.ty=bb *atx+bd *aty+bty;
			}else {
			out.a=aa *ba;
			out.b=ab *bd;
			out.c=ac *ba;
			out.d=ad *bd;
			out.tx=ba *atx+btx;
			out.ty=bd *aty+bty;
		}
		return out;
	}

	Matrix.preMul=function(parent,self,out){
		var pa=parent.a,pb=parent.b,pc=parent.c,pd=parent.d;
		var na=self.a,nb=self.b,nc=self.c,nd=self.d,ntx=self.tx,nty=self.ty;
		out.a=na *pa;
		out.b=out.c=0;
		out.d=nd *pd;
		out.tx=ntx *pa+parent.tx;
		out.ty=nty *pd+parent.ty;
		if (nb!==0 || nc!==0 || pb!==0 || pc!==0){
			out.a+=nb *pc;
			out.d+=nc *pb;
			out.b+=na *pb+nb *pd;
			out.c+=nc *pa+nd *pc;
			out.tx+=nty *pc;
			out.ty+=ntx *pb;
		}
		return out;
	}

	Matrix.preMulXY=function(parent,x,y,out){
		var pa=parent.a,pb=parent.b,pc=parent.c,pd=parent.d;
		out.a=pa;
		out.b=pb;
		out.c=pc;
		out.d=pd;
		out.tx=x *pa+parent.tx+y *pc;
		out.ty=y *pd+parent.ty+x *pb;
		return out;
	}

	Matrix.create=function(){
		var cache=Matrix._cache;
		var mat=!cache._length ? (new Matrix()):cache[--cache._length];
		mat.inPool=false;
		return mat;
	}

	Matrix.EMPTY=new Matrix();
	Matrix.TEMP=new Matrix();
	Matrix._cache=[];
	return Matrix;
})()


/**
*<code>Point</code> 对象表示二维坐标系统中的某个位置，其中 x 表示水平轴，y 表示垂直轴。
*/
//class laya.maths.Point
var Point=(function(){
	function Point(x,y){
		/**该点的水平坐标。*/
		//this.x=NaN;
		/**该点的垂直坐标。*/
		//this.y=NaN;
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		this.x=x;
		this.y=y;
	}

	__class(Point,'laya.maths.Point');
	var __proto=Point.prototype;
	/**
	*将 <code>Point</code> 的成员设置为指定值。
	*@param x 水平坐标。
	*@param y 垂直坐标。
	*@return 当前 Point 对象。
	*/
	__proto.setTo=function(x,y){
		this.x=x;
		this.y=y;
		return this;
	}

	/**
	*计算当前点和目标点(x，y)的距离。
	*@param x 水平坐标。
	*@param y 垂直坐标。
	*@return 返回当前点和目标点之间的距离。
	*/
	__proto.distance=function(x,y){
		return Math.sqrt((this.x-x)*(this.x-x)+(this.y-y)*(this.y-y));
	}

	/**返回包含 x 和 y 坐标的值的字符串。*/
	__proto.toString=function(){
		return this.x+","+this.y;
	}

	/**
	*标准化向量。
	*/
	__proto.normalize=function(){
		var d=Math.sqrt(this.x *this.x+this.y *this.y);
		if (d > 0){
			var id=1.0 / d;
			this.x *=id;
			this.y *=id;
		}
	}

	Point.TEMP=new Point();
	Point.EMPTY=new Point();
	return Point;
})()


/**
*<p><code>Rectangle</code> 对象是按其位置（由它左上角的点 (x,y)确定）以及宽度和高度定义的区域。</p>
*<p>Rectangle 类的 x、y、width 和 height 属性相互独立；更改一个属性的值不会影响其他属性。</p>
*/
//class laya.maths.Rectangle
var Rectangle=(function(){
	function Rectangle(x,y,width,height){
		/**矩形左上角的 X 轴坐标。*/
		//this.x=NaN;
		/**矩形左上角的 Y 轴坐标。*/
		//this.y=NaN;
		/**矩形的宽度。*/
		//this.width=NaN;
		/**矩形的高度。*/
		//this.height=NaN;
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		this.x=x;
		this.y=y;
		this.width=width;
		this.height=height;
	}

	__class(Rectangle,'laya.maths.Rectangle');
	var __proto=Rectangle.prototype;
	/**
	*将 Rectangle 的属性设置为指定值。
	*@param x x 矩形左上角的 X 轴坐标。
	*@param y x 矩形左上角的 Y 轴坐标。
	*@param width 矩形的宽度。
	*@param height 矩形的高。
	*@return 返回属性值修改后的矩形对象本身。
	*/
	__proto.setTo=function(x,y,width,height){
		this.x=x;
		this.y=y;
		this.width=width;
		this.height=height;
		return this;
	}

	/**
	*复制 source 对象的属性值到此矩形对象中。
	*@param sourceRect 源 Rectangle 对象。
	*@return 返回属性值修改后的矩形对象本身。
	*/
	__proto.copyFrom=function(source){
		this.x=source.x;
		this.y=source.y;
		this.width=source.width;
		this.height=source.height;
		return this;
	}

	/**
	*确定由此 Rectangle 对象定义的矩形区域内是否包含指定的点。
	*@param x 点的 X 轴坐标值（水平位置）。
	*@param y 点的 Y 轴坐标值（垂直位置）。
	*@return 如果 Rectangle 对象包含指定的点，则值为 true；否则为 false。
	*/
	__proto.contains=function(x,y){
		if (this.width <=0 || this.height <=0)return false;
		if (x >=this.x && x < this.right){
			if (y >=this.y && y < this.bottom){
				return true;
			}
		}
		return false;
	}

	/**
	*确定在 rect 参数中指定的对象是否与此 Rectangle 对象相交。此方法检查指定的 Rectangle 对象的 x、y、width 和 height 属性，以查看它是否与此 Rectangle 对象相交。
	*@param rect Rectangle 对象。
	*@return 如果传入的矩形对象与此对象相交，则返回 true 值，否则返回 false。
	*/
	__proto.intersects=function(rect){
		return !(rect.x > (this.x+this.width)|| (rect.x+rect.width)< this.x || rect.y > (this.y+this.height)|| (rect.y+rect.height)< this.y);
	}

	/**
	*如果在 rect 参数中指定的 Rectangle 对象与此 Rectangle 对象相交，则返回交集区域作为 Rectangle 对象。如果矩形不相交，则此方法返回null。
	*@param rect 待比较的矩形区域。
	*@param out （可选）待输出的矩形区域。如果为空则创建一个新的。建议：尽量复用对象，减少对象创建消耗。
	*@return 返回相交的矩形区域对象。
	*/
	__proto.intersection=function(rect,out){
		if (!this.intersects(rect))return null;
		out || (out=new Rectangle());
		out.x=Math.max(this.x,rect.x);
		out.y=Math.max(this.y,rect.y);
		out.width=Math.min(this.right,rect.right)-out.x;
		out.height=Math.min(this.bottom,rect.bottom)-out.y;
		return out;
	}

	/**
	*<p>矩形联合，通过填充两个矩形之间的水平和垂直空间，将这两个矩形组合在一起以创建一个新的 Rectangle 对象。</p>
	*<p>注意：union()方法忽略高度或宽度值为 0 的矩形，如：var rect2:Rectangle=new Rectangle(300,300,50,0);</p>
	*@param 要添加到此 Rectangle 对象的 Rectangle 对象。
	*@param out 用于存储输出结果的矩形对象。如果为空，则创建一个新的。建议：尽量复用对象，减少对象创建消耗。Rectangle.TEMP对象用于对象复用。
	*@return 充当两个矩形的联合的新 Rectangle 对象。
	*/
	__proto.union=function(source,out){
		out || (out=new Rectangle());
		this.clone(out);
		if (source.width <=0 || source.height <=0)return out;
		out.addPoint(source.x,source.y);
		out.addPoint(source.right,source.bottom);
		return this;
	}

	/**
	*返回一个 Rectangle 对象，其 x、y、width 和 height 属性的值与当前 Rectangle 对象的对应值相同。
	*@param out （可选）用于存储结果的矩形对象。如果为空，则创建一个新的。建议：尽量复用对象，减少对象创建消耗。。Rectangle.TEMP对象用于对象复用。
	*@return Rectangle 对象，其 x、y、width 和 height 属性的值与当前 Rectangle 对象的对应值相同。
	*/
	__proto.clone=function(out){
		out || (out=new Rectangle());
		out.x=this.x;
		out.y=this.y;
		out.width=this.width;
		out.height=this.height;
		return out;
	}

	/**
	*当前 Rectangle 对象的水平位置 x 和垂直位置 y 以及高度 width 和宽度 height 以逗号连接成的字符串。
	*/
	__proto.toString=function(){
		return this.x+","+this.y+","+this.width+","+this.height;
	}

	/**
	*检测传入的 Rectangle 对象的属性是否与当前 Rectangle 对象的属性 x、y、width、height 属性值都相等。
	*@param rect 待比较的 Rectangle 对象。
	*@return 如果判断的属性都相等，则返回 true ,否则返回 false。
	*/
	__proto.equals=function(rect){
		if (!rect || rect.x!==this.x || rect.y!==this.y || rect.width!==this.width || rect.height!==this.height)return false;
		return true;
	}

	/**
	*<p>为当前矩形对象加一个点，以使当前矩形扩展为包含当前矩形和此点的最小矩形。</p>
	*<p>此方法会修改本对象。</p>
	*@param x 点的 X 坐标。
	*@param y 点的 Y 坐标。
	*@return 返回此 Rectangle 对象。
	*/
	__proto.addPoint=function(x,y){
		this.x > x && (this.width+=this.x-x,this.x=x);
		this.y > y && (this.height+=this.y-y,this.y=y);
		if (this.width < x-this.x)this.width=x-this.x;
		if (this.height < y-this.y)this.height=y-this.y;
		return this;
	}

	/**
	*@private
	*返回代表当前矩形的顶点数据。
	*@return 顶点数据。
	*/
	__proto._getBoundPoints=function(){
		var rst=Rectangle._temB;
		rst.length=0;
		if (this.width==0 || this.height==0)return rst;
		rst.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height);
		return rst;
	}

	/**
	*确定此 Rectangle 对象是否为空。
	*@return 如果 Rectangle 对象的宽度或高度小于等于 0，则返回 true 值，否则返回 false。
	*/
	__proto.isEmpty=function(){
		if (this.width <=0 || this.height <=0)return true;
		return false;
	}

	/**此矩形右侧的 X 轴坐标。 x 和 width 属性的和。*/
	__getset(0,__proto,'right',function(){
		return this.x+this.width;
	});

	/**此矩形底端的 Y 轴坐标。y 和 height 属性的和。*/
	__getset(0,__proto,'bottom',function(){
		return this.y+this.height;
	});

	Rectangle._getBoundPointS=function(x,y,width,height){
		var rst=Rectangle._temA;
		rst.length=0;
		if (width==0 || height==0)return rst;
		rst.push(x,y,x+width,y,x,y+height,x+width,y+height);
		return rst;
	}

	Rectangle._getWrapRec=function(pointList,rst){
		if (!pointList || pointList.length < 1)return rst ? rst.setTo(0,0,0,0):Rectangle.TEMP.setTo(0,0,0,0);
		rst=rst ? rst :new Rectangle();
		var i,len=pointList.length,minX,maxX,minY,maxY,tPoint=Point.TEMP;
		minX=minY=99999;
		maxX=maxY=-minX;
		for (i=0;i < len;i+=2){
			tPoint.x=pointList[i];
			tPoint.y=pointList[i+1];
			minX=minX < tPoint.x ? minX :tPoint.x;
			minY=minY < tPoint.y ? minY :tPoint.y;
			maxX=maxX > tPoint.x ? maxX :tPoint.x;
			maxY=maxY > tPoint.y ? maxY :tPoint.y;
		}
		return rst.setTo(minX,minY,maxX-minX,maxY-minY);
	}

	Rectangle.EMPTY=new Rectangle();
	Rectangle.TEMP=new Rectangle();
	Rectangle._temB=[];
	Rectangle._temA=[];
	return Rectangle;
})()


/**
*<code>SoundManager</code> 是一个声音管理类。提供了对背景音乐、音效的播放控制方法。
*引擎默认有两套声音方案：WebAudio和H5Audio
*播放音效，优先使用WebAudio播放声音，如果WebAudio不可用，则用H5Audio播放，H5Audio在部分机器上有兼容问题（比如不能混音，播放有延迟等）。
*播放背景音乐，则使用H5Audio播放（使用WebAudio会增加特别大的内存，并且要等加载完毕后才能播放，有延迟）
*建议背景音乐用mp3类型，音效用wav或者mp3类型（如果打包为app，音效只能用wav格式）。
*详细教程及声音格式请参考：http://ldc.layabox.com/doc/?nav=ch-as-1-7-0
*/
//class laya.media.SoundManager
var SoundManager=(function(){
	function SoundManager(){}
	__class(SoundManager,'laya.media.SoundManager');
	__getset(1,SoundManager,'useAudioMusic',function(){
		return SoundManager._useAudioMusic;
		},function(value){
		SoundManager._useAudioMusic=value;
		if (value){
			SoundManager._musicClass=AudioSound;
			}else{
			SoundManager._musicClass=null;
		}
	});

	/**
	*失去焦点后是否自动停止背景音乐。
	*@param v Boolean 失去焦点后是否自动停止背景音乐。
	*
	*/
	/**
	*失去焦点后是否自动停止背景音乐。
	*/
	__getset(1,SoundManager,'autoStopMusic',function(){
		return SoundManager._autoStopMusic;
		},function(v){
		Laya.stage.off("blur",null,SoundManager._stageOnBlur);
		Laya.stage.off("focus",null,SoundManager._stageOnFocus);
		Laya.stage.off("visibilitychange",null,SoundManager._visibilityChange);
		SoundManager._autoStopMusic=v;
		if (v){
			Laya.stage.on("blur",null,SoundManager._stageOnBlur);
			Laya.stage.on("focus",null,SoundManager._stageOnFocus);
			Laya.stage.on("visibilitychange",null,SoundManager._visibilityChange);
		}
	});

	/**
	*背景音乐和所有音效是否静音。
	*/
	__getset(1,SoundManager,'muted',function(){
		return SoundManager._muted;
		},function(value){
		if (value==SoundManager._muted)return;
		if (value){
			SoundManager.stopAllSound();
		}
		SoundManager.musicMuted=value;
		SoundManager._muted=value;
	});

	/**
	*背景音乐（不包括音效）是否静音。
	*/
	__getset(1,SoundManager,'musicMuted',function(){
		return SoundManager._musicMuted;
		},function(value){
		if (value==SoundManager._musicMuted)return;
		if (value){
			if (SoundManager._tMusic){
				if (SoundManager._musicChannel&&!SoundManager._musicChannel.isStopped){
					SoundManager._musicChannel.pause();
					}else{
					SoundManager._musicChannel=null;
				}
				}else{
				SoundManager._musicChannel=null;
			}
			SoundManager._musicMuted=value;
			}else {
			SoundManager._musicMuted=value;
			if (SoundManager._tMusic){
				if (SoundManager._musicChannel){
					SoundManager._musicChannel.resume();
				}
			}
		}
	});

	/**
	*所有音效（不包括背景音乐）是否静音。
	*/
	__getset(1,SoundManager,'soundMuted',function(){
		return SoundManager._soundMuted;
		},function(value){
		SoundManager._soundMuted=value;
	});

	SoundManager.addChannel=function(channel){
		if (SoundManager._channels.indexOf(channel)>=0)return;
		SoundManager._channels.push(channel);
	}

	SoundManager.removeChannel=function(channel){
		var i=0;
		for (i=SoundManager._channels.length-1;i >=0;i--){
			if (SoundManager._channels[i]==channel){
				SoundManager._channels.splice(i,1);
			}
		}
	}

	SoundManager.disposeSoundIfNotUsed=function(url){
		var i=0;
		for (i=SoundManager._channels.length-1;i >=0;i--){
			if (SoundManager._channels[i].url==url){
				return;
			}
		}
		SoundManager.destroySound(url);
	}

	SoundManager._visibilityChange=function(){
		if (Laya.stage.isVisibility){
			SoundManager._stageOnFocus();
			}else {
			SoundManager._stageOnBlur();
		}
	}

	SoundManager._stageOnBlur=function(){
		SoundManager._isActive=false;
		if (SoundManager._musicChannel){
			if (!SoundManager._musicChannel.isStopped){
				SoundManager._blurPaused=true;
				SoundManager._musicChannel.pause();
			}
		}
		SoundManager.stopAllSound();
		Laya.stage.once("mousedown",null,SoundManager._stageOnFocus);
	}

	SoundManager._recoverWebAudio=function(){
		if(WebAudioSound.ctx&&WebAudioSound.ctx.state!="running")
			WebAudioSound.ctx.resume();
	}

	SoundManager._stageOnFocus=function(){
		SoundManager._isActive=true;
		SoundManager._recoverWebAudio();
		Laya.stage.off("mousedown",null,SoundManager._stageOnFocus);
		if (SoundManager._blurPaused){
			if (SoundManager._musicChannel && SoundManager._musicChannel.isStopped){
				SoundManager._blurPaused=false;
				SoundManager._musicChannel.resume();
			}
		}
	}

	SoundManager.playSound=function(url,loops,complete,soundClass,startTime){
		(loops===void 0)&& (loops=1);
		(startTime===void 0)&& (startTime=0);
		if (!SoundManager._isActive || !url)return null;
		if (SoundManager._muted)return null;
		SoundManager._recoverWebAudio();
		url=URL.formatURL(url);
		if (url==SoundManager._tMusic){
			if (SoundManager._musicMuted)return null;
			}else {
			if (Render.isConchApp){
				var ext=Utils.getFileExtension(url);
				if (ext !="wav" && ext !="ogg"){
					alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document.");
					return null;
				}
			}
			if (SoundManager._soundMuted)return null;
		};
		var tSound;
		if (!Browser.onMiniGame){
			tSound=Laya.loader.getRes(url);
		}
		if (!soundClass)soundClass=SoundManager._soundClass;
		if (!tSound){
			tSound=new soundClass();
			tSound.load(url);
			Loader.cacheRes(url,tSound);
		};
		var channel;
		channel=tSound.play(startTime,loops);
		if (!channel)return null;
		channel.url=url;
		channel.volume=(url==SoundManager._tMusic)? SoundManager.musicVolume :SoundManager.soundVolume;
		channel.completeHandler=complete;
		return channel;
	}

	SoundManager.destroySound=function(url){
		var tSound=Laya.loader.getRes(url);
		if (tSound){
			Loader.clearRes(url);
			tSound.dispose();
		}
	}

	SoundManager.playMusic=function(url,loops,complete,startTime){
		(loops===void 0)&& (loops=0);
		(startTime===void 0)&& (startTime=0);
		url=URL.formatURL(url);
		SoundManager._tMusic=url;
		if (SoundManager._musicChannel)SoundManager._musicChannel.stop();
		return SoundManager._musicChannel=SoundManager.playSound(url,loops,complete,SoundManager._musicClass,startTime);
	}

	SoundManager.stopSound=function(url){
		url=URL.formatURL(url);
		var i=0;
		var channel;
		for (i=SoundManager._channels.length-1;i >=0;i--){
			channel=SoundManager._channels[i];
			if (channel.url==url){
				channel.stop();
			}
		}
	}

	SoundManager.stopAll=function(){
		SoundManager._tMusic=null;
		var i=0;
		var channel;
		for (i=SoundManager._channels.length-1;i >=0;i--){
			channel=SoundManager._channels[i];
			channel.stop();
		}
	}

	SoundManager.stopAllSound=function(){
		var i=0;
		var channel;
		for (i=SoundManager._channels.length-1;i >=0;i--){
			channel=SoundManager._channels[i];
			if (channel.url !=SoundManager._tMusic){
				channel.stop();
			}
		}
	}

	SoundManager.stopMusic=function(){
		if (SoundManager._musicChannel)SoundManager._musicChannel.stop();
		SoundManager._tMusic=null;
	}

	SoundManager.setSoundVolume=function(volume,url){
		if (url){
			url=URL.formatURL(url);
			SoundManager._setVolume(url,volume);
			}else {
			SoundManager.soundVolume=volume;
			var i=0;
			var channel;
			for (i=SoundManager._channels.length-1;i >=0;i--){
				channel=SoundManager._channels[i];
				if (channel.url !=SoundManager._tMusic){
					channel.volume=volume;
				}
			}
		}
	}

	SoundManager.setMusicVolume=function(volume){
		SoundManager.musicVolume=volume;
		SoundManager._setVolume(SoundManager._tMusic,volume);
	}

	SoundManager._setVolume=function(url,volume){
		url=URL.formatURL(url);
		var i=0;
		var channel;
		for (i=SoundManager._channels.length-1;i >=0;i--){
			channel=SoundManager._channels[i];
			if (channel.url==url){
				channel.volume=volume;
			}
		}
	}

	SoundManager.musicVolume=1;
	SoundManager.soundVolume=1;
	SoundManager.playbackRate=1;
	SoundManager._useAudioMusic=true;
	SoundManager._muted=false;
	SoundManager._soundMuted=false;
	SoundManager._musicMuted=false;
	SoundManager._tMusic=null;
	SoundManager._musicChannel=null;
	SoundManager._channels=[];
	SoundManager._autoStopMusic=false;
	SoundManager._blurPaused=false;
	SoundManager._isActive=true;
	SoundManager._soundClass=null;
	SoundManager._musicClass=null;
	SoundManager.autoReleaseSound=true;
	return SoundManager;
})()


/**
*<p> <code>LocalStorage</code> 类用于没有时间限制的数据存储。</p>
*/
//class laya.net.LocalStorage
var LocalStorage=(function(){
	var Storage;
	function LocalStorage(){}
	__class(LocalStorage,'laya.net.LocalStorage');
	LocalStorage.__init__=function(){
		if (!LocalStorage._baseClass){
			LocalStorage._baseClass=Storage;
			Storage.init();
		}
		LocalStorage.items=LocalStorage._baseClass.items;
		LocalStorage.support=LocalStorage._baseClass.support;
	}

	LocalStorage.setItem=function(key,value){
		LocalStorage._baseClass.setItem(key,value);
	}

	LocalStorage.getItem=function(key){
		return LocalStorage._baseClass.getItem(key);
	}

	LocalStorage.setJSON=function(key,value){
		LocalStorage._baseClass.setJSON(key,value);
	}

	LocalStorage.getJSON=function(key){
		return LocalStorage._baseClass.getJSON(key);
	}

	LocalStorage.removeItem=function(key){
		LocalStorage._baseClass.removeItem(key);
	}

	LocalStorage.clear=function(){
		LocalStorage._baseClass.clear();
	}

	LocalStorage._baseClass=null;
	LocalStorage.items=null;
	LocalStorage.support=false;
	LocalStorage.__init$=function(){
		//class Storage
		Storage=(function(){
			function Storage(){}
			__class(Storage,'');
			Storage.init=function(){
				try{Storage.items=window.localStorage;Storage.setItem('laya','1');Storage.removeItem('laya');Storage.support=true;}catch(e){}if(!Storage.support)console.log('LocalStorage is not supprot or browser is private mode.');
			}
			Storage.setItem=function(key,value){
				try {
					Storage.support && Storage.items.setItem(key,value);
					}catch (e){
					console.warn("set localStorage failed",e);
				}
			}
			Storage.getItem=function(key){
				return Storage.support ? Storage.items.getItem(key):null;
			}
			Storage.setJSON=function(key,value){
				try {
					Storage.support && Storage.items.setItem(key,JSON.stringify(value));
					}catch (e){
					console.warn("set localStorage failed",e);
				}
			}
			Storage.getJSON=function(key){
				return JSON.parse(Storage.support ? Storage.items.getItem(key):null);
			}
			Storage.removeItem=function(key){
				Storage.support && Storage.items.removeItem(key);
			}
			Storage.clear=function(){
				Storage.support && Storage.items.clear();
			}
			Storage.items=null;
			Storage.support=false;
			return Storage;
		})()
	}

	return LocalStorage;
})()


/**
*<p>资源版本的生成由layacmd或IDE完成，使用 <code>ResourceVersion</code> 简化使用过程。</p>
*<p>调用 <code>enable</code> 启用资源版本管理。</p>
*/
//class laya.net.ResourceVersion
var ResourceVersion=(function(){
	function ResourceVersion(){}
	__class(ResourceVersion,'laya.net.ResourceVersion');
	ResourceVersion.enable=function(manifestFile,callback,type){
		(type===void 0)&& (type=2);
		laya.net.ResourceVersion.type=type;
		Laya.loader.load(manifestFile,Handler.create(null,ResourceVersion.onManifestLoaded,[callback]),null,"json");
		URL.customFormat=ResourceVersion.addVersionPrefix;
	}

	ResourceVersion.onManifestLoaded=function(callback,data){
		ResourceVersion.manifest=data;
		callback.run();
		if (!data){
			console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。");
		}
	}

	ResourceVersion.addVersionPrefix=function(originURL){
		if (ResourceVersion.manifest && ResourceVersion.manifest[originURL]){
			if (ResourceVersion.type==2)return ResourceVersion.manifest[originURL];
			return ResourceVersion.manifest[originURL]+"/"+originURL;
		}
		return originURL;
	}

	ResourceVersion.FOLDER_VERSION=1;
	ResourceVersion.FILENAME_VERSION=2;
	ResourceVersion.manifest=null;
	ResourceVersion.type=1;
	return ResourceVersion;
})()


/**
*@private
*/
//class laya.net.TTFLoader
var TTFLoader=(function(){
	function TTFLoader(){
		this.fontName=null;
		this.complete=null;
		this.err=null;
		this._fontTxt=null;
		this._url=null;
		this._div=null;
		this._txtWidth=NaN;
		this._http=null;
	}

	__class(TTFLoader,'laya.net.TTFLoader');
	var __proto=TTFLoader.prototype;
	__proto.load=function(fontPath){
		this._url=fontPath;
		var tArr=fontPath.split(".ttf")[0].split("/");
		this.fontName=tArr[tArr.length-1];
		if (Browser.window.conch){
			this._loadConch();
		}else
		if (Browser.window.FontFace){
			this._loadWithFontFace()
		}
		else {
			this._loadWithCSS();
		}
	}

	__proto._loadConch=function(){
		this._http=new HttpRequest();
		this._http.on("error",this,this._onErr);
		this._http.on("complete",this,this._onHttpLoaded);
		this._http.send(this._url,null,"get","arraybuffer");
	}

	__proto._onHttpLoaded=function(data){
		Browser.window.conch.setFontFaceFromBuffer(this.fontName,data);
		this._clearHttp();
		this._complete();
	}

	__proto._clearHttp=function(){
		if (this._http){
			this._http.off("error",this,this._onErr);
			this._http.off("complete",this,this._onHttpLoaded);
			this._http=null;
		}
	}

	__proto._onErr=function(){
		this._clearHttp();
		if (this.err){
			this.err.runWith("fail:"+this._url);
			this.err=null;
		}
	}

	__proto._complete=function(){
		Laya.timer.clear(this,this._complete);
		Laya.timer.clear(this,this._checkComplete);
		if (this._div && this._div.parentNode){
			this._div.parentNode.removeChild(this._div);
			this._div=null;
		}
		if (this.complete){
			this.complete.runWith(this);
			this.complete=null;
		}
	}

	__proto._checkComplete=function(){
		if (RunDriver.measureText("LayaTTFFont",this._fontTxt).width !=this._txtWidth){
			this._complete();
		}
	}

	__proto._loadWithFontFace=function(){
		var fontFace=new Browser.window.FontFace(this.fontName,"url('"+this._url+"')");
		Browser.window.document.fonts.add(fontFace);
		var self=this;
		fontFace.loaded.then((function(){
			self._complete()
		}));
		fontFace.load();
	}

	__proto._createDiv=function(){
		this._div=Browser.createElement("div");
		this._div.innerHTML="laya";
		var _style=this._div.style;
		_style.fontFamily=this.fontName;
		_style.position="absolute";
		_style.left="-100px";
		_style.top="-100px";
		Browser.document.body.appendChild(this._div);
	}

	__proto._loadWithCSS=function(){
		var _$this=this;
		var fontStyle=Browser.createElement("style");
		fontStyle.type="text/css";
		Browser.document.body.appendChild(fontStyle);
		fontStyle.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}";
		this._fontTxt="40px "+this.fontName;
		this._txtWidth=RunDriver.measureText("LayaTTFFont",this._fontTxt).width;
		var self=this;
		fontStyle.onload=function (){
			Laya.timer.once(10000,self,_$this._complete);
		};
		Laya.timer.loop(20,this,this._checkComplete);
		this._createDiv();
	}

	TTFLoader._testString="LayaTTFFont";
	return TTFLoader;
})()


/**
*<p> <code>URL</code> 类用于定义地址信息。</p>
*/
//class laya.net.URL
var URL=(function(){
	function URL(url){
		/**@private */
		this._url=null;
		/**@private */
		this._path=null;
		this._url=URL.formatURL(url);
		this._path=URL.getPath(url);
	}

	__class(URL,'laya.net.URL');
	var __proto=URL.prototype;
	/**地址的路径。*/
	__getset(0,__proto,'path',function(){
		return this._path;
	});

	/**格式化后的地址。*/
	__getset(0,__proto,'url',function(){
		return this._url;
	});

	URL.formatURL=function(url,base){
		if (!url)return "null path";
		if (url.indexOf(":")> 0)return url;
		if (URL.customFormat !=null)url=URL.customFormat(url,base);
		var char1=url.charAt(0);
		if (char1==="."){
			return URL.formatRelativePath((base || URL.basePath)+url);
			}else if (char1==='~'){
			return URL.rootPath+url.substring(1);
			}else if (char1==="d"){
			if (url.indexOf("data:image")===0)return url;
			}else if (char1==="/"){
			return url;
		}
		return (base || URL.basePath)+url;
	}

	URL.formatRelativePath=function(value){
		var parts=value.split("/");
		for (var i=0,len=parts.length;i < len;i++){
			if (parts[i]=='..'){
				parts.splice(i-1,2);
				i-=2;
			}
		}
		return parts.join('/');
	}

	URL.isAbsolute=function(url){
		return url.indexOf(":")> 0 || url.charAt(0)=='/';
	}

	URL.getPath=function(url){
		var ofs=url.lastIndexOf('/');
		return ofs > 0 ? url.substr(0,ofs+1):"";
	}

	URL.getFileName=function(url){
		var ofs=url.lastIndexOf('/');
		return ofs > 0 ? url.substr(ofs+1):url;
	}

	URL.version={};
	URL.basePath="";
	URL.rootPath="";
	URL.customFormat=function(url){
		var newUrl=URL.version[url];
		if (!Render.isConchApp && newUrl)url+="?v="+newUrl;
		return url;
	}

	return URL;
})()


/**
*<code>EmitterBase</code> 类是粒子发射器类
*/
//class laya.particle.emitter.EmitterBase
var EmitterBase=(function(){
	function EmitterBase(){
		/**
		*积累的帧时间
		*/
		this._frameTime=0;
		/**
		*粒子发射速率
		*/
		this._emissionRate=60;
		/**
		*当前剩余发射时间
		*/
		this._emissionTime=0;
		/**
		*发射粒子最小时间间隔
		*/
		this.minEmissionTime=1 / 60;
		/**@private */
		this._particleTemplate=null;
	}

	__class(EmitterBase,'laya.particle.emitter.EmitterBase');
	var __proto=EmitterBase.prototype;
	/**
	*开始发射粒子
	*@param duration 发射持续的时间(秒)
	*/
	__proto.start=function(duration){
		(duration===void 0)&& (duration=2147483647);
		if (this._emissionRate !=0)
			this._emissionTime=duration;
	}

	/**
	*停止发射粒子
	*@param clearParticles 是否清理当前的粒子
	*/
	__proto.stop=function(){
		this._emissionTime=0;
	}

	/**
	*清理当前的活跃粒子
	*@param clearTexture 是否清理贴图数据,若清除贴图数据将无法再播放
	*/
	__proto.clear=function(){
		this._emissionTime=0;
	}

	/**
	*发射一个粒子
	*
	*/
	__proto.emit=function(){}
	/**
	*时钟前进
	*@param passedTime 前进时间
	*
	*/
	__proto.advanceTime=function(passedTime){
		(passedTime===void 0)&& (passedTime=1);
		this._emissionTime-=passedTime;
		if (this._emissionTime < 0)return;
		this._frameTime+=passedTime;
		if (this._frameTime < this.minEmissionTime)return;
		while (this._frameTime > this.minEmissionTime){
			this._frameTime-=this.minEmissionTime;
			this.emit();
		}
	}

	/**
	*设置粒子粒子模板
	*@param particleTemplate 粒子模板
	*
	*/
	__getset(0,__proto,'particleTemplate',null,function(particleTemplate){
		this._particleTemplate=particleTemplate;
	});

	/**
	*设置粒子发射速率
	*@param emissionRate 粒子发射速率 (个/秒)
	*/
	/**
	*获取粒子发射速率
	*@return 发射速率 粒子发射速率 (个/秒)
	*/
	__getset(0,__proto,'emissionRate',function(){
		return this._emissionRate;
		},function(_emissionRate){
		if (_emissionRate <=0)return;
		this._emissionRate=_emissionRate;
		(_emissionRate > 0)&& (this.minEmissionTime=1 / _emissionRate);
	});

	return EmitterBase;
})()


/**
*@private
*/
//class laya.particle.ParticleData
var ParticleData=(function(){
	function ParticleData(){
		this.position=null;
		this.velocity=null;
		this.startColor=null;
		this.endColor=null;
		this.sizeRotation=null;
		this.radius=null;
		this.radian=null;
		this.durationAddScale=NaN;
		this.time=NaN;
	}

	__class(ParticleData,'laya.particle.ParticleData');
	ParticleData.Create=function(settings,position,velocity,time){
		var particleData=new ParticleData();
		particleData.position=position;
		MathUtil.scaleVector3(velocity,settings.emitterVelocitySensitivity,ParticleData._tempVelocity);
		var horizontalVelocity=MathUtil.lerp(settings.minHorizontalVelocity,settings.maxHorizontalVelocity,Math.random());
		var horizontalAngle=Math.random()*Math.PI *2;
		ParticleData._tempVelocity[0]+=horizontalVelocity *Math.cos(horizontalAngle);
		ParticleData._tempVelocity[2]+=horizontalVelocity *Math.sin(horizontalAngle);
		ParticleData._tempVelocity[1]+=MathUtil.lerp(settings.minVerticalVelocity,settings.maxVerticalVelocity,Math.random());
		particleData.velocity=ParticleData._tempVelocity;
		particleData.startColor=ParticleData._tempStartColor;
		particleData.endColor=ParticleData._tempEndColor;
		var i=0;
		if (settings.disableColor){
			for (i=0;i < 4;i++){
				particleData.startColor[i]=1;
				particleData.endColor[i]=1;
			}
		}
		else{
			if (settings.colorComponentInter){
				for (i=0;i < 4;i++){
					particleData.startColor[i]=MathUtil.lerp(settings.minStartColor[i],settings.maxStartColor[i],Math.random());
					particleData.endColor[i]=MathUtil.lerp(settings.minEndColor[i],settings.maxEndColor[i],Math.random());
				}
				}else {
				MathUtil.lerpVector4(settings.minStartColor,settings.maxStartColor,Math.random(),particleData.startColor);
				MathUtil.lerpVector4(settings.minEndColor,settings.maxEndColor,Math.random(),particleData.endColor);
			}
		}
		particleData.sizeRotation=ParticleData._tempSizeRotation;
		var sizeRandom=Math.random();
		particleData.sizeRotation[0]=MathUtil.lerp(settings.minStartSize,settings.maxStartSize,sizeRandom);
		particleData.sizeRotation[1]=MathUtil.lerp(settings.minEndSize,settings.maxEndSize,sizeRandom);
		particleData.sizeRotation[2]=MathUtil.lerp(settings.minRotateSpeed,settings.maxRotateSpeed,Math.random());
		particleData.radius=ParticleData._tempRadius;
		var radiusRandom=Math.random();
		particleData.radius[0]=MathUtil.lerp(settings.minStartRadius,settings.maxStartRadius,radiusRandom);
		particleData.radius[1]=MathUtil.lerp(settings.minEndRadius,settings.maxEndRadius,radiusRandom);
		particleData.radian=ParticleData._tempRadian;
		particleData.radian[0]=MathUtil.lerp(settings.minHorizontalStartRadian,settings.maxHorizontalStartRadian,Math.random());
		particleData.radian[1]=MathUtil.lerp(settings.minVerticalStartRadian,settings.maxVerticalStartRadian,Math.random());
		var useEndRadian=settings.useEndRadian;
		particleData.radian[2]=useEndRadian?MathUtil.lerp(settings.minHorizontalEndRadian,settings.maxHorizontalEndRadian,Math.random()):particleData.radian[0];
		particleData.radian[3]=useEndRadian?MathUtil.lerp(settings.minVerticalEndRadian,settings.maxVerticalEndRadian,Math.random()):particleData.radian[1];
		particleData.durationAddScale=settings.ageAddScale *Math.random();
		particleData.time=time;
		return particleData;
	}

	__static(ParticleData,
	['_tempVelocity',function(){return this._tempVelocity=new Float32Array(3);},'_tempStartColor',function(){return this._tempStartColor=new Float32Array(4);},'_tempEndColor',function(){return this._tempEndColor=new Float32Array(4);},'_tempSizeRotation',function(){return this._tempSizeRotation=new Float32Array(3);},'_tempRadius',function(){return this._tempRadius=new Float32Array(2);},'_tempRadian',function(){return this._tempRadian=new Float32Array(4);}
	]);
	return ParticleData;
})()


/**
*<code>ParticleSettings</code> 类是粒子配置数据类
*/
//class laya.particle.ParticleSetting
var ParticleSetting=(function(){
	function ParticleSetting(){
		/**贴图*/
		this.textureName=null;
		/**贴图个数,默认为1可不设置*/
		this.textureCount=1;
		/**最大同屏粒子个数，最大饱和粒子数为maxPartices-1。注意:WebGL模式下释放粒子时间为最大声明周期，可能会出现释放延迟,实际看到的同屏粒子数小于该数值，如连续喷发出现中断，请调大该数值。*/
		this.maxPartices=100;
		/**粒子持续时间(单位:秒）*/
		this.duration=1;
		/**如果大于0，某些粒子的持续时间会小于其他粒子,并具有随机性(单位:无）*/
		this.ageAddScale=0;
		/**粒子受发射器速度的敏感度（需在自定义发射器中编码设置）*/
		this.emitterVelocitySensitivity=1;
		/**最小开始尺寸（单位：2D像素、3D坐标）*/
		this.minStartSize=100;
		/**最大开始尺寸（单位：2D像素、3D坐标）*/
		this.maxStartSize=100;
		/**最小结束尺寸（单位：2D像素、3D坐标）*/
		this.minEndSize=100;
		/**最大结束尺寸（单位：2D像素、3D坐标）*/
		this.maxEndSize=100;
		/**最小水平速度（单位：2D像素、3D坐标）*/
		this.minHorizontalVelocity=0;
		/**最大水平速度（单位：2D像素、3D坐标）*/
		this.maxHorizontalVelocity=0;
		/**最小垂直速度（单位：2D像素、3D坐标）*/
		this.minVerticalVelocity=0;
		/**最大垂直速度（单位：2D像素、3D坐标）*/
		this.maxVerticalVelocity=0;
		/**等于1时粒子从出生到消亡保持一致的速度，等于0时粒子消亡时速度为0，大于1时粒子会保持加速（单位：无）*/
		this.endVelocity=1;
		/**最小旋转速度（单位：2D弧度/秒、3D弧度/秒）*/
		this.minRotateSpeed=0;
		/**最大旋转速度（单位：2D弧度/秒、3D弧度/秒）*/
		this.maxRotateSpeed=0;
		/**最小开始半径（单位：2D像素、3D坐标）*/
		this.minStartRadius=0;
		/**最大开始半径（单位：2D像素、3D坐标）*/
		this.maxStartRadius=0;
		/**最小结束半径（单位：2D像素、3D坐标）*/
		this.minEndRadius=0;
		/**最大结束半径（单位：2D像素、3D坐标）*/
		this.maxEndRadius=0;
		/**最小水平开始弧度（单位：2D弧度、3D弧度）*/
		this.minHorizontalStartRadian=0;
		/**最大水平开始弧度（单位：2D弧度、3D弧度）*/
		this.maxHorizontalStartRadian=0;
		/**最小垂直开始弧度（单位：2D弧度、3D弧度）*/
		this.minVerticalStartRadian=0;
		/**最大垂直开始弧度（单位：2D弧度、3D弧度）*/
		this.maxVerticalStartRadian=0;
		/**是否使用结束弧度,false为结束时与起始弧度保持一致,true为根据minHorizontalEndRadian、maxHorizontalEndRadian、minVerticalEndRadian、maxVerticalEndRadian计算结束弧度。*/
		this.useEndRadian=true;
		/**最小水平结束弧度（单位：2D弧度、3D弧度）*/
		this.minHorizontalEndRadian=0;
		/**最大水平结束弧度（单位：2D弧度、3D弧度）*/
		this.maxHorizontalEndRadian=0;
		/**最小垂直结束弧度（单位：2D弧度、3D弧度）*/
		this.minVerticalEndRadian=0;
		/**最大垂直结束弧度（单位：2D弧度、3D弧度）*/
		this.maxVerticalEndRadian=0;
		/**false代表RGBA整体插值，true代表RGBA逐分量插值*/
		this.colorComponentInter=false;
		/**false代表使用参数颜色数据，true代表使用原图颜色数据*/
		this.disableColor=false;
		/**混合模式，待调整，引擎中暂无BlendState抽象*/
		this.blendState=0;
		/**发射器类型,"point","box","sphere","ring"*/
		this.emitterType="null";
		/**发射器发射速率*/
		this.emissionRate=0;
		/**球发射器半径*/
		this.sphereEmitterRadius=1;
		/**球发射器速度*/
		this.sphereEmitterVelocity=0;
		/**球发射器速度随机值*/
		this.sphereEmitterVelocityAddVariance=0;
		/**环发射器半径*/
		this.ringEmitterRadius=30;
		/**环发射器速度*/
		this.ringEmitterVelocity=0;
		/**环发射器速度随机值*/
		this.ringEmitterVelocityAddVariance=0;
		/**环发射器up向量，0代表X轴,1代表Y轴,2代表Z轴*/
		this.ringEmitterUp=2;
		this.gravity=new Float32Array([0,0,0]);
		this.minStartColor=new Float32Array([1,1,1,1]);
		this.maxStartColor=new Float32Array([1,1,1,1]);
		this.minEndColor=new Float32Array([1,1,1,1]);
		this.maxEndColor=new Float32Array([1,1,1,1]);
		this.pointEmitterPosition=new Float32Array([0,0,0]);
		this.pointEmitterPositionVariance=new Float32Array([0,0,0]);
		this.pointEmitterVelocity=new Float32Array([0,0,0]);
		this.pointEmitterVelocityAddVariance=new Float32Array([0,0,0]);
		this.boxEmitterCenterPosition=new Float32Array([0,0,0]);
		this.boxEmitterSize=new Float32Array([0,0,0]);
		this.boxEmitterVelocity=new Float32Array([0,0,0]);
		this.boxEmitterVelocityAddVariance=new Float32Array([0,0,0]);
		this.sphereEmitterCenterPosition=new Float32Array([0,0,0]);
		this.ringEmitterCenterPosition=new Float32Array([0,0,0]);
		this.positionVariance=new Float32Array([0,0,0]);
	}

	__class(ParticleSetting,'laya.particle.ParticleSetting');
	ParticleSetting.checkSetting=function(setting){
		var key;
		for (key in ParticleSetting._defaultSetting){
			if (!setting.hasOwnProperty(key)){
				setting[key]=ParticleSetting._defaultSetting[key];
			}
		}
	}

	__static(ParticleSetting,
	['_defaultSetting',function(){return this._defaultSetting=new ParticleSetting();}
	]);
	return ParticleSetting;
})()


/**
*
*<code>ParticleTemplateBase</code> 类是粒子模板基类
*
*/
//class laya.particle.ParticleTemplateBase
var ParticleTemplateBase=(function(){
	function ParticleTemplateBase(){
		/**
		*粒子配置数据
		*/
		this.settings=null;
		/**
		*粒子贴图
		*/
		this.texture=null;
	}

	__class(ParticleTemplateBase,'laya.particle.ParticleTemplateBase');
	var __proto=ParticleTemplateBase.prototype;
	/**
	*添加一个粒子
	*@param position 粒子位置
	*@param velocity 粒子速度
	*
	*/
	__proto.addParticleArray=function(position,velocity){}
	return ParticleTemplateBase;
})()


/**
*@private
*/
//class laya.particle.particleUtils.CanvasShader
var CanvasShader=(function(){
	function CanvasShader(){
		this.u_Duration=NaN;
		this.u_EndVelocity=NaN;
		this.u_Gravity=null;
		this.a_Position=null;
		this.a_Velocity=null;
		this.a_StartColor=null;
		this.a_EndColor=null;
		this.a_SizeRotation=null;
		this.a_Radius=null;
		this.a_Radian=null;
		this.a_AgeAddScale=NaN;
		this.gl_Position=null;
		this.v_Color=null;
		this.oSize=NaN;
		this._color=new Float32Array(4);
		this._position=new Float32Array(3);
	}

	__class(CanvasShader,'laya.particle.particleUtils.CanvasShader');
	var __proto=CanvasShader.prototype;
	__proto.getLen=function(position){
		return Math.sqrt(position[0] *position[0]+position[1] *position[1]+position[2] *position[2]);
	}

	__proto.ComputeParticlePosition=function(position,velocity,age,normalizedAge){
		this._position[0]=position[0];
		this._position[1]=position[1];
		this._position[2]=position[2];
		var startVelocity=this.getLen(velocity);
		var endVelocity=startVelocity *this.u_EndVelocity;
		var velocityIntegral=startVelocity *normalizedAge+(endVelocity-startVelocity)*normalizedAge *normalizedAge / 2.0;
		var lenVelocity=NaN;
		lenVelocity=this.getLen(velocity);
		var i=0,len=0;
		len=3;
		for (i=0;i < len;i++){
			this._position[i]=this._position[i]+(velocity[i] / lenVelocity)*velocityIntegral *this.u_Duration;
			this._position[i]+=this.u_Gravity[i] *age *normalizedAge;
		};
		var radius=MathUtil.lerp(this.a_Radius[0],this.a_Radius[1],normalizedAge);
		var radianHorizontal=MathUtil.lerp(this.a_Radian[0],this.a_Radian[2],normalizedAge);
		var radianVertical=MathUtil.lerp(this.a_Radian[1],this.a_Radian[3],normalizedAge);
		var r=Math.cos(radianVertical)*radius;
		this._position[1]+=Math.sin(radianVertical)*radius;
		this._position[0]+=Math.cos(radianHorizontal)*r;
		this._position[2]+=Math.sin(radianHorizontal)*r;
		return new Float32Array([this._position[0],this._position[1],0.0,1.0]);
	}

	__proto.ComputeParticleSize=function(startSize,endSize,normalizedAge){
		var size=MathUtil.lerp(startSize,endSize,normalizedAge);
		return size;
	}

	__proto.ComputeParticleRotation=function(rot,age){
		return rot *age;
	}

	__proto.ComputeParticleColor=function(startColor,endColor,normalizedAge){
		var rst=this._color;
		MathUtil.lerpVector4(startColor,endColor,normalizedAge,rst);
		rst[3]=rst[3]*normalizedAge *(1.0-normalizedAge)*(1.0-normalizedAge)*6.7;
		return rst;
	}

	__proto.clamp=function(value,min,max){
		if(value<min)return min;
		if(value>max)return max;
		return value;
	}

	__proto.getData=function(age){
		age *=1.0+this.a_AgeAddScale;
		var normalizedAge=this.clamp(age / this.u_Duration,0.0,1.0);
		this.gl_Position=this.ComputeParticlePosition(this.a_Position,this.a_Velocity,age,normalizedAge);
		var pSize=this.ComputeParticleSize(this.a_SizeRotation[0],this.a_SizeRotation[1],normalizedAge);
		var rotation=this.ComputeParticleRotation(this.a_SizeRotation[2],age);
		this.v_Color=this.ComputeParticleColor(this.a_StartColor,this.a_EndColor,normalizedAge);
		var matric=new Matrix();
		var scale=NaN;
		scale=pSize/this.oSize*2;
		matric.scale(scale,scale);
		matric.rotate(rotation);
		matric.setTranslate(this.gl_Position[0],-this.gl_Position[1]);
		var alpha=NaN;
		alpha=this.v_Color[3];
		return [this.v_Color,alpha,matric,this.v_Color[0]*alpha,this.v_Color[1]*alpha,this.v_Color[2]*alpha];
	}

	return CanvasShader;
})()


/**
*
*@private
*
*@created 2015-8-25 下午3:41:07
*/
//class laya.particle.particleUtils.CMDParticle
var CMDParticle=(function(){
	function CMDParticle(){
		/**
		*最大帧
		*/
		this.maxIndex=0;
		/**
		*帧命令数组
		*/
		this.cmds=null;
		/**
		*粒子id
		*/
		this.id=0;
	}

	__class(CMDParticle,'laya.particle.particleUtils.CMDParticle');
	var __proto=CMDParticle.prototype;
	__proto.setCmds=function(cmds){
		this.cmds=cmds;
		this.maxIndex=cmds.length-1;
	}

	return CMDParticle;
})()


//class laya.particle.particleUtils.PicTool
var PicTool=(function(){
	function PicTool(){}
	__class(PicTool,'laya.particle.particleUtils.PicTool');
	PicTool.getCanvasPic=function(img,color){
		img=img.bitmap;
		var canvas=new HTMLCanvas("2D");
		var ctx=canvas.getContext('2d');
		canvas.size(img.width,img.height);
		var red=(color >> 16 & 0xFF);
		var green=(color >> 8 & 0xFF);
		var blue=(color & 0xFF);
		if(Render.isConchApp){
			ctx.setFilter(red/255,green/255,blue/255,0);
		}
		ctx.drawImage(img.source,0,0);
		if (!Render.isConchApp){
			var imgdata=ctx.getImageData(0,0,canvas.width,canvas.height);
			var data=imgdata.data;
			for (var i=0,n=data.length;i < n;i+=4){
				if (data[i+3]==0)continue ;
				data[i] *=red/255;
				data[i+1] *=green/255;
				data[i+2] *=blue/255;
			}
			ctx.putImageData(imgdata,0,0);
		}
		return canvas;
	}

	PicTool.getRGBPic=function(img){
		var rst;
		rst=[new Texture(PicTool.getCanvasPic(img,0xFF0000)),new Texture(PicTool.getCanvasPic(img,0x00FF00)),new Texture(PicTool.getCanvasPic(img,0x0000FF))];
		return rst;
	}

	return PicTool;
})()


//class laya.webgl.shader.ShaderValue
var ShaderValue=(function(){
	function ShaderValue(){}
	__class(ShaderValue,'laya.webgl.shader.ShaderValue');
	return ShaderValue;
})()


/**
*@private
*<code>Render</code> 是渲染管理类。它是一个单例，可以使用 Laya.render 访问。
*/
//class laya.renders.Render
var Render=(function(){
	function Render(width,height){
		/**@private */
		this._timeId=0;
		var style=Render._mainCanvas.source.style;
		style.position='absolute';
		style.top=style.left="0px";
		style.background="#000000";
		Render._mainCanvas.source.id="layaCanvas";
		var isWebGl=laya.renders.Render.isWebGL;
		Render._mainCanvas.source.width=width;
		Render._mainCanvas.source.height=height;
		isWebGl && Render.WebGL.init(Render._mainCanvas,width,height);
		Browser.container.appendChild(Render._mainCanvas.source);
		Render._context=new RenderContext(width,height,isWebGl ? null :Render._mainCanvas);
		Render._context.ctx.setIsMainContext();
		Browser.window.requestAnimationFrame(loop);
		function loop (){
			Laya.stage._loop();
			Browser.window.requestAnimationFrame(loop);
		}
		Laya.stage.on("visibilitychange",this,this._onVisibilitychange);
	}

	__class(Render,'laya.renders.Render');
	var __proto=Render.prototype;
	/**@private */
	__proto._onVisibilitychange=function(){
		if (!Laya.stage.isVisibility){
			this._timeId=Browser.window.setInterval(this._enterFrame,1000);
			}else if (this._timeId !=0){
			Browser.window.clearInterval(this._timeId);
		}
	}

	/**@private */
	__proto._enterFrame=function(e){
		Laya.stage._loop();
	}

	/**目前使用的渲染器。*/
	__getset(1,Render,'context',function(){
		return Render._context;
	});

	/**渲染使用的原生画布引用。 */
	__getset(1,Render,'canvas',function(){
		return Render._mainCanvas.source;
	});

	Render._context=null;
	Render._mainCanvas=null;
	Render.WebGL=null;
	Render.isConchNode=false;
	Render.isConchApp=false;
	Render.isConchWebGL=false;
	Render.isWebGL=false;
	Render.is3DMode=false;
	Render.optimizeTextureMemory=function(url,texture){
		return true;
	}

	Render.__init$=function(){
		window.ConchRenderType=window.ConchRenderType||1;
		window.ConchRenderType|=(!window.conch?0:0x04);;{
			Render.isConchNode=(window.ConchRenderType & 5)==5;
			Render.isConchApp=(window.ConchRenderType & 0x04)==0x04;
			Render.isConchWebGL=window.ConchRenderType==6;
		};;
	}

	return Render;
})()


/**
*@private
*渲染环境
*/
//class laya.renders.RenderContext
var RenderContext=(function(){
	function RenderContext(width,height,canvas){
		/**全局x坐标 */
		this.x=0;
		/**全局y坐标 */
		this.y=0;
		/**当前使用的画布 */
		//this.canvas=null;
		/**当前使用的画布上下文 */
		//this.ctx=null;
		this._drawTexture=function(x,y,args){
			if (args[0].loaded)this.ctx.drawTexture(args[0],args[1],args[2],args[3],args[4],x,y);
		}
		this._fillTexture=function(x,y,args){
			if (args[0].loaded)this.ctx.fillTexture(args[0],args[1]+x,args[2]+y,args[3],args[4],args[5],args[6],args[7]);
		}
		this._drawTextureWithTransform=function(x,y,args){
			if (args[0].loaded)this.ctx.drawTextureWithTransform(args[0],args[1],args[2],args[3],args[4],args[5],x,y,args[6]);
		}
		this._fillQuadrangle=function(x,y,args){
			this.ctx.fillQuadrangle(args[0],args[1],args[2],args[3],args[4]);
		}
		this._drawRect=function(x,y,args){
			var ctx=this.ctx;
			if (args[4] !=null){
				ctx.fillStyle=args[4];
				ctx.fillRect(x+args[0],y+args[1],args[2],args[3],null);
			}
			if (args[5] !=null){
				ctx.strokeStyle=args[5];
				ctx.lineWidth=args[6];
				ctx.strokeRect(x+args[0],y+args[1],args[2],args[3],args[6]);
			}
		}
		//矢量方法
		this._drawPie=function(x,y,args){
			var ctx=this.ctx;
			Render.isWebGL && ctx.setPathId(args[8]);
			ctx.beginPath();
			if (Render.isWebGL){
				ctx.movePath(args[0]+x,args[1]+y);
				ctx.moveTo(0,0);
				}else {
				ctx.moveTo(x+args[0],y+args[1]);
			}
			ctx.arc(x+args[0],y+args[1],args[2],args[3],args[4]);
			ctx.closePath();
			this._fillAndStroke(args[5],args[6],args[7],true);
		}
		this._clipRect=function(x,y,args){
			this.ctx.clipRect(x+args[0],y+args[1],args[2],args[3]);
		}
		this._fillRect=function(x,y,args){
			this.ctx.fillRect(x+args[0],y+args[1],args[2],args[3],args[4]);
		}
		this._drawCircle=function(x,y,args){
			var ctx=this.ctx;
			Render.isWebGL && ctx.setPathId(args[6]);
			Stat.drawCall++;
			ctx.beginPath();
			Render.isWebGL && ctx.movePath(args[0]+x,args[1]+y);
			ctx.arc(args[0]+x,args[1]+y,args[2],0,RenderContext.PI2);
			ctx.closePath();
			this._fillAndStroke(args[3],args[4],args[5],true);
		}
		this._fillCircle=function(x,y,args){
			Stat.drawCall++;
			var ctx=this.ctx;
			ctx.beginPath();
			ctx.fillStyle=args[3];
			ctx.arc(args[0]+x,args[1]+y,args[2],0,RenderContext.PI2);
			ctx.fill();
		}
		this._setShader=function(x,y,args){
			this.ctx.setShader(args[0]);
		}
		this._drawLine=function(x,y,args){
			var ctx=this.ctx;
			Render.isWebGL && ctx.setPathId(args[6]);
			ctx.beginPath();
			ctx.strokeStyle=args[4];
			ctx.lineWidth=args[5];
			if (Render.isWebGL){
				ctx.movePath(x,y);
				ctx.moveTo(args[0],args[1]);
				ctx.lineTo(args[2],args[3]);
				}else {
				ctx.moveTo(x+args[0],y+args[1]);
				ctx.lineTo(x+args[2],y+args[3]);
			}
			ctx.stroke();
		}
		this._drawLines=function(x,y,args){
			var ctx=this.ctx;
			Render.isWebGL && ctx.setPathId(args[5]);
			ctx.beginPath();
			x+=args[0],y+=args[1];
			Render.isWebGL && ctx.movePath(x,y);
			ctx.strokeStyle=args[3];
			ctx.lineWidth=args[4];
			var points=args[2];
			var i=2,n=points.length;
			if (Render.isWebGL){
				ctx.moveTo(points[0],points[1]);
				while (i < n){
					ctx.lineTo(points[i++],points[i++]);
				}
				}else {
				ctx.moveTo(x+points[0],y+points[1]);
				while (i < n){
					ctx.lineTo(x+points[i++],y+points[i++]);
				}
			}
			ctx.stroke();
		}
		this._drawLinesWebGL=function(x,y,args){
			this.ctx.drawLines(x+this.x+args[0],y+this.y+args[1],args[2],args[3],args[4]);
		}
		//x:Number,y:Number,points:Array,lineColor:String,lineWidth:Number=1
		this._drawCurves=function(x,y,args){
			this.ctx.drawCurves(x,y,args);
		}
		this._draw=function(x,y,args){
			args[0].call(null,this,x,y);
		}
		this._transformByMatrix=function(x,y,args){
			this.ctx.transformByMatrix(args[0]);
		}
		this._setTransform=function(x,y,args){
			this.ctx.setTransform(args[0],args[1],args[2],args[3],args[4],args[5]);
		}
		this._setTransformByMatrix=function(x,y,args){
			this.ctx.setTransformByMatrix(args[0]);
		}
		this._save=function(x,y,args){
			this.ctx.save();
		}
		this._restore=function(x,y,args){
			this.ctx.restore();
		}
		this._translate=function(x,y,args){
			this.ctx.translate(args[0],args[1]);
		}
		this._transform=function(x,y,args){
			this.ctx.translate(args[1]+x,args[2]+y);
			var mat=args[0];
			this.ctx.transform(mat.a,mat.b,mat.c,mat.d,mat.tx,mat.ty);
			this.ctx.translate(-x-args[1],-y-args[2]);
		}
		this._rotate=function(x,y,args){
			this.ctx.translate(args[1]+x,args[2]+y);
			this.ctx.rotate(args[0]);
			this.ctx.translate(-x-args[1],-y-args[2]);
		}
		this._scale=function(x,y,args){
			this.ctx.translate(args[2]+x,args[3]+y);
			this.ctx.scale(args[0],args[1]);
			this.ctx.translate(-x-args[2],-y-args[3]);
		}
		this._alpha=function(x,y,args){
			this.ctx.globalAlpha *=args[0];
		}
		this._setAlpha=function(x,y,args){
			this.ctx.globalAlpha=args[0];
		}
		this._fillText=function(x,y,args){
			this.ctx.fillText(args[0],args[1]+x,args[2]+y,args[3],args[4],args[5]);
		}
		this._strokeText=function(x,y,args){
			this.ctx.strokeText(args[0],args[1]+x,args[2]+y,args[3],args[4],args[5],args[6]);
		}
		this._fillBorderText=function(x,y,args){
			this.ctx.fillBorderText(args[0],args[1]+x,args[2]+y,args[3],args[4],args[5],args[6],args[7]);
		}
		this._blendMode=function(x,y,args){
			this.ctx.globalCompositeOperation=args[0];
		}
		this._beginClip=function(x,y,args){
			this.ctx.beginClip && this.ctx.beginClip(x+args[0],y+args[1],args[2],args[3]);
		}
		this._setIBVB=function(x,y,args){
			this.ctx.setIBVB(args[0]+x,args[1]+y,args[2],args[3],args[4],args[5],args[6],args[7]);
		}
		this._fillTrangles=function(x,y,args){
			this.ctx.fillTrangles(args[0],args[1]+x,args[2]+y,args[3],args[4]);
		}
		//x:Number,y:Number,paths:Array,brush:Object=null,pen:Object=null
		this._drawPath=function(x,y,args){
			var ctx=this.ctx;
			Render.isWebGL && ctx.setPathId(-1);
			ctx.beginPath();
			x+=args[0],y+=args[1];
			Render.isWebGL && ctx.movePath(x,y);
			var paths=args[2];
			for (var i=0,n=paths.length;i < n;i++){
				var path=paths[i];
				switch (path[0]){
					case "moveTo":
						Render.isWebGL ? ctx.moveTo(path[1],path[2]):ctx.moveTo(x+path[1],y+path[2]);
						break ;
					case "lineTo":
						Render.isWebGL ? ctx.lineTo(path[1],path[2]):ctx.lineTo(x+path[1],y+path[2]);
						break ;
					case "arcTo":
						Render.isWebGL ? ctx.arcTo(path[1],path[2],path[3],path[4],path[5]):ctx.arcTo(x+path[1],y+path[2],x+path[3],y+path[4],path[5]);
						break ;
					case "closePath":
						ctx.closePath();
						break ;
					}
			};
			var brush=args[3];
			if (brush !=null){
				ctx.fillStyle=brush.fillStyle;
				ctx.fill();
			};
			var pen=args[4];
			if (pen !=null){
				ctx.strokeStyle=pen.strokeStyle;
				ctx.lineWidth=pen.lineWidth || 1;
				ctx.lineJoin=pen.lineJoin;
				ctx.lineCap=pen.lineCap;
				ctx.miterLimit=pen.miterLimit;
				ctx.stroke();
			}
		}
		// polygon(x:Number,y:Number,r:Number,edges:Number,color:uint,borderWidth:int=2,borderColor:uint=0)
		this.drawPoly=function(x,y,args){
			this.ctx.drawPoly(x+this.x+args[0],y+this.y+args[1],args[2],args[3],args[4],args[5],args[6]);
		}
		//x:Number,y:Number,points:Array,fillColor:String,lineColor:String=null,lineWidth:Number=1
		this._drawPoly=function(x,y,args){
			var ctx=this.ctx;
			var points=args[2];
			var i=2,n=points.length;
			if (Render.isWebGL){
				ctx.setPathId(args[6]);
				ctx.beginPath();
				x+=args[0],y+=args[1];
				ctx.movePath(x,y);
				ctx.moveTo(points[0],points[1]);
				while (i < n){
					ctx.lineTo(points[i++],points[i++]);
				}
				}else {
				ctx.beginPath();
				x+=args[0],y+=args[1];
				ctx.moveTo(x+points[0],y+points[1]);
				while (i < n){
					ctx.lineTo(x+points[i++],y+points[i++]);
				}
			}
			ctx.closePath();
			this._fillAndStroke(args[3],args[4],args[5],args[7]);
		}
		this._drawSkin=function(x,y,args){
			var tSprite=args[0];
			if (tSprite){
				var ctx=this.ctx;
				tSprite.render(ctx,x,y);
			}
		}
		this._drawParticle=function(x,y,args){
			this.ctx.drawParticle(x+this.x,y+this.y,args[0]);
		}
		this._setFilters=function(x,y,args){
			this.ctx.setFilters(args);
		}
		if (canvas){
			this.ctx=canvas.getContext('2d');
			}else {
			canvas=HTMLCanvas.create("3D");
			this.ctx=RunDriver.createWebGLContext2D(canvas);
			canvas._setContext(this.ctx);
		}
		canvas.size(width,height);
		this.canvas=canvas;
	}

	__class(RenderContext,'laya.renders.RenderContext');
	var __proto=RenderContext.prototype;
	/**销毁当前渲染环境*/
	__proto.destroy=function(){
		if (this.canvas){
			this.canvas.destroy();
			this.canvas=null;
			this.ctx=null;
		}
		if (this.ctx){
			this.ctx.destroy();
			this.ctx=null;
		}
	}

	__proto.drawTexture=function(tex,x,y,width,height){
		if (tex.loaded)this.ctx.drawTexture(tex,x,y,width,height,this.x,this.y);
	}

	__proto._drawTextures=function(x,y,args){
		if (args[0].loaded)this.ctx.drawTextures(args[0],args[1],x+this.x,y+this.y);
	}

	__proto.drawTextureWithTransform=function(tex,x,y,width,height,m,alpha){
		if (tex.loaded)this.ctx.drawTextureWithTransform(tex,x,y,width,height,m,this.x,this.y,alpha);
	}

	__proto.fillQuadrangle=function(tex,x,y,point4,m){
		this.ctx.fillQuadrangle(tex,x,y,point4,m);
	}

	__proto.drawCanvas=function(canvas,x,y,width,height){
		this.ctx.drawCanvas(canvas,x+this.x,y+this.y,width,height);
	}

	__proto.drawRect=function(x,y,width,height,color,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var ctx=this.ctx;
		ctx.strokeStyle=color;
		ctx.lineWidth=lineWidth;
		ctx.strokeRect(x+this.x,y+this.y,width,height,lineWidth);
	}

	__proto._fillAndStroke=function(fillColor,strokeColor,lineWidth,isConvexPolygon){
		(isConvexPolygon===void 0)&& (isConvexPolygon=false);
		var ctx=this.ctx;
		if (fillColor !=null){
			ctx.fillStyle=fillColor;
			if (Render.isWebGL){
				ctx.fill(isConvexPolygon);
				}else {
				ctx.fill();
			}
		}
		if (strokeColor !=null && lineWidth > 0){
			ctx.strokeStyle=strokeColor;
			ctx.lineWidth=lineWidth;
			ctx.stroke();
		}
	}

	//ctx.translate(-x-args[0],-y-args[1]);
	__proto.clipRect=function(x,y,width,height){
		this.ctx.clipRect(x+this.x,y+this.y,width,height);
	}

	__proto.fillRect=function(x,y,width,height,fillStyle){
		this.ctx.fillRect(x+this.x,y+this.y,width,height,fillStyle);
	}

	__proto.drawCircle=function(x,y,radius,color,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		Stat.drawCall++;
		var ctx=this.ctx;
		ctx.beginPath();
		ctx.strokeStyle=color;
		ctx.lineWidth=lineWidth;
		ctx.arc(x+this.x,y+this.y,radius,0,RenderContext.PI2);
		ctx.stroke();
	}

	/**
	*绘制三角形
	*@param x
	*@param y
	*@param tex
	*@param args [x,y,texture,vertices,indices,uvs,matrix]
	*/
	__proto.drawTriangles=function(x,y,args){
		if (Render.isWebGL){
			this.ctx.drawTriangles(args[0],x+args[1],y+args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9]);
			}else {
			var indices=args[5];
			var i=0,len=indices.length;
			var ctx=this.ctx;
			for (i=0;i < len;i+=3){
				var index0=indices[i] *2;
				var index1=indices[i+1] *2;
				var index2=indices[i+2] *2;
				ctx.drawTriangle(args[0],args[3],args[4],index0,index1,index2,args[6],true);
			}
		}
	}

	__proto.fillCircle=function(x,y,radius,color){
		Stat.drawCall++;
		var ctx=this.ctx;
		ctx.beginPath();
		ctx.fillStyle=color;
		ctx.arc(x+this.x,y+this.y,radius,0,RenderContext.PI2);
		ctx.fill();
	}

	__proto.setShader=function(shader){
		this.ctx.setShader(shader);
	}

	__proto.drawLine=function(fromX,fromY,toX,toY,color,lineWidth){
		(lineWidth===void 0)&& (lineWidth=1);
		var ctx=this.ctx;
		ctx.beginPath();
		ctx.strokeStyle=color;
		ctx.lineWidth=lineWidth;
		ctx.moveTo(this.x+fromX,this.y+fromY);
		ctx.lineTo(this.x+toX,this.y+toY);
		ctx.stroke();
	}

	__proto.clear=function(){
		this.ctx.clear();
	}

	__proto.transformByMatrix=function(value){
		this.ctx.transformByMatrix(value);
	}

	__proto.setTransform=function(a,b,c,d,tx,ty){
		this.ctx.setTransform(a,b,c,d,tx,ty);
	}

	__proto.setTransformByMatrix=function(value){
		this.ctx.setTransformByMatrix(value);
	}

	__proto.save=function(){
		this.ctx.save();
	}

	__proto.restore=function(){
		this.ctx.restore();
	}

	__proto.translate=function(x,y){
		this.ctx.translate(x,y);
	}

	__proto.transform=function(a,b,c,d,tx,ty){
		this.ctx.transform(a,b,c,d,tx,ty);
	}

	__proto.rotate=function(angle){
		this.ctx.rotate(angle);
	}

	__proto.scale=function(scaleX,scaleY){
		this.ctx.scale(scaleX,scaleY);
	}

	__proto.alpha=function(value){
		this.ctx.globalAlpha *=value;
	}

	__proto.setAlpha=function(value){
		this.ctx.globalAlpha=value;
	}

	__proto.fillWords=function(words,x,y,font,color,underLine){
		(underLine===void 0)&& (underLine=0);
		this.ctx.fillWords(words,x,y,font,color,underLine);
	}

	/***@private */
	__proto.fillBorderWords=function(words,x,y,font,fillColor,borderColor,lineWidth){
		this.ctx.fillBorderWords(words,x,y,font,fillColor,borderColor,lineWidth);
	}

	__proto.fillText=function(text,x,y,font,color,textAlign){
		this.ctx.fillText(text,x+this.x,y+this.y,font,color,textAlign);
	}

	__proto.strokeText=function(text,x,y,font,color,lineWidth,textAlign){
		this.ctx.strokeText(text,x+this.x,y+this.y,font,color,lineWidth,textAlign);
	}

	__proto.blendMode=function(type){
		this.ctx.globalCompositeOperation=type;
	}

	__proto.flush=function(){
		this.ctx.flush && this.ctx.flush();
	}

	__proto.addRenderObject=function(o){
		this.ctx.addRenderObject(o);
	}

	__proto.beginClip=function(x,y,w,h){
		this.ctx.beginClip && this.ctx.beginClip(x,y,w,h);
	}

	__proto.endClip=function(){
		this.ctx.endClip && this.ctx.endClip();
	}

	__proto.fillTrangles=function(x,y,args){
		this.ctx.fillTrangles(args[0],args[1],args[2],args[3],args.length > 4 ? args[4] :null);
	}

	RenderContext.PI2=2 *Math.PI;
	return RenderContext;
})()


/**
*@private
*精灵渲染器
*/
//class laya.renders.RenderSprite
var RenderSprite=(function(){
	function RenderSprite(type,next){
		/**@private */
		//this._next=null;
		/**@private */
		//this._fun=null;
		this._next=next || RenderSprite.NORENDER;
		switch (type){
			case 0:
				this._fun=this._no;
				return;
			case 0x01:
				this._fun=this._image;
				return;
			case 0x02:
				this._fun=this._alpha;
				return;
			case 0x04:
				this._fun=this._transform;
				return;
			case 0x08:
				this._fun=this._blend;
				return;
			case 0x10:
				this._fun=this._canvas;
				return;
			case 0x40:
				this._fun=this._mask;
				return;
			case 0x80:
				this._fun=this._clip;
				return;
			case 0x100:
				this._fun=this._style;
				return;
			case 0x200:
				this._fun=this._graphics;
				return;
			case 0x800:
				this._fun=this._childs;
				return;
			case 0x400:
				this._fun=this._custom;
				return;
			case 0x01 | 0x200:
				this._fun=this._image2;
				return;
			case 0x01 | 0x04 | 0x200:
				this._fun=this._image2;
				return;
			case 0x20:
				this._fun=Filter._filter;
				return;
			case 0x11111:
				this._fun=RenderSprite._initRenderFun;
				return;
			}
		this.onCreate(type);
	}

	__class(RenderSprite,'laya.renders.RenderSprite');
	var __proto=RenderSprite.prototype;
	__proto.onCreate=function(type){}
	__proto._style=function(sprite,context,x,y){
		sprite._style.render(sprite,context,x,y);
		var next=this._next;
		next._fun.call(next,sprite,context,x,y);
	}

	__proto._no=function(sprite,context,x,y){}
	__proto._custom=function(sprite,context,x,y){
		sprite.customRender(context,x,y);
		var tf=sprite._style._tf;
		this._next._fun.call(this._next,sprite,context,x-tf.translateX,y-tf.translateY);
	}

	__proto._clip=function(sprite,context,x,y){
		var next=this._next;
		if (next==RenderSprite.NORENDER)return;
		var r=sprite._style.scrollRect;
		context.ctx.save();
		context.ctx.clipRect(x,y,r.width,r.height);
		next._fun.call(next,sprite,context,x-r.x,y-r.y);
		context.ctx.restore();
	}

	__proto._blend=function(sprite,context,x,y){
		var style=sprite._style;
		if (style.blendMode){
			context.ctx.globalCompositeOperation=style.blendMode;
		};
		var next=this._next;
		next._fun.call(next,sprite,context,x,y);
		context.ctx.globalCompositeOperation="source-over";
	}

	__proto._mask=function(sprite,context,x,y){
		var next=this._next;
		next._fun.call(next,sprite,context,x,y);
		var mask=sprite.mask;
		if (mask){
			context.ctx.globalCompositeOperation="destination-in";
			if (mask.numChildren > 0 || !mask.graphics._isOnlyOne()){
				mask.cacheAsBitmap=true;
			}
			mask.render(context,x-sprite.pivotX,y-sprite.pivotY);
		}
		context.ctx.globalCompositeOperation="source-over";
	}

	__proto._graphics=function(sprite,context,x,y){
		var tf=sprite._style._tf;
		sprite._graphics && sprite._graphics._render(sprite,context,x-tf.translateX,y-tf.translateY);
		var next=this._next;
		next._fun.call(next,sprite,context,x,y);
	}

	__proto._image=function(sprite,context,x,y){
		var style=sprite._style;
		context.ctx.drawTexture2(x,y,style._tf.translateX,style._tf.translateY,sprite.transform,style.alpha,style.blendMode,sprite._graphics._one);
	}

	__proto._image2=function(sprite,context,x,y){
		var tf=sprite._style._tf;
		context.ctx.drawTexture2(x,y,tf.translateX,tf.translateY,sprite.transform,1,null,sprite._graphics._one);
	}

	__proto._alpha=function(sprite,context,x,y){
		var style=sprite._style;
		var alpha;
		if ((alpha=style.alpha)> 0.01 || sprite._needRepaint()){
			var temp=context.ctx.globalAlpha;
			context.ctx.globalAlpha *=alpha;
			var next=this._next;
			next._fun.call(next,sprite,context,x,y);
			context.ctx.globalAlpha=temp;
		}
	}

	__proto._transform=function(sprite,context,x,y){
		var transform=sprite.transform,_next=this._next;
		if (transform && _next !=RenderSprite.NORENDER){
			context.save();
			context.transform(transform.a,transform.b,transform.c,transform.d,transform.tx+x,transform.ty+y);
			_next._fun.call(_next,sprite,context,0,0);
			context.restore();
		}else
		_next._fun.call(_next,sprite,context,x,y);
	}

	__proto._childs=function(sprite,context,x,y){
		var style=sprite._style;
		var tf=style._tf;
		x=x-tf.translateX+style.paddingLeft;
		y=y-tf.translateY+style.paddingTop;
		if (style._calculation){
			var words=sprite._getWords();
			if (words){
				var tStyle=style;
				if (tStyle){
					if (tStyle.stroke){
						context.fillBorderWords(words,x,y,tStyle.font,tStyle.color,tStyle.strokeColor,tStyle.stroke);
						}else{
						context.fillWords(words,x,y,tStyle.font,tStyle.color,tStyle.underLine);
					}
				}
			}
		};
		var childs=sprite._childs,n=childs.length,ele;
		if (sprite.viewport || (sprite.optimizeScrollRect && sprite._style.scrollRect)){
			var rect=sprite.viewport || sprite._style.scrollRect;
			var left=rect.x;
			var top=rect.y;
			var right=rect.right;
			var bottom=rect.bottom;
			var _x=NaN,_y=NaN;
			for (i=0;i < n;++i){
				if ((ele=childs [i]).visible && ((_x=ele._x)< right && (_x+ele.width)> left && (_y=ele._y)< bottom && (_y+ele.height)> top)){
					ele.render(context,x,y);
				}
			}
			}else {
			for (var i=0;i < n;++i)
			(ele=(childs [i]))._style.visible && ele.render(context,x,y);
		}
	}

	//}
	__proto._canvas=function(sprite,context,x,y){
		var _cacheCanvas=sprite._$P.cacheCanvas;
		if (!_cacheCanvas){
			this._next._fun.call(this._next,sprite,context,x,y);
			return;
		}
		_cacheCanvas.type==='bitmap' ? (Stat.canvasBitmap++):(Stat.canvasNormal++);
		var tx=_cacheCanvas.ctx;
		if (sprite._needRepaint()|| !tx){
			this._canvas_repaint(sprite,context,x,y);
		}
		else{
			var tRec=_cacheCanvas._cacheRec;
			context.drawCanvas(tx.canvas,x+tRec.x,y+tRec.y,tRec.width,tRec.height);
		}
	}

	__proto._canvas_repaint=function(sprite,context,x,y){
		var _cacheCanvas=sprite._$P.cacheCanvas;
		var _next=this._next;
		if (!_cacheCanvas){
			_next._fun.call(_next,sprite,tx,x,y);
			return;
		};
		var tx=_cacheCanvas.ctx;
		var _repaint=sprite._needRepaint()|| (!tx);
		var canvas;
		var left;
		var top;
		var tRec;
		var tCacheType=_cacheCanvas.type;
		tCacheType==='bitmap' ? (Stat.canvasBitmap++):(Stat.canvasNormal++);
		if (_repaint){
			if (!_cacheCanvas._cacheRec)
				_cacheCanvas._cacheRec=new Rectangle();
			var w,h;
			if (!Render.isWebGL || tCacheType==="bitmap"){
				tRec=sprite.getSelfBounds();
				tRec.x=tRec.x-sprite.pivotX;
				tRec.y=tRec.y-sprite.pivotY;
				tRec.x=tRec.x-16;
				tRec.y=tRec.y-16;
				tRec.width=tRec.width+32;
				tRec.height=tRec.height+32;
				tRec.x=Math.floor(tRec.x+x)-x;
				tRec.y=Math.floor(tRec.y+y)-y;
				tRec.width=Math.floor(tRec.width);
				tRec.height=Math.floor(tRec.height);
				_cacheCanvas._cacheRec.copyFrom(tRec);
				}else{
				_cacheCanvas._cacheRec.setTo(-sprite.pivotX,-sprite.pivotY,1,1);
			}
			tRec=_cacheCanvas._cacheRec;
			var scaleX=Render.isWebGL ? 1 :Browser.pixelRatio *Laya.stage.clientScaleX;
			var scaleY=Render.isWebGL ? 1 :Browser.pixelRatio *Laya.stage.clientScaleY;
			if (!Render.isWebGL){
				var chainScaleX=1;
				var chainScaleY=1;
				var tar;
				tar=sprite;
				while (tar && tar !=Laya.stage){
					chainScaleX *=tar.scaleX;
					chainScaleY *=tar.scaleY;
					tar=tar.parent;
				}
				if (Render.isWebGL){
					if (chainScaleX < 1)scaleX *=chainScaleX;
					if (chainScaleY < 1)scaleY *=chainScaleY;
					}else {
					if (chainScaleX > 1)scaleX *=chainScaleX;
					if (chainScaleY > 1)scaleY *=chainScaleY;
				}
			}
			if (sprite.scrollRect){
				var scrollRect=sprite.scrollRect;
				tRec.x-=scrollRect.x;
				tRec.y-=scrollRect.y;
			}
			w=tRec.width *scaleX;
			h=tRec.height *scaleY;
			left=tRec.x;
			top=tRec.y;
			if (Render.isWebGL && tCacheType==='bitmap' && (w > 2048 || h > 2048)){
				console.warn("cache bitmap size larger than 2048,cache ignored");
				if (_cacheCanvas.ctx){
					Pool.recover("RenderContext",_cacheCanvas.ctx);
					_cacheCanvas.ctx.canvas.size(0,0);
					_cacheCanvas.ctx=null;
				}
				_next._fun.call(_next,sprite,context,x,y);
				return;
			}
			if (!tx){
				tx=_cacheCanvas.ctx=Pool.getItem("RenderContext")|| new RenderContext(w,h,HTMLCanvas.create("AUTO"));
			}
			tx.ctx.sprite=sprite;
			canvas=tx.canvas;
			canvas.clear();
			(canvas.width !=w || canvas.height !=h)&& canvas.size(w,h);
			if (tCacheType==='bitmap')canvas.context.asBitmap=true;
			else if(tCacheType==='normal')canvas.context.asBitmap=false;
			var t;
			if (scaleX !=1 || scaleY !=1){
				var ctx=(tx).ctx;
				ctx.save();
				ctx.scale(scaleX,scaleY);
				if (!Render.isConchWebGL && Render.isConchApp){
					t=sprite._$P.cf;
					t && ctx.setFilterMatrix && ctx.setFilterMatrix(t._mat,t._alpha);
				}
				_next._fun.call(_next,sprite,tx,-left,-top);
				ctx.restore();
				if (!Render.isConchApp || Render.isConchWebGL)sprite._applyFilters();
				}else {
				ctx=(tx).ctx;
				if (!Render.isConchWebGL && Render.isConchApp){
					t=sprite._$P.cf;
					t && ctx.setFilterMatrix && ctx.setFilterMatrix(t._mat,t._alpha);
				}
				_next._fun.call(_next,sprite,tx,-left,-top);
				if (!Render.isConchApp || Render.isConchWebGL)sprite._applyFilters();
			}
			if (sprite._$P.staticCache)_cacheCanvas.reCache=false;
			Stat.canvasReCache++;
			}else {
			tRec=_cacheCanvas._cacheRec;
			left=tRec.x;
			top=tRec.y;
			canvas=tx.canvas;
		}
		context.drawCanvas(canvas,x+left,y+top,tRec.width,tRec.height);
	}

	RenderSprite.__init__=function(){
		var i=0,len=0;
		var initRender;
		initRender=RunDriver.createRenderSprite(0x11111,null);
		len=RenderSprite.renders.length=0x800 *2;
		for (i=0;i < len;i++)
		RenderSprite.renders[i]=initRender;
		RenderSprite.renders[0]=RunDriver.createRenderSprite(0,null);
		function _initSame (value,o){
			var n=0;
			for (var i=0;i < value.length;i++){
				n |=value[i];
				RenderSprite.renders[n]=o;
			}
		}
		_initSame([0x01,0x200,0x04,0x02],new RenderSprite(0x01,null));
		RenderSprite.renders[0x01 | 0x200]=RunDriver.createRenderSprite(0x01 | 0x200,null);
		RenderSprite.renders[0x01 | 0x04 | 0x200]=new RenderSprite(0x01 | 0x04 | 0x200,null);
	}

	RenderSprite._initRenderFun=function(sprite,context,x,y){
		var type=sprite._renderType;
		var r=RenderSprite.renders[type]=RenderSprite._getTypeRender(type);
		r._fun(sprite,context,x,y);
	}

	RenderSprite._getTypeRender=function(type){
		var rst=null;
		var tType=0x800;
		while (tType > 1){
			if (tType & type)
				rst=RunDriver.createRenderSprite(tType,rst);
			tType=tType >> 1;
		}
		return rst;
	}

	RenderSprite.IMAGE=0x01;
	RenderSprite.ALPHA=0x02;
	RenderSprite.TRANSFORM=0x04;
	RenderSprite.BLEND=0x08;
	RenderSprite.CANVAS=0x10;
	RenderSprite.FILTERS=0x20;
	RenderSprite.MASK=0x40;
	RenderSprite.CLIP=0x80;
	RenderSprite.STYLE=0x100;
	RenderSprite.GRAPHICS=0x200;
	RenderSprite.CUSTOM=0x400;
	RenderSprite.CHILDS=0x800;
	RenderSprite.INIT=0x11111;
	RenderSprite.renders=[];
	RenderSprite.NORENDER=new RenderSprite(0,null);
	return RenderSprite;
})()


/**
*@private
*Context扩展类
*/
//class laya.resource.Context
var Context=(function(){
	function Context(){
		/***@private */
		//this._canvas=null;
		this._repaint=false;
	}

	__class(Context,'laya.resource.Context');
	var __proto=Context.prototype;
	__proto.replaceReset=function(){
		var i=0,len=0;
		len=Context.replaceKeys.length;
		var key;
		for (i=0;i < len;i++){
			key=Context.replaceKeys[i];
			this[Context.newKeys[i]]=this[key];
		}
	}

	__proto.replaceResotre=function(){
		this.__restore();
		this.__reset();
	}

	__proto.setIsMainContext=function(){}
	__proto.drawTextures=function(tex,pos,tx,ty){
		Stat.drawCall+=pos.length / 2;
		var w=tex.width;
		var h=tex.height;
		for (var i=0,sz=pos.length;i < sz;i+=2){
			this.drawTexture(tex,pos[i],pos[i+1],w,h,tx,ty);
		}
	}

	/***@private */
	__proto.drawCanvas=function(canvas,x,y,width,height){
		Stat.drawCall++;
		this.drawImage(canvas.source,x,y,width,height);
	}

	/***@private */
	__proto.fillRect=function(x,y,width,height,style){
		Stat.drawCall++;
		style && (this.fillStyle=style);
		this.__fillRect(x,y,width,height);
	}

	/***@private */
	__proto.fillText=function(text,x,y,font,color,textAlign){
		Stat.drawCall++;
		if (arguments.length > 3 && font !=null){
			this.font=font;
			this.fillStyle=color;
			this.textAlign=textAlign;
			this.textBaseline="top";
		}
		this.__fillText(text,x,y);
	}

	/***@private */
	__proto.fillBorderText=function(text,x,y,font,fillColor,borderColor,lineWidth,textAlign){
		Stat.drawCall++;
		this.font=font;
		this.fillStyle=fillColor;
		this.textBaseline="top";
		this.strokeStyle=borderColor;
		this.lineWidth=lineWidth;
		this.textAlign=textAlign;
		this.__strokeText(text,x,y);
		this.__fillText(text,x,y);
	}

	/***@private */
	__proto.strokeText=function(text,x,y,font,color,lineWidth,textAlign){
		Stat.drawCall++;
		if (arguments.length > 3 && font !=null){
			this.font=font;
			this.strokeStyle=color;
			this.lineWidth=lineWidth;
			this.textAlign=textAlign;
			this.textBaseline="top";
		}
		this.__strokeText(text,x,y);
	}

	/***@private */
	__proto.transformByMatrix=function(value){
		this.transform(value.a,value.b,value.c,value.d,value.tx,value.ty);
	}

	/***@private */
	__proto.setTransformByMatrix=function(value){
		this.setTransform(value.a,value.b,value.c,value.d,value.tx,value.ty);
	}

	/***@private */
	__proto.clipRect=function(x,y,width,height){
		Stat.drawCall++;
		this.beginPath();
		this.rect(x,y,width,height);
		this.clip();
	}

	/***@private */
	__proto.drawTexture=function(tex,x,y,width,height,tx,ty){
		Stat.drawCall++;
		var uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;
		this.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,x+tx,y+ty,width,height);
	}

	/***@private */
	__proto.drawTextureWithTransform=function(tex,x,y,width,height,m,tx,ty,alpha){
		Stat.drawCall++;
		var uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;
		this.save();
		alpha !=1 && (this.globalAlpha *=alpha);
		if (m){
			this.transform(m.a,m.b,m.c,m.d,m.tx+tx,m.ty+ty);
			this.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,x ,y,width,height);
			}else {
			this.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,x+tx ,y+ty,width,height);
		}
		this.restore();
	}

	/***@private */
	__proto.drawTexture2=function(x,y,pivotX,pivotY,m,alpha,blendMode,args2){
		var tex=args2[0];
		if (!(tex.loaded && tex.bitmap && tex.source)){
			return;
		}
		Stat.drawCall++;
		var alphaChanged=alpha!==1;
		if (alphaChanged){
			var temp=this.globalAlpha;
			this.globalAlpha *=alpha;
		};
		var uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;
		if (m){
			this.save();
			this.transform(m.a,m.b,m.c,m.d,m.tx+x,m.ty+y);
			this.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,args2[1]-pivotX ,args2[2]-pivotY,args2[3],args2[4]);
			this.restore();
			}else {
			this.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,args2[1]-pivotX+x ,args2[2]-pivotY+y,args2[3],args2[4]);
		}
		if (alphaChanged)this.globalAlpha=temp;
	}

	__proto.fillTexture=function(texture,x,y,width,height,type,offset,other){
		if (!other.pat){
			if (texture.uv !=Texture.DEF_UV){
				var canvas=new HTMLCanvas("2D");
				canvas.getContext('2d');
				canvas.size(texture.width,texture.height);
				canvas.context.drawTexture(texture,0,0,texture.width,texture.height,0,0);
				texture=new Texture(canvas);
			}
			other.pat=this.createPattern(texture.bitmap.source,type);
		};
		var oX=x,oY=y;
		var sX=0,sY=0;
		if (offset){
			oX+=offset.x % texture.width;
			oY+=offset.y % texture.height;
			sX-=offset.x % texture.width;
			sY-=offset.y % texture.height;
		}
		this.translate(oX,oY);
		this.fillRect(sX,sY,width,height,other.pat);
		this.translate(-oX,-oY);
	}

	__proto.drawTriangle=function(texture,vertices,uvs,index0,index1,index2,matrix,canvasPadding){
		var source=texture.bitmap;
		var textureSource=source.source;
		var textureWidth=texture.width;
		var textureHeight=texture.height;
		var sourceWidth=source.width;
		var sourceHeight=source.height;
		var u0=uvs[index0] *sourceWidth;
		var u1=uvs[index1] *sourceWidth;
		var u2=uvs[index2] *sourceWidth;
		var v0=uvs[index0+1] *sourceHeight;
		var v1=uvs[index1+1] *sourceHeight;
		var v2=uvs[index2+1] *sourceHeight;
		var x0=vertices[index0];
		var x1=vertices[index1];
		var x2=vertices[index2];
		var y0=vertices[index0+1];
		var y1=vertices[index1+1];
		var y2=vertices[index2+1];
		if (canvasPadding){
			var paddingX=1;
			var paddingY=1;
			var centerX=(x0+x1+x2)/ 3;
			var centerY=(y0+y1+y2)/ 3;
			var normX=x0-centerX;
			var normY=y0-centerY;
			var dist=Math.sqrt((normX *normX)+(normY *normY));
			x0=centerX+((normX / dist)*(dist+paddingX));
			y0=centerY+((normY / dist)*(dist+paddingY));
			normX=x1-centerX;
			normY=y1-centerY;
			dist=Math.sqrt((normX *normX)+(normY *normY));
			x1=centerX+((normX / dist)*(dist+paddingX));
			y1=centerY+((normY / dist)*(dist+paddingY));
			normX=x2-centerX;
			normY=y2-centerY;
			dist=Math.sqrt((normX *normX)+(normY *normY));
			x2=centerX+((normX / dist)*(dist+paddingX));
			y2=centerY+((normY / dist)*(dist+paddingY));
		}
		this.save();
		if (matrix)
			this.transform(matrix.a,matrix.b,matrix.c,matrix.d,matrix.tx,matrix.ty);
		this.beginPath();
		this.moveTo(x0,y0);
		this.lineTo(x1,y1);
		this.lineTo(x2,y2);
		this.closePath();
		this.clip();
		var delta=(u0 *v1)+(v0 *u2)+(u1 *v2)-(v1 *u2)-(v0 *u1)-(u0 *v2);
		var dDelta=1 / delta;
		var deltaA=(x0 *v1)+(v0 *x2)+(x1 *v2)-(v1 *x2)-(v0 *x1)-(x0 *v2);
		var deltaB=(u0 *x1)+(x0 *u2)+(u1 *x2)-(x1 *u2)-(x0 *u1)-(u0 *x2);
		var deltaC=(u0 *v1 *x2)+(v0 *x1 *u2)+(x0 *u1 *v2)-(x0 *v1 *u2)-(v0 *u1 *x2)-(u0 *x1 *v2);
		var deltaD=(y0 *v1)+(v0 *y2)+(y1 *v2)-(v1 *y2)-(v0 *y1)-(y0 *v2);
		var deltaE=(u0 *y1)+(y0 *u2)+(u1 *y2)-(y1 *u2)-(y0 *u1)-(u0 *y2);
		var deltaF=(u0 *v1 *y2)+(v0 *y1 *u2)+(y0 *u1 *v2)-(y0 *v1 *u2)-(v0 *u1 *y2)-(u0 *y1 *v2);
		this.transform(deltaA *dDelta,deltaD *dDelta,deltaB *dDelta,deltaE *dDelta,deltaC *dDelta,deltaF *dDelta);
		this.drawImage(textureSource,texture.uv[0] *sourceWidth,texture.uv[1] *sourceHeight,textureWidth,textureHeight,texture.uv[0] *sourceWidth,texture.uv[1] *sourceHeight,textureWidth,textureHeight);
		this.restore();
	}

	/***@private */
	__proto.flush=function(){
		return 0;
	}

	/***@private */
	__proto.fillWords=function(words,x,y,font,color,underLine){
		font && (this.font=font);
		color && (this.fillStyle=color);
		var _this=this;
		this.textBaseline="top";
		this.textAlign='left';
		for (var i=0,n=words.length;i < n;i++){
			var a=words[i];
			this.__fillText(a.char,a.x+x,a.y+y);
			if (underLine===1){
				var tHeight=a.height;
				var dX=a.style.letterSpacing*0.5;
				if (!dX)dX=0;
				this.beginPath();
				this.strokeStyle=color;
				this.lineWidth=1;
				this.moveTo(x+a.x-dX+0.5,y+a.y+tHeight+0.5);
				this.lineTo(x+a.x+a.width+dX+0.5,y+a.y+tHeight+0.5);
				this.stroke();
			}
		}
	}

	/***@private */
	__proto.fillBorderWords=function(words,x,y,font,color,borderColor,lineWidth){
		font && (this.font=font);
		color && (this.fillStyle=color);
		this.textBaseline="top";
		this.lineWidth=lineWidth;
		this.textAlign='left';
		this.strokeStyle=borderColor;
		for (var i=0,n=words.length;i < n;i++){
			var a=words[i];
			this.__strokeText(a.char,a.x+x,a.y+y);
			this.__fillText(a.char,a.x+x,a.y+y);
		}
	}

	/***@private */
	__proto.destroy=function(){
		this.canvas.width=this.canvas.height=0;
	}

	/***@private */
	__proto.clear=function(){
		this.clearRect(0,0,this._canvas.width,this._canvas.height);
		this._repaint=false;
	}

	__proto.drawCurves=function(x,y,args){
		this.beginPath();
		this.strokeStyle=args[3];
		this.lineWidth=args[4];
		var points=args[2];
		x+=args[0],y+=args[1];
		this.moveTo(x+points[0],y+points[1]);
		var i=2,n=points.length;
		while (i < n){
			this.quadraticCurveTo(x+points[i++],y+points[i++],x+points[i++],y+points[i++]);
		}
		this.stroke();
	}

	Context.__init__=function(to){
		var from=laya.resource.Context.prototype;
		to=to || CanvasRenderingContext2D.prototype;
		if (to.inited)return;
		to.inited=true;
		to.__fillText=to.fillText;
		to.__fillRect=to.fillRect;
		to.__strokeText=to.strokeText;
		var funs=['drawTextures',"drawTriangle",'fillWords','fillBorderWords','setIsMainContext','fillRect','strokeText','fillTexture','fillText','transformByMatrix','setTransformByMatrix','clipRect','drawTexture','drawTexture2','drawTextureWithTransform','flush','clear','destroy','drawCanvas','fillBorderText','drawCurves'];
		funs.forEach(function(i){
			to[i]=from[i];
		});
	}

	Context.replaceCanvasGetSet=function(tar,key){
		var oldO=Object.getOwnPropertyDescriptor(tar,key);
		if (!oldO||!oldO.configurable)return false;
		var newO={};
		var tkey;
		for (tkey in oldO){
			if (tkey !="set"){
				newO[tkey]=oldO[tkey];
			}
		};
		var preFun=oldO["set"];
		newO["set"]=function (v){
			var _self=this;
			preFun.call(_self,v);
			var _ct=_self.getContext("2d");
			if (_ct && "__reset" in _ct){
				_ct.__reset();
			}
		}
		Object.defineProperty(tar,key,newO);
		return true;
	}

	Context.replaceGetSet=function(tar,key){
		var oldO=Object.getOwnPropertyDescriptor(tar,key);
		if (!oldO||!oldO.configurable)return false;
		var newO={};
		var tkey;
		for (tkey in oldO){
			if (tkey !="set"){
				newO[tkey]=oldO[tkey];
			}
		};
		var preFun=oldO["set"];
		var dataKey="___"+key+"__";
		Context.newKeys.push(dataKey);
		newO["set"]=function (v){
			var _self=this;
			if (v !=_self[dataKey]){
				_self[dataKey]=v;
				preFun.call(_self,v);
			}
		}
		Object.defineProperty(tar,key,newO);
		return true;
	}

	Context._default=new Context();
	Context.newKeys=[];
	__static(Context,
	['replaceKeys',function(){return this.replaceKeys=["font","fillStyle","textBaseline"];}
	]);
	return Context;
})()


/**
*@private
*<code>ResourceManager</code> 是资源管理类。它用于资源的载入、获取、销毁。
*/
//class laya.resource.ResourceManager
var ResourceManager=(function(){
	function ResourceManager(name){
		/**唯一标识ID。*/
		this._id=0;
		/**名字。*/
		this._name=null;
		/**所管理资源。*/
		this._resources=null;
		/**所管理资源的累计内存,以字节为单位。*/
		this._memorySize=0;
		/**垃圾回收比例，范围是0到1。*/
		this._garbageCollectionRate=NaN;
		/**自动释放机制中内存是否溢出。*/
		this._isOverflow=false;
		/**是否启用自动释放机制。*/
		this.autoRelease=false;
		/**自动释放机制的内存触发上限,以字节为单位。*/
		this.autoReleaseMaxSize=0;
		this._id=++ResourceManager._uniqueIDCounter;
		this._name=name ? name :"Content Manager";
		ResourceManager._isResourceManagersSorted=false;
		this._memorySize=0;
		this._isOverflow=false;
		this.autoRelease=false;
		this.autoReleaseMaxSize=1024 *1024 *512;
		this._garbageCollectionRate=0.2;
		ResourceManager._resourceManagers.push(this);
		this._resources=[];
	}

	__class(ResourceManager,'laya.resource.ResourceManager');
	var __proto=ResourceManager.prototype;
	Laya.imps(__proto,{"laya.resource.IDispose":true})
	/**
	*获取指定索引的资源 Resource 对象。
	*@param 索引。
	*@return 资源 Resource 对象。
	*/
	__proto.getResourceByIndex=function(index){
		return this._resources[index];
	}

	/**
	*获取此管理器所管理的资源个数。
	*@return 资源个数。
	*/
	__proto.getResourcesLength=function(){
		return this._resources.length;
	}

	/**
	*添加指定资源。
	*@param resource 需要添加的资源 Resource 对象。
	*@return 是否添加成功。
	*/
	__proto.addResource=function(resource){
		if (resource.resourceManager)
			resource.resourceManager.removeResource(resource);
		var index=this._resources.indexOf(resource);
		if (index===-1){
			resource._resourceManager=this;
			this._resources.push(resource);
			this.addSize(resource.memorySize);
			return true;
		}
		return false;
	}

	/**
	*移除指定资源。
	*@param resource 需要移除的资源 Resource 对象
	*@return 是否移除成功。
	*/
	__proto.removeResource=function(resource){
		var index=this._resources.indexOf(resource);
		if (index!==-1){
			this._resources.splice(index,1);
			resource._resourceManager=null;
			this._memorySize-=resource.memorySize;
			return true;
		}
		return false;
	}

	/**
	*卸载此资源管理器载入的资源。
	*/
	__proto.unload=function(){
		var tempResources=this._resources.slice(0,this._resources.length);
		for (var i=0;i < tempResources.length;i++){
			var resource=tempResources[i];
			resource.destroy();
		}
		tempResources.length=0;
	}

	/**释放资源。*/
	__proto.dispose=function(){
		if (this===ResourceManager._systemResourceManager)
			throw new Error("systemResourceManager不能被释放！");
		ResourceManager._resourceManagers.splice(ResourceManager._resourceManagers.indexOf(this),1);
		ResourceManager._isResourceManagersSorted=false;
		var tempResources=this._resources.slice(0,this._resources.length);
		for (var i=0;i < tempResources.length;i++){
			var resource=tempResources[i];
			resource.resourceManager.removeResource(resource);
			resource.destroy();
		}
		tempResources.length=0;
	}

	/**
	*增加内存。
	*@param add 需要增加的内存大小。
	*/
	__proto.addSize=function(add){
		if (add){
			if (this.autoRelease && add > 0)
				((this._memorySize+add)> this.autoReleaseMaxSize)&& (this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize));
			this._memorySize+=add;
		}
	}

	/**
	*垃圾回收。
	*@param reserveSize 保留尺寸。
	*/
	__proto.garbageCollection=function(reserveSize){
		var all=this._resources;
		all=all.slice();
		all.sort(function(a,b){
			if (!a || !b)
				throw new Error("a或b不能为空！");
			if (a.released && b.released)
				return 0;
			else if (a.released)
			return 1;
			else if (b.released)
			return-1;
			return a._lastUseFrameCount-b._lastUseFrameCount;
		});
		var currentFrameCount=Stat.loopCount;
		for (var i=0,n=all.length;i < n;i++){
			var resou=all[i];
			if (currentFrameCount-resou._lastUseFrameCount > 1){
				resou.releaseResource();
				}else {
				if (this._memorySize >=reserveSize)
					this._isOverflow=true;
				return;
			}
			if (this._memorySize < reserveSize){
				this._isOverflow=false;
				return;
			}
		}
	}

	/**
	*唯一标识 ID 。
	*/
	__getset(0,__proto,'id',function(){
		return this._id;
	});

	/**
	*名字。
	*/
	__getset(0,__proto,'name',function(){
		return this._name;
		},function(value){
		if ((value || value!=="")&& this._name!==value){
			this._name=value;
			ResourceManager._isResourceManagersSorted=false;
		}
	});

	/**
	*此管理器所管理资源的累计内存，以字节为单位。
	*/
	__getset(0,__proto,'memorySize',function(){
		return this._memorySize;
	});

	/**
	*系统资源管理器。
	*/
	__getset(1,ResourceManager,'systemResourceManager',function(){
		return ResourceManager._systemResourceManager;
	});

	ResourceManager.__init__=function(){
		ResourceManager.currentResourceManager=ResourceManager.systemResourceManager;
	}

	ResourceManager.getLoadedResourceManagerByIndex=function(index){
		return ResourceManager._resourceManagers[index];
	}

	ResourceManager.getLoadedResourceManagersCount=function(){
		return ResourceManager._resourceManagers.length;
	}

	ResourceManager.recreateContentManagers=function(force){
		(force===void 0)&& (force=false);
		var temp=ResourceManager.currentResourceManager;
		for (var i=0;i < ResourceManager._resourceManagers.length;i++){
			ResourceManager.currentResourceManager=ResourceManager._resourceManagers[i];
			for (var j=0;j < ResourceManager.currentResourceManager._resources.length;j++){
				ResourceManager.currentResourceManager._resources[j].releaseResource(force);
				ResourceManager.currentResourceManager._resources[j].activeResource(force);
			}
		}
		ResourceManager.currentResourceManager=temp;
	}

	ResourceManager.releaseContentManagers=function(force){
		(force===void 0)&& (force=false);
		var temp=ResourceManager.currentResourceManager;
		for (var i=0;i < ResourceManager._resourceManagers.length;i++){
			ResourceManager.currentResourceManager=ResourceManager._resourceManagers[i];
			for (var j=0;j < ResourceManager.currentResourceManager._resources.length;j++){
				var resource=ResourceManager.currentResourceManager._resources[j];
				(!resource.released)&& (resource.releaseResource(force));
			}
		}
		ResourceManager.currentResourceManager=temp;
	}

	ResourceManager._uniqueIDCounter=0;
	ResourceManager._isResourceManagersSorted=false;
	ResourceManager._resourceManagers=[];
	__static(ResourceManager,
	['_systemResourceManager',function(){return this._systemResourceManager=new ResourceManager("System Resource Manager");},'currentResourceManager',function(){return this.currentResourceManager=ResourceManager._systemResourceManager;}
	]);
	return ResourceManager;
})()


/**
*@private
*/
//class laya.system.System
var System=(function(){
	function System(){}
	__class(System,'laya.system.System');
	System.changeDefinition=function(name,classObj){
		Laya[name]=classObj;
		var str=name+"=classObj";
		Laya._runScript(str);
	}

	System.__init__=function(){
		if (Render.isConchApp){
			conch.disableConchResManager();
			conch.disableConchAutoRestoreLostedDevice();
		}
	}

	return System;
})()


/**
*<code>LayoutStyle</code> 是一个布局样式类。
*/
//class laya.ui.LayoutStyle
var LayoutStyle=(function(){
	function LayoutStyle(){
		/**一个布尔值，表示是否有效。*/
		this.enable=false;
		this.top=NaN;
		this.bottom=NaN;
		this.left=NaN;
		this.right=NaN;
		this.centerX=NaN;
		this.centerY=NaN;
		this.anchorX=NaN;
		this.anchorY=NaN;
	}

	__class(LayoutStyle,'laya.ui.LayoutStyle');
	__static(LayoutStyle,
	['EMPTY',function(){return this.EMPTY=new LayoutStyle();}
	]);
	return LayoutStyle;
})()


/**
*<code>Styles</code> 定义了组件常用的样式属性。
*/
//class laya.ui.Styles
var Styles=(function(){
	function Styles(){}
	__class(Styles,'laya.ui.Styles');
	Styles.labelColor="#000000";
	Styles.buttonStateNum=3;
	Styles.scrollBarMinNum=15;
	Styles.scrollBarDelayTime=500;
	__static(Styles,
	['defaultSizeGrid',function(){return this.defaultSizeGrid=[4,4,4,4,0];},'labelPadding',function(){return this.labelPadding=[2,2,2,2];},'inputLabelPadding',function(){return this.inputLabelPadding=[1,1,1,3];},'buttonLabelColors',function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"];},'comboBoxItemColors',function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"];}
	]);
	return Styles;
})()


/**
*<code>UIUtils</code> 是文本工具集。
*/
//class laya.ui.UIUtils
var UIUtils=(function(){
	function UIUtils(){}
	__class(UIUtils,'laya.ui.UIUtils');
	UIUtils.fillArray=function(arr,str,type){
		var temp=arr.concat();
		if (str){
			var a=str.split(",");
			for (var i=0,n=Math.min(temp.length,a.length);i < n;i++){
				var value=a[i];
				temp[i]=(value=="true" ? true :(value=="false" ? false :value));
				if (type !=null)temp[i]=type(value);
			}
		}
		return temp;
	}

	UIUtils.toColor=function(color){
		return Utils.toHexColor(color);
	}

	UIUtils.gray=function(traget,isGray){
		(isGray===void 0)&& (isGray=true);
		if (isGray){
			UIUtils.addFilter(traget,UIUtils.grayFilter);
			}else {
			UIUtils.clearFilter(traget,ColorFilter);
		}
	}

	UIUtils.addFilter=function(target,filter){
		var filters=target.filters || [];
		filters.push(filter);
		target.filters=filters;
	}

	UIUtils.clearFilter=function(target,filterType){
		var filters=target.filters;
		if (filters !=null && filters.length > 0){
			for (var i=filters.length-1;i >-1;i--){
				var filter=filters[i];
				if (Laya.__typeof(filter,filterType))filters.splice(i,1);
			}
			target.filters=filters;
		}
	}

	UIUtils._getReplaceStr=function(word){
		return UIUtils.escapeSequence[word];
	}

	UIUtils.adptString=function(str){
		return str.replace(/\\(\w)/g,UIUtils._getReplaceStr);
	}

	UIUtils.getBindFun=function(value){
		var fun=UIUtils._funMap.get(value);
		if (fun==null){
			var temp="\""+value+"\"";
			temp=temp.replace(/^"\${|}"$/g,"").replace(/\${/g,"\"+").replace(/}/g,"+\"");
			var str="(function(data){if(data==null)return;with(data){try{\nreturn "+temp+"\n}catch(e){}}})";
			fun=Laya._runScript(str);
			UIUtils._funMap.set(value,fun);
		}
		return fun;
	}

	__static(UIUtils,
	['grayFilter',function(){return this.grayFilter=new ColorFilter([0.3086,0.6094,0.082,0,0,0.3086,0.6094,0.082,0,0,0.3086,0.6094,0.082,0,0,0,0,0,1,0]);},'escapeSequence',function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"};},'_funMap',function(){return this._funMap=new WeakObject();}
	]);
	return UIUtils;
})()


SoundManager;
/**
*<code>Browser</code> 是浏览器代理类。封装浏览器及原生 js 提供的一些功能。
*/
//class laya.utils.Browser
var Browser=(function(){
	function Browser(){}
	__class(Browser,'laya.utils.Browser');
	/**设备像素比。*/
	__getset(1,Browser,'pixelRatio',function(){
		Browser.__init__();
		if (Browser.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1)return 2;
		return RunDriver.getPixelRatio();
	});

	/**浏览器窗口物理高度，其值等于clientHeight *pixelRatio，并且浏览器发生反转之后，宽高会互换。*/
	__getset(1,Browser,'height',function(){
		Browser.__init__();
		return ((Laya.stage && Laya.stage.canvasRotation)? Browser.clientWidth :Browser.clientHeight)*Browser.pixelRatio;
	});

	/**
	*浏览器窗口可视宽度。
	*通过分析浏览器信息获得。浏览器多个属性值优先级为：window.innerWidth(包含滚动条宽度)> document.body.clientWidth(不包含滚动条宽度)，如果前者为0或为空，则选择后者。
	*/
	__getset(1,Browser,'clientWidth',function(){
		Browser.__init__();
		return Browser.window.innerWidth || Browser.document.body.clientWidth;
	});

	/**浏览器原生 window 对象的引用。*/
	__getset(1,Browser,'window',function(){
		Browser.__init__();
		return Browser._window;
	});

	/**
	*浏览器窗口可视高度。
	*通过分析浏览器信息获得。浏览器多个属性值优先级为：window.innerHeight(包含滚动条高度)> document.body.clientHeight(不包含滚动条高度)> document.documentElement.clientHeight(不包含滚动条高度)，如果前者为0或为空，则选择后者。
	*/
	__getset(1,Browser,'clientHeight',function(){
		Browser.__init__();
		return Browser.window.innerHeight || Browser.document.body.clientHeight || Browser.document.documentElement.clientHeight;
	});

	/**浏览器窗口物理宽度，其值等于clientWidth *pixelRatio，并且浏览器发生反转之后，宽高会互换。*/
	__getset(1,Browser,'width',function(){
		Browser.__init__();
		return ((Laya.stage && Laya.stage.canvasRotation)? Browser.clientHeight :Browser.clientWidth)*Browser.pixelRatio;
	});

	/**画布容器，用来盛放画布的容器。方便对画布进行控制*/
	__getset(1,Browser,'container',function(){
		Browser.__init__();
		if (!Browser._container){
			Browser._container=Browser.createElement("div");
			Browser._container.id="layaContainer";
			Browser.document.body.appendChild(Browser._container);
		}
		return Browser._container;
		},function(value){
		Browser._container=value;
	});

	/**浏览器原生 document 对象的引用。*/
	__getset(1,Browser,'document',function(){
		Browser.__init__();
		return Browser._document;
	});

	Browser.__init__=function(){
		SoundManager;
		if (Browser._window)return;
		Browser._window=RunDriver.getWindow();
		Browser._document=Browser.window.document;
		Browser._window.addEventListener('message',function(e){
			laya.utils.Browser._onMessage(e);
		},false);
		Browser.document.__createElement=Browser.document.createElement;
		window.requestAnimationFrame=window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (c){return window.setTimeout(c,1000 / 60);};;
		Browser.userAgent=/*[SAFE]*/ Browser.window.navigator.userAgent;
		Browser.u=/*[SAFE]*/ Browser.userAgent;
		Browser.onIOS=/*[SAFE]*/ !!Browser.u.match(/\(i[^;]+;(U;)? CPU.+Mac OS X/);
		Browser.onMobile=/*[SAFE]*/ Browser.u.indexOf("Mobile")>-1;
		Browser.onIPhone=/*[SAFE]*/ Browser.u.indexOf("iPhone")>-1;
		Browser.onMac=/*[SAFE]*/ Browser.u.indexOf("Mac OS X")>-1;
		Browser.onIPad=/*[SAFE]*/ Browser.u.indexOf("iPad")>-1;
		Browser.onAndriod=/*[SAFE]*/ Browser.u.indexOf('Android')>-1 || Browser.u.indexOf('Adr')>-1;
		Browser.onWP=/*[SAFE]*/ Browser.u.indexOf("Windows Phone")>-1;
		Browser.onQQBrowser=/*[SAFE]*/ Browser.u.indexOf("QQBrowser")>-1;
		Browser.onMQQBrowser=/*[SAFE]*/ Browser.u.indexOf("MQQBrowser")>-1 || (Browser.u.indexOf("Mobile")>-1 && Browser.u.indexOf("QQ")>-1);
		Browser.onIE=/*[SAFE]*/ !!Browser.window.ActiveXObject || "ActiveXObject" in Browser.window;
		Browser.onWeiXin=/*[SAFE]*/ Browser.u.indexOf('MicroMessenger')>-1;
		Browser.onPC=/*[SAFE]*/ !Browser.onMobile;
		Browser.onSafari=/*[SAFE]*/ Browser.u.indexOf("Safari")>-1;
		Browser.onFirefox=/*[SAFE]*/ Browser.u.indexOf('Firefox')>-1;
		Browser.onEdge=/*[SAFE]*/ Browser.u.indexOf('Edge')>-1;
		Browser.onMiniGame=/*[SAFE]*/ Browser.u.indexOf('MiniGame')>-1;
		Browser.onLimixiu=/*[SAFE]*/ Browser.u.indexOf('limixiu')>-1;
		Browser.httpProtocol=/*[SAFE]*/ Browser.window.location.protocol=="http:";
		if (Browser.onMiniGame && Browser.window.focus==null){
			console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0");
		}
		Browser.webAudioEnabled=/*[SAFE]*/ Browser.window["AudioContext"] || Browser.window["webkitAudioContext"] || Browser.window["mozAudioContext"] ? true :false;
		Browser.soundType=/*[SAFE]*/ Browser.webAudioEnabled ? "WEBAUDIOSOUND" :"AUDIOSOUND";
		Sound=Browser.webAudioEnabled?WebAudioSound:AudioSound;;
		if (Browser.webAudioEnabled)WebAudioSound.initWebAudio();;
		AudioSound._initMusicAudio();
		Browser.enableTouch=(('ontouchstart' in window)|| window.DocumentTouch && document instanceof DocumentTouch);
		window.focus();
		SoundManager._soundClass=Sound;;
		SoundManager._musicClass=AudioSound;
		Render._mainCanvas=Render._mainCanvas || HTMLCanvas.create('2D');
		if (Browser.canvas)return;
		Browser.canvas=HTMLCanvas.create('2D');
		Browser.context=Browser.canvas.getContext('2d');
	}

	Browser._onMessage=function(e){
		if (!e.data)return;
		if (e.data.name=="size"){
			Browser.window.innerWidth=e.data.width;
			Browser.window.innerHeight=e.data.height;
			Browser.window.__innerHeight=e.data.clientHeight;
			if (!Browser.document.createEvent){
				console.warn("no document.createEvent");
				return;
			};
			var evt=Browser.document.createEvent("HTMLEvents");
			evt.initEvent("resize",false,false);
			Browser.window.dispatchEvent(evt);
			return;
		}
	}

	Browser.createElement=function(type){
		Browser.__init__();
		return Browser.document.__createElement(type);
	}

	Browser.getElementById=function(type){
		Browser.__init__();
		return Browser.document.getElementById(type);
	}

	Browser.removeElement=function(ele){
		if (ele && ele.parentNode)ele.parentNode.removeChild(ele);
	}

	Browser.now=function(){
		return RunDriver.now();
	}

	Browser._window=null;
	Browser._document=null;
	Browser._container=null;
	Browser.userAgent=null;
	Browser.u=null;
	Browser.onIOS=false;
	Browser.onMac=false;
	Browser.onMobile=false;
	Browser.onIPhone=false;
	Browser.onIPad=false;
	Browser.onAndriod=false;
	Browser.onAndroid=false;
	Browser.onWP=false;
	Browser.onQQBrowser=false;
	Browser.onMQQBrowser=false;
	Browser.onSafari=false;
	Browser.onFirefox=false;
	Browser.onEdge=false;
	Browser.onIE=false;
	Browser.onWeiXin=false;
	Browser.onMiniGame=false;
	Browser.onLimixiu=false;
	Browser.onPC=false;
	Browser.httpProtocol=false;
	Browser.webAudioEnabled=false;
	Browser.soundType=null;
	Browser.enableTouch=false;
	Browser.canvas=null;
	Browser.context=null;
	Browser.__init$=function(){
		AudioSound;
		WebAudioSound;
	}

	return Browser;
})()


/**
*@private
*对象缓存统一管理类
*/
//class laya.utils.CacheManager
var CacheManager=(function(){
	function CacheManager(){}
	__class(CacheManager,'laya.utils.CacheManager');
	CacheManager.regCacheByFunction=function(disposeFunction,getCacheListFunction){
		CacheManager.unRegCacheByFunction(disposeFunction,getCacheListFunction);
		var cache;
		cache={tryDispose:disposeFunction,getCacheList:getCacheListFunction};
		CacheManager._cacheList.push(cache);
	}

	CacheManager.unRegCacheByFunction=function(disposeFunction,getCacheListFunction){
		var i=0,len=0;
		len=CacheManager._cacheList.length;
		for (i=0;i < len;i++){
			if (CacheManager._cacheList[i].tryDispose==disposeFunction && CacheManager._cacheList[i].getCacheList==getCacheListFunction){
				CacheManager._cacheList.splice(i,1);
				return;
			}
		}
	}

	CacheManager.forceDispose=function(){
		var i=0,len=CacheManager._cacheList.length;
		for (i=0;i < len;i++){
			CacheManager._cacheList[i].tryDispose(true);
		}
	}

	CacheManager.beginCheck=function(waitTime){
		(waitTime===void 0)&& (waitTime=15000);
		Laya.timer.loop(waitTime,null,CacheManager._checkLoop);
	}

	CacheManager.stopCheck=function(){
		Laya.timer.clear(null,CacheManager._checkLoop);
	}

	CacheManager._checkLoop=function(){
		var cacheList=CacheManager._cacheList;
		if (cacheList.length < 1)return;
		var tTime=Browser.now();
		var count=0;
		var len=0;
		len=count=cacheList.length;
		while (count > 0){
			CacheManager._index++;
			CacheManager._index=CacheManager._index % len;
			cacheList[CacheManager._index].tryDispose(false);
			if (Browser.now()-tTime > CacheManager.loopTimeLimit)break ;
			count--;
		}
	}

	CacheManager.loopTimeLimit=2;
	CacheManager._cacheList=[];
	CacheManager._index=0;
	return CacheManager;
})()


/**
*<code>ClassUtils</code> 是一个类工具类。
*/
//class laya.utils.ClassUtils
var ClassUtils=(function(){
	function ClassUtils(){}
	__class(ClassUtils,'laya.utils.ClassUtils');
	ClassUtils.regClass=function(className,classDef){
		ClassUtils._classMap[className]=classDef;
	}

	ClassUtils.getRegClass=function(className){
		return ClassUtils._classMap[className];
	}

	ClassUtils.getInstance=function(className){
		var compClass=ClassUtils.getClass(className);
		if (compClass)
			return new compClass();
		else
		console.warn("[error] Undefined class:",className);
		return null;
	}

	ClassUtils.createByJson=function(json,node,root,customHandler,instanceHandler){
		if ((typeof json=='string'))
			json=JSON.parse(json);
		var props=json.props;
		if (!node){
			node=instanceHandler ? instanceHandler.runWith(json):ClassUtils.getInstance(props.runtime || json.type);
			if (!node)
				return null;
		};
		var child=json.child;
		if (child){
			for (var i=0,n=child.length;i < n;i++){
				var data=child[i];
				if ((data.props.name==="render" || data.props.renderType==="render")&& node["_$set_itemRender"])
					node.itemRender=data;
				else {
					if (data.type=="Graphic"){
						ClassUtils.addGraphicsToSprite(data,node);
						}else if (ClassUtils.isDrawType(data.type)){
						ClassUtils.addGraphicToSprite(data,node,true);
						}else {
						var tChild=ClassUtils.createByJson(data,null,root,customHandler,instanceHandler)
						if (data.type=="Script"){
							if (tChild.hasOwnProperty("owner")){
								tChild["owner"]=node;
								}else if (tChild.hasOwnProperty("target")){
								tChild["target"]=node;
							}
							}else if (data.props.renderType=="mask"){
							node.mask=tChild;
							}else {
							node.addChild(tChild);
						}
					}
				}
			}
		}
		if (props){
			for (var prop in props){
				var value=props[prop];
				if (prop==="var" && root){
					root[value]=node;
					}else if ((value instanceof Array)&& (typeof (node[prop])=='function')){
					node[prop].apply(node,value);
					}else {
					node[prop]=value;
				}
			}
		}
		if (customHandler && json.customProps){
			customHandler.runWith([node,json]);
		}
		if (node["created"])
			node.created();
		return node;
	}

	ClassUtils.addGraphicsToSprite=function(graphicO,sprite){
		var graphics;
		graphics=graphicO.child;
		if (!graphics || graphics.length < 1)
			return;
		var g;
		g=ClassUtils._getGraphicsFromSprite(graphicO,sprite);
		var ox=0;
		var oy=0;
		if (graphicO.props){
			ox=ClassUtils._getObjVar(graphicO.props,"x",0);
			oy=ClassUtils._getObjVar(graphicO.props,"y",0);
		}
		if (ox !=0 && oy !=0){
			g.translate(ox,oy);
		};
		var i=0,len=0;
		len=graphics.length;
		for (i=0;i < len;i++){
			ClassUtils._addGraphicToGraphics(graphics[i],g);
		}
		if (ox !=0 && oy !=0){
			g.translate(-ox,-oy);
		}
	}

	ClassUtils.addGraphicToSprite=function(graphicO,sprite,isChild){
		(isChild===void 0)&& (isChild=false);
		var g;
		g=isChild ? ClassUtils._getGraphicsFromSprite(graphicO,sprite):sprite.graphics;
		ClassUtils._addGraphicToGraphics(graphicO,g);
	}

	ClassUtils._getGraphicsFromSprite=function(dataO,sprite){
		var g;
		if (!dataO || !dataO.props)
			return sprite.graphics;
		var propsName;
		propsName=dataO.props.renderType;
		switch (propsName){
			case "hit":
			case "unHit":;
				var hitArea;
				if (!sprite.hitArea){
					sprite.hitArea=new HitArea();
				}
				hitArea=sprite.hitArea;
				if (!hitArea[propsName]){
					hitArea[propsName]=new Graphics();
				}
				g=hitArea[propsName];
				break ;
			default :
			}
		if (!g)
			g=sprite.graphics;
		return g;
	}

	ClassUtils._getTransformData=function(propsO){
		var m;
		if (propsO.hasOwnProperty("pivotX")|| propsO.hasOwnProperty("pivotY")){
			m=m || new Matrix();
			m.translate(-ClassUtils._getObjVar(propsO,"pivotX",0),-ClassUtils._getObjVar(propsO,"pivotY",0));
		};
		var sx=ClassUtils._getObjVar(propsO,"scaleX",1),sy=ClassUtils._getObjVar(propsO,"scaleY",1);
		var rotate=ClassUtils._getObjVar(propsO,"rotation",0);
		var skewX=ClassUtils._getObjVar(propsO,"skewX",0);
		var skewY=ClassUtils._getObjVar(propsO,"skewY",0);
		if (sx !=1 || sy !=1 || rotate !=0){
			m=m || new Matrix();
			m.scale(sx,sy);
			m.rotate(rotate *0.0174532922222222);
		}
		return m;
	}

	ClassUtils._addGraphicToGraphics=function(graphicO,graphic){
		var propsO;
		propsO=graphicO.props;
		if (!propsO)
			return;
		var drawConfig;
		drawConfig=ClassUtils.DrawTypeDic[graphicO.type];
		if (!drawConfig)
			return;
		var g;
		g=graphic;
		var m;
		var params=ClassUtils._getParams(propsO,drawConfig[1],drawConfig[2],drawConfig[3]);
		m=ClassUtils._tM;
		if (m || ClassUtils._alpha !=1){
			g.save();
			if (m)
				g.transform(m);
			if (ClassUtils._alpha !=1)
				g.alpha(ClassUtils._alpha);
		}
		g[drawConfig[0]].apply(g,params);
		if (m || ClassUtils._alpha !=1){
			g.restore();
		}
	}

	ClassUtils._adptLineData=function(params){
		params[2]=parseFloat(params[0])+parseFloat(params[2]);
		params[3]=parseFloat(params[1])+parseFloat(params[3]);
		return params;
	}

	ClassUtils._adptTextureData=function(params){
		params[0]=Loader.getRes(params[0]);
		return params;
	}

	ClassUtils._adptLinesData=function(params){
		params[2]=ClassUtils._getPointListByStr(params[2]);
		return params;
	}

	ClassUtils.isDrawType=function(type){
		if (type=="Image")
			return false;
		return ClassUtils.DrawTypeDic.hasOwnProperty(type);
	}

	ClassUtils._getParams=function(obj,params,xPos,adptFun){
		(xPos===void 0)&& (xPos=0);
		var rst;
		rst=ClassUtils._temParam;
		rst.length=params.length;
		var i=0,len=0;
		len=params.length;
		for (i=0;i < len;i++){
			rst[i]=ClassUtils._getObjVar(obj,params[i][0],params[i][1]);
		}
		ClassUtils._alpha=ClassUtils._getObjVar(obj,"alpha",1);
		var m;
		m=ClassUtils._getTransformData(obj);
		if (m){
			if (!xPos)xPos=0;
			m.translate(rst[xPos],rst[xPos+1]);
			rst[xPos]=rst[xPos+1]=0;
			ClassUtils._tM=m;
			}else {
			ClassUtils._tM=null;
		}
		if (adptFun && ClassUtils[adptFun]){
			rst=ClassUtils[adptFun](rst);
		}
		return rst;
	}

	ClassUtils._getPointListByStr=function(str){
		var pointArr;
		pointArr=str.split(",");
		var i=0,len=0;
		len=pointArr.length;
		for (i=0;i < len;i++){
			pointArr[i]=parseFloat(pointArr[i]);
		}
		return pointArr;
	}

	ClassUtils._getObjVar=function(obj,key,noValue){
		if (obj.hasOwnProperty(key)){
			return obj[key];
		}
		return noValue;
	}

	ClassUtils._temParam=[];
	ClassUtils._classMap={'Sprite':'laya.display.Sprite','Text':'laya.display.Text','Animation':'laya.display.Animation','Skeleton':'laya.ani.bone.Skeleton','Particle2D':'laya.particle.Particle2D','div':'laya.html.dom.HTMLDivElement','p':'laya.html.dom.HTMLElement','img':'laya.html.dom.HTMLImageElement','span':'laya.html.dom.HTMLElement','br':'laya.html.dom.HTMLBrElement','style':'laya.html.dom.HTMLStyleElement','font':'laya.html.dom.HTMLElement','a':'laya.html.dom.HTMLElement','#text':'laya.html.dom.HTMLElement'};
	ClassUtils.getClass=function(className){
		var classObject=ClassUtils._classMap[className] || className;
		if ((typeof classObject=='string'))
			return Laya["__classmap"][classObject];
		return classObject;
	}

	ClassUtils._tM=null;
	ClassUtils._alpha=NaN;
	__static(ClassUtils,
	['DrawTypeDic',function(){return this.DrawTypeDic={"Rect":["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],"Circle":["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],"Pie":["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],"Image":["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],"Texture":["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],"FillTexture":["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],"FillText":["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],"Line":["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],"Lines":["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],"Curves":["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],"Poly":["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]};}
	]);
	return ClassUtils;
})()


/**
*@private
*<code>Color</code> 是一个颜色值处理类。
*/
//class laya.utils.Color
var Color$1=(function(){
	function Color(str){
		/**@private */
		this._color=[];
		/**字符串型颜色值。*/
		//this.strColor=null;
		/**uint 型颜色值。*/
		//this.numColor=0;
		//this._drawStyle=null;
		if ((typeof str=='string')){
			this.strColor=str;
			if (str===null)str="#000000";
			str.charAt(0)=='#' && (str=str.substr(1));
			var len=str.length;
			if (len==3 || len==4){
				var temp="";
				for (var i=0;i < len;i++){
					temp+=(str[i]+str[i]);
				}
				str=temp;
			};
			var color=this.numColor=parseInt(str,16);
			var flag=(str.length==8);
			if (flag){
				this._color=[parseInt(str.substr(0,2),16)/ 255,((0x00FF0000 & color)>> 16)/ 255,((0x0000FF00 & color)>> 8)/ 255,(0x000000FF & color)/ 255];
				return;
			}
			}else {
			color=this.numColor=str;
			this.strColor=Utils.toHexColor(color);
		}
		this._color=[((0xFF0000 & color)>> 16)/ 255,((0xFF00 & color)>> 8)/ 255,(0xFF & color)/ 255,1];
		(this._color).__id=++Color._COLODID;
	}

	__class(Color,'laya.utils.Color',null,'Color$1');
	Color._initDefault=function(){
		Color._DEFAULT={};
		for (var i in Color._COLOR_MAP)Color._SAVE[i]=Color._DEFAULT[i]=new Color(Color._COLOR_MAP[i]);
		return Color._DEFAULT;
	}

	Color._initSaveMap=function(){
		Color._SAVE_SIZE=0;
		Color._SAVE={};
		for (var i in Color._DEFAULT)Color._SAVE[i]=Color._DEFAULT[i];
	}

	Color.create=function(str){
		var color=Color._SAVE[str+""];
		if (color !=null)return color;
		(Color._SAVE_SIZE < 1000)|| Color._initSaveMap();
		return Color._SAVE[str+""]=new Color(str);
	}

	Color._SAVE={};
	Color._SAVE_SIZE=0;
	Color._COLOR_MAP={"white":'#FFFFFF',"red":'#FF0000',"green":'#00FF00',"blue":'#0000FF',"black":'#000000',"yellow":'#FFFF00','gray':'#AAAAAA'};
	Color._DEFAULT=Color._initDefault();
	Color._COLODID=1;
	return Color;
})()


/**
*<code>Dictionary</code> 是一个字典型的数据存取类。
*/
//class laya.utils.Dictionary
var Dictionary=(function(){
	function Dictionary(){
		this._values=[];
		this._keys=[];
	}

	__class(Dictionary,'laya.utils.Dictionary');
	var __proto=Dictionary.prototype;
	/**
	*给指定的键名设置值。
	*@param key 键名。
	*@param value 值。
	*/
	__proto.set=function(key,value){
		var index=this.indexOf(key);
		if (index >=0){
			this._values[index]=value;
			return;
		}
		this._keys.push(key);
		this._values.push(value);
	}

	/**
	*获取指定对象的键名索引。
	*@param key 键名对象。
	*@return 键名索引。
	*/
	__proto.indexOf=function(key){
		var index=this._keys.indexOf(key);
		if (index >=0)return index;
		key=((typeof key=='string'))? Number(key):(((typeof key=='number'))? key.toString():key);
		return this._keys.indexOf(key);
	}

	/**
	*返回指定键名的值。
	*@param key 键名对象。
	*@return 指定键名的值。
	*/
	__proto.get=function(key){
		var index=this.indexOf(key);
		return index < 0 ? null :this._values[index];
	}

	/**
	*移除指定键名的值。
	*@param key 键名对象。
	*@return 是否成功移除。
	*/
	__proto.remove=function(key){
		var index=this.indexOf(key);
		if (index >=0){
			this._keys.splice(index,1);
			this._values.splice(index,1);
			return true;
		}
		return false;
	}

	/**
	*清除此对象的键名列表和键值列表。
	*/
	__proto.clear=function(){
		this._values.length=0;
		this._keys.length=0;
	}

	/**
	*获取所有的子元素列表。
	*/
	__getset(0,__proto,'values',function(){
		return this._values;
	});

	/**
	*获取所有的子元素键名列表。
	*/
	__getset(0,__proto,'keys',function(){
		return this._keys;
	});

	return Dictionary;
})()


/**
*@private
*<code>Dragging</code> 类是触摸滑动控件。
*/
//class laya.utils.Dragging
var Dragging=(function(){
	function Dragging(){
		/**被拖动的对象。*/
		//this.target=null;
		/**缓动衰减系数。*/
		this.ratio=0.92;
		/**单帧最大偏移量。*/
		this.maxOffset=60;
		/**滑动范围。*/
		//this.area=null;
		/**表示拖动是否有惯性。*/
		//this.hasInertia=false;
		/**橡皮筋最大值。*/
		//this.elasticDistance=NaN;
		/**橡皮筋回弹时间，单位为毫秒。*/
		//this.elasticBackTime=NaN;
		/**事件携带数据。*/
		//this.data=null;
		this._dragging=false;
		this._clickOnly=true;
		//this._elasticRateX=NaN;
		//this._elasticRateY=NaN;
		//this._lastX=NaN;
		//this._lastY=NaN;
		//this._offsetX=NaN;
		//this._offsetY=NaN;
		//this._offsets=null;
		//this._disableMouseEvent=false;
		//this._tween=null;
		//this._parent=null;
	}

	__class(Dragging,'laya.utils.Dragging');
	var __proto=Dragging.prototype;
	/**
	*开始拖拽。
	*@param target 待拖拽的 <code>Sprite</code> 对象。
	*@param area 滑动范围。
	*@param hasInertia 拖动是否有惯性。
	*@param elasticDistance 橡皮筋最大值。
	*@param elasticBackTime 橡皮筋回弹时间，单位为毫秒。
	*@param data 事件携带数据。
	*@param disableMouseEvent 鼠标事件是否有效。
	*@param ratio 惯性阻尼系数
	*/
	__proto.start=function(target,area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio){
		(ratio===void 0)&& (ratio=0.92);
		this.clearTimer();
		this.target=target;
		this.area=area;
		this.hasInertia=hasInertia;
		this.elasticDistance=area ? elasticDistance :0;
		this.elasticBackTime=elasticBackTime;
		this.data=data;
		this._disableMouseEvent=disableMouseEvent;
		this.ratio=ratio;
		if (target.globalScaleX !=1 || target.globalScaleY !=1){
			this._parent=target.parent;
			}else {
			this._parent=Laya.stage;
		}
		this._clickOnly=true;
		this._dragging=true;
		this._elasticRateX=this._elasticRateY=1;
		this._lastX=this._parent.mouseX;
		this._lastY=this._parent.mouseY;
		Laya.stage.on("mouseup",this,this.onStageMouseUp);
		Laya.stage.on("mouseout",this,this.onStageMouseUp);
		Laya.timer.frameLoop(1,this,this.loop);
	}

	/**
	*清除计时器。
	*/
	__proto.clearTimer=function(){
		Laya.timer.clear(this,this.loop);
		Laya.timer.clear(this,this.tweenMove);
		if (this._tween){
			this._tween.recover();
			this._tween=null;
		}
	}

	/**
	*停止拖拽。
	*/
	__proto.stop=function(){
		if (this._dragging){
			MouseManager.instance.disableMouseEvent=false;
			Laya.stage.off("mouseup",this,this.onStageMouseUp);
			Laya.stage.off("mouseout",this,this.onStageMouseUp);
			this._dragging=false;
			this.target && this.area && this.backToArea();
			this.clear();
		}
	}

	/**
	*拖拽的循环处理函数。
	*/
	__proto.loop=function(){
		var point=this._parent.getMousePoint();
		var mouseX=point.x;
		var mouseY=point.y;
		var offsetX=mouseX-this._lastX;
		var offsetY=mouseY-this._lastY;
		if (this._clickOnly){
			if (Math.abs(offsetX *Laya.stage._canvasTransform.getScaleX())> 1 || Math.abs(offsetY *Laya.stage._canvasTransform.getScaleY())> 1){
				this._clickOnly=false;
				this._offsets || (this._offsets=[]);
				this._offsets.length=0;
				this.target.event("dragstart",this.data);
				MouseManager.instance.disableMouseEvent=this._disableMouseEvent;
				this.target._set$P("$_MOUSEDOWN",false);
			}else return;
			}else {
			this._offsets.push(offsetX,offsetY);
		}
		if (offsetX===0 && offsetY===0)return;
		this._lastX=mouseX;
		this._lastY=mouseY;
		this.target.x+=offsetX *this._elasticRateX;
		this.target.y+=offsetY *this._elasticRateY;
		this.area && this.checkArea();
		this.target.event("dragmove",this.data);
	}

	/**
	*拖拽区域检测。
	*/
	__proto.checkArea=function(){
		if (this.elasticDistance <=0){
			this.backToArea();
			}else {
			if (this.target.x < this.area.x){
				var offsetX=this.area.x-this.target.x;
				}else if (this.target.x > this.area.x+this.area.width){
				offsetX=this.target.x-this.area.x-this.area.width;
				}else {
				offsetX=0;
			}
			this._elasticRateX=Math.max(0,1-(offsetX / this.elasticDistance));
			if (this.target.y < this.area.y){
				var offsetY=this.area.y-this.target.y;
				}else if (this.target.y > this.area.y+this.area.height){
				offsetY=this.target.y-this.area.y-this.area.height;
				}else {
				offsetY=0;
			}
			this._elasticRateY=Math.max(0,1-(offsetY / this.elasticDistance));
		}
	}

	/**
	*移动至设定的拖拽区域。
	*/
	__proto.backToArea=function(){
		this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width);
		this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height);
	}

	/**
	*舞台的抬起事件侦听函数。
	*@param e Event 对象。
	*/
	__proto.onStageMouseUp=function(e){
		MouseManager.instance.disableMouseEvent=false;
		Laya.stage.off("mouseup",this,this.onStageMouseUp);
		Laya.stage.off("mouseout",this,this.onStageMouseUp);
		Laya.timer.clear(this,this.loop);
		if (this._clickOnly || !this.target)return;
		if (this.hasInertia){
			if (this._offsets.length < 1){
				this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY);
			}
			this._offsetX=this._offsetY=0;
			var len=this._offsets.length;
			var n=Math.min(len,6);
			var m=this._offsets.length-n;
			for (var i=len-1;i > m;i--){
				this._offsetY+=this._offsets[i--];
				this._offsetX+=this._offsets[i];
			}
			this._offsetX=this._offsetX / n *2;
			this._offsetY=this._offsetY / n *2;
			if (Math.abs(this._offsetX)> this.maxOffset)this._offsetX=this._offsetX > 0 ? this.maxOffset :-this.maxOffset;
			if (Math.abs(this._offsetY)> this.maxOffset)this._offsetY=this._offsetY > 0 ? this.maxOffset :-this.maxOffset;
			Laya.timer.frameLoop(1,this,this.tweenMove);
			}else if (this.elasticDistance > 0){
			this.checkElastic();
			}else {
			this.clear();
		}
	}

	/**
	*橡皮筋效果检测。
	*/
	__proto.checkElastic=function(){
		var tx=NaN;
		var ty=NaN;
		if (this.target.x < this.area.x)tx=this.area.x;
		else if (this.target.x > this.area.x+this.area.width)tx=this.area.x+this.area.width;
		if (this.target.y < this.area.y)ty=this.area.y;
		else if (this.target.y > this.area.y+this.area.height)ty=this.area.y+this.area.height;
		if (!isNaN(tx)|| !isNaN(ty)){
			var obj={};
			if (!isNaN(tx))obj.x=tx;
			if (!isNaN(ty))obj.y=ty;
			this._tween=Tween.to(this.target,obj,this.elasticBackTime,Ease.sineOut,Handler.create(this,this.clear),0,false,false);
			}else {
			this.clear();
		}
	}

	/**
	*移动。
	*/
	__proto.tweenMove=function(){
		this._offsetX *=this.ratio *this._elasticRateX;
		this._offsetY *=this.ratio *this._elasticRateY;
		this.target.x+=this._offsetX;
		this.target.y+=this._offsetY;
		this.area && this.checkArea();
		this.target.event("dragmove",this.data);
		if ((Math.abs(this._offsetX)< 1 && Math.abs(this._offsetY)< 1)|| this._elasticRateX < 0.5 || this._elasticRateY < 0.5){
			Laya.timer.clear(this,this.tweenMove);
			if (this.elasticDistance > 0)this.checkElastic();
			else this.clear();
		}
	}

	/**
	*结束拖拽。
	*/
	__proto.clear=function(){
		if (this.target){
			this.clearTimer();
			var sp=this.target;
			this.target=null;
			this._parent=null;
			sp.event("dragend",this.data);
		}
	}

	return Dragging;
})()


/**
*<code>Ease</code> 类定义了缓动函数，以便实现 <code>Tween</code> 动画的缓动效果。
*/
//class laya.utils.Ease
var Ease=(function(){
	function Ease(){}
	__class(Ease,'laya.utils.Ease');
	Ease.linearNone=function(t,b,c,d){
		return c *t / d+b;
	}

	Ease.linearIn=function(t,b,c,d){
		return c *t / d+b;
	}

	Ease.linearInOut=function(t,b,c,d){
		return c *t / d+b;
	}

	Ease.linearOut=function(t,b,c,d){
		return c *t / d+b;
	}

	Ease.bounceIn=function(t,b,c,d){
		return c-Ease.bounceOut(d-t,0,c,d)+b;
	}

	Ease.bounceInOut=function(t,b,c,d){
		if (t < d *0.5)return Ease.bounceIn(t *2,0,c,d)*.5+b;
		else return Ease.bounceOut(t *2-d,0,c,d)*.5+c *.5+b;
	}

	Ease.bounceOut=function(t,b,c,d){
		if ((t /=d)< (1 / 2.75))return c *(7.5625 *t *t)+b;
		else if (t < (2 / 2.75))return c *(7.5625 *(t-=(1.5 / 2.75))*t+.75)+b;
		else if (t < (2.5 / 2.75))return c *(7.5625 *(t-=(2.25 / 2.75))*t+.9375)+b;
		else return c *(7.5625 *(t-=(2.625 / 2.75))*t+.984375)+b;
	}

	Ease.backIn=function(t,b,c,d,s){
		(s===void 0)&& (s=1.70158);
		return c *(t /=d)*t *((s+1)*t-s)+b;
	}

	Ease.backInOut=function(t,b,c,d,s){
		(s===void 0)&& (s=1.70158);
		if ((t /=d *0.5)< 1)return c *0.5 *(t *t *(((s *=(1.525))+1)*t-s))+b;
		return c / 2 *((t-=2)*t *(((s *=(1.525))+1)*t+s)+2)+b;
	}

	Ease.backOut=function(t,b,c,d,s){
		(s===void 0)&& (s=1.70158);
		return c *((t=t / d-1)*t *((s+1)*t+s)+1)+b;
	}

	Ease.elasticIn=function(t,b,c,d,a,p){
		(a===void 0)&& (a=0);
		(p===void 0)&& (p=0);
		var s;
		if (t==0)return b;
		if ((t /=d)==1)return b+c;
		if (!p)p=d *.3;
		if (!a || (c > 0 && a < c)|| (c < 0 && a <-c)){
			a=c;
			s=p / 4;
		}else s=p / Ease.PI2 *Math.asin(c / a);
		return-(a *Math.pow(2,10 *(t-=1))*Math.sin((t *d-s)*Ease.PI2 / p))+b;
	}

	Ease.elasticInOut=function(t,b,c,d,a,p){
		(a===void 0)&& (a=0);
		(p===void 0)&& (p=0);
		var s;
		if (t==0)return b;
		if ((t /=d *0.5)==2)return b+c;
		if (!p)p=d *(.3 *1.5);
		if (!a || (c > 0 && a < c)|| (c < 0 && a <-c)){
			a=c;
			s=p / 4;
		}else s=p / Ease.PI2 *Math.asin(c / a);
		if (t < 1)return-.5 *(a *Math.pow(2,10 *(t-=1))*Math.sin((t *d-s)*Ease.PI2 / p))+b;
		return a *Math.pow(2,-10 *(t-=1))*Math.sin((t *d-s)*Ease.PI2 / p)*.5+c+b;
	}

	Ease.elasticOut=function(t,b,c,d,a,p){
		(a===void 0)&& (a=0);
		(p===void 0)&& (p=0);
		var s;
		if (t==0)return b;
		if ((t /=d)==1)return b+c;
		if (!p)p=d *.3;
		if (!a || (c > 0 && a < c)|| (c < 0 && a <-c)){
			a=c;
			s=p / 4;
		}else s=p / Ease.PI2 *Math.asin(c / a);
		return (a *Math.pow(2,-10 *t)*Math.sin((t *d-s)*Ease.PI2 / p)+c+b);
	}

	Ease.strongIn=function(t,b,c,d){
		return c *(t /=d)*t *t *t *t+b;
	}

	Ease.strongInOut=function(t,b,c,d){
		if ((t /=d *0.5)< 1)return c *0.5 *t *t *t *t *t+b;
		return c *0.5 *((t-=2)*t *t *t *t+2)+b;
	}

	Ease.strongOut=function(t,b,c,d){
		return c *((t=t / d-1)*t *t *t *t+1)+b;
	}

	Ease.sineInOut=function(t,b,c,d){
		return-c *0.5 *(Math.cos(Math.PI *t / d)-1)+b;
	}

	Ease.sineIn=function(t,b,c,d){
		return-c *Math.cos(t / d *Ease.HALF_PI)+c+b;
	}

	Ease.sineOut=function(t,b,c,d){
		return c *Math.sin(t / d *Ease.HALF_PI)+b;
	}

	Ease.quintIn=function(t,b,c,d){
		return c *(t /=d)*t *t *t *t+b;
	}

	Ease.quintInOut=function(t,b,c,d){
		if ((t /=d *0.5)< 1)return c *0.5 *t *t *t *t *t+b;
		return c *0.5 *((t-=2)*t *t *t *t+2)+b;
	}

	Ease.quintOut=function(t,b,c,d){
		return c *((t=t / d-1)*t *t *t *t+1)+b;
	}

	Ease.quartIn=function(t,b,c,d){
		return c *(t /=d)*t *t *t+b;
	}

	Ease.quartInOut=function(t,b,c,d){
		if ((t /=d *0.5)< 1)return c *0.5 *t *t *t *t+b;
		return-c *0.5 *((t-=2)*t *t *t-2)+b;
	}

	Ease.quartOut=function(t,b,c,d){
		return-c *((t=t / d-1)*t *t *t-1)+b;
	}

	Ease.cubicIn=function(t,b,c,d){
		return c *(t /=d)*t *t+b;
	}

	Ease.cubicInOut=function(t,b,c,d){
		if ((t /=d *0.5)< 1)return c *0.5 *t *t *t+b;
		return c *0.5 *((t-=2)*t *t+2)+b;
	}

	Ease.cubicOut=function(t,b,c,d){
		return c *((t=t / d-1)*t *t+1)+b;
	}

	Ease.quadIn=function(t,b,c,d){
		return c *(t /=d)*t+b;
	}

	Ease.quadInOut=function(t,b,c,d){
		if ((t /=d *0.5)< 1)return c *0.5 *t *t+b;
		return-c *0.5 *((--t)*(t-2)-1)+b;
	}

	Ease.quadOut=function(t,b,c,d){
		return-c *(t /=d)*(t-2)+b;
	}

	Ease.expoIn=function(t,b,c,d){
		return (t==0)? b :c *Math.pow(2,10 *(t / d-1))+b-c *0.001;
	}

	Ease.expoInOut=function(t,b,c,d){
		if (t==0)return b;
		if (t==d)return b+c;
		if ((t /=d *0.5)< 1)return c *0.5 *Math.pow(2,10 *(t-1))+b;
		return c *0.5 *(-Math.pow(2,-10 *--t)+2)+b;
	}

	Ease.expoOut=function(t,b,c,d){
		return (t==d)? b+c :c *(-Math.pow(2,-10 *t / d)+1)+b;
	}

	Ease.circIn=function(t,b,c,d){
		return-c *(Math.sqrt(1-(t /=d)*t)-1)+b;
	}

	Ease.circInOut=function(t,b,c,d){
		if ((t /=d *0.5)< 1)return-c *0.5 *(Math.sqrt(1-t *t)-1)+b;
		return c *0.5 *(Math.sqrt(1-(t-=2)*t)+1)+b;
	}

	Ease.circOut=function(t,b,c,d){
		return c *Math.sqrt(1-(t=t / d-1)*t)+b;
	}

	Ease.HALF_PI=Math.PI *0.5;
	Ease.PI2=Math.PI *2;
	return Ease;
})()


/**
*鼠标点击区域，可以设置绘制一系列矢量图作为点击区域和非点击区域（目前只支持圆形，矩形，多边形）
*/
//class laya.utils.HitArea
var HitArea=(function(){
	function HitArea(){
		/**@private */
		this._hit=null;
		/**@private */
		this._unHit=null;
	}

	__class(HitArea,'laya.utils.HitArea');
	var __proto=HitArea.prototype;
	/**
	*是否包含某个点
	*@param x x坐标
	*@param y y坐标
	*@return 是否点击到
	*/
	__proto.isHit=function(x,y){
		if (!HitArea.isHitGraphic(x,y,this.hit))return false;
		return !HitArea.isHitGraphic(x,y,this.unHit);
	}

	/**
	*检测对象是否包含指定的点。
	*@param x 点的 X 轴坐标值（水平位置）。
	*@param y 点的 Y 轴坐标值（垂直位置）。
	*@return 如果包含指定的点，则值为 true；否则为 false。
	*/
	__proto.contains=function(x,y){
		return this.isHit(x,y);
	}

	/**
	*可点击区域，可以设置绘制一系列矢量图作为点击区域（目前只支持圆形，矩形，多边形）
	*/
	__getset(0,__proto,'hit',function(){
		if (!this._hit)this._hit=new Graphics();
		return this._hit;
		},function(value){
		this._hit=value;
	});

	/**
	*不可点击区域，可以设置绘制一系列矢量图作为非点击区域（目前只支持圆形，矩形，多边形）
	*/
	__getset(0,__proto,'unHit',function(){
		if (!this._unHit)this._unHit=new Graphics();
		return this._unHit;
		},function(value){
		this._unHit=value;
	});

	HitArea.isHitGraphic=function(x,y,graphic){
		if (!graphic)return false;
		var cmds;
		cmds=graphic.cmds;
		if (!cmds && graphic._one){
			cmds=HitArea._cmds;
			cmds.length=1;
			cmds[0]=graphic._one;
		}
		if (!cmds)return false;
		var i=0,len=0;
		len=cmds.length;
		var cmd;
		for (i=0;i < len;i++){
			cmd=cmds[i];
			if (!cmd)continue ;
			var context=Render._context;
			switch (cmd.callee){
				case context._translate:
				case 6:
					x-=cmd[0];
					y-=cmd[1];
				default :
				}
			if (HitArea.isHitCmd(x,y,cmd))return true;
		}
		return false;
	}

	HitArea.isHitCmd=function(x,y,cmd){
		if (!cmd)return false;
		var context=Render._context;
		var rst=false;
		switch (cmd["callee"]){
			case context._drawRect:
			case 13:
				HitArea._rec.setTo(cmd[0],cmd[1],cmd[2],cmd[3]);
				rst=HitArea._rec.contains(x,y);
				break ;
			case context._drawCircle:
			case context._fillCircle:
			case 14:;
				var d=NaN;
				x-=cmd[0];
				y-=cmd[1];
				d=x *x+y *y;
				rst=d < cmd[2] *cmd[2];
				break ;
			case context._drawPoly:
			case 18:
				x-=cmd[0];
				y-=cmd[1];
				rst=HitArea.ptInPolygon(x,y,cmd[2]);
				break ;
			default :
				break ;
			}
		return rst;
	}

	HitArea.ptInPolygon=function(x,y,areaPoints){
		var p;
		p=HitArea._ptPoint;
		p.setTo(x,y);
		var nCross=0;
		var p1x=NaN,p1y=NaN,p2x=NaN,p2y=NaN;
		var len=0;
		len=areaPoints.length;
		for (var i=0;i < len;i+=2){
			p1x=areaPoints[i];
			p1y=areaPoints[i+1];
			p2x=areaPoints[(i+2)% len];
			p2y=areaPoints[(i+3)% len];
			if (p1y==p2y)
				continue ;
			if (p.y < Math.min(p1y,p2y))
				continue ;
			if (p.y >=Math.max(p1y,p2y))
				continue ;
			var tx=(p.y-p1y)*(p2x-p1x)/ (p2y-p1y)+p1x;
			if (tx > p.x){
				nCross++;
			}
		}
		return (nCross % 2==1);
	}

	HitArea._cmds=[];
	__static(HitArea,
	['_rec',function(){return this._rec=new Rectangle();},'_ptPoint',function(){return this._ptPoint=new Point();}
	]);
	return HitArea;
})()


/**
*@private
*<code>HTMLChar</code> 是一个 HTML 字符类。
*/
//class laya.utils.HTMLChar
var HTMLChar=(function(){
	function HTMLChar(char,w,h,style){
		//this._sprite=null;
		//this._x=NaN;
		//this._y=NaN;
		//this._w=NaN;
		//this._h=NaN;
		/**表示是否是正常单词(英文|.|数字)。*/
		//this.isWord=false;
		/**字符。*/
		//this.char=null;
		/**字符数量。*/
		//this.charNum=NaN;
		/**CSS 样式。*/
		//this.style=null;
		this.char=char;
		this.charNum=char.charCodeAt(0);
		this._x=this._y=0;
		this.width=w;
		this.height=h;
		this.style=style;
		this.isWord=!HTMLChar._isWordRegExp.test(char);
	}

	__class(HTMLChar,'laya.utils.HTMLChar');
	var __proto=HTMLChar.prototype;
	Laya.imps(__proto,{"laya.display.ILayout":true})
	/**
	*设置与此对象绑定的显示对象 <code>Sprite</code> 。
	*@param sprite 显示对象 <code>Sprite</code> 。
	*/
	__proto.setSprite=function(sprite){
		this._sprite=sprite;
	}

	/**
	*获取与此对象绑定的显示对象 <code>Sprite</code>。
	*@return
	*/
	__proto.getSprite=function(){
		return this._sprite;
	}

	/**@private */
	__proto._isChar=function(){
		return true;
	}

	/**@private */
	__proto._getCSSStyle=function(){
		return this.style;
	}

	/**
	*宽度。
	*/
	__getset(0,__proto,'width',function(){
		return this._w;
		},function(value){
		this._w=value;
	});

	/**
	*此对象存储的 X 轴坐标值。
	*当设置此值时，如果此对象有绑定的 Sprite 对象，则改变 Sprite 对象的属性 x 的值。
	*/
	__getset(0,__proto,'x',function(){
		return this._x;
		},function(value){
		if (this._sprite){
			this._sprite.x=value;
		}
		this._x=value;
	});

	/**
	*此对象存储的 Y 轴坐标值。
	*当设置此值时，如果此对象有绑定的 Sprite 对象，则改变 Sprite 对象的属性 y 的值。
	*/
	__getset(0,__proto,'y',function(){
		return this._y;
		},function(value){
		if (this._sprite){
			this._sprite.y=value;
		}
		this._y=value;
	});

	/**
	*高度。
	*/
	__getset(0,__proto,'height',function(){
		return this._h;
		},function(value){
		this._h=value;
	});

	HTMLChar._isWordRegExp=new RegExp("[\\w\.]","");
	return HTMLChar;
})()


/**
*<code>Log</code> 类用于在界面内显示日志记录信息。
*/
//class laya.utils.Log
var Log=(function(){
	function Log(){}
	__class(Log,'laya.utils.Log');
	Log.enable=function(){
		if (!Log._logdiv){
			Log._logdiv=Browser.window.document.createElement('div');
			Browser.window.document.body.appendChild(Log._logdiv);
			Log._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;";
		}
	}

	Log.toggle=function(){
		var style=Log._logdiv.style;
		if (style.width=="1px"){
			style.width=style.height="50%";
			}else {
			style.width=style.height="1px";
		}
	}

	Log.print=function(value){
		if (Log._logdiv){
			if (Log._count >=Log.maxCount)Log.clear();
			Log._count++;
			Log._logdiv.innerText+=value+"\n";
			Log._logdiv.scrollTop=Log._logdiv.scrollHeight;
		}
	}

	Log.clear=function(){
		Log._logdiv.innerText="";
		Log._count=0;
	}

	Log._logdiv=null;
	Log._count=0;
	Log.maxCount=20;
	return Log;
})()


/**
*<p> <code>Pool</code> 是对象池类，用于对象的存贮、重复使用。</p>
*<p>合理使用对象池，可以有效减少对象创建的开销，避免频繁的垃圾回收，从而优化游戏流畅度。</p>
*/
//class laya.utils.Pool
var Pool=(function(){
	function Pool(){}
	__class(Pool,'laya.utils.Pool');
	Pool.getPoolBySign=function(sign){
		return Pool._poolDic[sign] || (Pool._poolDic[sign]=[]);
	}

	Pool.clearBySign=function(sign){
		if (Pool._poolDic[sign])Pool._poolDic[sign].length=0;
	}

	Pool.recover=function(sign,item){
		if (item["__InPool"])return;
		item["__InPool"]=true;
		Pool.getPoolBySign(sign).push(item);
	}

	Pool.getItemByClass=function(sign,cls){
		var pool=Pool.getPoolBySign(sign);
		var rst=pool.length ? pool.pop():new cls();
		rst["__InPool"]=false;
		return rst;
	}

	Pool.getItemByCreateFun=function(sign,createFun){
		var pool=Pool.getPoolBySign(sign);
		var rst=pool.length ? pool.pop():createFun();
		rst["__InPool"]=false;
		return rst;
	}

	Pool.getItem=function(sign){
		var pool=Pool.getPoolBySign(sign);
		var rst=pool.length ? pool.pop():null;
		if (rst){
			rst["__InPool"]=false;
		}
		return rst;
	}

	Pool._poolDic={};
	Pool.InPoolSign="__InPool";
	return Pool;
})()


/**
*<p> <code>Stat</code> 是一个性能统计面板，可以实时更新相关的性能参数。</p>
*<p>参与统计的性能参数如下（所有参数都是每大约1秒进行更新）：<br/>
*FPS(Canvas)/FPS(WebGL)：Canvas 模式或者 WebGL 模式下的帧频，也就是每秒显示的帧数，值越高、越稳定，感觉越流畅；<br/>
*Sprite：统计所有渲染节点（包括容器）数量，它的大小会影响引擎进行节点遍历、数据组织和渲染的效率。其值越小，游戏运行效率越高；<br/>
*DrawCall：此值是决定性能的重要指标，其值越小，游戏运行效率越高。Canvas模式下表示每大约1秒的图像绘制次数；WebGL模式下表示每大约1秒的渲染提交批次，每次准备数据并通知GPU渲染绘制的过程称为1次DrawCall，在每次DrawCall中除了在通知GPU的渲染上比较耗时之外，切换材质与shader也是非常耗时的操作；<br/>
*CurMem：Canvas模式下，表示内存占用大小，值越小越好，过高会导致游戏闪退；WebGL模式下，表示内存与显存的占用，值越小越好；<br/>
*Shader：是 WebGL 模式独有的性能指标，表示每大约1秒 Shader 提交次数，值越小越好；<br/>
*Canvas：由三个数值组成，只有设置 CacheAs 后才会有值，默认为0/0/0。从左到右数值的意义分别为：每帧重绘的画布数量 / 缓存类型为"normal"类型的画布数量 / 缓存类型为"bitmap"类型的画布数量。</p>
*/
//class laya.utils.Stat
var Stat=(function(){
	function Stat(){}
	__class(Stat,'laya.utils.Stat');
	/**
	*点击性能统计显示区域的处理函数。
	*/
	__getset(1,Stat,'onclick',null,function(fn){
		if (Stat._sp){
			Stat._sp.on("click",Stat._sp,fn);
		}
		if (Stat._canvas){
			Stat._canvas.source.onclick=fn;
			Stat._canvas.source.style.pointerEvents='';
		}
	});

	Stat.show=function(x,y){
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		if (Render.isConchApp && !Render.isConchWebGL){
			Browser.window.conch.showFPS && Browser.window.conch.showFPS(x,y);
			return;
		}
		if (!Render.isConchWebGL && !Browser.onMiniGame &&! Browser.onLimixiu)Stat._useCanvas=true;
		Stat._show=true;
		Stat._fpsData.length=60;
		Stat._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"};
		Stat._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"};
		Stat._view[2]={title:"DrawCall",value:"drawCall",color:"white",units:"int"};
		Stat._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"};
		if (Render.isWebGL){
			Stat._view[4]={title:"Shader",value:"shaderCall",color:"white",units:"int"};
			if (!Render.is3DMode){
				Stat._view[0].title="FPS(WebGL)";
				Stat._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};
				}else {
				Stat._view[0].title="FPS(3D)";
				Stat._view[5]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"};
				Stat._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"};
				Stat._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"};
			}
			}else {
			Stat._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};
		}
		if (Stat._useCanvas){
			Stat.createUIPre(x,y);
		}else
		Stat.createUI(x,y);
		Stat.enable();
	}

	Stat.createUIPre=function(x,y){
		var pixel=Browser.pixelRatio;
		Stat._width=pixel *130;
		Stat._vx=pixel *75;
		Stat._height=pixel *(Stat._view.length *12+3 *pixel)+4;
		Stat._fontSize=12 *pixel;
		for (var i=0;i < Stat._view.length;i++){
			Stat._view[i].x=4;
			Stat._view[i].y=i *Stat._fontSize+2 *pixel;
		}
		if (!Stat._canvas){
			Stat._canvas=new HTMLCanvas('2D');
			Stat._canvas.size(Stat._width,Stat._height);
			Stat._ctx=Stat._canvas.getContext('2d');
			Stat._ctx.textBaseline="top";
			Stat._ctx.font=Stat._fontSize+"px Sans-serif";
			Stat._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+x+"px;top:"+y+"px;width:"+(Stat._width / pixel)+"px;height:"+(Stat._height / pixel)+"px;";
		}
		Stat._first=true;
		Stat.loop();
		Stat._first=false;
		Browser.container.appendChild(Stat._canvas.source);
	}

	Stat.createUI=function(x,y){
		var stat=Stat._sp;
		var pixel=Browser.pixelRatio;
		if (!stat){
			stat=new Sprite();
			Stat._leftText=new Text();
			Stat._leftText.pos(5,5);
			Stat._leftText.color="#ffffff";
			stat.addChild(Stat._leftText);
			Stat._txt=new Text();
			Stat._txt.pos(80*pixel,5);
			Stat._txt.color="#ffffff";
			stat.addChild(Stat._txt);
			Stat._sp=stat;
		}
		stat.pos(x,y);
		var text="";
		for (var i=0;i < Stat._view.length;i++){
			var one=Stat._view[i];
			text+=one.title+"\n";
		}
		Stat._leftText.text=text;
		var width=pixel *138;
		var height=pixel *(Stat._view.length *12+3 *pixel)+4;
		Stat._txt.fontSize=Stat._fontSize *pixel;
		Stat._leftText.fontSize=Stat._fontSize *pixel;
		stat.size(width,height);
		stat.graphics.clear();
		stat.graphics.setAlpha(0.5);
		stat.graphics.drawRect(0,0,width,height,"#999999");
		stat.graphics.setAlpha(1);
		Stat.loop();
	}

	Stat.enable=function(){
		Laya.timer.frameLoop(1,Stat,Stat.loop);
	}

	Stat.hide=function(){
		Stat._show=false;
		Laya.timer.clear(Stat,Stat.loop);
		if (Stat._canvas){
			Browser.removeElement(Stat._canvas.source);
		}
	}

	Stat.clear=function(){
		Stat.trianglesFaces=Stat.drawCall=Stat.shaderCall=Stat.spriteCount=Stat.spriteRenderUseCacheCount=Stat.treeNodeCollision=Stat.treeSpriteCollision=Stat.canvasNormal=Stat.canvasBitmap=Stat.canvasReCache=0;
	}

	Stat.loop=function(){
		Stat._count++;
		var timer=Browser.now();
		if (timer-Stat._timer < 1000)return;
		var count=Stat._count;
		Stat.FPS=Math.round((count *1000)/ (timer-Stat._timer));
		if (Stat._show){
			Stat.trianglesFaces=Math.round(Stat.trianglesFaces / count);
			if (!Stat._useCanvas){
				Stat.drawCall=Math.round(Stat.drawCall / count)-2;
				Stat.shaderCall=Math.round(Stat.shaderCall / count)-4;
				Stat.spriteCount=Math.round(Stat.spriteCount / count)-4;
				}else{
				Stat.drawCall=Math.round(Stat.drawCall / count)-2;
				Stat.shaderCall=Math.round(Stat.shaderCall / count);
				Stat.spriteCount=Math.round(Stat.spriteCount / count)-1;
			}
			Stat.spriteRenderUseCacheCount=Math.round(Stat.spriteRenderUseCacheCount / count);
			Stat.canvasNormal=Math.round(Stat.canvasNormal / count);
			Stat.canvasBitmap=Math.round(Stat.canvasBitmap / count);
			Stat.canvasReCache=Math.ceil(Stat.canvasReCache / count);
			Stat.treeNodeCollision=Math.round(Stat.treeNodeCollision / count);
			Stat.treeSpriteCollision=Math.round(Stat.treeSpriteCollision / count);
			var delay=Stat.FPS > 0 ? Math.floor(1000 / Stat.FPS).toString():" ";
			Stat._fpsStr=Stat.FPS+(Stat.renderSlow ? " slow" :"")+" "+delay;
			Stat._spriteStr=Stat.spriteCount+(Stat.spriteRenderUseCacheCount ? ("/"+Stat.spriteRenderUseCacheCount):'');
			Stat._canvasStr=Stat.canvasReCache+"/"+Stat.canvasNormal+"/"+Stat.canvasBitmap;
			Stat.currentMemorySize=ResourceManager.systemResourceManager.memorySize;
			if (Stat._useCanvas){
				Stat.renderInfoPre();
			}else
			Stat.renderInfo();
			Stat.clear();
		}
		Stat._count=0;
		Stat._timer=timer;
	}

	Stat.renderInfoPre=function(){
		if (Stat._canvas){
			var ctx=Stat._ctx;
			ctx.clearRect(Stat._first ? 0 :Stat._vx,0,Stat._width,Stat._height);
			for (var i=0;i < Stat._view.length;i++){
				var one=Stat._view[i];
				if (Stat._first){
					ctx.fillStyle="white";
					ctx.fillText(one.title,one.x,one.y,null,null,null);
				}
				ctx.fillStyle=one.color;
				var value=Stat[one.value];
				(one.units=="M")&& (value=Math.floor(value / (1024 *1024)*100)/ 100+" M");
				ctx.fillText(value+"",one.x+Stat._vx,one.y,null,null,null);
			}
		}
	}

	Stat.renderInfo=function(){
		var text="";
		for (var i=0;i < Stat._view.length;i++){
			var one=Stat._view[i];
			var value=Stat[one.value];
			(one.units=="M")&& (value=Math.floor(value / (1024 *1024)*100)/ 100+" M");
			(one.units=="K")&& (value=Math.floor(value / (1024)*100)/ 100+" K");
			text+=value+"\n";
		}
		Stat._txt.text=text;
	}

	Stat.FPS=0;
	Stat.loopCount=0;
	Stat.shaderCall=0;
	Stat.drawCall=0;
	Stat.trianglesFaces=0;
	Stat.spriteCount=0;
	Stat.spriteRenderUseCacheCount=0;
	Stat.treeNodeCollision=0;
	Stat.treeSpriteCollision=0;
	Stat.canvasNormal=0;
	Stat.canvasBitmap=0;
	Stat.canvasReCache=0;
	Stat.renderSlow=false;
	Stat.currentMemorySize=0;
	Stat._fpsStr=null;
	Stat._canvasStr=null;
	Stat._spriteStr=null;
	Stat._fpsData=[];
	Stat._timer=0;
	Stat._count=0;
	Stat._view=[];
	Stat._fontSize=12;
	Stat._txt=null;
	Stat._leftText=null;
	Stat._sp=null;
	Stat._show=false;
	Stat._useCanvas=false;
	Stat._canvas=null;
	Stat._ctx=null;
	Stat._first=false;
	Stat._vx=NaN;
	Stat._width=0;
	Stat._height=100;
	return Stat;
})()


/**
*@private
*<code>StringKey</code> 类用于存取字符串对应的数字。
*/
//class laya.utils.StringKey
var StringKey=(function(){
	function StringKey(){
		this._strsToID={};
		this._idToStrs=[];
		this._length=0;
	}

	__class(StringKey,'laya.utils.StringKey');
	var __proto=StringKey.prototype;
	/**
	*添加一个字符。
	*@param str 字符，将作为key 存储相应生成的数字。
	*@return 此字符对应的数字。
	*/
	__proto.add=function(str){
		var index=this._strsToID[str];
		if (index !=null)return index;
		this._idToStrs[this._length]=str;
		return this._strsToID[str]=this._length++;
	}

	/**
	*获取指定字符对应的ID。
	*@param str 字符。
	*@return 此字符对应的ID。
	*/
	__proto.getID=function(str){
		var index=this._strsToID[str];
		return index==null ?-1 :index;
	}

	/**
	*根据指定ID获取对应字符。
	*@param id ID。
	*@return 此id对应的字符。
	*/
	__proto.getName=function(id){
		var str=this._idToStrs[id];
		return str==null ? undefined :str;
	}

	return StringKey;
})()


/**
*<code>Timer</code> 是时钟管理类。它是一个单例，不要手动实例化此类，应该通过 Laya.timer 访问。
*/
//class laya.utils.Timer
var Timer=(function(){
	var TimerHandler;
	function Timer(){
		/**两帧之间的时间间隔,单位毫秒。*/
		this._delta=0;
		/**时针缩放。*/
		this.scale=1;
		/**当前的帧数。*/
		this.currFrame=0;
		/**@private */
		this._mid=1;
		/**@private */
		this._map=[];
		/**@private */
		this._laters=[];
		/**@private */
		this._handlers=[];
		/**@private */
		this._temp=[];
		/**@private */
		this._count=0;
		this.currTimer=this._now();
		this._lastTimer=this._now();
		this._init();
	}

	__class(Timer,'laya.utils.Timer');
	var __proto=Timer.prototype;
	/**@private */
	__proto._init=function(){
		Laya.timer && Laya.timer.frameLoop(1,this,this._update);
	}

	/**@private */
	__proto._now=function(){
		return Date.now();
	}

	/**
	*@private
	*帧循环处理函数。
	*/
	__proto._update=function(){
		if (this.scale <=0){
			this._lastTimer=this._now();
			return;
		};
		var frame=this.currFrame=this.currFrame+this.scale;
		var now=this._now();
		this._delta=(now-this._lastTimer)*this.scale;
		var timer=this.currTimer=this.currTimer+this._delta;
		this._lastTimer=now;
		var handlers=this._handlers;
		this._count=0;
		for (i=0,n=handlers.length;i < n;i++){
			handler=handlers[i];
			if (handler.method!==null){
				var t=handler.userFrame ? frame :timer;
				if (t >=handler.exeTime){
					if (handler.repeat){
						if (!handler.jumpFrame){
							handler.exeTime+=handler.delay;
							handler.run(false);
							if (t > handler.exeTime){
								handler.exeTime+=Math.ceil((t-handler.exeTime)/ handler.delay)*handler.delay;
							}
							}else {
							while (t >=handler.exeTime){
								handler.exeTime+=handler.delay;
								handler.run(false);
							}
						}
						}else {
						handler.run(true);
					}
				}
				}else {
				this._count++;
			}
		}
		if (this._count > 30 || frame % 200===0)this._clearHandlers();
		var laters=this._laters;
		for (var i=0,n=laters.length-1;i <=n;i++){
			var handler=laters[i];
			if (handler.method!==null){
				this._map[handler.key]=null;
				handler.run(false);
			}
			this._recoverHandler(handler);
			i===n && (n=laters.length-1);
		}
		laters.length=0;
	}

	/**@private */
	__proto._clearHandlers=function(){
		var handlers=this._handlers;
		for (var i=0,n=handlers.length;i < n;i++){
			var handler=handlers[i];
			if (handler.method!==null)this._temp.push(handler);
			else this._recoverHandler(handler);
		}
		this._handlers=this._temp;
		this._temp=handlers;
		this._temp.length=0;
	}

	/**@private */
	__proto._recoverHandler=function(handler){
		if(this._map[handler.key]==handler)this._map[handler.key]=null;
		handler.clear();
		Timer._pool.push(handler);
	}

	/**@private */
	__proto._create=function(useFrame,repeat,delay,caller,method,args,coverBefore){
		if (!delay){
			method.apply(caller,args);
			return null;
		}
		if (coverBefore){
			var handler=this._getHandler(caller,method);
			if (handler){
				handler.repeat=repeat;
				handler.userFrame=useFrame;
				handler.delay=delay;
				handler.caller=caller;
				handler.method=method;
				handler.args=args;
				handler.exeTime=delay+(useFrame ? this.currFrame :this.currTimer+this._now()-this._lastTimer);
				return handler;
			}
		}
		handler=Timer._pool.length > 0 ? Timer._pool.pop():new TimerHandler();
		handler.repeat=repeat;
		handler.userFrame=useFrame;
		handler.delay=delay;
		handler.caller=caller;
		handler.method=method;
		handler.args=args;
		handler.exeTime=delay+(useFrame ? this.currFrame :this.currTimer+this._now()-this._lastTimer)+1;
		this._indexHandler(handler);
		this._handlers.push(handler);
		return handler;
	}

	/**@private */
	__proto._indexHandler=function(handler){
		var caller=handler.caller;
		var method=handler.method;
		var cid=caller ? caller.$_GID || (caller.$_GID=Utils.getGID()):0;
		var mid=method.$_TID || (method.$_TID=(this._mid++)*100000);
		handler.key=cid+mid;
		this._map[handler.key]=handler;
	}

	/**
	*定时执行一次。
	*@param delay 延迟时间(单位为毫秒)。
	*@param caller 执行域(this)。
	*@param method 定时器回调函数。
	*@param args 回调参数。
	*@param coverBefore 是否覆盖之前的延迟执行，默认为 true 。
	*/
	__proto.once=function(delay,caller,method,args,coverBefore){
		(coverBefore===void 0)&& (coverBefore=true);
		this._create(false,false,delay,caller,method,args,coverBefore);
	}

	/**
	*定时重复执行。
	*@param delay 间隔时间(单位毫秒)。
	*@param caller 执行域(this)。
	*@param method 定时器回调函数。
	*@param args 回调参数。
	*@param coverBefore 是否覆盖之前的延迟执行，默认为 true 。
	*@param jumpFrame 时钟是否跳帧。基于时间的循环回调，单位时间间隔内，如能执行多次回调，出于性能考虑，引擎默认只执行一次，设置jumpFrame=true后，则回调会连续执行多次
	*/
	__proto.loop=function(delay,caller,method,args,coverBefore,jumpFrame){
		(coverBefore===void 0)&& (coverBefore=true);
		(jumpFrame===void 0)&& (jumpFrame=false);
		var handler=this._create(false,true,delay,caller,method,args,coverBefore);
		if (handler)handler.jumpFrame=jumpFrame;
	}

	/**
	*定时执行一次(基于帧率)。
	*@param delay 延迟几帧(单位为帧)。
	*@param caller 执行域(this)。
	*@param method 定时器回调函数。
	*@param args 回调参数。
	*@param coverBefore 是否覆盖之前的延迟执行，默认为 true 。
	*/
	__proto.frameOnce=function(delay,caller,method,args,coverBefore){
		(coverBefore===void 0)&& (coverBefore=true);
		this._create(true,false,delay,caller,method,args,coverBefore);
	}

	/**
	*定时重复执行(基于帧率)。
	*@param delay 间隔几帧(单位为帧)。
	*@param caller 执行域(this)。
	*@param method 定时器回调函数。
	*@param args 回调参数。
	*@param coverBefore 是否覆盖之前的延迟执行，默认为 true 。
	*/
	__proto.frameLoop=function(delay,caller,method,args,coverBefore){
		(coverBefore===void 0)&& (coverBefore=true);
		this._create(true,true,delay,caller,method,args,coverBefore);
	}

	/**返回统计信息。*/
	__proto.toString=function(){
		return "callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+Timer._pool.length;
	}

	/**
	*清理定时器。
	*@param caller 执行域(this)。
	*@param method 定时器回调函数。
	*/
	__proto.clear=function(caller,method){
		var handler=this._getHandler(caller,method);
		if (handler){
			this._map[handler.key]=null;handler.key=0;
			handler.clear();
		}
	}

	/**
	*清理对象身上的所有定时器。
	*@param caller 执行域(this)。
	*/
	__proto.clearAll=function(caller){
		if (!caller)return;
		for (var i=0,n=this._handlers.length;i < n;i++){
			var handler=this._handlers[i];
			if (handler.caller===caller){
				this._map[handler.key]=null;handler.key=0;
				handler.clear();
			}
		}
	}

	/**@private */
	__proto._getHandler=function(caller,method){
		var cid=caller ? caller.$_GID || (caller.$_GID=Utils.getGID()):0;
		var mid=method.$_TID || (method.$_TID=(this._mid++)*100000);
		return this._map[cid+mid];
	}

	/**
	*延迟执行。
	*@param caller 执行域(this)。
	*@param method 定时器回调函数。
	*@param args 回调参数。
	*/
	__proto.callLater=function(caller,method,args){
		if (this._getHandler(caller,method)==null){
			if (Timer._pool.length)
				var handler=Timer._pool.pop();
			else handler=new TimerHandler();
			handler.caller=caller;
			handler.method=method;
			handler.args=args;
			this._indexHandler(handler);
			this._laters.push(handler);
		}
	}

	/**
	*立即执行 callLater 。
	*@param caller 执行域(this)。
	*@param method 定时器回调函数。
	*/
	__proto.runCallLater=function(caller,method){
		var handler=this._getHandler(caller,method);
		if (handler && handler.method !=null){
			this._map[handler.key]=null;
			handler.run(true);
		}
	}

	/**
	*立即提前执行定时器，执行之后从队列中删除
	*@param caller 执行域(this)。
	*@param method 定时器回调函数。
	*/
	__proto.runTimer=function(caller,method){
		this.runCallLater(caller,method);
	}

	/**
	*两帧之间的时间间隔,单位毫秒。
	*/
	__getset(0,__proto,'delta',function(){
		return this._delta;
	});

	Timer._pool=[];
	Timer.__init$=function(){
		/**@private */
		//class TimerHandler
		TimerHandler=(function(){
			function TimerHandler(){
				this.key=0;
				this.repeat=false;
				this.delay=0;
				this.userFrame=false;
				this.exeTime=0;
				this.caller=null;
				this.method=null;
				this.args=null;
				this.jumpFrame=false;
			}
			__class(TimerHandler,'');
			var __proto=TimerHandler.prototype;
			__proto.clear=function(){
				this.caller=null;
				this.method=null;
				this.args=null;
			}
			__proto.run=function(withClear){
				var caller=this.caller;
				if (caller && caller.destroyed)return this.clear();
				var method=this.method;
				var args=this.args;
				withClear && this.clear();
				if (method==null)return;
				args ? method.apply(caller,args):method.call(caller);
			}
			return TimerHandler;
		})()
	}

	return Timer;
})()


/**
*<code>Tween</code> 是一个缓动类。使用此类能够实现对目标对象属性的渐变。
*/
//class laya.utils.Tween
var Tween=(function(){
	function Tween(){
		/**@private */
		//this._complete=null;
		/**@private */
		//this._target=null;
		/**@private */
		//this._ease=null;
		/**@private */
		//this._props=null;
		/**@private */
		//this._duration=0;
		/**@private */
		//this._delay=0;
		/**@private */
		//this._startTimer=0;
		/**@private */
		//this._usedTimer=0;
		/**@private */
		//this._usedPool=false;
		/**@private */
		//this._delayParam=null;
		/**@private 唯一标识，TimeLintLite用到*/
		this.gid=0;
		/**更新回调，缓动数值发生变化时，回调变化的值*/
		//this.update=null;
	}

	__class(Tween,'laya.utils.Tween');
	var __proto=Tween.prototype;
	/**
	*缓动对象的props属性到目标值。
	*@param target 目标对象(即将更改属性值的对象)。
	*@param props 变化的属性列表，比如{x:100,y:20,ease:Ease.backOut,complete:Handler.create(this,onComplete),update:new Handler(this,onComplete)}。
	*@param duration 花费的时间，单位毫秒。
	*@param ease 缓动类型，默认为匀速运动。
	*@param complete 结束回调函数。
	*@param delay 延迟执行时间。
	*@param coverBefore 是否覆盖之前的缓动。
	*@return 返回Tween对象。
	*/
	__proto.to=function(target,props,duration,ease,complete,delay,coverBefore){
		(delay===void 0)&& (delay=0);
		(coverBefore===void 0)&& (coverBefore=false);
		return this._create(target,props,duration,ease,complete,delay,coverBefore,true,false,true);
	}

	/**
	*从props属性，缓动到当前状态。
	*@param target 目标对象(即将更改属性值的对象)。
	*@param props 变化的属性列表，比如{x:100,y:20,ease:Ease.backOut,complete:Handler.create(this,onComplete),update:new Handler(this,onComplete)}。
	*@param duration 花费的时间，单位毫秒。
	*@param ease 缓动类型，默认为匀速运动。
	*@param complete 结束回调函数。
	*@param delay 延迟执行时间。
	*@param coverBefore 是否覆盖之前的缓动。
	*@return 返回Tween对象。
	*/
	__proto.from=function(target,props,duration,ease,complete,delay,coverBefore){
		(delay===void 0)&& (delay=0);
		(coverBefore===void 0)&& (coverBefore=false);
		return this._create(target,props,duration,ease,complete,delay,coverBefore,false,false,true);
	}

	/**@private */
	__proto._create=function(target,props,duration,ease,complete,delay,coverBefore,isTo,usePool,runNow){
		if (!target)throw new Error("Tween:target is null");
		this._target=target;
		this._duration=duration;
		this._ease=ease || props.ease || Tween.easeNone;
		this._complete=complete || props.complete;
		this._delay=delay;
		this._props=[];
		this._usedTimer=0;
		this._startTimer=Browser.now();
		this._usedPool=usePool;
		this._delayParam=null;
		this.update=props.update;
		var gid=(target.$_GID || (target.$_GID=Utils.getGID()));
		if (!Tween.tweenMap[gid]){
			Tween.tweenMap[gid]=[this];
			}else {
			if (coverBefore)Tween.clearTween(target);
			Tween.tweenMap[gid].push(this);
		}
		if (runNow){
			if (delay <=0)this.firstStart(target,props,isTo);
			else{
				this._delayParam=[target,props,isTo];
				Laya.scaleTimer.once(delay,this,this.firstStart,this._delayParam);
			}
			}else {
			this._initProps(target,props,isTo);
		}
		return this;
	}

	__proto.firstStart=function(target,props,isTo){
		this._delayParam=null;
		if (target.destroyed){
			this.clear();
			return;
		}
		this._initProps(target,props,isTo);
		this._beginLoop();
	}

	__proto._initProps=function(target,props,isTo){
		for (var p in props){
			if ((typeof (target[p])=='number')){
				var start=isTo ? target[p] :props[p];
				var end=isTo ? props[p] :target[p];
				this._props.push([p,start,end-start]);
				if (!isTo)target[p]=start;
			}
		}
	}

	__proto._beginLoop=function(){
		Laya.scaleTimer.frameLoop(1,this,this._doEase);
	}

	/**执行缓动**/
	__proto._doEase=function(){
		this._updateEase(Browser.now());
	}

	/**@private */
	__proto._updateEase=function(time){
		var target=this._target;
		if (!target)return;
		if (target.destroyed)return Tween.clearTween(target);
		var usedTimer=this._usedTimer=time-this._startTimer-this._delay;
		if (usedTimer < 0)return;
		if (usedTimer >=this._duration)return this.complete();
		var ratio=usedTimer > 0 ? this._ease(usedTimer,0,1,this._duration):0;
		var props=this._props;
		for (var i=0,n=props.length;i < n;i++){
			var prop=props[i];
			target[prop[0]]=prop[1]+(ratio *prop[2]);
		}
		if (this.update)this.update.run();
	}

	/**
	*立即结束缓动并到终点。
	*/
	__proto.complete=function(){
		if (!this._target)return;
		Laya.scaleTimer.runTimer(this,this.firstStart);
		var target=this._target;
		var props=this._props;
		var handler=this._complete;
		for (var i=0,n=props.length;i < n;i++){
			var prop=props[i];
			target[prop[0]]=prop[1]+prop[2];
		}
		if (this.update)this.update.run();
		this.clear();
		handler && handler.run();
	}

	/**
	*暂停缓动，可以通过resume或restart重新开始。
	*/
	__proto.pause=function(){
		Laya.scaleTimer.clear(this,this._beginLoop);
		Laya.scaleTimer.clear(this,this._doEase);
		Laya.scaleTimer.clear(this,this.firstStart);
		var time=Browser.now();
		var dTime=NaN;
		dTime=time-this._startTimer-this._delay;
		if (dTime < 0){
			this._usedTimer=dTime;
		}
	}

	/**
	*设置开始时间。
	*@param startTime 开始时间。
	*/
	__proto.setStartTime=function(startTime){
		this._startTimer=startTime;
	}

	/**
	*停止并清理当前缓动。
	*/
	__proto.clear=function(){
		if (this._target){
			this._remove();
			this._clear();
		}
	}

	/**
	*@private
	*/
	__proto._clear=function(){
		this.pause();
		Laya.scaleTimer.clear(this,this.firstStart);
		this._complete=null;
		this._target=null;
		this._ease=null;
		this._props=null;
		this._delayParam=null;
		if (this._usedPool){
			this.update=null;
			Pool.recover("tween",this);
		}
	}

	/**回收到对象池。*/
	__proto.recover=function(){
		this._usedPool=true;
		this._clear();
	}

	__proto._remove=function(){
		var tweens=Tween.tweenMap[this._target.$_GID];
		if (tweens){
			for (var i=0,n=tweens.length;i < n;i++){
				if (tweens[i]===this){
					tweens.splice(i,1);
					break ;
				}
			}
		}
	}

	/**
	*重新开始暂停的缓动。
	*/
	__proto.restart=function(){
		this.pause();
		this._usedTimer=0;
		this._startTimer=Browser.now();
		if (this._delayParam){
			Laya.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);
			return;
		};
		var props=this._props;
		for (var i=0,n=props.length;i < n;i++){
			var prop=props[i];
			this._target[prop[0]]=prop[1];
		}
		Laya.scaleTimer.once(this._delay,this,this._beginLoop);
	}

	/**
	*恢复暂停的缓动。
	*/
	__proto.resume=function(){
		if (this._usedTimer >=this._duration)return;
		this._startTimer=Browser.now()-this._usedTimer-this._delay;
		if (this._delayParam){
			if (this._usedTimer < 0){
				Laya.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam);
				}else{
				this.firstStart.apply(this,this._delayParam);
			}
			}else{
			this._beginLoop();
		}
	}

	/**设置当前执行比例**/
	__getset(0,__proto,'progress',null,function(v){
		var uTime=v *this._duration;
		this._startTimer=Browser.now()-this._delay-uTime;
	});

	Tween.to=function(target,props,duration,ease,complete,delay,coverBefore,autoRecover){
		(delay===void 0)&& (delay=0);
		(coverBefore===void 0)&& (coverBefore=false);
		(autoRecover===void 0)&& (autoRecover=true);
		return Pool.getItemByClass("tween",Tween)._create(target,props,duration,ease,complete,delay,coverBefore,true,autoRecover,true);
	}

	Tween.from=function(target,props,duration,ease,complete,delay,coverBefore,autoRecover){
		(delay===void 0)&& (delay=0);
		(coverBefore===void 0)&& (coverBefore=false);
		(autoRecover===void 0)&& (autoRecover=true);
		return Pool.getItemByClass("tween",Tween)._create(target,props,duration,ease,complete,delay,coverBefore,false,autoRecover,true);
	}

	Tween.clearAll=function(target){
		if (!target || !target.$_GID)return;
		var tweens=Tween.tweenMap[target.$_GID];
		if (tweens){
			for (var i=0,n=tweens.length;i < n;i++){
				tweens[i]._clear();
			}
			tweens.length=0;
		}
	}

	Tween.clear=function(tween){
		tween.clear();
	}

	Tween.clearTween=function(target){
		Tween.clearAll(target);
	}

	Tween.easeNone=function(t,b,c,d){
		return c *t / d+b;
	}

	Tween.tweenMap={};
	return Tween;
})()


/**
*<code>Utils</code> 是工具类。
*/
//class laya.utils.Utils
var Utils=(function(){
	function Utils(){}
	__class(Utils,'laya.utils.Utils');
	Utils.toRadian=function(angle){
		return angle *Utils._pi2;
	}

	Utils.toAngle=function(radian){
		return radian *Utils._pi;
	}

	Utils.toHexColor=function(color){
		if (color < 0 || isNaN(color))return null;
		var str=color.toString(16);
		while (str.length < 6)str="0"+str;
		return "#"+str;
	}

	Utils.getGID=function(){
		return Utils._gid++;
	}

	Utils.concatArray=function(source,array){
		if (!array)return source;
		if (!source)return array;
		var i=0,len=array.length;
		for (i=0;i < len;i++){
			source.push(array[i]);
		}
		return source;
	}

	Utils.clearArray=function(array){
		if (!array)return array;
		array.length=0;
		return array;
	}

	Utils.copyArray=function(source,array){
		source || (source=[]);
		if (!array)return source;
		source.length=array.length;
		var i=0,len=array.length;
		for (i=0;i < len;i++){
			source[i]=array[i];
		}
		return source;
	}

	Utils.getGlobalRecByPoints=function(sprite,x0,y0,x1,y1){
		var newLTPoint;
		newLTPoint=new Point(x0,y0);
		newLTPoint=sprite.localToGlobal(newLTPoint);
		var newRBPoint;
		newRBPoint=new Point(x1,y1);
		newRBPoint=sprite.localToGlobal(newRBPoint);
		return Rectangle._getWrapRec([newLTPoint.x,newLTPoint.y,newRBPoint.x,newRBPoint.y]);
	}

	Utils.getGlobalPosAndScale=function(sprite){
		return Utils.getGlobalRecByPoints(sprite,0,0,1,1);
	}

	Utils.bind=function(fun,scope){
		var rst=fun;
		rst=fun.bind(scope);;
		return rst;
	}

	Utils.measureText=function(txt,font){
		return RunDriver.measureText(txt,font);
	}

	Utils.updateOrder=function(array){
		if (!array || array.length < 2)return false;
		var i=1,j=0,len=array.length,key=NaN,c;
		while (i < len){
			j=i;
			c=array[j];
			key=array[j]._zOrder;
			while (--j >-1){
				if (array[j]._zOrder > key)array[j+1]=array[j];
				else break ;
			}
			array[j+1]=c;
			i++;
		};
		var model=c.parent.conchModel;
		if (model){
			if (model.updateZOrder !=null){
				model.updateZOrder();
				}else {
				for (i=0;i < len;i++){
					model.removeChild(array[i].conchModel);
				}
				for (i=0;i < len;i++){
					model.addChildAt(array[i].conchModel,i);
				}
			}
		}
		return true;
	}

	Utils.transPointList=function(points,x,y){
		var i=0,len=points.length;
		for (i=0;i < len;i+=2){
			points[i]+=x;
			points[i+1]+=y;
		}
	}

	Utils.parseInt=function(str,radix){
		(radix===void 0)&& (radix=0);
		var result=Browser.window.parseInt(str,radix);
		if (isNaN(result))return 0;
		return result;
	}

	Utils.getFileExtension=function(path){
		Utils._extReg.lastIndex=path.lastIndexOf(".");
		var result=Utils._extReg.exec(path);
		if (result && result.length > 1){
			return result[1].toLowerCase();
		}
		return null;
	}

	Utils.getTransformRelativeToWindow=function(coordinateSpace,x,y){
		var stage=Laya.stage;
		var globalTransform=laya.utils.Utils.getGlobalPosAndScale(coordinateSpace);
		var canvasMatrix=stage._canvasTransform.clone();
		var canvasLeft=canvasMatrix.tx;
		var canvasTop=canvasMatrix.ty;
		canvasMatrix.rotate(-Math.PI / 180 *Laya.stage.canvasDegree);
		canvasMatrix.scale(Laya.stage.clientScaleX,Laya.stage.clientScaleY);
		var perpendicular=(Laya.stage.canvasDegree % 180 !=0);
		var tx=NaN,ty=NaN;
		if (perpendicular){
			tx=y+globalTransform.y;
			ty=x+globalTransform.x;
			tx *=canvasMatrix.d;
			ty *=canvasMatrix.a;
			if (Laya.stage.canvasDegree==90){
				tx=canvasLeft-tx;
				ty+=canvasTop;
			}
			else {
				tx+=canvasLeft;
				ty=canvasTop-ty;
			}
		}
		else {
			tx=x+globalTransform.x;
			ty=y+globalTransform.y;
			tx *=canvasMatrix.a;
			ty *=canvasMatrix.d;
			tx+=canvasLeft;
			ty+=canvasTop;
		};
		var domScaleX=NaN,domScaleY=NaN;
		if (perpendicular){
			domScaleX=canvasMatrix.d *globalTransform.height;
			domScaleY=canvasMatrix.a *globalTransform.width;
			}else {
			domScaleX=canvasMatrix.a *globalTransform.width;
			domScaleY=canvasMatrix.d *globalTransform.height;
		}
		return {x:tx,y:ty,scaleX:domScaleX,scaleY:domScaleY};
	}

	Utils.fitDOMElementInArea=function(dom,coordinateSpace,x,y,width,height){
		if (!dom._fitLayaAirInitialized){
			dom._fitLayaAirInitialized=true;
			dom.style.transformOrigin=dom.style.webKittransformOrigin="left top";
			dom.style.position="absolute"
		};
		var transform=Utils.getTransformRelativeToWindow(coordinateSpace,x,y);
		dom.style.transform=dom.style.webkitTransform="scale("+transform.scaleX+","+transform.scaleY+") rotate("+(Laya.stage.canvasDegree)+"deg)";
		dom.style.width=width+'px';
		dom.style.height=height+'px';
		dom.style.left=transform.x+'px';
		dom.style.top=transform.y+'px';
	}

	Utils.isOkTextureList=function(textureList){
		if (!textureList)return false;
		var i=0,len=textureList.length;
		var tTexture;
		for (i=0;i < len;i++){
			tTexture=textureList[i];
			if (!tTexture||!tTexture.source)return false;
		}
		return true;
	}

	Utils.isOKCmdList=function(cmds){
		if (!cmds)return false;
		var i=0,len=cmds.length;
		var context=Render._context;
		var cmd;
		var tex;
		for (i=0;i < len;i++){
			cmd=cmds[i];
			switch(cmd.callee){
				case context._drawTexture:
				case context._fillTexture:
				case context._drawTextureWithTransform:
					tex=cmd[0];
					if (!tex || !tex.source)return false;
				}
		}
		return true;
	}

	Utils._gid=1;
	Utils._pi=180 / Math.PI;
	Utils._pi2=Math.PI / 180;
	Utils._extReg=/\.(\w+)\??/g;
	Utils.parseXMLFromString=function(value){
		var rst;
		value=value.replace(/>\s+</g,'><');
		rst=(new DOMParser()).parseFromString(value,'text/xml');
		if (rst.firstChild.textContent.indexOf("This page contains the following errors")>-1){
			throw new Error(rst.firstChild.firstChild.textContent);
		}
		return rst;
	}

	return Utils;
})()


/**
*@private
*/
//class laya.utils.VectorGraphManager
var VectorGraphManager=(function(){
	function VectorGraphManager(){
		this.useDic={};
		this.shapeDic={};
		this.shapeLineDic={};
		this._id=0;
		this._checkKey=false;
		this._freeIdArray=[];
		if (Render.isWebGL){
			CacheManager.regCacheByFunction(Utils.bind(this.startDispose,this),Utils.bind(this.getCacheList,this));
		}
	}

	__class(VectorGraphManager,'laya.utils.VectorGraphManager');
	var __proto=VectorGraphManager.prototype;
	/**
	*得到个空闲的ID
	*@return
	*/
	__proto.getId=function(){
		return this._id++;
	}

	/**
	*添加一个图形到列表中
	*@param id
	*@param shape
	*/
	__proto.addShape=function(id,shape){
		this.shapeDic[id]=shape;
		if (!this.useDic[id]){
			this.useDic[id]=true;
		}
	}

	/**
	*添加一个线图形到列表中
	*@param id
	*@param Line
	*/
	__proto.addLine=function(id,Line){
		this.shapeLineDic[id]=Line;
		if (!this.shapeLineDic[id]){
			this.shapeLineDic[id]=true;
		}
	}

	/**
	*检测一个对象是否在使用中
	*@param id
	*/
	__proto.getShape=function(id){
		if (this._checkKey){
			if (this.useDic[id] !=null){
				this.useDic[id]=true;
			}
		}
	}

	/**
	*删除一个图形对象
	*@param id
	*/
	__proto.deleteShape=function(id){
		if (this.shapeDic[id]){
			this.shapeDic[id]=null;
			delete this.shapeDic[id];
		}
		if (this.shapeLineDic[id]){
			this.shapeLineDic[id]=null;
			delete this.shapeLineDic[id];
		}
		if (this.useDic[id] !=null){
			delete this.useDic[id];
		}
	}

	/**
	*得到缓存列表
	*@return
	*/
	__proto.getCacheList=function(){
		var str;
		var list=[];
		for (str in this.shapeDic){
			list.push(this.shapeDic[str]);
		}
		for (str in this.shapeLineDic){
			list.push(this.shapeLineDic[str]);
		}
		return list;
	}

	/**
	*开始清理状态，准备销毁
	*/
	__proto.startDispose=function(key){
		var str;
		for (str in this.useDic){
			this.useDic[str]=false;
		}
		this._checkKey=true;
	}

	/**
	*确认销毁
	*/
	__proto.endDispose=function(){
		if (this._checkKey){
			var str;
			for (str in this.useDic){
				if (!this.useDic[str]){
					this.deleteShape(str);
				}
			}
			this._checkKey=false;
		}
	}

	VectorGraphManager.getInstance=function(){
		return VectorGraphManager.instance=VectorGraphManager.instance|| new VectorGraphManager();
	}

	VectorGraphManager.instance=null;
	return VectorGraphManager;
})()


/**
*封装弱引用WeakMap
*如果支持WeakMap，则使用WeakMap，如果不支持，则用Object代替
*注意：如果采用Object，为了防止内存泄漏，则采用定时清理缓存策略
*/
//class laya.utils.WeakObject
var WeakObject=(function(){
	function WeakObject(){
		/**@private */
		this._obj=null;
		this._obj=WeakObject.supportWeakMap ? new Browser.window.WeakMap():{};
		if (!WeakObject.supportWeakMap)WeakObject._maps.push(this);
	}

	__class(WeakObject,'laya.utils.WeakObject');
	var __proto=WeakObject.prototype;
	/**
	*设置缓存
	*@param key kye对象，可被回收
	*@param value object对象，可被回收
	*/
	__proto.set=function(key,value){
		if (key==null)return;
		if (WeakObject.supportWeakMap){
			var objKey=key;
			if ((typeof key=='string')|| (typeof key=='number')){
				objKey=WeakObject._keys[key];
				if (!objKey)objKey=WeakObject._keys[key]={k:key};
			}
			this._obj.set(objKey,value);
			}else {
			if ((typeof key=='string')|| (typeof key=='number')){
				this._obj[key]=value;
				}else {
				key.$_GID || (key.$_GID=Utils.getGID());
				this._obj[key.$_GID]=value;
			}
		}
	}

	/**
	*获取缓存
	*@param key kye对象，可被回收
	*/
	__proto.get=function(key){
		if (key==null)return null;
		if (WeakObject.supportWeakMap){
			var objKey=((typeof key=='string')|| (typeof key=='number'))? WeakObject._keys[key] :key;
			if (!objKey)return null;
			return this._obj.get(objKey);
			}else {
			if ((typeof key=='string')|| (typeof key=='number'))return this._obj[key];
			return this._obj[key.$_GID];
		}
	}

	/**
	*删除缓存
	*/
	__proto.del=function(key){
		if (key==null)return;
		if (WeakObject.supportWeakMap){
			var objKey=((typeof key=='string')|| (typeof key=='number'))? WeakObject._keys[key] :key;
			if (!objKey)return;
			this._obj.delete(objKey);
			}else {
			if ((typeof key=='string')|| (typeof key=='number'))delete this._obj[key];
			else delete this._obj[this._obj.$_GID];
		}
	}

	/**
	*是否有缓存
	*/
	__proto.has=function(key){
		if (key==null)return false;
		if (WeakObject.supportWeakMap){
			var objKey=((typeof key=='string')|| (typeof key=='number'))? WeakObject._keys[key] :key;
			return this._obj.has(objKey);
			}else {
			if ((typeof key=='string')|| (typeof key=='number'))return this._obj[key] !=null;
			return this._obj[this._obj.$_GID] !=null;
		}
	}

	WeakObject.__init__=function(){
		WeakObject.supportWeakMap=Browser.window.WeakMap !=null;
		if (!WeakObject.supportWeakMap)Laya.timer.loop(WeakObject.delInterval,null,WeakObject.clearCache);
	}

	WeakObject.clearCache=function(){
		for (var i=0,n=WeakObject._maps.length;i < n;i++){
			var obj=WeakObject._maps[i];
			obj._obj={};
		}
	}

	WeakObject.supportWeakMap=false;
	WeakObject.delInterval=5 *60 *1000;
	WeakObject._keys={};
	WeakObject._maps=[];
	__static(WeakObject,
	['I',function(){return this.I=new WeakObject();}
	]);
	return WeakObject;
})()


/**
*@private
*/
//class laya.utils.WordText
var WordText=(function(){
	function WordText(){
		this.id=NaN;
		this.save=[];
		this.toUpperCase=null;
		this.changed=false;
		this._text=null;
	}

	__class(WordText,'laya.utils.WordText');
	var __proto=WordText.prototype;
	__proto.setText=function(txt){
		this.changed=true;
		this._text=txt;
	}

	__proto.toString=function(){
		return this._text;
	}

	__proto.charCodeAt=function(i){
		return this._text ? this._text.charCodeAt(i):NaN;
	}

	__proto.charAt=function(i){
		return this._text ? this._text.charAt(i):null;
	}

	__getset(0,__proto,'length',function(){
		return this._text ? this._text.length :0;
	});

	return WordText;
})()


//class laya.webgl.atlas.AtlasGrid
var AtlasGrid=(function(){
	var TexRowInfo,TexMergeTexSize;
	function AtlasGrid(width,height,atlasID){
		this._atlasID=0;
		this._width=0;
		this._height=0;
		this._texCount=0;
		this._rowInfo=null;
		this._cells=null;
		this._failSize=new TexMergeTexSize();
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		(atlasID===void 0)&& (atlasID=0);
		this._cells=null;
		this._rowInfo=null;
		this._init(width,height);
		this._atlasID=atlasID;
	}

	__class(AtlasGrid,'laya.webgl.atlas.AtlasGrid');
	var __proto=AtlasGrid.prototype;
	//------------------------------------------------------------------------------
	__proto.getAltasID=function(){
		return this._atlasID;
	}

	//------------------------------------------------------------------------------
	__proto.setAltasID=function(atlasID){
		if (atlasID >=0){
			this._atlasID=atlasID;
		}
	}

	//------------------------------------------------------------------
	__proto.addTex=function(type,width,height){
		var result=this._get(width,height);
		if (result.ret==false){
			return result;
		}
		this._fill(result.x,result.y,width,height,type);
		this._texCount++;
		return result;
	}

	//------------------------------------------------------------------------------
	__proto._release=function(){
		if (this._cells !=null){
			this._cells.length=0;
			this._cells=null;
		}
		if (this._rowInfo){
			this._rowInfo.length=0;
			this._rowInfo=null;
		}
	}

	//------------------------------------------------------------------------------
	__proto._init=function(width,height){
		this._width=width;
		this._height=height;
		this._release();
		if (this._width==0)return false;
		this._cells=new Uint8Array(this._width *this._height*3);
		this._rowInfo=__newvec(this._height);
		for (var i=0;i < this._height;i++){
			this._rowInfo[i]=new TexRowInfo();
		}
		this._clear();
		return true;
	}

	//------------------------------------------------------------------
	__proto._get=function(width,height){
		var pFillInfo=new MergeFillInfo();
		if (width >=this._failSize.width && height >=this._failSize.height){
			return pFillInfo;
		};
		var rx=-1;
		var ry=-1;
		var nWidth=this._width;
		var nHeight=this._height;
		var pCellBox=this._cells;
		for (var y=0;y < nHeight;y++){
			if (this._rowInfo[y].spaceCount < width)continue ;
			for (var x=0;x < nWidth;){
				var tm=(y *nWidth+x)*3;
				if (pCellBox[tm] !=0 || pCellBox[tm+1] < width || pCellBox[tm+2] < height){
					x+=pCellBox[tm+1];
					continue ;
				}
				rx=x;
				ry=y;
				for (var xx=0;xx < width;xx++){
					if (pCellBox[3*xx+tm+2] < height){
						rx=-1;
						break ;
					}
				}
				if (rx < 0){
					x+=pCellBox[tm+1];
					continue ;
				}
				pFillInfo.ret=true;
				pFillInfo.x=rx;
				pFillInfo.y=ry;
				return pFillInfo;
			}
		}
		return pFillInfo;
	}

	//------------------------------------------------------------------
	__proto._fill=function(x,y,w,h,type){
		var nWidth=this._width;
		var nHeghit=this._height;
		this._check((x+w)<=nWidth && (y+h)<=nHeghit);
		for (var yy=y;yy < (h+y);++yy){
			this._check(this._rowInfo[yy].spaceCount >=w);
			this._rowInfo[yy].spaceCount-=w;
			for (var xx=0;xx < w;xx++){
				var tm=(x+yy *nWidth+xx)*3;
				this._check(this._cells[tm]==0);
				this._cells[tm]=type;
				this._cells[tm+1]=w;
				this._cells[tm+2]=h;
			}
		}
		if (x > 0){
			for (yy=0;yy < h;++yy){
				var s=0;
				for (xx=x-1;xx >=0;--xx,++s){
					if (this._cells[((y+yy)*nWidth+xx)*3] !=0)break ;
				}
				for (xx=s;xx > 0;--xx){
					this._cells[((y+yy)*nWidth+x-xx)*3+1]=xx;
					this._check(xx > 0);
				}
			}
		}
		if (y > 0){
			for (xx=x;xx < (x+w);++xx){
				s=0;
				for (yy=y-1;yy >=0;--yy,s++){
					if (this._cells[(xx+yy *nWidth)*3] !=0)break ;
				}
				for (yy=s;yy > 0;--yy){
					this._cells[(xx+(y-yy)*nWidth)*3+2]=yy;
					this._check(yy > 0);
				}
			}
		}
	}

	__proto._check=function(ret){
		if (ret==false){
			console.log("xtexMerger 错误啦");
		}
	}

	//------------------------------------------------------------------
	__proto._clear=function(){
		this._texCount=0;
		for (var y=0;y < this._height;y++){
			this._rowInfo[y].spaceCount=this._width;
		}
		for (var i=0;i < this._height;i++){
			for (var j=0;j < this._width;j++){
				var tm=(i *this._width+j)*3;
				this._cells[tm]=0;
				this._cells[tm+1]=this._width-j;
				this._cells[tm+2]=this._width-i;
			}
		}
		this._failSize.width=this._width+1;
		this._failSize.height=this._height+1;
	}

	AtlasGrid.__init$=function(){
		//------------------------------------------------------------------------------
		//class TexRowInfo
		TexRowInfo=(function(){
			function TexRowInfo(){
				this.spaceCount=0;
			}
			__class(TexRowInfo,'');
			return TexRowInfo;
		})()
		//------------------------------------------------------------------------------
		//class TexMergeTexSize
		TexMergeTexSize=(function(){
			function TexMergeTexSize(){
				this.width=0;
				this.height=0;
			}
			__class(TexMergeTexSize,'');
			return TexMergeTexSize;
		})()
	}

	return AtlasGrid;
})()


//class laya.webgl.atlas.AtlasResourceManager
var AtlasResourceManager=(function(){
	function AtlasResourceManager(width,height,gridSize,maxTexNum){
		this._currentAtlasCount=0;
		this._maxAtlaserCount=0;
		this._width=0;
		this._height=0;
		this._gridSize=0;
		this._gridNumX=0;
		this._gridNumY=0;
		this._init=false;
		this._curAtlasIndex=0;
		this._setAtlasParam=false;
		this._atlaserArray=null;
		this._needGC=false;
		this._setAtlasParam=true;
		this._width=width;
		this._height=height;
		this._gridSize=gridSize;
		this._maxAtlaserCount=maxTexNum;
		this._gridNumX=width / gridSize;
		this._gridNumY=height / gridSize;
		this._curAtlasIndex=0;
		this._atlaserArray=[];
	}

	__class(AtlasResourceManager,'laya.webgl.atlas.AtlasResourceManager');
	var __proto=AtlasResourceManager.prototype;
	__proto.setAtlasParam=function(width,height,gridSize,maxTexNum){
		if (this._setAtlasParam==true){
			AtlasResourceManager._sid_=0;
			this._width=width;
			this._height=height;
			this._gridSize=gridSize;
			this._maxAtlaserCount=maxTexNum;
			this._gridNumX=width / gridSize;
			this._gridNumY=height / gridSize;
			this._curAtlasIndex=0;
			this.freeAll();
			return true;
			}else {
			console.log("设置大图合集参数错误，只能在开始页面设置各种参数");
			throw-1;
			return false;
		}
		return false;
	}

	//添加 图片到大图集
	__proto.pushData=function(texture){
		var bitmap=texture.bitmap;
		var nWebGLImageIndex=-1;
		var curAtlas=null;
		var i=0,n=0,altasIndex=0;
		for (i=0,n=this._atlaserArray.length;i < n;i++){
			altasIndex=(this._curAtlasIndex+i)% n;
			curAtlas=this._atlaserArray[altasIndex];
			nWebGLImageIndex=curAtlas.findBitmapIsExist(bitmap);
			if (nWebGLImageIndex !=-1){
				break ;
			}
		}
		if (nWebGLImageIndex !=-1){
			var offset=curAtlas.InAtlasWebGLImagesOffsetValue[nWebGLImageIndex];
			offsetX=offset[0];
			offsetY=offset[1];
			curAtlas.addToAtlas(texture,offsetX,offsetY);
			return true;
			}else {
			var tex=texture;
			this._setAtlasParam=false;
			var bFound=false;
			var nImageGridX=(Math.ceil((texture.bitmap.width+2)/ this._gridSize));
			var nImageGridY=(Math.ceil((texture.bitmap.height+2)/ this._gridSize));
			var bSuccess=false;
			for (var k=0;k < 2;k++){
				var maxAtlaserCount=this._maxAtlaserCount;
				for (i=0;i < maxAtlaserCount;i++){
					altasIndex=(this._curAtlasIndex+i)% maxAtlaserCount;
					(this._atlaserArray.length-1 >=altasIndex)|| (this._atlaserArray.push(new Atlaser(this._gridNumX,this._gridNumY,this._width,this._height,AtlasResourceManager._sid_++)));
					var atlas=this._atlaserArray[altasIndex];
					var offsetX=0,offsetY=0;
					var fillInfo=atlas.addTex(1,nImageGridX,nImageGridY);
					if (fillInfo.ret){
						offsetX=fillInfo.x *this._gridSize+1;
						offsetY=fillInfo.y *this._gridSize+1;
						bitmap.lock=true;
						atlas.addToAtlasTexture((bitmap),offsetX,offsetY);
						atlas.addToAtlas(texture,offsetX,offsetY);
						bSuccess=true;
						this._curAtlasIndex=altasIndex;
						break ;
					}
				}
				if (bSuccess)
					break ;
				this._atlaserArray.push(new Atlaser(this._gridNumX,this._gridNumY,this._width,this._height,AtlasResourceManager._sid_++));
				this._needGC=true;
				this.garbageCollection();
				this._curAtlasIndex=this._atlaserArray.length-1;
			}
			if (!bSuccess){
				console.log(">>>AtlasManager pushData error");
			}
			return bSuccess;
		}
	}

	__proto.addToAtlas=function(tex){
		laya.webgl.atlas.AtlasResourceManager.instance.pushData(tex);
	}

	/**
	*回收大图合集,不建议手动调用
	*@return
	*/
	__proto.garbageCollection=function(){
		if (this._needGC===true){
			var n=this._atlaserArray.length-this._maxAtlaserCount;
			for (var i=0;i < n;i++){
				this._atlaserArray[i].dispose();
				console.log("AtlasResourceManager:Dispose the inner Atlas。");
			}
			console.log(">>>>altas garbageCollection ="+n);
			this._atlaserArray.splice(0,n);
			this._needGC=false;
		}
		return true;
	}

	__proto.freeAll=function(){
		for (var i=0,n=this._atlaserArray.length;i < n;i++){
			this._atlaserArray[i].dispose();
		}
		this._atlaserArray.length=0;
		this._curAtlasIndex=0;
	}

	__proto.getAtlaserCount=function(){
		return this._atlaserArray.length;
	}

	__proto.getAtlaserByIndex=function(index){
		return this._atlaserArray[index];
	}

	__getset(1,AtlasResourceManager,'instance',function(){
		if (!AtlasResourceManager._Instance){
			AtlasResourceManager._Instance=new AtlasResourceManager(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount);
		}
		return AtlasResourceManager._Instance;
	});

	__getset(1,AtlasResourceManager,'enabled',function(){
		return Config.atlasEnable;
	});

	__getset(1,AtlasResourceManager,'atlasLimitWidth',function(){
		return AtlasResourceManager._atlasLimitWidth;
		},function(value){
		AtlasResourceManager._atlasLimitWidth=value;
	});

	__getset(1,AtlasResourceManager,'atlasLimitHeight',function(){
		return AtlasResourceManager._atlasLimitHeight;
		},function(value){
		AtlasResourceManager._atlasLimitHeight=value;
	});

	AtlasResourceManager._enable=function(){
		Config.atlasEnable=true;
	}

	AtlasResourceManager._disable=function(){
		Config.atlasEnable=false;
	}

	AtlasResourceManager.__init__=function(){
		AtlasResourceManager.atlasTextureWidth=2048;
		AtlasResourceManager.atlasTextureHeight=2048;
		AtlasResourceManager.maxTextureCount=6;
		AtlasResourceManager.atlasLimitWidth=512;
		AtlasResourceManager.atlasLimitHeight=512;
	}

	AtlasResourceManager._atlasLimitWidth=0;
	AtlasResourceManager._atlasLimitHeight=0;
	AtlasResourceManager.gridSize=16;
	AtlasResourceManager.atlasTextureWidth=0;
	AtlasResourceManager.atlasTextureHeight=0;
	AtlasResourceManager.maxTextureCount=0;
	AtlasResourceManager._atlasRestore=0;
	AtlasResourceManager.BOARDER_TYPE_NO=0;
	AtlasResourceManager.BOARDER_TYPE_RIGHT=1;
	AtlasResourceManager.BOARDER_TYPE_LEFT=2;
	AtlasResourceManager.BOARDER_TYPE_BOTTOM=4;
	AtlasResourceManager.BOARDER_TYPE_TOP=8;
	AtlasResourceManager.BOARDER_TYPE_ALL=15;
	AtlasResourceManager._sid_=0;
	AtlasResourceManager._Instance=null;
	return AtlasResourceManager;
})()


//class laya.webgl.atlas.MergeFillInfo
var MergeFillInfo=(function(){
	function MergeFillInfo(){
		this.x=0;
		this.y=0;
		this.ret=false;
		this.ret=false;
		this.x=0;
		this.y=0;
	}

	__class(MergeFillInfo,'laya.webgl.atlas.MergeFillInfo');
	return MergeFillInfo;
})()


;
//class laya.webgl.canvas.BlendMode
var BlendMode=(function(){
	function BlendMode(){}
	__class(BlendMode,'laya.webgl.canvas.BlendMode');
	BlendMode._init_=function(gl){
		BlendMode.fns=[BlendMode.BlendNormal,BlendMode.BlendAdd,BlendMode.BlendMultiply,BlendMode.BlendScreen,BlendMode.BlendOverlay,BlendMode.BlendLight,BlendMode.BlendMask,BlendMode.BlendDestinationOut];
		BlendMode.targetFns=[BlendMode.BlendNormalTarget,BlendMode.BlendAddTarget,BlendMode.BlendMultiplyTarget,BlendMode.BlendScreenTarget,BlendMode.BlendOverlayTarget,BlendMode.BlendLightTarget,BlendMode.BlendMask,BlendMode.BlendDestinationOut];
	}

	BlendMode.BlendNormal=function(gl){
		gl.blendFunc(1,0x0303);
	}

	BlendMode.BlendAdd=function(gl){
		gl.blendFunc(1,0x0304);
	}

	BlendMode.BlendMultiply=function(gl){
		gl.blendFunc(0x0306,0x0303);
	}

	BlendMode.BlendScreen=function(gl){
		gl.blendFunc(1,1);
	}

	BlendMode.BlendOverlay=function(gl){
		gl.blendFunc(1,0x0301);
	}

	BlendMode.BlendLight=function(gl){
		gl.blendFunc(1,1);
	}

	BlendMode.BlendNormalTarget=function(gl){
		gl.blendFunc(1,0x0303);
	}

	BlendMode.BlendAddTarget=function(gl){
		gl.blendFunc(1,0x0304);
	}

	BlendMode.BlendMultiplyTarget=function(gl){
		gl.blendFunc(0x0306,0x0303);
	}

	BlendMode.BlendScreenTarget=function(gl){
		gl.blendFunc(1,1);
	}

	BlendMode.BlendOverlayTarget=function(gl){
		gl.blendFunc(1,0x0301);
	}

	BlendMode.BlendLightTarget=function(gl){
		gl.blendFunc(1,1);
	}

	BlendMode.BlendMask=function(gl){
		gl.blendFunc(0,0x0302);
	}

	BlendMode.BlendDestinationOut=function(gl){
		gl.blendFunc(0,0);
	}

	BlendMode.activeBlendFunction=null;
	BlendMode.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"];
	BlendMode.TOINT={"normal":0,"add":1,"multiply":2,"screen":3 ,"lighter":1,"overlay":4,"light":5,"mask":6,"destination-out":7};
	BlendMode.NORMAL="normal";
	BlendMode.ADD="add";
	BlendMode.MULTIPLY="multiply";
	BlendMode.SCREEN="screen";
	BlendMode.LIGHT="light";
	BlendMode.OVERLAY="overlay";
	BlendMode.DESTINATIONOUT="destination-out";
	BlendMode.fns=[];
	BlendMode.targetFns=[];
	return BlendMode;
})()


//class laya.webgl.canvas.DrawStyle
var DrawStyle=(function(){
	function DrawStyle(value){
		this._color=Color$1.create("black");
		this.setValue(value);
	}

	__class(DrawStyle,'laya.webgl.canvas.DrawStyle');
	var __proto=DrawStyle.prototype;
	__proto.setValue=function(value){
		if (value){
			if ((typeof value=='string')){
				this._color=Color$1.create(value);
				return;
			}
			if ((value instanceof laya.utils.Color )){
				this._color=value;
				return;
			}
		}
	}

	__proto.reset=function(){
		this._color=Color$1.create("black");
	}

	__proto.equal=function(value){
		if ((typeof value=='string'))return this._color.strColor===value;
		if ((value instanceof laya.utils.Color ))return this._color.numColor===(value).numColor;
		return false;
	}

	__proto.toColorStr=function(){
		return this._color.strColor;
	}

	DrawStyle.create=function(value){
		if (value){
			var color;
			if ((typeof value=='string'))color=Color$1.create(value);
			else if ((value instanceof laya.utils.Color ))color=value;
			if (color){
				return color._drawStyle || (color._drawStyle=new DrawStyle(value));
			}
		}
		return laya.webgl.canvas.DrawStyle.DEFAULT;
	}

	__static(DrawStyle,
	['DEFAULT',function(){return this.DEFAULT=new DrawStyle("#000000");}
	]);
	return DrawStyle;
})()


//class laya.webgl.canvas.Path
var Path=(function(){
	function Path(){
		this._x=0;
		this._y=0;
		//this._rect=null;
		//this.ib=null;
		//this.vb=null;
		this.dirty=false;
		//this.geomatrys=null;
		//this._curGeomatry=null;
		this.offset=0;
		this.count=0;
		this.geoStart=0;
		this.tempArray=[];
		this.closePath=false;
		this.geomatrys=[];
		var gl=WebGL.mainContext;
		this.ib=IndexBuffer2D.create(0x88E8);
		this.vb=VertexBuffer2D.create(5);
	}

	__class(Path,'laya.webgl.canvas.Path');
	var __proto=Path.prototype;
	__proto.addPoint=function(pointX,pointY){
		this.tempArray.push(pointX,pointY);
	}

	__proto.getEndPointX=function(){
		return this.tempArray[this.tempArray.length-2];
	}

	__proto.getEndPointY=function(){
		return this.tempArray[this.tempArray.length-1];
	}

	__proto.polygon=function(x,y,points,color,borderWidth,borderColor){
		var geo;
		this.geomatrys.push(this._curGeomatry=geo=new Polygon(x,y,points,color,borderWidth,borderColor));
		if (!color)geo.fill=false;
		if (borderColor==undefined)geo.borderWidth=0;
		return geo;
	}

	__proto.setGeomtry=function(shape){
		this.geomatrys.push(this._curGeomatry=shape);
	}

	__proto.drawLine=function(x,y,points,width,color){
		var geo;
		if (this.closePath){
			this.geomatrys.push(this._curGeomatry=geo=new LoopLine(x,y,points,width,color));
			}else {
			this.geomatrys.push(this._curGeomatry=geo=new Line(x,y,points,width,color));
		}
		geo.fill=false;
		return geo;
	}

	__proto.update=function(){
		var si=this.ib._byteLength;
		var len=this.geomatrys.length;
		this.offset=si;
		for (var i=this.geoStart;i < len;i++){
			this.geomatrys[i].getData(this.ib,this.vb,this.vb._byteLength / 20);
		}
		this.geoStart=len;
		this.count=(this.ib._byteLength-si)/ CONST3D2D.BYTES_PIDX;
	}

	__proto.reset=function(){
		this.vb.clear();
		this.ib.clear();
		this.offset=this.count=this.geoStart=0;
		this.geomatrys.length=0;
	}

	__proto.recover=function(){
		this._curGeomatry=null;
		this.vb.destory();
		this.vb=null;
		this.ib.destory();
		this.ib=null;
	}

	return Path;
})()


//class laya.webgl.canvas.save.SaveBase
var SaveBase=(function(){
	function SaveBase(){
		//this._valueName=null;
		//this._value=null;
		//this._dataObj=null;
		//this._newSubmit=false;
	}

	__class(SaveBase,'laya.webgl.canvas.save.SaveBase');
	var __proto=SaveBase.prototype;
	Laya.imps(__proto,{"laya.webgl.canvas.save.ISaveData":true})
	__proto.isSaveMark=function(){return false;}
	__proto.restore=function(context){
		this._dataObj[this._valueName]=this._value;
		SaveBase._cache[SaveBase._cache._length++]=this;
		this._newSubmit && (context._curSubmit=Submit.RENDERBASE,context._renderKey=0);
	}

	SaveBase._createArray=function(){
		var value=[];
		value._length=0;
		return value;
	}

	SaveBase._init=function(){
		var namemap=SaveBase._namemap={};
		namemap[0x1]="ALPHA";
		namemap[0x2]="fillStyle";
		namemap[0x8]="font";
		namemap[0x100]="lineWidth";
		namemap[0x200]="strokeStyle";
		namemap[0x2000]="_mergeID";
		namemap[0x400]=namemap[0x800]=namemap[0x1000]=[];
		namemap[0x4000]="textBaseline";
		namemap[0x8000]="textAlign";
		namemap[0x10000]="_nBlendType";
		namemap[0x100000]="shader";
		namemap[0x200000]="filters";
		return namemap;
	}

	SaveBase.save=function(context,type,dataObj,newSubmit){
		if ((context._saveMark._saveuse & type)!==type){
			context._saveMark._saveuse |=type;
			var cache=SaveBase._cache;
			var o=cache._length > 0 ? cache[--cache._length] :(new SaveBase());
			o._value=dataObj[o._valueName=SaveBase._namemap[type]];
			o._dataObj=dataObj;
			o._newSubmit=newSubmit;
			var _save=context._save;
			_save[_save._length++]=o;
		}
	}

	SaveBase._cache=laya.webgl.canvas.save.SaveBase._createArray();
	SaveBase._namemap=SaveBase._init();
	return SaveBase;
})()


//class laya.webgl.canvas.save.SaveClipRect
var SaveClipRect=(function(){
	function SaveClipRect(){
		//this._clipSaveRect=null;
		//this._submitScissor=null;
		this._clipRect=new Rectangle();
	}

	__class(SaveClipRect,'laya.webgl.canvas.save.SaveClipRect');
	var __proto=SaveClipRect.prototype;
	Laya.imps(__proto,{"laya.webgl.canvas.save.ISaveData":true})
	__proto.isSaveMark=function(){return false;}
	__proto.restore=function(context){
		context._clipRect=this._clipSaveRect;
		SaveClipRect._cache[SaveClipRect._cache._length++]=this;
		this._submitScissor.submitLength=context._submits._length-this._submitScissor.submitIndex;
		context._curSubmit=Submit.RENDERBASE;
		context._renderKey=0;
	}

	SaveClipRect.save=function(context,submitScissor){
		if ((context._saveMark._saveuse & 0x20000)==0x20000)return;
		context._saveMark._saveuse |=0x20000;
		var cache=SaveClipRect._cache;
		var o=cache._length > 0 ? cache[--cache._length] :(new SaveClipRect());
		o._clipSaveRect=context._clipRect;
		context._clipRect=o._clipRect.copyFrom(context._clipRect);
		o._submitScissor=submitScissor;
		var _save=context._save;
		_save[_save._length++]=o;
	}

	__static(SaveClipRect,
	['_cache',function(){return this._cache=SaveBase._createArray();}
	]);
	return SaveClipRect;
})()


//class laya.webgl.canvas.save.SaveClipRectStencil
var SaveClipRectStencil=(function(){
	function SaveClipRectStencil(){
		//this._clipSaveRect=null;
		//this._saveMatrix=null;
		this._contextX=0;
		this._contextY=0;
		//this._submitStencil=null;
		this._clipRect=new Rectangle();
		this._rect=new Rectangle();
		this._matrix=new Matrix();
	}

	__class(SaveClipRectStencil,'laya.webgl.canvas.save.SaveClipRectStencil');
	var __proto=SaveClipRectStencil.prototype;
	Laya.imps(__proto,{"laya.webgl.canvas.save.ISaveData":true})
	__proto.isSaveMark=function(){return false;}
	__proto.restore=function(context){
		SubmitStencil.restore(context,this._rect,this._saveMatrix,this._contextX,this._contextY);
		context._clipRect=this._clipSaveRect;
		context._curMat=this._saveMatrix;
		context._x=this._contextX;
		context._y=this._contextY;
		SaveClipRectStencil._cache[SaveClipRectStencil._cache._length++]=this;
		context._curSubmit=Submit.RENDERBASE;
	}

	SaveClipRectStencil.save=function(context,submitStencil,x,y,width,height,clipX,clipY,clipWidth,clipHeight){
		if ((context._saveMark._saveuse & 0x40000)==0x40000)return;
		context._saveMark._saveuse |=0x40000;
		var cache=SaveClipRectStencil._cache;
		var o=cache._length > 0 ? cache[--cache._length] :(new SaveClipRectStencil());
		o._clipSaveRect=context._clipRect;
		o._clipRect.setTo(clipX,clipY,clipWidth,clipHeight);
		context._clipRect=o._clipRect;
		o._rect.x=x;
		o._rect.y=y;
		o._rect.width=width;
		o._rect.height=height;
		o._contextX=context._x;
		o._contextY=context._y;
		o._saveMatrix=context._curMat;
		context._curMat.copyTo(o._matrix);
		context._curMat=o._matrix;
		o._submitStencil=submitStencil;
		var _save=context._save;
		_save[_save._length++]=o;
	}

	__static(SaveClipRectStencil,
	['_cache',function(){return this._cache=SaveBase._createArray();}
	]);
	return SaveClipRectStencil;
})()


//class laya.webgl.canvas.save.SaveMark
var SaveMark=(function(){
	function SaveMark(){
		this._saveuse=0;
		//this._preSaveMark=null;
		;
	}

	__class(SaveMark,'laya.webgl.canvas.save.SaveMark');
	var __proto=SaveMark.prototype;
	Laya.imps(__proto,{"laya.webgl.canvas.save.ISaveData":true})
	__proto.isSaveMark=function(){
		return true;
	}

	__proto.restore=function(context){
		context._saveMark=this._preSaveMark;
		SaveMark._no[SaveMark._no._length++]=this;
	}

	SaveMark.Create=function(context){
		var no=SaveMark._no;
		var o=no._length > 0 ? no[--no._length] :(new SaveMark());
		o._saveuse=0;
		o._preSaveMark=context._saveMark;
		context._saveMark=o;
		return o;
	}

	__static(SaveMark,
	['_no',function(){return this._no=SaveBase._createArray();}
	]);
	return SaveMark;
})()


//class laya.webgl.canvas.save.SaveTransform
var SaveTransform=(function(){
	function SaveTransform(){
		//this._savematrix=null;
		this._matrix=new Matrix();
	}

	__class(SaveTransform,'laya.webgl.canvas.save.SaveTransform');
	var __proto=SaveTransform.prototype;
	Laya.imps(__proto,{"laya.webgl.canvas.save.ISaveData":true})
	__proto.isSaveMark=function(){return false;}
	__proto.restore=function(context){
		context._curMat=this._savematrix;
		SaveTransform._no[SaveTransform._no._length++]=this;
	}

	SaveTransform.save=function(context){
		var _saveMark=context._saveMark;
		if ((_saveMark._saveuse & 0x800)===0x800)return;
		_saveMark._saveuse |=0x800;
		var no=SaveTransform._no;
		var o=no._length > 0 ? no[--no._length] :(new SaveTransform());
		o._savematrix=context._curMat;
		context._curMat=context._curMat.copyTo(o._matrix);
		var _save=context._save;
		_save[_save._length++]=o;
	}

	__static(SaveTransform,
	['_no',function(){return this._no=SaveBase._createArray();}
	]);
	return SaveTransform;
})()


//class laya.webgl.canvas.save.SaveTranslate
var SaveTranslate=(function(){
	function SaveTranslate(){
		//this._x=NaN;
		//this._y=NaN;
	}

	__class(SaveTranslate,'laya.webgl.canvas.save.SaveTranslate');
	var __proto=SaveTranslate.prototype;
	Laya.imps(__proto,{"laya.webgl.canvas.save.ISaveData":true})
	__proto.isSaveMark=function(){return false;}
	__proto.restore=function(context){
		var mat=context._curMat;
		context._x=this._x;
		context._y=this._y;
		SaveTranslate._no[SaveTranslate._no._length++]=this;
	}

	SaveTranslate.save=function(context){
		var no=SaveTranslate._no;
		var o=no._length > 0 ? no[--no._length] :(new SaveTranslate());
		o._x=context._x;
		o._y=context._y;
		var _save=context._save;
		_save[_save._length++]=o;
	}

	__static(SaveTranslate,
	['_no',function(){return this._no=SaveBase._createArray();}
	]);
	return SaveTranslate;
})()


//class laya.webgl.resource.RenderTargetMAX
var RenderTargetMAX=(function(){
	function RenderTargetMAX(){
		//public var targets:Vector.<OneTarget>;//没用到
		this.target=null;
		this.repaint=false;
		this._width=NaN;
		this._height=NaN;
		this._sp=null;
		this._clipRect=new Rectangle();
	}

	__class(RenderTargetMAX,'laya.webgl.resource.RenderTargetMAX');
	var __proto=RenderTargetMAX.prototype;
	__proto.setSP=function(sp){
		this._sp=sp;
	}

	__proto.size=function(w,h){
		var _$this=this;
		if (this._width===w && this._height===h){
			this.target.size(w,h);
			return;
		}
		this.repaint=true;
		this._width=w;
		this._height=h;
		if (!this.target)
			this.target=RenderTarget2D.create(w,h);
		else
		this.target.size(w,h);
		if (!this.target.hasListener("recovered")){
			this.target.on("recovered",this,function(e){
				Laya.timer.callLater(_$this._sp,_$this._sp.repaint);
			});
		}
	}

	__proto._flushToTarget=function(context,target){
		if (target._destroy)return;
		var worldScissorTest=RenderState2D.worldScissorTest;
		var preworldClipRect=RenderState2D.worldClipRect;
		RenderState2D.worldClipRect=this._clipRect;
		this._clipRect.x=this._clipRect.y=0;
		this._clipRect.width=this._width;
		this._clipRect.height=this._height;
		RenderState2D.worldScissorTest=false;
		WebGL.mainContext.disable(0x0C11);
		var preAlpha=RenderState2D.worldAlpha;
		var preMatrix4=RenderState2D.worldMatrix4;
		var preMatrix=RenderState2D.worldMatrix;
		var preFilters=RenderState2D.worldFilters;
		var preShaderDefines=RenderState2D.worldShaderDefines;
		RenderState2D.worldMatrix=Matrix.EMPTY;
		RenderState2D.restoreTempArray();
		RenderState2D.worldMatrix4=RenderState2D.TEMPMAT4_ARRAY;
		RenderState2D.worldAlpha=1;
		RenderState2D.worldFilters=null;
		RenderState2D.worldShaderDefines=null;
		BaseShader.activeShader=null;
		target.start();
		Config.showCanvasMark ? target.clear(0,1,0,0.3):target.clear(0,0,0,0);
		context.flush();
		target.end();
		BaseShader.activeShader=null;
		RenderState2D.worldAlpha=preAlpha;
		RenderState2D.worldMatrix4=preMatrix4;
		RenderState2D.worldMatrix=preMatrix;
		RenderState2D.worldFilters=preFilters;
		RenderState2D.worldShaderDefines=preShaderDefines;
		RenderState2D.worldScissorTest=worldScissorTest
		if (worldScissorTest){
			var y=RenderState2D.height-preworldClipRect.y-preworldClipRect.height;
			WebGL.mainContext.scissor(preworldClipRect.x,y,preworldClipRect.width,preworldClipRect.height);
			WebGL.mainContext.enable(0x0C11);
		}
		RenderState2D.worldClipRect=preworldClipRect;
	}

	__proto.flush=function(context){
		if (this.repaint){
			this._flushToTarget(context,this.target);
			this.repaint=false;
		}
	}

	__proto.drawTo=function(context,x,y,width,height){
		context.drawTexture(this.target.getTexture(),x,y,width,height,0,0);
	}

	__proto.destroy=function(){
		if (this.target){
			this.target.destroy();
			this.target=null;
			this._sp=null;
		}
	}

	return RenderTargetMAX;
})()


//class laya.webgl.shader.d2.Shader2D
var Shader2D=(function(){
	function Shader2D(){
		this.ALPHA=1;
		//this.glTexture=null;
		//this.shader=null;
		//this.filters=null;
		this.shaderType=0;
		//this.colorAdd=null;
		//this.strokeStyle=null;
		//this.fillStyle=null;
		this.defines=new ShaderDefines2D();
	}

	__class(Shader2D,'laya.webgl.shader.d2.Shader2D');
	var __proto=Shader2D.prototype;
	__proto.destroy=function(){
		this.defines=null;
		this.filters=null;
		this.glTexture=null;
		this.strokeStyle=null;
		this.fillStyle=null;
	}

	Shader2D.__init__=function(){
		Shader.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;");
		Shader.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n");
		Shader.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;");
		Shader.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n	for(float j = 0.0;j<=c_IterationTime; ++j){\n		vec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n		vec4Color += texture2D(texture, v_texcoord + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n	}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;");
		Shader.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;");
		Shader.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}");
		Shader.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n");
		Shader.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;");
		var vs,ps;
		vs="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}";
		ps="precision mediump float;\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\n#include?BLUR_FILTER  \"parts/BlurFilter_ps_uniform.glsl\";\n#include?COLOR_FILTER \"parts/ColorFilter_ps_uniform.glsl\";\n#include?GLOW_FILTER \"parts/GlowFilter_ps_uniform.glsl\";\n#include?COLOR_ADD \"parts/ColorAdd_ps_uniform.glsl\";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD \"parts/ColorAdd_ps_logic.glsl\";   \n   #include?BLUR_FILTER  \"parts/BlurFilter_ps_logic.glsl\";\n   #include?COLOR_FILTER \"parts/ColorFilter_ps_logic.glsl\";\n   #include?GLOW_FILTER \"parts/GlowFilter_ps_logic.glsl\";\n}";
		Shader.preCompile2D(0,0x01,vs,ps,null);
		vs="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}";
		ps="precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER \"parts/ColorFilter_ps_uniform.glsl\";\nvoid main() {\n	vec4 a = vec4(color.r, color.g, color.b, color.a);\n	a.w = alpha;\n	a.xyz *= alpha;\n	gl_FragColor = a;\n	#include?COLOR_FILTER \"parts/ColorFilter_ps_logic.glsl\";\n}";
		Shader.preCompile2D(0,0x02,vs,ps,null);
		vs="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}";
		ps="precision mediump float;\n//precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n	//vec4 a=vec4(color.r, color.g, color.b, 1);\n	//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n	gl_FragColor.rgb*=alpha;\n}";
		Shader.preCompile2D(0,0x04,vs,ps,null);
		vs="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}";
		ps="#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  \"parts/BlurFilter_ps_uniform.glsl\";\n#include?COLOR_FILTER \"parts/ColorFilter_ps_uniform.glsl\";\n#include?GLOW_FILTER \"parts/GlowFilter_ps_uniform.glsl\";\n#include?COLOR_ADD \"parts/ColorAdd_ps_uniform.glsl\";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD \"parts/ColorAdd_ps_logic.glsl\";   \n   #include?BLUR_FILTER  \"parts/BlurFilter_ps_logic.glsl\";\n   #include?COLOR_FILTER \"parts/ColorFilter_ps_logic.glsl\";\n   #include?GLOW_FILTER \"parts/GlowFilter_ps_logic.glsl\";\n}";
		Shader.preCompile2D(0,0x100,vs,ps,null);
		vs="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}";
		ps="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n	vec4 t_color = texture2D(texture, v_texcoord);\n	gl_FragColor = t_color.rgba * v_color;\n	gl_FragColor *= alpha;\n}";
		Shader.preCompile2D(0,0x200,vs,ps,null);
	}

	return Shader2D;
})()


//class laya.webgl.shader.ShaderDefines
var ShaderDefines$1=(function(){
	function ShaderDefines(name2int,int2name,int2nameMap){
		this._value=0;
		//this._name2int=null;
		//this._int2name=null;
		//this._int2nameMap=null;
		this._name2int=name2int;
		this._int2name=int2name;
		this._int2nameMap=int2nameMap;
	}

	__class(ShaderDefines,'laya.webgl.shader.ShaderDefines',null,'ShaderDefines$1');
	var __proto=ShaderDefines.prototype;
	__proto.add=function(value){
		if ((typeof value=='string'))value=this._name2int[value];
		this._value |=value;
		return this._value;
	}

	__proto.addInt=function(value){
		this._value |=value;
		return this._value;
	}

	__proto.remove=function(value){
		if ((typeof value=='string'))value=this._name2int[value];
		this._value &=(~value);
		return this._value;
	}

	__proto.isDefine=function(def){
		return (this._value & def)===def;
	}

	__proto.getValue=function(){
		return this._value;
	}

	__proto.setValue=function(value){
		this._value=value;
	}

	__proto.toNameDic=function(){
		var r=this._int2nameMap[this._value];
		return r ? r :ShaderDefines._toText(this._value,this._int2name,this._int2nameMap);
	}

	ShaderDefines._reg=function(name,value,_name2int,_int2name){
		_name2int[name]=value;
		_int2name[value]=name;
	}

	ShaderDefines._toText=function(value,_int2name,_int2nameMap){
		var r=_int2nameMap[value];
		if (r)return r;
		var o={};
		var d=1;
		for (var i=0;i < 32;i++){
			d=1 << i;
			if (d > value)break ;
			if (value & d){
				var name=_int2name[d];
				name && (o[name]="");
			}
		}
		_int2nameMap[value]=o;
		return o;
	}

	ShaderDefines._toInt=function(names,_name2int){
		var words=names.split('.');
		var num=0;
		for (var i=0,n=words.length;i < n;i++){
			var value=_name2int[words[i]];
			if (!value)throw new Error("Defines to int err:"+names+"/"+words[i]);
			num |=value;
		}
		return num;
	}

	return ShaderDefines;
})()


/**
*这里销毁的问题，后面待确认
*/
//class laya.webgl.shader.d2.skinAnishader.SkinMesh
var SkinMesh=(function(){
	function SkinMesh(){
		this.mVBBuffer=null;
		this.mIBBuffer=null;
		this.mVBData=null;
		this.mIBData=null;
		this.mEleNum=0;
		this.mTexture=null;
		this.transform=null;
		this._vs=null;
		this._ps=null;
		this._indexStart=-1;
		this._verticles=null;
		this._uvs=null;
		this._tempMatrix=new Matrix();
	}

	__class(SkinMesh,'laya.webgl.shader.d2.skinAnishader.SkinMesh');
	var __proto=SkinMesh.prototype;
	__proto.init=function(texture,vs,ps){
		if (vs){
			this._vs=vs;
			}else {
			this._vs=[];
			var tWidth=texture.width;
			var tHeight=texture.height;
			var tRed=1;
			var tGreed=1;
			var tBlue=1;
			var tAlpha=1;
			this._vs.push(0,0,0,0,tRed,tGreed,tBlue,tAlpha);
			this._vs.push(tWidth,0,1,0,tRed,tGreed,tBlue,tAlpha);
			this._vs.push(tWidth,tHeight,1,1,tRed,tGreed,tBlue,tAlpha);
			this._vs.push(0,tHeight,0,1,tRed,tGreed,tBlue,tAlpha);
		}
		if (ps){
			this._ps=ps;
			}else {
			if (!SkinMesh._defaultPS){
				SkinMesh._defaultPS=[];
				SkinMesh._defaultPS.push(0,1,3,3,1,2);
			}
			this._ps=SkinMesh._defaultPS;
		}
		this.mVBData=new Float32Array(this._vs);
		this.mIBData=new Uint16Array(this._ps.length);
		this.mIBData["start"]=-1;
		this.mEleNum=this._ps.length;
		this.mTexture=texture;
	}

	__proto.init2=function(texture,vs,ps,verticles,uvs){
		if (this.transform)this.transform=null;
		if (ps){
			this._ps=ps;
			}else {
			this._ps=[];
			this._ps.push(0,1,3,3,1,2);
		}
		this._verticles=verticles;
		this._uvs=uvs;
		this.mEleNum=this._ps.length;
		this.mTexture=texture;
		if (Render.isConchNode || Render.isConchApp){
			this._initMyData();
			this.mVBData=new Float32Array(this._vs);
		}
	}

	__proto._initMyData=function(){
		var vsI=0;
		var vI=0;
		var vLen=this._verticles.length;
		var tempVLen=vLen *4;
		this._vs=SkinMesh._tempVS;
		var insertNew=false;
		if (Render.isConchNode || Render.isConchApp){
			this._vs.length=tempVLen;
			insertNew=true;
			}else{
			if (this._vs.length < tempVLen){
				this._vs.length=tempVLen;
				insertNew=true;
			}
		}
		SkinMesh._tVSLen=tempVLen;
		if (insertNew){
			while (vsI < tempVLen){
				this._vs[vsI]=this._verticles[vI];
				this._vs[vsI+1]=this._verticles[vI+1];
				this._vs[vsI+2]=this._uvs[vI];
				this._vs[vsI+3]=this._uvs[vI+1];
				this._vs[vsI+4]=1;
				this._vs[vsI+5]=1;
				this._vs[vsI+6]=1;
				this._vs[vsI+7]=1;
				vsI+=8;
				vI+=2;
			}
			}else{
			while (vsI < tempVLen){
				this._vs[vsI]=this._verticles[vI];
				this._vs[vsI+1]=this._verticles[vI+1];
				this._vs[vsI+2]=this._uvs[vI];
				this._vs[vsI+3]=this._uvs[vI+1];
				vsI+=8;
				vI+=2;
			}
		}
	}

	__proto.getData2=function(vb,ib,start){
		this.mVBBuffer=vb;
		this.mIBBuffer=ib;
		this._initMyData();
		vb.appendEx2(this._vs,Float32Array,SkinMesh._tVSLen,4);
		this._indexStart=ib._byteLength;
		var tIB;
		tIB=SkinMesh._tempIB;
		if (tIB.length < this._ps.length){
			tIB.length=this._ps.length;
		}
		for (var i=0,n=this._ps.length;i < n;i++){
			tIB[i]=this._ps[i]+start;
		}
		ib.appendEx2(tIB,Uint16Array,this._ps.length,2);
	}

	__proto.getData=function(vb,ib,start){
		this.mVBBuffer=vb;
		this.mIBBuffer=ib;
		vb.append(this.mVBData);
		this._indexStart=ib._byteLength;
		if (this.mIBData["start"] !=start){
			for (var i=0,n=this._ps.length;i < n;i++){
				this.mIBData[i]=this._ps[i]+start;
			}
			this.mIBData["start"]=start;
		}
		ib.append(this.mIBData);
	}

	__proto.render=function(context,x,y){
		if (Render.isWebGL && this.mTexture){
			context._renderKey=0;
			context._shader2D.glTexture=null;
			SkinMeshBuffer.getInstance().addSkinMesh(this);
			var tempSubmit=Submit.createShape(context,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,Value2D.create(0x200,0));
			this.transform || (this.transform=Matrix.EMPTY);
			this.transform.translate(x,y);
			Matrix.mul(this.transform,context._curMat,this._tempMatrix);
			this.transform.translate(-x,-y);
			var tShaderValue=tempSubmit.shaderValue;
			var tArray=tShaderValue.u_mmat2||RenderState2D.getMatrArray();
			RenderState2D.mat2MatArray(this._tempMatrix,tArray);
			tShaderValue.textureHost=this.mTexture;
			tShaderValue.offsetX=0;
			tShaderValue.offsetY=0;
			tShaderValue.u_mmat2=tArray;
			tShaderValue.ALPHA=context._shader2D.ALPHA;
			context._submits[context._submits._length++]=tempSubmit;
		}
		else if (Render.isConchApp&&this.mTexture){
			this.transform || (this.transform=Matrix.EMPTY);
			context.setSkinMesh&&context.setSkinMesh(x,y,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform);
		}
	}

	SkinMesh._tempVS=[];
	SkinMesh._tempIB=[];
	SkinMesh._defaultPS=null;
	SkinMesh._tVSLen=0;
	return SkinMesh;
})()


//class laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer
var SkinMeshBuffer=(function(){
	function SkinMeshBuffer(){
		this.ib=null;
		this.vb=null;
		var gl=WebGL.mainContext;
		this.ib=IndexBuffer2D.create(0x88E8);
		this.vb=VertexBuffer2D.create(8);
	}

	__class(SkinMeshBuffer,'laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer');
	var __proto=SkinMeshBuffer.prototype;
	__proto.addSkinMesh=function(skinMesh){
		skinMesh.getData2(this.vb,this.ib,this.vb._byteLength / 32);
	}

	__proto.reset=function(){
		this.vb.clear();
		this.ib.clear();
	}

	SkinMeshBuffer.getInstance=function(){
		return SkinMeshBuffer.instance=SkinMeshBuffer.instance|| new SkinMeshBuffer();
	}

	SkinMeshBuffer.instance=null;
	return SkinMeshBuffer;
})()


//此类可以减少代码
//class laya.webgl.shapes.BasePoly
var BasePoly=(function(){
	function BasePoly(x,y,width,height,edges,color,borderWidth,borderColor,round){
		//this.x=NaN;
		//this.y=NaN;
		//this.r=NaN;
		//this.width=NaN;
		//this.height=NaN;
		//this.edges=NaN;
		this.r0=0
		//this.color=0;
		//this.borderColor=NaN;
		//this.borderWidth=NaN;
		//this.round=0;
		this.fill=true;
		//this.mUint16Array=null;
		//this.mFloat32Array=null;
		this.r1=Math.PI / 2;
		(round===void 0)&& (round=0);
		this.x=x;
		this.y=y;
		this.width=width;
		this.height=height;
		this.edges=edges;
		this.color=color;
		this.borderWidth=borderWidth;
		this.borderColor=borderColor;
	}

	__class(BasePoly,'laya.webgl.shapes.BasePoly');
	var __proto=BasePoly.prototype;
	Laya.imps(__proto,{"laya.webgl.shapes.IShape":true})
	__proto.getData=function(ib,vb,start){}
	__proto.rebuild=function(points){}
	__proto.setMatrix=function(mat){}
	__proto.needUpdate=function(mat){
		return true;
	}

	__proto.sector=function(outVert,outIndex,start){
		var x=this.x,y=this.y,edges=this.edges,seg=(this.r1-this.r0)/ edges;
		var w=this.width,h=this.height,color=this.color;
		var r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;
		outVert.push(x,y,r,g,b);
		for (var i=0;i < edges+1;i++){
			outVert.push(x+Math.sin(seg *i+this.r0)*w,y+Math.cos(seg *i+this.r0)*h);
			outVert.push(r,g,b);
		}
		for (i=0;i < edges;i++){
			outIndex.push(start,start+i+1,start+i+2);
		}
	}

	//用于画线
	__proto.createLine2=function(p,indices,lineWidth,len,outVertex,indexCount){
		var points=p.concat();
		var result=outVertex;
		var color=this.borderColor;
		var r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;
		var length=points.length / 2;
		var iStart=len,w=lineWidth / 2;
		var px,py,p1x,p1y,p2x,p2y,p3x,p3y;
		var perpx,perpy,perp2x,perp2y,perp3x,perp3y;
		var a1,b1,c1,a2,b2,c2;
		var denom,pdist,dist;
		p1x=points[0];
		p1y=points[1];
		p2x=points[2];
		p2y=points[3];
		perpx=-(p1y-p2y);
		perpy=p1x-p2x;
		dist=Math.sqrt(perpx *perpx+perpy *perpy);
		perpx=perpx / dist *w;
		perpy=perpy / dist *w;
		result.push(p1x-perpx+this.x,p1y-perpy+this.y,r,g,b,p1x+perpx+this.x,p1y+perpy+this.y,r,g,b);
		for (var i=1;i < length-1;i++){
			p1x=points[(i-1)*2];
			p1y=points[(i-1)*2+1];
			p2x=points[(i)*2];
			p2y=points[(i)*2+1];
			p3x=points[(i+1)*2];
			p3y=points[(i+1)*2+1];
			perpx=-(p1y-p2y);
			perpy=p1x-p2x;
			dist=Math.sqrt(perpx *perpx+perpy *perpy);
			perpx=perpx / dist *w;
			perpy=perpy / dist *w;
			perp2x=-(p2y-p3y);
			perp2y=p2x-p3x;
			dist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);
			perp2x=perp2x / dist *w;
			perp2y=perp2y / dist *w;
			a1=(-perpy+p1y)-(-perpy+p2y);
			b1=(-perpx+p2x)-(-perpx+p1x);
			c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);
			a2=(-perp2y+p3y)-(-perp2y+p2y);
			b2=(-perp2x+p2x)-(-perp2x+p3x);
			c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);
			denom=a1 *b2-a2 *b1;
			if (Math.abs(denom)< 0.1){
				denom+=10.1;
				result.push(p2x-perpx+this.x,p2y-perpy+this.y,r,g,b,p2x+perpx+this.x,p2y+perpy+this.y,r,g,b);
				continue ;
			}
			px=(b1 *c2-b2 *c1)/ denom;
			py=(a2 *c1-a1 *c2)/ denom;
			pdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);
			result.push(px+this.x,py+this.y,r,g,b,p2x-(px-p2x)+this.x,p2y-(py-p2y)+this.y,r,g,b);
		}
		p1x=points[points.length-4];
		p1y=points[points.length-3];
		p2x=points[points.length-2];
		p2y=points[points.length-1];
		perpx=-(p1y-p2y);
		perpy=p1x-p2x;
		dist=Math.sqrt(perpx *perpx+perpy *perpy);
		perpx=perpx / dist *w;
		perpy=perpy / dist *w;
		result.push(p2x-perpx+this.x,p2y-perpy+this.y,r,g,b,p2x+perpx+this.x,p2y+perpy+this.y,r,g,b);
		var groupLen=indexCount;
		for (i=1;i < groupLen;i++){
			indices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);
		}
		return result;
	}

	// /*,outVertex:Array,outIndex:Array*/
	__proto.createLine=function(p,indices,lineWidth,len){
		var points=p.concat();
		var result=p;
		var color=this.borderColor;
		var r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;
		points.splice(0,5);
		var length=points.length / 5;
		var iStart=len,w=lineWidth / 2;
		var px,py,p1x,p1y,p2x,p2y,p3x,p3y;
		var perpx,perpy,perp2x,perp2y,perp3x,perp3y;
		var a1,b1,c1,a2,b2,c2;
		var denom,pdist,dist;
		p1x=points[0];
		p1y=points[1];
		p2x=points[5];
		p2y=points[6];
		perpx=-(p1y-p2y);
		perpy=p1x-p2x;
		dist=Math.sqrt(perpx *perpx+perpy *perpy);
		perpx=perpx / dist *w;
		perpy=perpy / dist *w;
		result.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);
		for (var i=1;i < length-1;i++){
			p1x=points[(i-1)*5];
			p1y=points[(i-1)*5+1];
			p2x=points[(i)*5];
			p2y=points[(i)*5+1];
			p3x=points[(i+1)*5];
			p3y=points[(i+1)*5+1];
			perpx=-(p1y-p2y);
			perpy=p1x-p2x;
			dist=Math.sqrt(perpx *perpx+perpy *perpy);
			perpx=perpx / dist *w;
			perpy=perpy / dist *w;
			perp2x=-(p2y-p3y);
			perp2y=p2x-p3x;
			dist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);
			perp2x=perp2x / dist *w;
			perp2y=perp2y / dist *w;
			a1=(-perpy+p1y)-(-perpy+p2y);
			b1=(-perpx+p2x)-(-perpx+p1x);
			c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);
			a2=(-perp2y+p3y)-(-perp2y+p2y);
			b2=(-perp2x+p2x)-(-perp2x+p3x);
			c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);
			denom=a1 *b2-a2 *b1;
			if (Math.abs(denom)< 0.1){
				denom+=10.1;
				result.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);
				continue ;
			}
			px=(b1 *c2-b2 *c1)/ denom;
			py=(a2 *c1-a1 *c2)/ denom;
			pdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);
			result.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);
		}
		p1x=points[points.length-10];
		p1y=points[points.length-9];
		p2x=points[points.length-5];
		p2y=points[points.length-4];
		perpx=-(p1y-p2y);
		perpy=p1x-p2x;
		dist=Math.sqrt(perpx *perpx+perpy *perpy);
		perpx=perpx / dist *w;
		perpy=perpy / dist *w;
		result.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);
		var groupLen=this.edges+1;
		for (i=1;i < groupLen;i++){
			indices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);
		}
		return result;
	}

	//闭合路径
	__proto.createLoopLine=function(p,indices,lineWidth,len,outVertex,outIndex){
		var points=p.concat();
		var result=outVertex ? outVertex :p;
		var color=this.borderColor;
		var r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;
		points.splice(0,5);
		var firstPoint=[points[0],points[1]];
		var lastPoint=[points[points.length-5],points[points.length-4]];
		var midPointX=lastPoint[0]+(firstPoint[0]-lastPoint[0])*0.5;
		var midPointY=lastPoint[1]+(firstPoint[1]-lastPoint[1])*0.5;
		points.unshift(midPointX,midPointY,0,0,0);
		points.push(midPointX,midPointY,0,0,0);
		var length=points.length / 5;
		var iStart=len,w=lineWidth / 2;
		var px,py,p1x,p1y,p2x,p2y,p3x,p3y;
		var perpx,perpy,perp2x,perp2y,perp3x,perp3y;
		var a1,b1,c1,a2,b2,c2;
		var denom,pdist,dist;
		p1x=points[0];
		p1y=points[1];
		p2x=points[5];
		p2y=points[6];
		perpx=-(p1y-p2y);
		perpy=p1x-p2x;
		dist=Math.sqrt(perpx *perpx+perpy *perpy);
		perpx=perpx / dist *w;
		perpy=perpy / dist *w;
		result.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);
		for (var i=1;i < length-1;i++){
			p1x=points[(i-1)*5];
			p1y=points[(i-1)*5+1];
			p2x=points[(i)*5];
			p2y=points[(i)*5+1];
			p3x=points[(i+1)*5];
			p3y=points[(i+1)*5+1];
			perpx=-(p1y-p2y);
			perpy=p1x-p2x;
			dist=Math.sqrt(perpx *perpx+perpy *perpy);
			perpx=perpx / dist *w;
			perpy=perpy / dist *w;
			perp2x=-(p2y-p3y);
			perp2y=p2x-p3x;
			dist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);
			perp2x=perp2x / dist *w;
			perp2y=perp2y / dist *w;
			a1=(-perpy+p1y)-(-perpy+p2y);
			b1=(-perpx+p2x)-(-perpx+p1x);
			c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);
			a2=(-perp2y+p3y)-(-perp2y+p2y);
			b2=(-perp2x+p2x)-(-perp2x+p3x);
			c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);
			denom=a1 *b2-a2 *b1;
			if (Math.abs(denom)< 0.1){
				denom+=10.1;
				result.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);
				continue ;
			}
			px=(b1 *c2-b2 *c1)/ denom;
			py=(a2 *c1-a1 *c2)/ denom;
			pdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);
			result.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);
		}
		if (outIndex){
			indices=outIndex;
		};
		var groupLen=this.edges+1;
		for (i=1;i < groupLen;i++){
			indices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);
		}
		indices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+1,iStart+1,iStart,iStart+(i-1)*2);
		return result;
	}

	return BasePoly;
})()


//class laya.webgl.shapes.Earcut
var Earcut=(function(){
	function Earcut(){}
	__class(Earcut,'laya.webgl.shapes.Earcut');
	Earcut.earcut=function(data,holeIndices,dim){
		dim=dim || 2;
		var hasHoles=holeIndices && holeIndices.length,
		outerLen=hasHoles ? holeIndices[0] *dim :data.length,
		outerNode=Earcut.linkedList(data,0,outerLen,dim,true),
		triangles=[];
		if (!outerNode)return triangles;
		var minX,minY,maxX,maxY,x,y,invSize;
		if (hasHoles)outerNode=Earcut.eliminateHoles(data,holeIndices,outerNode,dim);
		if (data.length > 80 *dim){
			minX=maxX=data[0];
			minY=maxY=data[1];
			for (var i=dim;i < outerLen;i+=dim){
				x=data[i];
				y=data[i+1];
				if (x < minX)minX=x;
				if (y < minY)minY=y;
				if (x > maxX)maxX=x;
				if (y > maxY)maxY=y;
			}
			invSize=Math.max(maxX-minX,maxY-minY);
			invSize=invSize!==0 ? 1 / invSize :0;
		}
		Earcut.earcutLinked(outerNode,triangles,dim,minX,minY,invSize);
		return triangles;
	}

	Earcut.linkedList=function(data,start,end,dim,clockwise){
		var i,last;
		if (clockwise===(Earcut.signedArea(data,start,end,dim)> 0)){
			for (i=start;i < end;i+=dim)last=Earcut.insertNode(i,data[i],data[i+1],last);
			}else {
			for (i=end-dim;i >=start;i-=dim)last=Earcut.insertNode(i,data[i],data[i+1],last);
		}
		if (last && Earcut.equals(last,last.next)){
			Earcut.removeNode(last);
			last=last.next;
		}
		return last;
	}

	Earcut.filterPoints=function(start,end){
		if (!start)return start;
		if (!end)end=start;
		var p=start,
		again;
		do {
			again=false;
			if (!p.steiner && (Earcut.equals(p,p.next)|| Earcut.area(p.prev,p,p.next)===0)){
				Earcut.removeNode(p);
				p=end=p.prev;
				if (p===p.next)break ;
				again=true;
				}else {
				p=p.next;
			}
		}while (again || p!==end);
		return end;
	}

	Earcut.earcutLinked=function(ear,triangles,dim,minX,minY,invSize,pass){
		if (!ear)return;
		if (!pass && invSize)Earcut.indexCurve(ear,minX,minY,invSize);
		var stop=ear,
		prev,next;
		while (ear.prev!==ear.next){
			prev=ear.prev;
			next=ear.next;
			if (invSize ? Earcut.isEarHashed(ear,minX,minY,invSize):Earcut.isEar(ear)){
				triangles.push(prev.i / dim);
				triangles.push(ear.i / dim);
				triangles.push(next.i / dim);
				Earcut.removeNode(ear);
				ear=next.next;
				stop=next.next;
				continue ;
			}
			ear=next;
			if (ear===stop){
				if (!pass){
					Earcut.earcutLinked(Earcut.filterPoints(ear,null),triangles,dim,minX,minY,invSize,1);
					}else if (pass===1){
					ear=Earcut.cureLocalIntersections(ear,triangles,dim);
					Earcut.earcutLinked(ear,triangles,dim,minX,minY,invSize,2);
					}else if (pass===2){
					Earcut.splitEarcut(ear,triangles,dim,minX,minY,invSize);
				}
				break ;
			}
		}
	}

	Earcut.isEar=function(ear){
		var a=ear.prev,
		b=ear,
		c=ear.next;
		if (Earcut.area(a,b,c)>=0)return false;
		var p=ear.next.next;
		while (p!==ear.prev){
			if (Earcut.pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&
				Earcut.area(p.prev,p,p.next)>=0)return false;
			p=p.next;
		}
		return true;
	}

	Earcut.isEarHashed=function(ear,minX,minY,invSize){
		var a=ear.prev,
		b=ear,
		c=ear.next;
		if (Earcut.area(a,b,c)>=0)return false;
		var minTX=a.x < b.x ? (a.x < c.x ? a.x :c.x):(b.x < c.x ? b.x :c.x),
		minTY=a.y < b.y ? (a.y < c.y ? a.y :c.y):(b.y < c.y ? b.y :c.y),
		maxTX=a.x > b.x ? (a.x > c.x ? a.x :c.x):(b.x > c.x ? b.x :c.x),
		maxTY=a.y > b.y ? (a.y > c.y ? a.y :c.y):(b.y > c.y ? b.y :c.y);
		var minZ=Earcut.zOrder(minTX,minTY,minX,minY,invSize),
		maxZ=Earcut.zOrder(maxTX,maxTY,minX,minY,invSize);
		var p=ear.nextZ;
		while (p && p.z <=maxZ){
			if (p!==ear.prev && p!==ear.next &&
				Earcut.pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&
			Earcut.area(p.prev,p,p.next)>=0)return false;
			p=p.nextZ;
		}
		p=ear.prevZ;
		while (p && p.z >=minZ){
			if (p!==ear.prev && p!==ear.next &&
				Earcut.pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&
			Earcut.area(p.prev,p,p.next)>=0)return false;
			p=p.prevZ;
		}
		return true;
	}

	Earcut.cureLocalIntersections=function(start,triangles,dim){
		var p=start;
		do {
			var a=p.prev,
			b=p.next.next;
			if (!Earcut.equals(a,b)&& Earcut.intersects(a,p,p.next,b)&& Earcut.locallyInside(a,b)&& Earcut.locallyInside(b,a)){
				triangles.push(a.i / dim);
				triangles.push(p.i / dim);
				triangles.push(b.i / dim);
				Earcut.removeNode(p);
				Earcut.removeNode(p.next);
				p=start=b;
			}
			p=p.next;
		}while (p!==start);
		return p;
	}

	Earcut.splitEarcut=function(start,triangles,dim,minX,minY,invSize){
		var a=start;
		do {
			var b=a.next.next;
			while (b!==a.prev){
				if (a.i!==b.i && Earcut.isValidDiagonal(a,b)){
					var c=Earcut.splitPolygon(a,b);
					a=Earcut.filterPoints(a,a.next);
					c=Earcut.filterPoints(c,c.next);
					Earcut.earcutLinked(a,triangles,dim,minX,minY,invSize);
					Earcut.earcutLinked(c,triangles,dim,minX,minY,invSize);
					return;
				}
				b=b.next;
			}
			a=a.next;
		}while (a!==start);
	}

	Earcut.eliminateHoles=function(data,holeIndices,outerNode,dim){
		var queue=[],
		i,len,start,end,list;
		for (i=0,len=holeIndices.length;i < len;i++){
			start=holeIndices[i] *dim;
			end=i < len-1 ? holeIndices[i+1] *dim :data.length;
			list=Earcut.linkedList(data,start,end,dim,false);
			if (list===list.next)list.steiner=true;
			queue.push(Earcut.getLeftmost(list));
		}
		queue.sort(Earcut.compareX);
		for (i=0;i < queue.length;i++){
			Earcut.eliminateHole(queue[i],outerNode);
			outerNode=Earcut.filterPoints(outerNode,outerNode.next);
		}
		return outerNode;
	}

	Earcut.compareX=function(a,b){
		return a.x-b.x;
	}

	Earcut.eliminateHole=function(hole,outerNode){
		outerNode=Earcut.findHoleBridge(hole,outerNode);
		if (outerNode){
			var b=Earcut.splitPolygon(outerNode,hole);
			Earcut.filterPoints(b,b.next);
		}
	}

	Earcut.findHoleBridge=function(hole,outerNode){
		var p=outerNode,
		hx=hole.x,
		hy=hole.y,
		qx=-Infinity,
		m;
		do {
			if (hy <=p.y && hy >=p.next.y && p.next.y!==p.y){
				var x=p.x+(hy-p.y)*(p.next.x-p.x)/ (p.next.y-p.y);
				if (x <=hx && x > qx){
					qx=x;
					if (x===hx){
						if (hy===p.y)return p;
						if (hy===p.next.y)return p.next;
					}
					m=p.x < p.next.x ? p :p.next;
				}
			}
			p=p.next;
		}while (p!==outerNode);
		if (!m)return null;
		if (hx===qx)return m.prev;
		var stop=m,
		mx=m.x,
		my=m.y,
		tanMin=Infinity,
		tan;
		p=m.next;
		while (p!==stop){
			if (hx >=p.x && p.x >=mx && hx!==p.x &&
				Earcut.pointInTriangle(hy < my ? hx :qx,hy,mx,my,hy < my ? qx :hx,hy,p.x,p.y)){
				tan=Math.abs(hy-p.y)/ (hx-p.x);
				if ((tan < tanMin || (tan===tanMin && p.x > m.x))&& Earcut.locallyInside(p,hole)){
					m=p;
					tanMin=tan;
				}
			}
			p=p.next;
		}
		return m;
	}

	Earcut.indexCurve=function(start,minX,minY,invSize){
		var p=start;
		do {
			if (p.z===null)p.z=Earcut.zOrder(p.x,p.y,minX,minY,invSize);
			p.prevZ=p.prev;
			p.nextZ=p.next;
			p=p.next;
		}while (p!==start);
		p.prevZ.nextZ=null;
		p.prevZ=null;
		Earcut.sortLinked(p);
	}

	Earcut.sortLinked=function(list){
		var i,p,q,e,tail,numMerges,pSize,qSize,
		inSize=1;
		do {
			p=list;
			list=null;
			tail=null;
			numMerges=0;
			while (p){
				numMerges++;
				q=p;
				pSize=0;
				for (i=0;i < inSize;i++){
					pSize++;
					q=q.nextZ;
					if (!q)break ;
				}
				qSize=inSize;
				while (pSize > 0 || (qSize > 0 && q)){
					if (pSize!==0 && (qSize===0 || !q || p.z <=q.z)){
						e=p;
						p=p.nextZ;
						pSize--;
						}else {
						e=q;
						q=q.nextZ;
						qSize--;
					}
					if (tail)tail.nextZ=e;
					else list=e;
					e.prevZ=tail;
					tail=e;
				}
				p=q;
			}
			tail.nextZ=null;
			inSize *=2;
		}while (numMerges > 1);
		return list;
	}

	Earcut.zOrder=function(x,y,minX,minY,invSize){
		x=32767 *(x-minX)*invSize;
		y=32767 *(y-minY)*invSize;
		x=(x | (x << 8))& 0x00FF00FF;
		x=(x | (x << 4))& 0x0F0F0F0F;
		x=(x | (x << 2))& 0x33333333;
		x=(x | (x << 1))& 0x55555555;
		y=(y | (y << 8))& 0x00FF00FF;
		y=(y | (y << 4))& 0x0F0F0F0F;
		y=(y | (y << 2))& 0x33333333;
		y=(y | (y << 1))& 0x55555555;
		return x | (y << 1);
	}

	Earcut.getLeftmost=function(start){
		var p=start,
		leftmost=start;
		do {
			if (p.x < leftmost.x)leftmost=p;
			p=p.next;
		}while (p!==start);
		return leftmost;
	}

	Earcut.pointInTriangle=function(ax,ay,bx,by,cx,cy,px,py){
		return (cx-px)*(ay-py)-(ax-px)*(cy-py)>=0 &&
		(ax-px)*(by-py)-(bx-px)*(ay-py)>=0 &&
		(bx-px)*(cy-py)-(cx-px)*(by-py)>=0;
	}

	Earcut.isValidDiagonal=function(a,b){
		return a.next.i!==b.i && a.prev.i!==b.i && !Earcut.intersectsPolygon(a,b)&&
		Earcut.locallyInside(a,b)&& Earcut.locallyInside(b,a)&& Earcut.middleInside(a,b);
	}

	Earcut.area=function(p,q,r){
		return (q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y);
	}

	Earcut.equals=function(p1,p2){
		return p1.x===p2.x && p1.y===p2.y;
	}

	Earcut.intersects=function(p1,q1,p2,q2){
		if ((Earcut.equals(p1,q1)&& Earcut.equals(p2,q2))||
			(Earcut.equals(p1,q2)&& Earcut.equals(p2,q1)))return true;
		return Earcut.area(p1,q1,p2)> 0!==Earcut.area(p1,q1,q2)> 0 &&
		Earcut.area(p2,q2,p1)> 0!==Earcut.area(p2,q2,q1)> 0;
	}

	Earcut.intersectsPolygon=function(a,b){
		var p=a;
		do {
			if (p.i!==a.i && p.next.i!==a.i && p.i!==b.i && p.next.i!==b.i &&
				Earcut.intersects(p,p.next,a,b))return true;
			p=p.next;
		}while (p!==a);
		return false;
	}

	Earcut.locallyInside=function(a,b){
		return Earcut.area(a.prev,a,a.next)< 0 ?
		Earcut.area(a,b,a.next)>=0 && Earcut.area(a,a.prev,b)>=0 :
		Earcut.area(a,b,a.prev)< 0 || Earcut.area(a,a.next,b)< 0;
	}

	Earcut.middleInside=function(a,b){
		var p=a,
		inside=false,
		px=(a.x+b.x)/ 2,
		py=(a.y+b.y)/ 2;
		do {
			if (((p.y > py)!==(p.next.y > py))&& p.next.y!==p.y &&
				(px < (p.next.x-p.x)*(py-p.y)/ (p.next.y-p.y)+p.x))
			inside=!inside;
			p=p.next;
		}while (p!==a);
		return inside;
	}

	Earcut.splitPolygon=function(a,b){
		var a2=new EarcutNode(a.i,a.x,a.y),
		b2=new EarcutNode(b.i,b.x,b.y),
		an=a.next,
		bp=b.prev;
		a.next=b;
		b.prev=a;
		a2.next=an;
		an.prev=a2;
		b2.next=a2;
		a2.prev=b2;
		bp.next=b2;
		b2.prev=bp;
		return b2;
	}

	Earcut.insertNode=function(i,x,y,last){
		var p=new EarcutNode(i,x,y);
		if (!last){
			p.prev=p;
			p.next=p;
			}else {
			p.next=last.next;
			p.prev=last;
			last.next.prev=p;
			last.next=p;
		}
		return p;
	}

	Earcut.removeNode=function(p){
		p.next.prev=p.prev;
		p.prev.next=p.next;
		if (p.prevZ)p.prevZ.nextZ=p.nextZ;
		if (p.nextZ)p.nextZ.prevZ=p.prevZ;
	}

	Earcut.signedArea=function(data,start,end,dim){
		var sum=0;
		for (var i=start,j=end-dim;i < end;i+=dim){
			sum+=(data[j]-data[i])*(data[i+1]+data[j+1]);
			j=i;
		}
		return sum;
	}

	return Earcut;
})()


//class laya.webgl.shapes.EarcutNode
var EarcutNode=(function(){
	function EarcutNode(i,x,y){
		this.i=null;
		this.x=null;
		this.y=null;
		this.prev=null;
		this.next=null;
		this.z=null;
		this.prevZ=null;
		this.nextZ=null;
		this.steiner=null;
		this.i=i;
		this.x=x;
		this.y=y;
		this.prev=null;
		this.next=null;
		this.z=null;
		this.prevZ=null;
		this.nextZ=null;
		this.steiner=false;
	}

	__class(EarcutNode,'laya.webgl.shapes.EarcutNode');
	return EarcutNode;
})()


//class laya.webgl.submit.Submit
var Submit=(function(){
	function Submit(renderType){
		//this._selfVb=null;
		//this._ib=null;
		//this._blendFn=null;
		//this._renderType=0;
		//this._vb=null;
		// 从VB中什么地方开始画，画到哪
		//this._startIdx=0;
		//this._numEle=0;
		//this.shaderValue=null;
		(renderType===void 0)&& (renderType=10000);
		this._renderType=renderType;
	}

	__class(Submit,'laya.webgl.submit.Submit');
	var __proto=Submit.prototype;
	Laya.imps(__proto,{"laya.webgl.submit.ISubmit":true})
	__proto.releaseRender=function(){
		var cache=Submit._cache;
		cache[cache._length++]=this;
		this.shaderValue.release();
		this._vb=null;
	}

	__proto.getRenderType=function(){
		return this._renderType;
	}

	__proto.renderSubmit=function(){
		if (this._numEle===0)return 1;
		var _tex=this.shaderValue.textureHost;
		if (_tex){
			var source=_tex.source;
			if (!_tex.bitmap || !source)
				return 1;
			this.shaderValue.texture=source;
		}
		this._vb.bind_upload(this._ib);
		var gl=WebGL.mainContext;
		this.shaderValue.upload();
		if (BlendMode.activeBlendFunction!==this._blendFn){
			gl.enable(0x0BE2);
			this._blendFn(gl);
			BlendMode.activeBlendFunction=this._blendFn;
		}
		Stat.drawCall++;
		Stat.trianglesFaces+=this._numEle / 3;
		gl.drawElements(0x0004,this._numEle,0x1403,this._startIdx);
		return 1;
	}

	Submit.__init__=function(){
		var s=Submit.RENDERBASE=new Submit(-1);
		s.shaderValue=new Value2D(0,0);
		s.shaderValue.ALPHA=-1234;
	}

	Submit.createSubmit=function(context,ib,vb,pos,sv){
		var o=Submit._cache._length ? Submit._cache[--Submit._cache._length] :new Submit();
		if (vb==null){
			vb=o._selfVb || (o._selfVb=VertexBuffer2D.create(-1));
			vb.clear();
			pos=0;
		}
		o._ib=ib;
		o._vb=vb;
		o._startIdx=pos *CONST3D2D.BYTES_PIDX;
		o._numEle=0;
		var blendType=context._nBlendType;
		o._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];
		o.shaderValue=sv;
		o.shaderValue.setValue(context._shader2D);
		var filters=context._shader2D.filters;
		filters && o.shaderValue.setFilters(filters);
		return o;
	}

	Submit.createShape=function(ctx,ib,vb,numEle,offset,sv){
		var o=(!Submit._cache._length)? (new Submit()):Submit._cache[--Submit._cache._length];
		o._ib=ib;
		o._vb=vb;
		o._numEle=numEle;
		o._startIdx=offset;
		o.shaderValue=sv;
		o.shaderValue.setValue(ctx._shader2D);
		var blendType=ctx._nBlendType;
		o._blendFn=ctx._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];
		return o;
	}

	Submit.TYPE_2D=10000;
	Submit.TYPE_CANVAS=10003;
	Submit.TYPE_CMDSETRT=10004;
	Submit.TYPE_CUSTOM=10005;
	Submit.TYPE_BLURRT=10006;
	Submit.TYPE_CMDDESTORYPRERT=10007;
	Submit.TYPE_DISABLESTENCIL=10008;
	Submit.TYPE_OTHERIBVB=10009;
	Submit.TYPE_PRIMITIVE=10010;
	Submit.TYPE_RT=10011;
	Submit.TYPE_BLUR_RT=10012;
	Submit.TYPE_TARGET=10013;
	Submit.TYPE_CHANGE_VALUE=10014;
	Submit.TYPE_SHAPE=10015;
	Submit.TYPE_TEXTURE=10016;
	Submit.TYPE_FILLTEXTURE=10017;
	Submit.RENDERBASE=null;
	Submit._cache=(Submit._cache=[],Submit._cache._length=0,Submit._cache);
	return Submit;
})()


//class laya.webgl.submit.SubmitCMD
var SubmitCMD=(function(){
	function SubmitCMD(){
		this.fun=null;
		this.args=null;
	}

	__class(SubmitCMD,'laya.webgl.submit.SubmitCMD');
	var __proto=SubmitCMD.prototype;
	Laya.imps(__proto,{"laya.webgl.submit.ISubmit":true})
	__proto.renderSubmit=function(){
		this.fun.apply(null,this.args);
		return 1;
	}

	__proto.getRenderType=function(){
		return 0;
	}

	__proto.releaseRender=function(){
		var cache=SubmitCMD._cache;
		cache[cache._length++]=this;
	}

	SubmitCMD.create=function(args,fun){
		var o=SubmitCMD._cache._length?SubmitCMD._cache[--SubmitCMD._cache._length]:new SubmitCMD();
		o.fun=fun;
		o.args=args;
		return o;
	}

	SubmitCMD._cache=(SubmitCMD._cache=[],SubmitCMD._cache._length=0,SubmitCMD._cache);
	return SubmitCMD;
})()


//class laya.webgl.submit.SubmitCMDScope
var SubmitCMDScope=(function(){
	function SubmitCMDScope(){
		this.variables={};
	}

	__class(SubmitCMDScope,'laya.webgl.submit.SubmitCMDScope');
	var __proto=SubmitCMDScope.prototype;
	__proto.getValue=function(name){
		return this.variables[name];
	}

	__proto.addValue=function(name,value){
		return this.variables[name]=value;
	}

	__proto.setValue=function(name,value){
		if(this.variables.hasOwnProperty(name)){
			return this.variables[name]=value;
		}
		return null;
	}

	__proto.clear=function(){
		for(var key in this.variables){
			delete this.variables[key];
		}
	}

	__proto.recycle=function(){
		this.clear();
		SubmitCMDScope.POOL.push(this);
	}

	SubmitCMDScope.create=function(){
		var scope=SubmitCMDScope.POOL.pop();
		scope||(scope=new SubmitCMDScope());
		return scope;
	}

	SubmitCMDScope.POOL=[];
	return SubmitCMDScope;
})()


//class laya.webgl.submit.SubmitOtherIBVB
var SubmitOtherIBVB=(function(){
	function SubmitOtherIBVB(){
		this.offset=0;
		//this._vb=null;
		//this._ib=null;
		//this._blendFn=null;
		//this._mat=null;
		//this._shader=null;
		//this._shaderValue=null;
		//this._numEle=0;
		this.startIndex=0;
		;
		this._mat=Matrix.create();
	}

	__class(SubmitOtherIBVB,'laya.webgl.submit.SubmitOtherIBVB');
	var __proto=SubmitOtherIBVB.prototype;
	Laya.imps(__proto,{"laya.webgl.submit.ISubmit":true})
	__proto.releaseRender=function(){
		var cache=SubmitOtherIBVB._cache;
		cache[cache._length++]=this;
	}

	__proto.getRenderType=function(){
		return 10009;
	}

	__proto.renderSubmit=function(){
		var _tex=this._shaderValue.textureHost;
		if (_tex){
			var source=_tex.source;
			if (!_tex.bitmap || !source)
				return 1;
			this._shaderValue.texture=source;
		}
		this._vb.bind_upload(this._ib);
		var w=RenderState2D.worldMatrix4;
		var wmat=Matrix.TEMP;
		Matrix.mulPre(this._mat,w[0],w[1],w[4],w[5],w[12],w[13],wmat);
		var tmp=RenderState2D.worldMatrix4=SubmitOtherIBVB.tempMatrix4;
		tmp[0]=wmat.a;
		tmp[1]=wmat.b;
		tmp[4]=wmat.c;
		tmp[5]=wmat.d;
		tmp[12]=wmat.tx;
		tmp[13]=wmat.ty;
		this._shader._offset=this.offset;
		this._shaderValue.refresh();
		this._shader.upload(this._shaderValue);
		this._shader._offset=0;
		var gl=WebGL.mainContext;
		if (BlendMode.activeBlendFunction!==this._blendFn){
			gl.enable(0x0BE2);
			this._blendFn(gl);
			BlendMode.activeBlendFunction=this._blendFn;
		}
		Stat.drawCall++;
		Stat.trianglesFaces+=this._numEle / 3;
		gl.drawElements(0x0004,this._numEle,0x1403,this.startIndex);
		RenderState2D.worldMatrix4=w;
		BaseShader.activeShader=null;
		return 1;
	}

	SubmitOtherIBVB.create=function(context,vb,ib,numElement,shader,shaderValue,startIndex,offset,type){
		(type===void 0)&& (type=0);
		var o=(!SubmitOtherIBVB._cache._length)? (new SubmitOtherIBVB()):SubmitOtherIBVB._cache[--SubmitOtherIBVB._cache._length];
		o._ib=ib;
		o._vb=vb;
		o._numEle=numElement;
		o._shader=shader;
		o._shaderValue=shaderValue;
		var blendType=context._nBlendType;
		o._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];
		switch(type){
			case 0:
				o.offset=0;
				o.startIndex=offset / (CONST3D2D.BYTES_PE *vb.vertexStride)*1.5;
				o.startIndex *=CONST3D2D.BYTES_PIDX;
				break ;
			case 1:
				o.startIndex=startIndex;
				o.offset=offset;
				break ;
			}
		return o;
	}

	SubmitOtherIBVB._cache=(SubmitOtherIBVB._cache=[],SubmitOtherIBVB._cache._length=0,SubmitOtherIBVB._cache);
	SubmitOtherIBVB.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,];
	return SubmitOtherIBVB;
})()


//class laya.webgl.submit.SubmitScissor
var SubmitScissor=(function(){
	function SubmitScissor(){
		this.submitIndex=0;
		this.submitLength=0;
		this.context=null;
		this.clipRect=new Rectangle();
		this.screenRect=new Rectangle();
	}

	__class(SubmitScissor,'laya.webgl.submit.SubmitScissor');
	var __proto=SubmitScissor.prototype;
	Laya.imps(__proto,{"laya.webgl.submit.ISubmit":true})
	__proto._scissor=function(x,y,w,h){
		var m=RenderState2D.worldMatrix4;
		var a=m[0],d=m[5],tx=m[12],ty=m[13];
		x=x *a+tx;
		y=y *d+ty;
		w *=a;
		h *=d;
		if (w < 1 || h < 1){
			return false;
		};
		var r=x+w;
		var b=y+h;
		x < 0 && (x=0,w=r-x);
		y < 0 && (y=0,h=b-y);
		var screen=RenderState2D.worldClipRect;
		x=Math.max(x,screen.x);
		y=Math.max(y,screen.y);
		w=Math.min(r,screen.right)-x;
		h=Math.min(b,screen.bottom)-y;
		if (w < 1 || h < 1){
			return false;
		};
		var worldScissorTest=RenderState2D.worldScissorTest;
		this.screenRect.copyFrom(screen);
		screen.x=x;
		screen.y=y;
		screen.width=w;
		screen.height=h;
		RenderState2D.worldScissorTest=true;
		y=RenderState2D.height-y-h;
		WebGL.mainContext.scissor(x,y,w,h);
		WebGL.mainContext.enable(0x0C11);
		this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength);
		if (worldScissorTest){
			y=RenderState2D.height-this.screenRect.y-this.screenRect.height;
			WebGL.mainContext.scissor(this.screenRect.x,y,this.screenRect.width,this.screenRect.height);
			WebGL.mainContext.enable(0x0C11);
		}
		else{
			WebGL.mainContext.disable(0x0C11);
			RenderState2D.worldScissorTest=false;
		}
		screen.copyFrom(this.screenRect);
		return true;
	}

	__proto._scissorWithTagart=function(x,y,w,h){
		if (w < 1 || h < 1){
			return false;
		};
		var r=x+w;
		var b=y+h;
		x < 0 && (x=0,w=r-x);
		y < 0 && (y=0,h=b-y);
		var screen=RenderState2D.worldClipRect;
		x=Math.max(x,screen.x);
		y=Math.max(y,screen.y);
		w=Math.min(r,screen.right)-x;
		h=Math.min(b,screen.bottom)-y;
		if (w < 1 || h < 1){
			return false;
		};
		var worldScissorTest=RenderState2D.worldScissorTest;
		this.screenRect.copyFrom(screen);
		RenderState2D.worldScissorTest=true;
		screen.x=x;
		screen.y=y;
		screen.width=w;
		screen.height=h;
		y=RenderState2D.height-y-h;
		WebGL.mainContext.scissor(x,y,w,h);
		WebGL.mainContext.enable(0x0C11);
		this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength);
		if (worldScissorTest){
			y=RenderState2D.height-this.screenRect.y-this.screenRect.height;
			WebGL.mainContext.scissor(this.screenRect.x,y,this.screenRect.width,this.screenRect.height);
			WebGL.mainContext.enable(0x0C11);
		}
		else{
			WebGL.mainContext.disable(0x0C11);
			RenderState2D.worldScissorTest=false;
		}
		screen.copyFrom(this.screenRect);
		return true;
	}

	__proto.renderSubmit=function(){
		this.submitLength=Math.min(this.context._submits._length-1,this.submitLength);
		if (this.submitLength < 1 || this.clipRect.width < 1 || this.clipRect.height < 1)
			return this.submitLength+1;
		if (this.context._targets)
			this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height);
		else this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height);
		return this.submitLength+1;
	}

	__proto.getRenderType=function(){
		return 0;
	}

	__proto.releaseRender=function(){
		var cache=SubmitScissor._cache;
		cache[cache._length++]=this;
		this.context=null;
	}

	SubmitScissor.create=function(context){
		var o=SubmitScissor._cache._length?SubmitScissor._cache[--SubmitScissor._cache._length]:new SubmitScissor();
		o.context=context;
		return o;
	}

	SubmitScissor._cache=(SubmitScissor._cache=[],SubmitScissor._cache._length=0,SubmitScissor._cache);
	return SubmitScissor;
})()


//class laya.webgl.submit.SubmitStencil
var SubmitStencil=(function(){
	function SubmitStencil(){
		this.step=0;
		this.blendMode=null;
		this.level=0;
	}

	__class(SubmitStencil,'laya.webgl.submit.SubmitStencil');
	var __proto=SubmitStencil.prototype;
	Laya.imps(__proto,{"laya.webgl.submit.ISubmit":true})
	__proto.renderSubmit=function(){
		switch(this.step){
			case 1:
				this.do1();
				break ;
			case 2:
				this.do2();
				break ;
			case 3:
				this.do3();
				break ;
			case 4:
				this.do4();
				break ;
			case 5:
				this.do5();
				break ;
			case 6:
				this.do6();
				break ;
			case 7:
				this.do7();
				break ;
			case 8:
				this.do8();
				break ;
			}
		return 1;
	}

	__proto.getRenderType=function(){
		return 0;
	}

	__proto.releaseRender=function(){
		var cache=SubmitStencil._cache;
		cache[cache._length++]=this;
	}

	__proto.do1=function(){
		var gl=WebGL.mainContext;
		gl.enable(0x0B90);
		gl.clear(0x00000400);
		gl.colorMask(false,false,false,false);
		gl.stencilFunc(0x0202,this.level,0xFF);
		gl.stencilOp(0x1E00,0x1E00,0x1E02);
	}

	//gl.stencilOp(WebGLContext.KEEP,WebGLContext.KEEP,WebGLContext.INVERT);//测试通过给模版缓冲 写入值 一开始是0 现在是 0xFF (模版缓冲中不知道是多少位的数据)
	__proto.do2=function(){
		var gl=WebGL.mainContext;
		gl.stencilFunc(0x0202,this.level+1,0xFF);
		gl.colorMask(true,true,true,true);
		gl.stencilOp(0x1E00,0x1E00,0x1E00);
	}

	__proto.do3=function(){
		var gl=WebGL.mainContext;
		gl.colorMask(true,true,true,true);
		gl.stencilOp(0x1E00,0x1E00,0x1E00);
		gl.clear(0x00000400);
		gl.disable(0x0B90);
	}

	__proto.do4=function(){
		var gl=WebGL.mainContext;
		if (this.level==0){
			gl.enable(0x0B90);
			gl.clear(0x00000400);
		}
		gl.colorMask(false,false,false,false);
		gl.stencilFunc(0x0207,0,0xFF);
		gl.stencilOp(0x1E00,0x1E00,0x1E02);
	}

	__proto.do5=function(){
		var gl=WebGL.mainContext;
		gl.stencilFunc(0x0202,this.level,0xFF);
		gl.colorMask(true,true,true,true);
		gl.stencilOp(0x1E00,0x1E00,0x1E00);
	}

	__proto.do6=function(){
		var gl=WebGL.mainContext;
		BlendMode.targetFns[BlendMode.TOINT[this.blendMode]](gl);
	}

	__proto.do7=function(){
		var gl=WebGL.mainContext;
		gl.colorMask(false,false,false,false);
		gl.stencilOp(0x1E00,0x1E00,0x1E03);
	}

	__proto.do8=function(){
		var gl=WebGL.mainContext;
		gl.colorMask(true,true,true,true);
		gl.stencilFunc(0x0202,this.level,0xFF);
		gl.stencilOp(0x1E00,0x1E00,0x1E00);
	}

	SubmitStencil.restore=function(context,clip,m,_x,_y){
		var submitStencil;
		context._renderKey=0;
		if (SubmitStencil._mask > 0){
			SubmitStencil._mask--;
		}
		if (SubmitStencil._mask==0){
			submitStencil=laya.webgl.submit.SubmitStencil.create(3);
			context.addRenderObject(submitStencil);
			context._curSubmit=Submit.RENDERBASE;
		}
		else{
			submitStencil=laya.webgl.submit.SubmitStencil.create(7);
			context.addRenderObject(submitStencil);
			var vb=context._vb;
			var nPos=(vb._byteLength >> 2);
			if (GlUtils.fillRectImgVb(vb,null,clip.x,clip.y,clip.width,clip.height,Texture.DEF_UV,m,_x,_y,0,0)){
				var shader=context._shader2D;
				shader.glTexture=null;
				var submit=context._curSubmit=Submit.createSubmit(context,context._ib,vb,((vb._byteLength-16 *4)/ 32)*3,Value2D.create(0x02,0));
				submit.shaderValue.ALPHA=1.0;
				context._submits[context._submits._length++]=submit;
				context._curSubmit._numEle+=6;
				context._curSubmit=Submit.RENDERBASE;
				}else {
				alert("clipRect calc stencil rect error");
			}
			submitStencil=laya.webgl.submit.SubmitStencil.create(8);
			context.addRenderObject(submitStencil);
		}
	}

	SubmitStencil.restore2=function(context,submit){
		var submitStencil;
		context._renderKey=0;
		if (SubmitStencil._mask > 0){
			SubmitStencil._mask--;
		}
		if (SubmitStencil._mask==0){
			submitStencil=laya.webgl.submit.SubmitStencil.create(3);
			context.addRenderObject(submitStencil);
			context._curSubmit=Submit.RENDERBASE;
		}
		else{
			submitStencil=laya.webgl.submit.SubmitStencil.create(7);
			context.addRenderObject(submitStencil);
			context._submits[context._submits._length++]=submit;
			submitStencil=laya.webgl.submit.SubmitStencil.create(8);
			context.addRenderObject(submitStencil);
		}
	}

	SubmitStencil.create=function(step){
		var o=SubmitStencil._cache._length?SubmitStencil._cache[--SubmitStencil._cache._length]:new SubmitStencil();
		o.step=step;
		if (step==5)
			++SubmitStencil._mask;
		o.level=SubmitStencil._mask;
		return o;
	}

	SubmitStencil._cache=(SubmitStencil._cache=[],SubmitStencil._cache._length=0,SubmitStencil._cache);
	SubmitStencil._mask=0;
	return SubmitStencil;
})()


//class laya.webgl.submit.SubmitTarget
var SubmitTarget=(function(){
	function SubmitTarget(){
		this._renderType=0;
		this._vb=null;
		this._ib=null;
		this._startIdx=0;
		this._numEle=0;
		this.shaderValue=null;
		this.blendType=0;
		this.proName=null;
		this.scope=null;
	}

	__class(SubmitTarget,'laya.webgl.submit.SubmitTarget');
	var __proto=SubmitTarget.prototype;
	Laya.imps(__proto,{"laya.webgl.submit.ISubmit":true})
	__proto.renderSubmit=function(){
		this._vb.bind_upload(this._ib);
		var target=this.scope.getValue(this.proName);
		if (target){
			this.shaderValue.texture=target.source;
			if (this.shaderValue["strength"] && !this.shaderValue["blurInfo"]){
				this.shaderValue["blurInfo"]=[target.width,target.height];
			}
			this.shaderValue.upload();
			this.blend();
			Stat.drawCall++;
			Stat.trianglesFaces+=this._numEle/3;
			WebGL.mainContext.drawElements(0x0004,this._numEle,0x1403,this._startIdx);
		}
		return 1;
	}

	__proto.blend=function(){
		if (BlendMode.activeBlendFunction!==BlendMode.fns[this.blendType]){
			var gl=WebGL.mainContext;
			gl.enable(0x0BE2);
			BlendMode.fns[this.blendType](gl);
			BlendMode.activeBlendFunction=BlendMode.fns[this.blendType];
		}
	}

	__proto.getRenderType=function(){
		return 0;
	}

	__proto.releaseRender=function(){
		var cache=SubmitTarget._cache;
		cache[cache._length++]=this;
	}

	SubmitTarget.create=function(context,ib,vb,pos,sv,proName){
		var o=SubmitTarget._cache._length?SubmitTarget._cache[--SubmitTarget._cache._length]:new SubmitTarget();
		o._ib=ib;
		o._vb=vb;
		o.proName=proName;
		o._startIdx=pos *CONST3D2D.BYTES_PIDX;
		o._numEle=0;
		o.blendType=context._nBlendType;
		o.shaderValue=sv;
		o.shaderValue.setValue(context._shader2D);
		return o;
	}

	SubmitTarget._cache=(SubmitTarget._cache=[],SubmitTarget._cache._length=0,SubmitTarget._cache);
	return SubmitTarget;
})()


/**
*...特殊的字符，如泰文，必须重新实现这个类
*/
//class laya.webgl.text.CharSegment
var CharSegment=(function(){
	function CharSegment(){
		this._sourceStr=null;
	}

	__class(CharSegment,'laya.webgl.text.CharSegment');
	var __proto=CharSegment.prototype;
	Laya.imps(__proto,{"laya.webgl.text.ICharSegment":true})
	__proto.textToSpit=function(str){
		this._sourceStr=str;
	}

	__proto.getChar=function(i){
		return this._sourceStr.charAt(i);
	}

	__proto.getCharCode=function(i){
		return this._sourceStr.charCodeAt(i);
	}

	__proto.length=function(){
		return this._sourceStr.length;
	}

	return CharSegment;
})()


//class laya.webgl.text.DrawText
var DrawText=(function(){
	var CharValue;
	function DrawText(){}
	__class(DrawText,'laya.webgl.text.DrawText');
	DrawText.__init__=function(){
		DrawText._charsTemp=new Array;
		DrawText._drawValue=new CharValue();
		DrawText._charSeg=new CharSegment();
	}

	DrawText.customCharSeg=function(charseg){
		DrawText._charSeg=charseg;
	}

	DrawText.getChar=function(char,id,drawValue){
		var result=WebGLCharImage.createOneChar(char,drawValue);
		if(id!=-1)
			DrawText._charsCache[id]=result;
		return result;
	}

	DrawText._drawSlow=function(save,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy,underLine){
		var drawValue=DrawText._drawValue.value(font,fillColor,borderColor,lineWidth,sx,sy,underLine);
		var i=0,n=0;
		var chars=DrawText._charsTemp;
		var width=0,oneChar,htmlWord,id=NaN;
		if (words){
			chars.length=words.length;
			for (i=0,n=words.length;i < n;i++){
				htmlWord=words[i];
				id=htmlWord.charNum+drawValue.txtID;
				chars[i]=oneChar=DrawText._charsCache[id] || DrawText.getChar(htmlWord.char,id,drawValue);
				oneChar.active();
			}
			}else {
			var text=((txt instanceof laya.utils.WordText ))? txt.toString():txt;
			if (Text.CharacterCache){
				DrawText._charSeg.textToSpit(text);
				var len=/*if err,please use iflash.method.xmlLength()*/DrawText._charSeg.length();
				chars.length=len;
				for (i=0,n=len;i < n;i++){
					id=DrawText._charSeg.getCharCode(i)+drawValue.txtID;
					chars[i]=oneChar=DrawText._charsCache[id] || DrawText.getChar(DrawText._charSeg.getChar(i),id,drawValue);
					oneChar.active();
					width+=oneChar.cw;
				}
			}
			else {
				chars.length=0;
				oneChar=DrawText.getChar(text,-1,drawValue);
				oneChar.active();
				width+=oneChar.cw;
				chars[0]=oneChar;
			}
		};
		var dx=0;
		if (textAlign!==null && textAlign!=="left")
			dx=-(textAlign=="center" ? (width / 2):width);
		var uv,bdSz=NaN,texture,value,saveLength=0;
		if (words){
			for (i=0,n=chars.length;i < n;i++){
				oneChar=chars[i];
				if (!oneChar.isSpace){
					htmlWord=words[i];
					bdSz=oneChar.borderSize;
					texture=oneChar.texture;
					ctx._drawText(texture,x+dx+htmlWord.x *sx-bdSz,y+htmlWord.y *sy-bdSz,texture.width,texture.height,curMat,0,0,0,0);
				}
			}
			}else {
			for (i=0,n=chars.length;i < n;i++){
				oneChar=chars[i];
				if (!oneChar.isSpace){
					bdSz=oneChar.borderSize;
					texture=oneChar.texture;
					ctx._drawText(texture,x+dx-bdSz,y-bdSz,texture.width,texture.height,curMat,0,0,0,0);
					save && (value=save[saveLength++],value || (value=save[saveLength-1]=[]),value[0]=texture,value[1]=dx-bdSz,value[2]=-bdSz);
				}
				dx+=oneChar.cw;
			}
			save && (save.length=saveLength);
		}
	}

	DrawText._drawFast=function(save,ctx,curMat,x,y){
		var texture,value;
		for (var i=0,n=save.length;i < n;i++){
			value=save[i];
			texture=value[0];
			texture.active();
			ctx._drawText(texture,x+value[1],y+value[2],texture.width,texture.height,curMat,0,0,0,0);
		}
	}

	DrawText.drawText=function(ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,underLine){
		(underLine===void 0)&& (underLine=0);
		if ((txt && txt.length===0)|| (words && words.length===0))
			return;
		var sx=curMat.a,sy=curMat.d;
		(curMat.b!==0 || curMat.c!==0)&& (sx=sy=1);
		var scale=sx!==1 || sy!==1;
		if (scale && Laya.stage.transform){
			var t=Laya.stage.transform;
			scale=t.a===sx && t.d===sy;
		}else scale=false;
		if (scale){
			curMat=curMat.copyTo(WebGLContext2D._tmpMatrix);
			var tempTx=curMat.tx;
			var tempTy=curMat.ty;
			curMat.scale(1 / sx,1 / sy);
			curMat._checkTransform();
			x *=sx;
			y *=sy;
			x+=tempTx-curMat.tx;
			y+=tempTy-curMat.ty;
		}else sx=sy=1;
		if (words){
			DrawText._drawSlow(null,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy,underLine);
			}else {
			if (txt.toUpperCase===null){
				var idNum=sx+sy *100000;
				var myCache=txt;
				if (!myCache.changed && myCache.id===idNum){
					DrawText._drawFast(myCache.save,ctx,curMat,x,y);
					}else {
					myCache.id=idNum;
					myCache.changed=false;
					DrawText._drawSlow(myCache.save,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy,underLine);
				}
				return;
			};
			var id=txt+font.toString()+fillColor+borderColor+lineWidth+sx+sy+textAlign;
			var cache=DrawText._textsCache[id];
			if (Text.CharacterCache){
				if (cache){
					DrawText._drawFast(cache,ctx,curMat,x,y);
					}else {
					DrawText._textsCache.__length || (DrawText._textsCache.__length=0);
					if (DrawText._textsCache.__length > Config.WebGLTextCacheCount){
						DrawText._textsCache={};
						DrawText._textsCache.__length=0;
						DrawText._curPoolIndex=0;
					}
					DrawText._textCachesPool[DrawText._curPoolIndex] ? (cache=DrawText._textsCache[id]=DrawText._textCachesPool[DrawText._curPoolIndex],cache.length=0):(DrawText._textCachesPool[DrawText._curPoolIndex]=cache=DrawText._textsCache[id]=[]);
					DrawText._textsCache.__length++
					DrawText._curPoolIndex++;
					DrawText._drawSlow(cache,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy,underLine);
				}
			}
			else{
				DrawText._drawSlow(cache,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy,underLine);
			}
		}
	}

	DrawText._charsTemp=null;
	DrawText._textCachesPool=[];
	DrawText._curPoolIndex=0;
	DrawText._charsCache={};
	DrawText._textsCache={};
	DrawText._drawValue=null;
	DrawText.d=[];
	DrawText._charSeg=null;
	DrawText.__init$=function(){
		//class CharValue
		CharValue=(function(){
			function CharValue(){
				//this.txtID=NaN;
				//this.font=null;
				//this.fillColor=null;
				//this.borderColor=null;
				//this.lineWidth=0;
				//this.scaleX=NaN;
				//this.scaleY=NaN;
				//this.underLine=0;
			}
			__class(CharValue,'');
			var __proto=CharValue.prototype;
			__proto.value=function(font,fillColor,borderColor,lineWidth,scaleX,scaleY,underLine){
				this.font=font;
				this.fillColor=fillColor;
				this.borderColor=borderColor;
				this.lineWidth=lineWidth;
				this.scaleX=scaleX;
				this.scaleY=scaleY;
				this.underLine=underLine;
				var key=font.toString()+scaleX+scaleY+lineWidth+fillColor+borderColor+underLine;
				this.txtID=CharValue._keymap[key];
				if (!this.txtID){
					this.txtID=(++CharValue._keymapCount)*0.0000001;
					CharValue._keymap[key]=this.txtID;
				}
				return this;
			}
			CharValue.clear=function(){
				CharValue._keymap={};
				CharValue._keymapCount=1;
			}
			CharValue._keymap={};
			CharValue._keymapCount=1;
			return CharValue;
		})()
	}

	return DrawText;
})()


//class laya.webgl.text.FontInContext
var FontInContext=(function(){
	function FontInContext(font){
		//this._text=null;
		//this._words=null;
		this._index=0;
		this._size=14;
		this._italic=-2;
		FontInContext._cache2=FontInContext._cache2|| [];
		this.setFont(font || "14px Arial");
	}

	__class(FontInContext,'laya.webgl.text.FontInContext');
	var __proto=FontInContext.prototype;
	__proto.setFont=function(value){
		var arr=FontInContext._cache2[value];
		if (!arr){
			this._words=value.split(' ');
			for (var i=0,n=this._words.length;i < n;i++){
				if (this._words[i].indexOf('px')> 0){
					this._index=i;
					break ;
				}
			}
			this._size=parseInt(this._words[this._index]);
			FontInContext._cache2[value]=[this._words,this._size];
			}else {
			this._words=arr[0];
			this._size=arr[1];
		}
		this._text=null;
		this._italic=-2;
	}

	__proto.getItalic=function(){
		this._italic===-2 && (this._italic=this.hasType("italic"));
		return this._italic;
	}

	__proto.hasType=function(name){
		for (var i=0,n=this._words.length;i < n;i++)
		if (this._words[i]===name)return i;
		return-1;
	}

	__proto.removeType=function(name){
		for (var i=0,n=this._words.length;i < n;i++)
		if (this._words[i]===name){
			this._words.splice(i,1);
			if (this._index > i)this._index--;
			break ;
		}
		this._text=null;
		this._italic=-2;
	}

	__proto.copyTo=function(dec){
		dec._text=this._text;
		dec._size=this._size;
		dec._index=this._index;
		dec._words=this._words.slice();
		dec._italic=-2;
		return dec;
	}

	__proto.toString=function(){
		return this._text ? this._text :(this._text=this._words.join(' '));
	}

	__getset(0,__proto,'size',function(){
		return this._size;
		},function(value){
		this._size=value;
		this._words[this._index]=value+"px";
		this._text=null;
	});

	FontInContext.create=function(font){
		var r=FontInContext._cache[font];
		if (r)return r;
		r=FontInContext._cache[font]=new FontInContext(font);
		return r;
	}

	FontInContext.EMPTY=new FontInContext();
	FontInContext._cache={};
	FontInContext._cache2=null;
	return FontInContext;
})()


//class laya.webgl.utils.CONST3D2D
var CONST3D2D=(function(){
	function CONST3D2D(){}
	__class(CONST3D2D,'laya.webgl.utils.CONST3D2D');
	CONST3D2D.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];
	CONST3D2D.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1];
	CONST3D2D.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0];
	CONST3D2D._TMPARRAY=[];
	CONST3D2D._OFFSETX=0;
	CONST3D2D._OFFSETY=0;
	__static(CONST3D2D,
	['BYTES_PE',function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT;},'BYTES_PIDX',function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT;}
	]);
	return CONST3D2D;
})()


//class laya.webgl.utils.GlUtils
var GlUtils=(function(){
	function GlUtils(){}
	__class(GlUtils,'laya.webgl.utils.GlUtils');
	GlUtils.make2DProjection=function(width,height,depth){
		return [2.0 / width,0,0,0,0,-2.0 / height,0,0,0,0,2.0 / depth,0,-1,1,0,1,];
	}

	GlUtils.fillIBQuadrangle=function(buffer,count){
		if (count > 65535 / 4){
			throw Error("IBQuadrangle count:"+count+" must<:"+Math.floor(65535 / 4));
			return false;
		}
		count=Math.floor(count);
		buffer._resizeBuffer((count+1)*6 *2,false);
		buffer.byteLength=buffer.bufferLength;
		var bufferData=buffer.getUint16Array();
		var idx=0;
		for (var i=0;i < count;i++){
			bufferData[idx++]=i *4;
			bufferData[idx++]=i *4+2;
			bufferData[idx++]=i *4+1;
			bufferData[idx++]=i *4;
			bufferData[idx++]=i *4+3;
			bufferData[idx++]=i *4+2;
		}
		buffer.setNeedUpload();
		return true;
	}

	GlUtils.expandIBQuadrangle=function(buffer,count){
		buffer.bufferLength >=(count *6 *2)|| GlUtils.fillIBQuadrangle(buffer,count);
	}

	GlUtils.mathCeilPowerOfTwo=function(value){
		value--;
		value |=value >> 1;
		value |=value >> 2;
		value |=value >> 4;
		value |=value >> 8;
		value |=value >> 16;
		value++;
		return value;
	}

	GlUtils.fillQuadrangleImgVb=function(vb,x,y,point4,uv,m,_x,_y){
		var vpos=(vb._byteLength >> 2)+16;
		vb.byteLength=(vpos << 2);
		var vbdata=vb.getFloat32Array();
		vpos-=16;
		vbdata[vpos+2]=uv[0];
		vbdata[vpos+3]=uv[1];
		vbdata[vpos+6]=uv[2];
		vbdata[vpos+7]=uv[3];
		vbdata[vpos+10]=uv[4];
		vbdata[vpos+11]=uv[5];
		vbdata[vpos+14]=uv[6];
		vbdata[vpos+15]=uv[7];
		var a=m.a,b=m.b,c=m.c,d=m.d;
		if (a!==1 || b!==0 || c!==0 || d!==1){
			m.bTransform=true;
			var tx=m.tx+_x,ty=m.ty+_y;
			vbdata[vpos]=(point4[0]+x)*a+(point4[1]+y)*c+tx;
			vbdata[vpos+1]=(point4[0]+x)*b+(point4[1]+y)*d+ty;
			vbdata[vpos+4]=(point4[2]+x)*a+(point4[3]+y)*c+tx;
			vbdata[vpos+5]=(point4[2]+x)*b+(point4[3]+y)*d+ty;
			vbdata[vpos+8]=(point4[4]+x)*a+(point4[5]+y)*c+tx;
			vbdata[vpos+9]=(point4[4]+x)*b+(point4[5]+y)*d+ty;
			vbdata[vpos+12]=(point4[6]+x)*a+(point4[7]+y)*c+tx;
			vbdata[vpos+13]=(point4[6]+x)*b+(point4[7]+y)*d+ty;
			}else {
			m.bTransform=false;
			x+=m.tx+_x;
			y+=m.ty+_y;
			vbdata[vpos]=x+point4[0];
			vbdata[vpos+1]=y+point4[1];
			vbdata[vpos+4]=x+point4[2];
			vbdata[vpos+5]=y+point4[3];
			vbdata[vpos+8]=x+point4[4];
			vbdata[vpos+9]=y+point4[5];
			vbdata[vpos+12]=x+point4[6];
			vbdata[vpos+13]=y+point4[7];
		}
		vb._upload=true;
		return true;
	}

	GlUtils.fillTranglesVB=function(vb,x,y,points,m,_x,_y){
		var vpos=(vb._byteLength >> 2)+points.length;
		vb.byteLength=(vpos << 2);
		var vbdata=vb.getFloat32Array();
		vpos-=points.length;
		var len=points.length;
		var a=m.a,b=m.b,c=m.c,d=m.d;
		for (var i=0;i < len;i+=4){
			vbdata[vpos+i+2]=points[i+2];
			vbdata[vpos+i+3]=points[i+3];
			if (a!==1 || b!==0 || c!==0 || d!==1){
				m.bTransform=true;
				var tx=m.tx+_x,ty=m.ty+_y;
				vbdata[vpos+i]=(points[i]+x)*a+(points[i+1]+y)*c+tx;
				vbdata[vpos+i+1]=(points[i]+x)*b+(points[i+1]+y)*d+ty;
				}else {
				m.bTransform=false;
				x+=m.tx+_x;
				y+=m.ty+_y;
				vbdata[vpos+i]=x+points[i];
				vbdata[vpos+i+1]=y+points[i+1];
			}
		}
		vb._upload=true;
		return true;
	}

	GlUtils.copyPreImgVb=function(vb,dx,dy){
		var vpos=(vb._byteLength >> 2);
		vb.byteLength=((vpos+16)<< 2);
		var vbdata=vb.getFloat32Array();
		for (var i=0,ci=vpos-16;i < 4;i++){
			vbdata[vpos]=vbdata[ci]+dx;
			++vpos;
			++ci;
			vbdata[vpos]=vbdata[ci]+dy;
			++vpos;
			++ci;
			vbdata[vpos]=vbdata[ci];
			++vpos;
			++ci;
			vbdata[vpos]=vbdata[ci];
			++vpos;
			++ci;
		}
		vb._upload=true;
	}

	GlUtils.fillRectImgVb=function(vb,clip,x,y,width,height,uv,m,_x,_y,dx,dy,round){
		(round===void 0)&& (round=false);
		var mType=1;
		var toBx,toBy,toEx,toEy;
		var cBx,cBy,cEx,cEy;
		var w0,h0,tx,ty;
		var finalX,finalY,offsetX,offsetY;
		var a=m.a,b=m.b,c=m.c,d=m.d;
		var useClip=clip && clip.width < 99999999;
		if (a!==1 || b!==0 || c!==0 || d!==1){
			m.bTransform=true;
			if (b===0 && c===0){
				mType=23;
				w0=width+x,h0=height+y;
				tx=m.tx+_x,ty=m.ty+_y;
				toBx=a *x+tx;
				toEx=a *w0+tx;
				toBy=d *y+ty;
				toEy=d *h0+ty;
			}
			}else {
			mType=23;
			m.bTransform=false;
			toBx=x+m.tx+_x;
			toEx=toBx+width;
			toBy=y+m.ty+_y;
			toEy=toBy+height;
		}
		if (useClip){
			cBx=clip.x,cBy=clip.y,cEx=clip.width+cBx,cEy=clip.height+cBy;
		}
		if (mType!==1){
			if (Math.min(toBx,toEx)>=cEx)return false;
			if (Math.min(toBy,toEy)>=cEy)return false;
			if (Math.max(toEx,toBx)<=cBx)return false;
			if (Math.max(toEy,toBy)<=cBy)return false;
		};
		var vpos=(vb._byteLength >> 2);
		vb.byteLength=((vpos+16)<< 2);
		var vbdata=vb.getFloat32Array();
		vbdata[vpos+2]=uv[0];
		vbdata[vpos+3]=uv[1];
		vbdata[vpos+6]=uv[2];
		vbdata[vpos+7]=uv[3];
		vbdata[vpos+10]=uv[4];
		vbdata[vpos+11]=uv[5];
		vbdata[vpos+14]=uv[6];
		vbdata[vpos+15]=uv[7];
		switch (mType){
			case 1:
				tx=m.tx+_x,ty=m.ty+_y;
				w0=width+x,h0=height+y;
				var w1=x,h1=y;
				var aw1=a *w1,ch1=c *h1,dh1=d *h1,bw1=b *w1;
				var aw0=a *w0,ch0=c *h0,dh0=d *h0,bw0=b *w0;
				if (round){
					finalX=aw1+ch1+tx;
					offsetX=Math.round(finalX)-finalX;
					finalY=dh1+bw1+ty;
					offsetY=Math.round(finalY)-finalY;
					vbdata[vpos]=finalX+offsetX;
					vbdata[vpos+1]=finalY+offsetY;
					vbdata[vpos+4]=aw0+ch1+tx+offsetX;
					vbdata[vpos+5]=dh1+bw0+ty+offsetY;
					vbdata[vpos+8]=aw0+ch0+tx+offsetX;
					vbdata[vpos+9]=dh0+bw0+ty+offsetY;
					vbdata[vpos+12]=aw1+ch0+tx+offsetX;
					vbdata[vpos+13]=dh0+bw1+ty+offsetY;
					}else {
					vbdata[vpos]=aw1+ch1+tx;
					vbdata[vpos+1]=dh1+bw1+ty;
					vbdata[vpos+4]=aw0+ch1+tx;
					vbdata[vpos+5]=dh1+bw0+ty;
					vbdata[vpos+8]=aw0+ch0+tx;
					vbdata[vpos+9]=dh0+bw0+ty;
					vbdata[vpos+12]=aw1+ch0+tx;
					vbdata[vpos+13]=dh0+bw1+ty;
				}
				break ;
			case 23:
				if (round){
					finalX=toBx+dx;
					offsetX=Math.round(finalX)-finalX;
					finalY=toBy;
					offsetY=Math.round(finalY)-finalY;
					vbdata[vpos]=finalX+offsetX;
					vbdata[vpos+1]=finalY+offsetY;
					vbdata[vpos+4]=toEx+dx+offsetX;
					vbdata[vpos+5]=toBy+offsetY;
					vbdata[vpos+8]=toEx+offsetX;
					vbdata[vpos+9]=toEy+offsetY;
					vbdata[vpos+12]=toBx+offsetX;
					vbdata[vpos+13]=toEy+offsetY;
					}else {
					vbdata[vpos]=toBx+dx;
					vbdata[vpos+1]=toBy;
					vbdata[vpos+4]=toEx+dx;
					vbdata[vpos+5]=toBy;
					vbdata[vpos+8]=toEx;
					vbdata[vpos+9]=toEy;
					vbdata[vpos+12]=toBx;
					vbdata[vpos+13]=toEy;
				}
				break ;
			}
		vb._upload=true;
		return true;
	}

	GlUtils.fillLineVb=function(vb,clip,fx,fy,tx,ty,width,mat){
		var linew=width *.5;
		var data=GlUtils._fillLineArray;
		var perpx=-(fy-ty),perpy=fx-tx;
		var dist=Math.sqrt(perpx *perpx+perpy *perpy);
		perpx /=dist,perpy /=dist,perpx *=linew,perpy *=linew;
		data[0]=fx-perpx,data[1]=fy-perpy,data[4]=fx+perpx,data[5]=fy+perpy,data[8]=tx+perpx,data[9]=ty+perpy,data[12]=tx-perpx,data[13]=ty-perpy;
		mat && mat.transformPointArray(data,data);
		var vpos=(vb._byteLength >> 2)+16;
		vb.byteLength=(vpos << 2);
		vb.insertData(data,vpos-16);
		return true;
	}

	GlUtils._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
	return GlUtils;
})()


//class laya.webgl.utils.MatirxArray
var MatirxArray=(function(){
	function MatirxArray(){}
	__class(MatirxArray,'laya.webgl.utils.MatirxArray');
	MatirxArray.ArrayMul=function(a,b,o){
		if (!a){
			MatirxArray.copyArray(b,o);
			return;
		}
		if (!b){
			MatirxArray.copyArray(a,o);
			return;
		};
		var ai0=NaN,ai1=NaN,ai2=NaN,ai3=NaN;
		for (var i=0;i < 4;i++){
			ai0=a[i];
			ai1=a[i+4];
			ai2=a[i+8];
			ai3=a[i+12];
			o[i]=ai0 *b[0]+ai1 *b[1]+ai2 *b[2]+ai3 *b[3];
			o[i+4]=ai0 *b[4]+ai1 *b[5]+ai2 *b[6]+ai3 *b[7];
			o[i+8]=ai0 *b[8]+ai1 *b[9]+ai2 *b[10]+ai3 *b[11];
			o[i+12]=ai0 *b[12]+ai1 *b[13]+ai2 *b[14]+ai3 *b[15];
		}
	}

	MatirxArray.copyArray=function(f,t){
		if (!f)return;
		if (!t)return;
		for (var i=0;i < f.length;i++){
			t[i]=f[i];
		}
	}

	return MatirxArray;
})()


/**
*Mesh2d只是保存数据。描述attribute用的。本身不具有渲染功能。
*/
//class laya.webgl.utils.Mesh2D
var Mesh2D=(function(){
	function Mesh2D(stride,vballoc,iballoc){
		this._stride=0;
		//顶点结构大小。每个mesh的顶点结构是固定的。
		this.vertNum=0;
		//当前的顶点的个数
		this.indexNum=0;
		//实际index 个数。例如一个三角形是3个。由于ib本身可能超过实际使用的数量，所以需要一个indexNum
		this._applied=false;
		//是否已经设置给webgl了
		this._vb=null;
		//vb和ib都可能需要在外部修改，所以public
		this._ib=null;
		this._vao=null;
		this._attribInfo=null;
		//保存起来的属性定义数组。
		this._quadNum=0;
		//public static var meshlist:Array=[];//活着的mesh对象列表。
		this.canReuse=false;
		this._stride=stride;
		this._vb=new VertexBuffer2D(stride,0x88E8);
		if (vballoc){
			this._vb._resizeBuffer(vballoc,false);
		}else{}
		this._ib=new IndexBuffer2D();
		if (iballoc){
			this._ib._resizeBuffer(iballoc,false);
		}
	}

	__class(Mesh2D,'laya.webgl.utils.Mesh2D');
	var __proto=Mesh2D.prototype;
	/**
	*重新创建一个mesh。复用这个对象的vertex结构，ib对象和attribinfo对象
	*/
	__proto.cloneWithNewVB=function(){
		var mesh=new Mesh2D(this._stride,0,0);
		mesh._ib=this._ib;
		mesh._quadNum=this._quadNum;
		mesh._attribInfo=this._attribInfo;
		return mesh;
	}

	/**
	*创建一个mesh，使用当前对象的vertex结构。vb和ib自己提供。
	*@return
	*/
	__proto.cloneWithNewVBIB=function(){
		var mesh=new Mesh2D(this._stride,0,0);
		mesh._attribInfo=this._attribInfo;
		return mesh;
	}

	/**
	*获得一个可以写的vb对象
	*/
	__proto.getVBW=function(){
		this._vb.setNeedUpload();
		return this._vb;
	}

	/**
	*获得一个只读vb
	*/
	__proto.getVBR=function(){
		return this._vb;
	}

	__proto.getIBR=function(){
		return this._ib;
	}

	/**
	*获得一个可写的ib
	*/
	__proto.getIBW=function(){
		this._ib.setNeedUpload();
		return this._ib;
	}

	/**
	*直接创建一个固定的ib。按照固定四边形的索引。
	*@param var QuadNum
	*/
	__proto.createQuadIB=function(QuadNum){
		this._quadNum=QuadNum;
		this._ib._resizeBuffer(QuadNum *6 *2,false);
		this._ib.byteLength=this._ib.bufferLength;
		var bd=this._ib.getUint16Array();
		var idx=0;
		var curvert=0;
		for (var i=0;i < QuadNum;i++){
			bd[idx++]=curvert;
			bd[idx++]=curvert+2;
			bd[idx++]=curvert+1;
			bd[idx++]=curvert;
			bd[idx++]=curvert+3;
			bd[idx++]=curvert+2;
			curvert+=4;
		}
		this._ib.setNeedUpload();
	}

	/**
	*设置mesh的属性。每3个一组，对应的location分别是0,1,2...
	*含义是：type,size,offset
	*不允许多流。因此stride是固定的，offset只是在一个vertex之内。
	*@param attribs
	*/
	__proto.setAttributes=function(attribs){
		this._attribInfo=attribs;
		if (this._attribInfo.length % 3 !=0){
			throw 'Mesh2D setAttributes error!';
		}
	}

	__proto.getEleNum=function(){
		return this._ib.getBuffer().byteLength / 2;
	}

	/**
	*子类实现。用来把自己放到对应的回收池中，以便复用。
	*/
	__proto.releaseMesh=function(){}
	/**
	*释放资源。
	*/
	__proto.destroy=function(){}
	/**
	*清理vb数据
	*/
	__proto.clearVB=function(){
		this._vb.clear();
	}

	Mesh2D._gvaoid=0;
	return Mesh2D;
})()


//class laya.webgl.utils.RenderState2D
var RenderState2D=(function(){
	function RenderState2D(){}
	__class(RenderState2D,'laya.webgl.utils.RenderState2D');
	RenderState2D.getMatrArray=function(){
		return [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];
	}

	RenderState2D.mat2MatArray=function(mat,matArray){
		var m=mat;
		var m4=matArray;
		m4[0]=m.a;
		m4[1]=m.b;
		m4[2]=RenderState2D.EMPTYMAT4_ARRAY[2];
		m4[3]=RenderState2D.EMPTYMAT4_ARRAY[3];
		m4[4]=m.c;
		m4[5]=m.d;
		m4[6]=RenderState2D.EMPTYMAT4_ARRAY[6];
		m4[7]=RenderState2D.EMPTYMAT4_ARRAY[7];
		m4[8]=RenderState2D.EMPTYMAT4_ARRAY[8];
		m4[9]=RenderState2D.EMPTYMAT4_ARRAY[9];
		m4[10]=RenderState2D.EMPTYMAT4_ARRAY[10];
		m4[11]=RenderState2D.EMPTYMAT4_ARRAY[11];
		m4[12]=m.tx;
		m4[13]=m.ty;
		m4[14]=RenderState2D.EMPTYMAT4_ARRAY[14];
		m4[15]=RenderState2D.EMPTYMAT4_ARRAY[15];
		return matArray;
	}

	RenderState2D.restoreTempArray=function(){
		RenderState2D.TEMPMAT4_ARRAY[0]=1;
		RenderState2D.TEMPMAT4_ARRAY[1]=0;
		RenderState2D.TEMPMAT4_ARRAY[4]=0;
		RenderState2D.TEMPMAT4_ARRAY[5]=1;
		RenderState2D.TEMPMAT4_ARRAY[12]=0;
		RenderState2D.TEMPMAT4_ARRAY[13]=0;
	}

	RenderState2D.clear=function(){
		RenderState2D.worldScissorTest=false;
		RenderState2D.worldShaderDefines=null;
		RenderState2D.worldFilters=null;
		RenderState2D.worldAlpha=1;
		RenderState2D.worldClipRect.x=RenderState2D.worldClipRect.y=0;
		RenderState2D.worldClipRect.width=RenderState2D.width;
		RenderState2D.worldClipRect.height=RenderState2D.height;
		RenderState2D.curRenderTarget=null;
	}

	RenderState2D._MAXSIZE=99999999;
	RenderState2D.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];
	RenderState2D.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];
	RenderState2D.worldMatrix4=RenderState2D.TEMPMAT4_ARRAY;
	RenderState2D.worldAlpha=1.0;
	RenderState2D.worldScissorTest=false;
	RenderState2D.worldFilters=null;
	RenderState2D.worldShaderDefines=null;
	RenderState2D.curRenderTarget=null;
	RenderState2D.width=0;
	RenderState2D.height=0;
	__static(RenderState2D,
	['worldMatrix',function(){return this.worldMatrix=new Matrix();},'worldClipRect',function(){return this.worldClipRect=new Rectangle(0,0,99999999,99999999);}
	]);
	return RenderState2D;
})()


/**
*@private
*/
//class laya.webgl.WebGL
var WebGL=(function(){
	function WebGL(){}
	__class(WebGL,'laya.webgl.WebGL');
	WebGL._uint8ArraySlice=function(){
		var _this=this;
		var sz=_this.length;
		var dec=new Uint8Array(_this.length);
		for (var i=0;i < sz;i++)dec[i]=_this[i];
		return dec;
	}

	WebGL._float32ArraySlice=function(){
		var _this=this;
		var sz=_this.length;
		var dec=new Float32Array(_this.length);
		for (var i=0;i < sz;i++)dec[i]=_this[i];
		return dec;
	}

	WebGL._uint16ArraySlice=function(__arg){
		var arg=arguments;
		var _this=this;
		var sz=0;
		var dec;
		var i=0;
		if (arg.length===0){
			sz=_this.length;
			dec=new Uint16Array(sz);
			for (i=0;i < sz;i++)
			dec[i]=_this[i];
			}else if (arg.length===2){
			var start=arg[0];
			var end=arg[1];
			if (end > start){
				sz=end-start;
				dec=new Uint16Array(sz);
				for (i=start;i < end;i++)
				dec[i-start]=_this[i];
				}else {
				dec=new Uint16Array(0);
			}
		}
		return dec;
	}

	WebGL.expandContext=function(){
		var from=Context.prototype;
		var to=CanvasRenderingContext2D.prototype;
		to.fillTrangles=from.fillTrangles;
		Buffer2D.__int__(null);
		to.setIBVB=function (x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset){
			(startIndex===void 0)&& (startIndex=0);
			(offset===void 0)&& (offset=0);
			if (ib===null){
				this._ib=this._ib || IndexBuffer2D.QuadrangleIB;
				ib=this._ib;
				GlUtils.expandIBQuadrangle(ib,(vb._byteLength / (4 *16)+8));
			}
			this._setIBVB(x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset);
		};
		to.fillTrangles=function (tex,x,y,points,m){
			this._curMat=this._curMat || Matrix.create();
			this._vb=this._vb || VertexBuffer2D.create();
			if (!this._ib){
				this._ib=IndexBuffer2D.create();
				GlUtils.fillIBQuadrangle(this._ib,length / 4);
			};
			var vb=this._vb;
			var length=points.length >> 4;
			GlUtils.fillTranglesVB(vb,x,y,points,m || this._curMat,0,0);
			GlUtils.expandIBQuadrangle(this._ib,(vb._byteLength / (4 *16)+8));
			var shaderValues=new Value2D(0x01,0);
			shaderValues.textureHost=tex;
			var sd=new Shader2X("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; void main() {vec4 color= texture2D(texture, v_texcoord); color.a*=1.0; gl_FragColor= color;}");
			vb._vertType=3;
			this._setIBVB(x,y,this._ib,vb,length *6,m,sd,shaderValues,0,0);
		}
	}

	WebGL.enable=function(){
		Browser.__init__();
		if (Render.isConchApp){
			if (!Render.isConchWebGL){
				RunDriver.skinAniSprite=function (){
					var tSkinSprite=new SkinMesh()
					return tSkinSprite;
				}
				WebGL.expandContext();
				return false;
			}
		}
		RunDriver.getWebGLContext=function getWebGLContext (canvas){
			var gl;
			var names=["webgl","experimental-webgl","webkit-3d","moz-webgl"];
			for (var i=0;i < names.length;i++){
				try {
					gl=canvas.getContext(names[i],{stencil:Config.isStencil,alpha:Config.isAlpha,antialias:Config.isAntialias,premultipliedAlpha:Config.premultipliedAlpha,preserveDrawingBuffer:Config.preserveDrawingBuffer});
				}catch (e){}
				if (gl)
					return gl;
			}
			return null;
		}
		WebGL.mainContext=RunDriver.getWebGLContext(Render._mainCanvas);
		if (WebGL.mainContext==null)
			return false;
		if (Render.isWebGL)return true;
		HTMLImage.create=function (src,def){
			return new WebGLImage(src,def);
		}
		HTMLSubImage.create=function (canvas,offsetX,offsetY,width,height,atlasImage,src){
			return new WebGLSubImage(canvas,offsetX,offsetY,width,height,atlasImage,src);
		}
		Render.WebGL=WebGL;
		Render.isWebGL=true;
		DrawText.__init__();
		RunDriver.createRenderSprite=function (type,next){
			return new RenderSprite3D(type,next);
		}
		RunDriver.createWebGLContext2D=function (c){
			return new WebGLContext2D(c);
		}
		RunDriver.changeWebGLSize=function (width,height){
			laya.webgl.WebGL.onStageResize(width,height);
		}
		RunDriver.createGraphics=function (){
			return new GraphicsGL();
		};
		var action=RunDriver.createFilterAction;
		RunDriver.createFilterAction=action ? action :function (type){
			return new ColorFilterActionGL()
		}
		RunDriver.clear=function (color){
			RenderState2D.worldScissorTest && laya.webgl.WebGL.mainContext.disable(0x0C11);
			var ctx=Render.context.ctx;
			var c=(ctx._submits._length==0 || Config.preserveDrawingBuffer)? Color$1.create(color)._color :Stage._wgColor;
			if (c)ctx.clearBG(c[0],c[1],c[2],c[3]);
			RenderState2D.clear();
		}
		RunDriver.addToAtlas=function (texture,force){
			(force===void 0)&& (force=false);
			var bitmap=texture.bitmap;
			if (!Render.optimizeTextureMemory(texture.url,texture)){
				(bitmap).enableMerageInAtlas=false;
				return;
			}
			if ((Laya.__typeof(bitmap,'laya.webgl.resource.IMergeAtlasBitmap'))&& ((bitmap).allowMerageInAtlas)){
				bitmap.on("recovered",texture,texture.addTextureToAtlas);
			}
		}
		RunDriver.isAtlas=function (bitmap){
			return (bitmap instanceof laya.webgl.atlas.AtlasWebGLCanvas );
		}
		AtlasResourceManager._enable();
		RunDriver.beginFlush=function (){
			var atlasResourceManager=AtlasResourceManager.instance;
			var count=atlasResourceManager.getAtlaserCount();
			for (var i=0;i < count;i++){
				var atlerCanvas=atlasResourceManager.getAtlaserByIndex(i).texture;
				(atlerCanvas._flashCacheImageNeedFlush)&& (RunDriver.flashFlushImage(atlerCanvas));
			}
		}
		RunDriver.drawToCanvas=function (sprite,_renderType,canvasWidth,canvasHeight,offsetX,offsetY){
			if (canvasWidth <=0 || canvasHeight <=0){
				console.log("[error] canvasWidth and canvasHeight should greater than zero");
			}
			offsetX-=sprite.x;
			offsetY-=sprite.y;
			var renderTarget=RenderTarget2D.create(canvasWidth,canvasHeight,0x1908,0x1401,0,false);
			renderTarget.start();
			renderTarget.clear(0,0,0,0);
			Render.context.clear();
			RenderSprite.renders[_renderType]._fun(sprite,Render.context,offsetX,RenderState2D.height-canvasHeight+offsetY);
			Render.context.flush();
			renderTarget.end();
			var pixels=renderTarget.getData(0,0,renderTarget.width,renderTarget.height);
			renderTarget.recycle();
			var htmlCanvas=new WebGLCanvas();
			htmlCanvas._canvas=Browser.createElement("canvas");
			htmlCanvas.size(canvasWidth,canvasHeight);
			var context=htmlCanvas._canvas.getContext('2d');
			Browser.canvas.size(canvasWidth,canvasHeight);
			var tempContext=Browser.context;
			var imgData=tempContext.createImageData(canvasWidth,canvasHeight);
			imgData.data.set(new Uint8ClampedArray(pixels.buffer));
			htmlCanvas._imgData=imgData;
			tempContext.putImageData(imgData,0,0);
			context.save();
			context.translate(0,canvasHeight);
			context.scale(1,-1);
			context.drawImage(Browser.canvas.source,0,0);
			context.restore();
			return htmlCanvas;
		}
		RunDriver.createFilterAction=function (type){
			var action;
			switch (type){
				case 0x20:
					action=new ColorFilterActionGL();
					break ;
				}
			return action;
		}
		RunDriver.addTextureToAtlas=function (texture){
			texture._uvID++;
			AtlasResourceManager._atlasRestore++;
			((texture.bitmap).enableMerageInAtlas)&& (AtlasResourceManager.instance.addToAtlas(texture));
		}
		RunDriver.getTexturePixels=function (value,x,y,width,height){
			(Render.context.ctx).clear();
			var tSprite=new Sprite();
			tSprite.graphics.drawTexture(value,-x,-y);
			var tRenderTarget=RenderTarget2D.create(width,height);
			tRenderTarget.start();
			tRenderTarget.clear(0,0,0,0);
			tSprite.render(Render.context,0,0);
			(Render.context.ctx).flush();
			tRenderTarget.end();
			var tUint8Array=tRenderTarget.getData(0,0,width,height);
			var tArray=[];
			var tIndex=0;
			for (var i=height-1;i >=0;i--){
				for (var j=0;j < width;j++){
					tIndex=(i *width+j)*4;
					tArray.push(tUint8Array[tIndex]);
					tArray.push(tUint8Array[tIndex+1]);
					tArray.push(tUint8Array[tIndex+2]);
					tArray.push(tUint8Array[tIndex+3]);
				}
			}
			return tArray;
		}
		RunDriver.skinAniSprite=function (){
			var tSkinSprite=new SkinMesh()
			return tSkinSprite;
		}
		HTMLCanvas.create=function (type,canvas){
			var ret=new WebGLCanvas();
			ret._imgData=canvas;
			ret.flipY=false;
			return ret;
		}
		Filter._filterStart=function (scope,sprite,context,x,y){
			var b=scope.getValue("bounds");
			var source=RenderTarget2D.create(b.width,b.height);
			source.start();
			source.clear(0,0,0,0);
			scope.addValue("src",source);
			scope.addValue("ScissorTest",RenderState2D.worldScissorTest);
			if (RenderState2D.worldScissorTest){
				var tClilpRect=new Rectangle();
				tClilpRect.copyFrom((context.ctx)._clipRect)
				scope.addValue("clipRect",tClilpRect);
				RenderState2D.worldScissorTest=false;
				laya.webgl.WebGL.mainContext.disable(0x0C11);
			}
		}
		Filter._filterEnd=function (scope,sprite,context,x,y){
			var b=scope.getValue("bounds");
			var source=scope.getValue("src");
			source.end();
			var out=RenderTarget2D.create(b.width,b.height);
			out.start();
			out.clear(0,0,0,0);
			scope.addValue("out",out);
			sprite._set$P('_filterCache',out);
			sprite._set$P('_isHaveGlowFilter',scope.getValue("_isHaveGlowFilter"));
		}
		Filter._EndTarget=function (scope,context){
			var source=scope.getValue("src");
			source.recycle();
			var out=scope.getValue("out");
			out.end();
			var b=scope.getValue("ScissorTest");
			if (b){
				RenderState2D.worldScissorTest=true;
				laya.webgl.WebGL.mainContext.enable(0x0C11);
				context.ctx.save();
				var tClipRect=scope.getValue("clipRect");
				(context.ctx).clipRect(tClipRect.x,tClipRect.y,tClipRect.width,tClipRect.height);
			}
		}
		Filter._useSrc=function (scope){
			var source=scope.getValue("out");
			source.end();
			source=scope.getValue("src");
			source.start();
			source.clear(0,0,0,0);
		}
		Filter._endSrc=function (scope){
			var source=scope.getValue("src");
			source.end();
		}
		Filter._useOut=function (scope){
			var source=scope.getValue("src");
			source.end();
			source=scope.getValue("out");
			source.start();
			source.clear(0,0,0,0);
		}
		Filter._endOut=function (scope){
			var source=scope.getValue("out");
			source.end();
		}
		Filter._recycleScope=function (scope){
			scope.recycle();
		}
		Filter._filter=function (sprite,context,x,y){
			var next=this._next;
			if (next){
				var filters=sprite.filters,len=filters.length;
				if (len==1 && (filters[0].type==0x20)){
					context.ctx.save();
					context.ctx.setFilters([filters[0]]);
					next._fun.call(next,sprite,context,x,y);
					context.ctx.restore();
					return;
				};
				var shaderValue;
				var b;
				var scope=SubmitCMDScope.create();
				var p=Point.TEMP;
				var tMatrix=context.ctx._getTransformMatrix();
				var mat=Matrix.create();
				tMatrix.copyTo(mat);
				var tPadding=0;
				var tHalfPadding=0;
				var tIsHaveGlowFilter=false;
				var out=sprite._$P._filterCache ? sprite._$P._filterCache :null;
				if (!out || sprite._repaint){
					tIsHaveGlowFilter=sprite._isHaveGlowFilter();
					scope.addValue("_isHaveGlowFilter",tIsHaveGlowFilter);
					if (tIsHaveGlowFilter){
						tPadding=50;
						tHalfPadding=25;
					}
					b=new Rectangle();
					b.copyFrom((sprite).getSelfBounds());
					b.x+=(sprite).x;
					b.y+=(sprite).y;
					b.x-=(sprite).pivotX+4;
					b.y-=(sprite).pivotY+4;
					var tSX=b.x;
					var tSY=b.y;
					b.width+=(tPadding+8);
					b.height+=(tPadding+8);
					p.x=b.x *mat.a+b.y *mat.c;
					p.y=b.y *mat.d+b.x *mat.b;
					b.x=p.x;
					b.y=p.y;
					p.x=b.width *mat.a+b.height *mat.c;
					p.y=b.height *mat.d+b.width *mat.b;
					b.width=p.x;
					b.height=p.y;
					if (b.width <=0 || b.height <=0){
						return;
					}
					out && out.recycle();
					scope.addValue("bounds",b);
					var submit=SubmitCMD.create([scope,sprite,context,0,0],Filter._filterStart);
					context.addRenderObject(submit);
					(context.ctx)._renderKey=0;
					(context.ctx)._shader2D.glTexture=null;
					var tX=sprite.x-tSX+tHalfPadding;
					var tY=sprite.y-tSY+tHalfPadding;
					next._fun.call(next,sprite,context,tX,tY);
					submit=SubmitCMD.create([scope,sprite,context,0,0],Filter._filterEnd);
					context.addRenderObject(submit);
					for (var i=0;i < len;i++){
						if (i !=0){
							submit=SubmitCMD.create([scope],Filter._useSrc);
							context.addRenderObject(submit);
							shaderValue=Value2D.create(0x01,0);
							Matrix.TEMP.identity();
							context.ctx.drawTarget(scope,0,0,b.width,b.height,Matrix.TEMP,"out",shaderValue,null,BlendMode.TOINT.overlay);
							submit=SubmitCMD.create([scope],Filter._useOut);
							context.addRenderObject(submit);
						};
						var fil=filters[i];
						fil.action.apply3d(scope,sprite,context,0,0);
					}
					submit=SubmitCMD.create([scope,context],Filter._EndTarget);
					context.addRenderObject(submit);
					}else {
					tIsHaveGlowFilter=sprite._$P._isHaveGlowFilter ? sprite._$P._isHaveGlowFilter :false;
					if (tIsHaveGlowFilter){
						tPadding=50;
						tHalfPadding=25;
					}
					b=sprite.getBounds();
					if (b.width <=0 || b.height <=0){
						return;
					}
					b.width+=tPadding;
					b.height+=tPadding;
					p.x=b.x *mat.a+b.y *mat.c;
					p.y=b.y *mat.d+b.x *mat.b;
					b.x=p.x;
					b.y=p.y;
					p.x=b.width *mat.a+b.height *mat.c;
					p.y=b.height *mat.d+b.width *mat.b;
					b.width=p.x;
					b.height=p.y;
					scope.addValue("out",out);
				}
				x=x-tHalfPadding-sprite.x;
				y=y-tHalfPadding-sprite.y;
				p.setTo(x,y);
				mat.transformPoint(p);
				x=p.x+b.x;
				y=p.y+b.y;
				shaderValue=Value2D.create(0x01,0);
				Matrix.TEMP.identity();
				(context.ctx).drawTarget(scope,x,y,b.width,b.height,Matrix.TEMP,"out",shaderValue,null,BlendMode.TOINT.overlay);
				submit=SubmitCMD.create([scope],Filter._recycleScope);
				context.addRenderObject(submit);
				mat.destroy();
			}
		}
		Float32Array.prototype.slice || (Float32Array.prototype.slice=WebGL._float32ArraySlice);
		Uint16Array.prototype.slice || (Uint16Array.prototype.slice=WebGL._uint16ArraySlice);
		Uint8Array.prototype.slice || (Uint8Array.prototype.slice=WebGL._uint8ArraySlice);
		return true;
	}

	WebGL.onStageResize=function(width,height){
		if (WebGL.mainContext==null)return;
		WebGL.mainContext.viewport(0,0,width,height);
		RenderState2D.width=width;
		RenderState2D.height=height;
	}

	WebGL.onInvalidGLRes=function(){
		AtlasResourceManager.instance.freeAll();
		ResourceManager.releaseContentManagers(true);
		WebGL.doNodeRepaint(Laya.stage);
		WebGL.mainContext.viewport(0,0,RenderState2D.width,RenderState2D.height);
		Laya.stage.event("devicelost");
	}

	WebGL.doNodeRepaint=function(sprite){
		(sprite.numChildren==0)&& (sprite.repaint());
		for (var i=0;i < sprite.numChildren;i++)
		WebGL.doNodeRepaint(sprite.getChildAt(i));
	}

	WebGL.init=function(canvas,width,height){
		WebGL.mainCanvas=canvas;
		HTMLCanvas._createContext=function (canvas){
			return new WebGLContext2D(canvas);
		}
		WebGLCanvas._createContext=function (canvas){
			return new WebGLContext2D(canvas);
		};
		var gl=laya.webgl.WebGL.mainContext;
		if (gl.getShaderPrecisionFormat !=null){
			var vertexPrecisionFormat=gl.getShaderPrecisionFormat(0x8B31,0x8DF2);
			var framePrecisionFormat=gl.getShaderPrecisionFormat(0x8B30,0x8DF2);
			WebGL.shaderHighPrecision=(vertexPrecisionFormat.precision&&framePrecisionFormat.precision)? true :false;
			}else {
			WebGL.shaderHighPrecision=false;
		}
		WebGL.compressAstc=gl.getExtension("WEBGL_compressed_texture_astc");
		WebGL.compressAtc=gl.getExtension("WEBGL_compressed_texture_atc");
		WebGL.compressEtc=gl.getExtension("WEBGL_compressed_texture_etc");
		WebGL.compressEtc1=gl.getExtension("WEBGL_compressed_texture_etc1");
		WebGL.compressPvrtc=gl.getExtension("WEBGL_compressed_texture_pvrtc");
		WebGL.compressS3tc=gl.getExtension("WEBGL_compressed_texture_s3tc");
		WebGL.compressS3tc_srgb=gl.getExtension("WEBGL_compressed_texture_s3tc_srgb");
		gl.deleteTexture1=gl.deleteTexture;
		gl.deleteTexture=function (t){
			if (t==WebGLContext.curBindTexValue){
				WebGLContext.curBindTexValue=null;
			}
			gl.deleteTexture1(t);
		}
		WebGL.onStageResize(width,height);
		if (WebGL.mainContext==null)
			throw new Error("webGL getContext err!");
		System.__init__();
		AtlasResourceManager.__init__();
		ShaderDefines2D.__init__();
		Submit.__init__();
		WebGLContext2D.__init__();
		Value2D.__init__();
		Shader2D.__init__();
		Buffer2D.__int__(gl);
		BlendMode._init_(gl);
		if (Render.isConchApp){
			conch.setOnInvalidGLRes(WebGL.onInvalidGLRes);
		}
	}

	WebGL.compressAstc=null;
	WebGL.compressAtc=null;
	WebGL.compressEtc=null;
	WebGL.compressEtc1=null;
	WebGL.compressPvrtc=null;
	WebGL.compressS3tc=null;
	WebGL.compressS3tc_srgb=null;
	WebGL.mainCanvas=null;
	WebGL.mainContext=null;
	WebGL.antialias=true;
	WebGL.shaderHighPrecision=false;
	WebGL._bg_null=[0,0,0,0];
	return WebGL;
})()


//class laya.webgl.WebGLContext
var WebGLContext=(function(){
	function WebGLContext(){}
	__class(WebGLContext,'laya.webgl.WebGLContext');
	WebGLContext.UseProgram=function(program){
		if (WebGLContext._useProgram===program)return false;
		WebGL.mainContext.useProgram(program);
		WebGLContext._useProgram=program;
		return true;
	}

	WebGLContext.setDepthTest=function(gl,value){
		value!==WebGLContext._depthTest && (WebGLContext._depthTest=value,value?gl.enable(0x0B71):gl.disable(0x0B71));
	}

	WebGLContext.setDepthMask=function(gl,value){
		value!==WebGLContext._depthMask && (WebGLContext._depthMask=value,gl.depthMask(value));
	}

	WebGLContext.setDepthFunc=function(gl,value){
		value!==WebGLContext._depthFunc && (WebGLContext._depthFunc=value,gl.depthFunc(value));
	}

	WebGLContext.setBlend=function(gl,value){
		value!==WebGLContext._blend && (WebGLContext._blend=value,value?gl.enable(0x0BE2):gl.disable(0x0BE2));
	}

	WebGLContext.setBlendFunc=function(gl,sFactor,dFactor){
		(sFactor!==WebGLContext._sFactor||dFactor!==WebGLContext._dFactor)&& (WebGLContext._sFactor=sFactor,WebGLContext._dFactor=dFactor,gl.blendFunc(sFactor,dFactor));
	}

	WebGLContext.setCullFace=function(gl,value){
		value!==WebGLContext._cullFace && (WebGLContext._cullFace=value,value?gl.enable(0x0B44):gl.disable(0x0B44));
	}

	WebGLContext.setFrontFace=function(gl,value){
		value!==WebGLContext._frontFace && (WebGLContext._frontFace=value,gl.frontFace(value));
	}

	WebGLContext.bindTexture=function(gl,target,texture){
		gl.bindTexture(target,texture);
		WebGLContext.curBindTexTarget=target;
		WebGLContext.curBindTexValue=texture;
	}

	WebGLContext.DEPTH_BUFFER_BIT=0x00000100;
	WebGLContext.STENCIL_BUFFER_BIT=0x00000400;
	WebGLContext.COLOR_BUFFER_BIT=0x00004000;
	WebGLContext.POINTS=0x0000;
	WebGLContext.LINES=0x0001;
	WebGLContext.LINE_LOOP=0x0002;
	WebGLContext.LINE_STRIP=0x0003;
	WebGLContext.TRIANGLES=0x0004;
	WebGLContext.TRIANGLE_STRIP=0x0005;
	WebGLContext.TRIANGLE_FAN=0x0006;
	WebGLContext.ZERO=0;
	WebGLContext.ONE=1;
	WebGLContext.SRC_COLOR=0x0300;
	WebGLContext.ONE_MINUS_SRC_COLOR=0x0301;
	WebGLContext.SRC_ALPHA=0x0302;
	WebGLContext.ONE_MINUS_SRC_ALPHA=0x0303;
	WebGLContext.DST_ALPHA=0x0304;
	WebGLContext.ONE_MINUS_DST_ALPHA=0x0305;
	WebGLContext.DST_COLOR=0x0306;
	WebGLContext.ONE_MINUS_DST_COLOR=0x0307;
	WebGLContext.SRC_ALPHA_SATURATE=0x0308;
	WebGLContext.FUNC_ADD=0x8006;
	WebGLContext.BLEND_EQUATION=0x8009;
	WebGLContext.BLEND_EQUATION_RGB=0x8009;
	WebGLContext.BLEND_EQUATION_ALPHA=0x883D;
	WebGLContext.FUNC_SUBTRACT=0x800A;
	WebGLContext.FUNC_REVERSE_SUBTRACT=0x800B;
	WebGLContext.BLEND_DST_RGB=0x80C8;
	WebGLContext.BLEND_SRC_RGB=0x80C9;
	WebGLContext.BLEND_DST_ALPHA=0x80CA;
	WebGLContext.BLEND_SRC_ALPHA=0x80CB;
	WebGLContext.CONSTANT_COLOR=0x8001;
	WebGLContext.ONE_MINUS_CONSTANT_COLOR=0x8002;
	WebGLContext.CONSTANT_ALPHA=0x8003;
	WebGLContext.ONE_MINUS_CONSTANT_ALPHA=0x8004;
	WebGLContext.BLEND_COLOR=0x8005;
	WebGLContext.ARRAY_BUFFER=0x8892;
	WebGLContext.ELEMENT_ARRAY_BUFFER=0x8893;
	WebGLContext.ARRAY_BUFFER_BINDING=0x8894;
	WebGLContext.ELEMENT_ARRAY_BUFFER_BINDING=0x8895;
	WebGLContext.STREAM_DRAW=0x88E0;
	WebGLContext.STATIC_DRAW=0x88E4;
	WebGLContext.DYNAMIC_DRAW=0x88E8;
	WebGLContext.BUFFER_SIZE=0x8764;
	WebGLContext.BUFFER_USAGE=0x8765;
	WebGLContext.CURRENT_VERTEX_ATTRIB=0x8626;
	WebGLContext.FRONT=0x0404;
	WebGLContext.BACK=0x0405;
	WebGLContext.CULL_FACE=0x0B44;
	WebGLContext.FRONT_AND_BACK=0x0408;
	WebGLContext.BLEND=0x0BE2;
	WebGLContext.DITHER=0x0BD0;
	WebGLContext.STENCIL_TEST=0x0B90;
	WebGLContext.DEPTH_TEST=0x0B71;
	WebGLContext.SCISSOR_TEST=0x0C11;
	WebGLContext.POLYGON_OFFSET_FILL=0x8037;
	WebGLContext.SAMPLE_ALPHA_TO_COVERAGE=0x809E;
	WebGLContext.SAMPLE_COVERAGE=0x80A0;
	WebGLContext.NO_ERROR=0;
	WebGLContext.INVALID_ENUM=0x0500;
	WebGLContext.INVALID_VALUE=0x0501;
	WebGLContext.INVALID_OPERATION=0x0502;
	WebGLContext.OUT_OF_MEMORY=0x0505;
	WebGLContext.CW=0x0900;
	WebGLContext.CCW=0x0901;
	WebGLContext.LINE_WIDTH=0x0B21;
	WebGLContext.ALIASED_POINT_SIZE_RANGE=0x846D;
	WebGLContext.ALIASED_LINE_WIDTH_RANGE=0x846E;
	WebGLContext.CULL_FACE_MODE=0x0B45;
	WebGLContext.FRONT_FACE=0x0B46;
	WebGLContext.DEPTH_RANGE=0x0B70;
	WebGLContext.DEPTH_WRITEMASK=0x0B72;
	WebGLContext.DEPTH_CLEAR_VALUE=0x0B73;
	WebGLContext.DEPTH_FUNC=0x0B74;
	WebGLContext.STENCIL_CLEAR_VALUE=0x0B91;
	WebGLContext.STENCIL_FUNC=0x0B92;
	WebGLContext.STENCIL_FAIL=0x0B94;
	WebGLContext.STENCIL_PASS_DEPTH_FAIL=0x0B95;
	WebGLContext.STENCIL_PASS_DEPTH_PASS=0x0B96;
	WebGLContext.STENCIL_REF=0x0B97;
	WebGLContext.STENCIL_VALUE_MASK=0x0B93;
	WebGLContext.STENCIL_WRITEMASK=0x0B98;
	WebGLContext.STENCIL_BACK_FUNC=0x8800;
	WebGLContext.STENCIL_BACK_FAIL=0x8801;
	WebGLContext.STENCIL_BACK_PASS_DEPTH_FAIL=0x8802;
	WebGLContext.STENCIL_BACK_PASS_DEPTH_PASS=0x8803;
	WebGLContext.STENCIL_BACK_REF=0x8CA3;
	WebGLContext.STENCIL_BACK_VALUE_MASK=0x8CA4;
	WebGLContext.STENCIL_BACK_WRITEMASK=0x8CA5;
	WebGLContext.VIEWPORT=0x0BA2;
	WebGLContext.SCISSOR_BOX=0x0C10;
	WebGLContext.COLOR_CLEAR_VALUE=0x0C22;
	WebGLContext.COLOR_WRITEMASK=0x0C23;
	WebGLContext.UNPACK_ALIGNMENT=0x0CF5;
	WebGLContext.PACK_ALIGNMENT=0x0D05;
	WebGLContext.MAX_TEXTURE_SIZE=0x0D33;
	WebGLContext.MAX_VIEWPORT_DIMS=0x0D3A;
	WebGLContext.SUBPIXEL_BITS=0x0D50;
	WebGLContext.RED_BITS=0x0D52;
	WebGLContext.GREEN_BITS=0x0D53;
	WebGLContext.BLUE_BITS=0x0D54;
	WebGLContext.ALPHA_BITS=0x0D55;
	WebGLContext.DEPTH_BITS=0x0D56;
	WebGLContext.STENCIL_BITS=0x0D57;
	WebGLContext.POLYGON_OFFSET_UNITS=0x2A00;
	WebGLContext.POLYGON_OFFSET_FACTOR=0x8038;
	WebGLContext.TEXTURE_BINDING_2D=0x8069;
	WebGLContext.SAMPLE_BUFFERS=0x80A8;
	WebGLContext.SAMPLES=0x80A9;
	WebGLContext.SAMPLE_COVERAGE_VALUE=0x80AA;
	WebGLContext.SAMPLE_COVERAGE_INVERT=0x80AB;
	WebGLContext.NUM_COMPRESSED_TEXTURE_FORMATS=0x86A2;
	WebGLContext.COMPRESSED_TEXTURE_FORMATS=0x86A3;
	WebGLContext.DONT_CARE=0x1100;
	WebGLContext.FASTEST=0x1101;
	WebGLContext.NICEST=0x1102;
	WebGLContext.GENERATE_MIPMAP_HINT=0x8192;
	WebGLContext.BYTE=0x1400;
	WebGLContext.UNSIGNED_BYTE=0x1401;
	WebGLContext.SHORT=0x1402;
	WebGLContext.UNSIGNED_SHORT=0x1403;
	WebGLContext.INT=0x1404;
	WebGLContext.UNSIGNED_INT=0x1405;
	WebGLContext.FLOAT=0x1406;
	WebGLContext.DEPTH_COMPONENT=0x1902;
	WebGLContext.ALPHA=0x1906;
	WebGLContext.RGB=0x1907;
	WebGLContext.RGBA=0x1908;
	WebGLContext.LUMINANCE=0x1909;
	WebGLContext.LUMINANCE_ALPHA=0x190A;
	WebGLContext.UNSIGNED_SHORT_4_4_4_4=0x8033;
	WebGLContext.UNSIGNED_SHORT_5_5_5_1=0x8034;
	WebGLContext.UNSIGNED_SHORT_5_6_5=0x8363;
	WebGLContext.FRAGMENT_SHADER=0x8B30;
	WebGLContext.VERTEX_SHADER=0x8B31;
	WebGLContext.MAX_VERTEX_ATTRIBS=0x8869;
	WebGLContext.MAX_VERTEX_UNIFORM_VECTORS=0x8DFB;
	WebGLContext.MAX_VARYING_VECTORS=0x8DFC;
	WebGLContext.MAX_COMBINED_TEXTURE_IMAGE_UNITS=0x8B4D;
	WebGLContext.MAX_VERTEX_TEXTURE_IMAGE_UNITS=0x8B4C;
	WebGLContext.MAX_TEXTURE_IMAGE_UNITS=0x8872;
	WebGLContext.MAX_FRAGMENT_UNIFORM_VECTORS=0x8DFD;
	WebGLContext.SHADER_TYPE=0x8B4F;
	WebGLContext.DELETE_STATUS=0x8B80;
	WebGLContext.LINK_STATUS=0x8B82;
	WebGLContext.VALIDATE_STATUS=0x8B83;
	WebGLContext.ATTACHED_SHADERS=0x8B85;
	WebGLContext.ACTIVE_UNIFORMS=0x8B86;
	WebGLContext.ACTIVE_ATTRIBUTES=0x8B89;
	WebGLContext.SHADING_LANGUAGE_VERSION=0x8B8C;
	WebGLContext.CURRENT_PROGRAM=0x8B8D;
	WebGLContext.NEVER=0x0200;
	WebGLContext.LESS=0x0201;
	WebGLContext.EQUAL=0x0202;
	WebGLContext.LEQUAL=0x0203;
	WebGLContext.GREATER=0x0204;
	WebGLContext.NOTEQUAL=0x0205;
	WebGLContext.GEQUAL=0x0206;
	WebGLContext.ALWAYS=0x0207;
	WebGLContext.KEEP=0x1E00;
	WebGLContext.REPLACE=0x1E01;
	WebGLContext.INCR=0x1E02;
	WebGLContext.DECR=0x1E03;
	WebGLContext.INVERT=0x150A;
	WebGLContext.INCR_WRAP=0x8507;
	WebGLContext.DECR_WRAP=0x8508;
	WebGLContext.VENDOR=0x1F00;
	WebGLContext.RENDERER=0x1F01;
	WebGLContext.VERSION=0x1F02;
	WebGLContext.NEAREST=0x2600;
	WebGLContext.LINEAR=0x2601;
	WebGLContext.NEAREST_MIPMAP_NEAREST=0x2700;
	WebGLContext.LINEAR_MIPMAP_NEAREST=0x2701;
	WebGLContext.NEAREST_MIPMAP_LINEAR=0x2702;
	WebGLContext.LINEAR_MIPMAP_LINEAR=0x2703;
	WebGLContext.TEXTURE_MAG_FILTER=0x2800;
	WebGLContext.TEXTURE_MIN_FILTER=0x2801;
	WebGLContext.TEXTURE_WRAP_S=0x2802;
	WebGLContext.TEXTURE_WRAP_T=0x2803;
	WebGLContext.TEXTURE_2D=0x0DE1;
	WebGLContext.TEXTURE=0x1702;
	WebGLContext.TEXTURE_CUBE_MAP=0x8513;
	WebGLContext.TEXTURE_BINDING_CUBE_MAP=0x8514;
	WebGLContext.TEXTURE_CUBE_MAP_POSITIVE_X=0x8515;
	WebGLContext.TEXTURE_CUBE_MAP_NEGATIVE_X=0x8516;
	WebGLContext.TEXTURE_CUBE_MAP_POSITIVE_Y=0x8517;
	WebGLContext.TEXTURE_CUBE_MAP_NEGATIVE_Y=0x8518;
	WebGLContext.TEXTURE_CUBE_MAP_POSITIVE_Z=0x8519;
	WebGLContext.TEXTURE_CUBE_MAP_NEGATIVE_Z=0x851A;
	WebGLContext.MAX_CUBE_MAP_TEXTURE_SIZE=0x851C;
	WebGLContext.TEXTURE0=0x84C0;
	WebGLContext.TEXTURE1=0x84C1;
	WebGLContext.TEXTURE2=0x84C2;
	WebGLContext.TEXTURE3=0x84C3;
	WebGLContext.TEXTURE4=0x84C4;
	WebGLContext.TEXTURE5=0x84C5;
	WebGLContext.TEXTURE6=0x84C6;
	WebGLContext.TEXTURE7=0x84C7;
	WebGLContext.TEXTURE8=0x84C8;
	WebGLContext.TEXTURE9=0x84C9;
	WebGLContext.TEXTURE10=0x84CA;
	WebGLContext.TEXTURE11=0x84CB;
	WebGLContext.TEXTURE12=0x84CC;
	WebGLContext.TEXTURE13=0x84CD;
	WebGLContext.TEXTURE14=0x84CE;
	WebGLContext.TEXTURE15=0x84CF;
	WebGLContext.TEXTURE16=0x84D0;
	WebGLContext.TEXTURE17=0x84D1;
	WebGLContext.TEXTURE18=0x84D2;
	WebGLContext.TEXTURE19=0x84D3;
	WebGLContext.TEXTURE20=0x84D4;
	WebGLContext.TEXTURE21=0x84D5;
	WebGLContext.TEXTURE22=0x84D6;
	WebGLContext.TEXTURE23=0x84D7;
	WebGLContext.TEXTURE24=0x84D8;
	WebGLContext.TEXTURE25=0x84D9;
	WebGLContext.TEXTURE26=0x84DA;
	WebGLContext.TEXTURE27=0x84DB;
	WebGLContext.TEXTURE28=0x84DC;
	WebGLContext.TEXTURE29=0x84DD;
	WebGLContext.TEXTURE30=0x84DE;
	WebGLContext.TEXTURE31=0x84DF;
	WebGLContext.ACTIVE_TEXTURE=0x84E0;
	WebGLContext.REPEAT=0x2901;
	WebGLContext.CLAMP_TO_EDGE=0x812F;
	WebGLContext.MIRRORED_REPEAT=0x8370;
	WebGLContext.FLOAT_VEC2=0x8B50;
	WebGLContext.FLOAT_VEC3=0x8B51;
	WebGLContext.FLOAT_VEC4=0x8B52;
	WebGLContext.INT_VEC2=0x8B53;
	WebGLContext.INT_VEC3=0x8B54;
	WebGLContext.INT_VEC4=0x8B55;
	WebGLContext.BOOL=0x8B56;
	WebGLContext.BOOL_VEC2=0x8B57;
	WebGLContext.BOOL_VEC3=0x8B58;
	WebGLContext.BOOL_VEC4=0x8B59;
	WebGLContext.FLOAT_MAT2=0x8B5A;
	WebGLContext.FLOAT_MAT3=0x8B5B;
	WebGLContext.FLOAT_MAT4=0x8B5C;
	WebGLContext.SAMPLER_2D=0x8B5E;
	WebGLContext.SAMPLER_CUBE=0x8B60;
	WebGLContext.VERTEX_ATTRIB_ARRAY_ENABLED=0x8622;
	WebGLContext.VERTEX_ATTRIB_ARRAY_SIZE=0x8623;
	WebGLContext.VERTEX_ATTRIB_ARRAY_STRIDE=0x8624;
	WebGLContext.VERTEX_ATTRIB_ARRAY_TYPE=0x8625;
	WebGLContext.VERTEX_ATTRIB_ARRAY_NORMALIZED=0x886A;
	WebGLContext.VERTEX_ATTRIB_ARRAY_POINTER=0x8645;
	WebGLContext.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=0x889F;
	WebGLContext.COMPILE_STATUS=0x8B81;
	WebGLContext.LOW_FLOAT=0x8DF0;
	WebGLContext.MEDIUM_FLOAT=0x8DF1;
	WebGLContext.HIGH_FLOAT=0x8DF2;
	WebGLContext.LOW_INT=0x8DF3;
	WebGLContext.MEDIUM_INT=0x8DF4;
	WebGLContext.HIGH_INT=0x8DF5;
	WebGLContext.FRAMEBUFFER=0x8D40;
	WebGLContext.RENDERBUFFER=0x8D41;
	WebGLContext.RGBA4=0x8056;
	WebGLContext.RGB5_A1=0x8057;
	WebGLContext.RGB565=0x8D62;
	WebGLContext.DEPTH_COMPONENT16=0x81A5;
	WebGLContext.STENCIL_INDEX=0x1901;
	WebGLContext.STENCIL_INDEX8=0x8D48;
	WebGLContext.DEPTH_STENCIL=0x84F9;
	WebGLContext.RENDERBUFFER_WIDTH=0x8D42;
	WebGLContext.RENDERBUFFER_HEIGHT=0x8D43;
	WebGLContext.RENDERBUFFER_INTERNAL_FORMAT=0x8D44;
	WebGLContext.RENDERBUFFER_RED_SIZE=0x8D50;
	WebGLContext.RENDERBUFFER_GREEN_SIZE=0x8D51;
	WebGLContext.RENDERBUFFER_BLUE_SIZE=0x8D52;
	WebGLContext.RENDERBUFFER_ALPHA_SIZE=0x8D53;
	WebGLContext.RENDERBUFFER_DEPTH_SIZE=0x8D54;
	WebGLContext.RENDERBUFFER_STENCIL_SIZE=0x8D55;
	WebGLContext.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=0x8CD0;
	WebGLContext.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=0x8CD1;
	WebGLContext.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=0x8CD2;
	WebGLContext.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=0x8CD3;
	WebGLContext.COLOR_ATTACHMENT0=0x8CE0;
	WebGLContext.DEPTH_ATTACHMENT=0x8D00;
	WebGLContext.STENCIL_ATTACHMENT=0x8D20;
	WebGLContext.DEPTH_STENCIL_ATTACHMENT=0x821A;
	WebGLContext.NONE=0;
	WebGLContext.FRAMEBUFFER_COMPLETE=0x8CD5;
	WebGLContext.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=0x8CD6;
	WebGLContext.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=0x8CD7;
	WebGLContext.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=0x8CD9;
	WebGLContext.FRAMEBUFFER_UNSUPPORTED=0x8CDD;
	WebGLContext.FRAMEBUFFER_BINDING=0x8CA6;
	WebGLContext.RENDERBUFFER_BINDING=0x8CA7;
	WebGLContext.MAX_RENDERBUFFER_SIZE=0x84E8;
	WebGLContext.INVALID_FRAMEBUFFER_OPERATION=0x0506;
	WebGLContext.UNPACK_FLIP_Y_WEBGL=0x9240;
	WebGLContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL=0x9241;
	WebGLContext.CONTEXT_LOST_WEBGL=0x9242;
	WebGLContext.UNPACK_COLORSPACE_CONVERSION_WEBGL=0x9243;
	WebGLContext.BROWSER_DEFAULT_WEBGL=0x9244;
	WebGLContext._useProgram=null;
	WebGLContext._depthTest=true;
	WebGLContext._depthMask=true;
	WebGLContext._depthFunc=0x0201;
	WebGLContext._blend=false;
	WebGLContext._sFactor=1;
	WebGLContext._dFactor=0;
	WebGLContext._cullFace=false;
	WebGLContext._frontFace=0x0901;
	WebGLContext.curBindTexTarget=null;
	WebGLContext.curBindTexValue=null;
	return WebGLContext;
})()


/**全局配置*/
//class UIConfig
var UIConfig=(function(){
	function UIConfig(){}
	__class(UIConfig,'UIConfig');
	UIConfig.touchScrollEnable=true;
	UIConfig.mouseWheelEnable=true;
	UIConfig.showButtons=true;
	UIConfig.popupBgColor="#000000";
	UIConfig.popupBgAlpha=0.5;
	UIConfig.closeDialogOnSide=true;
	return UIConfig;
})()


/**
*<code>Node</code> 类是可放在显示列表中的所有对象的基类。该显示列表管理 Laya 运行时中显示的所有对象。使用 Node 类排列显示列表中的显示对象。Node 对象可以有子显示对象。
*/
//class laya.display.Node extends laya.events.EventDispatcher
var Node=(function(_super){
	function Node(){
		/**@private */
		this._bits=0;
		/**@private 是否在显示列表中显示*/
		this._displayedInStage=false;
		/**@private 父节点对象*/
		this._parent=null;
		/**@private */
		this.conchModel=null;
		/**节点名称。*/
		this.name="";
		/**[只读]是否已经销毁。对象销毁后不能再使用。*/
		this._destroyed=false;
		Node.__super.call(this);
		this._childs=Node.ARRAY_EMPTY;
		this._$P=Node.PROP_EMPTY;
		this.timer=Laya.scaleTimer;
		this.conchModel=Render.isConchNode ? this.createConchModel():null;
	}

	__class(Node,'laya.display.Node',_super);
	var __proto=Node.prototype;
	/**@private */
	__proto._setBit=function(type,value){
		if (type==0x1){
			var preValue=this._getBit(type);
			if (preValue !=value){
				this._updateDisplayedInstage();
			}
		}
		if (value){
			this._bits |=type;
			}else {
			this._bits &=~type;
		}
	}

	/**@private */
	__proto._getBit=function(type){
		return (this._bits & type)!=0;
	}

	/**@private */
	__proto._setUpNoticeChain=function(){
		if (this._getBit(0x1)){
			this._setUpNoticeType(0x1);
		}
	}

	/**@private */
	__proto._setUpNoticeType=function(type){
		var ele=this;
		ele._setBit(type,true);
		ele=ele.parent;
		while (ele){
			if (ele._getBit(type))return;
			ele._setBit(type,true);
			ele=ele.parent;
		}
	}

	/**
	*<p>增加事件侦听器，以使侦听器能够接收事件通知。</p>
	*<p>如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。</p>
	*@param type 事件的类型。
	*@param caller 事件侦听函数的执行域。
	*@param listener 事件侦听函数。
	*@param args （可选）事件侦听函数的回调参数。
	*@return 此 EventDispatcher 对象。
	*/
	__proto.on=function(type,caller,listener,args){
		if (type==="display" || type==="undisplay"){
			if (!this._getBit(0x1)){
				this._setUpNoticeType(0x1);
			}
		}
		return this._createListener(type,caller,listener,args,false);
	}

	/**
	*<p>增加事件侦听器，以使侦听器能够接收事件通知，此侦听事件响应一次后则自动移除侦听。</p>
	*<p>如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。</p>
	*@param type 事件的类型。
	*@param caller 事件侦听函数的执行域。
	*@param listener 事件侦听函数。
	*@param args （可选）事件侦听函数的回调参数。
	*@return 此 EventDispatcher 对象。
	*/
	__proto.once=function(type,caller,listener,args){
		if (type==="display" || type==="undisplay"){
			if (!this._getBit(0x1)){
				this._setUpNoticeType(0x1);
			}
		}
		return this._createListener(type,caller,listener,args,true);
	}

	/**@private */
	__proto.createConchModel=function(){
		return null;
	}

	/**
	*<p>销毁此对象。destroy对象默认会把自己从父节点移除，并且清理自身引用关系，等待js自动垃圾回收机制回收。destroy后不能再使用。</p>
	*<p>destroy时会移除自身的事情监听，自身的timer监听，移除子对象及从父节点移除自己。</p>
	*@param destroyChild （可选）是否同时销毁子节点，若值为true,则销毁子节点，否则不销毁子节点。
	*/
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		this._destroyed=true;
		this._parent && this._parent.removeChild(this);
		if (this._childs){
			if (destroyChild)this.destroyChildren();
			else this.removeChildren();
		}
		this._childs=null;
		this._$P=null;
		this.offAll();
		this.timer.clearAll(this);
	}

	/**
	*销毁所有子对象，不销毁自己本身。
	*/
	__proto.destroyChildren=function(){
		if (this._childs){
			for (var i=this._childs.length-1;i >-1;i--){
				this._childs[i].destroy(true);
			}
		}
	}

	/**
	*添加子节点。
	*@param node 节点对象
	*@return 返回添加的节点
	*/
	__proto.addChild=function(node){
		if (!node || this.destroyed || node===this)return node;
		if ((node).zOrder)this._set$P("hasZorder",true);
		if (node._parent===this){
			var index=this.getChildIndex(node);
			if (index!==this._childs.length-1){
				this._childs.splice(index,1);
				this._childs.push(node);
				if (this.conchModel){
					this.conchModel.removeChild(node.conchModel);
					this.conchModel.addChildAt(node.conchModel,this._childs.length-1);
				}
				this._childChanged();
			}
			}else {
			node.parent && node.parent.removeChild(node);
			this._childs===Node.ARRAY_EMPTY && (this._childs=[]);
			this._childs.push(node);
			this.conchModel && this.conchModel.addChildAt(node.conchModel,this._childs.length-1);
			node.parent=this;
			this._childChanged();
		}
		return node;
	}

	/**
	*批量增加子节点
	*@param ...args 无数子节点。
	*/
	__proto.addChildren=function(__args){
		var args=arguments;
		var i=0,n=args.length;
		while (i < n){
			this.addChild(args[i++]);
		}
	}

	/**
	*添加子节点到指定的索引位置。
	*@param node 节点对象。
	*@param index 索引位置。
	*@return 返回添加的节点。
	*/
	__proto.addChildAt=function(node,index){
		if (!node || this.destroyed || node===this)return node;
		if ((node).zOrder)this._set$P("hasZorder",true);
		if (index >=0 && index <=this._childs.length){
			if (node._parent===this){
				var oldIndex=this.getChildIndex(node);
				this._childs.splice(oldIndex,1);
				this._childs.splice(index,0,node);
				if (this.conchModel){
					this.conchModel.removeChild(node.conchModel);
					this.conchModel.addChildAt(node.conchModel,index);
				}
				this._childChanged();
				}else {
				node.parent && node.parent.removeChild(node);
				this._childs===Node.ARRAY_EMPTY && (this._childs=[]);
				this._childs.splice(index,0,node);
				this.conchModel && this.conchModel.addChildAt(node.conchModel,index);
				node.parent=this;
			}
			return node;
			}else {
			throw new Error("appendChildAt:The index is out of bounds");
		}
	}

	/**
	*根据子节点对象，获取子节点的索引位置。
	*@param node 子节点。
	*@return 子节点所在的索引位置。
	*/
	__proto.getChildIndex=function(node){
		return this._childs.indexOf(node);
	}

	/**
	*根据子节点的名字，获取子节点对象。
	*@param name 子节点的名字。
	*@return 节点对象。
	*/
	__proto.getChildByName=function(name){
		var nodes=this._childs;
		if (nodes){
			for (var i=0,n=nodes.length;i < n;i++){
				var node=nodes[i];
				if (node.name===name)return node;
			}
		}
		return null;
	}

	/**@private */
	__proto._get$P=function(key){
		return this._$P[key];
	}

	/**@private */
	__proto._set$P=function(key,value){
		if (!this.destroyed){
			this._$P===Node.PROP_EMPTY && (this._$P={});
			this._$P[key]=value;
		}
		return value;
	}

	/**
	*根据子节点的索引位置，获取子节点对象。
	*@param index 索引位置
	*@return 子节点
	*/
	__proto.getChildAt=function(index){
		return this._childs[index];
	}

	/**
	*设置子节点的索引位置。
	*@param node 子节点。
	*@param index 新的索引。
	*@return 返回子节点本身。
	*/
	__proto.setChildIndex=function(node,index){
		var childs=this._childs;
		if (index < 0 || index >=childs.length){
			throw new Error("setChildIndex:The index is out of bounds.");
		};
		var oldIndex=this.getChildIndex(node);
		if (oldIndex < 0)throw new Error("setChildIndex:node is must child of this object.");
		childs.splice(oldIndex,1);
		childs.splice(index,0,node);
		if (this.conchModel){
			this.conchModel.removeChild(node.conchModel);
			this.conchModel.addChildAt(node.conchModel,index);
		}
		this._childChanged();
		return node;
	}

	/**
	*@private
	*子节点发生改变。
	*@param child 子节点。
	*/
	__proto._childChanged=function(child){}
	/**
	*删除子节点。
	*@param node 子节点
	*@return 被删除的节点
	*/
	__proto.removeChild=function(node){
		if (!this._childs)return node;
		var index=this._childs.indexOf(node);
		return this.removeChildAt(index);
	}

	/**
	*从父容器删除自己，如已经被删除不会抛出异常。
	*@return 当前节点（ Node ）对象。
	*/
	__proto.removeSelf=function(){
		this._parent && this._parent.removeChild(this);
		return this;
	}

	/**
	*根据子节点名字删除对应的子节点对象，如果找不到不会抛出异常。
	*@param name 对象名字。
	*@return 查找到的节点（ Node ）对象。
	*/
	__proto.removeChildByName=function(name){
		var node=this.getChildByName(name);
		node && this.removeChild(node);
		return node;
	}

	/**
	*根据子节点索引位置，删除对应的子节点对象。
	*@param index 节点索引位置。
	*@return 被删除的节点。
	*/
	__proto.removeChildAt=function(index){
		var node=this.getChildAt(index);
		if (node){
			this._childs.splice(index,1);
			this.conchModel && this.conchModel.removeChild(node.conchModel);
			node.parent=null;
		}
		return node;
	}

	/**
	*删除指定索引区间的所有子对象。
	*@param beginIndex 开始索引。
	*@param endIndex 结束索引。
	*@return 当前节点对象。
	*/
	__proto.removeChildren=function(beginIndex,endIndex){
		(beginIndex===void 0)&& (beginIndex=0);
		(endIndex===void 0)&& (endIndex=0x7fffffff);
		if (this._childs && this._childs.length > 0){
			var childs=this._childs;
			if (beginIndex===0 && endIndex >=n){
				var arr=childs;
				this._childs=Node.ARRAY_EMPTY;
				}else {
				arr=childs.splice(beginIndex,endIndex-beginIndex);
			}
			for (var i=0,n=arr.length;i < n;i++){
				arr[i].parent=null;
				this.conchModel && this.conchModel.removeChild(arr[i].conchModel);
			}
		}
		return this;
	}

	/**
	*替换子节点。
	*@internal 将传入的新节点对象替换到已有子节点索引位置处。
	*@param newNode 新节点。
	*@param oldNode 老节点。
	*@return 返回新节点。
	*/
	__proto.replaceChild=function(newNode,oldNode){
		var index=this._childs.indexOf(oldNode);
		if (index >-1){
			this._childs.splice(index,1,newNode);
			if (this.conchModel){
				this.conchModel.removeChild(oldNode.conchModel);
				this.conchModel.addChildAt(newNode.conchModel,index);
			}
			oldNode.parent=null;
			newNode.parent=this;
			return newNode;
		}
		return null;
	}

	/**@private */
	__proto._updateDisplayedInstage=function(){
		var ele;
		ele=this;
		var stage=Laya.stage;
		this._displayedInStage=false;
		while (ele){
			if (ele._getBit(0x1)){
				this._displayedInStage=ele._displayedInStage;
				break ;
			}
			if (ele==stage || ele._displayedInStage){
				this._displayedInStage=true;
				break ;
			}
			ele=ele.parent;
		}
	}

	/**@private */
	__proto._setDisplay=function(value){
		if (this._displayedInStage!==value){
			this._displayedInStage=value;
			if (value)this.event("display");
			else this.event("undisplay");
		}
	}

	/**
	*@private
	*设置指定节点对象是否可见(是否在渲染列表中)。
	*@param node 节点。
	*@param display 是否可见。
	*/
	__proto._displayChild=function(node,display){
		var childs=node._childs;
		if (childs){
			for (var i=0,n=childs.length;i < n;i++){
				var child=childs[i];
				if (!child._getBit(0x1))continue ;
				if (child._childs.length > 0){
					this._displayChild(child,display);
					}else {
					child._setDisplay(display);
				}
			}
		}
		node._setDisplay(display);
	}

	/**
	*当前容器是否包含指定的 <code>Node</code> 节点对象 。
	*@param node 指定的 <code>Node</code> 节点对象 。
	*@return 一个布尔值表示是否包含指定的 <code>Node</code> 节点对象 。
	*/
	__proto.contains=function(node){
		if (node===this)return true;
		while (node){
			if (node.parent===this)return true;
			node=node.parent;
		}
		return false;
	}

	/**
	*定时重复执行某函数。功能同Laya.timer.timerLoop()。
	*@param delay 间隔时间(单位毫秒)。
	*@param caller 执行域(this)。
	*@param method 结束时的回调方法。
	*@param args （可选）回调参数。
	*@param coverBefore （可选）是否覆盖之前的延迟执行，默认为true。
	*@param jumpFrame 时钟是否跳帧。基于时间的循环回调，单位时间间隔内，如能执行多次回调，出于性能考虑，引擎默认只执行一次，设置jumpFrame=true后，则回调会连续执行多次
	*/
	__proto.timerLoop=function(delay,caller,method,args,coverBefore,jumpFrame){
		(coverBefore===void 0)&& (coverBefore=true);
		(jumpFrame===void 0)&& (jumpFrame=false);
		this.timer.loop(delay,caller,method,args,coverBefore,jumpFrame);
	}

	/**
	*定时执行某函数一次。功能同Laya.timer.timerOnce()。
	*@param delay 延迟时间(单位毫秒)。
	*@param caller 执行域(this)。
	*@param method 结束时的回调方法。
	*@param args （可选）回调参数。
	*@param coverBefore （可选）是否覆盖之前的延迟执行，默认为true。
	*/
	__proto.timerOnce=function(delay,caller,method,args,coverBefore){
		(coverBefore===void 0)&& (coverBefore=true);
		this.timer._create(false,false,delay,caller,method,args,coverBefore);
	}

	/**
	*定时重复执行某函数(基于帧率)。功能同Laya.timer.frameLoop()。
	*@param delay 间隔几帧(单位为帧)。
	*@param caller 执行域(this)。
	*@param method 结束时的回调方法。
	*@param args （可选）回调参数。
	*@param coverBefore （可选）是否覆盖之前的延迟执行，默认为true。
	*/
	__proto.frameLoop=function(delay,caller,method,args,coverBefore){
		(coverBefore===void 0)&& (coverBefore=true);
		this.timer._create(true,true,delay,caller,method,args,coverBefore);
	}

	/**
	*定时执行一次某函数(基于帧率)。功能同Laya.timer.frameOnce()。
	*@param delay 延迟几帧(单位为帧)。
	*@param caller 执行域(this)
	*@param method 结束时的回调方法
	*@param args （可选）回调参数
	*@param coverBefore （可选）是否覆盖之前的延迟执行，默认为true
	*/
	__proto.frameOnce=function(delay,caller,method,args,coverBefore){
		(coverBefore===void 0)&& (coverBefore=true);
		this.timer._create(true,false,delay,caller,method,args,coverBefore);
	}

	/**
	*清理定时器。功能同Laya.timer.clearTimer()。
	*@param caller 执行域(this)。
	*@param method 结束时的回调方法。
	*/
	__proto.clearTimer=function(caller,method){
		this.timer.clear(caller,method);
	}

	/**
	*子对象数量。
	*/
	__getset(0,__proto,'numChildren',function(){
		return this._childs.length;
	});

	/**
	*[只读]是否已经销毁。对象销毁后不能再使用。
	*@return
	*/
	__getset(0,__proto,'destroyed',function(){
		return this._destroyed;
	});

	/**父节点。*/
	__getset(0,__proto,'parent',function(){
		return this._parent;
		},function(value){
		if (this._parent!==value){
			if (value){
				this._parent=value;
				this.event("added");
				if (this._getBit(0x1)){
					this._setUpNoticeChain();
					value.displayedInStage && this._displayChild(this,true);
				}
				value._childChanged(this);
				}else {
				this.event("removed");
				this._parent._childChanged();
				if (this._getBit(0x1))this._displayChild(this,false);
				this._parent=value;
			}
		}
	});

	/**表示是否在显示列表中显示。*/
	__getset(0,__proto,'displayedInStage',function(){
		if (this._getBit(0x1))return this._displayedInStage;
		this._setUpNoticeType(0x1);
		return this._displayedInStage;
	});

	Node.ARRAY_EMPTY=[];
	Node.PROP_EMPTY={};
	Node.NOTICE_DISPLAY=0x1;
	Node.MOUSEENABLE=0x2;
	return Node;
})(EventDispatcher)


//class fight.TimerClass extends laya.events.EventDispatcher
var TimerClass=(function(_super){
	function TimerClass(){
		this.scaleManager=null;
		TimerClass.__super.call(this);
		this.scaleManager=BattleFileScene.instance.scaleManager;
	}

	__class(TimerClass,'fight.TimerClass',_super);
	return TimerClass;
})(EventDispatcher)


//class game.base.manager.DragonBonesManager extends laya.events.EventDispatcher
var DragonBonesManager=(function(_super){
	function DragonBonesManager(){
		this.map={};
		DragonBonesManager.__super.call(this);
	}

	__class(DragonBonesManager,'game.base.manager.DragonBonesManager',_super);
	var __proto=DragonBonesManager.prototype;
	__proto.getSkeleton=function(url){
		var arr=this.map[url];
		if(arr==null || arr.length==1){
			return null;
		};
		var t=arr [0];
		return t.buildArmature(0);
	}

	__proto.load=function(url){
		var arr=this.map[url];
		if(arr==null){
			var templet=new Templet();
			templet.on("complete",this,this.comFun,[url,templet]);
			templet.loadAni(url);
			this.map[url]=[templet];
		}
	}

	__proto.comFun=function(url,templet){
		this.map[url]=[templet,0];
		this.event("DB_LOAD_OVER",url);
	}

	__proto.getMcFromPool=function(url){
		var db=Pool.getItem(url);
		if(db==null){
			db=new DragonBonesMc(true);
			db.setUrl(url);
		}
		db.isClear=false;
		return db;
	}

	DragonBonesManager.DB_LOAD_OVER="DB_LOAD_OVER";
	return DragonBonesManager;
})(EventDispatcher)


/**
*<p> <code>Socket</code> 封装了 HTML5 WebSocket ，允许服务器端与客户端进行全双工（full-duplex）的实时通信，并且允许跨域通信。在建立连接后，服务器和 Browser/Client Agent 都能主动的向对方发送或接收文本和二进制数据。</p>
*<p>要使用 <code>Socket</code> 类的方法，请先使用构造函数 <code>new Socket</code> 创建一个 <code>Socket</code> 对象。 <code>Socket</code> 以异步方式传输和接收数据。</p>
*/
//class laya.net.Socket extends laya.events.EventDispatcher
var Socket=(function(_super){
	function Socket(host,port,byteClass){
		/**@private */
		this._endian=null;
		/**@private */
		this._stamp=NaN;
		/**@private */
		this._socket=null;
		/**@private */
		this._connected=false;
		/**@private */
		this._addInputPosition=0;
		/**@private */
		this._input=null;
		/**@private */
		this._output=null;
		/**
		*@private
		*表示建立连接时需等待的毫秒数。
		*/
		this.timeout=0;
		/**
		*@private
		*在写入或读取对象时，控制所使用的 AMF 的版本。
		*/
		this.objectEncoding=0;
		/**
		*不再缓存服务端发来的数据。
		*/
		this.disableInput=false;
		/**
		*用来发送和接收数据的 <code>Byte</code> 类。
		*/
		this._byteClass=null;
		/**
		*<p>子协议名称。子协议名称字符串，或由多个子协议名称字符串构成的数组。必须在调用 connect 或者 connectByUrl 之前进行赋值，否则无效。</p>
		*<p>指定后，只有当服务器选择了其中的某个子协议，连接才能建立成功，否则建立失败，派发 Event.ERROR 事件。</p>
		*@see https://html.spec.whatwg.org/multipage/comms.html#dom-websocket
		*/
		this.protocols=[];
		(port===void 0)&& (port=0);
		Socket.__super.call(this);
		this._byteClass=byteClass ? byteClass :Byte;
		this.endian="bigEndian";
		this.timeout=20000;
		this._addInputPosition=0;
		if (host && port > 0 && port < 65535)
			this.connect(host,port);
	}

	__class(Socket,'laya.net.Socket',_super);
	var __proto=Socket.prototype;
	/**
	*<p>连接到指定的主机和端口。</p>
	*<p>连接成功派发 Event.OPEN 事件；连接失败派发 Event.ERROR 事件；连接被关闭派发 Event.CLOSE 事件；接收到数据派发 Event.MESSAGE 事件； 除了 Event.MESSAGE 事件参数为数据内容，其他事件参数都是原生的 HTML DOM Event 对象。</p>
	*@param host 服务器地址。
	*@param port 服务器端口。
	*/
	__proto.connect=function(host,port){
		var url="ws://"+host+":"+port;
		if (Browser.window.location.protocol=="https:"){
			url="wss://"+host+":"+port;
			}else {
			url="ws://"+host+":"+port;
		}
		this.connectByUrl(url);
	}

	/**
	*<p>连接到指定的服务端 WebSocket URL。 URL 类似 ws://yourdomain:port。</p>
	*<p>连接成功派发 Event.OPEN 事件；连接失败派发 Event.ERROR 事件；连接被关闭派发 Event.CLOSE 事件；接收到数据派发 Event.MESSAGE 事件； 除了 Event.MESSAGE 事件参数为数据内容，其他事件参数都是原生的 HTML DOM Event 对象。</p>
	*@param url 要连接的服务端 WebSocket URL。 URL 类似 ws://yourdomain:port。
	*/
	__proto.connectByUrl=function(url){
		var _$this=this;
		if (this._socket !=null)
			this.close();
		this._socket && this.cleanSocket();
		if (!this.protocols || this.protocols.length==0){
			this._socket=new Browser.window.WebSocket(url);
			}else {
			this._socket=new Browser.window.WebSocket(url,this.protocols);
		}
		this._socket.binaryType="arraybuffer";
		this._output=new this._byteClass();
		this._output.endian=this.endian;
		this._input=new this._byteClass();
		this._input.endian=this.endian;
		this._addInputPosition=0;
		this._socket.onopen=function (e){
			_$this._onOpen(e);
		};
		this._socket.onmessage=function (msg){
			_$this._onMessage(msg);
		};
		this._socket.onclose=function (e){
			_$this._onClose(e);
		};
		this._socket.onerror=function (e){
			_$this._onError(e);
		};
	}

	/**
	*清理socket。
	*/
	__proto.cleanSocket=function(){
		try {
			this._socket.close();
		}catch (e){}
		this._connected=false;
		this._socket.onopen=null;
		this._socket.onmessage=null;
		this._socket.onclose=null;
		this._socket.onerror=null;
		this._socket=null;
	}

	/**
	*关闭连接。
	*/
	__proto.close=function(){
		if (this._socket !=null){
			try {
				this._socket.close();
			}catch (e){}
		}
	}

	/**
	*@private
	*连接建立成功 。
	*/
	__proto._onOpen=function(e){
		this._connected=true;
		this.event("open",e);
	}

	/**
	*@private
	*接收到数据处理方法。
	*@param msg 数据。
	*/
	__proto._onMessage=function(msg){
		if (!msg || !msg.data)return;
		var data=msg.data;
		if (this.disableInput && data){
			this.event("message",data);
			return;
		}
		if (this._input.length > 0 && this._input.bytesAvailable < 1){
			this._input.clear();
			this._addInputPosition=0;
		};
		var pre=this._input.pos;
		!this._addInputPosition && (this._addInputPosition=0);
		this._input.pos=this._addInputPosition;
		if (data){
			if ((typeof data=='string')){
				this._input.writeUTFBytes(data);
				}else {
				this._input.writeArrayBuffer(data);
			}
			this._addInputPosition=this._input.pos;
			this._input.pos=pre;
		}
		this.event("message",data);
	}

	/**
	*@private
	*连接被关闭处理方法。
	*/
	__proto._onClose=function(e){
		this._connected=false;
		this.event("close",e)
	}

	/**
	*@private
	*出现异常处理方法。
	*/
	__proto._onError=function(e){
		this.event("error",e)
	}

	/**
	*发送数据到服务器。
	*@param data 需要发送的数据，可以是String或者ArrayBuffer。
	*/
	__proto.send=function(data){
		this._socket.send(data);
	}

	/**
	*发送缓冲区中的数据到服务器。
	*/
	__proto.flush=function(){
		if (this._output && this._output.length > 0){
			var evt;
			try {
				this._socket && this._socket.send(this._output.__getBuffer().slice(0,this._output.length));
				}catch (e){
				evt=e;
			}
			this._output.endian=this.endian;
			this._output.clear();
			if (evt)this.event("error",evt);
		}
	}

	/**
	*缓存的服务端发来的数据。
	*/
	__getset(0,__proto,'input',function(){
		return this._input;
	});

	/**
	*表示需要发送至服务端的缓冲区中的数据。
	*/
	__getset(0,__proto,'output',function(){
		return this._output;
	});

	/**
	*表示此 Socket 对象目前是否已连接。
	*/
	__getset(0,__proto,'connected',function(){
		return this._connected;
	});

	/**
	*<p>主机字节序，是 CPU 存放数据的两种不同顺序，包括小端字节序和大端字节序。</p>
	*<p> LITTLE_ENDIAN ：小端字节序，地址低位存储值的低位，地址高位存储值的高位。</p>
	*<p> BIG_ENDIAN ：大端字节序，地址低位存储值的高位，地址高位存储值的低位。</p>
	*/
	__getset(0,__proto,'endian',function(){
		return this._endian;
		},function(value){
		this._endian=value;
		if (this._input !=null)this._input.endian=value;
		if (this._output !=null)this._output.endian=value;
	});

	Socket.LITTLE_ENDIAN="littleEndian";
	Socket.BIG_ENDIAN="bigEndian";
	return Socket;
})(EventDispatcher)


//class game.base.utils.MyAnimation extends laya.events.EventDispatcher
var MyAnimation=(function(_super){
	function MyAnimation(ss_){
		this.index=0;
		this.ss=null;
		MyAnimation.__super.call(this);
		this.ss=ss_;
	}

	__class(MyAnimation,'game.base.utils.MyAnimation',_super);
	var __proto=MyAnimation.prototype;
	__proto.start=function(){
		this.event("game.base.utils.MyAnimation.Start");
	}

	__proto.end=function(){
		this.event("game.base.utils.MyAnimation.End");
	}

	MyAnimation.Start="game.base.utils.MyAnimation.Start";
	MyAnimation.End="game.base.utils.MyAnimation.End";
	MyAnimation.Frame="game.base.utils.MyAnimation.Frame";
	return MyAnimation;
})(EventDispatcher)


//class game.mvc.OrderCommand extends game.mvc.Command
var OrderCommand=(function(_super){
	function OrderCommand(){
		OrderCommand.__super.call(this);
	}

	__class(OrderCommand,'game.mvc.OrderCommand',_super);
	OrderCommand.nextStep=function(){
		App.eventManager.event("ORDER_CMD_NEXT");
	}

	OrderCommand.ORDER_CMD_NEXT="ORDER_CMD_NEXT";
	return OrderCommand;
})(Command)


//class game.base.utils.ByteArray extends laya.utils.Byte
var ByteArray=(function(_super){
	function ByteArray(){
		this._$1__length=0;
		this._objectEncoding_=0;
		this._position_=0;
		this._$1__allocated_=8;
		this._data_=null;
		//arrayBuffer
		this._littleEndian_=false;
		this._byteView_=null;
		this._strTable=null;
		//=[];
		this._objTable=null;
		//=[];
		this._traitsTable=null;
		ByteArray.__super.call(this);
		this.___resizeBuffers(this._allocated_);
	}

	__class(ByteArray,'game.base.utils.ByteArray',_super);
	var __proto=ByteArray.prototype;
	__proto.clear=function(){
		this._strTable=[];
		this._objTable=[];
		this._traitsTable=[];
		this._position_=0;
		this.length=0;
	}

	__proto.ensureWrite=function(lengthToEnsure){
		if (this._$1__length < lengthToEnsure)this.length=lengthToEnsure;
	}

	__proto.readBoolean=function(){
		return (this.readByte ()!=0);
	}

	__proto.readByte=function(){
		return this._data_.getInt8 (this._position_++);
	}

	__proto.readBytes=function(bytes,offset,length){
		(offset===void 0)&& (offset=0);
		(length===void 0)&& (length=0);
		if (offset < 0 || length < 0){
			throw "Read error - Out of bounds";
		}
		if (length==0)length=this._$1__length-this._position_;
		bytes.ensureWrite (offset+length);
		bytes._byteView_.set (this._byteView_.subarray(this._position_,this._position_+length),offset);
		bytes.position=offset;
		this._position_+=length;
		if (bytes.position+length > bytes.length)bytes.length=bytes.position+length;
	}

	__proto.readDouble=function(){
		var double=this._data_.getFloat64 (this._position_,this._littleEndian_);
		this._position_+=8;
		return double;
	}

	__proto.readFloat=function(){
		var float=this._data_.getFloat32 (this._position_,this._littleEndian_);
		this._position_+=4;
		return float;
	}

	__proto.readFullBytes=function(bytes,pos,len){
		this.ensureWrite (len);
		for(var i=pos;i < pos+len;i++){
			this._data_.setInt8 (this._position_++,bytes.get(i));
		}
	}

	__proto.readInt=function(){
		var tInt=this._data_.getInt32 (this._position_,this._littleEndian_);
		this._position_+=4;
		return tInt;
	}

	__proto.readShort=function(){
		var short=this._data_.getInt16 (this._position_,this._littleEndian_);
		this._position_+=2;
		return short;
	}

	__proto.readUnsignedByte=function(){
		return this._data_.getUint8 (this._position_++);
	}

	__proto.readUnsignedInt=function(){
		var uInt=this._data_.getUint32 (this._position_,this._littleEndian_);
		this._position_+=4;
		return int(uInt);
	}

	//add by ch.ji 解决读取整数时读到负整数的问题
	__proto.readUnsignedShort=function(){
		var uShort=this._data_.getUint16 (this._position_,this._littleEndian_);
		this._position_+=2;
		return uShort;
	}

	__proto.readLong=function(){
		return this.readInt()*10000000+this.readInt();
	}

	__proto.readUTF=function(){
		return this.readUTFBytes (this.readUnsignedShort ());
	}

	__proto.readUnicode=function(length){
		var value="";
		var max=this._position_+length;
		var c1=0,c2=0;
		while (this._position_ < max){
			c2=this._byteView_[this._position_++];
			c1=this._byteView_[this._position_++];
			value+=String.fromCharCode(c1<<8 | c2);
		}
		return value;
	}

	__proto.readMultiByte=function(length,charSet){
		if(charSet=="UNICODE" || charSet=="unicode"){
			return this.readUnicode(length);
		}
		return this.readUTFBytes (length);
	}

	__proto.readUTFBytes=function(len){
		(len===void 0)&& (len=-1);
		var value="";
		var max=this._position_+len;
		var c=0,c2=0,c3=0;
		while (this._position_ < max){
			c=this._data_.getUint8 (this._position_++);
			if (c < 0x80){
				if (c !=0){
					value+=String.fromCharCode (c);
				}
				}else if (c < 0xE0){
				value+=String.fromCharCode (((c & 0x3F)<< 6)| (this._data_.getUint8 (this._position_++)& 0x7F));
				}else if (c < 0xF0){
				c2=this._data_.getUint8 (this._position_++);
				value+=String.fromCharCode (((c & 0x1F)<< 12)| ((c2 & 0x7F)<< 6)| (this._data_.getUint8 (this._position_++)& 0x7F));
				}else {
				c2=this._data_.getUint8 (this._position_++);
				c3=this._data_.getUint8 (this._position_++);
				value+=String.fromCharCode (((c & 0x0F)<< 18)| ((c2 & 0x7F)<< 12)| ((c3 << 6)& 0x7F)| (this._data_.getUint8 (this._position_++)& 0x7F));
			}
		}
		return value;
	}

	__proto.toString=function(){
		var cachePosition=this._position_;
		this._position_=0;
		var value=this.readUTFBytes (this.length);
		this._position_=cachePosition;
		return value;
	}

	__proto.writeBoolean=function(value){
		this.writeByte (value ? 1 :0);
	}

	__proto.writeByte=function(value){
		this.ensureWrite (this._position_+1);
		this._data_.setInt8 (this._position_,value);
		this._position_+=1;
	}

	__proto.writeBytes=function(bytes,offset,length){
		(offset===void 0)&& (offset=0);
		(length===void 0)&& (length=0);
		if (offset < 0 || length < 0)throw "writeBytes error - Out of bounds";
		if(length==0)length=bytes.length-offset;
		this.ensureWrite (this._position_+length);
		this._byteView_.set(bytes._byteView_.subarray (offset,offset+length),this._position_);
		this._position_+=length;
	}

	__proto.writeArrayBuffer=function(arraybuffer,offset,length){
		(offset===void 0)&& (offset=0);
		(length===void 0)&& (length=0);
		if (offset < 0 || length < 0)throw "writeArrayBuffer error - Out of bounds";
		if(length==0)length=arraybuffer.byteLength-offset;
		this.ensureWrite (this._position_+length);
		var uint8array=new Uint8Array(arraybuffer);
		this._byteView_.set(uint8array.subarray (offset,offset+length),this._position_);
		this._position_+=length;
	}

	__proto.writeDouble=function(x){
		this.ensureWrite (this._position_+8);
		this._data_.setFloat64 (this._position_,x,this._littleEndian_);
		this._position_+=8;
	}

	__proto.writeFloat=function(x){
		this.ensureWrite (this._position_+4);
		this._data_.setFloat32 (this._position_,x,this._littleEndian_);
		this._position_+=4;
	}

	__proto.writeInt=function(value){
		this.ensureWrite (this._position_+4);
		this._data_.setInt32 (this._position_,value,this._littleEndian_);
		this._position_+=4;
	}

	__proto.writeShort=function(value){
		this.ensureWrite (this._position_+2);
		this._data_.setInt16 (this._position_,value,this._littleEndian_);
		this._position_+=2;
	}

	__proto.writeUnsignedInt=function(value){
		this.ensureWrite (this._position_+4);
		this._data_.setUint32 (this._position_,value,this._littleEndian_);
		this._position_+=4;
	}

	__proto.writeUnsignedShort=function(value){
		this.ensureWrite (this._position_+2);
		this._data_.setUint16 (this._position_,value,this._littleEndian_);
		this._position_+=2;
	}

	__proto.writeUTF=function(value){
		value=value+"";
		this.writeUnsignedShort (this._getUTFBytesCount(value));this.writeUTFBytes (value);
	}

	__proto.writeUnicode=function(value){
		value=value+"";
		this.ensureWrite (this._position_+value.length*2);
		var c=0;
		for(var i=0,sz=value.length;i<sz;i++){
			c=value.charCodeAt(i);
			this._byteView_[this._position_++]=c&0xff;
			this._byteView_[this._position_++]=c>>8;
		}
	}

	__proto.writeMultiByte=function(value,charSet){
		value=value+"";
		if(charSet=="UNICODE" || charSet=="unicode"){
			return this.writeUnicode(value);
		}
		this.writeUTFBytes(value);
	}

	__proto.writeUTFBytes=function(value){
		value=value+"";
		this.ensureWrite(this._position_+value.length*4);
		for (var i=0,sz=value.length;i < sz;i++){
			var c=value.charCodeAt(i);
			if (c <=0x7F){
				this.writeByte (c);
				}else if (c <=0x7FF){
				this.writeByte (0xC0 | (c >> 6));
				this.writeByte (0x80 | (c & 63));
				}else if (c <=0xFFFF){
				this.writeByte(0xE0 | (c >> 12));
				this.writeByte(0x80 | ((c >> 6)& 63));
				this.writeByte(0x80 | (c & 63));
				}else {
				this.writeByte(0xF0 | (c >> 18));
				this.writeByte(0x80 | ((c >> 12)& 63));
				this.writeByte(0x80 | ((c >> 6)& 63));
				this.writeByte(0x80 | (c & 63));
			}
		}
		this.length=this._position_;
	}

	__proto.__fromBytes=function(inBytes){
		this._byteView_=new Uint8Array(inBytes.getData ());
		this.length=this._byteView_.length;
		this._$1__allocated_=this.length;
	}

	__proto.__get=function(pos){
		return this._data_.getUint8(pos);
	}

	__proto._getUTFBytesCount=function(value){
		var count=0;
		value=value+"";
		for (var i=0,sz=value.length;i < sz;i++){
			var c=value.charCodeAt(i);
			if (c <=0x7F){
				count+=1;
				}else if (c <=0x7FF){
				count+=2;
				}else if (c <=0xFFFF){
				count+=3;
				}else {
				count+=4;
			}
		}
		return count;
	}

	__proto._byteAt_=function(index){
		return this._byteView_[index];
	}

	__proto._byteSet_=function(index,value){
		this.ensureWrite (index+1);
		this._byteView_[index]=value;
	}

	//this._position_+=1;
	__proto.uncompress=function(algorithm){
		(algorithm===void 0)&& (algorithm="zlib");
		var inflate=new Zlib.Inflate(this._byteView_);
		this._byteView_=inflate.decompress();
		this._data_=new DataView(this._byteView_ .buffer);;
		this._$1__allocated_=this._$1__length=this._byteView_.byteLength;
		this._position_=0;
	}

	__proto.compress=function(algorithm){
		(algorithm===void 0)&& (algorithm="zlib");
		var deflate=new Zlib.Deflate(this._byteView_);
		this._byteView_=deflate.compress();
		this._data_=new DataView(this._byteView_.buffer);;
		this._position_=this._$1__allocated_=this._$1__length=this._byteView_.byteLength;
	}

	__proto.___resizeBuffers=function(len){
		try{
			var newByteView=new Uint8Array(len);
			if (this._byteView_!=null){
				if (this._byteView_.length <=len)newByteView.set (this._byteView_);
				else newByteView.set (this._byteView_.subarray (0,len));
			}
			this._byteView_=newByteView;
			this._data_=new DataView(newByteView.buffer);
		}
		catch (err){
			throw "___resizeBuffer err:"+len;
		}
	}

	__proto.__getBuffer=function(){
		this._data_.buffer.byteLength=this.length;
		return this._data_.buffer;
	}

	__proto.__set=function(pos,v){
		this._data_.setUint8 (pos,v);
	}

	__proto.setUint8Array=function(data){
		this._byteView_=data;
		this._data_=new DataView(data.buffer);
		this._$1__length=data.byteLength;
		this._position_=0;
	}

	/**从字节数组中读取一个以 AMF 序列化格式进行编码的对象 **/
	__proto.readObject=function(){
		this._strTable=[];
		this._objTable=[];
		this._traitsTable=[];
		return this.readObject2();
	}

	__proto.readObject2=function(){
		var type=this.readByte();
		return this.readObjectValue(type);
	}

	__proto.readObjectValue=function(type){
		var value;
		switch (type){
			case 1:
				break ;
			case 6:
				value=this.__readString();
				break ;
			case 4:
				value=this.readInterger();
				break ;
			case 2:
				value=false;
				break ;
			case 3:
				value=true;
				break ;
			case 10:
				value=this.readScriptObject();
				break ;
			case 9:
				value=this.readArray();
				break ;
			case 5:
				value=this.readDouble();
				break ;
			case 12:
				value=this.readByteArray();
				break ;
			default :
			}
		return value;
	}

	__proto.readByteArray=function(){
		var ref=this.readUInt29();
		if ((ref & 1)==0){
			return this.getObjRef(ref >> 1);
		}
		else{
			var len=(ref >> 1);
			var ba=new ByteArray();
			this._objTable.push(ba);
			this.readBytes(ba,0,len);
			return ba;
		}
	}

	__proto.readInterger=function(){
		var i=this.readUInt29();
		i=(i << 3)>> 3;
		return parseInt(i+"");
	}

	__proto.getStrRef=function(ref){
		return this._strTable[ref];
	}

	__proto.getObjRef=function(ref){
		return this._objTable[ref];
	}

	__proto.__readString=function(){
		var ref=this.readUInt29();
		if ((ref & 1)==0){
			return this.getStrRef(ref >> 1);
		};
		var len=(ref >> 1);
		if (0==len){
			return "";
		};
		var str=this.readUTFBytes(len);
		this._strTable.push(str);
		return str;
	}

	__proto.readTraits=function(ref){
		var ti;
		if ((ref & 3)==1){
			ti=this.getTraitReference(ref >> 2);
			return ti.propoties?ti:{obj:{}};
		}
		else{
			var externalizable=((ref & 4)==4);
			var isDynamic=((ref & 8)==8);
			var count=(ref >> 4);
			var className=this.__readString();
			ti={};
			ti.className=className;
			ti.propoties=[];
			ti.dynamic=isDynamic;
			ti.externalizable=externalizable;
			if(count>0){
				for(var i=0;i<count;i++){
					var propName=this.__readString();
					ti.propoties.push(propName);
				}
			}
			this._traitsTable.push(ti);
			return ti;
		}
	}

	__proto.readScriptObject=function(){
		var ref=this.readUInt29();
		if ((ref & 1)==0){
			return this.getObjRef(ref >> 1);
		}
		else{
			var objref=this.readTraits(ref);
			var className=objref.className;
			var externalizable=objref.externalizable;
			var obj;
			var propName;
			var pros=objref.propoties;
			if(className&&className!=""){
				var rst=ClassUtils.getRegClass(className);
				if(rst){
					obj=new rst();
					}else{
					obj={};
				}
				}else{
				obj={};
			}
			this._objTable.push(obj);
			if(pros){
				for(var d=0;d<pros.length;d++){
					obj[pros[d]]=this.readObject2();
				}
			}
			if(objref.dynamic){
				for (;;){
					propName=this.__readString();
					if (propName==null || propName.length==0)break ;
					obj[propName]=this.readObject2();
				}
			}
			return obj;
		}
	}

	__proto.readArray=function(){
		var ref=this.readUInt29();
		if ((ref & 1)==0){
			return this.getObjRef(ref >> 1);
		};
		var obj=null;
		var count=(ref >> 1);
		var propName;
		for (;;){
			propName=this.__readString();
			if (propName==null || propName.length==0)break ;
			if (obj==null){
				obj={};
				this._objTable.push(obj);
			}
			obj[propName]=this.readObject2();
		}
		if (obj==null){
			obj=[];
			this._objTable.push(obj);
			var i=0;
			for (i=0;i < count;i++){
				obj.push(this.readObject2());
			}
			}else {
			for (i=0;i < count;i++){
				obj[i.toString()]=this.readObject2();
			}
		}
		return obj;
	}

	/**
	*AMF 3 represents smaller integers with fewer bytes using the most
	*significant bit of each byte. The worst case uses 32-bits
	*to represent a 29-bit number,which is what we would have
	*done with no compression.
	*<pre>
	*0x00000000-0x0000007F :0xxxxxxx
	*0x00000080-0x00003FFF :1xxxxxxx 0xxxxxxx
	*0x00004000-0x001FFFFF :1xxxxxxx 1xxxxxxx 0xxxxxxx
	*0x00200000-0x3FFFFFFF :1xxxxxxx 1xxxxxxx 1xxxxxxx xxxxxxxx
	*0x40000000-0xFFFFFFFF :throw range exception
	*</pre>
	*
	*@return A int capable of holding an unsigned 29 bit integer.
	*@throws IOException
	*@exclude
	*/
	__proto.readUInt29=function(){
		var value=0;
		var b=this.readByte()& 0xFF;
		if (b < 128){
			return b;
		}
		value=(b & 0x7F)<< 7;
		b=this.readByte()& 0xFF;
		if (b < 128){
			return (value | b);
		}
		value=(value | (b & 0x7F))<< 7;
		b=this.readByte()& 0xFF;
		if (b < 128){
			return (value | b);
		}
		value=(value | (b & 0x7F))<< 8;
		b=this.readByte()& 0xFF;
		return (value | b);
	}

	//============================================================================================
	__proto.writeObject=function(o){
		this._strTable=[];
		this._objTable=[];
		this._traitsTable=[];
		this.writeObject2(o);
	}

	__proto.writeObject2=function(o){
		if(o==null){
			this.writeAMFNull();
			return;
		};
		var type=typeof(o);
		if("string"===type){
			this.writeAMFString(o);
		}
		else if("boolean"===type){
			this.writeAMFBoolean(o);
		}
		else if("number"===type){
			if(String(o).indexOf(".")!=-1){
				this.writeAMFDouble(o);
			}
			else{
				this.writeAMFInt(o);
			}
		}
		else if("object"===type){
			if((o instanceof Array)){
				this.writeArray(o);
			}
			else if((o instanceof game.base.utils.ByteArray )){
				this.writeAMFByteArray(o);
			}
			else{
				this.writeCustomObject(o);
			}
		}
	}

	__proto.writeAMFNull=function(){
		this.writeByte(1);
	}

	__proto.writeAMFString=function(s){
		this.writeByte(6);
		this.writeStringWithoutType(s);
	}

	__proto.writeStringWithoutType=function(s){
		if (s.length==0){
			this.writeUInt29(1);
			return;
		};
		var ref=this._strTable.indexOf(s);
		if(ref>=0){
			this.writeUInt29(ref << 1);
			}else{
			var utflen=this._getUTFBytesCount(s);
			this.writeUInt29((utflen << 1)| 1);
			this.writeUTFBytes(s);
			this._strTable.push(s);
		}
	}

	__proto.writeAMFInt=function(i){
		if (i >=ByteArray.INT28_MIN_VALUE && i <=0x0FFFFFFF){
			i=i & 0x1FFFFFFF;
			this.writeByte(4);
			this.writeUInt29(i);
			}else {
			this.writeAMFDouble(i);
		}
	}

	__proto.writeAMFDouble=function(d){
		this.writeByte(5);
		this.writeDouble(d);
	}

	__proto.writeAMFBoolean=function(b){
		if (b)
			this.writeByte(3);
		else
		this.writeByte(2);
	}

	__proto.writeCustomObject=function(o){
		this.writeByte(10);
		var refNum=this._objTable.indexOf(o);
		if(refNum!=-1){
			this.writeUInt29(refNum << 1);
		}
		else{
			this._objTable.push(o);
			var traitsInfo=new Object();
			traitsInfo.className=this.getAliasByObj(o);
			traitsInfo.dynamic=false;
			traitsInfo.externalizable=false;
			traitsInfo.properties=[];
			for(var prop in o){
				if((typeof (o[prop])=='function'))continue ;
				traitsInfo.properties.push(prop);
				traitsInfo.properties.sort();
			};
			var tRef=ByteArray.getTraitsInfoRef(this._traitsTable,traitsInfo);
			var count=traitsInfo.properties.length;
			var i=0;
			if(tRef>=0){
				this.writeUInt29((tRef << 2)| 1);
				}else{
				this._traitsTable.push(traitsInfo);
				this.writeUInt29(3 | (traitsInfo.externalizable ? 4 :0)| (traitsInfo.dynamic ? 8 :0)| (count << 4));
				this.writeStringWithoutType(traitsInfo.className);
				for(i=0;i<count;i++){
					this.writeStringWithoutType(traitsInfo.properties[i]);
				}
			}
			for(i=0;i<count;i++){
				this.writeObject2(o[traitsInfo.properties[i]]);
			}
		}
	}

	/**
	*获取实例的注册别名
	*@param obj
	*@return
	*/
	__proto.getAliasByObj=function(obj){
		var tClassName=ClassUtils.getRegClass(obj);
		if(tClassName==null || tClassName=="")return "";
		var tClass=ClassUtils.getClass(tClassName);
		if(tClass==null)return "";
		var tkey;
		return "";
	}

	__proto.writeArray=function(value){
		this.writeByte(9);
		var len=value.length;
		var ref=this._objTable.indexOf(value);
		if(ref>-1){
			this.writeUInt29(len<<1);
		}
		else{
			this.writeUInt29((len << 1)| 1);
			this.writeStringWithoutType("");
			for (var i=0;i < len;i++){
				this.writeObject2(value[i]);
			}
			this._objTable.push(value);
		}
	}

	__proto.writeAMFByteArray=function(ba){
		this.writeByte(12);
		var ref=this._objTable.indexOf(ba);
		if(ref>=0){
			this.writeUInt29(ref << 1);
			}else{
			var len=ba.length;
			this.writeUInt29((len << 1)| 1);
			this.writeBytes(ba,0,len);
		}
	}

	__proto.writeMapAsECMAArray=function(o){
		this.writeByte(9);
		this.writeUInt29((0 << 1)| 1);
		var count=0,key;
		for (key in o){
			count++;
			this.writeStringWithoutType(key);
			this.writeObject2(o[key]);
		}
		this.writeStringWithoutType("");
	}

	__proto.writeUInt29=function(ref){
		if (ref < 0x80){
			this.writeByte(ref);
			}else if (ref < 0x4000){
			this.writeByte(((ref >> 7)& 0x7F)| 0x80);
			this.writeByte(ref & 0x7F);
			}else if (ref < 0x200000){
			this.writeByte(((ref >> 14)& 0x7F)| 0x80);
			this.writeByte(((ref >> 7)& 0x7F)| 0x80);
			this.writeByte(ref & 0x7F);
			}else if (ref < 0x40000000){
			this.writeByte(((ref >> 22)& 0x7F)| 0x80);
			this.writeByte(((ref >> 15)& 0x7F)| 0x80);
			this.writeByte(((ref >> 8)& 0x7F)| 0x80);
			this.writeByte(ref & 0xFF);
		}else {}
	}

	/**
	*@exclude
	*/
	__proto.getTraitReference=function(ref){
		return this._traitsTable[ref];
	}

	// Getters & Setters
	__getset(0,__proto,'bytesAvailable',function(){
		return this.length-this._position_;
	});

	__getset(0,__proto,'position',function(){
		return this._position_;
		},function(pos){
		if (pos < this._$1__length)
			this._position_=pos < 0?0:pos;
		else{
			this._position_=pos;
			this.length=pos;
		}
	});

	__getset(0,__proto,'endian',function(){
		return this._littleEndian_ ? "littleEndian" :"bigEndian";
		},function(endianStr){
		this._littleEndian_=(endianStr=="littleEndian");
	});

	__getset(0,__proto,'length',function(){
		return this._$1__length;
		},function(value){
		this.___resizeBuffers (this._$1__allocated_=value);
		this._$1__length=value;
	});

	ByteArray.__ofBuffer=function(buffer){
		var bytes=new ByteArray ();
		bytes.length=bytes.allocated=buffer.byteLength;
		bytes.data=new DataView(buffer);
		bytes.byteView=new Uint8Array(buffer);
		return bytes;
	}

	ByteArray.getTraitsInfoRef=function(arr,ti){
		var i=0,len=arr.length;
		for(i=0;i<len;i++){
			if (ByteArray.equalsTraitsInfo(ti,arr[i]))return i;
		}
		return-1;
	}

	ByteArray.equalsTraitsInfo=function(ti1,ti2){
		if (ti1==ti2){
			return true;
		}
		if (!ti1.className===ti2.className){
			return false;
		}
		if(ti1.properties.length !=ti2.properties.length){
			return false;
		};
		var len=ti1.properties.length;
		var prop;
		ti1.properties.sort();ti2.properties.sort();
		for(var i=0;i<len;i++){
			if(ti1.properties[i] !=ti2.properties[i]){
				return false;
			}
		}
		return true;
	}

	ByteArray.BIG_ENDIAN="bigEndian";
	ByteArray.LITTLE_ENDIAN="littleEndian";
	ByteArray.UNDEFINED_TYPE=0;
	ByteArray.NULL_TYPE=1;
	ByteArray.FALSE_TYPE=2;
	ByteArray.TRUE_TYPE=3;
	ByteArray.INTEGER_TYPE=4;
	ByteArray.DOUBLE_TYPE=5;
	ByteArray.STRING_TYPE=6;
	ByteArray.XML_TYPE=7;
	ByteArray.DATE_TYPE=8;
	ByteArray.ARRAY_TYPE=9;
	ByteArray.OBJECT_TYPE=10;
	ByteArray.AVMPLUSXML_TYPE=11;
	ByteArray.BYTEARRAY_TYPE=12;
	ByteArray.EMPTY_STRING="";
	ByteArray.UINT29_MASK=0x1FFFFFFF;
	ByteArray.INT28_MAX_VALUE=0x0FFFFFFF;
	ByteArray.INT28_MIN_VALUE=-268435456;
	return ByteArray;
})(Byte)


//class game.mvc.Action extends game.mvc.Sender
var Action=(function(_super){
	function Action(){
		Action.__super.call(this);
	}

	__class(Action,'game.mvc.Action',_super);
	var __proto=Action.prototype;
	__proto.execute=function(ba){}
	return Action;
})(Sender)


//class game.mvc.Session extends game.mvc.Sender
var Session=(function(_super){
	function Session(){
		Session.__super.call(this);;
	}

	__class(Session,'game.mvc.Session',_super);
	var __proto=Session.prototype;
	__proto.sessionUpdataEvent=function(type){
		App.eventManager.event(type,this);
		App.eventManager.on("CLEAR_SESSION_DATA",this,this.clearSessionData);
	}

	/**
	*游戏内的数据都会存在session里
	*如果切换账号 或者 被人踢下线 换其他号登陆 必须要求 session里的数据清空
	*/
	__proto.clearSessionData=function(){}
	return Session;
})(Sender)


//class huamao.mediator.AddHaoyouMediator extends game.mvc.Mediator
var AddHaoyouMediator=(function(_super){
	function AddHaoyouMediator(sprite){
		this.addHaoyou=null;
		AddHaoyouMediator.__super.call(this,sprite);
		this.addHaoyou=sprite;
		this.autoEvent.add("FIND_FRIEND_RESULT",this,this.onSet);
	}

	__class(AddHaoyouMediator,'huamao.mediator.AddHaoyouMediator',_super);
	var __proto=AddHaoyouMediator.prototype;
	__proto.onSet=function(arr){
		this.addHaoyou.refreshList(arr);
	}

	return AddHaoyouMediator;
})(Mediator)


//class huamao.mediator.BagBoxMediator extends game.mvc.Mediator
var BagBoxMediator=(function(_super){
	function BagBoxMediator(sprite){
		this.victoryBoxSession=null;
		this.victoryBoxAction=null;
		this.panel=null;
		BagBoxMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.autoEvent.add("BAG_BOX_FLUSH",this,this.onUpdate);
		this.panel.kaixiang.on("click",this,this.openBox);
		this.panel.sheqi.on("click",this,this.disBox);
		this.onUpdate();
	}

	__class(BagBoxMediator,'huamao.mediator.BagBoxMediator',_super);
	var __proto=BagBoxMediator.prototype;
	__proto.disBox=function(){
		if(this.panel.currData){
			this.victoryBoxAction.sendDisBox(this.panel.currData.boxId);
		}
		else{
			FlyUpTips.setTips("当前没有宝箱");
		}
	}

	__proto.openBox=function(){
		if(this.panel.currData){
			if(this.panel.currData.endTime<=GameUtils.GetServerTime()){
				this.victoryBoxAction.sendLingqu(this.panel.currData.boxId);
			}
			else{
				FlyUpTips.setTips("时间未到");
			}
		}
		else{
			FlyUpTips.setTips("当前没有宝箱");
		}
	}

	__proto.onUpdate=function(){
		this.panel.upData(this.victoryBoxSession.boxArr);
	}

	return BagBoxMediator;
})(Mediator)


//class huamao.mediator.BagEquipMediator extends game.mvc.Mediator
var BagEquipMediator=(function(_super){
	function BagEquipMediator(sprite){
		this.equipView=null;
		BagEquipMediator.__super.call(this,sprite);
		this.equipView=sprite;
		this.autoEvent.add("BAG_EQUIP_FLUSH",this,this.onUpdate);
	}

	__class(BagEquipMediator,'huamao.mediator.BagEquipMediator',_super);
	var __proto=BagEquipMediator.prototype;
	__proto.onUpdate=function(){
		this.equipView.flushData();
	}

	return BagEquipMediator;
})(Mediator)


//class huamao.mediator.BagItemMediator extends game.mvc.Mediator
var BagItemMediator=(function(_super){
	function BagItemMediator(sprite){
		this.itemView=null;
		BagItemMediator.__super.call(this,sprite);
		this.itemView=sprite;
		this.autoEvent.add("BAG_ITEM_FLUSH",this,this.onUpdate);
	}

	__class(BagItemMediator,'huamao.mediator.BagItemMediator',_super);
	var __proto=BagItemMediator.prototype;
	__proto.onUpdate=function(){
		this.itemView.flushData();
	}

	return BagItemMediator;
})(Mediator)


//class huamao.mediator.BattleFieldMediator extends game.mvc.SceneMediator
var BattleFieldMediator=(function(_super){
	function BattleFieldMediator(sprite){
		this.battleSession=null;
		this.battleScene=null;
		this.battleData=null;
		this.nowSpeedIndex=0;
		this.speedArr=[1,2,4];
		BattleFieldMediator.__super.call(this,sprite);
		this.battleScene=sprite;
		this.battleData=this.battleSession.battleData;
		this.autoEvent.add("GAME_OVER",this,this.gameOverFun);
		this.init();
	}

	__class(BattleFieldMediator,'huamao.mediator.BattleFieldMediator',_super);
	var __proto=BattleFieldMediator.prototype;
	__proto.gameOverFun=function(){
		this.clearFun();
	}

	__proto.resume=function(mediatorData){
		this.init();
	}

	/**
	*根据data初始化场景 这时候已经开屏
	*/
	__proto.init=function(){
		App.voiceManager.playMusic("bgm3.mp3");
		this.battleScene.setBattleData(this.battleData);
		if(this.battleData.isPlayBack){
			this.battleScene.btn0.clickHandler=new Handler(this,this.speedFun);
			this.battleScene.btn0.visible=true;
			this.initHero(this.battleData.nowCell.initDataArr);
			}else{
			this.battleScene.btn0.visible=false;
			var time=0;
			if(GameUtils.GetServerTime()> this.battleData.getEndTime()){
				time=-1;
				}else{
				time=(GameUtils.GetServerTime()-this.battleData.nowCell.startTime)*1000;
			}
			this.initHero(this.battleData.getNowTime(time));
		}
		if(this.battleData.nowCell.haveWallSoldiers){
			this.battleScene.showWall();
		}
		this.resetName();
		if(this.battleData.isGuide){
			this.battleScene.btn0.visible=false;
			this.battleScene.tuichu.visible=false;
			Laya.timer.once(10 *1000,this,this.disExitBtnFun);
		}
		this.battleScene.closeEnd();
		if(BattleFileScene.TEST==false){
			this.playMovie();
		}
		this.battleScene.tuichu.clickHandler=new Handler(this,this.clearFun);
		this.battleScene.on("HERO_DEAD",this,this.deadFun);
		if(this.battleData.isGuide){
			App.eventManager.event("ENTER_BATTLE");
		}
	}

	__proto.disExitBtnFun=function(){
		this.battleScene.tuichu.visible=true;
		this.battleScene.showJianTouFun();
	}

	__proto.deadFun=function(heroId){
		App.eventManager.on("GUIDE_GUIDE2FIGHT",this,this.continueFun);
		Laya.timer.once(500,this,this.delayFun,[heroId]);
	}

	__proto.delayFun=function(heroId){
		App.eventManager.event("GUIDE_FIGHT2GUIDE",heroId);
	}

	// }
	__proto.clickFun=function(){
		App.eventManager.event("GUIDE_GUIDE2FIGHT");
	}

	__proto.continueFun=function(){
		this.battleScene.continueFuHuo();
		this.playMovie();
	}

	__proto.clearFun=function(){
		this.battleScene.clear();
		this.nowSpeedIndex=0;
	}

	__proto.initHero=function(initDataArr){
		for (var b in initDataArr){
			var data=initDataArr[b];
			if(data){
				this.battleScene.setHero(data);
			}
		}
		this.battleScene.resetGroupSkill();
	}

	__proto.speedFun=function(){
		this.nowSpeedIndex++;
		this.nowSpeedIndex=TheGame.betweenArr(this.nowSpeedIndex,0,this.speedArr);
		this.battleScene.setSpeed(this.nowSpeedIndex);
	}

	__proto.playMovie=function(){
		this.battleScene.setAllBlood();
		this.battleScene.setTurn(this.battleData.nowTurn);
		var arr=this.battleData.getOneAtkArr();
		if(arr==null){
			if(this.battleData.haveNextBattle()){
				this.battleData.changeNextBattle();
				this.resetName();
				this.battleScene.clearHero();
				this.initHero(this.battleData.nowCell.initDataArr);
				this.battleData.nowActionData=null;
				this.battleScene.setAllBlood();
				this.playMovie();
				return;
			}
			this.battleScene.showEnd();
			App.voiceManager.playSound("战斗胜利欢呼.wav");
			return;
		}
		this.setArr(arr);
	}

	/**
	*重置攻防的名字
	*/
	__proto.resetName=function(){
		this.battleScene.setAtkName(this.battleData.nowCell.atkName);
		this.battleScene.setDefName(this.battleData.nowCell.defName);
		if(this.battleData.nowCell.defName==""){
			var sys=ConfigManager.getConfig("sys_city.txt",this.battleData.nowCell.citiId);
			this.battleScene.setDefName(sys.cityName+"守军");
		}
	}

	__proto.setArr=function(arr){
		this.battleScene.scaleManager.setNowSpeedScale(this.speedArr[this.nowSpeedIndex]);
		this.battleScene.setTurn(this.battleData.nowTurn);
		this.battleScene.setArr(arr);
		this.resetAllBlood();
		var atkData=arr[0];
		var time=0;
		if(atkData.dataType==1){
			if(atkData.heroIndex==-1){
				time=BattleData.getTime(11);
				}else{
				if(atkData.skillId > 0){
					time=BattleData.getTime(12);
					}else{
					time=BattleData.getTime(11);
				}
			}
			}else if(atkData.dataType==0){
			time=BattleData.getTime(13);
		}
		if(this.battleData.isGuide){
			var obj=this.deadHeroId(arr);
			if(obj[4016]==1 || obj[2019]==1 || obj[4001]==1){
				return;
			}
		}
		this.battleScene.scaleManager.addTimer(time,this,this.playMovie);
	}

	__proto.deadHeroId=function(arr){
		var obj={};
		for (var i=0;i < arr.length;i++){
			var data=arr[i];
			if(data.disType==2){
				if(data.heroIndex !=-1){
					if(data.nowHp==0){
						var hero=this.battleScene.heroArr[data.heroIndex];
						obj[hero.data.heroId]=1;
					}
				}
			}
		}
		return obj;
	}

	/**重置两个人的血量 */
	__proto.resetAllBlood=function(){}
	BattleFieldMediator.getTime=function(time){
		return time/BattleFieldMediator.nowSpeedScale;
	}

	BattleFieldMediator.nowSpeedScale=1;
	return BattleFieldMediator;
})(SceneMediator)


//class huamao.mediator.BeizhuMediator extends game.mvc.Mediator
var BeizhuMediator=(function(_super){
	function BeizhuMediator(sprite){
		BeizhuMediator.__super.call(this,sprite);
	}

	__class(BeizhuMediator,'huamao.mediator.BeizhuMediator',_super);
	return BeizhuMediator;
})(Mediator)


//class huamao.mediator.BuidViewMediator extends game.mvc.Mediator
var BuidViewMediator=(function(_super){
	function BuidViewMediator(sprite){
		this.buildView=null;
		BuidViewMediator.__super.call(this,sprite);
		this.buildView=sprite;
		this.autoEvent.add("UPDATA_CITY_LIST",this,this.upDataCityList);
	}

	__class(BuidViewMediator,'huamao.mediator.BuidViewMediator',_super);
	var __proto=BuidViewMediator.prototype;
	__proto.upDataCityList=function(){
		this.buildView.flushData();
	}

	return BuidViewMediator;
})(Mediator)


//class huamao.mediator.CDkeyMediator extends game.mvc.Mediator
var CDkeyMediator=(function(_super){
	function CDkeyMediator(sprite){
		CDkeyMediator.__super.call(this,sprite);
	}

	__class(CDkeyMediator,'huamao.mediator.CDkeyMediator',_super);
	return CDkeyMediator;
})(Mediator)


//class huamao.mediator.ChuzhengMediator extends game.mvc.Mediator
var ChuzhengMediator=(function(_super){
	function ChuzhengMediator(sprite){
		this.chuzheng=null;
		ChuzhengMediator.__super.call(this,sprite);
		this.chuzheng=sprite;
		this.autoEvent.add("SET_SELECT_WUJIANG",this,this.onSet);
		this.autoEvent.add("CANLE_BUZHENG_ITEM",this,this.onCancelItem);
	}

	__class(ChuzhengMediator,'huamao.mediator.ChuzhengMediator',_super);
	var __proto=ChuzhengMediator.prototype;
	__proto.onSet=function(idx,data){
		this.chuzheng.onSet(idx,data);
	}

	__proto.onCancelItem=function(index){
		this.chuzheng.onCancelItem(index);
	}

	return ChuzhengMediator;
})(Mediator)


//class huamao.mediator.CityBuduiMediator extends game.mvc.Mediator
var CityBuduiMediator=(function(_super){
	function CityBuduiMediator(sprite){
		this._budui=null;
		this.mapCitySession=null;
		CityBuduiMediator.__super.call(this,sprite);
		this._budui=sprite;
		this.autoEvent.add("HEROUPDATE",this,this.onUpdate);
		this.autoEvent.add("UPDATE_CITY_INFO",this,this.onSuccess);
		this.autoEvent.add("ZHAOBINGMAIMA_TIMES",this,this.onTimes);
		this.autoEvent.add("DIAOBING_SINGLE",this,this.onSingle);
		this.autoEvent.add("SWAP_HEROS",this,this.onSwap);
	}

	__class(CityBuduiMediator,'huamao.mediator.CityBuduiMediator',_super);
	var __proto=CityBuduiMediator.prototype;
	__proto.onSwap=function(hero1,hero2){
		this._budui.swap(hero1,hero2);
	}

	__proto.onSingle=function(heroId,num){
		this._budui.onSingle(heroId,num);
	}

	__proto.onTimes=function(){
		this._budui.updateTimes();
	}

	__proto.onUpdate=function(heroId){
		this._budui.update();
	}

	__proto.onSuccess=function(cityData,playerData){
		this._budui.onSuccess(cityData,playerData);
	}

	return CityBuduiMediator;
})(Mediator)


//class huamao.mediator.CityBuildCreateMediator extends game.mvc.Mediator
var CityBuildCreateMediator=(function(_super){
	function CityBuildCreateMediator(sprite){
		CityBuildCreateMediator.__super.call(this,sprite);
	}

	__class(CityBuildCreateMediator,'huamao.mediator.CityBuildCreateMediator',_super);
	return CityBuildCreateMediator;
})(Mediator)


//class huamao.mediator.CityBuildLvUpMediator extends game.mvc.Mediator
var CityBuildLvUpMediator=(function(_super){
	function CityBuildLvUpMediator(sprite){
		this.lvup=null;
		CityBuildLvUpMediator.__super.call(this,sprite);
		this.lvup=sprite;
	}

	__class(CityBuildLvUpMediator,'huamao.mediator.CityBuildLvUpMediator',_super);
	return CityBuildLvUpMediator;
})(Mediator)


//class huamao.mediator.CityBuildRemoveMediator extends game.mvc.Mediator
var CityBuildRemoveMediator=(function(_super){
	function CityBuildRemoveMediator(sprite){
		CityBuildRemoveMediator.__super.call(this,sprite);
	}

	__class(CityBuildRemoveMediator,'huamao.mediator.CityBuildRemoveMediator',_super);
	return CityBuildRemoveMediator;
})(Mediator)


//class huamao.mediator.CityMediator extends game.mvc.Mediator
var CityMediator=(function(_super){
	function CityMediator(sprite){
		CityMediator.__super.call(this,sprite);
		this.autoEvent.add("GOTO_CITY_INNER2",this,this.enterCityFun);
	}

	__class(CityMediator,'huamao.mediator.CityMediator',_super);
	var __proto=CityMediator.prototype;
	__proto.enterCityFun=function(){
		this.sprite.close();
	}

	//App.eventManager.on(YouEvent.EXIT_CITY_INNER2,this,exitCityFun);
	__proto.exitCityFun=function(){}
	return CityMediator;
})(Mediator)


//class huamao.mediator.CityPanelMediator extends game.mvc.Mediator
var CityPanelMediator=(function(_super){
	function CityPanelMediator(sprite){
		this.cityPanel=null;
		CityPanelMediator.__super.call(this,sprite);
		this.cityPanel=sprite;
		this.autoEvent.add("UPDATA_CITY_LIST",this,this.flushBtn);
		this.autoEvent.add("GOTO_CITY_INNER2",this,this.enterCityFun);
	}

	__class(CityPanelMediator,'huamao.mediator.CityPanelMediator',_super);
	var __proto=CityPanelMediator.prototype;
	__proto.flushBtn=function(){
		this.cityPanel.flushBtn();
	}

	__proto.enterCityFun=function(){
		App.eventManager.on("EXIT_CITY_INNER2",this,this.exitCityFun);
		this.sprite.close();
	}

	//退出城池内部 重新显示
	__proto.exitCityFun=function(){
		this.sprite.popup();
		App.eventManager.off("EXIT_CITY_INNER2",this,this.exitCityFun);
	}

	return CityPanelMediator;
})(Mediator)


//class huamao.mediator.Dianzan2Mediator extends game.mvc.Mediator
var Dianzan2Mediator=(function(_super){
	function Dianzan2Mediator(sprite){
		Dianzan2Mediator.__super.call(this,sprite);
	}

	__class(Dianzan2Mediator,'huamao.mediator.Dianzan2Mediator',_super);
	return Dianzan2Mediator;
})(Mediator)


//class huamao.mediator.DianzanMediator extends game.mvc.Mediator
var DianzanMediator=(function(_super){
	function DianzanMediator(sprite){
		this.playerInfoAction=null;
		this.dianzan=null;
		this.dianZanSession=null;
		this.defaultText=null;
		DianzanMediator.__super.call(this,sprite);
		this.dianzan=sprite;
		this.playerInfoAction.getDianzanList();
		this.autoEvent.add("DIANZAN_LIST",this,this.onupdate);
		this.autoEvent.add("DIANZAN_CHANGE",this,this.onupdate);
		this.dianzan.ming.on("input",this,this.inputFun);
		this.defaultText=this.dianzan.ming.text;
		this.dianzan.ming.on("focus",this,this.focusFun);
		this.dianzan.ming.on("blur",this,this.blurFun);
	}

	__class(DianzanMediator,'huamao.mediator.DianzanMediator',_super);
	var __proto=DianzanMediator.prototype;
	__proto.blurFun=function(){
		if(this.dianzan.ming.text==""){
			this.dianzan.ming.text=this.defaultText;
		}
	}

	__proto.focusFun=function(){
		if(this.dianzan.ming.text==this.defaultText){
			this.dianzan.ming.text="";
		}
	}

	__proto.inputFun=function(){
		var text=this.dianzan.ming.text;
		if(text==""){
			this.onupdate();
			return;
		};
		var arr=[];
		for (var i=0;i < this.dianZanSession.dianZanDataArr.length;i++){
			var data=this.dianZanSession.dianZanDataArr [i];
			if(data.playerName.indexOf(text)!=-1){
				arr.push(data);
			}
		}
		this.dianzan.setData(arr);
	}

	__proto.onupdate=function(){
		this.dianzan.setData(this.dianZanSession.dianZanDataArr);
	}

	return DianzanMediator;
})(Mediator)


//class huamao.mediator.DiaobingMediator extends game.mvc.Mediator
var DiaobingMediator=(function(_super){
	function DiaobingMediator(sprite){
		DiaobingMediator.__super.call(this,sprite);
	}

	__class(DiaobingMediator,'huamao.mediator.DiaobingMediator',_super);
	return DiaobingMediator;
})(Mediator)


//class huamao.mediator.DropGiftMediator extends game.mvc.Mediator
var DropGiftMediator=(function(_super){
	function DropGiftMediator(sprite){
		this.dropGiftPanel=null;
		this.dropGiftSession=null;
		this.mapCityAction=null;
		DropGiftMediator.__super.call(this,sprite);
		this.dropGiftPanel=sprite;
		this.onUpdate();
		this.autoEvent.add("VICTORYDROPGET",this,this.sendGiftGet);
		this.autoEvent.add("FLUSHDROPGIFT",this,this.onUpdate);
	}

	__class(DropGiftMediator,'huamao.mediator.DropGiftMediator',_super);
	var __proto=DropGiftMediator.prototype;
	__proto.onUpdate=function(){
		this.dropGiftPanel.update(this.dropGiftSession.giftData);
	}

	__proto.sendGiftGet=function(){
		this.mapCityAction.sendDropGift();
	}

	return DropGiftMediator;
})(Mediator)


//class huamao.mediator.DuoBaoJiLuMediator extends game.mvc.Mediator
var DuoBaoJiLuMediator=(function(_super){
	function DuoBaoJiLuMediator(sprite){
		this.duoBaoJiLuPanel=null;
		this.duoBaoSession=null;
		DuoBaoJiLuMediator.__super.call(this,sprite);
		this.duoBaoJiLuPanel=sprite;
		this.onUpdate();
	}

	__class(DuoBaoJiLuMediator,'huamao.mediator.DuoBaoJiLuMediator',_super);
	var __proto=DuoBaoJiLuMediator.prototype;
	__proto.onUpdate=function(){
		this.duoBaoJiLuPanel.update(this.duoBaoSession.drawListArr);
	}

	return DuoBaoJiLuMediator;
})(Mediator)


//class huamao.mediator.DuoBaoMediator extends game.mvc.Mediator
var DuoBaoMediator=(function(_super){
	function DuoBaoMediator(sprite){
		this.duoBaoAction=null;
		this.duoBaoSession=null;
		this.panel=null;
		this.bagSession=null;
		DuoBaoMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.upData();
		this.autoEvent.add("DUOBAOFlUSH",this,this.upData);
		this.autoEvent.add("DUOBAOSEND",this,this.duoBaoSend);
		this.autoEvent.add("DUOBAOBACK",this,this.dataBack);
		this.autoEvent.add("DUOBAOBAOXIANG",this,this.duoBaoBAOXIANG);
		this.autoEvent.add("DUOBAOADDJUAN",this,this.timerLater);
	}

	__class(DuoBaoMediator,'huamao.mediator.DuoBaoMediator',_super);
	var __proto=DuoBaoMediator.prototype;
	__proto.upData=function(){
		this.panel.upData(this.duoBaoSession.duoBaoData[0]);
	}

	__proto.duoBaoSend=function(num){
		console.log("夺宝次数："+num);
		this.duoBaoAction.onDuoBaoGift(num);
	}

	__proto.duoBaoBAOXIANG=function(num){console.log("夺宝xiang次数："+num);
		this.duoBaoAction.onBuyGift(num);
	}

	__proto.dataBack=function(num){
		this.panel.zhuanDraw(num);
	}

	__proto.timerLater=function(count){
		this.panel.oneDB(count);
		console.log("count-->"+count);
	}

	return DuoBaoMediator;
})(Mediator)


//class huamao.mediator.FenxiangMediator extends game.mvc.Mediator
var FenxiangMediator=(function(_super){
	function FenxiangMediator(sprite){
		FenxiangMediator.__super.call(this,sprite);
	}

	__class(FenxiangMediator,'huamao.mediator.FenxiangMediator',_super);
	return FenxiangMediator;
})(Mediator)


//class huamao.mediator.GameOverMediator extends game.mvc.Mediator
var GameOverMediator=(function(_super){
	function GameOverMediator(sprite){
		GameOverMediator.__super.call(this,sprite);
	}

	__class(GameOverMediator,'huamao.mediator.GameOverMediator',_super);
	return GameOverMediator;
})(Mediator)


//class huamao.mediator.HaoyouMediator extends game.mvc.Mediator
var HaoyouMediator=(function(_super){
	function HaoyouMediator(sprite){
		this.haoyou=null;
		HaoyouMediator.__super.call(this,sprite);
		this.haoyou=sprite;
		this.autoEvent.add("UPDATE_FRIEND",this,this.onUpdate);
		this.autoEvent.add("DELETE_FRIEND",this,this.onDelete);
		this.autoEvent.add("ADD_CHAT_MSG",this,this.addMsg);
	}

	__class(HaoyouMediator,'huamao.mediator.HaoyouMediator',_super);
	var __proto=HaoyouMediator.prototype;
	__proto.onDelete=function(friendId){
		this.haoyou.onDelete(friendId);
	}

	__proto.onUpdate=function(friendId){
		this.haoyou.refresh();
	}

	__proto.addMsg=function(data){
		this.haoyou.addMsg(data,true);
	}

	return HaoyouMediator;
})(Mediator)


//class huamao.mediator.HeroInfoArmsTabMediator extends game.mvc.Mediator
var HeroInfoArmsTabMediator=(function(_super){
	function HeroInfoArmsTabMediator(sprite){
		this.heroData=null;
		this.mainPlayerSession=null;
		this.wuJiangSession=null;
		HeroInfoArmsTabMediator.__super.call(this,sprite);
		this.autoEvent.add("SELECT_HERO",this,this.setHeroData);
		this.autoEvent.add("HEROUPDATE",this,this.heroUpdateFun);
		this.dialog().daquan.clickHandler=new Handler(this,this.openArmsFun);
	}

	__class(HeroInfoArmsTabMediator,'huamao.mediator.HeroInfoArmsTabMediator',_super);
	var __proto=HeroInfoArmsTabMediator.prototype;
	__proto.heroUpdateFun=function(heroId){
		if(heroId==this.heroData.heroId){
			this.setHeroData(this.heroData);
		}
	}

	__proto.zhuanZhiFun=function(){
		if(this.mainPlayerSession.mainPlayerData.job < 1004){
			FlyUpTips.setTips("官职达到县令后可开启转职系统");
			return;
		}
		(App.dialogManager.showMiniDialog(ZhuanZhiDialog)).setHeroId(this.heroData.heroId);
	}

	__proto.openArmsFun=function(){
		App.dialogManager.showMiniDialog(HeroArmsDialog);
	}

	__proto.dialog=function(){
		return this.sprite;
	}

	__proto.setHeroData=function(heroData){
		this.heroData=heroData;
		this.initList();
	}

	__proto.initList=function(){
		var heroId=this.heroData.heroId;
		var soldierType=this.heroData.soldierType;
		var sysHero=ConfigManager.getConfig("sys_hero.txt",heroId);
		var forceLen=sysHero.forceArr.length;
		this.dialog().initList(heroId,sysHero.forceArr,this.heroData.unlockSoldier,this.heroData.soldierType);
	}

	HeroInfoArmsTabMediator.Need_Title_XianLing=1004;
	return HeroInfoArmsTabMediator;
})(Mediator)


//class huamao.mediator.HeroInfoEquipTabMediator extends game.mvc.Mediator
var HeroInfoEquipTabMediator=(function(_super){
	function HeroInfoEquipTabMediator(sprite){
		this.mainPlayerSession=null;
		this.bagSession=null;
		this.wuJiangAction=null;
		this.heroData=null;
		this.openFunctionSession=null;
		this.disMap={};
		HeroInfoEquipTabMediator.__super.call(this,sprite);
		this.autoEvent.add("SELECT_HERO",this,this.setHeroData);
		this.autoEvent.add("HEROUPDATE",this,this.updateFun);
		this.autoEvent.add("HERO_EQUIP_CHANGE",this,this.equipChangeFun);
		this.autoEvent.add("BAG_EQUIP_FLUSH",this,this.bagChanegFun);
		this.autoEvent.add("FLUSH_PLAYER_JOB",this,this.flushReset);
		this.dialog().shengji.clickHandler=new Handler(this,this.lvUpFun);
		this.dialog().shengji.on("mousedown",this,this.onStart);
		this.dialog().box1.on("click",this,this.equipFun,[1,this.dialog().box1]);
		this.dialog().box2.on("click",this,this.equipFun,[2,this.dialog().box2]);
		this.dialog().box3.on("click",this,this.equipFun,[3,this.dialog().box2]);
		this.dialog().jinjie.clickHandler=new Handler(this,this.soulLvUpFun);
		this.dialog().reset.clickHandler=new Handler(this,this.resetCB);
		this.disMap[0]="勇";
		this.disMap[1]="御";
		this.disMap[2]="智";
		this.disMap[3]="威";
		this.dialog().on("display",this,this.onDisplayFun);
		this.dialog().on("undisplay",this,this.onUnDisplayFun);
		this.onDisplayFun();
	}

	__class(HeroInfoEquipTabMediator,'huamao.mediator.HeroInfoEquipTabMediator',_super);
	var __proto=HeroInfoEquipTabMediator.prototype;
	//武将重置
	__proto.resetCB=function(){
		var tips=App.dialogManager.showMiniDialog(HeroReset,true,true);
		tips.setHeroData(this.heroData);
	}

	__proto.onUnDisplayFun=function(){
		Laya.stage.off("mouseup",this,this.onStop);
		Laya.stage.off("mouseout",this,this.onStop);
	}

	__proto.onDisplayFun=function(){
		Laya.stage.on("mouseup",this,this.onStop);
		Laya.stage.on("mouseout",this,this.onStop);
	}

	__proto.bagChanegFun=function(){
		this.resetEquip();
	}

	__proto.equipChangeFun=function(data){
		var str="";
		for (var i=0;i < data.dataArr.length;i++){
			var number=data.dataArr[i];
			var text=PropertyChangeData.arr[i];
			var ss=this.getTip(number,text);
			if(number==0){
				continue ;
			}
			if(number > 0){
				ss=TheGame.FONT(ss,"#00ff00",25,null);
				}else{
				ss=TheGame.FONT(ss,"#ff0000",25,null);
			}
			str+=("<br/>"+ss);
		}
		FlyUpTips.setHtml(str);
	}

	__proto.getTip=function(value,text){
		if(value==0){
			return "";
		}
		return text+": "+((value>0)?("+"+value):(value))+" ";
	}

	__proto.soulLvUpFun=function(){
		if(this.openFunctionSession.isFunction("jinjie")){
			return;
		};
		var key=this.heroData.sysHero.heroColor+"_"+this.heroData.heroStar;
		var sys=ConfigManager.getConfig("sys_hero_progress.txt",key);
		if(sys.nextStar==-1){
			FlyUpTips.setTips("已满星");
			return;
		};
		var dialog=App.dialogManager.showMiniDialog(SoulLvUpDialog,true,true);
		dialog.setHeroData(this.heroData);
	}

	__proto.equipFun=function(type,box){
		var data=this.bagSession.getEquipByPart(this.heroData.heroId,type);
		if(data){
			var replaceEquipDialog=App.dialogManager.showMiniDialog(ReplaceEquipDialog,true,true);
			replaceEquipDialog.setBagData(data);
			}else{
			var openFunctionSession=App.getSession("openFunctionSession");
			if(openFunctionSession.isFunction("shangdian")){
				return;
			};
			var dialog=App.dialogManager.showMiniDialog(EquipItemDialog,true,true);
			dialog.setType(type,this.heroData.heroId);
		}
	}

	__proto.updateFun=function(heroId){
		if(heroId==this.heroData.heroId){
			this.setHeroData(this.heroData);
		}
	}

	__proto.onStop=function(){
		Laya.timer.clear(this,this.lvUpFun);
	}

	__proto.onStart=function(){
		Laya.timer.loop(500,this,this.lvUpFun);
	}

	__proto.lvUpFun=function(){
		console.log("aaaaaaaaaaaaaaaaaaaaa");
		if(this.openFunctionSession.isFunction("shengji")){
			return;
		}
		if(this.heroData.heroLv >=this.mainPlayerSession.mainPlayerData.Lv){
			FlyUpTips.setTips("英雄等级不能超过玩家等级");
			return;
		};
		var sys=ConfigManager.getConfig("sys_level_hero.txt",this.heroData.heroLv);
		if(sys==null){
			FlyUpTips.setTips("已经达到最高等级");
			return;
		}
		if(sys.heroExp > this.mainPlayerSession.mainPlayerData.heroExp){
			FlyUpTips.setTips("经验值不够");
			return;
		}
		App.eventManager.event("HEROLVMC");
		this.wuJiangAction.sendHeroLvUp(this.heroData.heroId);
	}

	__proto.dialog=function(){
		return this.sprite;
	}

	__proto.setHeroData=function(heroData){
		this.heroData=heroData;
		this.dialog().setHeroData(heroData);
		this.dialog().setExp(this.mainPlayerSession.mainPlayerData.heroExp);
		var sys=ConfigManager.getConfig("sys_level_hero.txt",heroData.heroLv);
		this.dialog().setNeedExp(sys.heroExp);
		this.dialog().setMaxSoul(this.bagSession.getItemNumByItemId(8001));
		this.dialog().setStar(heroData.heroStar);
		this.resetEquip();
		this.flushReset();
	}

	__proto.flushReset=function(){
		var curjob=this.mainPlayerSession.mainPlayerData.job;
		if(curjob >=1006){
			if(this.heroData.heroStar > 0){
				this.dialog().reset.visible=true;
				}else{
				this.dialog().reset.visible=false;
			}
			}else{
			this.dialog().reset.visible=false;
		}
	}

	__proto.resetEquip=function(){
		this.dialog().setEquip(this.bagSession.getEquipByHeroId(this.heroData.heroId));
	}

	return HeroInfoEquipTabMediator;
})(Mediator)


//class huamao.mediator.HeroInfoLegionTabMediator extends game.mvc.Mediator
var HeroInfoLegionTabMediator=(function(_super){
	function HeroInfoLegionTabMediator(sprite){
		this.wuJiangAction=null;
		this.wuJiangSession=null;
		this.heroData=null;
		this.sysTips=null;
		this.mainPlayerSession=null;
		HeroInfoLegionTabMediator.__super.call(this,sprite);
		this.autoEvent.add("SELECT_HERO",this,this.setHeroData);
		this.autoEvent.add("ADDLEGION",this,this.addLegion);
		this.autoEvent.add("DELETELEGION",this,this.deleteLegion);
		this.dialog().meika0.on("click",this,this.seleFun);
		this.dialog().meika1.on("click",this,this.seleFun);
		this.dialog().chakan.on("click",this,this.chaKanFun);
		this.dialog().tuijian.on("click",this,this.tuiJianFun);
		this.dialog().zhujiang.on("click",this,this.tuiJianFun);
		this.dialog().wenhao.on("click",this,this.tipsFun);
		this.sysTips=ConfigManager.getConfig("sys_tips.txt",3001);
	}

	__class(HeroInfoLegionTabMediator,'huamao.mediator.HeroInfoLegionTabMediator',_super);
	var __proto=HeroInfoLegionTabMediator.prototype;
	__proto.tipsFun=function(){
		FlyLittleUpTips.setTips(this.sysTips.tipsDescribe);
	}

	__proto.tuiJianFun=function(){
		var dialog=App.dialogManager.showMiniDialog(TuijianWujiang,true,true);
		dialog.setData(this.heroData.heroId,1);
	}

	__proto.chaKanFun=function(){
		var hData=this.wuJiangSession.getHero(this.heroData.masterId);
		App.eventManager.event("CHAKANZHUJIANG",hData);
	}

	__proto.deleteLegion=function(_heroId){
		this.dialog().upDataLegion(_heroId);
	}

	__proto.addLegion=function(_heroId){
		this.dialog().upDataLegion(_heroId);
	}

	__proto.seleFun=function(){
		if(this.mainPlayerSession.mainPlayerData.job>=1004){
			var listPanel=App.dialogManager.showMiniDialog(LegionListPanel,true,true);
			listPanel.setData(this.heroData);
		}
	}

	__proto.setHeroData=function(_heroData){
		this.heroData=_heroData;
		this.dialog().upDataLegion(this.heroData.heroId);
	}

	__proto.dialog=function(){
		return this.sprite;
	}

	return HeroInfoLegionTabMediator;
})(Mediator)


//class huamao.mediator.HeroInfoSkillTabMediator extends game.mvc.Mediator
var HeroInfoSkillTabMediator=(function(_super){
	function HeroInfoSkillTabMediator(sprite){
		this.wuJiangSession=null;
		HeroInfoSkillTabMediator.__super.call(this,sprite);
		this.autoEvent.add("SELECT_HERO",this,this.setHeroData);
	}

	__class(HeroInfoSkillTabMediator,'huamao.mediator.HeroInfoSkillTabMediator',_super);
	var __proto=HeroInfoSkillTabMediator.prototype;
	__proto.setHeroData=function(heroData){
		this.dialog().setSkill(heroData.sysHero.heroDefaultSkill);
		var arr=[];
		for (var i=0 ,len=heroData.sysHero.mixSkillArr.length;i < len;i++){
			var sys=ConfigManager.getConfig("sys_skill_mix.txt",heroData.sysHero.mixSkillArr[i]);
			var skillName=this.getHtml(sys.mixSkillName+":","#e3a915");
			arr.push(skillName);
			var str="";
			for (var j=0,len2=sys.mixHeroArr.length;j < len2;j++){
				var heroId=sys.mixHeroArr[j];
				var sysHero=ConfigManager.getConfig("sys_hero.txt",heroId);
				var color=(this.wuJiangSession.getHero(heroId)?"#ffdeb9":"#959595");
				var splitSymbol=((j==(len2-1))?"":"、");
				str+=(this.getHtml(sysHero.heroName+splitSymbol ,color));
			};
			var str2="同时上场,"+SysTalent.getName(sys.property)+"+"+SysTalent.getValue(sys.property,sys.add);
			str+=this.getHtml(str2,"#ffdeb9");
			arr.push(str);
		}
		this.dialog().setMix(arr);
	}

	__proto.getHtml=function(str,color){
		return TheGame.FONT(str,color,26,HeroInfoSkillTabMediator.FONT_FAMILY);
	}

	__proto.dialog=function(){
		return this.sprite;
	}

	HeroInfoSkillTabMediator.FONT_SIZE=26;
	HeroInfoSkillTabMediator.FONT_FAMILY=null;
	HeroInfoSkillTabMediator.NORMAL="#ffdeb9";
	HeroInfoSkillTabMediator.NO_HAVE="#959595";
	HeroInfoSkillTabMediator.HAVE="#ffdeb9";
	HeroInfoSkillTabMediator.TITLE_NAME="#e3a915";
	return HeroInfoSkillTabMediator;
})(Mediator)


//class huamao.mediator.HuodongMediator extends game.mvc.Mediator
var HuodongMediator=(function(_super){
	function HuodongMediator(sprite){
		this.panel=null;
		HuodongMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.autoEvent.add("CANCELCHA",this,this.cancelCha);
	}

	__class(HuodongMediator,'huamao.mediator.HuodongMediator',_super);
	var __proto=HuodongMediator.prototype;
	__proto.cancelCha=function(boo){
		this.panel.unEable(boo);
	}

	return HuodongMediator;
})(Mediator)


//class huamao.mediator.HuoyueDayMediator extends game.mvc.Mediator
var HuoyueDayMediator=(function(_super){
	function HuoyueDayMediator(sprite){
		this.activitySession=null;
		this.huoyueDaySession=null;
		this.huoyueDayAction=null;
		this.taskAction=null;
		this.huoyueDayView=null;
		HuoyueDayMediator.__super.call(this,sprite);
		this.huoyueDayView=sprite;
		this.huoyueDayView.getGiftData(this.activitySession.huoyueDayDataArr);
		this.onUpdate();
		this.autoEvent.add("HUOYUEDAY",this,this.onUpdate);
		this.autoEvent.add("HUOYUEDAYGIFT",this,this.onGetGift);
	}

	__class(HuoyueDayMediator,'huamao.mediator.HuoyueDayMediator',_super);
	var __proto=HuoyueDayMediator.prototype;
	__proto.onUpdate=function(){
		console.log("huoyueDaySession.arrData:"+this.huoyueDaySession.arrData);
		this.huoyueDayView.onUpdate(this.huoyueDaySession.arrData,this.huoyueDaySession.huoYueDu,this.huoyueDaySession.giftArr);
	}

	__proto.onGetGift=function(type,actId){
		this.taskAction.sendWeekTask(type,actId);
	}

	return HuoyueDayMediator;
})(Mediator)


//class huamao.mediator.HuoyueMediator extends game.mvc.Mediator
var HuoyueMediator=(function(_super){
	function HuoyueMediator(sprite){
		this.huoyueView=null;
		this.huoyueSession=null;
		this.activitySession=null;
		this.taskAction=null;
		HuoyueMediator.__super.call(this,sprite);
		this.huoyueView=sprite;
		this.onUpdate();
		this.autoEvent.add("HUOYUEWEEK",this,this.onUpdate);
		this.autoEvent.add("HUOYUEGIFT",this,this.onGiftUpdate);
	}

	__class(HuoyueMediator,'huamao.mediator.HuoyueMediator',_super);
	var __proto=HuoyueMediator.prototype;
	__proto.onUpdate=function(){
		this.huoyueView.update(this.activitySession.huoyueDataArr,this.huoyueSession.arrData,this.huoyueSession.huoyuedu,this.huoyueSession.giftArr)
	}

	__proto.onGiftUpdate=function(num,activityId){
		this.taskAction.sendWeekTask(num,activityId);
	}

	HuoyueMediator.StatusShow=1;
	return HuoyueMediator;
})(Mediator)


//class huamao.mediator.JijinMediator extends game.mvc.Mediator
var JijinMediator=(function(_super){
	function JijinMediator(sprite){
		this.panel=null;
		this.activityAction=null;
		this.activitySession=null;
		JijinMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.autoEvent.add("HUODONGUPDATA",this,this.upData);
		this.panel.chaozhi.on("click",this,this.sendGoumai);
	}

	__class(JijinMediator,'huamao.mediator.JijinMediator',_super);
	var __proto=JijinMediator.prototype;
	__proto.sendGoumai=function(){
		var arr=this.activitySession.sysjijinData.activityTarget.split(",");
		var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true,false,false);
		alert.setAll("","确定花费"+arr[1]+"元宝购买基金吗?",new Handler(this,this.goumaiFun));
	}

	__proto.goumaiFun=function(){
		this.activityAction.sendGoumai();
	}

	__proto.upData=function(){
		this.panel.upData();
	}

	return JijinMediator;
})(Mediator)


//class huamao.mediator.KaBaoMediator extends game.mvc.Mediator
var KaBaoMediator=(function(_super){
	function KaBaoMediator(sprite){
		this.kaBaoPanel=null;
		this.activityAction=null;
		this.activitySession=null;
		KaBaoMediator.__super.call(this,sprite);
		this.kaBaoPanel=sprite;
		this.autoEvent.add("HUODONGUPDATA",this,this.onUpdate);
		this.autoEvent.add("KABAOBUYGIFT",this,this.buyGift);
		this.onUpdate();
	}

	__class(KaBaoMediator,'huamao.mediator.KaBaoMediator',_super);
	var __proto=KaBaoMediator.prototype;
	__proto.onUpdate=function(){
		this.kaBaoPanel.onUpdate(this.activitySession.kaBaoDataArr);
	}

	__proto.buyGift=function(id){
		this.activityAction.sendKaBaoLingQu(id);
	}

	return KaBaoMediator;
})(Mediator)


//class huamao.mediator.LeijiMediator extends game.mvc.Mediator
var LeijiMediator=(function(_super){
	function LeijiMediator(sprite){
		this.panel=null;
		LeijiMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.autoEvent.add("HUODONGUPDATA",this,this.upData);
	}

	__class(LeijiMediator,'huamao.mediator.LeijiMediator',_super);
	var __proto=LeijiMediator.prototype;
	__proto.upData=function(){
		this.panel.upData();
	}

	return LeijiMediator;
})(Mediator)


//class huamao.mediator.LeijiNewMediator extends game.mvc.Mediator
var LeijiNewMediator=(function(_super){
	function LeijiNewMediator(sprite){
		this.panel=null;
		LeijiNewMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.autoEvent.add("HUODONGUPDATA",this,this.upData);
		this.autoEvent.add("LEIJINEWCZGIFT",this,this.getGift);
	}

	__class(LeijiNewMediator,'huamao.mediator.LeijiNewMediator',_super);
	var __proto=LeijiNewMediator.prototype;
	__proto.upData=function(){
		this.panel.upData();
	}

	__proto.getGift=function(){}
	return LeijiNewMediator;
})(Mediator)


//class huamao.mediator.MailBattleMediator extends game.mvc.Mediator
var MailBattleMediator=(function(_super){
	function MailBattleMediator(sprite){
		MailBattleMediator.__super.call(this,sprite);
	}

	__class(MailBattleMediator,'huamao.mediator.MailBattleMediator',_super);
	return MailBattleMediator;
})(Mediator)


//class huamao.mediator.MessageMediator extends game.mvc.Mediator
var MessageMediator=(function(_super){
	function MessageMediator(sprite){
		this.messagePanel=null;
		MessageMediator.__super.call(this,sprite);
		this.messagePanel=sprite;
		this.autoEvent.add("FLUSH_PLAYER_LV",this,this.flushLvCB);
		this.autoEvent.add("FLUSH_PLAYER_EXP",this,this.flushExpCB);
		this.autoEvent.add("FLUSH_PLAYER_JOB",this,this.flushOfficalCB);
		this.autoEvent.add("FLUSH_PLAYER_JOBSCORE",this,this.flushOfficalScoreCB);
		this.autoEvent.add("FLUSH_PLAYER_GAMETIMES",this,this.flushGameTimesCB);
		this.autoEvent.add("FLUSH_PLAYER_WINTIMES",this,this.flushWinTimesCB);
		this.autoEvent.add("FLUSH_PLAYER_TORTOISE",this,this.flushResultNameCB);
		this.autoEvent.add("FLUSH_PLAYER_MARS",this,this.flushResultNameCB);
		this.autoEvent.add("FLUSH_PLAYER_WISE",this,this.flushResultNameCB);
		this.autoEvent.add("FLUSH_PLAYER_DEFEAT",this,this.flushResultNameCB);
		this.autoEvent.add("FLUSH_MEJCLQZT",this,this.flushJiCeBaoLingQuZT);
		this.autoEvent.add("FLUSH_MONTHSALARY",this,this.flushMonthSalaryBtn);
		this.autoEvent.add("FLUSH_PLAYER_NAME",this,this.flushPlayerName);
	}

	__class(MessageMediator,'huamao.mediator.MessageMediator',_super);
	var __proto=MessageMediator.prototype;
	__proto.flushPlayerName=function(){
		this.messagePanel.flushPlayerName();
	}

	__proto.flushMonthSalaryBtn=function(){
		this.messagePanel.flushMonthSalaryBtn();
	}

	__proto.flushJiCeBaoLingQuZT=function(){
		this.messagePanel.flushJiCeBaoLingQuZT();
	}

	__proto.flushLvCB=function(){
		this.messagePanel.flushLv();
	}

	__proto.flushExpCB=function(){
		this.messagePanel.flushExp();
	}

	__proto.flushOfficalCB=function(){
		this.messagePanel.flushOffcial();
	}

	__proto.flushOfficalScoreCB=function(){
		this.messagePanel.flushOffcialScore();
	}

	__proto.flushGameTimesCB=function(){
		this.messagePanel.flushGameTimes();
	}

	__proto.flushWinTimesCB=function(){
		this.messagePanel.flushWinTimes();
	}

	__proto.flushResultNameCB=function(){
		this.messagePanel.flushResultName();
	}

	return MessageMediator;
})(Mediator)


//class huamao.mediator.MilitaryViewMediator extends game.mvc.Mediator
var MilitaryViewMediator=(function(_super){
	function MilitaryViewMediator(sprite){
		this.militaryView=null;
		MilitaryViewMediator.__super.call(this,sprite);
		this.militaryView=sprite;
		this.autoEvent.add("UPDATA_CITY_LIST",this,this.upDataCityList);
	}

	__class(MilitaryViewMediator,'huamao.mediator.MilitaryViewMediator',_super);
	var __proto=MilitaryViewMediator.prototype;
	__proto.upDataCityList=function(){
		this.militaryView.flushData();
	}

	return MilitaryViewMediator;
})(Mediator)


//class huamao.mediator.MjlMediator extends game.mvc.Mediator
var MjlMediator=(function(_super){
	function MjlMediator(sprite){
		MjlMediator.__super.call(this,sprite);
	}

	__class(MjlMediator,'huamao.mediator.MjlMediator',_super);
	return MjlMediator;
})(Mediator)


//class huamao.mediator.MjlXinxiMediator extends game.mvc.Mediator
var MjlXinxiMediator=(function(_super){
	function MjlXinxiMediator(sprite,mediatorData){
		this.panel=null;
		this.currId=0;
		this.wuJiangSession=null;
		this.sysHero=null;
		MjlXinxiMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.panel.juexing.on("click",this,this.clickFun);
		this.panel.fujiang.on("click",this,this.openFujiang);
		this.panel.bingzhong.on("click",this,this.openbingZhong);
		this.currId=mediatorData.heroId;
		this.sysHero=ConfigManager.getConfig("sys_hero.txt",this.currId);
		this.panel.setData(this.currId);
		this.panel.tianfu();
		this.setSkill(this.sysHero.heroDefaultSkill);
		var arr=[];
		for (var i=0;i < this.sysHero.mixSkillArr.length;i++){
			var str="";
			var sys=ConfigManager.getConfig("sys_skill_mix.txt",this.sysHero.mixSkillArr[i]);
			for (var j=0;j < sys.mixHeroArr.length;j++){
				var heroId=sys.mixHeroArr[j];
				if(this.currId==heroId)continue ;
				var sysHero1=ConfigManager.getConfig("sys_hero.txt",heroId);
				var bd=j==sys.mixHeroArr.length-1?":":"、";
				if(j+1==sys.mixHeroArr.length-1){
					var heroId1=sys.mixHeroArr[j+1];
					if(this.currId==heroId1){
						bd=":";
					}
				}
				str+=(this.getHtml(sysHero1.heroName+bd,"#7280a5"));
			};
			var str2=SysTalent.getName(sys.property)+"<font color='#4bd438'>+"+SysTalent.getValue(sys.property,sys.add)+"</font>";
			str+=this.getHtml(str2,"#7f8b96");
			arr.push(str);
		}
		this.panel.setMix(arr);
	}

	__class(MjlXinxiMediator,'huamao.mediator.MjlXinxiMediator',_super);
	var __proto=MjlXinxiMediator.prototype;
	__proto.openFujiang=function(){
		var dialog=App.dialogManager.showMiniDialog(TuijianWujiang,true,true);
		dialog.setData(this.currId);
	}

	__proto.openbingZhong=function(){
		var dialog=App.dialogManager.showMiniDialog(BingZhongPanel,true,true);
		dialog.setData(this.currId);
	}

	__proto.setSkill=function(id){
		var sys=ConfigManager.getConfig("sys_skill.txt",id);
		this.panel.setSkill(id,this.getHtml(sys.skillDescription,"#7f8b96"));
	}

	__proto.clickFun=function(e){
		var sys=ConfigManager.getConfig("sys_skill_wake.txt",this.sysHero.heroWakeSkill);
		var str=this.getHtml("<font color='#7280a5'>"+sys.wakeSkillName+":</font>    <font color='#7280a5'>"+sys.wakeSkillDescription+"</font>","#7f8b96");
		FlyLittleUpTips.setTips(sys.wakeSkillName+":\n"+sys.wakeSkillDescription,400);
	}

	__proto.getHtml=function(str,color){
		return TheGame.FONT(str,color,24,"Microsoft YaHei");
	}

	MjlXinxiMediator.FONT_SIZE=24;
	MjlXinxiMediator.FONT_FAMILY="Microsoft YaHei";
	MjlXinxiMediator.NORMAL="#7f8b96";
	MjlXinxiMediator.NO_HAVE="#959595";
	MjlXinxiMediator.HAVE="#ffdeb9";
	MjlXinxiMediator.TITLE_NAME="#e3a915";
	return MjlXinxiMediator;
})(Mediator)


//class huamao.mediator.NewUnionMediator extends game.mvc.Mediator
var NewUnionMediator=(function(_super){
	function NewUnionMediator(sprite){
		NewUnionMediator.__super.call(this,sprite);
	}

	__class(NewUnionMediator,'huamao.mediator.NewUnionMediator',_super);
	return NewUnionMediator;
})(Mediator)


//class huamao.mediator.QiandaoMediator extends game.mvc.Mediator
var QiandaoMediator=(function(_super){
	function QiandaoMediator(sprite){
		this._qiandao=null;
		QiandaoMediator.__super.call(this,sprite);
		this._qiandao=sprite;
		this.autoEvent.add("QIANDAO_DATA",this,this.onUpdate);
	}

	__class(QiandaoMediator,'huamao.mediator.QiandaoMediator',_super);
	var __proto=QiandaoMediator.prototype;
	__proto.onUpdate=function(){
		this._qiandao.onUpdate();
	}

	return QiandaoMediator;
})(Mediator)


//class huamao.mediator.QingbaoMediator extends game.mvc.Mediator
var QingbaoMediator=(function(_super){
	function QingbaoMediator(sprite){
		QingbaoMediator.__super.call(this,sprite);
	}

	__class(QingbaoMediator,'huamao.mediator.QingbaoMediator',_super);
	return QingbaoMediator;
})(Mediator)


//class huamao.mediator.RankMediator extends game.mvc.Mediator
var RankMediator=(function(_super){
	function RankMediator(sprite){
		this.rank=null;
		RankMediator.__super.call(this,sprite);
		this.rank=sprite;
		this.autoEvent.add("REFRESH_RANK",this,this.onRefresh);
	}

	__class(RankMediator,'huamao.mediator.RankMediator',_super);
	var __proto=RankMediator.prototype;
	__proto.onRefresh=function(type){
		this.rank.onRefresh(type);
	}

	return RankMediator;
})(Mediator)


//class huamao.mediator.RechargeMediator extends game.mvc.Mediator
var RechargeMediator=(function(_super){
	function RechargeMediator(sprite){
		this.rechargeSession=null;
		this.panel=null;
		RechargeMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.init();
	}

	__class(RechargeMediator,'huamao.mediator.RechargeMediator',_super);
	var __proto=RechargeMediator.prototype;
	__proto.init=function(){
		this.autoEvent.add("CHONGZHIUPDATA",this,this.upData);
		this.autoEvent.addEventNow();
		this.upData();
	}

	__proto.upData=function(){
		this.panel.upData();
	}

	return RechargeMediator;
})(Mediator)


//class huamao.mediator.SelectChuzhengMediator extends game.mvc.Mediator
var SelectChuzhengMediator=(function(_super){
	function SelectChuzhengMediator(sprite){
		SelectChuzhengMediator.__super.call(this,sprite);
	}

	__class(SelectChuzhengMediator,'huamao.mediator.SelectChuzhengMediator',_super);
	return SelectChuzhengMediator;
})(Mediator)


//class huamao.mediator.SelectZhenrongMediator extends game.mvc.Mediator
var SelectZhenrongMediator=(function(_super){
	function SelectZhenrongMediator(sprite){
		SelectZhenrongMediator.__super.call(this,sprite);
	}

	__class(SelectZhenrongMediator,'huamao.mediator.SelectZhenrongMediator',_super);
	return SelectZhenrongMediator;
})(Mediator)


//class huamao.mediator.SettingMediator extends game.mvc.Mediator
var SettingMediator=(function(_super){
	function SettingMediator(sprite){
		this._setting=null;
		SettingMediator.__super.call(this,sprite);
		this._setting=sprite;
	}

	__class(SettingMediator,'huamao.mediator.SettingMediator',_super);
	var __proto=SettingMediator.prototype;
	// this.autoEvent.add(YouEvent.UPDATE_SETTING,this,onUpdate);
	__proto.onUpdate=function(type){
		this._setting.update(type);
	}

	return SettingMediator;
})(Mediator)


//class huamao.mediator.SevenrenwuMediator extends game.mvc.Mediator
var SevenrenwuMediator=(function(_super){
	function SevenrenwuMediator(sprite){
		this.sevenrenwuSession=null;
		this.sevenview=null;
		this.sevenTaskAction=null;
		SevenrenwuMediator.__super.call(this,sprite);
		this.sevenview=sprite;
		this.autoEvent.add("SEVENRENWU_DATA",this,this.onReward);
		this.onUpdate(this.sevenrenwuSession.dataRenwu);
	}

	__class(SevenrenwuMediator,'huamao.mediator.SevenrenwuMediator',_super);
	var __proto=SevenrenwuMediator.prototype;
	__proto.onReward=function(actionId){
		this.sevenTaskAction.onSevenGift(actionId);
	}

	__proto.onUpdate=function(arr){
		this.sevenview.setData(arr);
	}

	return SevenrenwuMediator;
})(Mediator)


//class huamao.mediator.ShopMediator extends game.mvc.Mediator
var ShopMediator=(function(_super){
	function ShopMediator(sprite){
		this.shopPanel=null;
		ShopMediator.__super.call(this,sprite);
		this.shopPanel=sprite;
		this.initEvent();
	}

	__class(ShopMediator,'huamao.mediator.ShopMediator',_super);
	var __proto=ShopMediator.prototype;
	__proto.initEvent=function(){
		this.autoEvent.add("SHOP_INTIMACY",this,this.flushIntimacy);
		this.autoEvent.add("SHOP_ITEM",this,this.flushItem);
		this.autoEvent.add("SHOP_CD",this,this.flushCd);
		this.autoEvent.add("FLUSH_PLAYER_GOLD",this,this.flushGold);
		this.autoEvent.add("FLUSH_PLAYER_SILVER",this,this.flushSilver);
	}

	__proto.flushIntimacy=function(){
		this.shopPanel.flushIntimacy();
	}

	__proto.flushItem=function(){
		this.shopPanel.flushItem();
	}

	__proto.flushCd=function(){
		this.shopPanel.flushCd();
	}

	__proto.flushGold=function(){
		this.shopPanel.flushGold();
	}

	__proto.flushSilver=function(){
		this.shopPanel.flushSilver();
	}

	return ShopMediator;
})(Mediator)


//class huamao.mediator.ShoucangMediator extends game.mvc.Mediator
var ShoucangMediator=(function(_super){
	function ShoucangMediator(sprite){
		this.info=null;
		ShoucangMediator.__super.call(this,sprite);
		this.info=sprite;
		this.autoEvent.add("SHOUCANG_SUCCESS",this,this.onUpdate);
	}

	__class(ShoucangMediator,'huamao.mediator.ShoucangMediator',_super);
	var __proto=ShoucangMediator.prototype;
	__proto.onUpdate=function(id){
		this.info.update();
	}

	return ShoucangMediator;
})(Mediator)


//class huamao.mediator.ShoucangZhanbaoInfoMediator extends game.mvc.Mediator
var ShoucangZhanbaoInfoMediator=(function(_super){
	function ShoucangZhanbaoInfoMediator(sprite){
		this.info=null;
		ShoucangZhanbaoInfoMediator.__super.call(this,sprite);
		this.info=sprite;
		this.autoEvent.add("SHOUCANG_SUCCESS",this,this.onUpdate);
	}

	__class(ShoucangZhanbaoInfoMediator,'huamao.mediator.ShoucangZhanbaoInfoMediator',_super);
	var __proto=ShoucangZhanbaoInfoMediator.prototype;
	__proto.onUpdate=function(id){
		this.info.onUpdate(id);
	}

	return ShoucangZhanbaoInfoMediator;
})(Mediator)


//class huamao.mediator.ShouChongMediator extends game.mvc.Mediator
var ShouChongMediator=(function(_super){
	function ShouChongMediator(sprite){
		this.panel=null;
		ShouChongMediator.__super.call(this,sprite);
		this.panel=sprite
		this.autoEvent.add("HUODONGUPDATA",this,this.upData);
	}

	__class(ShouChongMediator,'huamao.mediator.ShouChongMediator',_super);
	var __proto=ShouChongMediator.prototype;
	__proto.upData=function(){
		this.panel.upData();
	}

	return ShouChongMediator;
})(Mediator)


//class huamao.mediator.StratagemMediator extends game.mvc.Mediator
var StratagemMediator=(function(_super){
	function StratagemMediator(sprite){
		this.panel=null;
		StratagemMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.init();
	}

	__class(StratagemMediator,'huamao.mediator.StratagemMediator',_super);
	var __proto=StratagemMediator.prototype;
	__proto.init=function(){
		this.autoEvent.add("STRATAGEM_CD",this,this.flushCd);
		this.autoEvent.add("STRATAGEM_ORDER",this,this.flushOrder);
		this.autoEvent.add("FLUSH_PLAYER_JOB",this,this.flushJob);
	}

	__proto.flushCd=function(){
		this.panel.flushCd();
	}

	__proto.flushOrder=function(){
		this.panel.flushOrder();
	}

	__proto.flushJob=function(){
		this.panel.checkJob();
	}

	return StratagemMediator;
})(Mediator)


//class huamao.mediator.TaskMediator extends game.mvc.Mediator
var TaskMediator=(function(_super){
	function TaskMediator(sprite){
		this.taskAction=null;
		// public var newPlayerTaskAction:NewPlayerTaskAction;
		this.taskSession=null;
		this.mainPlayerSession=null;
		this.itemSp=null;
		//private var arr:Array=["功勋任务","君主任务","成长任务","剧情任务"];
		this.temp=[];
		this.barr=[];
		this.redArr=[];
		this.nowIndex=0;
		TaskMediator.__super.call(this,sprite);
		var p=this.getDialog();
		var yy=478;
		this.itemSp=new Sprite();
		p.addChild(this.itemSp);
		var item;
		item=new RewardItem();
		item.x=256;
		item.y=yy;
		this.barr.push(item);
		item=new RewardItem();
		item.x=352;
		item.y=yy;
		this.barr.push(item);
		item=new RewardItem();
		item.x=447;
		item.y=yy;
		this.barr.push(item);
		this.init_();
		this.autoEvent.add("huamao.YouEvent.UPDATA_TASK_DATA",this,this.update_);
		this.getDialog().tab0.selectHandler=new Handler(this,this.fun);
		var index=0;
		for (var k=0;k < this.temp.length;k++){
			var td=this.temp[k];
			if(td && td.isOk){
				index=k;
				break ;
			}
		}
		this.nowIndex=index;
		this.getDialog().tab0.selectedIndex=index;
	}

	__class(TaskMediator,'huamao.mediator.TaskMediator',_super);
	var __proto=TaskMediator.prototype;
	__proto.update_=function(){
		this.init_();
	}

	__proto.init_=function(){
		this.temp.length=0;
		if(this.taskSession.typeNewplayer!=null && this.taskSession.typeNewplayer.status!=0){
			this.temp.push(this.taskSession.typeNewplayer);
		}
		if(this.taskSession.gNewplayer!=null && this.taskSession.gNewplayer.status!=0){
			this.temp.push(this.taskSession.gNewplayer);
		}
		if(this.mainPlayerSession.mainPlayerData.job>1001){
			if(this.taskSession.typeHonour.status!=0)
				this.temp.push(this.taskSession.typeHonour);
			if(this.taskSession.typeKing.status!=0)
				this.temp.push(this.taskSession.typeKing);
		};
		var ss="";
		for (var i=0;i < this.temp.length;i++){
			var td=this.temp [i];
			ss+=(td.systask?td.systask.taskName:"?");
			if(i<this.temp.length-1)ss+=",";
		}
		this.getDialog().tab0.labels=ss;
		this.fun(this.nowIndex);
		this.clearRed();
		var arr=ss.split(",");
		for(i=0;i<arr.length;i++){
			var task=this.temp [i];
			if(task && task.isOk==1){
				var red=new RedPoint(0,this.getDialog().tab0.items [i]);
				red.setPos(-15);
				this.redArr.push(red);
			}
		}
	}

	__proto.clearRed=function(){
		for(var i=0;i<this.redArr.length;i++){
			var red=this.redArr[i];
			red.removeSelf();
			red.destroy();
			red=null;
		}
	}

	__proto.fun=function(index){
		this.setIndex(index);
	}

	__proto.setIndex=function(index){
		if(this.temp.length<=0)return;
		var td;
		if(index>=this.temp.length){
			index=0;
		}
		this.nowIndex=index;
		td=this.temp [index];
		var p=this.getDialog();
		var systask=td.systask;
		p.txt0.text=systask.showValue(td);
		var ss=systask.taskReward;
		var arr=ss.split(",");
		var item;
		for (var j=0;j < this.barr.length;j++){
			item=this.barr[j];
			item.removeSelf();
		};
		var kk=0
		for (var i=0;td.end==0 && i < arr.length;i+=2){
			var itemid=parseInt(arr[i]);
			var num=parseInt(arr[i+1]);
			item=this.barr[kk++];
			item.setItemId(itemid);
			this.itemSp.addChild(item);
			item.setNum(num);
		};
		var data=ConfigManager.getConfig("sys_title_player.txt",this.mainPlayerSession.mainPlayerData.job);
		ss=systask.taskDescription;
		var a=ss.indexOf("{");
		var b=ss.indexOf("}");
		ss=ss.substring(a,b+1);
		if(ss!=""){
			ss=systask.taskDescription.replace(ss,data.titleBonusHonorPoint+"");
			}else{
			ss=systask.taskDescription;
		}
		p.txt1.text=ss;
		p.lingqu.visible=(td.isOk==1);
		p.lingqu.on("click",this,this.clickFun,[td]);
	}

	__proto.clickFun=function(td){
		if(td.type==100){
			this.taskAction.sendTask(1);
		}
		else if(td.type==101){
			this.taskAction.sendTask(2);
		}
		else if(td.type==102){
			this.taskAction.sendTask(7);
		}
		else if(td.type==103){
			this.taskAction.sendTask(10);
		};
		var p=this.getDialog();
		p.lingqu.visible=false;
		p.lingqu.off("click",this,this.clickFun,[td]);
		GameUtils.setFlyToItem(this.barr);
	}

	__proto.getDialog=function(){
		return this.sprite;
	}

	return TaskMediator;
})(Mediator)


//class huamao.mediator.TColeageMediator extends game.mvc.Mediator
var TColeageMediator=(function(_super){
	function TColeageMediator(sprite){
		this.coleageT=null;
		TColeageMediator.__super.call(this,sprite);
		this.coleageT=sprite;
		this.autoEvent.add("TALK_FLUSH_COLEAGE",this,this.flushPanel);
	}

	__class(TColeageMediator,'huamao.mediator.TColeageMediator',_super);
	var __proto=TColeageMediator.prototype;
	__proto.flushPanel=function(){
		this.coleageT.flushPanel();
	}

	return TColeageMediator;
})(Mediator)


//class huamao.mediator.TCurrentMediator extends game.mvc.Mediator
var TCurrentMediator=(function(_super){
	function TCurrentMediator(sprite){
		this.currentT=null;
		TCurrentMediator.__super.call(this,sprite);
		this.currentT=sprite;
		this.autoEvent.add("TALK_FLUSH_CURRENT",this,this.flushPanel);
	}

	__class(TCurrentMediator,'huamao.mediator.TCurrentMediator',_super);
	var __proto=TCurrentMediator.prototype;
	__proto.flushPanel=function(){
		this.currentT.flushPanel();
	}

	return TCurrentMediator;
})(Mediator)


//class huamao.mediator.TongjiMediator extends game.mvc.Mediator
var TongjiMediator=(function(_super){
	function TongjiMediator(sprite){
		this.panel=null;
		TongjiMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.autoEvent.add("LOAD_BATTLE_FILE",this,this.onLoadCom);
	}

	__class(TongjiMediator,'huamao.mediator.TongjiMediator',_super);
	var __proto=TongjiMediator.prototype;
	__proto.onLoadCom=function(battleData){
		this.panel.update(battleData);
	}

	return TongjiMediator;
})(Mediator)


//class huamao.mediator.TSystemMediator extends game.mvc.Mediator
var TSystemMediator=(function(_super){
	function TSystemMediator(sprite){
		this.systemT=null;
		TSystemMediator.__super.call(this,sprite);
		this.systemT=sprite;
		this.autoEvent.add("TALK_FLUSH_SYS",this,this.flushPanel);
	}

	__class(TSystemMediator,'huamao.mediator.TSystemMediator',_super);
	var __proto=TSystemMediator.prototype;
	__proto.flushPanel=function(){
		this.systemT.flushPanel();
	}

	return TSystemMediator;
})(Mediator)


//class huamao.mediator.TTeamMediator extends game.mvc.Mediator
var TTeamMediator=(function(_super){
	function TTeamMediator(sprite){
		this.teamT=null;
		TTeamMediator.__super.call(this,sprite);
		this.teamT=sprite;
		this.autoEvent.add("TALK_FLUSH_TEAM",this,this.flushPanel);
	}

	__class(TTeamMediator,'huamao.mediator.TTeamMediator',_super);
	var __proto=TTeamMediator.prototype;
	__proto.flushPanel=function(){
		this.teamT.flushPanel();
	}

	return TTeamMediator;
})(Mediator)


//class huamao.mediator.TWordMediator extends game.mvc.Mediator
var TWordMediator=(function(_super){
	function TWordMediator(sprite){
		this.wordT=null;
		TWordMediator.__super.call(this,sprite);
		this.wordT=sprite;
		this.autoEvent.add("TALK_FLUSH_WORD",this,this.flushPanel);
	}

	__class(TWordMediator,'huamao.mediator.TWordMediator',_super);
	var __proto=TWordMediator.prototype;
	__proto.flushPanel=function(){
		this.wordT.flushPanel();
	}

	return TWordMediator;
})(Mediator)


//class huamao.mediator.TZSXZMediator extends game.mvc.Mediator
var TZSXZMediator=(function(_super){
	function TZSXZMediator(sprite){
		this.playerInfoAction=null;
		TZSXZMediator.__super.call(this,sprite);
		this.autoEvent.add("TINGBUBIAN",this,this.Chang);
		this.autoEvent.add("OPENTINGBUBIAN",this,this.openView)
	}

	__class(TZSXZMediator,'huamao.mediator.TZSXZMediator',_super);
	var __proto=TZSXZMediator.prototype;
	__proto.Chang=function(index){
		this.playerInfoAction.sendXZRaise();
	}

	__proto.openView=function(){
		App.dialogManager.openDialogByStr("TZHUANX",null,true,true);
	}

	return TZSXZMediator;
})(Mediator)


//class huamao.mediator.UnionMediator extends game.mvc.Mediator
var UnionMediator=(function(_super){
	function UnionMediator(sprite){
		UnionMediator.__super.call(this,sprite);
	}

	__class(UnionMediator,'huamao.mediator.UnionMediator',_super);
	return UnionMediator;
})(Mediator)


//class huamao.mediator.VipMediator extends game.mvc.Mediator
var VipMediator=(function(_super){
	function VipMediator(sprite){
		this.panel=null;
		VipMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.autoEvent.add("CHONGZHIUPDATA",this,this.upData);
	}

	__class(VipMediator,'huamao.mediator.VipMediator',_super);
	var __proto=VipMediator.prototype;
	__proto.upData=function(){
		this.panel.upData();
	}

	return VipMediator;
})(Mediator)


//class huamao.mediator.WaiJiaoMediator extends game.mvc.Mediator
var WaiJiaoMediator=(function(_super){
	function WaiJiaoMediator(sprite){
		this.waiJiaoPanel=null;
		WaiJiaoMediator.__super.call(this,sprite);
		this.waiJiaoPanel=sprite;
		this.autoEvent.add("WAIJIAO_FLUSH",this,this.onUpdate);
	}

	__class(WaiJiaoMediator,'huamao.mediator.WaiJiaoMediator',_super);
	var __proto=WaiJiaoMediator.prototype;
	__proto.onUpdate=function(){
		this.waiJiaoPanel.flushData();
	}

	return WaiJiaoMediator;
})(Mediator)


//class huamao.mediator.WorldMapMediator extends game.mvc.Mediator
var WorldMapMediator=(function(_super){
	function WorldMapMediator(sprite){
		this.worldMap=null;
		WorldMapMediator.__super.call(this,sprite);
		this.worldMap=sprite;
		this.autoEvent.add("ADD_CITY_PLAYER",this,this.onUpdate);
		this.autoEvent.add("UPDATE_CITY_INFO",this,this.onUpdateOne);
		this.autoEvent.add("ADD_FIGHT_FIRE",this,this.addFightFire);
		this.autoEvent.add("UPDATE_XINGJUN_LIST",this,this.onDanger);
	}

	__class(WorldMapMediator,'huamao.mediator.WorldMapMediator',_super);
	var __proto=WorldMapMediator.prototype;
	__proto.onDanger=function(){
		this.worldMap.onDanger();
	}

	__proto.addFightFire=function(cityId){
		this.worldMap.addFightFire(cityId);
	}

	__proto.onUpdate=function(data){
		this.worldMap.update();
	}

	__proto.onUpdateOne=function(cityData,playerData){
		this.worldMap.update();
	}

	return WorldMapMediator;
})(Mediator)


//class huamao.mediator.WuJiangMediator extends game.mvc.Mediator
var WuJiangMediator=(function(_super){
	function WuJiangMediator(sprite){
		this.wuJiangSession=null;
		this.heroTeamSession=null;
		this.wujiang=null;
		this.teamIdArr=[];
		this.heroArr=null;
		WuJiangMediator.__super.call(this,sprite);
		this.wujiang=sprite;
		this.init();
		this.autoEvent.add("HEROUPDATE",this,this.updateFun);
		this.autoEvent.add("TEAM_CHANGE",this,this.teamChangeFun);
		this.getDialog().check1.clickHandler=new Handler(this,this.disLegionFun);
		this.getDialog().check0.clickHandler=new Handler(this,this.disWeaponFun);
		this.getDialog().xue.clickHandler=new Handler(this,this.disXueCangFun);
		this.getDialog().btn0.clickHandler=new Handler(this,this.teamFun);
	}

	__class(WuJiangMediator,'huamao.mediator.WuJiangMediator',_super);
	var __proto=WuJiangMediator.prototype;
	__proto.disWeaponFun=function(){
		WuJiangPanel.DIS_WEAPON=this.getDialog().check0.selected;
		this.getDialog().list0.refresh();
	}

	__proto.disXueCangFun=function(){
		WuJiangPanel.DIS_XUECANG=this.getDialog().xue.selected;
		this.filterLegion();
	}

	__proto.disLegionFun=function(){
		WuJiangPanel.DIS_LEGION=this.getDialog().check1.selected;
		this.filterLegion();
	}

	__proto.teamFun=function(){
		if(this.wuJiangSession.getNoFenJie().length < 30){
			FlyUpTips.setTips("拥有30位武将后开启武将队列,可自定义武将排序");
			return;
		}
		App.dialogManager.showMiniDialog(HeroTeamDialog);
	}

	__proto.init=function(){
		this.getDialog().tab0.selectHandler=new Handler(this,this.setTeam);
		this.resetTab();
	}

	__proto.teamChangeFun=function(){
		this.resetTab();
	}

	__proto.updateFun=function(){
		this.setTeam(this.getDialog().tab0.selectedIndex);
	}

	__proto.resetTab=function(){
		this.teamIdArr.length=0;
		var str="默认队列";
		var teamArr=this.heroTeamSession.getTeamArr();
		for (var i=0;i < teamArr.length;i++){
			var data=teamArr[i];
			if(data.heroIdArr.length !=0){
				str+=(","+data.teamName);
				this.teamIdArr.push(data.teamIndex);
			}
		}
		this.getDialog().tab0.labels=str;
		this.getDialog().tab0.selectedIndex=0;
	}

	__proto.setTeam=function(index){
		if(index==-1){
			return;
		}
		if(index==0){
			this.heroArr=this.wuJiangSession.getHeroSnArr();
			}else{
			var teamIndex=this.teamIdArr[index-1];
			var team=this.heroTeamSession.getTeamByIndex(teamIndex);
			this.heroArr=this.heroTeamSession.getTeam(team);
		}
		this.filterLegion();
	}

	/**
	*筛选副将 并且负责武将的显示
	*/
	__proto.filterLegion=function(){
		var ary=this.wuJiangSession.filterLegion(this.heroArr,WuJiangPanel.DIS_LEGION,WuJiangPanel.DIS_XUECANG);
		this.getDialog().setHeroArr(ary);
		this.resetHeroNum();
	}

	__proto.resetHeroNum=function(){
		var arr=this.wuJiangSession.getNoFenJie();
		this.getDialog().setHeroNum(arr.length);
	}

	__proto.getDialog=function(){
		return this.sprite;
	}

	return WuJiangMediator;
})(Mediator)


//class huamao.mediator.WuJiangXinXiMediator extends game.mvc.Mediator
var WuJiangXinXiMediator=(function(_super){
	function WuJiangXinXiMediator(sprite,mediatorData){
		this.wuJiangAction=null;
		this.wuJiangSession=null;
		this.heroTeamSession=null;
		this.panel=null;
		this.nowIndex=0;
		this.heroArr=null;
		this.heroData=null;
		WuJiangXinXiMediator.__super.call(this,sprite);
		this.panel=sprite;
		this.panel.qian1.clickHandler=new Handler(this,this.selectHeroFun,[-1]);
		this.panel.xia1.clickHandler=new Handler(this,this.selectHeroFun,[1]);
		this.setData(mediatorData);
		this.autoEvent.add("HEROUPDATE",this,this.heroUpdateFun);
		this.autoEvent.add("CHAKANZHUJIANG",this,this.setHeroFun);
		this.panel.tab0.on("change",this,this.selectFun);
	}

	__class(WuJiangXinXiMediator,'huamao.mediator.WuJiangXinXiMediator',_super);
	var __proto=WuJiangXinXiMediator.prototype;
	__proto.setHeroFun=function(hdata){
		if((hdata instanceof huamao.panel.hero.HeroData )){
			for (var i=0;i < this.heroArr.length;i++){
				var heroData=this.heroArr [i];
				if(heroData.heroId==hdata.heroId){
					this.setHeroByIndex(i);
					return;
				}
			}
		}
		else{
			this.setHeroData(this.wuJiangSession.getHero(parseInt(hdata+"")));
		}
	}

	/**
	*接受外部参数
	*@param data
	*/
	__proto.setData=function(mediatorData){
		this.heroArr=mediatorData.team;
		for (var i=0;i < this.heroArr.length;i++){
			var heroData=this.heroArr [i];
			if(heroData.heroId==mediatorData.heroId){
				this.setHeroByIndex(i);
				return;
			}
		}
	}

	/**
	*武将信息更新 有可能被分解了
	*@param heroId
	*
	*/
	__proto.heroUpdateFun=function(heroId){
		if(heroId==this.heroData.heroId){
			if(this.heroData.haveHero()==false){
				this.panel.close();
				return;
			}
			this.panel.setHeroData(this.heroData);
		}
	}

	__proto.selectFun=function(index){
		this.sendEvent();
	}

	/**
	*前进后退方法
	*@param value
	*/
	__proto.selectHeroFun=function(value){
		this.nowIndex+=value;
		this.nowIndex=TheGame.betweenLoop(this.nowIndex,0,this.heroArr.length-1);
		this.setHeroByIndex(this.nowIndex);
	}

	/**
	*@param 会设置索引
	*/
	__proto.setHeroByIndex=function(index){
		this.nowIndex=index;
		this.setHeroData(this.heroArr[this.nowIndex]);
	}

	/**
	*@param heroData
	*/
	__proto.setHeroData=function(heroData){
		this.heroData=heroData;
		this.panel.setHeroData(heroData);
		this.sendEvent();
	}

	__proto.sendEvent=function(){
		Laya.timer.callLater(this,this.nextFrameFun);
	}

	__proto.nextFrameFun=function(){
		App.eventManager.event("SELECT_HERO",this.heroData);
	}

	__proto.xueCangFun=function(){
		this.wuJiangAction.sendXueCang(this.heroData.heroId,(this.heroData.isXueCang==1)? 0 :1);
	}

	return WuJiangXinXiMediator;
})(Mediator)


//class huamao.mediator.XianGouMediator extends game.mvc.Mediator
var XianGouMediator=(function(_super){
	function XianGouMediator(sprite){
		this.panel=null;
		this.activitySession=null;
		XianGouMediator.__super.call(this,sprite);
		this.panel=sprite
		this.autoEvent.add("HUODONGUPDATA",this,this.upData);
	}

	__class(XianGouMediator,'huamao.mediator.XianGouMediator',_super);
	var __proto=XianGouMediator.prototype;
	__proto.upData=function(){
		this.panel.upData();
	}

	return XianGouMediator;
})(Mediator)


//class huamao.mediator.XingjunListMediator extends game.mvc.Mediator
var XingjunListMediator=(function(_super){
	function XingjunListMediator(sprite){
		this._xingjun=null;
		XingjunListMediator.__super.call(this,sprite);
		this._xingjun=sprite;
		this.autoEvent.add("UPDATE_XINGJUN_LIST",this,this.update);
		this.autoEvent.add("DELETE_XINGJUN_ITEM",this,this.update);
	}

	__class(XingjunListMediator,'huamao.mediator.XingjunListMediator',_super);
	var __proto=XingjunListMediator.prototype;
	__proto.update=function(){
		this._xingjun.update();
	}

	return XingjunListMediator;
})(Mediator)


//class huamao.mediator.YaoqingZuduiMediator extends game.mvc.Mediator
var YaoqingZuduiMediator=(function(_super){
	function YaoqingZuduiMediator(sprite){
		this._yaoqing=null;
		YaoqingZuduiMediator.__super.call(this,sprite);
		this._yaoqing=sprite;
		this.autoEvent.add("UPDATE_INVITED_FRIEND",this,this.onUpdate);
		this.autoEvent.add("UPDATE_FRIEND",this,this.onUpdate2);
	}

	__class(YaoqingZuduiMediator,'huamao.mediator.YaoqingZuduiMediator',_super);
	var __proto=YaoqingZuduiMediator.prototype;
	__proto.onUpdate=function(){
		this._yaoqing.onUpdate();
	}

	__proto.onUpdate2=function(friendId){
		this._yaoqing.onUpdate();
	}

	return YaoqingZuduiMediator;
})(Mediator)


//class huamao.mediator.YunshuMediator extends game.mvc.Mediator
var YunshuMediator=(function(_super){
	function YunshuMediator(sprite){
		YunshuMediator.__super.call(this,sprite);
	}

	__class(YunshuMediator,'huamao.mediator.YunshuMediator',_super);
	return YunshuMediator;
})(Mediator)


//class huamao.mediator.ZhanbaoInfoMediator extends game.mvc.Mediator
var ZhanbaoInfoMediator=(function(_super){
	function ZhanbaoInfoMediator(sprite){
		this.info=null;
		ZhanbaoInfoMediator.__super.call(this,sprite);
		this.info=sprite;
		this.autoEvent.add("SHOUCANG_SUCCESS",this,this.onUpdate);
	}

	__class(ZhanbaoInfoMediator,'huamao.mediator.ZhanbaoInfoMediator',_super);
	var __proto=ZhanbaoInfoMediator.prototype;
	__proto.onUpdate=function(id){
		this.info.onUpdate(id);
	}

	return ZhanbaoInfoMediator;
})(Mediator)


//class huamao.mediator.ZhanbaoMediator extends game.mvc.Mediator
var ZhanbaoMediator=(function(_super){
	function ZhanbaoMediator(sprite){
		this._list=null;
		ZhanbaoMediator.__super.call(this,sprite);
		this._list=sprite;
		this.autoEvent.add("ADD_ZHANBAO",this,this.update);
	}

	__class(ZhanbaoMediator,'huamao.mediator.ZhanbaoMediator',_super);
	var __proto=ZhanbaoMediator.prototype;
	__proto.update=function(){
		this._list.update();
	}

	return ZhanbaoMediator;
})(Mediator)


//class huamao.mediator.ZhaoMuMediator extends game.mvc.Mediator
var ZhaoMuMediator=(function(_super){
	function ZhaoMuMediator(sprite){
		this.zhaoMuAction=null;
		this.zhaoMuSession=null;
		this.wuJiangSession=null;
		this.bagSession=null;
		this.zhaomuDirector=null;
		this.mainPlayerSession=null;
		this.isFree=false;
		ZhaoMuMediator.__super.call(this,sprite);
		var panel=this.getDialog();
		panel.on("removed" ,this ,this.panelClose);
		this.autoEvent.add("huamao.session.ZhaoMuSession.InitEvent",this,this.initPanel);
		this.autoEvent.add("huamao.session.ZhaoMuSession.ShowEvent",this,this.showKard);
		this.autoEvent.add("SHOWJL",this,this.showJl);
		this.autoEvent.add("BAG_ITEM_FLUSH",this,this.upDataItem);
		this.autoEvent.add("COUNTRYUPDATA",this,this.upDataCountry);
		this.autoEvent.add("FLUSH_PLAYER_GOLD",this,this.flushGold);
		this.flushGold();
		this.addClick(panel.zhao1ge,[0]);
		this.addClick(panel.zhao5ge,[1]);
		this.addClick(panel.mai1ge ,[2]);
		this.addClick(panel.mai5ge ,[3]);
		panel.shu.on("click",this,this.onGengHuan);
		panel.mingjianglu.on("click",this,this.onMjl);
		panel.zhaomujilu.on("click",this,this.onJl);
		panel.hecheng.on("click",this,this.onHc);
		panel.yuanbao.mouseEnabled=true;
		panel.yuanbao.on("click",this,this.openChongzhi);
		panel.btn_yb.on("click",this,this.openChongzhi);
		this.zhaoMuAction.sendZhaoMu(100);
		Laya.timer.loop(1000,this,this.countDown);
		this.zhaomuDirector=new ZhaomuDirector();
		this.upDataItem();
		var red=new RedPoint(RedPointType.HAOYIN,panel.mai1ge);
		this.upDataCountry();
	}

	__class(ZhaoMuMediator,'huamao.mediator.ZhaoMuMediator',_super);
	var __proto=ZhaoMuMediator.prototype;
	__proto.openChongzhi=function(){
		App.dialogManager.openDialogByStr("RECHARGEPANEL",null,true,true);
	}

	__proto.flushGold=function(){
		var gold=this.mainPlayerSession.mainPlayerData.gold
		this.getDialog().yuanbao.text=gold+"";
	}

	__proto.upDataCountry=function(){
		this.getDialog().shu.skin=GameUtils.getCountry(this.zhaoMuSession.country);
	}

	__proto.onGengHuan=function(){
		App.dialogManager.showMiniDialog(ZhaoMuGengHuan,true,true);
	}

	__proto.upDataItem=function(){
		var panel=this.getDialog();
		panel.zhaomuling.text=this.bagSession.getItemNumByItemId(7001)+"";
		panel.wuhun.text=this.bagSession.getItemNumByItemId(8001)+"";
	}

	__proto.onHc=function(){
		App.dialogManager.showMiniDialog(HeChengPanel,true,true);
	}

	__proto.showJl=function(){
		App.dialogManager.showMiniDialog(ZhaoMuJl,true,true);
	}

	__proto.onJl=function(){
		this.zhaoMuAction.sendZhaoMu(101);
	}

	__proto.onMjl=function(){
		App.dialogManager.openDialogByStr("MJLPANEL",null,true,true);
	}

	__proto.showKard=function(){
		App.layerManager.effectLayer.addChild(ZhaomuDirector.black);
		var str=this.zhaoMuSession.lastStr;
		var arrstr=str.split(",");
		this.zhaomuDirector.reset();
		for (var i=1;i < arrstr.length;i+=2){
			var hid=parseInt(arrstr[i]);
			var sunm=parseInt(arrstr[i+1]);
			var card=new ZhaomuCard(hid,sunm);
			this.zhaomuDirector.cards.push(card);
		}
		this.zhaomuDirector.play();
		for (i=0;i<this.zhaomuDirector.cards.length;i++){
			App.layerManager.effectLayer.addChild(this.zhaomuDirector.cards[i]);
		}
	}

	__proto.countDown=function(){
		this.showTimer();
	}

	__proto.panelClose=function(){
		Laya.timer.clear(this,this.countDown);
	}

	__proto.initPanel=function(){
		var panel=this.getDialog();
		var n=this.zhaoMuSession.num%5;
		var is5=(n==0);
		if(is5){
			panel.zaigou.text="这杯必出紫橙武将";
			}else{
			panel.zaigou.text="再购"+(5-n)+"杯必出紫橙武将";
		}
		this.showTimer();
		if(this.zhaoMuSession.actionType==100){
			Dialog.manager.lock(false);
			ZhaomuDirector.black.removeSelf();
		}
	}

	__proto.showTimer=function(){
		var panel=this.getDialog();
		var serverS=GameUtils.GetServerTime();
		var ft=this.zhaoMuSession.freeTime-serverS;
		if(ft<0)ft=0;
		if(ft>0){
			panel.houmianfei.text=GameUtils.time(ft);
		}
		this.isFree=(ft==0);
		panel.mian.visible=this.isFree;
		panel.huafei.visible=!this.isFree;
		panel.houmianfei.visible=!this.isFree;
		panel.houmianfei0.visible=!this.isFree;
		return ft;
	}

	__proto.getDialog=function(){
		return this.sprite;
	}

	__proto.addClick=function(btn,arr){
		btn.on("click",this,this.clickFun,arr);
	}

	__proto.clickFun=function(type){
		if(type==2){
			if(!this.isFree){
				var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true,false,false);
				alert.setAll(null,"确定花费200元宝购买杜康酒，获赠1次武将招募吗？",new Handler(this,this.zhaomuFun,[type]));
				}else{
				this.zhaomuFun(type);
			}
			}else if(type==3){
			var alert1=App.dialogManager.showMiniDialog(NormalAlert,true,true,false,false);
			alert1.setAll(null,"确定花费950元宝购买杜康酒，获赠5次武将招募吗？",new Handler(this,this.zhaomuFun,[type]));
			}else{
			this.zhaomuFun(type);
		}
	}

	__proto.zhaomuFun=function(type){
		Dialog.manager.setLockView(null);
		Dialog.manager.lock(true);
		this.zhaoMuAction.sendZhaoMu(type,this.zhaoMuSession.country);
	}

	return ZhaoMuMediator;
})(Mediator)


//class huamao.mediator.ZhenrongXuanzeMediator extends game.mvc.Mediator
var ZhenrongXuanzeMediator=(function(_super){
	function ZhenrongXuanzeMediator(sprite){
		ZhenrongXuanzeMediator.__super.call(this,sprite);
	}

	__class(ZhenrongXuanzeMediator,'huamao.mediator.ZhenrongXuanzeMediator',_super);
	return ZhenrongXuanzeMediator;
})(Mediator)


/**
*抽卡动画导演
*/
//class huamao.panel.zhaomu.ZhaomuDirector extends laya.events.EventDispatcher
var ZhaomuDirector=(function(_super){
	function ZhaomuDirector(){
		this.cards=[];
		this.animations=[];
		this.step=0;
		/**临时计数器*/
		this.tempNum=0;
		this.isZhaomu=true;
		this.getArr=[];
		ZhaomuDirector.__super.call(this);
		this.t=new TClass();
		this.paoguang=new PaoGuang();
		this.baozha=new Baozha();
		ZhaomuDirector.black.graphics.clear();
		ZhaomuDirector.black.graphics.drawRect(0,0,Laya.stage.width*2,Laya.stage.height*2,0xffffff);
		ZhaomuDirector.black.alpha=0.5;
	}

	__class(ZhaomuDirector,'huamao.panel.zhaomu.ZhaomuDirector',_super);
	var __proto=ZhaomuDirector.prototype;
	__proto.reset=function(){
		this.cards.length=0;
		this.step=0;
		this.tempNum=0;
		this.isZhaomu=true;
		this.animations.length=0;
		this.getArr.length=0;
	}

	__proto.play=function(){
		this.animations.length=0;
		if(this.step==0){
			this.tempNum=this.cards.length;
			var card=this.cards[0];
			var dy=(Laya.stage.height/2);
			var dx=(Laya.stage.width/2);
			for (var i=0;i < this.cards.length;i++){
				card=this.cards [i];
				card.y=dy+500;
				card.x=dx+(i*20);
				var delayT=i*70;
				var a10=new Animation10(card,dy,delayT);
				this.animations.push(a10);
				a10.on("game.base.utils.MyAnimation.End",this,this.a10end,[a10]);
				a10.play();
			}
		}
		else if(this.step==1){
			this.tempNum=this.cards.length;
			var ww=(Laya.stage.width)/ this.tempNum;
			for (i=0;i < this.cards.length;i++){
				card=this.cards [i];
				if(this.tempNum!=3){
					dx=i*ww+(ww/2);
					this.isZhaomu=true;
				}
				else{
					this.isZhaomu=false;
					ww=(Laya.stage.width)/ 5;
					dx=(Laya.stage.width/2);
					if(i==0)dx-=ww*1;
					if(i==1)dx-=ww*0;
					if(i==2)dx+=ww*1;
				};
				var a20=new Animation20(card,dx);
				this.animations.push(a20);
				a20.on("game.base.utils.MyAnimation.End",this,this.a20end,[a20]);
				a20.play();
			}
		}
		else if(this.step==2){
			this.tempNum=this.cards.length;
			for (i=0;i < this.cards.length;i++){
				card=this.cards [i];
				var a1=new Animation1(card.kar,card.kar.scaleX);
				this.animations.push(a1);
				a1.on("game.base.utils.MyAnimation.End",this,this.a1end,[a1]);
				a1.play();
			}
		}
		else if(this.step==3){
			this.tempNum=this.cards.length;
			this.getArr.length=0;
			for (i=0;i < this.cards.length;i++){
				card=this.cards [i];
				if(card.getSunm()!=0){
					var a2=new Animation2(card.kar);
					this.animations.push(a2);
					a2.on("game.base.utils.MyAnimation.End",this,this.a2end,[a2,card]);
					a2.play();
					}else{
					this.getArr.push(card);
				}
			}
			if(this.getArr.length>1)this.getArr.sort(this.sort1);
			this.showCard();
		}
	}

	/**排序展示队列*/
	__proto.sort1=function(c0,c1){
		if(c0.x<c1.x)return 1;
		if(c0.x>c1.x)return-1;
		return 0;
	}

	/**展示 武将队列*/
	__proto.showCard=function(){
		if(this.getArr.length>0){
			var card=this.getArr.pop();
			var dx=(Laya.stage.width/2);
			var a3=new Animation3(card,dx);
			a3.on("game.base.utils.MyAnimation.End",this,this.a3end ,[a3]);
			a3.play();
			Laya.stage.addChild(card);
		}
	}

	/**展示 动画完毕 增加点击事件*/
	__proto.a3end=function(a3){
		if(a3!=null){
			a3.off("game.base.utils.MyAnimation.End",this,this.a3end);
			var card=a3.getCard();
			card.kar.on("click",this,this.clickFun,[card]);
			Laya.timer.once(5000,this,this.tonce,[card]);
			card.addChildAt(this.t,0);
			card.addChild(this.paoguang);
			card.addChild(this.baozha);
			this.t.start();
			this.paoguang.start();
			this.baozha.start();
		}
	}

	__proto.tonce=function(card){
		this.clickFun(card);
	}

	/**点击后处理 检查是否解锁UI层*/
	__proto.clickFun=function(card){
		App.voiceManager.stopSound("gethero.wav");
		Laya.timer.clear(this,this.tonce);
		card.kar.off("click",this,this.clickFun);
		if(this.isZhaomu){
			card.y+=600;
			card.removeSelf();
		}
		else{
			FlyToBagEffect.flyToBag(card);
		}
		this.showCard();
		this.tempNum--;
		if(this.tempNum<=0){
			Dialog.manager.lock(false);
			ZhaomuDirector.black.removeSelf();
			App.eventManager.event("ZHAOMUCOM");
		}
		this.t.stop();
		this.paoguang.stop();
		this.baozha.stop();
	}

	/**武魂渐隐*/
	__proto.a2end=function(a2,card){
		this.tempNum--;
		if(a2!=null)a2.off("game.base.utils.MyAnimation.End",this,this.a2end);
		if(this.tempNum<=0){
			Dialog.manager.lock(false);
			ZhaomuDirector.black.removeSelf();
			App.eventManager.event("ZHAOMUCOM");
		};
		var zm=App.dialogManager.getDialogBystr("DIALOG_ZHAO_MU");
		var lp=zm.mingzi.localToGlobal(new Point());
		SoulFly.fly(card.x,card.y,lp.x+15 ,lp.y+13);
	}

	/**翻牌完毕*/
	__proto.a1end=function(a1){
		this.tempNum--;
		a1.off("game.base.utils.MyAnimation.End",this,this.a1end);
		if(this.tempNum<=0){
			this.step++;
			this.play();
		}
	}

	/**水平飞行完毕*/
	__proto.a20end=function(a20){
		if(a20==null){
			this.step++;
			this.play();
			return;
		}
		a20.off("game.base.utils.MyAnimation.End",this,this.a20end);
		this.tempNum--;
		if(this.tempNum<=0){
			this.step++;
			this.play();
		}
	}

	/**垂直飞行完毕*/
	__proto.a10end=function(a10){
		a10.off("game.base.utils.MyAnimation.End",this,this.a10end);
		this.tempNum--;
		if(this.tempNum==0){
			Laya.timer.once(500,this,this.a10endgo);
		}
	}

	__proto.a10endgo=function(){
		this.step++;
		this.play();
	}

	__static(ZhaomuDirector,
	['black',function(){return this.black=new Sprite();}
	]);
	return ZhaomuDirector;
})(EventDispatcher)


//class scene.LoginSceneMediator extends game.mvc.Mediator
var LoginSceneMediator=(function(_super){
	function LoginSceneMediator(sprite){
		this.loginScene=null;
		this.loginSession=null;
		this._$1_autoEvent=new AutoEvent();
		LoginSceneMediator.__super.call(this,sprite);
		this.loginScene=sprite;
		this.loginScene.zhanghao.visible=false;
		this.loginScene.zhanghao.centerX=0;
		if(MyGameInit.isFlySDK()){
			this.sdkInit();
			}else if(MyGameInit.isFaceBook()){
			this.faceBookInit();
			}else if(MyGameInit.isWeb()){
			this.webInit();
			}else{
			this.normalInit();
		}
		App.voiceManager.playMusic("bgm1.mp3");
	}

	__class(LoginSceneMediator,'scene.LoginSceneMediator',_super);
	var __proto=LoginSceneMediator.prototype;
	//sprite.on(Event.UNDISPLAY,this,undisFun);
	__proto.normalInit=function(){
		this.loginScene.goBtn.clickHandler=new Handler(this,this.normalLoginFun);
	}

	__proto.normalLoginFun=function(){
		this.loginSession.loginMasterServer();
		LoadMask.show(5000);
		this.addEventClose();
	}

	// }
	__proto.faceBookInit=function(){
		this.loginScene.goBtn.clickHandler=new Handler(this,this.faceBookLoginFun);
	}

	__proto.faceBookLoginFun=function(){
		console.log("点击登陆",this.loginSession.sdkPlayerId);
		if(Browser.window.fbid !=null){
			this.loginSession.sdkPlayerId=Browser.window.fbid;
		}
		if(this.loginSession.sdkPlayerId==null){
			App.eventManager.event("SDK_INIT");
			return;
		}
		this.loginSession.loginMasterServer();
		LoadMask.show(5000);
		this.addEventClose();
	}

	__proto.sdkInit=function(){
		SDKManager.callSDK("INIT_SDK");
		this.loginScene.goBtn.clickHandler=new Handler(this,this.sdkLoginFun);
		this.loginScene.haoBtn.clickHandler=new Handler(this,this.accountsFun);
		this.loginScene.gaoBtn.clickHandler=new Handler(this,this.noticeFun);
	}

	__proto.webInit=function(){
		this.loginScene.zhanghao.visible=true;
		var playerId=LocalStorage.getItem("playerId");
		this.loginScene.zhanghao.text=(playerId?playerId:"请输入账号");
		this.loginScene.goBtn.clickHandler=new Handler(this,this.webLoginFun);
	}

	/**
	*点击登陆按钮 如果sdk没登陆就调用sdk登陆请求
	*/
	__proto.sdkLoginFun=function(){
		if(this.loginSession.sdkPlayerId==null){
			SDKManager.callSDK("LOGIN_SDK");
			}else{
			this.loginSession.loginMasterServer();
			LoadMask.show(5000);
			this.addEventClose();
		}
	}

	//this.addEventClose();
	__proto.webLoginFun=function(){
		var text=this.loginScene.zhanghao.text;
		if(text=="请输入账号" || text==""){
			FlyUpTips.setTips("请输入账号");
			return;
		}
		LocalStorage.setItem("playerId",text);
		this.loginSession.setSdkPlayerId(text);
		this.loginSession.loginMasterServer();
		LoadMask.show(5000);
		this.addEventClose();
	}

	/**
	*有可能是创角 那就不链接socket 所以监听两个事件
	*/
	__proto.addEventClose=function(){
		this._$1_autoEvent.add("LOGIN_BACK_CLOSE_MASK",this,this.loginBackFun);
		this._$1_autoEvent.add("CONNECT_SERVER_OK",this,this.loginSucFun);
		this._$1_autoEvent.add("LOGIN_SDK_CANCEL",this,this.loginBackFun);
		this._$1_autoEvent.addEventNow();
	}

	__proto.loginSucFun=function(){
		this.loginScene.hideGoBtn();
		this.loginBackFun();
	}

	/**
	*登陆返回
	*/
	__proto.loginBackFun=function(){
		LoadMask.close();
		this._$1_autoEvent.removeAllEvent();
	}

	__proto.noticeFun=function(){}
	__proto.accountsFun=function(){}
	LoginSceneMediator.INPUT_TEXT="请输入账号";
	return LoginSceneMediator;
})(Mediator)


/**
*<code>AnimationPlayer</code> 类用于动画播放器。
*/
//class laya.ani.AnimationPlayer extends laya.events.EventDispatcher
var AnimationPlayer=(function(_super){
	function AnimationPlayer(){
		/**@private */
		this._destroyed=false;
		/**数据模板*/
		this._templet=null;
		/**当前精确时间，不包括重播时间*/
		this._currentTime=NaN;
		/**当前帧时间，不包括重播时间*/
		this._currentFrameTime=NaN;
		/**动画播放的起始时间位置*/
		this._playStart=NaN;
		/**动画播放的结束时间位置*/
		this._playEnd=NaN;
		/**动画播放一次的总时间*/
		this._playDuration=NaN;
		/**动画播放总时间*/
		this._overallDuration=NaN;
		/**是否在一帧结束时停止*/
		this._stopWhenCircleFinish=false;
		/**已播放时间，包括重播时间*/
		this._elapsedPlaybackTime=NaN;
		/**播放时帧数*/
		this._startUpdateLoopCount=NaN;
		/**当前动画索引*/
		this._currentAnimationClipIndex=0;
		/**当前帧数*/
		this._currentKeyframeIndex=0;
		/**是否暂停*/
		this._paused=false;
		/**默认帧率,必须大于0*/
		this._cacheFrameRate=0;
		/**帧率间隔时间*/
		this._cacheFrameRateInterval=NaN;
		/**缓存播放速率*/
		this._cachePlayRate=NaN;
		this._fullFrames=null;
		/**是否缓存*/
		this.isCache=true;
		/**播放速率*/
		this.playbackRate=1.0;
		/**停止时是否归零*/
		this.returnToZeroStopped=false;
		AnimationPlayer.__super.call(this);
		this._destroyed=false;
		this._currentAnimationClipIndex=-1;
		this._currentKeyframeIndex=-1;
		this._currentTime=0.0;
		this._overallDuration=Number.MAX_VALUE;
		this._stopWhenCircleFinish=false;
		this._elapsedPlaybackTime=0;
		this._startUpdateLoopCount=-1;
		this._cachePlayRate=1.0;
		this.cacheFrameRate=60;
		this.returnToZeroStopped=false;
	}

	__class(AnimationPlayer,'laya.ani.AnimationPlayer',_super);
	var __proto=AnimationPlayer.prototype;
	Laya.imps(__proto,{"laya.resource.IDestroy":true})
	/**
	*@private
	*/
	__proto._onTempletLoadedComputeFullKeyframeIndices=function(cachePlayRate,cacheFrameRate,templet){
		if (this._templet===templet && this._cachePlayRate===cachePlayRate && this._cacheFrameRate===cacheFrameRate)
			this._computeFullKeyframeIndices();
	}

	/**
	*@private
	*/
	__proto._computeFullKeyframeIndices=function(){
		var anifullFrames=this._fullFrames=[];
		var templet=this._templet;
		var cacheFrameInterval=this._cacheFrameRateInterval *this._cachePlayRate;
		for (var i=0,iNum=templet.getAnimationCount();i < iNum;i++){
			var aniFullFrame=[];
			for (var j=0,jNum=templet.getAnimation(i).nodes.length;j < jNum;j++){
				var node=templet.getAnimation(i).nodes[j];
				var frameCount=Math.floor(node.playTime / cacheFrameInterval+0.01);
				var nodeFullFrames=new Uint16Array(frameCount+1);
				var lastFrameIndex=-1;
				for (var n=0,nNum=node.keyFrame.length;n < nNum;n++){
					var keyFrame=node.keyFrame[n];
					var tm=keyFrame.startTime;
					var endTm=tm+keyFrame.duration+cacheFrameInterval;
					do {
						var frameIndex=Math.floor(tm / cacheFrameInterval+0.5);
						for (var k=lastFrameIndex+1;k < frameIndex;k++)
						nodeFullFrames[k]=n;
						lastFrameIndex=frameIndex;
						nodeFullFrames[frameIndex]=n;
						tm+=cacheFrameInterval;
					}while (tm <=endTm);
				}
				aniFullFrame.push(nodeFullFrames);
			}
			anifullFrames.push(aniFullFrame);
		}
	}

	/**
	*@private
	*/
	__proto._onAnimationTempletLoaded=function(){
		(this.destroyed)|| (this._calculatePlayDuration());
	}

	/**
	*@private
	*/
	__proto._calculatePlayDuration=function(){
		if (this.state!==0){
			var oriDuration=this._templet.getAniDuration(this._currentAnimationClipIndex);
			(this._playEnd===0)&& (this._playEnd=oriDuration);
			if (this._playEnd > oriDuration)
				this._playEnd=oriDuration;
			this._playDuration=this._playEnd-this._playStart;
		}
	}

	/**
	*@private
	*/
	__proto._setPlayParams=function(time,cacheFrameInterval){
		this._currentTime=time;
		this._currentKeyframeIndex=Math.max(Math.floor((this.currentPlayTime)/ cacheFrameInterval+0.01),0);
		this._currentFrameTime=this._currentKeyframeIndex *cacheFrameInterval;
	}

	/**
	*@private
	*/
	__proto._setPlayParamsWhenStop=function(currentAniClipPlayDuration,cacheFrameInterval){
		this._currentTime=currentAniClipPlayDuration;
		this._currentKeyframeIndex=Math.max(Math.floor(currentAniClipPlayDuration / cacheFrameInterval+0.01),0);
		this._currentFrameTime=this._currentKeyframeIndex *cacheFrameInterval;
		this._currentAnimationClipIndex=-1;
	}

	/**
	*@private
	*/
	__proto._update=function(elapsedTime){
		if (this._currentAnimationClipIndex===-1 || this._paused || !this._templet || !this._templet.loaded)
			return;
		var cacheFrameInterval=this._cacheFrameRateInterval *this._cachePlayRate;
		var time=0;
		(this._startUpdateLoopCount!==Stat.loopCount)&& (time=elapsedTime *this.playbackRate,this._elapsedPlaybackTime+=time);
		var currentAniClipPlayDuration=this.playDuration;
		if ((this._overallDuration!==0 && this._elapsedPlaybackTime >=this._overallDuration)|| (this._overallDuration===0 && this._elapsedPlaybackTime >=currentAniClipPlayDuration)){
			this._setPlayParamsWhenStop(currentAniClipPlayDuration,cacheFrameInterval);
			this.event("stopped");
			return;
		}
		time+=this._currentTime;
		if (currentAniClipPlayDuration > 0){
			if (time >=currentAniClipPlayDuration){
				do {
					time-=currentAniClipPlayDuration;
					if (this._stopWhenCircleFinish){
						this._setPlayParamsWhenStop(currentAniClipPlayDuration,cacheFrameInterval);
						this._stopWhenCircleFinish=false;
						this.event("stopped");
						return;
					}
					if (time < currentAniClipPlayDuration){
						this._setPlayParams(time,cacheFrameInterval);
						this.event("complete");
					}
				}while (time >=currentAniClipPlayDuration)
				}else {
				this._setPlayParams(time,cacheFrameInterval);
			}
			}else {
			if (this._stopWhenCircleFinish){
				this._setPlayParamsWhenStop(currentAniClipPlayDuration,cacheFrameInterval);
				this._stopWhenCircleFinish=false;
				this.event("stopped");
				return;
			}
			this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0;
			this.event("complete");
		}
	}

	/**
	*@private
	*/
	__proto._destroy=function(){
		this.offAll();
		this._templet=null;
		this._fullFrames=null;
		this._destroyed=true;
	}

	/**
	*播放动画。
	*@param index 动画索引。
	*@param playbackRate 播放速率。
	*@param duration 播放时长（0为1次,Number.MAX_VALUE为循环播放）。
	*@param playStart 播放的起始时间位置。
	*@param playEnd 播放的结束时间位置。（0为动画一次循环的最长结束时间位置）。
	*/
	__proto.play=function(index,playbackRate,overallDuration,playStart,playEnd){
		(index===void 0)&& (index=0);
		(playbackRate===void 0)&& (playbackRate=1.0);
		(overallDuration===void 0)&& (overallDuration=2147483647);
		(playStart===void 0)&& (playStart=0);
		(playEnd===void 0)&& (playEnd=0);
		if (!this._templet)
			throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");
		if (overallDuration < 0 || playStart < 0 || playEnd < 0)
			throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");
		if ((playEnd!==0)&& (playStart > playEnd))
			throw new Error("AnimationPlayer:start must less than end.");
		this._currentTime=0;
		this._currentFrameTime=0;
		this._elapsedPlaybackTime=0;
		this.playbackRate=playbackRate;
		this._overallDuration=overallDuration;
		this._playStart=playStart;
		this._playEnd=playEnd;
		this._paused=false;
		this._currentAnimationClipIndex=index;
		this._currentKeyframeIndex=0;
		this._startUpdateLoopCount=Stat.loopCount;
		this.event("played");
		if (this._templet.loaded)
			this._calculatePlayDuration();
		else
		this._templet.once("loaded",this,this._onAnimationTempletLoaded);
		this._update(0);
	}

	/**
	*播放动画。
	*@param index 动画索引。
	*@param playbackRate 播放速率。
	*@param duration 播放时长（0为1次,Number.MAX_VALUE为循环播放）。
	*@param playStartFrame 播放的原始起始帧率位置。
	*@param playEndFrame 播放的原始结束帧率位置。（0为动画一次循环的最长结束时间位置）。
	*/
	__proto.playByFrame=function(index,playbackRate,overallDuration,playStartFrame,playEndFrame,fpsIn3DBuilder){
		(index===void 0)&& (index=0);
		(playbackRate===void 0)&& (playbackRate=1.0);
		(overallDuration===void 0)&& (overallDuration=2147483647);
		(playStartFrame===void 0)&& (playStartFrame=0);
		(playEndFrame===void 0)&& (playEndFrame=0);
		(fpsIn3DBuilder===void 0)&& (fpsIn3DBuilder=30);
		var interval=1000.0 / fpsIn3DBuilder;
		this.play(index,playbackRate,overallDuration,playStartFrame *interval,playEndFrame *interval);
	}

	/**
	*停止播放当前动画
	*@param immediate 是否立即停止
	*/
	__proto.stop=function(immediate){
		(immediate===void 0)&& (immediate=true);
		if (immediate){
			this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0;
			this._currentAnimationClipIndex=-1;
			this.event("stopped");
			}else {
			this._stopWhenCircleFinish=true;
		}
	}

	/**
	*动画播放的结束时间位置。
	*@return 结束时间位置。
	*/
	__getset(0,__proto,'playEnd',function(){
		return this._playEnd;
	});

	/**
	*设置动画数据模板,注意：修改此值会有计算开销。
	*@param value 动画数据模板
	*/
	/**
	*获取动画数据模板
	*@param value 动画数据模板
	*/
	__getset(0,__proto,'templet',function(){
		return this._templet;
		},function(value){
		if (!this.state===0)
			this.stop(true);
		if (this._templet!==value){
			this._templet=value;
			if (value.loaded)
				this._computeFullKeyframeIndices();
			else
			value.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]);
		}
	});

	/**
	*动画播放的起始时间位置。
	*@return 起始时间位置。
	*/
	__getset(0,__proto,'playStart',function(){
		return this._playStart;
	});

	/**
	*获取动画播放一次的总时间
	*@return 动画播放一次的总时间
	*/
	__getset(0,__proto,'playDuration',function(){
		return this._playDuration;
	});

	/**
	*获取当前播放状态
	*@return 当前播放状态
	*/
	__getset(0,__proto,'state',function(){
		if (this._currentAnimationClipIndex===-1)
			return 0;
		if (this._paused)
			return 1;
		return 2;
	});

	/**
	*获取当前帧数
	*@return 当前帧数
	*/
	__getset(0,__proto,'currentKeyframeIndex',function(){
		return this._currentKeyframeIndex;
	});

	/**
	*获取动画播放的总总时间
	*@return 动画播放的总时间
	*/
	__getset(0,__proto,'overallDuration',function(){
		return this._overallDuration;
	});

	/**
	*获取当前帧时间，不包括重播时间
	*@return value 当前时间
	*/
	__getset(0,__proto,'currentFrameTime',function(){
		return this._currentFrameTime;
	});

	/**
	*获取当前动画索引
	*@return value 当前动画索引
	*/
	__getset(0,__proto,'currentAnimationClipIndex',function(){
		return this._currentAnimationClipIndex;
	});

	/**
	*获取当前精确时间，不包括重播时间
	*@return value 当前时间
	*/
	__getset(0,__proto,'currentPlayTime',function(){
		return this._currentTime+this._playStart;
	});

	/**
	*设置缓存播放速率,默认值为1.0,注意：修改此值会有计算开销。*
	*@return value 缓存播放速率。
	*/
	/**
	*获取缓存播放速率。*
	*@return 缓存播放速率。
	*/
	__getset(0,__proto,'cachePlayRate',function(){
		return this._cachePlayRate;
		},function(value){
		if (this._cachePlayRate!==value){
			this._cachePlayRate=value;
			if (this._templet)
				if (this._templet.loaded)
			this._computeFullKeyframeIndices();
			else
			this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[value,this._cacheFrameRate]);
		}
	});

	/**
	*设置默认帧率,每秒60帧,注意：修改此值会有计算开销。*
	*@return value 缓存帧率
	*/
	/**
	*获取默认帧率*
	*@return value 默认帧率
	*/
	__getset(0,__proto,'cacheFrameRate',function(){
		return this._cacheFrameRate;
		},function(value){
		if (this._cacheFrameRate!==value){
			this._cacheFrameRate=value;
			this._cacheFrameRateInterval=1000.0 / this._cacheFrameRate;
			if (this._templet)
				if (this._templet.loaded)
			this._computeFullKeyframeIndices();
			else
			this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,value]);
		}
	});

	/**
	*设置当前播放位置
	*@param value 当前时间
	*/
	__getset(0,__proto,'currentTime',null,function(value){
		if (this._currentAnimationClipIndex===-1 || !this._templet || !this._templet.loaded)
			return;
		if (value < this._playStart || value > this._playEnd)
			throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");
		this._startUpdateLoopCount=Stat.loopCount;
		var cacheFrameInterval=this._cacheFrameRateInterval *this._cachePlayRate;
		this._currentTime=value;
		this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime / cacheFrameInterval),0);
		this._currentFrameTime=this._currentKeyframeIndex *cacheFrameInterval;
	});

	/**
	*设置是否暂停
	*@param value 是否暂停
	*/
	/**
	*获取当前是否暂停
	*@return 是否暂停
	*/
	__getset(0,__proto,'paused',function(){
		return this._paused;
		},function(value){
		this._paused=value;
		value && this.event("paused");
	});

	/**
	*获取缓存帧率间隔时间
	*@return 缓存帧率间隔时间
	*/
	__getset(0,__proto,'cacheFrameRateInterval',function(){
		return this._cacheFrameRateInterval;
	});

	/**
	*获取是否已销毁。
	*@return 是否已销毁。
	*/
	__getset(0,__proto,'destroyed',function(){
		return this._destroyed;
	});

	return AnimationPlayer;
})(EventDispatcher)


/**
*@private
*<code>Resource</code> 资源存取类。
*/
//class laya.resource.Resource extends laya.events.EventDispatcher
var Resource=(function(_super){
	function Resource(){
		/**@private */
		//this.__loaded=false;
		/**@private */
		//this._id=0;
		/**@private */
		//this._memorySize=0;
		/**@private */
		//this._released=false;
		/**@private */
		//this._destroyed=false;
		/**@private */
		//this._referenceCount=0;
		/**@private */
		//this._group=null;
		/**@private */
		//this._url=null;
		/**@private */
		//this._resourceManager=null;
		/**@private */
		//this._lastUseFrameCount=0;
		/**是否加锁，如果true为不能使用自动释放机制。*/
		//this.lock=false;
		/**名称。 */
		//this.name=null;
		Resource.__super.call(this);
		this._$1__id=++Resource._uniqueIDCounter;
		this.__loaded=true;
		this._destroyed=false;
		this._referenceCount=0;
		Resource._idResourcesMap[this.id]=this;
		this._released=true;
		this.lock=false;
		this._memorySize=0;
		this._lastUseFrameCount=-1;
		(ResourceManager.currentResourceManager)&& (ResourceManager.currentResourceManager.addResource(this));
	}

	__class(Resource,'laya.resource.Resource',_super);
	var __proto=Resource.prototype;
	Laya.imps(__proto,{"laya.resource.ICreateResource":true,"laya.resource.IDispose":true})
	/**
	*@private
	*/
	__proto._setUrl=function(url){
		if (this._url!==url){
			var resList;
			if (this._url){
				resList=Resource._urlResourcesMap[this._url];
				resList.splice(resList.indexOf(this),1);
				(resList.length===0)&& (delete Resource._urlResourcesMap[this._url]);
			}
			if (url){
				resList=Resource._urlResourcesMap[url];
				(resList)|| (Resource._urlResourcesMap[url]=resList=[]);
				resList.push(this);
			}
			this._url=url;
		}
	}

	/**
	*@private
	*/
	__proto._getGroup=function(){
		return this._group;
	}

	/**
	*@private
	*/
	__proto._setGroup=function(value){
		if (this._group!==value){
			var groupList;
			if (this._group){
				groupList=Resource._groupResourcesMap[this._group];
				groupList.splice(groupList.indexOf(this),1);
				(groupList.length===0)&& (delete Resource._groupResourcesMap[this._group]);
			}
			if (value){
				groupList=Resource._groupResourcesMap[value];
				(groupList)|| (Resource._groupResourcesMap[value]=groupList=[]);
				groupList.push(this);
			}
			this._group=value;
		}
	}

	/**
	*@private
	*/
	__proto._addReference=function(){
		this._referenceCount++;
	}

	/**
	*@private
	*/
	__proto._removeReference=function(){
		this._referenceCount--;
	}

	/**
	*@private
	*/
	__proto._clearReference=function(){
		this._referenceCount=0;
	}

	/**
	*@private
	*/
	__proto._endLoaded=function(){
		this.__loaded=true;
		this.event("loaded",this);
	}

	/**
	*@private
	*/
	__proto.recreateResource=function(){
		this.completeCreate();
	}

	/**
	*@private
	*/
	__proto.disposeResource=function(){}
	/**
	*激活资源，使用资源前应先调用此函数激活。
	*@param force 是否强制创建。
	*/
	__proto.activeResource=function(force){
		(force===void 0)&& (force=false);
		this._lastUseFrameCount=Stat.loopCount;
		if (!this._destroyed && this.__loaded && (this._released || force))
			this.recreateResource();
	}

	/**
	*释放资源。
	*@param force 是否强制释放。
	*@return 是否成功释放。
	*/
	__proto.releaseResource=function(force){
		(force===void 0)&& (force=false);
		if (!force && this.lock)
			return false;
		if (!this._released || force){
			this.disposeResource();
			this._released=true;
			this._lastUseFrameCount=-1;
			this.event("released",this);
			return true;
			}else {
			return false;
		}
	}

	/**
	*@private
	*/
	__proto.onAsynLoaded=function(url,data,params){
		throw new Error("Resource: must override this function!");
	}

	/**
	*<p>彻底处理资源，处理后不能恢复。</p>
	*<p><b>注意：</b>会强制解锁清理。</p>
	*/
	__proto.destroy=function(){
		if (this._destroyed)
			return;
		if (this._resourceManager!==null)
			this._resourceManager.removeResource(this);
		this._destroyed=true;
		this.lock=false;
		this.releaseResource();
		delete Resource._idResourcesMap[this.id];
		var resList;
		if (this._url){
			resList=Resource._urlResourcesMap[this._url];
			if (resList){
				resList.splice(resList.indexOf(this),1);
				(resList.length===0)&& (delete Resource._urlResourcesMap[this.url]);
			}
			Loader.clearRes(this._url);
			(this.__loaded)||(RunDriver.cancelLoadByUrl(this._url));
		}
		if (this._group){
			resList=Resource._groupResourcesMap[this._group];
			resList.splice(resList.indexOf(this),1);
			(resList.length===0)&& (delete Resource._groupResourcesMap[this.url]);
		}
	}

	/**完成资源激活。*/
	__proto.completeCreate=function(){
		this._released=false;
		this.event("recovered",this);
	}

	/**
	*@private
	*/
	__proto.dispose=function(){
		this.destroy();
	}

	/**
	*@private
	*/
	/**
	*占用内存尺寸。
	*/
	__getset(0,__proto,'memorySize',function(){
		return this._memorySize;
		},function(value){
		var offsetValue=value-this._memorySize;
		this._memorySize=value;
		this.resourceManager && this.resourceManager.addSize(offsetValue);
	});

	/**
	*@private
	*/
	__getset(0,__proto,'_loaded',null,function(value){
		this.__loaded=value;
	});

	/**
	*获取是否已加载完成。
	*/
	__getset(0,__proto,'loaded',function(){
		return this.__loaded;
	});

	/**
	*获取唯一标识ID,通常用于识别。
	*/
	__getset(0,__proto,'id',function(){
		return this._$1__id;
	});

	/**
	*是否已处理。
	*/
	__getset(0,__proto,'destroyed',function(){
		return this._destroyed;
	});

	/**
	*设置资源组名。
	*/
	/**
	*获取资源组名。
	*/
	__getset(0,__proto,'group',function(){
		return this._getGroup();
		},function(value){
		this._setGroup(value);
	});

	/**
	*资源管理员。
	*/
	__getset(0,__proto,'resourceManager',function(){
		return this._resourceManager;
	});

	/**
	*获取资源的URL地址。
	*@return URL地址。
	*/
	__getset(0,__proto,'url',function(){
		return this._url;
	});

	/**
	*是否已释放。
	*/
	__getset(0,__proto,'released',function(){
		return this._released;
	});

	/**
	*获取资源的引用计数。
	*/
	__getset(0,__proto,'referenceCount',function(){
		return this._referenceCount;
	});

	Resource.getResourceByID=function(id){
		return Resource._idResourcesMap[id];
	}

	Resource.getResourceByURL=function(url,index){
		(index===void 0)&& (index=0);
		return Resource._urlResourcesMap[url][index];
	}

	Resource.getResourceCountByURL=function(url){
		return Resource._urlResourcesMap[url].length;
	}

	Resource.destroyUnusedResources=function(group){
		var res;
		if (group){
			var resouList=Resource._groupResourcesMap[group];
			if (resouList){
				var tempResouList=resouList.slice();
				for (var i=0,n=tempResouList.length;i < n;i++){
					res=tempResouList[i];
					if (!res.lock && res._referenceCount===0)
						res.destroy();
				}
			}
			}else {
			for (var k in Resource._idResourcesMap){
				res=Resource._idResourcesMap[k];
				if (!res.lock && res._referenceCount===0)
					res.destroy();
			}
		}
	}

	Resource._uniqueIDCounter=0;
	Resource._idResourcesMap={};
	Resource._urlResourcesMap={};
	Resource._groupResourcesMap={};
	return Resource;
})(EventDispatcher)


/**
*<p> <code>LoaderManager</code> 类用于用于批量加载资源。此类是单例，不要手动实例化此类，请通过Laya.loader访问。</p>
*<p>全部队列加载完成，会派发 Event.COMPLETE 事件；如果队列中任意一个加载失败，会派发 Event.ERROR 事件，事件回调参数值为加载出错的资源地址。</p>
*<p> <code>LoaderManager</code> 类提供了以下几种功能：<br/>
*多线程：默认5个加载线程，可以通过maxLoader属性修改线程数量；<br/>
*多优先级：有0-4共5个优先级，优先级高的优先加载。0最高，4最低；<br/>
*重复过滤：自动过滤重复加载（不会有多个相同地址的资源同时加载）以及复用缓存资源，防止重复加载；<br/>
*错误重试：资源加载失败后，会重试加载（以最低优先级插入加载队列），retryNum设定加载失败后重试次数，retryDelay设定加载重试的时间间隔。</p>
*@see laya.net.Loader
*/
//class laya.net.LoaderManager extends laya.events.EventDispatcher
var LoaderManager=(function(_super){
	var ResInfo;
	function LoaderManager(){
		/**加载出错后的重试次数，默认重试一次*/
		this.retryNum=1;
		/**延迟时间多久再进行错误重试，默认立即重试*/
		this.retryDelay=0;
		/**最大下载线程，默认为5个*/
		this.maxLoader=5;
		/**@private */
		this._loaders=[];
		/**@private */
		this._loaderCount=0;
		/**@private */
		this._resInfos=[];
		/**@private */
		this._infoPool=[];
		/**@private */
		this._maxPriority=5;
		/**@private */
		this._failRes={};
		LoaderManager.__super.call(this);
		for (var i=0;i < this._maxPriority;i++)this._resInfos[i]=[];
	}

	__class(LoaderManager,'laya.net.LoaderManager',_super);
	var __proto=LoaderManager.prototype;
	/**
	*<p>根据clas类型创建一个未初始化资源的对象，随后进行异步加载，资源加载完成后，初始化对象的资源，并通过此对象派发 Event.LOADED 事件，事件回调参数值为此对象本身。套嵌资源的子资源会保留资源路径"?"后的部分。</p>
	*<p>如果url为数组，返回true；否则返回指定的资源类对象，可以通过侦听此对象的 Event.LOADED 事件来判断资源是否已经加载完毕。</p>
	*<p><b>注意：</b>cache参数只能对文件后缀为atlas的资源进行缓存控制，其他资源会忽略缓存，强制重新加载。</p>
	*@param url 资源地址或者数组。如果url和clas同时指定了资源类型，优先使用url指定的资源类型。参数形如：[{url:xx,clas:xx,priority:xx,params:xx},{url:xx,clas:xx,priority:xx,params:xx}]。
	*@param complete 加载结束回调。根据url类型不同分为2种情况：1. url为String类型，也就是单个资源地址，如果加载成功，则回调参数值为加载完成的资源，否则为null；2. url为数组类型，指定了一组要加载的资源，如果全部加载成功，则回调参数值为true，否则为false。
	*@param progress 资源加载进度回调，回调参数值为当前资源加载的进度信息(0-1)。
	*@param clas 资源类名。如果url和clas同时指定了资源类型，优先使用url指定的资源类型。参数形如：Texture。
	*@param params 资源构造参数。
	*@param priority (default=1)加载的优先级，优先级高的优先加载。有0-4共5个优先级，0最高，4最低。
	*@param cache 是否缓存加载的资源。
	*@return 如果url为数组，返回true；否则返回指定的资源类对象。
	*/
	__proto.create=function(url,complete,progress,clas,params,priority,cache,group){
		(priority===void 0)&& (priority=1);
		(cache===void 0)&& (cache=true);
		if ((url instanceof Array)){
			var items=url;
			var itemCount=items.length;
			var loadedCount=0;
			if (progress){
				var progress2=Handler.create(progress.caller,progress.method,progress.args,false);
			}
			for (var i=0;i < itemCount;i++){
				var item=items[i];
				if ((typeof item=='string'))
					item=items[i]={url:item};
				item.progress=0;
			}
			for (i=0;i < itemCount;i++){
				item=items[i];
				var progressHandler=progress ? Handler.create(null,onProgress,[item],false):null;
				var completeHandler=(progress || complete)? Handler.create(null,onComplete,[item]):null;
				this._create(item.url,completeHandler,progressHandler,item.clas || clas,item.params || params,item.priority || priority,cache,item.group || group);
			}
			function onComplete (item,content){
				loadedCount++;
				item.progress=1;
				if (loadedCount===itemCount && complete){
					complete.run();
				}
			}
			function onProgress (item,value){
				item.progress=value;
				var num=0;
				for (var j=0;j < itemCount;j++){
					var item1=items[j];
					num+=item1.progress;
				};
				var v=num / itemCount;
				progress2.runWith(v);
			}
			return true;
		}else return this._create(url,complete,progress,clas,params,priority,cache,group);
	}

	__proto._create=function(url,complete,progress,clas,params,priority,cache,group){
		(priority===void 0)&& (priority=1);
		(cache===void 0)&& (cache=true);
		var formarUrl=URL.formatURL(url);
		var item=this.getRes(formarUrl);
		if (!item){
			var extension=Utils.getFileExtension(url);
			var creatItem=LoaderManager.createMap[extension];
			if (!creatItem)
				throw new Error("LoaderManager:unknown file("+url+") extension with: "+extension+".");
			if (!clas)clas=creatItem[0];
			var type=creatItem[1];
			if (extension=="atlas"){
				this.load(url,complete,progress,type,priority,cache);
				}else {
				if (clas===Texture)type="htmlimage";
				item=clas ? new clas():null;
				if (item.hasOwnProperty("_loaded"))
					item._loaded=false;
				item._setUrl(url);
				(group)&& (item._setGroup(group));
				this._createLoad(item,url,Handler.create(null,onLoaded),progress,type,priority,false,group,true);
				function onLoaded (data){
					(item && !item.destroyed && data)&& (item.onAsynLoaded.call(item,url,data,params));
					if (complete)complete.run();
					Laya.loader.event(url);
				}
				(cache)&& (this.cacheRes(formarUrl,item));
			}
			}else {
			if (!item.hasOwnProperty("loaded")|| item.loaded){
				progress && progress.runWith(1);
				complete && complete.run();
				}else if (complete){
				Laya.loader._createListener(url,complete.caller,complete.method,complete.args,true,false);
			}
		}
		return item;
	}

	/**
	*<p>加载资源。资源加载错误时，本对象会派发 Event.ERROR 事件，事件回调参数值为加载出错的资源地址。</p>
	*<p>因为返回值为 LoaderManager 对象本身，所以可以使用如下语法：Laya.loader.load(...).load(...);</p>
	*@param url 要加载的单个资源地址或资源信息数组。比如：简单数组：["a.png","b.png"]；复杂数组[{url:"a.png",type:Loader.IMAGE,size:100,priority:1},{url:"b.json",type:Loader.JSON,size:50,priority:1}]。
	*@param complete 加载结束回调。根据url类型不同分为2种情况：1. url为String类型，也就是单个资源地址，如果加载成功，则回调参数值为加载完成的资源，否则为null；2. url为数组类型，指定了一组要加载的资源，如果全部加载成功，则回调参数值为true，否则为false。
	*@param progress 加载进度回调。回调参数值为当前资源的加载进度信息(0-1)。
	*@param type 资源类型。比如：Loader.IMAGE。
	*@param priority (default=1)加载的优先级，优先级高的优先加载。有0-4共5个优先级，0最高，4最低。
	*@param cache 是否缓存加载结果。
	*@param group 分组，方便对资源进行管理。
	*@param ignoreCache 是否忽略缓存，强制重新加载。
	*@return 此 LoaderManager 对象本身。
	*/
	__proto.load=function(url,complete,progress,type,priority,cache,group,ignoreCache){
		var _$this=this;
		(priority===void 0)&& (priority=1);
		(cache===void 0)&& (cache=true);
		(ignoreCache===void 0)&& (ignoreCache=false);
		if ((url instanceof Array))return this._loadAssets(url,complete,progress,type,priority,cache,group);
		var content=Loader.getRes(url);
		if (content !=null){
			Laya.timer.frameOnce(1,null,function(){
				progress && progress.runWith(1);
				complete && complete.runWith(content);
				_$this._loaderCount || _$this.event("complete");
			});
			}else {
			var info=LoaderManager._resMap[url];
			if (!info){
				info=this._infoPool.length ? this._infoPool.pop():new ResInfo();
				info.url=url;
				info.type=type;
				info.cache=cache;
				info.group=group;
				info.ignoreCache=ignoreCache;
				complete && info.on("complete",complete.caller,complete.method,complete.args);
				progress && info.on("progress",progress.caller,progress.method,progress.args);
				LoaderManager._resMap[url]=info;
				priority=priority < this._maxPriority ? priority :this._maxPriority-1;
				this._resInfos[priority].push(info);
				this._next();
				}else {
				complete && info._createListener("complete",complete.caller,complete.method,complete.args,false,false);
				progress && info._createListener("progress",progress.caller,progress.method,progress.args,false,false);
			}
		}
		return this;
	}

	/**
	*@private
	*/
	__proto._createLoad=function(item,url,complete,progress,type,priority,cache,group,ignoreCache){
		var _$this=this;
		(priority===void 0)&& (priority=1);
		(cache===void 0)&& (cache=true);
		(ignoreCache===void 0)&& (ignoreCache=false);
		if ((url instanceof Array))return this._loadAssets(url,complete,progress,type,priority,cache,group);
		var content=Loader.getRes(url);
		if (content !=null){
			Laya.timer.frameOnce(1,null,function(){
				progress && progress.runWith(1);
				complete && complete.runWith(content);
				_$this._loaderCount || _$this.event("complete");
			});
			}else {
			var info=LoaderManager._resMap[url];
			if (!info){
				info=this._infoPool.length ? this._infoPool.pop():new ResInfo();
				info.url=url;
				info.clas=item;
				info.type=type;
				info.cache=cache;
				info.group=group;
				info.ignoreCache=ignoreCache;
				complete && info.on("complete",complete.caller,complete.method,complete.args);
				progress && info.on("progress",progress.caller,progress.method,progress.args);
				LoaderManager._resMap[url]=info;
				priority=priority < this._maxPriority ? priority :this._maxPriority-1;
				this._resInfos[priority].push(info);
				this._next();
				}else {
				complete && info._createListener("complete",complete.caller,complete.method,complete.args,false,false);
				progress && info._createListener("progress",progress.caller,progress.method,progress.args,false,false);
			}
		}
		return this;
	}

	__proto._next=function(){
		if (this._loaderCount >=this.maxLoader)return;
		for (var i=0;i < this._maxPriority;i++){
			var infos=this._resInfos[i];
			while (infos.length > 0){
				var info=infos.shift();
				if (info)return this._doLoad(info);
			}
		}
		this._loaderCount || this.event("complete");
	}

	__proto._doLoad=function(resInfo){
		this._loaderCount++;
		var loader=this._loaders.length ? this._loaders.pop():new Loader();
		loader.on("complete",null,onLoaded);
		loader.on("progress",null,function(num){
			resInfo.event("progress",num);
		});
		loader.on("error",null,function(msg){
			onLoaded(null);
		});
		var _this=this;
		function onLoaded (data){
			loader.offAll();
			loader._data=null;
			loader._customParse=false;
			_this._loaders.push(loader);
			_this._endLoad(resInfo,(data instanceof Array)? [data] :data);
			_this._loaderCount--;
			_this._next();
		}
		loader._class=resInfo.clas;
		loader.load(resInfo.url,resInfo.type,resInfo.cache,resInfo.group,resInfo.ignoreCache);
	}

	__proto._endLoad=function(resInfo,content){
		var url=resInfo.url;
		if (content==null){
			var errorCount=this._failRes[url] || 0;
			if (errorCount < this.retryNum){
				console.warn("[warn]Retry to load:",url);
				this._failRes[url]=errorCount+1;
				Laya.timer.once(this.retryDelay,this,this._addReTry,[resInfo],false);
				return;
				}else {
				console.warn("[error]Failed to load:",url);
				this.event("error",url);
			}
		}
		if (this._failRes[url])this._failRes[url]=0;
		delete LoaderManager._resMap[url];
		resInfo.event("complete",content);
		resInfo.offAll();
		this._infoPool.push(resInfo);
	}

	__proto._addReTry=function(resInfo){
		this._resInfos[this._maxPriority-1].push(resInfo);
		this._next();
	}

	/**
	*清理指定资源地址缓存。
	*@param url 资源地址。
	*@param forceDispose 是否强制销毁，有些资源是采用引用计数方式销毁，如果forceDispose=true，则忽略引用计数，直接销毁，比如Texture，默认为false
	*/
	__proto.clearRes=function(url,forceDispose){
		(forceDispose===void 0)&& (forceDispose=false);
		Loader.clearRes(url,forceDispose);
	}

	/**
	*获取指定资源地址的资源。
	*@param url 资源地址。
	*@return 返回资源。
	*/
	__proto.getRes=function(url){
		return Loader.getRes(url);
	}

	/**
	*缓存资源。
	*@param url 资源地址。
	*@param data 要缓存的内容。
	*/
	__proto.cacheRes=function(url,data){
		Loader.cacheRes(url,data);
	}

	/**
	*销毁Texture使用的图片资源，保留texture壳，如果下次渲染的时候，发现texture使用的图片资源不存在，则会自动恢复
	*相比clearRes，clearTextureRes只是清理texture里面使用的图片资源，并不销毁texture，再次使用到的时候会自动恢复图片资源
	*而clearRes会彻底销毁texture，导致不能再使用；clearTextureRes能确保立即销毁图片资源，并且不用担心销毁错误，clearRes则采用引用计数方式销毁
	*【注意】如果图片本身在自动合集里面（默认图片小于512*512），内存是不能被销毁的，此图片被大图合集管理器管理
	*@param url 图集地址或者texture地址，比如 Loader.clearTextureRes("res/atlas/comp.atlas");Loader.clearTextureRes("hall/bg.jpg");
	*/
	__proto.clearTextureRes=function(url){
		Loader.clearTextureRes(url);
	}

	/**
	*设置资源分组。
	*@param url 资源地址。
	*@param group 分组名
	*/
	__proto.setGroup=function(url,group){
		Loader.setGroup(url,group);
	}

	/**
	*根据分组清理资源。
	*@param group 分组名
	*/
	__proto.clearResByGroup=function(group){
		Loader.clearResByGroup(group);
	}

	/**清理当前未完成的加载，所有未加载的内容全部停止加载。*/
	__proto.clearUnLoaded=function(){
		for (var i=0;i < this._maxPriority;i++){
			var infos=this._resInfos[i];
			for (var j=infos.length-1;j >-1;j--){
				var info=infos[j];
				if (info){
					info.offAll();
					this._infoPool.push(info);
				}
			}
			infos.length=0;
		}
		this._loaderCount=0;
		LoaderManager._resMap={};
	}

	/**
	*根据地址集合清理掉未加载的内容
	*@param urls 资源地址集合
	*/
	__proto.cancelLoadByUrls=function(urls){
		if (!urls)return;
		for (var i=0,n=urls.length;i < n;i++){
			this.cancelLoadByUrl(urls[i]);
		}
	}

	/**
	*根据地址清理掉未加载的内容
	*@param url 资源地址
	*/
	__proto.cancelLoadByUrl=function(url){
		for (var i=0;i < this._maxPriority;i++){
			var infos=this._resInfos[i];
			for (var j=infos.length-1;j >-1;j--){
				var info=infos[j];
				if (info && info.url===url){
					infos[j]=null;
					info.offAll();
					this._infoPool.push(info);
				}
			}
		}
		if (LoaderManager._resMap[url])delete LoaderManager._resMap[url];
	}

	/**
	*@private
	*加载数组里面的资源。
	*@param arr 简单：["a.png","b.png"]，复杂[{url:"a.png",type:Loader.IMAGE,size:100,priority:1},{url:"b.json",type:Loader.JSON,size:50,priority:1}]*/
	__proto._loadAssets=function(arr,complete,progress,type,priority,cache,group){
		(priority===void 0)&& (priority=1);
		(cache===void 0)&& (cache=true);
		var itemCount=arr.length;
		var loadedCount=0;
		var totalSize=0;
		var items=[];
		var success=true;
		for (var i=0;i < itemCount;i++){
			var item=arr[i];
			if ((typeof item=='string'))item={url:item,type:type,size:1,priority:priority};
			if (!item.size)item.size=1;
			item.progress=0;
			totalSize+=item.size;
			items.push(item);
			var progressHandler=progress ? Handler.create(null,loadProgress,[item],false):null;
			var completeHandler=(complete || progress)? Handler.create(null,loadComplete,[item]):null;
			this.load(item.url,completeHandler,progressHandler,item.type,item.priority || 1,cache,item.group || group);
		}
		function loadComplete (item,content){
			loadedCount++;
			item.progress=1;
			if (!content)success=false;
			if (loadedCount===itemCount && complete){
				complete.runWith(success);
			}
		}
		function loadProgress (item,value){
			if (progress !=null){
				item.progress=value;
				var num=0;
				for (var j=0;j < items.length;j++){
					var item1=items[j];
					num+=item1.size *item1.progress;
				};
				var v=num / totalSize;
				progress.runWith(v);
			}
		}
		return this;
	}

	LoaderManager.cacheRes=function(url,data){
		Loader.cacheRes(url,data);
	}

	LoaderManager._resMap={};
	__static(LoaderManager,
	['createMap',function(){return this.createMap={atlas:[null,"atlas"]};}
	]);
	LoaderManager.__init$=function(){
		//class ResInfo extends laya.events.EventDispatcher
		ResInfo=(function(_super){
			function ResInfo(){
				this.url=null;
				this.type=null;
				this.cache=false;
				this.group=null;
				this.ignoreCache=false;
				this.clas=null;
				ResInfo.__super.call(this);
			}
			__class(ResInfo,'',_super);
			return ResInfo;
		})(EventDispatcher)
	}

	return LoaderManager;
})(EventDispatcher)


/**
*本类用于模块间消息传递
*@author ww
*/
//class laya.debug.tools.Notice extends laya.events.EventDispatcher
var Notice=(function(_super){
	function Notice(){
		Notice.__super.call(this);
	}

	__class(Notice,'laya.debug.tools.Notice',_super);
	Notice.notify=function(type,data){
		Notice.I.event(type,data);
	}

	Notice.listen=function(type,_scope,fun,args,cancelBefore){
		(cancelBefore===void 0)&& (cancelBefore=false);
		if(cancelBefore)Notice.cancel(type,_scope,fun);
		Notice.I.on(type,_scope,fun,args);
	}

	Notice.cancel=function(type,_scope,fun){
		Notice.I.off(type,_scope,fun);
	}

	__static(Notice,
	['I',function(){return this.I=new Notice();}
	]);
	return Notice;
})(EventDispatcher)


/**
*@private
*使用Audio标签播放声音
*/
//class laya.media.h5audio.AudioSound extends laya.events.EventDispatcher
var AudioSound=(function(_super){
	function AudioSound(){
		/**
		*声音URL
		*/
		this.url=null;
		/**
		*播放用的audio标签
		*/
		this.audio=null;
		/**
		*是否已加载完成
		*/
		this.loaded=false;
		AudioSound.__super.call(this);
	}

	__class(AudioSound,'laya.media.h5audio.AudioSound',_super);
	var __proto=AudioSound.prototype;
	/**
	*释放声音
	*
	*/
	__proto.dispose=function(){
		var ad=AudioSound._audioCache[this.url];
		if (ad){
			ad.src="";
			delete AudioSound._audioCache[this.url];
		}
	}

	/**
	*加载声音
	*@param url
	*
	*/
	__proto.load=function(url){
		url=URL.formatURL(url);
		this.url=url;
		var ad;
		if (url==SoundManager._tMusic){
			AudioSound._initMusicAudio();
			ad=AudioSound._musicAudio;
			if (ad.src !=url){
				AudioSound._audioCache[ad.src]=null;
				ad=null;
			}
			}else{
			ad=AudioSound._audioCache[url];
		}
		if (ad && ad.readyState >=2){
			this.event("complete");
			return;
		}
		if (!ad){
			if (url==SoundManager._tMusic){
				AudioSound._initMusicAudio();
				ad=AudioSound._musicAudio;
				}else{
				ad=Browser.createElement("audio");
			}
			AudioSound._audioCache[url]=ad;
			ad.src=url;
		}
		ad.addEventListener("canplaythrough",onLoaded);
		ad.addEventListener("error",onErr);
		var me=this;
		function onLoaded (){
			offs();
			me.loaded=true;
			me.event("complete");
		}
		function onErr (){
			ad.load=null;
			offs();
			me.event("error");
		}
		function offs (){
			ad.removeEventListener("canplaythrough",onLoaded);
			ad.removeEventListener("error",onErr);
		}
		this.audio=ad;
		if (ad.load){
			ad.load();
			}else {
			onErr();
		}
	}

	/**
	*播放声音
	*@param startTime 起始时间
	*@param loops 循环次数
	*@return
	*
	*/
	__proto.play=function(startTime,loops){
		(startTime===void 0)&& (startTime=0);
		(loops===void 0)&& (loops=0);
		if (!this.url)return null;
		var ad;
		if (this.url==SoundManager._tMusic){
			ad=AudioSound._musicAudio;
			}else{
			ad=AudioSound._audioCache[this.url];
		}
		if (!ad)return null;
		var tAd;
		tAd=Pool.getItem("audio:"+this.url);
		if (Render.isConchApp){
			if (!tAd){
				tAd=Browser.createElement("audio");
				tAd.src=this.url;
			}
		}
		else {
			if (this.url==SoundManager._tMusic){
				AudioSound._initMusicAudio();
				tAd=AudioSound._musicAudio;
				tAd.src=this.url;
				}else{
				tAd=tAd ? tAd :ad.cloneNode(true);
			}
		};
		var channel=new AudioSoundChannel(tAd);
		channel.url=this.url;
		channel.loops=loops;
		channel.startTime=startTime;
		channel.play();
		SoundManager.addChannel(channel);
		return channel;
	}

	/**
	*获取总时间。
	*/
	__getset(0,__proto,'duration',function(){
		var ad;
		ad=AudioSound._audioCache[this.url];
		if (!ad)
			return 0;
		return ad.duration;
	});

	AudioSound._initMusicAudio=function(){
		if (AudioSound._musicAudio)return;
		if (!AudioSound._musicAudio)AudioSound._musicAudio=Browser.createElement("audio");
		if (!Render.isConchApp){
			Browser.document.addEventListener("mousedown",AudioSound._makeMusicOK);
		}
	}

	AudioSound._makeMusicOK=function(){
		Browser.document.removeEventListener("mousedown",AudioSound._makeMusicOK);
		if (!AudioSound._musicAudio.src){
			AudioSound._musicAudio.src="";
			AudioSound._musicAudio.load();
			}else{
			AudioSound._musicAudio.play();
		}
	}

	AudioSound._audioCache={};
	AudioSound._musicAudio=null;
	return AudioSound;
})(EventDispatcher)


/**
*<p> <code>SoundChannel</code> 用来控制程序中的声音。每个声音均分配给一个声道，而且应用程序可以具有混合在一起的多个声道。</p>
*<p> <code>SoundChannel</code> 类包含控制声音的播放、暂停、停止、音量的方法，以及获取声音的播放状态、总时间、当前播放时间、总循环次数、播放地址等信息的方法。</p>
*/
//class laya.media.SoundChannel extends laya.events.EventDispatcher
var SoundChannel=(function(_super){
	function SoundChannel(){
		/**
		*声音地址。
		*/
		this.url=null;
		/**
		*循环次数。
		*/
		this.loops=0;
		/**
		*开始时间。
		*/
		this.startTime=NaN;
		/**
		*表示声音是否已暂停。
		*/
		this.isStopped=false;
		/**
		*播放完成处理器。
		*/
		this.completeHandler=null;
		SoundChannel.__super.call(this);
	}

	__class(SoundChannel,'laya.media.SoundChannel',_super);
	var __proto=SoundChannel.prototype;
	/**
	*播放。
	*/
	__proto.play=function(){}
	/**
	*停止。
	*/
	__proto.stop=function(){}
	/**
	*暂停。
	*/
	__proto.pause=function(){}
	/**
	*继续播放。
	*/
	__proto.resume=function(){}
	/**
	*private
	*/
	__proto.__runComplete=function(handler){
		if (handler){
			handler.run();
		}
	}

	/**
	*音量范围从 0（静音）至 1（最大音量）。
	*/
	__getset(0,__proto,'volume',function(){
		return 1;
		},function(v){
	});

	/**
	*获取当前播放时间。
	*/
	__getset(0,__proto,'position',function(){
		return 0;
	});

	/**
	*获取总时间。
	*/
	__getset(0,__proto,'duration',function(){
		return 0;
	});

	return SoundChannel;
})(EventDispatcher)


/**
*<code>Sound</code> 类是用来播放控制声音的类。
*/
//class laya.media.Sound extends laya.events.EventDispatcher
var Sound=(function(_super){
	function Sound(){
		Sound.__super.call(this);;
	}

	__class(Sound,'laya.media.Sound',_super);
	var __proto=Sound.prototype;
	/**
	*加载声音。
	*@param url 地址。
	*
	*/
	__proto.load=function(url){}
	/**
	*播放声音。
	*@param startTime 开始时间,单位秒
	*@param loops 循环次数,0表示一直循环
	*@return 声道 SoundChannel 对象。
	*
	*/
	__proto.play=function(startTime,loops){
		(startTime===void 0)&& (startTime=0);
		(loops===void 0)&& (loops=0);
		return null;
	}

	/**
	*释放声音资源。
	*
	*/
	__proto.dispose=function(){}
	/**
	*获取总时间。
	*/
	__getset(0,__proto,'duration',function(){
		return 0;
	});

	return Sound;
})(EventDispatcher)


/**
*@private
*web audio api方式播放声音
*/
//class laya.media.webaudio.WebAudioSound extends laya.events.EventDispatcher
var WebAudioSound=(function(_super){
	function WebAudioSound(){
		/**
		*声音URL
		*/
		this.url=null;
		/**
		*是否已加载完成
		*/
		this.loaded=false;
		/**
		*声音文件数据
		*/
		this.data=null;
		/**
		*声音原始文件数据
		*/
		this.audioBuffer=null;
		/**
		*待播放的声音列表
		*/
		this.__toPlays=null;
		/**
		*@private
		*/
		this._disposed=false;
		WebAudioSound.__super.call(this);
	}

	__class(WebAudioSound,'laya.media.webaudio.WebAudioSound',_super);
	var __proto=WebAudioSound.prototype;
	/**
	*加载声音
	*@param url
	*
	*/
	__proto.load=function(url){
		var me=this;
		url=URL.formatURL(url);
		this.url=url;
		this.audioBuffer=WebAudioSound._dataCache[url];
		if (this.audioBuffer){
			this._loaded(this.audioBuffer);
			return;
		}
		WebAudioSound.e.on("loaded:"+url,this,this._loaded);
		WebAudioSound.e.on("err:"+url,this,this._err);
		if (WebAudioSound.__loadingSound[url]){
			return;
		}
		WebAudioSound.__loadingSound[url]=true;
		var request=new Browser.window.XMLHttpRequest();
		request.open("GET",url,true);
		request.responseType="arraybuffer";
		request.onload=function (){
			if (me._disposed){
				me._removeLoadEvents();
				return;
			}
			me.data=request.response;
			WebAudioSound.buffs.push({"buffer":me.data,"url":me.url});
			WebAudioSound.decode();
		};
		request.onerror=function (e){
			me._err();
		}
		request.send();
	}

	__proto._err=function(){
		this._removeLoadEvents();
		WebAudioSound.__loadingSound[this.url]=false;
		this.event("error");
	}

	__proto._loaded=function(audioBuffer){
		this._removeLoadEvents();
		if (this._disposed){
			return;
		}
		this.audioBuffer=audioBuffer;
		WebAudioSound._dataCache[this.url]=this.audioBuffer;
		this.loaded=true;
		this.event("complete");
	}

	__proto._removeLoadEvents=function(){
		WebAudioSound.e.off("loaded:"+this.url,this,this._loaded);
		WebAudioSound.e.off("err:"+this.url,this,this._err);
	}

	__proto.__playAfterLoaded=function(){
		if (!this.__toPlays)return;
		var i=0,len=0;
		var toPlays;
		toPlays=this.__toPlays;
		len=toPlays.length;
		var tParams;
		for (i=0;i < len;i++){
			tParams=toPlays[i];
			if (tParams[2] && !(tParams [2]).isStopped){
				this.play(tParams[0],tParams[1],tParams[2]);
			}
		}
		this.__toPlays.length=0;
	}

	/**
	*播放声音
	*@param startTime 起始时间
	*@param loops 循环次数
	*@return
	*
	*/
	__proto.play=function(startTime,loops,channel){
		(startTime===void 0)&& (startTime=0);
		(loops===void 0)&& (loops=0);
		channel=channel ? channel :new WebAudioSoundChannel();
		if (!this.audioBuffer){
			if (this.url){
				if (!this.__toPlays)this.__toPlays=[];
				this.__toPlays.push([startTime,loops,channel]);
				this.once("complete",this,this.__playAfterLoaded);
				this.load(this.url);
			}
		}
		channel.url=this.url;
		channel.loops=loops;
		channel["audioBuffer"]=this.audioBuffer;
		channel.startTime=startTime;
		channel.play();
		SoundManager.addChannel(channel);
		return channel;
	}

	__proto.dispose=function(){
		this._disposed=true;
		delete WebAudioSound._dataCache[this.url];
		delete WebAudioSound.__loadingSound[this.url];
		this.audioBuffer=null;
		this.data=null;
		this.__toPlays=[];
	}

	__getset(0,__proto,'duration',function(){
		if (this.audioBuffer){
			return this.audioBuffer.duration;
		}
		return 0;
	});

	WebAudioSound.decode=function(){
		if (WebAudioSound.buffs.length <=0 || WebAudioSound.isDecoding){
			return;
		}
		WebAudioSound.isDecoding=true;
		WebAudioSound.tInfo=WebAudioSound.buffs.shift();
		WebAudioSound.ctx.decodeAudioData(WebAudioSound.tInfo["buffer"],WebAudioSound._done,WebAudioSound._fail);
	}

	WebAudioSound._done=function(audioBuffer){
		WebAudioSound.e.event("loaded:"+WebAudioSound.tInfo.url,audioBuffer);
		WebAudioSound.isDecoding=false;
		WebAudioSound.decode();
	}

	WebAudioSound._fail=function(){
		WebAudioSound.e.event("err:"+WebAudioSound.tInfo.url,null);
		WebAudioSound.isDecoding=false;
		WebAudioSound.decode();
	}

	WebAudioSound._playEmptySound=function(){
		if (WebAudioSound.ctx==null){
			return;
		};
		var source=WebAudioSound.ctx.createBufferSource();
		source.buffer=WebAudioSound._miniBuffer;
		source.connect(WebAudioSound.ctx.destination);
		source.start(0,0,0);
	}

	WebAudioSound._unlock=function(){
		if (WebAudioSound._unlocked){
			return;
		}
		WebAudioSound._playEmptySound();
		if (WebAudioSound.ctx.state=="running"){
			Browser.document.removeEventListener("mousedown",WebAudioSound._unlock,true);
			Browser.document.removeEventListener("touchend",WebAudioSound._unlock,true);
			WebAudioSound._unlocked=true;
		}
	}

	WebAudioSound.initWebAudio=function(){
		if (WebAudioSound.ctx.state !="running"){
			WebAudioSound._unlock();
			Browser.document.addEventListener("mousedown",WebAudioSound._unlock,true);
			Browser.document.addEventListener("touchend",WebAudioSound._unlock,true);
		}
	}

	WebAudioSound._dataCache={};
	WebAudioSound.buffs=[];
	WebAudioSound.isDecoding=false;
	WebAudioSound._unlocked=false;
	WebAudioSound.tInfo=null;
	WebAudioSound.__loadingSound={};
	__static(WebAudioSound,
	['window',function(){return this.window=Browser.window;},'webAudioEnabled',function(){return this.webAudioEnabled=WebAudioSound.window["AudioContext"] || WebAudioSound.window["webkitAudioContext"] || WebAudioSound.window["mozAudioContext"];},'ctx',function(){return this.ctx=WebAudioSound.webAudioEnabled ? new (WebAudioSound.window["AudioContext"] || WebAudioSound.window["webkitAudioContext"] || WebAudioSound.window["mozAudioContext"])():undefined;},'_miniBuffer',function(){return this._miniBuffer=WebAudioSound.ctx.createBuffer(1,1,22050);},'e',function(){return this.e=new EventDispatcher();}
	]);
	return WebAudioSound;
})(EventDispatcher)


/**
*<p> <code>HttpRequest</code> 通过封装 HTML <code>XMLHttpRequest</code> 对象提供了对 HTTP 协议的完全的访问，包括做出 POST 和 HEAD 请求以及普通的 GET 请求的能力。 <code>HttpRequest</code> 只提供以异步的形式返回 Web 服务器的响应，并且能够以文本或者二进制的形式返回内容。</p>
*<p><b>注意：</b>建议每次请求都使用新的 <code>HttpRequest</code> 对象，因为每次调用该对象的send方法时，都会清空之前设置的数据，并重置 HTTP 请求的状态，这会导致之前还未返回响应的请求被重置，从而得不到之前请求的响应结果。</p>
*/
//class laya.net.HttpRequest extends laya.events.EventDispatcher
var HttpRequest=(function(_super){
	function HttpRequest(){
		/**@private */
		this._responseType=null;
		/**@private */
		this._data=null;
		HttpRequest.__super.call(this);
		this._http=new Browser.window.XMLHttpRequest();
	}

	__class(HttpRequest,'laya.net.HttpRequest',_super);
	var __proto=HttpRequest.prototype;
	/**
	*发送 HTTP 请求。
	*@param url 请求的地址。大多数浏览器实施了一个同源安全策略，并且要求这个 URL 与包含脚本的文本具有相同的主机名和端口。
	*@param data (default=null)发送的数据。
	*@param method (default="get")用于请求的 HTTP 方法。值包括 "get"、"post"、"head"。
	*@param responseType (default="text")Web 服务器的响应类型，可设置为 "text"、"json"、"xml"、"arraybuffer"。
	*@param headers (default=null)HTTP 请求的头部信息。参数形如key-value数组：key是头部的名称，不应该包括空白、冒号或换行；value是头部的值，不应该包括换行。比如["Content-Type","application/json"]。
	*/
	__proto.send=function(url,data,method,responseType,headers){
		(method===void 0)&& (method="get");
		(responseType===void 0)&& (responseType="text");
		this._responseType=responseType;
		this._data=null;
		var _this=this;
		var http=this._http;
		http.open(method,url,true);
		if (headers){
			for (var i=0;i < headers.length;i++){
				http.setRequestHeader(headers[i++],headers[i]);
			}
			}else if (!Render.isConchApp){
			if (!data || (typeof data=='string'))http.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
			else http.setRequestHeader("Content-Type","application/json");
		}
		http.responseType=responseType!=="arraybuffer" ? "text" :"arraybuffer";
		http.onerror=function (e){
			_this._onError(e);
		}
		http.onabort=function (e){
			_this._onAbort(e);
		}
		http.onprogress=function (e){
			_this._onProgress(e);
		}
		http.onload=function (e){
			_this._onLoad(e);
		}
		http.send(data);
	}

	/**
	*@private
	*请求进度的侦听处理函数。
	*@param e 事件对象。
	*/
	__proto._onProgress=function(e){
		if (e && e.lengthComputable)this.event("progress",e.loaded / e.total);
	}

	/**
	*@private
	*请求中断的侦听处理函数。
	*@param e 事件对象。
	*/
	__proto._onAbort=function(e){
		this.error("Request was aborted by user");
	}

	/**
	*@private
	*请求出错侦的听处理函数。
	*@param e 事件对象。
	*/
	__proto._onError=function(e){
		this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText);
	}

	/**
	*@private
	*请求消息返回的侦听处理函数。
	*@param e 事件对象。
	*/
	__proto._onLoad=function(e){
		var http=this._http;
		var status=http.status!==undefined ? http.status :200;
		if (status===200 || status===204 || status===0){
			this.complete();
			}else {
			this.error("["+http.status+"]"+http.statusText+":"+http.responseURL);
		}
	}

	/**
	*@private
	*请求错误的处理函数。
	*@param message 错误信息。
	*/
	__proto.error=function(message){
		this.clear();
		this.event("error",message);
	}

	/**
	*@private
	*请求成功完成的处理函数。
	*/
	__proto.complete=function(){
		this.clear();
		var flag=true;
		try {
			if (this._responseType==="json"){
				this._data=JSON.parse(this._http.responseText);
				}else if (this._responseType==="xml"){
				this._data=Utils.parseXMLFromString(this._http.responseText);
				}else {
				this._data=this._http.response || this._http.responseText;
			}
			}catch (e){
			flag=false;
			this.error(e.message);
		}
		flag && this.event("complete",(this._data instanceof Array)? [this._data] :this._data);
	}

	/**
	*@private
	*清除当前请求。
	*/
	__proto.clear=function(){
		var http=this._http;
		http.onerror=http.onabort=http.onprogress=http.onload=null;
	}

	/**请求的地址。*/
	__getset(0,__proto,'url',function(){
		return this._http.responseURL;
	});

	/**
	*本对象所封装的原生 XMLHttpRequest 引用。
	*/
	__getset(0,__proto,'http',function(){
		return this._http;
	});

	/**返回的数据。*/
	__getset(0,__proto,'data',function(){
		return this._data;
	});

	return HttpRequest;
})(EventDispatcher)


/**
*<code>Loader</code> 类可用来加载文本、JSON、XML、二进制、图像等资源。
*/
//class laya.net.Loader extends laya.events.EventDispatcher
var Loader=(function(_super){
	function Loader(){
		/**@private 加载后的数据对象，只读*/
		this._data=null;
		/**@private */
		this._class=null;
		/**@private */
		this._url=null;
		/**@private */
		this._type=null;
		/**@private */
		this._cache=false;
		/**@private */
		this._http=null;
		/**@private 自定义解析不派发complete事件，但会派发loaded事件，手动调用endLoad方法再派发complete事件*/
		this._customParse=false;
		Loader.__super.call(this);
	}

	__class(Loader,'laya.net.Loader',_super);
	var __proto=Loader.prototype;
	/**
	*加载资源。加载错误会派发 Event.ERROR 事件，参数为错误信息。
	*@param url 资源地址。
	*@param type (default=null)资源类型。可选值为：Loader.TEXT、Loader.JSON、Loader.XML、Loader.BUFFER、Loader.IMAGE、Loader.SOUND、Loader.ATLAS、Loader.FONT。如果为null，则根据文件后缀分析类型。
	*@param cache (default=true)是否缓存数据。
	*@param group (default=null)分组名称。
	*@param ignoreCache (default=false)是否忽略缓存，强制重新加载。
	*/
	__proto.load=function(url,type,cache,group,ignoreCache){
		(cache===void 0)&& (cache=true);
		(ignoreCache===void 0)&& (ignoreCache=false);
		this._url=url;
		if (url.indexOf("data:image")===0)this._type=type="image";
		else {
			this._type=type || (type=this.getTypeFromUrl(url));
			url=URL.formatURL(url);
		}
		this._cache=cache;
		this._data=null;
		if (!ignoreCache && Loader.loadedMap[url]){
			this._data=Loader.loadedMap[url];
			this.event("progress",1);
			this.event("complete",this._data);
			return;
		}
		if (group)Loader.setGroup(url,group);
		if (Loader.parserMap[type] !=null){
			this._customParse=true;
			if (((Loader.parserMap[type])instanceof laya.utils.Handler ))Loader.parserMap[type].runWith(this);
			else Loader.parserMap[type].call(null,this);
			return;
		}
		if (type==="image" || type==="htmlimage" || type==="nativeimage")return this._loadImage(url);
		if (type==="sound")return this._loadSound(url);
		if (type==="ttf")return this._loadTTF(url);
		var contentType;
		switch (type){
			case "atlas":
				contentType="json";
				break ;
			case "font":
				contentType="xml";
				break ;
			case "pkm":
				contentType="arraybuffer";
				break
			default :
				contentType=type;
			}
		if (Loader.preLoadedMap[url]){
			this.onLoaded(Loader.preLoadedMap[url]);
			}else{
			if (!this._http){
				this._http=new HttpRequest();
				this._http.on("progress",this,this.onProgress);
				this._http.on("error",this,this.onError);
				this._http.on("complete",this,this.onLoaded);
			}
			this._http.send(url,null,"get",contentType);
		}
	}

	/**
	*获取指定资源地址的数据类型。
	*@param url 资源地址。
	*@return 数据类型。
	*/
	__proto.getTypeFromUrl=function(url){
		var type=Utils.getFileExtension(url);
		if (type)return Loader.typeMap[type];
		console.warn("Not recognize the resources suffix",url);
		return "text";
	}

	/**
	*@private
	*加载TTF资源。
	*@param url 资源地址。
	*/
	__proto._loadTTF=function(url){
		url=URL.formatURL(url);
		var ttfLoader=new TTFLoader();
		ttfLoader.complete=Handler.create(this,this.onLoaded);
		ttfLoader.load(url);
	}

	/**
	*@private
	*加载图片资源。
	*@param url 资源地址。
	*/
	__proto._loadImage=function(url){
		url=URL.formatURL(url);
		var _this=this;
		var image;
		function clear (){
			image.onload=null;
			image.onerror=null;
			delete Loader.imgCache[url]
		};
		var onload=function (){
			clear();
			_this.onLoaded(image);
		};
		var onerror=function (){
			clear();
			_this.event("error","Load image failed");
		}
		if (this._type==="nativeimage"){
			image=new Browser.window.Image();
			image.crossOrigin="";
			image.onload=onload;
			image.onerror=onerror;
			image.src=url;
			Loader.imgCache[url]=image;
			}else {
			new HTMLImage.create(url,{onload:onload,onerror:onerror,onCreate:function (img){
					image=img;
					Loader.imgCache[url]=img;
			}});
		}
	}

	/**
	*@private
	*加载声音资源。
	*@param url 资源地址。
	*/
	__proto._loadSound=function(url){
		var sound=(new SoundManager._soundClass());
		var _this=this;
		sound.on("complete",this,soundOnload);
		sound.on("error",this,soundOnErr);
		sound.load(url);
		function soundOnload (){
			clear();
			_this.onLoaded(sound);
		}
		function soundOnErr (){
			clear();
			sound.dispose();
			_this.event("error","Load sound failed");
		}
		function clear (){
			sound.offAll();
		}
	}

	/**@private */
	__proto.onProgress=function(value){
		if (this._type==="atlas")this.event("progress",value *0.3);
		else this.event("progress",value);
	}

	/**@private */
	__proto.onError=function(message){
		this.event("error",message);
	}

	/**
	*资源加载完成的处理函数。
	*@param data 数据。
	*/
	__proto.onLoaded=function(data){
		var type=this._type;
		if (type==="image"){
			var tex=new Texture(data);
			tex.url=this._url;
			this.complete(tex);
			}else if (type==="sound" || type==="htmlimage" || type==="nativeimage"){
			this.complete(data);
			}else if (type==="atlas"){
			if (!data.src && !data._setContext){
				if (!this._data){
					this._data=data;
					if (data.meta && data.meta.image){
						var toloadPics=data.meta.image.split(",");
						var split=this._url.indexOf("/")>=0 ? "/" :"\\";
						var idx=this._url.lastIndexOf(split);
						var folderPath=idx >=0 ? this._url.substr(0,idx+1):"";
						for (var i=0,len=toloadPics.length;i < len;i++){
							toloadPics[i]=folderPath+toloadPics[i];
						}
						}else {
						toloadPics=[this._url.replace(".json",".png")];
					}
					toloadPics.reverse();
					data.toLoads=toloadPics;
					data.pics=[];
				}
				this.event("progress",0.3+1 / toloadPics.length *0.6);
				return this._loadImage(toloadPics.pop());
				}else {
				this._data.pics.push(data);
				if (this._data.toLoads.length > 0){
					this.event("progress",0.3+1 / this._data.toLoads.length *0.6);
					return this._loadImage(this._data.toLoads.pop());
				};
				var frames=this._data.frames;
				var cleanUrl=this._url.split("?")[0];
				var directory=(this._data.meta && this._data.meta.prefix)? this._data.meta.prefix :cleanUrl.substring(0,cleanUrl.lastIndexOf("."))+"/";
				var pics=this._data.pics;
				var atlasURL=URL.formatURL(this._url);
				var map=Loader.atlasMap[atlasURL] || (Loader.atlasMap[atlasURL]=[]);
				map.dir=directory;
				var scaleRate=1;
				if (this._data.meta && this._data.meta.scale && this._data.meta.scale !=1){
					scaleRate=parseFloat(this._data.meta.scale);
					for (var name in frames){
						var obj=frames[name];
						var tPic=pics[obj.frame.idx ? obj.frame.idx :0];
						var url=URL.formatURL(directory+name);
						tPic.scaleRate=scaleRate;
						Loader.cacheRes(url,Texture.create(tPic,obj.frame.x,obj.frame.y,obj.frame.w,obj.frame.h,obj.spriteSourceSize.x,obj.spriteSourceSize.y,obj.sourceSize.w,obj.sourceSize.h));
						Loader.loadedMap[url].url=url;
						map.push(url);
					}
					}else{
					for (name in frames){
						obj=frames[name];
						tPic=pics[obj.frame.idx ? obj.frame.idx :0];
						url=URL.formatURL(directory+name);
						Loader.cacheRes(url,Texture.create(tPic,obj.frame.x,obj.frame.y,obj.frame.w,obj.frame.h,obj.spriteSourceSize.x,obj.spriteSourceSize.y,obj.sourceSize.w,obj.sourceSize.h));
						Loader.loadedMap[url].url=url;
						map.push(url);
					}
				}
				delete this._data.pics;
				this.complete(this._data);
			}
			}else if (type=="font"){
			if (!data.src){
				this._data=data;
				this.event("progress",0.5);
				return this._loadImage(this._url.replace(".fnt",".png"));
				}else {
				var bFont=new BitmapFont();
				bFont.parseFont(this._data,data);
				var tArr=this._url.split(".fnt")[0].split("/");
				var fontName=tArr[tArr.length-1];
				Text.registerBitmapFont(fontName,bFont);
				this._data=bFont;
				this.complete(this._data);
			}
			}else if (type=="pkm"){
			var image=HTMLImage.create(data,this._url);
			var tex1=new Texture(image);
			tex1.url=this._url;
			this.complete(tex1);
			}else {
			this.complete(data);
		}
	}

	/**
	*加载完成。
	*@param data 加载的数据。
	*/
	__proto.complete=function(data){
		this._data=data;
		if (this._customParse){
			this.event("loaded",(data instanceof Array)? [data] :data);
			}else {
			Loader._loaders.push(this);
			if (!Loader._isWorking)Loader.checkNext();
		}
	}

	/**
	*结束加载，处理是否缓存及派发完成事件 <code>Event.COMPLETE</code> 。
	*@param content 加载后的数据
	*/
	__proto.endLoad=function(content){
		content && (this._data=content);
		if (this._cache)Loader.cacheRes(this._url,this._data);
		this.event("progress",1);
		this.event("complete",(this.data instanceof Array)? [this.data] :this.data);
	}

	/**加载地址。*/
	__getset(0,__proto,'url',function(){
		return this._url;
	});

	/**返回的数据。*/
	__getset(0,__proto,'data',function(){
		return this._data;
	});

	/**是否缓存。*/
	__getset(0,__proto,'cache',function(){
		return this._cache;
	});

	/**加载类型。*/
	__getset(0,__proto,'type',function(){
		return this._type;
	});

	Loader.checkNext=function(){
		Loader._isWorking=true;
		var startTimer=Browser.now();
		var thisTimer=startTimer;
		while (Loader._startIndex < Loader._loaders.length){
			thisTimer=Browser.now();
			Loader._loaders[Loader._startIndex].endLoad();
			Loader._startIndex++;
			if (Browser.now()-startTimer > Loader.maxTimeOut){
				console.warn("loader callback cost a long time:"+(Browser.now()-startTimer)+" url="+Loader._loaders[Loader._startIndex-1].url);
				Laya.timer.frameOnce(1,null,Loader.checkNext);
				return;
			}
		}
		Loader._loaders.length=0;
		Loader._startIndex=0;
		Loader._isWorking=false;
	}

	Loader.clearRes=function(url,forceDispose){
		(forceDispose===void 0)&& (forceDispose=false);
		url=URL.formatURL(url);
		var arr=Loader.getAtlas(url);
		if (arr){
			for (var i=0,n=arr.length;i < n;i++){
				var resUrl=arr[i];
				var tex=Loader.getRes(resUrl);
				delete Loader.loadedMap[resUrl];
				if (tex)tex.destroy(forceDispose);
			}
			arr.length=0;
			delete Loader.atlasMap[url];
			delete Loader.loadedMap[url];
			}else {
			var res=Loader.loadedMap[url];
			if (res){
				delete Loader.loadedMap[url];
				if ((res instanceof laya.resource.Texture )&& res.bitmap)(res).destroy(forceDispose);
			}
		}
	}

	Loader.clearTextureRes=function(url){
		url=URL.formatURL(url);
		var arr=laya.net.Loader.getAtlas(url);
		var res=(arr && arr.length>0)? laya.net.Loader.getRes(arr[0]):laya.net.Loader.getRes(url);
		if (res && res.bitmap){
			if (Render.isConchApp){
				if (res.bitmap.source.releaseTexture){
					res.bitmap.source.releaseTexture();
				}
				}else if (res.bitmap._atlaser==null){
				res.bitmap.releaseResource(true);
			}
		}
	}

	Loader.getRes=function(url){
		return Loader.loadedMap[URL.formatURL(url)];
	}

	Loader.getAtlas=function(url){
		return Loader.atlasMap[URL.formatURL(url)];
	}

	Loader.cacheRes=function(url,data){
		url=URL.formatURL(url);
		if (Loader.loadedMap[url] !=null){
			console.warn("Resources already exist,is repeated loading:",url);
			}else {
			Loader.loadedMap[url]=data;
		}
	}

	Loader.setGroup=function(url,group){
		if (!Loader.groupMap[group])Loader.groupMap[group]=[];
		Loader.groupMap[group].push(url);
	}

	Loader.clearResByGroup=function(group){
		if (!Loader.groupMap[group])return;
		var arr=Loader.groupMap[group],i=0,len=arr.length;
		for (i=0;i < len;i++){
			Loader.clearRes(arr[i]);
		}
		arr.length=0;
	}

	Loader.TEXT="text";
	Loader.JSON="json";
	Loader.XML="xml";
	Loader.BUFFER="arraybuffer";
	Loader.IMAGE="image";
	Loader.SOUND="sound";
	Loader.ATLAS="atlas";
	Loader.FONT="font";
	Loader.TTF="ttf";
	Loader.PKM="pkm";
	Loader.typeMap={"png":"image","jpg":"image","jpeg":"image","txt":"text","json":"json","xml":"xml","als":"atlas","atlas":"atlas","mp3":"sound","ogg":"sound","wav":"sound","part":"json","fnt":"font","pkm":"pkm","ttf":"ttf"};
	Loader.parserMap={};
	Loader.groupMap={};
	Loader.maxTimeOut=100;
	Loader.loadedMap={};
	Loader.preLoadedMap={};
	Loader.atlasMap={};
	Loader._loaders=[];
	Loader._isWorking=false;
	Loader._startIndex=0;
	Loader.imgCache={};
	return Loader;
})(EventDispatcher)


/**
*<code>Texture</code> 是一个纹理处理类。
*/
//class laya.resource.Texture extends laya.events.EventDispatcher
var Texture=(function(_super){
	function Texture(bitmap,uv){
		/**图片或者canvas 。*/
		//this.bitmap=null;
		/**UV信息。*/
		//this.uv=null;
		/**沿 X 轴偏移量。*/
		this.offsetX=0;
		/**沿 Y 轴偏移量。*/
		this.offsetY=0;
		/**原始宽度（包括被裁剪的透明区域）。*/
		this.sourceWidth=0;
		/**原始高度（包括被裁剪的透明区域）。*/
		this.sourceHeight=0;
		/**@private */
		//this._loaded=false;
		/**@private */
		this._w=0;
		/**@private */
		this._h=0;
		/**@private 唯一ID*/
		//this.$_GID=NaN;
		/**图片地址*/
		//this.url=null;
		/**@private */
		this._uvID=0;
		this._atlasID=-1;
		/**@private */
		this.scaleRate=1;
		Texture.__super.call(this);
		if (bitmap){
			bitmap._addReference();
		}
		this.setTo(bitmap,uv);
	}

	__class(Texture,'laya.resource.Texture',_super);
	var __proto=Texture.prototype;
	/**
	*@private
	*/
	__proto._setUrl=function(url){
		this.url=url;
	}

	/**
	*设置此对象的位图资源、UV数据信息。
	*@param bitmap 位图资源
	*@param uv UV数据信息
	*/
	__proto.setTo=function(bitmap,uv){
		if (bitmap instanceof window.HTMLElement){
			var canvas=HTMLCanvas.create("2D",bitmap);
			this.bitmap=canvas;
			}else{
			this.bitmap=bitmap;
		}
		this.uv=uv || Texture.DEF_UV;
		if (bitmap){
			this._w=bitmap.width;
			this._h=bitmap.height;
			this.sourceWidth=this.sourceWidth || this._w;
			this.sourceHeight=this.sourceHeight || this._h
			this._loaded=this._w > 0;
			var _this=this;
			if (this._loaded){
				RunDriver.addToAtlas && RunDriver.addToAtlas(_this);
				}else {
				var bm=bitmap;
				if ((bm instanceof laya.resource.HTMLImage )&& bm.image)
					bm.image.addEventListener('load',function(e){
					RunDriver.addToAtlas && RunDriver.addToAtlas(_this);
				},false);
			}
		}
	}

	/**@private 激活资源。*/
	__proto.active=function(){
		if (this.bitmap)this.bitmap.activeResource();
	}

	/**
	*销毁纹理（分直接销毁，跟计数销毁两种）。
	*@param forceDispose (default=false)true为强制销毁主纹理，false是通过计数销毁纹理。
	*/
	__proto.destroy=function(forceDispose){
		(forceDispose===void 0)&& (forceDispose=false);
		if (this.bitmap && (this.bitmap).referenceCount > 0){
			var temp=this.bitmap;
			if (forceDispose){
				if (Render.isConchApp && temp.source && temp.source.conchDestroy){
					this.bitmap.source.conchDestroy();
				}
				this.bitmap=null;
				temp.dispose();
				(temp)._clearReference();
				}else {
				(temp)._removeReference();
				if ((temp).referenceCount==0){
					if (Render.isConchApp && temp.source && temp.source.conchDestroy){
						this.bitmap.source.conchDestroy();
					}
					this.bitmap=null;
					temp.dispose();
				}
			}
			if (this.url && this===Laya.loader.getRes(this.url))Laya.loader.clearRes(this.url,forceDispose);
			this._loaded=false;
		}
	}

	/**
	*加载指定地址的图片。
	*@param url 图片地址。
	*/
	__proto.load=function(url){
		var _$this=this;
		this._loaded=false;
		url=URL.customFormat(url);
		var fileBitmap=(this.bitmap || (this.bitmap=HTMLImage.create(url)));
		if (fileBitmap)fileBitmap._addReference();
		var _this=this;
		fileBitmap.onload=function (){
			fileBitmap.onload=null;
			_this._loaded=true;
			_$this.sourceWidth=_$this._w=fileBitmap.width;
			_$this.sourceHeight=_$this._h=fileBitmap.height;
			_this.event("loaded",this);
			(RunDriver.addToAtlas)&& (RunDriver.addToAtlas(_this));
		};
	}

	/**@private */
	__proto.addTextureToAtlas=function(e){
		RunDriver.addTextureToAtlas(this);
	}

	/**
	*获取Texture上的某个区域的像素点
	*@param x
	*@param y
	*@param width
	*@param height
	*@return 返回像素点集合
	*/
	__proto.getPixels=function(x,y,width,height){
		if (Render.isConchApp){
			var temp=this.bitmap;
			if (temp.source && temp.source.getImageData){
				var arraybuffer=temp.source.getImageData(x,y,width,height);
				var tUint8Array=new Uint8Array(arraybuffer);
				return Array.from(tUint8Array);
			}
			return null;
			}else if (Render.isWebGL){
			return RunDriver.getTexturePixels(this,x,y,width,height);
			}else {
			Browser.canvas.size(width,height);
			Browser.canvas.clear();
			Browser.context.drawTexture(this,-x,-y,this.width,this.height,0,0);
			var info=Browser.context.getImageData(0,0,width,height);
		}
		return info.data;
	}

	/**@private */
	__proto.onAsynLoaded=function(url,bitmap){
		if (bitmap)bitmap._addReference();
		this.setTo(bitmap,this.uv);
	}

	/**激活并获取资源。*/
	__getset(0,__proto,'source',function(){
		if (!this.bitmap)return null;
		this.bitmap.activeResource();
		return this.bitmap.source;
	});

	/**
	*表示是否加载成功，只能表示初次载入成功（通常包含下载和载入）,并不能完全表示资源是否可立即使用（资源管理机制释放影响等）。
	*/
	__getset(0,__proto,'loaded',function(){
		return this._loaded;
	});

	/**
	*表示资源是否已释放。
	*/
	__getset(0,__proto,'released',function(){
		if (!this.bitmap)return true;
		return this.bitmap.released;
	});

	/**实际宽度。*/
	__getset(0,__proto,'width',function(){
		if (this._w)return this._w;
		return (this.uv && this.uv!==Texture.DEF_UV)? (this.uv[2]-this.uv[0])*this.bitmap.width :this.bitmap.width;
		},function(value){
		this._w=value;
		this.sourceWidth || (this.sourceWidth=value);
	});

	/**
	*通过外部设置是否启用纹理平铺(后面要改成在着色器里计算)
	*/
	/**
	*获取当前纹理是否启用了纹理平铺
	*/
	__getset(0,__proto,'repeat',function(){
		if (Render.isWebGL && this.bitmap){
			return this.bitmap.repeat;
		}
		return true;
		},function(value){
		if (value){
			if (Render.isWebGL && this.bitmap){
				this.bitmap.repeat=value;
				if (value){
					this.bitmap.enableMerageInAtlas=false;
				}
			}
		}
	});

	/**实际高度。*/
	__getset(0,__proto,'height',function(){
		if (this._h)return this._h;
		return (this.uv && this.uv!==Texture.DEF_UV)? (this.uv[5]-this.uv[1])*this.bitmap.height :this.bitmap.height;
		},function(value){
		this._h=value;
		this.sourceHeight || (this.sourceHeight=value);
	});

	/**
	*设置线性采样的状态（目前只能第一次绘制前设置false生效,来关闭线性采样）。
	*/
	/**
	*获取当前纹理是否启用了线性采样。
	*/
	__getset(0,__proto,'isLinearSampling',function(){
		return Render.isWebGL ? (this.bitmap.minFifter !=0x2600):true;
		},function(value){
		if (!value && Render.isWebGL){
			if (!value && (this.bitmap.minFifter==-1)&& (this.bitmap.magFifter==-1)){
				this.bitmap.minFifter=0x2600;
				this.bitmap.magFifter=0x2600;
				this.bitmap.enableMerageInAtlas=false;
			}
		}
	});

	Texture.moveUV=function(offsetX,offsetY,uv){
		for (var i=0;i < 8;i+=2){
			uv[i]+=offsetX;
			uv[i+1]+=offsetY;
		}
		return uv;
	}

	Texture.create=function(source,x,y,width,height,offsetX,offsetY,sourceWidth,sourceHeight){
		(offsetX===void 0)&& (offsetX=0);
		(offsetY===void 0)&& (offsetY=0);
		(sourceWidth===void 0)&& (sourceWidth=0);
		(sourceHeight===void 0)&& (sourceHeight=0);
		var btex=(source instanceof laya.resource.Texture );
		var uv=btex ? source.uv :Texture.DEF_UV;
		var bitmap=btex ? source.bitmap :source;
		var bIsAtlas=RunDriver.isAtlas(bitmap);
		if (bIsAtlas){
			var atlaser=bitmap._atlaser;
			var nAtlasID=(source)._atlasID;
			if (nAtlasID==-1){
				throw new Error("create texture error");
			}
			bitmap=atlaser._inAtlasTextureBitmapValue[nAtlasID];
			uv=atlaser._inAtlasTextureOriUVValue[nAtlasID];
		};
		var tex=new Texture(bitmap,null);
		if (bitmap.width && (x+width)> bitmap.width)width=bitmap.width-x;
		if (bitmap.height && (y+height)> bitmap.height)height=bitmap.height-y;
		tex.width=width;
		tex.height=height;
		tex.offsetX=offsetX;
		tex.offsetY=offsetY;
		tex.sourceWidth=sourceWidth || width;
		tex.sourceHeight=sourceHeight || height;
		var dwidth=1 / bitmap.width;
		var dheight=1 / bitmap.height;
		x *=dwidth;
		y *=dheight;
		width *=dwidth;
		height *=dheight;
		var u1=tex.uv[0],v1=tex.uv[1],u2=tex.uv[4],v2=tex.uv[5];
		var inAltasUVWidth=(u2-u1),inAltasUVHeight=(v2-v1);
		var oriUV=Texture.moveUV(uv[0],uv[1],[x,y,x+width,y,x+width,y+height,x,y+height]);
		tex.uv=[u1+oriUV[0] *inAltasUVWidth,v1+oriUV[1] *inAltasUVHeight,u2-(1-oriUV[2])*inAltasUVWidth,v1+oriUV[3] *inAltasUVHeight,u2-(1-oriUV[4])*inAltasUVWidth,v2-(1-oriUV[5])*inAltasUVHeight,u1+oriUV[6] *inAltasUVWidth,v2-(1-oriUV[7])*inAltasUVHeight];
		if (bIsAtlas){
			tex.addTextureToAtlas();
		};
		var bitmapScale=bitmap.scaleRate;
		if (bitmapScale && bitmapScale !=1){
			tex.sourceWidth /=bitmapScale;
			tex.sourceHeight /=bitmapScale;
			tex.width /=bitmapScale;
			tex.height /=bitmapScale;
			tex.scaleRate=bitmapScale;
			tex.offsetX /=bitmapScale;
			tex.offsetY /=bitmapScale;
			}else{
			tex.scaleRate=1;
		}
		return tex;
	}

	Texture.createFromTexture=function(texture,x,y,width,height){
		var texScaleRate=texture.scaleRate;
		if (texScaleRate !=1){
			x *=texScaleRate;
			y *=texScaleRate;
			width *=texScaleRate;
			height *=texScaleRate;
		};
		var rect=Rectangle.TEMP.setTo(x-texture.offsetX,y-texture.offsetY,width,height);
		var result=rect.intersection(Texture._rect1.setTo(0,0,texture.width,texture.height),Texture._rect2);
		if (result)
			var tex=Texture.create(texture,result.x,result.y,result.width,result.height,result.x-rect.x,result.y-rect.y,width,height);
		else return null;
		tex.bitmap._removeReference();
		return tex;
	}

	Texture.DEF_UV=[0,0,1.0,0,1.0,1.0,0,1.0];
	Texture.INV_UV=[0,1,1.0,1,1.0,0.0,0,0.0];
	Texture._rect1=new Rectangle();
	Texture._rect2=new Rectangle();
	return Texture;
})(EventDispatcher)


/**
*@private
*Canvas版本的SkinMesh
*/
//class laya.ani.bone.canvasmesh.SkinMeshCanvas extends laya.ani.bone.canvasmesh.CanvasMeshRender
var SkinMeshCanvas=(function(_super){
	function SkinMeshCanvas(){
		SkinMeshCanvas.__super.call(this);
		this.mesh=new MeshData();
	}

	__class(SkinMeshCanvas,'laya.ani.bone.canvasmesh.SkinMeshCanvas',_super);
	var __proto=SkinMeshCanvas.prototype;
	__proto.init2=function(texture,vs,ps,verticles,uvs){
		if (this.transform){
			this.transform=null;
		};
		var _ps;
		if (ps){
			_ps=ps;
			}else {
			_ps=[];
			_ps.push(0,1,3,3,1,2);
		}
		this.mesh.texture=texture;
		this.mesh.indexes=_ps;
		this.mesh.vertices=verticles;
		this.mesh.uvs=uvs;
	}

	__proto.render=function(context,x,y){
		if(!this.mesh.texture)return;
		if(!this.transform){
			this.transform=SkinMeshCanvas._tempMatrix;
			this.transform.identity();
			this.transform.translate(x,y);
			this.renderToContext(context);
			this.transform.translate(-x,-y);
			this.transform=null;
			}else{
			this.transform.translate(x,y);
			this.renderToContext(context);
			this.transform.translate(-x,-y);
		}
	}

	__static(SkinMeshCanvas,
	['_tempMatrix',function(){return this._tempMatrix=new Matrix();}
	]);
	return SkinMeshCanvas;
})(CanvasMeshRender)


/**
*@private
*/
//class laya.ani.GraphicsAni extends laya.display.Graphics
var GraphicsAni=(function(_super){
	function GraphicsAni(){
		GraphicsAni.__super.call(this);
		if (Render.isConchNode){
			this["drawSkin"]=function (skin){
				skin.transform || (skin.transform=Matrix.EMPTY);
				this._addCmd([skin]);
				this.setSkinMesh&&this.setSkinMesh(skin._ps,skin.mVBData,skin.mEleNum,0,skin.mTexture,skin.transform);
			};
		}
	}

	__class(GraphicsAni,'laya.ani.GraphicsAni',_super);
	var __proto=GraphicsAni.prototype;
	/**
	*@private
	*画自定义蒙皮动画
	*@param skin
	*/
	__proto.drawSkin=function(skin){
		var arr=[skin];
		this._saveToCmd(Render._context._drawSkin,arr);
	}

	GraphicsAni.create=function(){
		var rs=GraphicsAni._caches.pop();
		return rs||new GraphicsAni();
	}

	GraphicsAni.recycle=function(graphics){
		graphics.clear();
		GraphicsAni._caches.push(graphics);
	}

	GraphicsAni._caches=[];
	return GraphicsAni;
})(Graphics)


/**
*<code>AutoBitmap</code> 类是用于表示位图图像或绘制图形的显示对象。
*<p>封装了位置，宽高及九宫格的处理，供UI组件使用。</p>
*/
//class laya.ui.AutoBitmap extends laya.display.Graphics
var AutoBitmap=(function(_super){
	function AutoBitmap(){
		/**@private 是否自动缓存命令*/
		this.autoCacheCmd=true;
		/**@private 宽度*/
		this._width=0;
		/**@private 高度*/
		this._height=0;
		/**@private 源数据*/
		this._source=null;
		/**@private 网格数据*/
		this._sizeGrid=null;
		/**@private */
		this._isChanged=false;
		/**@private */
		this._offset=null;
		AutoBitmap.__super.call(this);
	}

	__class(AutoBitmap,'laya.ui.AutoBitmap',_super);
	var __proto=AutoBitmap.prototype;
	/**@inheritDoc */
	__proto.destroy=function(){
		_super.prototype.destroy.call(this);
		this._source=null;
		this._sizeGrid=null;
		this._offset=null;
	}

	/**@private */
	__proto._setChanged=function(){
		if (!this._isChanged){
			this._isChanged=true;
			Laya.timer.callLater(this,this.changeSource);
		}
	}

	/**
	*@private
	*修改纹理资源。
	*/
	__proto.changeSource=function(){
		this._isChanged=false;
		var source=this._source;
		if (!source || !source.bitmap)return;
		var width=this.width;
		var height=this.height;
		var sizeGrid=this._sizeGrid;
		var sw=source.sourceWidth;
		var sh=source.sourceHeight;
		if (!sizeGrid || (sw===width && sh===height)){
			this.cleanByTexture(source,this._offset ? this._offset[0] :0,this._offset ? this._offset[1] :0,width,height);
			}else {
			source.$_GID || (source.$_GID=Utils.getGID());
			var key=source.$_GID+"."+width+"."+height+"."+sizeGrid.join(".");
			if (Utils.isOKCmdList(WeakObject.I.get(key))){
				this.cmds=WeakObject.I.get(key);
				return;
			}
			this.clear();
			var top=sizeGrid[0];
			var right=sizeGrid[1];
			var bottom=sizeGrid[2];
			var left=sizeGrid[3];
			var repeat=sizeGrid[4];
			var needClip=false;
			if (width==sw){
				left=right=0;
			}
			if (height==sh){
				top=bottom=0;
			}
			if (left+right > width){
				var clipWidth=width;
				needClip=true;
				width=left+right;
				this.save();
				this.clipRect(0,0,clipWidth,height);
			}
			left && top && this.drawTexture(AutoBitmap.getTexture(source,0,0,left,top),0,0,left,top);
			right && top && this.drawTexture(AutoBitmap.getTexture(source,sw-right,0,right,top),width-right,0,right,top);
			left && bottom && this.drawTexture(AutoBitmap.getTexture(source,0,sh-bottom,left,bottom),0,height-bottom,left,bottom);
			right && bottom && this.drawTexture(AutoBitmap.getTexture(source,sw-right,sh-bottom,right,bottom),width-right,height-bottom,right,bottom);
			top && this.drawBitmap(repeat,AutoBitmap.getTexture(source,left,0,sw-left-right,top),left,0,width-left-right,top);
			bottom && this.drawBitmap(repeat,AutoBitmap.getTexture(source,left,sh-bottom,sw-left-right,bottom),left,height-bottom,width-left-right,bottom);
			left && this.drawBitmap(repeat,AutoBitmap.getTexture(source,0,top,left,sh-top-bottom),0,top,left,height-top-bottom);
			right && this.drawBitmap(repeat,AutoBitmap.getTexture(source,sw-right,top,right,sh-top-bottom),width-right,top,right,height-top-bottom);
			this.drawBitmap(repeat,AutoBitmap.getTexture(source,left,top,sw-left-right,sh-top-bottom),left,top,width-left-right,height-top-bottom);
			if (needClip)this.restore();
			if (this.autoCacheCmd && !Render.isConchApp)WeakObject.I.set(key,this.cmds);
		}
		this._repaint();
	}

	__proto.drawBitmap=function(repeat,tex,x,y,width,height){
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		if (width < 0.1 || height < 0.1)return;
		if (repeat && (tex.width !=width || tex.height !=height))this.fillTexture(tex,x,y,width,height);
		else this.drawTexture(tex,x,y,width,height);
	}

	__proto.clear=function(recoverCmds){
		(recoverCmds===void 0)&& (recoverCmds=true);
		_super.prototype.clear.call(this,false);
	}

	/**
	*当前实例的有效缩放网格数据。
	*<p>如果设置为null,则在应用任何缩放转换时，将正常缩放整个显示对象。</p>
	*<p>数据格式：[上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)]。
	*<ul><li>例如：[4,4,4,4,1]</li></ul></p>
	*<p> <code>sizeGrid</code> 的值如下所示：
	*<ol>
	*<li>上边距</li>
	*<li>右边距</li>
	*<li>下边距</li>
	*<li>左边距</li>
	*<li>是否重复填充(值为0：不重复填充，1：重复填充)</li>
	*</ol></p>
	*<p>当定义 <code>sizeGrid</code> 属性时，该显示对象被分割到以 <code>sizeGrid</code> 数据中的"上边距,右边距,下边距,左边距" 组成的矩形为基础的具有九个区域的网格中，该矩形定义网格的中心区域。网格的其它八个区域如下所示：
	*<ul>
	*<li>矩形上方的区域</li>
	*<li>矩形外的右上角</li>
	*<li>矩形左侧的区域</li>
	*<li>矩形右侧的区域</li>
	*<li>矩形外的左下角</li>
	*<li>矩形下方的区域</li>
	*<li>矩形外的右下角</li>
	*<li>矩形外的左上角</li>
	*</ul>
	*同时也支持3宫格，比如0,4,0,4,1为水平3宫格，4,0,4,0,1为垂直3宫格，3宫格性能比9宫格高。
	*</p>
	*/
	__getset(0,__proto,'sizeGrid',function(){
		return this._sizeGrid;
		},function(value){
		this._sizeGrid=value;
		this._setChanged();
	});

	/**
	*表示显示对象的宽度，以像素为单位。
	*/
	__getset(0,__proto,'width',function(){
		if (this._width)return this._width;
		if (this._source)return this._source.sourceWidth;
		return 0;
		},function(value){
		if (this._width !=value){
			this._width=value;
			this._setChanged();
		}
	});

	/**
	*表示显示对象的高度，以像素为单位。
	*/
	__getset(0,__proto,'height',function(){
		if (this._height)return this._height;
		if (this._source)return this._source.sourceHeight;
		return 0;
		},function(value){
		if (this._height !=value){
			this._height=value;
			this._setChanged();
		}
	});

	/**
	*对象的纹理资源。
	*@see laya.resource.Texture
	*/
	__getset(0,__proto,'source',function(){
		return this._source;
		},function(value){
		if (value){
			this._source=value
			this._setChanged();
			}else {
			this._source=null;
			this.clear();
		}
	});

	AutoBitmap.getTexture=function(tex,x,y,width,height){
		if (width <=0)width=1;
		if (height <=0)height=1;
		tex.$_GID || (tex.$_GID=Utils.getGID())
		var key=tex.$_GID+"."+x+"."+y+"."+width+"."+height;
		var texture=WeakObject.I.get(key);
		if (!texture||!texture.source){
			texture=Texture.createFromTexture(tex,x,y,width,height);
			WeakObject.I.set(key,texture);
		}
		return texture;
	}

	return AutoBitmap;
})(Graphics)


//class laya.webgl.display.GraphicsGL extends laya.display.Graphics
var GraphicsGL=(function(_super){
	function GraphicsGL(){
		GraphicsGL.__super.call(this);
	}

	__class(GraphicsGL,'laya.webgl.display.GraphicsGL',_super);
	var __proto=GraphicsGL.prototype;
	__proto.setShader=function(shader){
		this._saveToCmd(Render.context._setShader,[shader]);
	}

	__proto.setIBVB=function(x,y,ib,vb,numElement,shader){
		this._saveToCmd(Render.context._setIBVB,[x,y,ib,vb,numElement,shader]);
	}

	__proto.drawParticle=function(x,y,ps){
		var pt=RunDriver.createParticleTemplate2D(ps);
		pt.x=x;
		pt.y=y;
		this._saveToCmd(Render.context._drawParticle,[pt]);
	}

	return GraphicsGL;
})(Graphics)


/**
*@private
*<code>CSSStyle</code> 类是元素CSS样式定义类。
*/
//class laya.display.css.CSSStyle extends laya.display.css.Style
var CSSStyle=(function(_super){
	function CSSStyle(ower){
		this._bgground=null;
		this._border=null;
		//this._ower=null;
		this._rect=null;
		/**@private */
		this.underLine=0;
		/**行高。 */
		this.lineHeight=0;
		CSSStyle.__super.call(this);
		this._padding=CSSStyle._PADDING;
		this._spacing=CSSStyle._SPACING;
		this._aligns=CSSStyle._ALIGNS;
		this._font=Font.EMPTY;
		this._ower=ower;
	}

	__class(CSSStyle,'laya.display.css.CSSStyle',_super);
	var __proto=CSSStyle.prototype;
	/**@inheritDoc */
	__proto.destroy=function(){
		this._ower=null;
		this._font=null;
		this._rect=null;
	}

	/**
	*复制传入的 CSSStyle 属性值。
	*@param src 待复制的 CSSStyle 对象。
	*/
	__proto.inherit=function(src){
		this._font=src._font;
		this._spacing=src._spacing===CSSStyle._SPACING ? CSSStyle._SPACING :src._spacing.slice();
		this.lineHeight=src.lineHeight;
	}

	/**@private */
	__proto._widthAuto=function(){
		return (this._type & 0x40000)!==0;
	}

	/**@inheritDoc */
	__proto.widthed=function(sprite){
		return (this._type & 0x8)!=0;
	}

	/**
	*@private
	*/
	__proto._calculation=function(type,value){
		if (value.indexOf('%')< 0)return false;
		var ower=this._ower;
		var parent=ower.parent;
		var rect=this._rect;
		function getValue (pw,w,nums){
			return (pw *nums[0]+w *nums[1]+nums[2]);
		}
		function onParentResize (type){
			var pw=parent.width,w=ower.width;
			rect.width && (ower.width=getValue(pw,w,rect.width));
			rect.height && (ower.height=getValue(pw,w,rect.height));
			rect.left && (ower.x=getValue(pw,w,rect.left));
			rect.top && (ower.y=getValue(pw,w,rect.top));
		}
		if (rect===null){
			parent._getCSSStyle()._type |=0x80000;
			parent.on("resize",this,onParentResize);
			this._rect=rect={input:{}};
		};
		var nums=value.split(' ');
		nums[0]=parseFloat(nums[0])/ 100;
		if (nums.length==1)
			nums[1]=nums[2]=0;
		else {
			nums[1]=parseFloat(nums[1])/ 100;
			nums[2]=parseFloat(nums[2]);
		}
		rect[type]=nums;
		rect.input[type]=value;
		onParentResize(type);
		return true;
	}

	/**
	*是否已设置高度。
	*@param sprite 显示对象 Sprite。
	*@return 一个Boolean 表示是否已设置高度。
	*/
	__proto.heighted=function(sprite){
		return (this._type & 0x2000)!=0;
	}

	/**
	*设置宽高。
	*@param w 宽度。
	*@param h 高度。
	*/
	__proto.size=function(w,h){
		var ower=this._ower;
		var resize=false;
		if (w!==-1 && w !=this._ower.width){
			this._type |=0x8;
			this._ower.width=w;
			resize=true;
		}
		if (h!==-1 && h !=this._ower.height){
			this._type |=0x2000;
			this._ower.height=h;
			resize=true;
		}
		if (resize){
			ower._layoutLater();
			(this._type & 0x80000)&& ower.event("resize",this);
		}
	}

	/**@private */
	__proto._getAlign=function(){
		return this._aligns[0];
	}

	/**@private */
	__proto._getValign=function(){
		return this._aligns[1];
	}

	/**@private */
	__proto._getCssFloat=function(){
		return (this._type & 0x8000)!=0 ? 0x8000 :0;
	}

	__proto._createFont=function(){
		return (this._type & 0x1000)? this._font :(this._type |=0x1000,this._font=new Font(this._font));
	}

	/**@inheritDoc */
	__proto.render=function(sprite,context,x,y){
		var w=sprite.width;
		var h=sprite.height;
		x-=sprite.pivotX;
		y-=sprite.pivotY;
		this._bgground && this._bgground.color !=null && context.ctx.fillRect(x,y,w,h,this._bgground.color);
		this._border && this._border.color && context.drawRect(x,y,w,h,this._border.color.strColor,this._border.size);
	}

	/**@inheritDoc */
	__proto.getCSSStyle=function(){
		return this;
	}

	/**
	*设置 CSS 样式字符串。
	*@param text CSS样式字符串。
	*/
	__proto.cssText=function(text){
		this.attrs(CSSStyle.parseOneCSS(text,';'));
	}

	/**
	*根据传入的属性名、属性值列表，设置此对象的属性值。
	*@param attrs 属性名与属性值列表。
	*/
	__proto.attrs=function(attrs){
		if (attrs){
			for (var i=0,n=attrs.length;i < n;i++){
				var attr=attrs[i];
				this[attr[0]]=attr[1];
			}
		}
	}

	/**@inheritDoc */
	__proto.setTransform=function(value){
		(value==='none')? (this._tf=Style._TF_EMPTY):this.attrs(CSSStyle.parseOneCSS(value,','));
	}

	/**
	*定义 X 轴、Y 轴移动转换。
	*@param x X 轴平移量。
	*@param y Y 轴平移量。
	*/
	__proto.translate=function(x,y){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.translateX=x;
		this._tf.translateY=y;
	}

	/**
	*定义 缩放转换。
	*@param x X 轴缩放值。
	*@param y Y 轴缩放值。
	*/
	__proto.scale=function(x,y){
		this._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());
		this._tf.scaleX=x;
		this._tf.scaleY=y;
	}

	/**@private */
	__proto._enableLayout=function(){
		return (this._type & 0x2)===0 && (this._type & 0x4)===0;
	}

	/**
	*是否显示为块级元素。
	*/
	__getset(0,__proto,'block',_super.prototype._$get_block,function(value){
		value ? (this._type |=0x1):(this._type &=(~0x1));
	});

	/**
	*垂直对齐方式。
	*/
	__getset(0,__proto,'valign',function(){
		return CSSStyle._valigndef[this._aligns[1]];
		},function(value){
		this._aligns===CSSStyle._ALIGNS && (this._aligns=[0,0,0]);
		this._aligns[1]=CSSStyle._valigndef[value];
	});

	/**
	*高度。
	*/
	__getset(0,__proto,'height',null,function(h){
		this._type |=0x2000;
		if ((typeof h=='string')){
			if (this._calculation("height",h))return;
			h=parseInt(h);
		}
		this.size(-1,h);
	});

	/**
	*宽度。
	*/
	__getset(0,__proto,'width',null,function(w){
		this._type |=0x8;
		if ((typeof w=='string')){
			var offset=w.indexOf('auto');
			if (offset >=0){
				this._type |=0x40000;
				w=w.substr(0,offset);
			}
			if (this._calculation("width",w))return;
			w=parseInt(w);
		}
		this.size(w,-1);
	});

	/**
	*字体粗细。
	*/
	__getset(0,__proto,'fontWeight',function(){
		return this._font.weight;
		},function(value){
		this._createFont().weight=value;
	});

	/**
	*表示左边距。
	*/
	__getset(0,__proto,'left',null,function(value){
		var ower=this._ower;
		if (((typeof value=='string'))){
			if (value==="center")
				value="50% -50% 0";
			else if (value==="right")
			value="100% -100% 0";
			if (this._calculation("left",value))return;
			value=parseInt(value);
		}
		ower.x=value;
	});

	__getset(0,__proto,'_translate',null,function(value){
		this.translate(value[0],value[1]);
	});

	/**@inheritDoc */
	__getset(0,__proto,'absolute',function(){
		return (this._type & 0x4)!==0;
	});

	/**
	*表示上边距。
	*/
	__getset(0,__proto,'top',null,function(value){
		var ower=this._ower;
		if (((typeof value=='string'))){
			if (value==="middle")
				value="50% -50% 0";
			else if (value==="bottom")
			value="100% -100% 0";
			if (this._calculation("top",value))return;
			value=parseInt(value);
		}
		ower.y=value;
	});

	/**
	*水平对齐方式。
	*/
	__getset(0,__proto,'align',function(){
		return CSSStyle._aligndef[this._aligns[0]];
		},function(value){
		this._aligns===CSSStyle._ALIGNS && (this._aligns=[0,0,0]);
		this._aligns[0]=CSSStyle._aligndef[value];
	});

	/**
	*表示是否加粗。
	*/
	__getset(0,__proto,'bold',function(){
		return this._font.bold;
		},function(value){
		this._createFont().bold=value;
	});

	/**
	*边距信息。
	*/
	__getset(0,__proto,'padding',function(){
		return this._padding;
		},function(value){
		this._padding=value;
	});

	/**
	*行间距。
	*/
	__getset(0,__proto,'leading',function(){
		return this._spacing[1];
		},function(d){
		((typeof d=='string'))&& (d=parseInt(d+""));
		this._spacing===CSSStyle._SPACING && (this._spacing=[0,0]);
		this._spacing[1]=d;
	});

	/**
	*是否是行元素。
	*/
	__getset(0,__proto,'lineElement',function(){
		return (this._type & 0x10000)!=0;
		},function(value){
		value ? (this._type |=0x10000):(this._type &=(~0x10000));
	});

	/**
	*浮动方向。
	*/
	__getset(0,__proto,'cssFloat',function(){
		return (this._type & 0x8000)!=0 ? "right" :"left";
		},function(value){
		this.lineElement=false;
		value==="right" ? (this._type |=0x8000):(this._type &=(~0x8000));
	});

	/**
	*添加到文本的修饰。
	*/
	__getset(0,__proto,'textDecoration',function(){
		return this._font.decoration;
		},function(value){
		this._createFont().decoration=value;
	});

	/**
	*设置如何处理元素内的空白。
	*/
	__getset(0,__proto,'whiteSpace',function(){
		return (this._type & 0x20000)? "nowrap" :"";
		},function(type){
		type==="nowrap" && (this._type |=0x20000);
		type==="none" && (this._type &=~0x20000);
	});

	__getset(0,__proto,'background',null,function(value){
		if (!value){
			this._bgground=null;
			return;
		}
		this._bgground || (this._bgground={});
		this._bgground.color=value;
		this._ower.conchModel && this._ower.conchModel.bgColor(value);
		this._type |=0x4000;
		this._ower._renderType |=0x100;
	});

	/**
	*表示是否换行。
	*/
	__getset(0,__proto,'wordWrap',function(){
		return (this._type & 0x20000)===0;
		},function(value){
		value ? (this._type &=~0x20000):(this._type |=0x20000);
	});

	/**
	*字体颜色。
	*/
	__getset(0,__proto,'color',function(){
		return this._font.color;
		},function(value){
		this._createFont().color=value;
	});

	/**
	*<p>指定文本字段是否是密码文本字段。</p>
	*如果此属性的值为 true，则文本字段被视为密码文本字段，并使用星号而不是实际字符来隐藏输入的字符。如果为 false，则不会将文本字段视为密码文本字段。
	*/
	__getset(0,__proto,'password',function(){
		return this._font.password;
		},function(value){
		this._createFont().password=value;
	});

	/**
	*背景颜色。
	*/
	__getset(0,__proto,'backgroundColor',function(){
		return this._bgground ? this._bgground.color :null;
		},function(value){
		if (value==='none')this._bgground=null;
		else (this._bgground || (this._bgground={}),this._bgground.color=value);
		this._ower.conchModel && this._ower.conchModel.bgColor(value);
		this._ower._renderType |=0x100;
	});

	/**
	*字体信息。
	*/
	__getset(0,__proto,'font',function(){
		return this._font.toString();
		},function(value){
		this._createFont().set(value);
	});

	/**
	*文本的粗细。
	*/
	__getset(0,__proto,'weight',null,function(value){
		this._createFont().weight=value;
	});

	/**
	*间距。
	*/
	__getset(0,__proto,'letterSpacing',function(){
		return this._spacing[0];
		},function(d){
		((typeof d=='string'))&& (d=parseInt(d+""));
		this._spacing===CSSStyle._SPACING && (this._spacing=[0,0]);
		this._spacing[0]=d;
	});

	/**
	*字体大小。
	*/
	__getset(0,__proto,'fontSize',function(){
		return this._font.size;
		},function(value){
		this._createFont().size=value;
	});

	/**
	*表示是否为斜体。
	*/
	__getset(0,__proto,'italic',function(){
		return this._font.italic;
		},function(value){
		this._createFont().italic=value;
	});

	/**
	*字体系列。
	*/
	__getset(0,__proto,'fontFamily',function(){
		return this._font.family;
		},function(value){
		this._createFont().family=value;
	});

	/**
	*<p>描边宽度（以像素为单位）。</p>
	*默认值0，表示不描边。
	*@default 0
	*/
	__getset(0,__proto,'stroke',function(){
		return this._font.stroke[0];
		},function(value){
		if (this._createFont().stroke===Font._STROKE)this._font.stroke=[0,"#000000"];
		this._font.stroke[0]=value;
	});

	/**
	*<p>描边颜色，以字符串表示。</p>
	*@default "#000000";
	*/
	__getset(0,__proto,'strokeColor',function(){
		return this._font.stroke[1];
		},function(value){
		if (this._createFont().stroke===Font._STROKE)this._font.stroke=[0,"#000000"];
		this._font.stroke[1]=value;
	});

	/**
	*边框属性，比如border="5px solid red"
	*/
	__getset(0,__proto,'border',function(){
		return this._border ? this._border.value :"";
		},function(value){
		if (value=='none'){
			this._border=null;
			return;
		}
		this._border || (this._border={});
		this._border.value=value;
		var values=value.split(' ');
		this._border.color=Color$1.create(values[values.length-1]);
		if (values.length==1){
			this._border.size=1;
			this._border.type='solid';
			return;
		};
		var i=0;
		if (values[0].indexOf('px')> 0){
			this._border.size=parseInt(values[0]);
			i++;
		}else this._border.size=1;
		this._border.type=values[i];
		this._ower._renderType |=0x100;
	});

	/**
	*边框的颜色。
	*/
	__getset(0,__proto,'borderColor',function(){
		return (this._border && this._border.color)? this._border.color.strColor :null;
		},function(value){
		if (!value){
			this._border=null;
			return;
		}
		this._border || (this._border={size:1,type:'solid'});
		this._border.color=(value==null)? null :Color$1.create(value);
		this._ower.conchModel && this._ower.conchModel.border(this._border.color.strColor);
		this._ower._renderType |=0x100;
	});

	/**
	*元素的定位类型。
	*/
	__getset(0,__proto,'position',function(){
		return (this._type & 0x4)? "absolute" :"";
		},function(value){
		value=="absolute" ? (this._type |=0x4):(this._type &=~0x4);
	});

	/**
	*规定元素应该生成的框的类型。
	*/
	__getset(0,__proto,'display',null,function(value){
		switch (value){
			case '':
				this._type &=~0x2;
				this.visible=true;
				break ;
			case 'none':
				this._type |=0x2;
				this.visible=false;
				this._ower._layoutLater();
				break ;
			}
	});

	/**@inheritDoc */
	__getset(0,__proto,'paddingLeft',function(){
		return this.padding[3];
	});

	/**@inheritDoc */
	__getset(0,__proto,'paddingTop',function(){
		return this.padding[0];
	});

	__getset(0,__proto,'_scale',null,function(value){
		this._ower.scale(value[0],value[1]);
	});

	__getset(0,__proto,'_rotate',null,function(value){
		this._ower.rotation=value;
	});

	CSSStyle.parseOneCSS=function(text,clipWord){
		var out=[];
		var attrs=text.split(clipWord);
		var valueArray;
		for (var i=0,n=attrs.length;i < n;i++){
			var attr=attrs[i];
			var ofs=attr.indexOf(':');
			var name=attr.substr(0,ofs).replace(/^\s+|\s+$/g,'');
			if (name.length==0)
				continue ;
			var value=attr.substr(ofs+1).replace(/^\s+|\s+$/g,'');
			var one=[name,value];
			switch (name){
				case 'italic':
				case 'bold':
					one[1]=value=="true";
					break ;
				case 'line-height':
					one[0]='lineHeight';
					one[1]=parseInt(value);
					break ;
				case 'font-size':
					one[0]='fontSize';
					one[1]=parseInt(value);
					break ;
				case 'padding':
					valueArray=value.split(' ');
					valueArray.length > 1 || (valueArray[1]=valueArray[2]=valueArray[3]=valueArray[0]);
					one[1]=[parseInt(valueArray[0]),parseInt(valueArray[1]),parseInt(valueArray[2]),parseInt(valueArray[3])];
					break ;
				case 'rotate':
					one[0]="_rotate";
					one[1]=parseFloat(value);
					break ;
				case 'scale':
					valueArray=value.split(' ');
					one[0]="_scale";
					one[1]=[parseFloat(valueArray[0]),parseFloat(valueArray[1])];
					break ;
				case 'translate':
					valueArray=value.split(' ');
					one[0]="_translate";
					one[1]=[parseInt(valueArray[0]),parseInt(valueArray[1])];
					break ;
				default :
					(one[0]=CSSStyle._CSSTOVALUE[name])|| (one[0]=name);
				}
			out.push(one);
		}
		return out;
	}

	CSSStyle.parseCSS=function(text,uri){
		var one;
		while ((one=CSSStyle._parseCSSRegExp.exec(text))!=null){
			CSSStyle.styleSheets[one[1]]=CSSStyle.parseOneCSS(one[2],';');
		}
	}

	CSSStyle.EMPTY=new CSSStyle(null);
	CSSStyle._CSSTOVALUE={'letter-spacing':'letterSpacing','line-spacing':'lineSpacing','white-space':'whiteSpace','line-height':'lineHeight','scale-x':'scaleX','scale-y':'scaleY','translate-x':'translateX','translate-y':'translateY','font-family':'fontFamily','font-weight':'fontWeight','vertical-align':'valign','text-decoration':'textDecoration','background-color':'backgroundColor','border-color':'borderColor','float':'cssFloat'};
	CSSStyle._parseCSSRegExp=new RegExp("([\.\#]\\w+)\\s*{([\\s\\S]*?)}","g");
	CSSStyle._aligndef={'left':0,'center':1,'right':2,0:'left',1:'center',2:'right'};
	CSSStyle._valigndef={'top':0,'middle':1,'bottom':2,0:'top',1:'middle',2:'bottom'};
	CSSStyle.styleSheets={};
	CSSStyle.ALIGN_CENTER=1;
	CSSStyle.ALIGN_RIGHT=2;
	CSSStyle.VALIGN_MIDDLE=1;
	CSSStyle.VALIGN_BOTTOM=2;
	CSSStyle._CSS_BLOCK=0x1;
	CSSStyle._DISPLAY_NONE=0x2;
	CSSStyle._ABSOLUTE=0x4;
	CSSStyle._WIDTH_SET=0x8;
	CSSStyle._PADDING=[0,0,0,0];
	CSSStyle._RECT=[-1,-1,-1,-1];
	CSSStyle._SPACING=[0,0];
	CSSStyle._ALIGNS=[0,0,0];
	CSSStyle.ADDLAYOUTED=0x200;
	CSSStyle._NEWFONT=0x1000;
	CSSStyle._HEIGHT_SET=0x2000;
	CSSStyle._BACKGROUND_SET=0x4000;
	CSSStyle._FLOAT_RIGHT=0x8000;
	CSSStyle._LINE_ELEMENT=0x10000;
	CSSStyle._NOWARP=0x20000;
	CSSStyle._WIDTHAUTO=0x40000;
	CSSStyle._LISTERRESZIE=0x80000;
	return CSSStyle;
})(Style)


/**
*模糊滤镜
*/
//class laya.filters.BlurFilter extends laya.filters.Filter
var BlurFilter=(function(_super){
	function BlurFilter(strength){
		/**模糊滤镜的强度(值越大，越不清晰 */
		this.strength=NaN;
		this.strength_sig2_2sig2_gauss1=[];
		BlurFilter.__super.call(this);
		(strength===void 0)&& (strength=4);
		if (Render.isWebGL)WebGLFilter.enable();
		this.strength=strength;
		this._action=RunDriver.createFilterAction(0x10);
		this._action.data=this;
	}

	__class(BlurFilter,'laya.filters.BlurFilter',_super);
	var __proto=BlurFilter.prototype;
	/**
	*@private 通知微端
	*/
	__proto.callNative=function(sp){
		sp.conchModel &&sp.conchModel.blurFilter&&sp.conchModel.blurFilter(this.strength);
	}

	/**
	*@private
	*当前滤镜对应的操作器
	*/
	__getset(0,__proto,'action',function(){
		return this._action;
	});

	/**
	*@private
	*当前滤镜的类型
	*/
	__getset(0,__proto,'type',function(){
		return 0x10;
	});

	return BlurFilter;
})(Filter)


/**
*<p><code>ColorFilter</code> 是颜色滤镜。使用 ColorFilter 类可以将 4 x 5 矩阵转换应用于输入图像上的每个像素的 RGBA 颜色和 Alpha 值，以生成具有一组新的 RGBA 颜色和 Alpha 值的结果。该类允许饱和度更改、色相旋转、亮度转 Alpha 以及各种其他效果。您可以将滤镜应用于任何显示对象（即，从 Sprite 类继承的对象）。</p>
*<p>注意：对于 RGBA 值，最高有效字节代表红色通道值，其后的有效字节分别代表绿色、蓝色和 Alpha 通道值。</p>
*/
//class laya.filters.ColorFilter extends laya.filters.Filter
var ColorFilter=(function(_super){
	function ColorFilter(mat){
		/**@private */
		//this._mat=null;
		/**@private */
		//this._alpha=null;
		ColorFilter.__super.call(this);
		if (!mat){
			mat=[0.3,0.59,0.11,0,0,0.3,0.59,0.11,0,0,0.3,0.59,0.11,0,0,0,0,0,1,0];
		}
		this._mat=new Float32Array(16);
		this._alpha=new Float32Array(4);
		var j=0;
		var z=0;
		for (var i=0;i < 20;i++){
			if (i % 5 !=4){
				this._mat[j++]=mat[i];
				}else {
				this._alpha[z++]=mat[i];
			}
		}
		this._action=RunDriver.createFilterAction(0x20);
		this._action.data=this;
	}

	__class(ColorFilter,'laya.filters.ColorFilter',_super);
	var __proto=ColorFilter.prototype;
	Laya.imps(__proto,{"laya.filters.IFilter":true})
	/**
	*@private 通知微端
	*/
	__proto.callNative=function(sp){
		var t=sp._$P.cf=this;
		sp.conchModel && sp.conchModel.setFilterMatrix && sp.conchModel.setFilterMatrix(this._mat,this._alpha);
	}

	/**@private */
	__getset(0,__proto,'type',function(){
		return 0x20;
	});

	/**@private */
	__getset(0,__proto,'action',function(){
		return this._action;
	});

	return ColorFilter;
})(Filter)


/**
*发光滤镜(也可以当成阴影滤使用）
*/
//class laya.filters.GlowFilter extends laya.filters.Filter
var GlowFilter=(function(_super){
	function GlowFilter(color,blur,offX,offY){
		/**滤镜的颜色*/
		this._color=null;
		GlowFilter.__super.call(this);
		this._elements=new Float32Array(9);
		(blur===void 0)&& (blur=4);
		(offX===void 0)&& (offX=6);
		(offY===void 0)&& (offY=6);
		if (Render.isWebGL){
			WebGLFilter.enable();
		}
		this._color=new Color$1(color);
		this.blur=Math.min(blur,20);
		this.offX=offX;
		this.offY=offY;
		this._action=RunDriver.createFilterAction(0x08);
		this._action.data=this;
	}

	__class(GlowFilter,'laya.filters.GlowFilter',_super);
	var __proto=GlowFilter.prototype;
	/**@private */
	__proto.getColor=function(){
		return this._color._color;
	}

	/**
	*@private 通知微端
	*/
	__proto.callNative=function(sp){
		sp.conchModel &&sp.conchModel.glowFilter&&sp.conchModel.glowFilter(this._color.strColor,this._elements[4],this._elements[5],this._elements[6]);
	}

	/**
	*@private
	*滤镜类型
	*/
	__getset(0,__proto,'type',function(){
		return 0x08;
	});

	/**@private */
	__getset(0,__proto,'action',function(){
		return this._action;
	});

	/**@private */
	/**@private */
	__getset(0,__proto,'offY',function(){
		return this._elements[6];
		},function(value){
		this._elements[6]=value;
	});

	/**@private */
	/**@private */
	__getset(0,__proto,'offX',function(){
		return this._elements[5];
		},function(value){
		this._elements[5]=value;
	});

	/**@private */
	/**@private */
	__getset(0,__proto,'blur',function(){
		return this._elements[4];
		},function(value){
		this._elements[4]=value;
	});

	return GlowFilter;
})(Filter)


/**
*@private
*/
//class laya.filters.webgl.BlurFilterActionGL extends laya.filters.webgl.FilterActionGL
var BlurFilterActionGL=(function(_super){
	function BlurFilterActionGL(){
		this.data=null;
		BlurFilterActionGL.__super.call(this);
	}

	__class(BlurFilterActionGL,'laya.filters.webgl.BlurFilterActionGL',_super);
	var __proto=BlurFilterActionGL.prototype;
	__proto.setValueMix=function(shader){
		shader.defines.add(this.data.type);
		var o=shader;
	}

	__proto.apply3d=function(scope,sprite,context,x,y){
		var b=scope.getValue("bounds");
		var shaderValue=Value2D.create(0x01,0);
		shaderValue.setFilters([this.data]);
		var tMatrix=Matrix.EMPTY;
		tMatrix.identity();
		context.ctx.drawTarget(scope,0,0,b.width,b.height,Matrix.EMPTY,"src",shaderValue);
		shaderValue.setFilters(null);
	}

	__proto.setValue=function(shader){
		shader.strength=this.data.strength;
		var sigma=this.data.strength/3.0;
		var sigma2=sigma*sigma;
		this.data.strength_sig2_2sig2_gauss1[0]=this.data.strength;
		this.data.strength_sig2_2sig2_gauss1[1]=sigma2;
		this.data.strength_sig2_2sig2_gauss1[2]=2.0*sigma2;
		this.data.strength_sig2_2sig2_gauss1[3]=1.0/(2.0*Math.PI*sigma2);
		shader.strength_sig2_2sig2_gauss1=this.data.strength_sig2_2sig2_gauss1;
	}

	__getset(0,__proto,'typeMix',function(){return 0x10;});
	return BlurFilterActionGL;
})(FilterActionGL)


//class laya.filters.webgl.ColorFilterActionGL extends laya.filters.webgl.FilterActionGL
var ColorFilterActionGL=(function(_super){
	function ColorFilterActionGL(){
		this.data=null;
		ColorFilterActionGL.__super.call(this);
	}

	__class(ColorFilterActionGL,'laya.filters.webgl.ColorFilterActionGL',_super);
	var __proto=ColorFilterActionGL.prototype;
	Laya.imps(__proto,{"laya.filters.IFilterActionGL":true})
	__proto.setValue=function(shader){
		shader.colorMat=this.data._mat;
		shader.colorAlpha=this.data._alpha;
	}

	__proto.apply3d=function(scope,sprite,context,x,y){
		var b=scope.getValue("bounds");
		var shaderValue=Value2D.create(0x01,0);
		shaderValue.setFilters([this.data]);
		var tMatrix=Matrix.TEMP;
		tMatrix.identity();
		context.ctx.drawTarget(scope,0,0,b.width,b.height,tMatrix,"src",shaderValue);
	}

	return ColorFilterActionGL;
})(FilterActionGL)


/**
*@private
*/
//class laya.filters.webgl.GlowFilterActionGL extends laya.filters.webgl.FilterActionGL
var GlowFilterActionGL=(function(_super){
	function GlowFilterActionGL(){
		this.data=null;
		this._initKey=false;
		this._textureWidth=0;
		this._textureHeight=0;
		GlowFilterActionGL.__super.call(this);
	}

	__class(GlowFilterActionGL,'laya.filters.webgl.GlowFilterActionGL',_super);
	var __proto=GlowFilterActionGL.prototype;
	Laya.imps(__proto,{"laya.filters.IFilterActionGL":true})
	__proto.setValueMix=function(shader){}
	__proto.apply3d=function(scope,sprite,context,x,y){
		var b=scope.getValue("bounds");
		scope.addValue("color",this.data.getColor());
		var w=b.width,h=b.height;
		this._textureWidth=w;
		this._textureHeight=h;
		var shaderValue;
		var mat=Matrix.TEMP;
		mat.identity();
		shaderValue=Value2D.create(0x01,0);
		shaderValue.setFilters([this.data]);
		context.ctx.drawTarget(scope,0,0,this._textureWidth,this._textureHeight,mat,"src",shaderValue,null);
		shaderValue=Value2D.create(0x01,0);
		context.ctx.drawTarget(scope,0,0,this._textureWidth,this._textureHeight,mat,"src",shaderValue);
		return null;
	}

	__proto.setSpriteWH=function(sprite){
		this._textureWidth=sprite.width;
		this._textureHeight=sprite.height;
	}

	__proto.setValue=function(shader){
		shader.u_offsetX=this.data.offX;
		shader.u_offsetY=-this.data.offY;
		shader.u_strength=1.0;
		shader.u_blurX=this.data.blur;
		shader.u_blurY=this.data.blur;
		shader.u_textW=this._textureWidth;
		shader.u_textH=this._textureHeight;
		shader.u_color=this.data.getColor();
	}

	__getset(0,__proto,'typeMix',function(){return 0x08;});
	GlowFilterActionGL.tmpTarget=function(scope,sprite,context,x,y){
		var b=scope.getValue("bounds");
		var out=scope.getValue("out");
		out.end();
		var tmpTarget=RenderTarget2D.create(b.width,b.height);
		tmpTarget.start();
		var color=scope.getValue("color");
		if (color){
			tmpTarget.clear(color[0],color[1],color[2],0);
		}
		scope.addValue("tmpTarget",tmpTarget);
	}

	GlowFilterActionGL.startOut=function(scope,sprite,context,x,y){
		var tmpTarget=scope.getValue("tmpTarget");
		tmpTarget.end();
		var out=scope.getValue("out");
		out.start();
		var color=scope.getValue("color");
		if (color){
			out.clear(color[0],color[1],color[2],0);
		}
	}

	GlowFilterActionGL.recycleTarget=function(scope,sprite,context,x,y){
		var src=scope.getValue("src");
		var tmpTarget=scope.getValue("tmpTarget");
		tmpTarget.recycle();
	}

	return GlowFilterActionGL;
})(FilterActionGL)


/**
*
*@private
*/
//class laya.particle.emitter.Emitter2D extends laya.particle.emitter.EmitterBase
var Emitter2D=(function(_super){
	function Emitter2D(_template){
		this.setting=null;
		this._posRange=null;
		this._canvasTemplate=null;
		this._emitFun=null;
		Emitter2D.__super.call(this);
		this.template=_template;
	}

	__class(Emitter2D,'laya.particle.emitter.Emitter2D',_super);
	var __proto=Emitter2D.prototype;
	__proto.emit=function(){
		_super.prototype.emit.call(this);
		if(this._emitFun!=null)
			this._emitFun();
	}

	__proto.getRandom=function(value){
		return (Math.random()*2-1)*value;
	}

	__proto.webGLEmit=function(){
		var pos=new Float32Array(3);
		pos[0]=this.getRandom(this._posRange[0]);
		pos[1]=this.getRandom(this._posRange[1]);
		pos[2]=this.getRandom(this._posRange[2]);
		var v=new Float32Array(3);
		v[0]=0;
		v[1]=0;
		v[2]=0;
		this._particleTemplate.addParticleArray(pos,v);
	}

	__proto.canvasEmit=function(){
		var pos=new Float32Array(3);
		pos[0]=this.getRandom(this._posRange[0]);
		pos[1]=this.getRandom(this._posRange[1]);
		pos[2]=this.getRandom(this._posRange[2]);
		var v=new Float32Array(3);
		v[0]=0;
		v[1]=0;
		v[2]=0;
		this._particleTemplate.addParticleArray(pos,v);
	}

	__getset(0,__proto,'template',function(){
		return this._particleTemplate;
		},function(template){
		this._particleTemplate=template;
		if (!template){
			this._emitFun=null;
			this.setting=null;
			this._posRange=null;
		};
		this.setting=template.settings;
		this._posRange=this.setting.positionVariance;
		if((this._particleTemplate instanceof laya.particle.ParticleTemplate2D )){
			this._emitFun=this.webGLEmit;
		}else
		if((this._particleTemplate instanceof laya.particle.ParticleTemplateCanvas )){
			this._canvasTemplate=template;
			this._emitFun=this.canvasEmit;
		}
	});

	return Emitter2D;
})(EmitterBase)


/**
*<code>UIEvent</code> 类用来定义UI组件类的事件类型。
*/
//class laya.ui.UIEvent extends laya.events.Event
var UIEvent=(function(_super){
	function UIEvent(){
		UIEvent.__super.call(this);;
	}

	__class(UIEvent,'laya.ui.UIEvent',_super);
	UIEvent.SHOW_TIP="showtip";
	UIEvent.HIDE_TIP="hidetip";
	return UIEvent;
})(Event)


/**
*@private
*/
//class laya.particle.ParticleTemplateWebGL extends laya.particle.ParticleTemplateBase
var ParticleTemplateWebGL=(function(_super){
	function ParticleTemplateWebGL(parSetting){
		this._vertices=null;
		this._vertexBuffer=null;
		this._indexBuffer=null;
		this._floatCountPerVertex=29;
		//0~3为CornerTextureCoordinate,4~6为Position,7~9Velocity,10到13为StartColor,14到17为EndColor,18到20位SizeRotation，21到22位Radius,23到26位Radian，27为DurationAddScaleShaderValue,28为Time
		this._firstActiveElement=0;
		this._firstNewElement=0;
		this._firstFreeElement=0;
		this._firstRetiredElement=0;
		this._currentTime=0;
		this._drawCounter=0;
		ParticleTemplateWebGL.__super.call(this);
		this.settings=parSetting;
	}

	__class(ParticleTemplateWebGL,'laya.particle.ParticleTemplateWebGL',_super);
	var __proto=ParticleTemplateWebGL.prototype;
	__proto.initialize=function(){
		this._vertices=new Float32Array(this.settings.maxPartices *this._floatCountPerVertex *4);
		var particleOffset=0;
		for (var i=0;i < this.settings.maxPartices;i++){
			var random=Math.random();
			var cornerYSegement=this.settings.textureCount ? 1.0 / this.settings.textureCount :1.0;
			var cornerY=NaN;
			for (cornerY=0;cornerY < this.settings.textureCount;cornerY+=cornerYSegement){
				if (random < cornerY+cornerYSegement)
					break ;
			}
			particleOffset=i *this._floatCountPerVertex *4;
			this._vertices[particleOffset+this._floatCountPerVertex *0+0]=-1;
			this._vertices[particleOffset+this._floatCountPerVertex *0+1]=-1;
			this._vertices[particleOffset+this._floatCountPerVertex *0+2]=0;
			this._vertices[particleOffset+this._floatCountPerVertex *0+3]=cornerY;
			this._vertices[particleOffset+this._floatCountPerVertex *1+0]=1;
			this._vertices[particleOffset+this._floatCountPerVertex *1+1]=-1;
			this._vertices[particleOffset+this._floatCountPerVertex *1+2]=1;
			this._vertices[particleOffset+this._floatCountPerVertex *1+3]=cornerY;
			this._vertices[particleOffset+this._floatCountPerVertex *2+0]=1;
			this._vertices[particleOffset+this._floatCountPerVertex *2+1]=1;
			this._vertices[particleOffset+this._floatCountPerVertex *2+2]=1;
			this._vertices[particleOffset+this._floatCountPerVertex *2+3]=cornerY+cornerYSegement;
			this._vertices[particleOffset+this._floatCountPerVertex *3+0]=-1;
			this._vertices[particleOffset+this._floatCountPerVertex *3+1]=1;
			this._vertices[particleOffset+this._floatCountPerVertex *3+2]=0;
			this._vertices[particleOffset+this._floatCountPerVertex *3+3]=cornerY+cornerYSegement;
		}
	}

	__proto.loadContent=function(){}
	__proto.update=function(elapsedTime){
		this._currentTime+=elapsedTime / 1000;
		this.retireActiveParticles();
		this.freeRetiredParticles();
		if (this._firstActiveElement==this._firstFreeElement)
			this._currentTime=0;
		if (this._firstRetiredElement==this._firstActiveElement)
			this._drawCounter=0;
	}

	__proto.retireActiveParticles=function(){
		var epsilon=0.0001;
		var particleDuration=this.settings.duration;
		while (this._firstActiveElement !=this._firstNewElement){
			var offset=this._firstActiveElement *this._floatCountPerVertex *4;
			var index=offset+28;
			var particleAge=this._currentTime-this._vertices[index];
			particleAge *=(1.0+this._vertices[offset+27]);
			if (particleAge+epsilon < particleDuration)
				break ;
			this._vertices[index]=this._drawCounter;
			this._firstActiveElement++;
			if (this._firstActiveElement >=this.settings.maxPartices)
				this._firstActiveElement=0;
		}
	}

	__proto.freeRetiredParticles=function(){
		while (this._firstRetiredElement !=this._firstActiveElement){
			var age=this._drawCounter-this._vertices[this._firstRetiredElement *this._floatCountPerVertex *4+28];
			if (age < 3)
				break ;
			this._firstRetiredElement++;
			if (this._firstRetiredElement >=this.settings.maxPartices)
				this._firstRetiredElement=0;
		}
	}

	__proto.addNewParticlesToVertexBuffer=function(){}
	__proto.addParticleArray=function(position,velocity){
		var nextFreeParticle=this._firstFreeElement+1;
		if (nextFreeParticle >=this.settings.maxPartices)
			nextFreeParticle=0;
		if (nextFreeParticle===this._firstRetiredElement)
			return;
		var particleData=ParticleData.Create(this.settings,position,velocity,this._currentTime);
		var startIndex=this._firstFreeElement *this._floatCountPerVertex *4;
		for (var i=0;i < 4;i++){
			var j=0,offset=0;
			for (j=0,offset=4;j < 3;j++)
			this._vertices[startIndex+i *this._floatCountPerVertex+offset+j]=particleData.position[j];
			for (j=0,offset=7;j < 3;j++)
			this._vertices[startIndex+i *this._floatCountPerVertex+offset+j]=particleData.velocity[j];
			for (j=0,offset=10;j < 4;j++)
			this._vertices[startIndex+i *this._floatCountPerVertex+offset+j]=particleData.startColor[j];
			for (j=0,offset=14;j < 4;j++)
			this._vertices[startIndex+i *this._floatCountPerVertex+offset+j]=particleData.endColor[j];
			for (j=0,offset=18;j < 3;j++)
			this._vertices[startIndex+i *this._floatCountPerVertex+offset+j]=particleData.sizeRotation[j];
			for (j=0,offset=21;j < 2;j++)
			this._vertices[startIndex+i *this._floatCountPerVertex+offset+j]=particleData.radius[j];
			for (j=0,offset=23;j < 4;j++)
			this._vertices[startIndex+i *this._floatCountPerVertex+offset+j]=particleData.radian[j];
			this._vertices[startIndex+i *this._floatCountPerVertex+27]=particleData.durationAddScale;
			this._vertices[startIndex+i *this._floatCountPerVertex+28]=particleData.time;
		}
		this._firstFreeElement=nextFreeParticle;
	}

	return ParticleTemplateWebGL;
})(ParticleTemplateBase)


/**
*@private
*/
//class laya.particle.ParticleTemplateCanvas extends laya.particle.ParticleTemplateBase
var ParticleTemplateCanvas=(function(_super){
	function ParticleTemplateCanvas(particleSetting){
		/**
		*是否处于可播放状态
		*/
		this._ready=false;
		/**
		*贴图列表
		*/
		this.textureList=[];
		/**
		*粒子列表
		*/
		this.particleList=[];
		/**
		*贴图中心偏移x
		*/
		this.pX=0;
		/**
		*贴图中心偏移y
		*/
		this.pY=0;
		/**
		*当前活跃的粒子
		*/
		this.activeParticles=[];
		/**
		*粒子pool
		*/
		this.deadParticles=[];
		/**
		*粒子播放进度列表
		*/
		this.iList=[];
		/**
		*粒子系统使用的最大粒子数
		*/
		this._maxNumParticles=0;
		/**
		*纹理的宽度
		*/
		this.textureWidth=NaN;
		/**
		*宽度倒数
		*/
		this.dTextureWidth=NaN;
		/**
		*是否支持颜色变化
		*/
		this.colorChange=true;
		/**
		*采样步长
		*/
		this.step=1/60;
		this.canvasShader=new CanvasShader();
		ParticleTemplateCanvas.__super.call(this);
		this.settings=particleSetting;
		this._maxNumParticles=particleSetting.maxPartices;
		this.texture=new Texture();
		this.texture.on("loaded",this,this._textureLoaded);
		this.texture.load(particleSetting.textureName);
	}

	__class(ParticleTemplateCanvas,'laya.particle.ParticleTemplateCanvas',_super);
	var __proto=ParticleTemplateCanvas.prototype;
	__proto._textureLoaded=function(e){
		this.setTexture(this.texture);
		this._ready=true;
	}

	__proto.clear=function(clearTexture){
		(clearTexture===void 0)&& (clearTexture=true);
		this.deadParticles.length=0;
		this.activeParticles.length=0;
		this.textureList.length=0;
	}

	/**
	*设置纹理
	*@param texture
	*
	*/
	__proto.setTexture=function(texture){
		this.texture=texture;
		this.textureWidth=texture.width;
		this.dTextureWidth=1/this.textureWidth;
		this.pX=-texture.width*0.5;
		this.pY=-texture.height*0.5;
		this.textureList=ParticleTemplateCanvas.changeTexture(texture,this.textureList);
		this.particleList.length=0;
		this.deadParticles.length=0;
		this.activeParticles.length=0;
	}

	/**
	*创建一个粒子数据
	*@return
	*
	*/
	__proto._createAParticleData=function(position,velocity){
		this.canvasShader.u_EndVelocity=this.settings.endVelocity;
		this.canvasShader.u_Gravity=this.settings.gravity;
		this.canvasShader.u_Duration=this.settings.duration;
		var particle;
		particle=ParticleData.Create(this.settings,position,velocity,0);
		this.canvasShader.a_Position=particle.position;
		this.canvasShader.a_Velocity=particle.velocity;
		this.canvasShader.a_StartColor=particle.startColor;
		this.canvasShader.a_EndColor=particle.endColor;
		this.canvasShader.a_SizeRotation=particle.sizeRotation;
		this.canvasShader.a_Radius=particle.radius;
		this.canvasShader.a_Radian=particle.radian;
		this.canvasShader.a_AgeAddScale=particle.durationAddScale;
		this.canvasShader.oSize=this.textureWidth;
		var rst=new CMDParticle();
		var i=0,len=this.settings.duration/(1+particle.durationAddScale);
		var params=[];
		var mStep=NaN;
		for(i=0;i<len;i+=this.step){
			params.push(this.canvasShader.getData(i));
		}
		rst.id=this.particleList.length;
		this.particleList.push(rst);
		rst.setCmds(params);
		return rst;
	}

	__proto.addParticleArray=function(position,velocity){
		if(!this._ready)return;
		var tParticle;
		if(this.particleList.length<this._maxNumParticles){
			tParticle=this._createAParticleData(position,velocity);
			this.iList[tParticle.id]=0;
			this.activeParticles.push(tParticle);
			}else{
			if(this.deadParticles.length>0){
				tParticle=this.deadParticles.pop();
				this.iList[tParticle.id]=0;
				this.activeParticles.push(tParticle);
			}
		}
	}

	__proto.advanceTime=function(passedTime){
		(passedTime===void 0)&& (passedTime=1);
		if(!this._ready)return;
		var particleList=this.activeParticles;
		var pool=this.deadParticles;
		var i=0,len=particleList.length;
		var tcmd;
		var tI=0;
		var iList=this.iList;
		for(i=len-1;i>-1;i--){
			tcmd=particleList[i];
			tI=iList[tcmd.id];
			if(tI>=tcmd.maxIndex){
				tI=0;
				particleList.splice(i,1);
				pool.push(tcmd);
				}else{
				tI+=1;
			}
			iList[tcmd.id]=tI;
		}
	}

	__proto.render=function(context,x,y){
		if(!this._ready)return;
		if(this.activeParticles.length<1)return;
		if (this.textureList.length < 2)return;
		if (this.settings.disableColor){
			this.noColorRender(context,x,y);
			}else{
			this.canvasRender(context,x,y);
		}
	}

	__proto.noColorRender=function(context,x,y){
		var particleList=this.activeParticles;
		var i=0,len=particleList.length;
		var tcmd;
		var tParam;
		var tAlpha=NaN;
		var px=this.pX,py=this.pY;
		var pw=-px*2,ph=-py*2;
		var tI=0;
		var textureList=this.textureList;
		var iList=this.iList;
		var preAlpha=NaN;
		context.translate(x,y);
		preAlpha=context.ctx.globalAlpha;
		for(i=0;i<len;i++){
			tcmd=particleList[i];
			tI=iList[tcmd.id];
			tParam=tcmd.cmds[tI];
			if (!tParam)continue ;
			if ((tAlpha=tParam[1])<=0.01)continue ;
			context.setAlpha(preAlpha*tAlpha);
			context.drawTextureWithTransform(this.texture,px,py,pw,ph,tParam[2],1);
		}
		context.setAlpha(preAlpha);
		context.translate(-x,-y);
	}

	__proto.canvasRender=function(context,x,y){
		var particleList=this.activeParticles;
		var i=0,len=particleList.length;
		var tcmd;
		var tParam;
		var tAlpha=NaN;
		var px=this.pX,py=this.pY;
		var pw=-px*2,ph=-py*2;
		var tI=0;
		var textureList=this.textureList;
		var iList=this.iList;
		var preAlpha=NaN;
		var preB;
		context.translate(x,y);
		preAlpha=context.ctx.globalAlpha;
		preB=context.ctx.globalCompositeOperation;
		context.blendMode("lighter");
		for(i=0;i<len;i++){
			tcmd=particleList[i];
			tI=iList[tcmd.id];
			tParam=tcmd.cmds[tI];
			if (!tParam)continue ;
			if ((tAlpha=tParam[1])<=0.01)continue ;
			context.save();
			context.transformByMatrix(tParam[2]);
			if(tParam[3]>0.01){
				context.setAlpha(preAlpha*tParam[3]);
				context.drawTexture(textureList[0],px,py,pw,ph);
			}
			if(tParam[4]>0.01){
				context.setAlpha(preAlpha*tParam[4]);
				context.drawTexture(textureList[1],px,py,pw,ph);
			}
			if(tParam[5]>0.01){
				context.setAlpha(preAlpha*tParam[5]);
				context.drawTexture(textureList[2],px,py,pw,ph);
			}
			context.restore();
		}
		context.setAlpha(preAlpha);
		context.translate(-x,-y);
		context.blendMode(preB);
	}

	ParticleTemplateCanvas.changeTexture=function(texture,rst,settings){
		if(!rst)rst=[];
		rst.length=0;
		if (settings&&settings.disableColor){
			rst.push(texture,texture,texture);
			}else{
			Utils.copyArray(rst,PicTool.getRGBPic(texture));
		}
		return rst;
	}

	return ParticleTemplateCanvas;
})(ParticleTemplateBase)


//class laya.webgl.shader.d2.value.Value2D extends laya.webgl.shader.ShaderValue
var Value2D=(function(_super){
	function Value2D(mainID,subID){
		this.size=[0,0];
		this.alpha=1.0;
		//this.mmat=null;
		this.ALPHA=1.0;
		//this.shader=null;
		//this.mainID=0;
		this.subID=0;
		//this.filters=null;
		//this.textureHost=null;
		//this.texture=null;
		//this.fillStyle=null;
		//this.color=null;
		//this.strokeStyle=null;
		//this.colorAdd=null;
		//this.glTexture=null;
		//this.u_mmat2=null;
		//this._inClassCache=null;
		this._cacheID=0;
		Value2D.__super.call(this);
		this.defines=new ShaderDefines2D();
		this.position=Value2D._POSITION;
		this.mainID=mainID;
		this.subID=subID;
		this.textureHost=null;
		this.texture=null;
		this.fillStyle=null;
		this.color=null;
		this.strokeStyle=null;
		this.colorAdd=null;
		this.glTexture=null;
		this.u_mmat2=null;
		this._cacheID=mainID|subID;
		this._inClassCache=Value2D._cache[this._cacheID];
		if (mainID>0 && !this._inClassCache){
			this._inClassCache=Value2D._cache[this._cacheID]=[];
			this._inClassCache._length=0;
		}
		this.clear();
	}

	__class(Value2D,'laya.webgl.shader.d2.value.Value2D',_super);
	var __proto=Value2D.prototype;
	__proto.setValue=function(value){}
	//throw new Error("todo in subclass");
	__proto.refresh=function(){
		var size=this.size;
		size[0]=RenderState2D.width;
		size[1]=RenderState2D.height;
		this.alpha=this.ALPHA *RenderState2D.worldAlpha;
		this.mmat=RenderState2D.worldMatrix4;
		return this;
	}

	__proto._ShaderWithCompile=function(){
		return Shader.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID | this.defines._value,Shader2X.create);
	}

	__proto._withWorldShaderDefines=function(){
		var defs=RenderState2D.worldShaderDefines;
		var sd=Shader.sharders [this.mainID | this.defines._value | defs.getValue()];
		if (!sd){
			var def={};
			var dic;
			var name;
			dic=this.defines.toNameDic();for (name in dic)def[name]="";
			dic=defs.toNameDic();for (name in dic)def[name]="";
			sd=Shader.withCompile2D(0,this.mainID,def,this.mainID | this.defines._value| defs.getValue(),Shader2X.create);
		};
		var worldFilters=RenderState2D.worldFilters;
		if (!worldFilters)return sd;
		var n=worldFilters.length,f;
		for (var i=0;i < n;i++){
			((f=worldFilters[i]))&& f.action.setValue(this);
		}
		return sd;
	}

	__proto.upload=function(){
		var renderstate2d=RenderState2D;
		this.alpha=this.ALPHA *renderstate2d.worldAlpha;
		if (RenderState2D.worldMatrix4!==RenderState2D.TEMPMAT4_ARRAY)this.defines.add(0x80);
		(WebGL.shaderHighPrecision)&& (this.defines.add(0x400));
		var sd=renderstate2d.worldShaderDefines?this._withWorldShaderDefines():(Shader.sharders [this.mainID | this.defines._value] || this._ShaderWithCompile());
		var params;
		this.size[0]=renderstate2d.width,this.size[1]=renderstate2d.height;
		this.mmat=renderstate2d.worldMatrix4;
		if (BaseShader.activeShader!==sd){
			if (sd._shaderValueWidth!==renderstate2d.width || sd._shaderValueHeight!==renderstate2d.height){
				sd._shaderValueWidth=renderstate2d.width;
				sd._shaderValueHeight=renderstate2d.height;
			}
			else{
				params=sd._params2dQuick2 || sd._make2dQuick2();
			}
			sd.upload(this,params);
		}
		else{
			if (sd._shaderValueWidth!==renderstate2d.width || sd._shaderValueHeight!==renderstate2d.height){
				sd._shaderValueWidth=renderstate2d.width;
				sd._shaderValueHeight=renderstate2d.height;
			}
			else{
				params=(sd._params2dQuick1)|| sd._make2dQuick1();
			}
			sd.upload(this,params);
		}
	}

	__proto.setFilters=function(value){
		this.filters=value;
		if (!value)
			return;
		var n=value.length,f;
		for (var i=0;i < n;i++){
			f=value[i];
			if (f){
				this.defines.add(f.type);
				f.action.setValue(this);
			}
		}
	}

	__proto.clear=function(){
		this.defines.setValue(this.subID);
	}

	__proto.release=function(){
		this._inClassCache[this._inClassCache._length++]=this;
		this.fillStyle=null;
		this.strokeStyle=null;
		this.clear();
	}

	Value2D._initone=function(type,classT){
		Value2D._typeClass[type]=classT;
		Value2D._cache[type]=[];
		Value2D._cache[type]._length=0;
	}

	Value2D.__init__=function(){
		Value2D._POSITION=[2,0x1406,false,4 *CONST3D2D.BYTES_PE,0];
		Value2D._TEXCOORD=[2,0x1406,false,4 *CONST3D2D.BYTES_PE,2 *CONST3D2D.BYTES_PE];
		Value2D._initone(0x02,Color2dSV);
		Value2D._initone(0x04,PrimitiveSV);
		Value2D._initone(0x100,FillTextureSV);
		Value2D._initone(0x200,SkinSV);
		Value2D._initone(0x01,TextureSV);
		Value2D._initone(0x01 | 0x40,TextSV);
		Value2D._initone(0x01 | 0x08,TextureSV);
	}

	Value2D.create=function(mainType,subType){
		var types=Value2D._cache[mainType|subType];
		if (types._length)
			return types[--types._length];
		else
		return new Value2D._typeClass[mainType|subType](subType);
	}

	Value2D._POSITION=null;
	Value2D._TEXCOORD=null;
	Value2D._cache=[];
	Value2D._typeClass=[];
	Value2D.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];
	return Value2D;
})(ShaderValue)


//class laya.webgl.canvas.WebGLContext2D extends laya.resource.Context
var WebGLContext2D=(function(_super){
	var ContextParams;
	function WebGLContext2D(c){
		this._x=0;
		this._y=0;
		this._id=++WebGLContext2D._COUNT;
		//this._other=null;
		this._path=null;
		//this._primitiveValue2D=null;
		this._drawCount=1;
		this._maxNumEle=0;
		this._clear=false;
		this._isMain=false;
		this._atlasResourceChange=0;
		this._submits=null;
		this._curSubmit=null;
		this._ib=null;
		this._vb=null;
		//this._curMat=null;
		this._nBlendType=0;
		//this._save=null;
		//this._targets=null;
		//this._renderKey=NaN;
		this._saveMark=null;
		this._shader2D=null;
		//this._triangleMesh=null;
		//drawTriangles专用mesh。由于ib不固定，所以不能与_mesh通用
		this.meshlist=[];
		/**所cacheAs精灵*/
		//this.sprite=null;
		/*******************************************start矢量绘制***************************************************/
		this.mId=-1;
		this.mHaveKey=false;
		this.mHaveLineKey=false;
		this.mX=0;
		this.mY=0;
		WebGLContext2D.__super.call(this);
		this._width=99999999;
		this._height=99999999;
		this._clipRect=WebGLContext2D.MAXCLIPRECT;
		this.mOutPoint
		this._canvas=c;
		WebGLContext2D._contextcount++;
		if (Render.isFlash){
			this._ib=IndexBuffer2D.create(0x88E4);
			GlUtils.fillIBQuadrangle(this._ib,16);
		}else
		this._ib=IndexBuffer2D.QuadrangleIB;
		this.clear();
	}

	__class(WebGLContext2D,'laya.webgl.canvas.WebGLContext2D',_super);
	var __proto=WebGLContext2D.prototype;
	__proto.setIsMainContext=function(){
		this._isMain=true;
	}

	__proto.clearBG=function(r,g,b,a){
		var gl=WebGL.mainContext;
		gl.clearColor(r,g,b,a);
		gl.clear(0x00004000);
	}

	__proto._getSubmits=function(){
		return this._submits;
	}

	__proto._releaseMem=function(){
		if (!this._submits)
			return;
		this._curMat.destroy();
		this._curMat=null;
		this._shader2D.destroy();
		this._shader2D=null;
		for (var i=0,n=this._submits._length;i < n;i++)
		this._submits[i].releaseRender();
		this._submits.length=0;
		this._submits._length=0;
		this._submits=null;
		this._curSubmit=null;
		this._path && this._path.recover();
		this._path=null;
		this._other && (this._other.font=null);
		this._save=null;
		if (this._vb){
			this._vb.releaseResource();
			this._vb.destroy();
			this._vb.destory();
			this._vb=null;
		}
	}

	__proto.destroy=function(){
		--WebGLContext2D._contextcount;
		this.sprite=null;
		this._releaseMem();
		this._targets && this._targets.destroy();
		this._targets=null;
		this._canvas=null;
		this._ib && (this._ib !=IndexBuffer2D.QuadrangleIB)&& this._ib.releaseResource();
	}

	__proto.clear=function(){
		if (!this._submits){
			this._other=ContextParams.DEFAULT;
			this._curMat=Matrix.create();
			this._vb=VertexBuffer2D.create(-1);
			this._submits=[];
			this._save=[SaveMark.Create(this)];
			this._save.length=10;
			this._shader2D=new Shader2D();
			this._triangleMesh=MeshTexture.getAMesh();
		}
		this._vb.clear();
		this._targets && (this._targets.repaint=true);
		this._other=ContextParams.DEFAULT;
		this._clear=true;
		this._repaint=false;
		this._drawCount=1;
		this._renderKey=0;
		this._other.lineWidth=this._shader2D.ALPHA=1.0;
		this._nBlendType=0;
		this._clipRect=WebGLContext2D.MAXCLIPRECT;
		this._curSubmit=Submit.RENDERBASE;
		this._shader2D.glTexture=null;
		this._shader2D.fillStyle=this._shader2D.strokeStyle=DrawStyle.DEFAULT;
		for (var i=0,n=this._submits._length;i < n;i++)
		this._submits[i].releaseRender();
		this._submits._length=0;
		this._curMat.identity();
		this._other.clear();
		this._saveMark=this._save[0];
		this._save._length=1;
	}

	__proto.size=function(w,h){
		if (this._width !=w || this._height !=h){
			if (w==0 || h==0){
				if (this._vb._byteLength !=0){
					this._width=w;
					this._height=h;
					this._vb.clear();
					this._vb.upload();
				}
				for (var i=0,n=this._submits._length;i < n;i++)
				this._submits[i].releaseRender();
				this._submits.length=0;
				this._submits._length=0;
				this._curSubmit=null;
				this._path && this._path.recover();
				this._path=null;
				this.sprite=null;
				this._targets && (this._targets.destroy());
				this._targets=null;
				}else {
				this._width=w;
				this._height=h;
				this._targets && (this._targets.size(w,h));
				this._canvas.memorySize-=this._canvas.memorySize;
			}
		}
		if (w===0 && h===0)this._releaseMem();
	}

	__proto._getTransformMatrix=function(){
		return this._curMat;
	}

	__proto.translate=function(x,y){
		if (x!==0 || y!==0){
			SaveTranslate.save(this);
			if (this._curMat.bTransform){
				SaveTransform.save(this);
				this._curMat.transformPointN(Point.TEMP.setTo(x,y));
				x=Point.TEMP.x;
				y=Point.TEMP.y;
			}
			this._x+=x;
			this._y+=y;
		}
	}

	__proto.save=function(){
		this._save[this._save._length++]=SaveMark.Create(this);
	}

	__proto.restore=function(){
		var sz=this._save._length;
		if (sz < 1)
			return;
		for (var i=sz-1;i >=0;i--){
			var o=this._save[i];
			o.restore(this);
			if (o.isSaveMark()){
				this._save._length=i;
				return;
			}
		}
	}

	__proto._fillText=function(txt,words,x,y,fontStr,color,strokeColor,lineWidth,textAlign,underLine){
		(underLine===void 0)&& (underLine=0);
		var shader=this._shader2D;
		var curShader=this._curSubmit.shaderValue;
		var font=fontStr ? FontInContext.create(fontStr):this._other.font;
		if (AtlasResourceManager.enabled){
			if (shader.ALPHA!==curShader.ALPHA)
				shader.glTexture=null;
			DrawText.drawText(this,txt,words,this._curMat,font,textAlign || this._other.textAlign,color,strokeColor,lineWidth,x,y,underLine);
			}else {
			var preDef=this._shader2D.defines.getValue();
			var colorAdd=color ? Color$1.create(color)._color :shader.colorAdd;
			if (shader.ALPHA!==curShader.ALPHA || colorAdd!==shader.colorAdd || curShader.colorAdd!==shader.colorAdd){
				shader.glTexture=null;
				shader.colorAdd=colorAdd;
			}
			DrawText.drawText(this,txt,words,this._curMat,font,textAlign || this._other.textAlign,color,strokeColor,lineWidth,x,y,underLine);
		}
	}

	//TODO:实现下划线
	__proto.fillWords=function(words,x,y,fontStr,color,underLine){
		this._fillText(null,words,x,y,fontStr,color,null,-1,null,underLine);
	}

	__proto.fillBorderWords=function(words,x,y,font,color,borderColor,lineWidth){
		this._fillBorderText(null,words,x,y,font,color,borderColor,lineWidth,null);
	}

	__proto.fillText=function(txt,x,y,fontStr,color,textAlign){
		this._fillText(txt,null,x,y,fontStr,color,null,-1,textAlign);
	}

	__proto.strokeText=function(txt,x,y,fontStr,color,lineWidth,textAlign){
		this._fillText(txt,null,x,y,fontStr,null,color,lineWidth || 1,textAlign);
	}

	__proto.fillBorderText=function(txt,x,y,fontStr,fillColor,borderColor,lineWidth,textAlign){
		this._fillBorderText(txt,null,x,y,fontStr,fillColor,borderColor,lineWidth,textAlign);
	}

	__proto._fillBorderText=function(txt,words,x,y,fontStr,fillColor,borderColor,lineWidth,textAlign){
		if (!AtlasResourceManager.enabled){
			this._fillText(txt,words,x,y,fontStr,null,borderColor,lineWidth || 1,textAlign);
			this._fillText(txt,words,x,y,fontStr,fillColor,null,-1,textAlign);
			return;
		};
		var shader=this._shader2D;
		var curShader=this._curSubmit.shaderValue;
		if (shader.ALPHA!==curShader.ALPHA)
			shader.glTexture=null;
		var font=fontStr ? (WebGLContext2D._fontTemp.setFont(fontStr),WebGLContext2D._fontTemp):this._other.font;
		DrawText.drawText(this,txt,words,this._curMat,font,textAlign || this._other.textAlign,fillColor,borderColor,lineWidth || 1,x,y,0);
	}

	__proto.fillRect=function(x,y,width,height,fillStyle){
		var vb=this._vb;
		if (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,width,height,Texture.DEF_UV,this._curMat,this._x,this._y,0,0)){
			this._renderKey=0;
			var pre=this._shader2D.fillStyle;
			fillStyle && (this._shader2D.fillStyle=DrawStyle.create(fillStyle));
			var shader=this._shader2D;
			var curShader=this._curSubmit.shaderValue;
			if (shader.fillStyle!==curShader.fillStyle || shader.ALPHA!==curShader.ALPHA){
				shader.glTexture=null;
				var submit=this._curSubmit=Submit.createSubmit(this,this._ib,vb,((vb._byteLength-16 *4)/ 32)*3,Value2D.create(0x02,0));
				submit.shaderValue.color=shader.fillStyle._color._color;
				submit.shaderValue.ALPHA=shader.ALPHA;
				this._submits[this._submits._length++]=submit;
			}
			this._curSubmit._numEle+=6;
			this._shader2D.fillStyle=pre;
		}
	}

	__proto.fillTexture=function(texture,x,y,width,height,type,offset,other){
		if (!(texture.loaded && texture.bitmap && texture.source)){
			if (this.sprite){
				Laya.timer.callLater(this,this._repaintSprite);
			}
			return;
		};
		var vb=this._vb;
		var w=texture.bitmap.width,h=texture.bitmap.height,uv=texture.uv;
		var ox=offset.x % texture.width,oy=offset.y % texture.height;
		if (w !=other.w || h !=other.h){
			if (!other.w && !other.h){
				other.oy=other.ox=0;
				switch (type){
					case "repeat":
						other.width=width;
						other.height=height;
						break ;
					case "repeat-x":
						other.width=width;
						if (oy < 0){
							if (texture.height+oy > height){
								other.height=height;
								}else {
								other.height=texture.height+oy;
							}
							}else {
							other.oy=oy;
							if (texture.height+oy > height){
								other.height=height-oy;
								}else {
								other.height=texture.height;
							}
						}
						break ;
					case "repeat-y":
						if (ox < 0){
							if (texture.width+ox > width){
								other.width=width;
								}else {
								other.width=texture.width+ox;
							}
							}else {
							other.ox=ox;
							if (texture.width+ox > width){
								other.width=width-ox;
								}else {
								other.width=texture.width;
							}
						}
						other.height=height;
						break ;
					default :
						other.width=width;
						other.height=height;
						break ;
					}
			}
			other.w=w;
			other.h=h;
			other.uv=[0,0,other.width / w,0,other.width / w,other.height / h,0,other.height / h];
		}
		x+=other.ox;
		y+=other.oy;
		ox-=other.ox;
		oy-=other.oy;
		if (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,other.width,other.height,other.uv,this._curMat,this._x,this._y,0,0)){
			this._renderKey=0;
			var submit=SubmitTexture.create(this,this._ib,vb,((vb._byteLength-16 *4)/ 32)*3,Value2D.create(0x100,0));
			this._submits[this._submits._length++]=submit;
			var shaderValue=submit.shaderValue;
			shaderValue.textureHost=texture;
			var tTextureX=uv[0] *w;
			var tTextureY=uv[1] *h;
			var tTextureW=(uv[2]-uv[0])*w;
			var tTextureH=(uv[5]-uv[3])*h;
			var tx=-ox / w;
			var ty=-oy / h;
			shaderValue.u_TexRange[0]=tTextureX / w;
			shaderValue.u_TexRange[1]=tTextureW / w;
			shaderValue.u_TexRange[2]=tTextureY / h;
			shaderValue.u_TexRange[3]=tTextureH / h;
			shaderValue.u_offset[0]=tx;
			shaderValue.u_offset[1]=ty;
			if (AtlasResourceManager.enabled && !this._isMain)
				submit.addTexture(texture,(vb._byteLength >> 2)-16);
			this._curSubmit=submit;
			submit._renderType=10017;
			submit._numEle+=6;
		}
	}

	__proto.setShader=function(shader){
		SaveBase.save(this,0x100000,this._shader2D,true);
		this._shader2D.shader=shader;
	}

	__proto.setFilters=function(value){
		SaveBase.save(this,0x200000,this._shader2D,true);
		this._shader2D.filters=value;
		this._curSubmit=Submit.RENDERBASE;
		this._renderKey=0;
		this._drawCount++;
	}

	__proto.drawTexture=function(tex,x,y,width,height,tx,ty){
		this._drawTextureM(tex,x,y,width,height,tx,ty,null,1);
	}

	__proto.addTextureVb=function(invb,x,y){
		var finalVB=this._curSubmit._vb || this._vb;
		var vpos=(finalVB._byteLength >> 2);
		finalVB.byteLength=((vpos+16)<< 2);
		var vbdata=finalVB.getFloat32Array();
		for (var i=0,ci=0;i < 16;i+=4){
			vbdata[vpos++]=invb[i]+x;
			vbdata[vpos++]=invb[i+1]+y;
			vbdata[vpos++]=invb[i+2];
			vbdata[vpos++]=invb[i+3];
		}
		this._curSubmit._numEle+=6;
		this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);
		finalVB._upload=true;
	}

	__proto.willDrawTexture=function(tex,alpha){
		if (!(tex.loaded && tex.bitmap && tex.source)){
			if (this.sprite){
				Laya.timer.callLater(this,this._repaintSprite);
			}
			return 0;
		};
		var webGLImg=tex.bitmap;
		var rid=webGLImg.id+this._shader2D.ALPHA *alpha+10016;
		if (rid==this._renderKey)return rid;
		var shader=this._shader2D;
		var preAlpha=shader.ALPHA;
		var curShader=this._curSubmit.shaderValue;
		shader.ALPHA *=alpha;
		this._renderKey=rid;
		this._drawCount++;
		shader.glTexture=webGLImg;
		var vb=this._vb;
		var submit=null;
		var vbSize=(vb._byteLength / 32)*3;
		submit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(0x01,0));
		this._submits[this._submits._length++]=submit;
		submit.shaderValue.textureHost=tex;
		submit._renderType=10016;
		submit._preIsSameTextureShader=this._curSubmit._renderType===10016 && shader.ALPHA===curShader.ALPHA;
		this._curSubmit=submit;
		shader.ALPHA=preAlpha;
		return rid;
	}

	__proto.drawTextures=function(tex,pos,tx,ty){
		if (!(tex.loaded && tex.bitmap && tex.source)){
			this.sprite && Laya.timer.callLater(this,this._repaintSprite);
			return;
		};
		var pre=this._clipRect;
		this._clipRect=WebGLContext2D.MAXCLIPRECT;
		if (!this._drawTextureM(tex,pos[0],pos[1],tex.width,tex.height,tx,ty,null,1)){
			alert("drawTextures err");
			return;
		}
		this._clipRect=pre;
		Stat.drawCall++;
		if (pos.length < 4)
			return;
		var finalVB=this._curSubmit._vb || this._vb;
		var sx=this._curMat.a,sy=this._curMat.d;
		for (var i=2,sz=pos.length;i < sz;i+=2){
			GlUtils.copyPreImgVb(finalVB,(pos[i]-pos[i-2])*sx,(pos[i+1]-pos[i-1])*sy);
			this._curSubmit._numEle+=6;
		}
		this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);
	}

	__proto._drawTextureM=function(tex,x,y,width,height,tx,ty,m,alpha){
		if (!(tex.loaded && tex.source)){
			if (this.sprite){
				Laya.timer.callLater(this,this._repaintSprite);
			}
			return false;
		};
		var finalVB=this._curSubmit._vb || this._vb;
		var webGLImg=tex.bitmap;
		x+=tx;
		y+=ty;
		this._drawCount++;
		var rid=webGLImg.id+this._shader2D.ALPHA *alpha+10016;
		if (rid !=this._renderKey){
			this._renderKey=rid;
			var curShader=this._curSubmit.shaderValue;
			var shader=this._shader2D;
			var alphaBack=shader.ALPHA;
			shader.ALPHA *=alpha;
			shader.glTexture=webGLImg;
			var vb=this._vb;
			var submit=null;
			var vbSize=(vb._byteLength / 32)*3;
			submit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(0x01,0));
			this._submits[this._submits._length++]=submit;
			submit.shaderValue.textureHost=tex;
			submit._renderType=10016;
			submit._preIsSameTextureShader=this._curSubmit._renderType===10016 && shader.ALPHA===curShader.ALPHA;
			this._curSubmit=submit;
			finalVB=this._curSubmit._vb || this._vb;
			shader.ALPHA=alphaBack;
		}
		if (GlUtils.fillRectImgVb(finalVB,this._clipRect,x,y,width || tex.width,height || tex.height,tex.uv,m || this._curMat,this._x,this._y,0,0)){
			if (AtlasResourceManager.enabled && !this._isMain)
				(this._curSubmit).addTexture(tex,(finalVB._byteLength >> 2)-16);
			this._curSubmit._numEle+=6;
			this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);
			return true;
		}
		return false;
	}

	__proto._repaintSprite=function(){
		if(this.sprite)
			this.sprite.repaint();
	}

	//}
	__proto._drawText=function(tex,x,y,width,height,m,tx,ty,dx,dy){
		var webGLImg=tex.bitmap;
		this._drawCount++;
		var rid=webGLImg.id+this._shader2D.ALPHA+10016;
		if (rid !=this._renderKey){
			this._renderKey=rid;
			var curShader=this._curSubmit.shaderValue;
			var shader=this._shader2D;
			shader.glTexture=webGLImg;
			var vb=this._vb;
			var submit=null;
			var submitID=NaN;
			var vbSize=(vb._byteLength / 32)*3;
			if (AtlasResourceManager.enabled){
				submit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(0x01,0));
				}else {
				submit=SubmitTexture.create(this,this._ib,vb,vbSize,TextSV.create());
			}
			submit._preIsSameTextureShader=this._curSubmit._renderType===10016 && shader.ALPHA===curShader.ALPHA;
			this._submits[this._submits._length++]=submit;
			submit.shaderValue.textureHost=tex;
			submit._renderType=10016;
			this._curSubmit=submit;
		}
		tex.active();
		var finalVB=this._curSubmit._vb || this._vb;
		if (GlUtils.fillRectImgVb(finalVB,this._clipRect,x+tx,y+ty,width || tex.width,height || tex.height,tex.uv,m || this._curMat,this._x,this._y,dx,dy,true)){
			if (AtlasResourceManager.enabled && !this._isMain){
				(this._curSubmit).addTexture(tex,(finalVB._byteLength >> 2)-16);
			}
			this._curSubmit._numEle+=6;
			this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);
		}
	}

	__proto.drawTextureWithTransform=function(tex,x,y,width,height,transform,tx,ty,alpha){
		if (!transform){
			this._drawTextureM(tex,x,y,width,height,tx,ty,null,alpha);
			return;
		};
		var curMat=this._curMat;
		var prex=this._x;
		var prey=this._y;
		(tx!==0 || ty!==0)&& (this._x=tx *curMat.a+ty *curMat.c,this._y=ty *curMat.d+tx *curMat.b);
		if (transform && curMat.bTransform){
			Matrix.mul(transform,curMat,WebGLContext2D._tmpMatrix);
			transform=WebGLContext2D._tmpMatrix;
			transform._checkTransform();
			}else {
			this._x+=curMat.tx;
			this._y+=curMat.ty;
		}
		this._drawTextureM(tex,x,y,width,height,0,0,transform,alpha);
		this._x=prex;
		this._y=prey;
	}

	__proto.fillQuadrangle=function(tex,x,y,point4,m){
		var submit=this._curSubmit;
		var vb=this._vb;
		var shader=this._shader2D;
		var curShader=submit.shaderValue;
		this._renderKey=0;
		if (tex.bitmap){
			var t_tex=tex.bitmap;
			if (shader.glTexture !=t_tex || shader.ALPHA!==curShader.ALPHA){
				shader.glTexture=t_tex;
				submit=this._curSubmit=Submit.createSubmit(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(0x01,0));
				submit.shaderValue.glTexture=t_tex;
				this._submits[this._submits._length++]=submit;
			}
			GlUtils.fillQuadrangleImgVb(vb,x,y,point4,tex.uv,m || this._curMat,this._x,this._y);
			}else {
			if (!submit.shaderValue.fillStyle || !submit.shaderValue.fillStyle.equal(tex)|| shader.ALPHA!==curShader.ALPHA){
				shader.glTexture=null;
				submit=this._curSubmit=Submit.createSubmit(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(0x02,0));
				submit.shaderValue.defines.add(0x02);
				submit.shaderValue.fillStyle=DrawStyle.create(tex);
				this._submits[this._submits._length++]=submit;
			}
			GlUtils.fillQuadrangleImgVb(vb,x,y,point4,Texture.DEF_UV,m || this._curMat,this._x,this._y);
		}
		submit._numEle+=6;
	}

	__proto.drawTexture2=function(x,y,pivotX,pivotY,transform,alpha,blendMode,args){
		if (alpha==0)return;
		var curMat=this._curMat;
		this._x=x *curMat.a+y *curMat.c;
		this._y=y *curMat.d+x *curMat.b;
		if (transform){
			if (curMat.bTransform || transform.bTransform){
				Matrix.mul(transform,curMat,WebGLContext2D._tmpMatrix);
				transform=WebGLContext2D._tmpMatrix;
				}else {
				this._x+=transform.tx+curMat.tx;
				this._y+=transform.ty+curMat.ty;
				transform=Matrix.EMPTY;
			}
		}
		if (alpha===1 && !blendMode)
			this._drawTextureM(args[0],args[1]-pivotX,args[2]-pivotY,args[3],args[4],0,0,transform,1);
		else {
			var preAlpha=this._shader2D.ALPHA;
			var preblendType=this._nBlendType;
			this._shader2D.ALPHA=alpha;
			blendMode && (this._nBlendType=BlendMode.TOINT(blendMode));
			this._drawTextureM(args[0],args[1]-pivotX,args[2]-pivotY,args[3],args[4],0,0,transform,1);
			this._shader2D.ALPHA=preAlpha;
			this._nBlendType=preblendType;
		}
		this._x=this._y=0;
	}

	__proto.drawCanvas=function(canvas,x,y,width,height){
		var src=canvas.context;
		this._renderKey=0;
		if (src._targets){
			this._submits[this._submits._length++]=SubmitCanvas.create(src,0,null);
			this._curSubmit=Submit.RENDERBASE;
			src._targets.drawTo(this,x,y,width,height);
			}else {
			var submit=this._submits[this._submits._length++]=SubmitCanvas.create(src,this._shader2D.ALPHA,this._shader2D.filters);
			var sx=width / canvas.width;
			var sy=height / canvas.height;
			var mat=submit._matrix;
			this._curMat.copyTo(mat);
			sx !=1 && sy !=1 && mat.scale(sx,sy);
			var tx=mat.tx,ty=mat.ty;
			mat.tx=mat.ty=0;
			mat.transformPoint(Point.TEMP.setTo(x,y));
			mat.translate(Point.TEMP.x+tx,Point.TEMP.y+ty);
			this._curSubmit=Submit.RENDERBASE;
		}
		if (Config.showCanvasMark){
			this.save();
			this.lineWidth=4;
			this.strokeStyle=src._targets ? "yellow" :"green";
			this.strokeRect(x-1,y-1,width+2,height+2,1);
			this.strokeRect(x,y,width,height,1);
			this.restore();
		}
	}

	__proto.drawTarget=function(scope,x,y,width,height,m,proName,shaderValue,uv,blend){
		(blend===void 0)&& (blend=-1);
		var vb=this._vb;
		if (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,width,height,uv || Texture.DEF_UV,m || this._curMat,this._x,this._y,0,0)){
			this._renderKey=0;
			var shader=this._shader2D;
			shader.glTexture=null;
			var curShader=this._curSubmit.shaderValue;
			var submit=this._curSubmit=SubmitTarget.create(this,this._ib,vb,((vb._byteLength-16 *4)/ 32)*3,shaderValue,proName);
			if (blend==-1){
				submit.blendType=this._nBlendType;
				}else {
				submit.blendType=blend;
			}
			submit.scope=scope;
			this._submits[this._submits._length++]=submit;
			this._curSubmit._numEle+=6;
		}
	}

	/**
	*把颜色跟当前设置的alpha混合
	*@return
	*/
	__proto.mixRGBandAlpha=function(color){
		return this._mixRGBandAlpha(color,this._shader2D.ALPHA);
	}

	__proto._mixRGBandAlpha=function(color,alpha){
		var a=((color & 0xff000000)>>> 24);
		if (a !=0){
			a*=alpha;
			}else {
			a=alpha*255;
		}
		return (color & 0x00ffffff)| (a << 24);
	}

	__proto.drawTriangles=function(tex,x,y,vertices,uvs,indices,matrix,alpha,color,blendMode){
		if (!(tex.loaded && tex.source)){
			if (this.sprite){
				Laya.timer.callLater(this,this._repaintSprite);
			}
			return false;
		}
		this._drawCount++;
		var webGLImg=tex.bitmap;
		var rgba=this._mixRGBandAlpha(0xffffffff,alpha);
		var vertNum=vertices.length / 2;
		var eleNum=indices.length;
		this._renderKey=-1;
		var submit=this._curSubmit=SubmitTexture.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,Value2D.create(0x01,0));
		submit.shaderValue.textureHost=tex;
		submit._renderType=10016;
		this._submits[this._submits._length++]=submit;
		if(matrix){
			WebGLContext2D._tmpMatrix.a=matrix.a;WebGLContext2D._tmpMatrix.b=matrix.b;WebGLContext2D._tmpMatrix.c=matrix.c;WebGLContext2D._tmpMatrix.d=matrix.d;WebGLContext2D._tmpMatrix.tx=matrix.tx+x;WebGLContext2D._tmpMatrix.ty=matrix.ty+y;
			Matrix.mul(WebGLContext2D._tmpMatrix,this._curMat,WebGLContext2D._tmpMatrix);
			}else {
			WebGLContext2D._tmpMatrix.a=this._curMat.a;WebGLContext2D._tmpMatrix.b=this._curMat.b;WebGLContext2D._tmpMatrix.c=this._curMat.c;WebGLContext2D._tmpMatrix.d=this._curMat.d;WebGLContext2D._tmpMatrix.tx=this._curMat.tx+x;WebGLContext2D._tmpMatrix.ty=this._curMat.ty+y;
		}
		this._triangleMesh.addData(vertices,uvs,indices,WebGLContext2D._tmpMatrix,rgba,this);
		this._curSubmit._numEle+=eleNum;
		this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);
		return true;
	}

	__proto.transform=function(a,b,c,d,tx,ty){
		SaveTransform.save(this);
		Matrix.mul(Matrix.TEMP.setTo(a,b,c,d,tx,ty),this._curMat,this._curMat);
		this._curMat._checkTransform();
	}

	__proto.setTransformByMatrix=function(value){
		value.copyTo(this._curMat);
	}

	__proto.transformByMatrix=function(value){
		SaveTransform.save(this);
		Matrix.mul(value,this._curMat,this._curMat);
		this._curMat._checkTransform();
	}

	__proto.rotate=function(angle){
		SaveTransform.save(this);
		this._curMat.rotateEx(angle);
	}

	__proto.scale=function(scaleX,scaleY){
		SaveTransform.save(this);
		this._curMat.scaleEx(scaleX,scaleY);
	}

	__proto.clipRect=function(x,y,width,height){
		if (this._curMat.b !=0 || this._curMat.c !=0){
			this._renderKey=0;
			var submitStencil0=SubmitStencil.create(4);
			this.addRenderObject(submitStencil0);
			var vb=this._vb;
			var nPos=(vb._byteLength >> 2);
			if (GlUtils.fillRectImgVb(vb,null,x,y,width,height,Texture.DEF_UV,this._curMat,this._x,this._y,0,0)){
				var shader=this._shader2D;
				shader.glTexture=null;
				var submit=this._curSubmit=Submit.createSubmit(this,this._ib,vb,((vb._byteLength-16 *4)/ 32)*3,Value2D.create(0x02,0));
				submit.shaderValue.ALPHA=1.0;
				this._submits[this._submits._length++]=submit;
				this._curSubmit._numEle+=6;
				}else {
				alert("clipRect calc stencil rect error");
			};
			var submitStencil1=SubmitStencil.create(5);
			this.addRenderObject(submitStencil1);
			var vbdata=vb.getFloat32Array();
			var minx=Math.min(Math.min(Math.min(vbdata[nPos+0],vbdata[nPos+4]),vbdata[nPos+8]),vbdata[nPos+12]);
			var maxx=Math.max(Math.max(Math.max(vbdata[nPos+0],vbdata[nPos+4]),vbdata[nPos+8]),vbdata[nPos+12]);
			var miny=Math.min(Math.min(Math.min(vbdata[nPos+1],vbdata[nPos+5]),vbdata[nPos+9]),vbdata[nPos+13]);
			var maxy=Math.max(Math.max(Math.max(vbdata[nPos+1],vbdata[nPos+5]),vbdata[nPos+9]),vbdata[nPos+13]);
			SaveClipRectStencil.save(this,submitStencil1,x,y,width,height,minx,miny,maxx-minx,maxy-miny);
			this._curSubmit=Submit.RENDERBASE;
			}else {
			width *=this._curMat.a;
			height *=this._curMat.d;
			var p=Point.TEMP;
			this._curMat.transformPoint(p.setTo(x,y));
			if (width < 0){
				p.x=p.x+width;
				width=-width;
			}
			if (height < 0){
				p.y=p.y+height;
				height=-height;
			}
			this._renderKey=0;
			var submitSc=this._curSubmit=SubmitScissor.create(this);
			this._submits[this._submits._length++]=submitSc;
			submitSc.submitIndex=this._submits._length;
			submitSc.submitLength=9999999;
			SaveClipRect.save(this,submitSc);
			var clip=this._clipRect;
			var x1=clip.x,y1=clip.y;
			var r=p.x+width,b=p.y+height;
			x1 < p.x && (clip.x=p.x);
			y1 < p.y && (clip.y=p.y);
			clip.width=Math.min(r,x1+clip.width)-clip.x;
			clip.height=Math.min(b,y1+clip.height)-clip.y;
			this._shader2D.glTexture=null;
			submitSc.clipRect.copyFrom(clip);
			this._curSubmit=Submit.RENDERBASE;
		}
	}

	__proto.setIBVB=function(x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset,type){
		(startIndex===void 0)&& (startIndex=0);
		(offset===void 0)&& (offset=0);
		(type===void 0)&& (type=0);
		if (ib===null){
			if (!Render.isFlash){
				ib=this._ib;
				}else {
				var falshVB=vb;
				(falshVB._selfIB)|| (falshVB._selfIB=IndexBuffer2D.create(0x88E4));
				falshVB._selfIB.clear();
				ib=falshVB._selfIB;
			}
			GlUtils.expandIBQuadrangle(ib,(vb._byteLength / (4 *vb.vertexStride *4)));
		}
		if (!shaderValues || !shader)
			throw Error("setIBVB must input:shader shaderValues");
		var submit=SubmitOtherIBVB.create(this,vb,ib,numElement,shader,shaderValues,startIndex,offset,type);
		mat || (mat=Matrix.EMPTY);
		mat.translate(x,y);
		Matrix.mul(mat,this._curMat,submit._mat);
		mat.translate(-x,-y);
		this._submits[this._submits._length++]=submit;
		this._curSubmit=Submit.RENDERBASE;
		this._renderKey=0;
	}

	__proto.addRenderObject=function(o){
		this._submits[this._submits._length++]=o;
	}

	__proto.fillTrangles=function(tex,x,y,points,m){
		var submit=this._curSubmit;
		var vb=this._vb;
		var shader=this._shader2D;
		var curShader=submit.shaderValue;
		var length=points.length >> 4;
		var t_tex=tex.bitmap;
		this._renderKey=0;
		if (shader.glTexture !=t_tex || shader.ALPHA!==curShader.ALPHA){
			submit=this._curSubmit=Submit.createSubmit(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(0x01,0));
			submit.shaderValue.textureHost=tex;
			this._submits[this._submits._length++]=submit;
		}
		GlUtils.fillTranglesVB(vb,x,y,points,m || this._curMat,this._x,this._y);
		submit._numEle+=length *6;
	}

	__proto.submitElement=function(start,end){
		var renderList=this._submits;
		end < 0 && (end=renderList._length);
		while (start < end){
			start+=renderList[start].renderSubmit();
		}
	}

	__proto.finish=function(){
		WebGL.mainContext.finish();
	}

	__proto.flush=function(){
		var maxNum=Math.max(this._vb._byteLength / (4 *16),this._maxNumEle / 6)+8;
		if (maxNum > (this._ib.bufferLength / (6 *2))){
			GlUtils.expandIBQuadrangle(this._ib,maxNum);
		}
		if (!this._isMain && AtlasResourceManager.enabled && AtlasResourceManager._atlasRestore > this._atlasResourceChange){
			this._atlasResourceChange=AtlasResourceManager._atlasRestore;
			var renderList=this._submits;
			for (var i=0,s=renderList._length;i < s;i++){
				var submit=renderList [i];
				if (submit.getRenderType()===10016)
					(submit).checkTexture();
			}
		}
		this.submitElement(0,this._submits._length);
		this._path && this._path.reset();
		SkinMeshBuffer.instance && SkinMeshBuffer.getInstance().reset();
		var sz=0;
		for (i=0,sz=this.meshlist.length;i < sz;i++){
			var curm=this.meshlist[i];
			curm.canReuse?(curm.releaseMesh()):(curm.destroy());
		}
		this.meshlist.length=0;
		this._curSubmit=Submit.RENDERBASE;
		this._renderKey=0;
		this._triangleMesh=MeshTexture.getAMesh();
		this.meshlist.push(this._triangleMesh);
		return this._submits._length;
	}

	__proto.setPathId=function(id){
		this.mId=id;
		if (this.mId !=-1){
			this.mHaveKey=false;
			var tVGM=VectorGraphManager.getInstance();
			if (tVGM.shapeDic[this.mId]){
				this.mHaveKey=true;
			}
			this.mHaveLineKey=false;
			if (tVGM.shapeLineDic[this.mId]){
				this.mHaveLineKey=true;
			}
		}
	}

	__proto.movePath=function(x,y){
		var _x1=x,_y1=y;
		x=this._curMat.a *_x1+this._curMat.c *_y1+this._curMat.tx;
		y=this._curMat.b *_x1+this._curMat.d *_y1+this._curMat.ty;
		this.mX+=x;
		this.mY+=y;
	}

	__proto.beginPath=function(){
		var tPath=this._getPath();
		tPath.tempArray.length=0;
		tPath.closePath=false;
		this.mX=0;
		this.mY=0;
	}

	__proto.closePath=function(){
		this._path.closePath=true;
	}

	__proto.fill=function(isConvexPolygon){
		(isConvexPolygon===void 0)&& (isConvexPolygon=false);
		var tPath=this._getPath();
		this.drawPoly(0,0,tPath.tempArray,this.fillStyle._color.numColor,0,0,isConvexPolygon);
	}

	__proto.stroke=function(){
		var tPath=this._getPath();
		if (this.lineWidth > 0){
			if (this.mId==-1){
				tPath.drawLine(0,0,tPath.tempArray,this.lineWidth,this.strokeStyle._color.numColor);
				}else {
				if (this.mHaveLineKey){
					var tShapeLine=VectorGraphManager.getInstance().shapeLineDic[this.mId];
					tShapeLine.rebuild(tPath.tempArray);
					tPath.setGeomtry(tShapeLine);
					}else {
					VectorGraphManager.getInstance().addLine(this.mId,tPath.drawLine(0,0,tPath.tempArray,this.lineWidth,this.strokeStyle._color.numColor));
				}
			}
			tPath.update();
			var tPosArray=[this.mX,this.mY];
			var tempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(0x04,0));
			tempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;
			(tempSubmit.shaderValue).u_pos=tPosArray;
			tempSubmit.shaderValue.u_mmat2=RenderState2D.TEMPMAT4_ARRAY;
			this._submits[this._submits._length++]=tempSubmit;
			this._renderKey=-1;
		}
	}

	__proto.line=function(fromX,fromY,toX,toY,lineWidth,mat){
		var submit=this._curSubmit;
		var vb=this._vb;
		if (GlUtils.fillLineVb(vb,this._clipRect,fromX,fromY,toX,toY,lineWidth,mat)){
			this._renderKey=0;
			var shader=this._shader2D;
			var curShader=submit.shaderValue;
			if (shader.strokeStyle!==curShader.strokeStyle || shader.ALPHA!==curShader.ALPHA){
				shader.glTexture=null;
				submit=this._curSubmit=Submit.createSubmit(this,this._ib,vb,((vb._byteLength-16 *4)/ 32)*3,Value2D.create(0x02,0));
				submit.shaderValue.strokeStyle=shader.strokeStyle;
				submit.shaderValue.mainID=0x02;
				submit.shaderValue.ALPHA=shader.ALPHA;
				this._submits[this._submits._length++]=submit;
			}
			submit._numEle+=6;
		}
	}

	__proto.moveTo=function(x,y,b){
		(b===void 0)&& (b=true);
		var tPath=this._getPath();
		if (b){
			var _x1=x,_y1=y;
			x=this._curMat.a *_x1+this._curMat.c *_y1;
			y=this._curMat.b *_x1+this._curMat.d *_y1;
		}
		tPath.addPoint(x,y);
	}

	__proto.lineTo=function(x,y,b){
		(b===void 0)&& (b=true);
		var tPath=this._getPath();
		if (b){
			var _x1=x,_y1=y;
			x=this._curMat.a *_x1+this._curMat.c *_y1;
			y=this._curMat.b *_x1+this._curMat.d *_y1;
		}
		tPath.addPoint(x,y);
	}

	__proto.drawCurves=function(x,y,args){
		this.setPathId(-1);
		this.beginPath();
		this.strokeStyle=args[3];
		this.lineWidth=args[4];
		var points=args[2];
		x+=args[0],y+=args[1];
		this.movePath(x,y);
		this.moveTo(points[0],points[1]);
		var i=2,n=points.length;
		while (i < n){
			this.quadraticCurveTo(points[i++],points[i++],points[i++],points[i++]);
		}
		this.stroke();
	}

	__proto.arcTo=function(x1,y1,x2,y2,r){
		if (this.mId !=-1){
			if (this.mHaveKey){
				return;
			}
		};
		var i=0;
		var x=0,y=0;
		var tPath=this._getPath();
		this._curMat.copyTo(WebGLContext2D._tmpMatrix);
		WebGLContext2D._tmpMatrix.tx=WebGLContext2D._tmpMatrix.ty=0;
		WebGLContext2D._tempPoint.setTo(tPath.getEndPointX(),tPath.getEndPointY());
		WebGLContext2D._tmpMatrix.invertTransformPoint(WebGLContext2D._tempPoint);
		var dx=WebGLContext2D._tempPoint.x-x1;
		var dy=WebGLContext2D._tempPoint.y-y1;
		var len1=Math.sqrt(dx*dx+dy*dy);
		if (len1 <=0.000001){
			return;
		};
		var ndx=dx / len1;
		var ndy=dy / len1;
		var dx2=x2-x1;
		var dy2=y2-y1;
		var len22=dx2*dx2+dy2*dy2;
		var len2=Math.sqrt(len22);
		if (len2 <=0.000001){
			return;
		};
		var ndx2=dx2 / len2;
		var ndy2=dy2 / len2;
		var odx=ndx+ndx2;
		var ody=ndy+ndy2;
		var olen=Math.sqrt(odx*odx+ody*ody);
		if (olen <=0.000001){
			return;
		};
		var nOdx=odx / olen;
		var nOdy=ody / olen;
		var alpha=Math.acos(nOdx*ndx+nOdy*ndy);
		var halfAng=Math.PI / 2-alpha;
		len1=r / Math.tan(halfAng);
		var ptx1=len1*ndx+x1;
		var pty1=len1*ndy+y1;
		var orilen=Math.sqrt(len1*len1+r*r);
		var orix=x1+nOdx*orilen;
		var oriy=y1+nOdy*orilen;
		var ptx2=len1*ndx2+x1;
		var pty2=len1*ndy2+y1;
		var dir=ndx *ndy2-ndy *ndx2;
		var fChgAng=0;
		var sinx=0.0;
		var cosx=0.0;
		if (dir >=0){
			fChgAng=halfAng *2;
			var fda=fChgAng / WebGLContext2D.SEGNUM;
			sinx=Math.sin(fda);
			cosx=Math.cos(fda);
		}
		else {
			fChgAng=-halfAng *2;
			fda=fChgAng / WebGLContext2D.SEGNUM;
			sinx=Math.sin(fda);
			cosx=Math.cos(fda);
		}
		x=this._curMat.a *ptx1+this._curMat.c *pty1;
		y=this._curMat.b *ptx1+this._curMat.d *pty1;
		if (x !=this._path.getEndPointX()|| y !=this._path.getEndPointY()){
			tPath.addPoint(x,y);
		};
		var cvx=ptx1-orix;
		var cvy=pty1-oriy;
		var tx=0.0;
		var ty=0.0;
		for (i=0;i < WebGLContext2D.SEGNUM;i++){
			var cx=cvx*cosx+cvy*sinx;
			var cy=-cvx*sinx+cvy*cosx;
			x=cx+orix;
			y=cy+oriy;
			x1=this._curMat.a *x+this._curMat.c *y;
			y1=this._curMat.b *x+this._curMat.d *y;
			x=x1;
			y=y1;
			if (x !=this._path.getEndPointX()|| y !=this._path.getEndPointY()){
				tPath.addPoint(x,y);
			}
			cvx=cx;
			cvy=cy;
		}
	}

	__proto.arc=function(cx,cy,r,startAngle,endAngle,counterclockwise,b){
		(counterclockwise===void 0)&& (counterclockwise=false);
		(b===void 0)&& (b=true);
		if (this.mId !=-1){
			var tShape=VectorGraphManager.getInstance().shapeDic[this.mId];
			if (tShape){
				if (this.mHaveKey && !tShape.needUpdate(this._curMat))
					return;
			}
			cx=0;
			cy=0;
		};
		var a=0,da=0,hda=0,kappa=0;
		var dx=0,dy=0,x=0,y=0,tanx=0,tany=0;
		var px=0,py=0,ptanx=0,ptany=0;
		var i=0,ndivs=0,nvals=0;
		da=endAngle-startAngle;
		if (!counterclockwise){
			if (Math.abs(da)>=Math.PI *2){
				da=Math.PI *2;
				}else {
				while (da < 0.0){
					da+=Math.PI *2;
				}
			}
			}else {
			if (Math.abs(da)>=Math.PI *2){
				da=-Math.PI *2;
				}else {
				while (da > 0.0){
					da-=Math.PI *2;
				}
			}
		}
		if (r < 101){
			ndivs=Math.max(10,da *r / 5);
			}else if (r < 201){
			ndivs=Math.max(10,da *r / 20);
			}else {
			ndivs=Math.max(10,da *r / 40);
		}
		hda=(da / ndivs)/ 2.0;
		kappa=Math.abs(4 / 3 *(1-Math.cos(hda))/ Math.sin(hda));
		if (counterclockwise)
			kappa=-kappa;
		nvals=0;
		var tPath=this._getPath();
		var _x1=NaN,_y1=NaN;
		for (i=0;i <=ndivs;i++){
			a=startAngle+da *(i / ndivs);
			dx=Math.cos(a);
			dy=Math.sin(a);
			x=cx+dx *r;
			y=cy+dy *r;
			if (b){
				_x1=x,_y1=y;
				x=this._curMat.a *_x1+this._curMat.c *_y1;
				y=this._curMat.b *_x1+this._curMat.d *_y1;
			}
			if (x !=this._path.getEndPointX()|| y !=this._path.getEndPointY()){
				tPath.addPoint(x,y);
			}
		}
		dx=Math.cos(endAngle);
		dy=Math.sin(endAngle);
		x=cx+dx *r;
		y=cy+dy *r;
		if (b){
			_x1=x,_y1=y;
			x=this._curMat.a *_x1+this._curMat.c *_y1;
			y=this._curMat.b *_x1+this._curMat.d *_y1;
		}
		if (x !=this._path.getEndPointX()|| y !=this._path.getEndPointY()){
			tPath.addPoint(x,y);
		}
	}

	__proto.quadraticCurveTo=function(cpx,cpy,x,y){
		var tBezier=Bezier.I;
		var tResultArray=[];
		var _x1=x,_y1=y;
		x=this._curMat.a *_x1+this._curMat.c *_y1;
		y=this._curMat.b *_x1+this._curMat.d *_y1;
		_x1=cpx,_y1=cpy;
		cpx=this._curMat.a *_x1+this._curMat.c *_y1;
		cpy=this._curMat.b *_x1+this._curMat.d *_y1;
		var tArray=tBezier.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),cpx,cpy,x,y],30,2);
		for (var i=0,n=tArray.length / 2;i < n;i++){
			this.lineTo(tArray[i *2],tArray[i *2+1],false);
		}
		this.lineTo(x,y,false);
	}

	__proto.rect=function(x,y,width,height){
		this._other=this._other.make();
		this._other.path || (this._other.path=new Path());
		this._other.path.rect(x,y,width,height);
	}

	__proto.strokeRect=function(x,y,width,height,parameterLineWidth){
		var tW=parameterLineWidth *0.5;
		this.line(x-tW,y,x+width+tW,y,parameterLineWidth,this._curMat);
		this.line(x+width,y,x+width,y+height,parameterLineWidth,this._curMat);
		this.line(x,y,x,y+height,parameterLineWidth,this._curMat);
		this.line(x-tW,y+height,x+width+tW,y+height,parameterLineWidth,this._curMat);
	}

	__proto.clip=function(){}
	/**
	*画多边形(用)
	*@param x
	*@param y
	*@param points
	*/
	__proto.drawPoly=function(x,y,points,color,lineWidth,boderColor,isConvexPolygon){
		(isConvexPolygon===void 0)&& (isConvexPolygon=false);
		this._renderKey=0;
		this._shader2D.glTexture=null;
		var tPath=this._getPath();
		if (this.mId==-1){
			tPath.polygon(x,y,points,color,lineWidth ? lineWidth :1,boderColor)
			}else {
			if (this.mHaveKey){
				var tShape=VectorGraphManager.getInstance().shapeDic[this.mId];
				tShape.setMatrix(this._curMat);
				tShape.rebuild(tPath.tempArray);
				tPath.setGeomtry(tShape);
				}else {
				var t=tPath.polygon(x,y,points,color,lineWidth ? lineWidth :1,boderColor);
				VectorGraphManager.getInstance().addShape(this.mId,t);
				t.setMatrix(this._curMat);
			}
		}
		tPath.update();
		var tPosArray=[this.mX,this.mY];
		var tempSubmit;
		tempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(0x04,0));
		tempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;
		(tempSubmit.shaderValue).u_pos=tPosArray;
		tempSubmit.shaderValue.u_mmat2=RenderState2D.EMPTYMAT4_ARRAY;
		this._submits[this._submits._length++]=tempSubmit;
		if (lineWidth > 0){
			if (this.mHaveLineKey){
				var tShapeLine=VectorGraphManager.getInstance().shapeLineDic[this.mId];
				tShapeLine.rebuild(tPath.tempArray);
				tPath.setGeomtry(tShapeLine);
				}else {
				VectorGraphManager.getInstance().addShape(this.mId,tPath.drawLine(x,y,points,lineWidth,boderColor));
			}
			tPath.update();
			tempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(0x04,0));
			tempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;
			tempSubmit.shaderValue.u_mmat2=RenderState2D.EMPTYMAT4_ARRAY;
			this._submits[this._submits._length++]=tempSubmit;
		}
	}

	/*******************************************end矢量绘制***************************************************/
	__proto.drawParticle=function(x,y,pt){
		pt.x=x;
		pt.y=y;
		this._submits[this._submits._length++]=pt;
	}

	__proto._getPath=function(){
		return this._path || (this._path=new Path());
	}

	/*,_shader2D.ALPHA=1*/
	__getset(0,__proto,'globalCompositeOperation',function(){
		return BlendMode.NAMES[this._nBlendType];
		},function(value){
		var n=BlendMode.TOINT[value];
		n==null || (this._nBlendType===n)|| (SaveBase.save(this,0x10000,this,true),this._curSubmit=Submit.RENDERBASE,this._renderKey=0,this._nBlendType=n);
	});

	__getset(0,__proto,'strokeStyle',function(){
		return this._shader2D.strokeStyle;
		},function(value){
		this._shader2D.strokeStyle.equal(value)|| (SaveBase.save(this,0x200,this._shader2D,false),this._shader2D.strokeStyle=DrawStyle.create(value));
	});

	__getset(0,__proto,'globalAlpha',function(){
		return this._shader2D.ALPHA;
		},function(value){
		value=Math.floor(value *1000)/ 1000;
		if (value !=this._shader2D.ALPHA){
			SaveBase.save(this,0x1,this._shader2D,true);
			this._shader2D.ALPHA=value;
		}
	});

	__getset(0,__proto,'asBitmap',null,function(value){
		if (value){
			this._targets || (this._targets=new RenderTargetMAX());
			this._targets.repaint=true;
			if (!this._width || !this._height)
				throw Error("asBitmap no size!");
			this._targets.setSP(this.sprite);
			this._targets.size(this._width,this._height);
		}else
		this._targets=null;
	});

	__getset(0,__proto,'fillStyle',function(){
		return this._shader2D.fillStyle;
		},function(value){
		this._shader2D.fillStyle.equal(value)|| (SaveBase.save(this,0x2,this._shader2D,false),this._shader2D.fillStyle=DrawStyle.create(value));
	});

	__getset(0,__proto,'textAlign',function(){
		return this._other.textAlign;
		},function(value){
		(this._other.textAlign===value)|| (this._other=this._other.make(),SaveBase.save(this,0x8000,this._other,false),this._other.textAlign=value);
	});

	__getset(0,__proto,'lineWidth',function(){
		return this._other.lineWidth;
		},function(value){
		(this._other.lineWidth===value)|| (this._other=this._other.make(),SaveBase.save(this,0x100,this._other,false),this._other.lineWidth=value);
	});

	__getset(0,__proto,'textBaseline',function(){
		return this._other.textBaseline;
		},function(value){
		(this._other.textBaseline===value)|| (this._other=this._other.make(),SaveBase.save(this,0x4000,this._other,false),this._other.textBaseline=value);
	});

	__getset(0,__proto,'font',null,function(str){
		if (str==this._other.font.toString())
			return;
		this._other=this._other.make();
		SaveBase.save(this,0x8,this._other,false);
		this._other.font===FontInContext.EMPTY ? (this._other.font=new FontInContext(str)):(this._other.font.setFont(str));
	});

	WebGLContext2D.__init__=function(){
		ContextParams.DEFAULT=new ContextParams();
	}

	WebGLContext2D._tempPoint=new Point();
	WebGLContext2D._SUBMITVBSIZE=32000;
	WebGLContext2D._MAXSIZE=99999999;
	WebGLContext2D._RECTVBSIZE=16;
	WebGLContext2D.MAXCLIPRECT=new Rectangle(0,0,99999999,99999999);
	WebGLContext2D._COUNT=0;
	WebGLContext2D._tmpMatrix=new Matrix();
	WebGLContext2D.SEGNUM=32;
	WebGLContext2D._contextcount=0;
	__static(WebGLContext2D,
	['_fontTemp',function(){return this._fontTemp=new FontInContext();},'_drawStyleTemp',function(){return this._drawStyleTemp=new DrawStyle(null);}
	]);
	WebGLContext2D.__init$=function(){
		//class ContextParams
		ContextParams=(function(){
			function ContextParams(){
				this.lineWidth=1;
				this.path=null;
				this.textAlign=null;
				this.textBaseline=null;
				this.font=FontInContext.EMPTY;
			}
			__class(ContextParams,'');
			var __proto=ContextParams.prototype;
			__proto.clear=function(){
				this.lineWidth=1;
				this.path && this.path.clear();
				this.textAlign=this.textBaseline=null;
				this.font=FontInContext.EMPTY;
			}
			__proto.make=function(){
				return this===ContextParams.DEFAULT ? new ContextParams():this;
			}
			ContextParams.DEFAULT=null;
			return ContextParams;
		})()
	}

	return WebGLContext2D;
})(Context)


//class laya.webgl.utils.RenderSprite3D extends laya.renders.RenderSprite
var RenderSprite3D=(function(_super){
	function RenderSprite3D(type,next){
		RenderSprite3D.__super.call(this,type,next);
	}

	__class(RenderSprite3D,'laya.webgl.utils.RenderSprite3D',_super);
	var __proto=RenderSprite3D.prototype;
	__proto.onCreate=function(type){
		switch (type){
			case 0x08:
				this._fun=this._blend;
				return;
			case 0x04:
				this._fun=this._transform;
				return;
			}
	}

	__proto._mask=function(sprite,context,x,y){
		var next=this._next;
		var mask=sprite.mask;
		var submitCMD;
		var submitStencil;
		if (mask){
			context.ctx.save();
			var preBlendMode=(context.ctx).globalCompositeOperation;
			var tRect=new Rectangle();
			tRect.copyFrom(mask.getBounds());
			tRect.width=Math.round(tRect.width);
			tRect.height=Math.round(tRect.height);
			tRect.x=Math.round(tRect.x);
			tRect.y=Math.round(tRect.y);
			if (tRect.width > 0 && tRect.height > 0){
				var tf=sprite._style._tf;
				var scope=SubmitCMDScope.create();
				scope.addValue("bounds",tRect);
				submitCMD=SubmitCMD.create([scope,context],laya.webgl.utils.RenderSprite3D.tmpTarget);
				context.addRenderObject(submitCMD);
				mask.render(context,-tRect.x,-tRect.y);
				submitCMD=SubmitCMD.create([scope],laya.webgl.utils.RenderSprite3D.endTmpTarget);
				context.addRenderObject(submitCMD);
				context.ctx.save();
				context.clipRect(x-tf.translateX+tRect.x,y-tf.translateY+tRect.y,tRect.width,tRect.height);
				next._fun.call(next,sprite,context,x,y);
				context.ctx.restore();
				submitStencil=SubmitStencil.create(6);
				preBlendMode=(context.ctx).globalCompositeOperation;
				submitStencil.blendMode="mask";
				context.addRenderObject(submitStencil);
				Matrix.TEMP.identity();
				var shaderValue=Value2D.create(0x01,0);
				var uv=Texture.INV_UV;
				var w=tRect.width;
				var h=tRect.height;
				var tempLimit=32;
				if (tRect.width < tempLimit || tRect.height < tempLimit){
					uv=RenderSprite3D.tempUV;
					uv[0]=0;
					uv[1]=0;
					uv[2]=(tRect.width >=32)? 1 :tRect.width/tempLimit;
					uv[3]=0
					uv[4]=(tRect.width >=32)? 1 :tRect.width/tempLimit;
					uv[5]=(tRect.height >=32)? 1 :tRect.height/tempLimit;
					uv[6]=0;
					uv[7]=(tRect.height >=32)? 1 :tRect.height/tempLimit;
					tRect.width=(tRect.width >=32)? tRect.width :tempLimit;
					tRect.height=(tRect.height >=32)? tRect.height :tempLimit;
					uv[1] *=-1;uv[3] *=-1;uv[5] *=-1;uv[7] *=-1;
					uv[1]+=1;uv[3]+=1;uv[5]+=1;uv[7]+=1;
				}
				(context.ctx).drawTarget(scope,x+tRect.x-tf.translateX,y+tRect.y-tf.translateY,w,h,Matrix.TEMP,"tmpTarget",shaderValue,uv,6);
				submitCMD=SubmitCMD.create([scope],laya.webgl.utils.RenderSprite3D.recycleTarget);
				context.addRenderObject(submitCMD);
				submitStencil=SubmitStencil.create(6);
				submitStencil.blendMode=preBlendMode;
				context.addRenderObject(submitStencil);
			}
			context.ctx.restore();
		}
		else{
			next._fun.call(next,sprite,context,x,y);
		}
	}

	__proto._blend=function(sprite,context,x,y){
		var style=sprite._style;
		var next=this._next;
		if (style.blendMode){
			context.ctx.save();
			context.ctx.globalCompositeOperation=style.blendMode;
			next._fun.call(next,sprite,context,x,y);
			context.ctx.restore();
		}
		else{
			next._fun.call(next,sprite,context,x,y);
		}
	}

	__proto._transform=function(sprite,context,x,y){
		var transform=sprite.transform,_next=this._next;
		if (transform && _next !=RenderSprite.NORENDER){
			var ctx=context.ctx;
			var style=sprite._style;
			transform.tx=x;
			transform.ty=y;
			var m2=ctx._getTransformMatrix();
			var m1=m2.clone();
			Matrix.mul(transform,m2,m2);
			m2._checkTransform();
			transform.tx=transform.ty=0;
			_next._fun.call(_next,sprite,context,0,0);
			m1.copyTo(m2);
			m1.destroy();
			}else {
			_next._fun.call(_next,sprite,context,x,y);
		}
	}

	RenderSprite3D.tmpTarget=function(scope,context){
		var b=scope.getValue("bounds");
		var tmpTarget=RenderTarget2D.create(b.width,b.height);
		tmpTarget.start();
		tmpTarget.clear(0,0,0,0);
		scope.addValue("tmpTarget",tmpTarget);
	}

	RenderSprite3D.endTmpTarget=function(scope){
		var tmpTarget=scope.getValue("tmpTarget");
		tmpTarget.end();
	}

	RenderSprite3D.recycleTarget=function(scope){
		var tmpTarget=scope.getValue("tmpTarget");
		tmpTarget.recycle();
		scope.recycle();
	}

	__static(RenderSprite3D,
	['tempUV',function(){return this.tempUV=new Array(8);}
	]);
	return RenderSprite3D;
})(RenderSprite)


//class laya.webgl.atlas.Atlaser extends laya.webgl.atlas.AtlasGrid
var Atlaser=(function(_super){
	function Atlaser(gridNumX,gridNumY,width,height,atlasID){
		this._atlasCanvas=null;
		this._inAtlasTextureKey=null;
		this._inAtlasTextureBitmapValue=null;
		this._inAtlasTextureOriUVValue=null;
		this._InAtlasWebGLImagesKey=null;
		this._InAtlasWebGLImagesOffsetValue=null;
		Atlaser.__super.call(this,gridNumX,gridNumY,atlasID);
		this._inAtlasTextureKey=[];
		this._inAtlasTextureBitmapValue=[];
		this._inAtlasTextureOriUVValue=[];
		this._InAtlasWebGLImagesKey={};
		this._InAtlasWebGLImagesOffsetValue=[];
		this._atlasCanvas=new AtlasWebGLCanvas();
		this._atlasCanvas._atlaser=this;
		this._atlasCanvas.width=width;
		this._atlasCanvas.height=height;
		this._atlasCanvas.activeResource();
		this._atlasCanvas.lock=true;
	}

	__class(Atlaser,'laya.webgl.atlas.Atlaser',_super);
	var __proto=Atlaser.prototype;
	__proto.computeUVinAtlasTexture=function(texture,oriUV,offsetX,offsetY){
		var tex=texture;
		var _width=AtlasResourceManager.atlasTextureWidth;
		var _height=AtlasResourceManager.atlasTextureHeight;
		var u1=offsetX / _width,v1=offsetY / _height,u2=(offsetX+texture.bitmap.width)/ _width,v2=(offsetY+texture.bitmap.height)/ _height;
		var inAltasUVWidth=texture.bitmap.width / _width,inAltasUVHeight=texture.bitmap.height / _height;
		texture.uv=[u1+oriUV[0] *inAltasUVWidth,v1+oriUV[1] *inAltasUVHeight,u2-(1-oriUV[2])*inAltasUVWidth,v1+oriUV[3] *inAltasUVHeight,u2-(1-oriUV[4])*inAltasUVWidth,v2-(1-oriUV[5])*inAltasUVHeight,u1+oriUV[6] *inAltasUVWidth,v2-(1-oriUV[7])*inAltasUVHeight];
	}

	__proto.findBitmapIsExist=function(bitmap){
		if ((bitmap instanceof laya.webgl.resource.WebGLImage )){
			var webImage=bitmap;
			var sUrl=webImage.url;
			var object=this._InAtlasWebGLImagesKey[sUrl?sUrl:webImage.id]
			if (object){
				return object.offsetInfoID;
			}
		}
		return-1;
	}

	/**
	*
	*@param inAtlasRes
	*@return 是否已经存在队列中
	*/
	__proto.addToAtlasTexture=function(mergeAtlasBitmap,offsetX,offsetY){
		if ((mergeAtlasBitmap instanceof laya.webgl.resource.WebGLImage )){
			var webImage=mergeAtlasBitmap;
			var sUrl=webImage.url;
			this._InAtlasWebGLImagesKey[sUrl?sUrl:webImage.id]={bitmap:mergeAtlasBitmap,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length};
			this._InAtlasWebGLImagesOffsetValue.push([offsetX,offsetY]);
		}
		this._atlasCanvas.texSubImage2D(offsetX,offsetY,mergeAtlasBitmap.atlasSource);
		mergeAtlasBitmap.clearAtlasSource();
	}

	__proto.addToAtlas=function(texture,offsetX,offsetY){
		texture._atlasID=this._inAtlasTextureKey.length;
		var oriUV=texture.uv.slice();
		var oriBitmap=texture.bitmap;
		this._inAtlasTextureKey.push(texture);
		this._inAtlasTextureOriUVValue.push(oriUV);
		this._inAtlasTextureBitmapValue.push(oriBitmap);
		this.computeUVinAtlasTexture(texture,oriUV,offsetX,offsetY);
		texture.bitmap=this._atlasCanvas;
	}

	__proto.clear=function(){
		for (var i=0,n=this._inAtlasTextureKey.length;i < n;i++){
			this._inAtlasTextureKey[i].bitmap=this._inAtlasTextureBitmapValue[i];
			this._inAtlasTextureKey[i].uv=this._inAtlasTextureOriUVValue[i];
			this._inAtlasTextureKey[i]._atlasID=-1;
			this._inAtlasTextureKey[i].bitmap.lock=false;
			this._inAtlasTextureKey[i].bitmap.releaseResource();
		}
		this._inAtlasTextureKey.length=0;
		this._inAtlasTextureBitmapValue.length=0;
		this._inAtlasTextureOriUVValue.length=0;
		this._InAtlasWebGLImagesKey=null;
		this._InAtlasWebGLImagesOffsetValue.length=0;
	}

	__proto.dispose=function(){
		this.clear();
		this._atlasCanvas.destroy();
	}

	__getset(0,__proto,'InAtlasWebGLImagesOffsetValue',function(){
		return this._InAtlasWebGLImagesOffsetValue;
	});

	__getset(0,__proto,'texture',function(){
		return this._atlasCanvas;
	});

	__getset(0,__proto,'inAtlasWebGLImagesKey',function(){
		return this._InAtlasWebGLImagesKey;
	});

	return Atlaser;
})(AtlasGrid)


//class laya.webgl.shader.d2.ShaderDefines2D extends laya.webgl.shader.ShaderDefines
var ShaderDefines2D=(function(_super){
	function ShaderDefines2D(){
		ShaderDefines2D.__super.call(this,ShaderDefines2D.__name2int,ShaderDefines2D.__int2name,ShaderDefines2D.__int2nameMap);
	}

	__class(ShaderDefines2D,'laya.webgl.shader.d2.ShaderDefines2D',_super);
	ShaderDefines2D.__init__=function(){
		ShaderDefines2D.reg("TEXTURE2D",0x01);
		ShaderDefines2D.reg("COLOR2D",0x02);
		ShaderDefines2D.reg("PRIMITIVE",0x04);
		ShaderDefines2D.reg("GLOW_FILTER",0x08);
		ShaderDefines2D.reg("BLUR_FILTER",0x10);
		ShaderDefines2D.reg("COLOR_FILTER",0x20);
		ShaderDefines2D.reg("COLOR_ADD",0x40);
		ShaderDefines2D.reg("WORLDMAT",0x80);
		ShaderDefines2D.reg("FILLTEXTURE",0x100);
		ShaderDefines2D.reg("FSHIGHPRECISION",0x400);
	}

	ShaderDefines2D.reg=function(name,value){
		ShaderDefines$1._reg(name,value,ShaderDefines2D.__name2int,ShaderDefines2D.__int2name);
	}

	ShaderDefines2D.toText=function(value,int2name,int2nameMap){
		return ShaderDefines$1._toText(value,int2name,int2nameMap);
	}

	ShaderDefines2D.toInt=function(names){
		return ShaderDefines$1._toInt(names,ShaderDefines2D.__name2int);
	}

	ShaderDefines2D.TEXTURE2D=0x01;
	ShaderDefines2D.COLOR2D=0x02;
	ShaderDefines2D.PRIMITIVE=0x04;
	ShaderDefines2D.FILTERGLOW=0x08;
	ShaderDefines2D.FILTERBLUR=0x10;
	ShaderDefines2D.FILTERCOLOR=0x20;
	ShaderDefines2D.COLORADD=0x40;
	ShaderDefines2D.WORLDMAT=0x80;
	ShaderDefines2D.FILLTEXTURE=0x100;
	ShaderDefines2D.SKINMESH=0x200;
	ShaderDefines2D.SHADERDEFINE_FSHIGHPRECISION=0x400;
	ShaderDefines2D.__name2int={};
	ShaderDefines2D.__int2name=[];
	ShaderDefines2D.__int2nameMap=[];
	return ShaderDefines2D;
})(ShaderDefines$1)


//class laya.webgl.shapes.Line extends laya.webgl.shapes.BasePoly
var Line=(function(_super){
	function Line(x,y,points,borderWidth,color){
		this._points=[];
		this.rebuild(points);
		Line.__super.call(this,x,y,0,0,0,color,borderWidth,color,0);
	}

	__class(Line,'laya.webgl.shapes.Line',_super);
	var __proto=Line.prototype;
	__proto.rebuild=function(points){
		var len=points.length;
		var preLen=this._points.length;
		if (len !=preLen){
			this.mUint16Array=new Uint16Array((len/2-1)*6);
			this.mFloat32Array=new Float32Array(len*5);
		}
		this._points.length=0;
		var tCurrX=NaN;
		var tCurrY=NaN;
		var tLastX=-1;
		var tLastY=-1;
		var tLen=points.length / 2;
		for (var i=0;i < tLen;i++){
			tCurrX=points[i *2];
			tCurrY=points[i *2+1];
			if (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)>0.01){
				this._points.push(tCurrX,tCurrY);
			}
			tLastX=tCurrX;
			tLastY=tCurrY;
		}
	}

	__proto.getData=function(ib,vb,start){
		var indices=[];
		var verts=[];
		(this.borderWidth > 0)&& this.createLine2(this._points,indices,this.borderWidth,start,verts,this._points.length / 2);
		this.mUint16Array.set(indices,0);
		this.mFloat32Array.set(verts,0);
		ib.append(this.mUint16Array);
		vb.append(this.mFloat32Array);
	}

	return Line;
})(BasePoly)


//class laya.webgl.shapes.LoopLine extends laya.webgl.shapes.BasePoly
var LoopLine=(function(_super){
	function LoopLine(x,y,points,width,color){
		this._points=[];
		var tCurrX=NaN;
		var tCurrY=NaN;
		var tLastX=-1;
		var tLastY=-1;
		var tLen=points.length / 2-1;
		for (var i=0;i < tLen;i++){
			tCurrX=points[i *2];
			tCurrY=points[i *2+1];
			if (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)> 0.01){
				this._points.push(tCurrX,tCurrY);
			}
			tLastX=tCurrX;
			tLastY=tCurrY;
		}
		tCurrX=points[tLen *2];
		tCurrY=points[tLen *2+1];
		tLastX=this._points[0];
		tLastY=this._points[1];
		if (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)> 0.01){
			this._points.push(tCurrX,tCurrY);
		}
		LoopLine.__super.call(this,x,y,0,0,this._points.length / 2,0,width,color);
	}

	__class(LoopLine,'laya.webgl.shapes.LoopLine',_super);
	var __proto=LoopLine.prototype;
	__proto.getData=function(ib,vb,start){
		if (this.borderWidth > 0){
			var color=this.color;
			var r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;
			var verts=[];
			var tLastX=-1,tLastY=-1;
			var tCurrX=0,tCurrY=0;
			var indices=[];
			var tLen=Math.floor(this._points.length / 2);
			for (var i=0;i < tLen;i++){
				tCurrX=this._points[i *2];
				tCurrY=this._points[i *2+1];
				verts.push(this.x+tCurrX,this.y+tCurrY,r,g,b);
			}
			this.createLoopLine(verts,indices,this.borderWidth,start+verts.length / 5);
			ib.append(new Uint16Array(indices));
			vb.append(new Float32Array(verts));
		}
	}

	__proto.createLoopLine=function(p,indices,lineWidth,len,outVertex,outIndex){
		var tLen=p.length / 5;
		var points=p.concat();
		var result=outVertex ? outVertex :p;
		var color=this.borderColor;
		var r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;
		var firstPoint=[points[0],points[1]];
		var lastPoint=[points[points.length-5],points[points.length-4]];
		var midPointX=lastPoint[0]+(firstPoint[0]-lastPoint[0])*0.5;
		var midPointY=lastPoint[1]+(firstPoint[1]-lastPoint[1])*0.5;
		points.unshift(midPointX,midPointY,0,0,0);
		points.push(midPointX,midPointY,0,0,0);
		var length=points.length / 5;
		var iStart=len,w=lineWidth / 2;
		var px,py,p1x,p1y,p2x,p2y,p3x,p3y;
		var perpx,perpy,perp2x,perp2y,perp3x,perp3y;
		var a1,b1,c1,a2,b2,c2;
		var denom,pdist,dist;
		p1x=points[0];
		p1y=points[1];
		p2x=points[5];
		p2y=points[6];
		perpx=-(p1y-p2y);
		perpy=p1x-p2x;
		dist=Math.sqrt(perpx *perpx+perpy *perpy);
		perpx=perpx / dist *w;
		perpy=perpy / dist *w;
		result.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);
		for (var i=1;i < length-1;i++){
			p1x=points[(i-1)*5];
			p1y=points[(i-1)*5+1];
			p2x=points[(i)*5];
			p2y=points[(i)*5+1];
			p3x=points[(i+1)*5];
			p3y=points[(i+1)*5+1];
			perpx=-(p1y-p2y);
			perpy=p1x-p2x;
			dist=Math.sqrt(perpx *perpx+perpy *perpy);
			perpx=perpx / dist *w;
			perpy=perpy / dist *w;
			perp2x=-(p2y-p3y);
			perp2y=p2x-p3x;
			dist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);
			perp2x=perp2x / dist *w;
			perp2y=perp2y / dist *w;
			a1=(-perpy+p1y)-(-perpy+p2y);
			b1=(-perpx+p2x)-(-perpx+p1x);
			c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);
			a2=(-perp2y+p3y)-(-perp2y+p2y);
			b2=(-perp2x+p2x)-(-perp2x+p3x);
			c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);
			denom=a1 *b2-a2 *b1;
			if (Math.abs(denom)< 0.1){
				denom+=10.1;
				result.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);
				continue ;
			}
			px=(b1 *c2-b2 *c1)/ denom;
			py=(a2 *c1-a1 *c2)/ denom;
			pdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);
			result.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);
		}
		if (outIndex){
			indices=outIndex;
		};
		var groupLen=this.edges+1;
		for (i=1;i < groupLen;i++){
			indices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);
		}
		indices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+1,iStart+1,iStart,iStart+(i-1)*2);
		return result;
	}

	return LoopLine;
})(BasePoly)


//class laya.webgl.shapes.Polygon extends laya.webgl.shapes.BasePoly
var Polygon=(function(_super){
	function Polygon(x,y,points,color,borderWidth,borderColor){
		this._points=null;
		this._start=-1;
		this._repaint=false;
		this.earcutTriangles=null;
		this._mat=Matrix.create();
		this._points=points.slice(0,points.length);
		Polygon.__super.call(this,x,y,0,0,this._points.length / 2,color,borderWidth,borderColor);
	}

	__class(Polygon,'laya.webgl.shapes.Polygon',_super);
	var __proto=Polygon.prototype;
	__proto.rebuild=function(point){
		if (!this._repaint){
			this._points.length=0;
			this._points=this._points.concat(point);
		}
	}

	__proto.setMatrix=function(mat){
		mat.copyTo(this._mat);
	}

	__proto.needUpdate=function(mat){
		this._repaint=(this._mat.a==mat.a && this._mat.b==mat.b && this._mat.c==mat.c && this._mat.d==mat.d && this._mat.tx==mat.tx && this._mat.ty==mat.ty);
		return !this._repaint;
	}

	__proto.getData=function(ib,vb,start){
		var indices,i=0;
		var tArray=this._points;
		var tLen=0;
		if (this.mUint16Array && this.mFloat32Array&&this._repaint){
			if (this._start !=start){
				this._start=start;
				indices=[];
				tLen=this.earcutTriangles.length;
				for (i=0;i < tLen;i++){
					indices.push(this.earcutTriangles[i]+start);
				}
				this.mUint16Array=new Uint16Array(indices);
			}
		}
		else {
			this._start=start;
			indices=[];
			var verts=[];
			var vertsEarcut=[];
			var color=this.color;
			var r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;
			tLen=Math.floor(tArray.length / 2);
			for (i=0;i < tLen;i++){
				verts.push(this.x+tArray[i *2],this.y+tArray[i *2+1],r,g,b);
				vertsEarcut.push(this.x+tArray[i *2],this.y+tArray[i *2+1]);
			}
			this.earcutTriangles=Earcut.earcut(vertsEarcut,null,2);
			tLen=this.earcutTriangles.length;
			for (i=0;i < tLen;i++){
				indices.push(this.earcutTriangles[i]+start);
			}
			this.mUint16Array=new Uint16Array(indices);
			this.mFloat32Array=new Float32Array(verts);
		}
		ib.append(this.mUint16Array);
		vb.append(this.mFloat32Array);
	}

	return Polygon;
})(BasePoly)


//class laya.webgl.submit.SubmitCanvas extends laya.webgl.submit.Submit
var SubmitCanvas=(function(_super){
	function SubmitCanvas(){
		//this._ctx_src=null;
		this._matrix=new Matrix();
		this._matrix4=CONST3D2D.defaultMatrix4.concat();
		SubmitCanvas.__super.call(this,10000);
		this.shaderValue=new Value2D(0,0);
	}

	__class(SubmitCanvas,'laya.webgl.submit.SubmitCanvas',_super);
	var __proto=SubmitCanvas.prototype;
	__proto.renderSubmit=function(){
		if (this._ctx_src._targets){
			this._ctx_src._targets.flush(this._ctx_src);
			return 1;
		};
		var preAlpha=RenderState2D.worldAlpha;
		var preMatrix4=RenderState2D.worldMatrix4;
		var preMatrix=RenderState2D.worldMatrix;
		var preFilters=RenderState2D.worldFilters;
		var preWorldShaderDefines=RenderState2D.worldShaderDefines;
		var v=this.shaderValue;
		var m=this._matrix;
		var m4=this._matrix4;
		var mout=Matrix.TEMP;
		Matrix.mul(m,preMatrix,mout);
		m4[0]=mout.a;
		m4[1]=mout.b;
		m4[4]=mout.c;
		m4[5]=mout.d;
		m4[12]=mout.tx;
		m4[13]=mout.ty;
		RenderState2D.worldMatrix=mout.clone();
		RenderState2D.worldMatrix4=m4;
		RenderState2D.worldAlpha=RenderState2D.worldAlpha *v.alpha;
		if (v.filters && v.filters.length){
			RenderState2D.worldFilters=v.filters;
			RenderState2D.worldShaderDefines=v.defines;
		}
		this._ctx_src.flush();
		RenderState2D.worldAlpha=preAlpha;
		RenderState2D.worldMatrix4=preMatrix4;
		RenderState2D.worldMatrix.destroy();
		RenderState2D.worldMatrix=preMatrix;
		RenderState2D.worldFilters=preFilters;
		RenderState2D.worldShaderDefines=preWorldShaderDefines;
		return 1;
	}

	__proto.releaseRender=function(){
		var cache=SubmitCanvas._cache;
		this._ctx_src=null;
		cache[cache._length++]=this;
	}

	__proto.getRenderType=function(){
		return 10003;
	}

	SubmitCanvas.create=function(ctx_src,alpha,filters){
		var o=(!SubmitCanvas._cache._length)? (new SubmitCanvas()):SubmitCanvas._cache[--SubmitCanvas._cache._length];
		o._ctx_src=ctx_src;
		var v=o.shaderValue;
		v.alpha=alpha;
		v.defines.setValue(0);
		filters && filters.length && v.setFilters(filters);
		return o;
	}

	SubmitCanvas._cache=(SubmitCanvas._cache=[],SubmitCanvas._cache._length=0,SubmitCanvas._cache);
	return SubmitCanvas;
})(Submit)


//class laya.webgl.submit.SubmitTexture extends laya.webgl.submit.Submit
var SubmitTexture=(function(_super){
	function SubmitTexture(renderType){
		this._preIsSameTextureShader=false;
		this._isSameTexture=true;
		this._texs=new Array;
		this._texsID=new Array;
		this._vbPos=new Array;
		(renderType===void 0)&& (renderType=10000);
		SubmitTexture.__super.call(this,renderType);
	}

	__class(SubmitTexture,'laya.webgl.submit.SubmitTexture',_super);
	var __proto=SubmitTexture.prototype;
	__proto.releaseRender=function(){
		var cache=SubmitTexture._cache;
		cache[cache._length++]=this;
		this.shaderValue.release();
		this._preIsSameTextureShader=false;
		this._vb=null;
		this._texs.length=0;
		this._vbPos.length=0;
		this._isSameTexture=true;
	}

	__proto.addTexture=function(tex,vbpos){
		this._texsID[this._texs.length]=tex._uvID;
		this._texs.push(tex);
		this._vbPos.push(vbpos);
	}

	//检查材质是否修改，修改UV，设置是否是同一材质
	__proto.checkTexture=function(){
		if (this._texs.length < 1){
			this._isSameTexture=true;
			return;
		};
		var _tex=this.shaderValue.textureHost;
		var webGLImg=_tex.bitmap;
		if (webGLImg===null)return;
		var vbdata=this._vb.getFloat32Array();
		for (var i=0,s=this._texs.length;i < s;i++){
			var tex=this._texs[i];
			tex.active();
			var newUV=tex.uv;
			if (this._texsID[i]!==tex._uvID){
				this._texsID[i]=tex._uvID;
				var vbPos=this._vbPos[i];
				vbdata[vbPos+2]=newUV[0];
				vbdata[vbPos+3]=newUV[1];
				vbdata[vbPos+6]=newUV[2];
				vbdata[vbPos+7]=newUV[3];
				vbdata[vbPos+10]=newUV[4];
				vbdata[vbPos+11]=newUV[5];
				vbdata[vbPos+14]=newUV[6];
				vbdata[vbPos+15]=newUV[7];
				this._vb.setNeedUpload();
			}
			if (tex.bitmap!==webGLImg){
				this._isSameTexture=false;
			}
		}
	}

	__proto.renderSubmit=function(){
		if (this._numEle===0){
			SubmitTexture._shaderSet=false;
			return 1;
		};
		var _tex=this.shaderValue.textureHost;
		if (_tex){
			var source=_tex.source;
			if (!_tex.bitmap || !source){
				SubmitTexture._shaderSet=false;
				return 1;
			}
			this.shaderValue.texture=source;
		}
		this._vb.bind_upload(this._ib);
		var gl=WebGL.mainContext;
		if (BlendMode.activeBlendFunction!==this._blendFn){
			gl.enable(0x0BE2);
			this._blendFn(gl);
			BlendMode.activeBlendFunction=this._blendFn;
		}
		Stat.drawCall++;
		Stat.trianglesFaces+=this._numEle / 3;
		if (this._preIsSameTextureShader && BaseShader.activeShader && SubmitTexture._shaderSet)
			(BaseShader.activeShader).uploadTexture2D(this.shaderValue.texture);
		else this.shaderValue.upload();
		SubmitTexture._shaderSet=true;
		if (this._texs.length > 1 && !this._isSameTexture){
			var webGLImg=_tex.bitmap;
			var index=0;
			var shader=BaseShader.activeShader;
			for (var i=0,s=this._texs.length;i < s;i++){
				var tex2=this._texs[i];
				if (tex2.bitmap!==webGLImg || (i+1)===s){
					shader.uploadTexture2D(tex2.source);
					gl.drawElements(0x0004,(i-index+1)*6,0x1403,this._startIdx+index *6 *CONST3D2D.BYTES_PIDX);
					webGLImg=tex2.bitmap;
					index=i;
				}
			}
			}else {
			gl.drawElements(0x0004,this._numEle,0x1403,this._startIdx);
		}
		return 1;
	}

	SubmitTexture.create=function(context,ib,vb,pos,sv){
		var o=SubmitTexture._cache._length ? SubmitTexture._cache[--SubmitTexture._cache._length] :new SubmitTexture();
		if (vb==null){
			vb=o._selfVb || (o._selfVb=VertexBuffer2D.create(-1));
			vb.clear();
			pos=0;
		}
		o._ib=ib;
		o._vb=vb;
		o._startIdx=pos *CONST3D2D.BYTES_PIDX;
		o._numEle=0;
		var blendType=context._nBlendType;
		o._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];
		o.shaderValue=sv;
		o.shaderValue.setValue(context._shader2D);
		var filters=context._shader2D.filters;
		filters && o.shaderValue.setFilters(filters);
		return o;
	}

	SubmitTexture._cache=(SubmitTexture._cache=[],SubmitTexture._cache._length=0,SubmitTexture._cache);
	SubmitTexture._shaderSet=true;
	return SubmitTexture;
})(Submit)


/**
*与MeshQuadTexture基本相同。不过index不是固定的
*/
//class laya.webgl.utils.MeshTexture extends laya.webgl.utils.Mesh2D
var MeshTexture=(function(_super){
	function MeshTexture(){
		MeshTexture.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0);
		this.canReuse=true;
		this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo);
	}

	__class(MeshTexture,'laya.webgl.utils.MeshTexture',_super);
	var __proto=MeshTexture.prototype;
	__proto.addData=function(vertices,uvs,idx,matrix,rgba,ctx){
		var sz=vertices.length / 2;
		var startpos=this._vb.needSize(sz *MeshTexture.const_stride);
		var f32pos=startpos >> 2;
		var vbdata=this._vb.getFloat32Array();
		var ci=0;
		for (var i=0;i < sz;i++){
			var x=vertices[ci],y=vertices[ci+1];
			var x1=x *matrix.a+y *matrix.c+matrix.tx;
			var y1=x *matrix.b+y *matrix.d+matrix.ty;
			vbdata[f32pos++]=x1;vbdata[f32pos++]=y1;
			vbdata[f32pos++]=uvs[ci];vbdata[f32pos++]=uvs[ci+1];
			ci+=2;
		}
		this._vb.setNeedUpload();
		var vertN=this.vertNum;
		if (vertN > 0){
			sz=idx.length;
			if (sz > MeshTexture.tmpIdx.length)MeshTexture.tmpIdx=new Uint16Array(sz);
			for (var ii=0;ii < sz;ii++){
				MeshTexture.tmpIdx[ii]=idx[ii]+vertN;
			}
			this._ib.appendU16Array(MeshTexture.tmpIdx,idx.length);
			}else {
			this._ib.append(idx);
		}
		this._ib.setNeedUpload();
		this.vertNum+=sz;
		this.indexNum+=idx.length;
	}

	/**
	*把本对象放到回收池中，以便getMesh能用。
	*/
	__proto.releaseMesh=function(){
		this._vb._byteLength=0;
		this._ib._byteLength=0;
		this.vertNum=0;
		this.indexNum=0;
		laya.webgl.utils.MeshTexture._POOL.push(this);
	}

	__proto.destroy=function(){
		this._ib.destroy();
		this._vb.destroy();
	}

	MeshTexture.getAMesh=function(){
		if (laya.webgl.utils.MeshTexture._POOL.length){
			return laya.webgl.utils.MeshTexture._POOL.pop();
		}
		return new MeshTexture();
	}

	MeshTexture.const_stride=16;
	MeshTexture._POOL=[];
	__static(MeshTexture,
	['_fixattriInfo',function(){return this._fixattriInfo=[
		0x1406,2,0,
		0x1406,2,8];},'tmpIdx',function(){return this.tmpIdx=new Uint16Array(4);}
	]);
	return MeshTexture;
})(Mesh2D)


/**
*<p> <code>Sprite</code> 是基本的显示图形的显示列表节点。 <code>Sprite</code> 默认没有宽高，默认不接受鼠标事件。通过 <code>graphics</code> 可以绘制图片或者矢量图，支持旋转，缩放，位移等操作。<code>Sprite</code>同时也是容器类，可用来添加多个子节点。</p>
*<p>注意： <code>Sprite</code> 默认没有宽高，可以通过<code>getBounds</code>函数获取；也可手动设置宽高；还可以设置<code>autoSize=true</code>，然后再获取宽高。<code>Sprite</code>的宽高一般用于进行碰撞检测和排版，并不影响显示图像大小，如果需要更改显示图像大小，请使用 <code>scaleX</code> ， <code>scaleY</code> ， <code>scale</code>。</p>
*<p> <code>Sprite</code> 默认不接受鼠标事件，即<code>mouseEnabled=false</code>，但是只要对其监听任意鼠标事件，会自动打开自己以及所有父对象的<code>mouseEnabled=true</code>。所以一般也无需手动设置<code>mouseEnabled</code>。</p>
*<p>LayaAir引擎API设计精简巧妙。核心显示类只有一个<code>Sprite</code>。<code>Sprite</code>针对不同的情况做了渲染优化，所以保证一个类实现丰富功能的同时，又达到高性能。</p>
*
*@example <caption>创建了一个 <code>Sprite</code> 实例。</caption>
*package
*{
	*import laya.display.Sprite;
	*import laya.events.Event;
	*
	*public class Sprite_Example
	*{
		*private var sprite:Sprite;
		*private var shape:Sprite
		*public function Sprite_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*onInit();
			*}
		*private function onInit():void
		*{
			*sprite=new Sprite();//创建一个 Sprite 类的实例对象 sprite 。
			*sprite.loadImage("resource/ui/bg.png");//加载并显示图片。
			*sprite.x=200;//设置 sprite 对象相对于父容器的水平方向坐标值。
			*sprite.y=200;//设置 sprite 对象相对于父容器的垂直方向坐标值。
			*sprite.pivotX=0;//设置 sprite 对象的水平方法轴心点坐标。
			*sprite.pivotY=0;//设置 sprite 对象的垂直方法轴心点坐标。
			*Laya.stage.addChild(sprite);//将此 sprite 对象添加到显示列表。
			*sprite.on(Event.CLICK,this,onClickSprite);//给 sprite 对象添加点击事件侦听。
			*shape=new Sprite();//创建一个 Sprite 类的实例对象 sprite 。
			*shape.graphics.drawRect(0,0,100,100,"#ccff00","#ff0000",2);//绘制一个有边框的填充矩形。
			*shape.x=400;//设置 shape 对象相对于父容器的水平方向坐标值。
			*shape.y=200;//设置 shape 对象相对于父容器的垂直方向坐标值。
			*shape.width=100;//设置 shape 对象的宽度。
			*shape.height=100;//设置 shape 对象的高度。
			*shape.pivotX=50;//设置 shape 对象的水平方法轴心点坐标。
			*shape.pivotY=50;//设置 shape 对象的垂直方法轴心点坐标。
			*Laya.stage.addChild(shape);//将此 shape 对象添加到显示列表。
			*shape.on(Event.CLICK,this,onClickShape);//给 shape 对象添加点击事件侦听。
			*}
		*private function onClickSprite():void
		*{
			*trace("点击 sprite 对象。");
			*sprite.rotation+=5;//旋转 sprite 对象。
			*}
		*private function onClickShape():void
		*{
			*trace("点击 shape 对象。");
			*shape.rotation+=5;//旋转 shape 对象。
			*}
		*}
	*}
*
*@example
*var sprite;
*var shape;
*Sprite_Example();
*function Sprite_Example()
*{
	*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
	*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
	*onInit();
	*}
*function onInit()
*{
	*sprite=new laya.display.Sprite();//创建一个 Sprite 类的实例对象 sprite 。
	*sprite.loadImage("resource/ui/bg.png");//加载并显示图片。
	*sprite.x=200;//设置 sprite 对象相对于父容器的水平方向坐标值。
	*sprite.y=200;//设置 sprite 对象相对于父容器的垂直方向坐标值。
	*sprite.pivotX=0;//设置 sprite 对象的水平方法轴心点坐标。
	*sprite.pivotY=0;//设置 sprite 对象的垂直方法轴心点坐标。
	*Laya.stage.addChild(sprite);//将此 sprite 对象添加到显示列表。
	*sprite.on(Event.CLICK,this,onClickSprite);//给 sprite 对象添加点击事件侦听。
	*shape=new laya.display.Sprite();//创建一个 Sprite 类的实例对象 sprite 。
	*shape.graphics.drawRect(0,0,100,100,"#ccff00","#ff0000",2);//绘制一个有边框的填充矩形。
	*shape.x=400;//设置 shape 对象相对于父容器的水平方向坐标值。
	*shape.y=200;//设置 shape 对象相对于父容器的垂直方向坐标值。
	*shape.width=100;//设置 shape 对象的宽度。
	*shape.height=100;//设置 shape 对象的高度。
	*shape.pivotX=50;//设置 shape 对象的水平方法轴心点坐标。
	*shape.pivotY=50;//设置 shape 对象的垂直方法轴心点坐标。
	*Laya.stage.addChild(shape);//将此 shape 对象添加到显示列表。
	*shape.on(laya.events.Event.CLICK,this,onClickShape);//给 shape 对象添加点击事件侦听。
	*}
*function onClickSprite()
*{
	*console.log("点击 sprite 对象。");
	*sprite.rotation+=5;//旋转 sprite 对象。
	*}
*function onClickShape()
*{
	*console.log("点击 shape 对象。");
	*shape.rotation+=5;//旋转 shape 对象。
	*}
*
*@example
*import Sprite=laya.display.Sprite;
*class Sprite_Example {
	*private sprite:Sprite;
	*private shape:Sprite
	*public Sprite_Example(){
		*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*this.onInit();
		*}
	*private onInit():void {
		*this.sprite=new Sprite();//创建一个 Sprite 类的实例对象 sprite 。
		*this.sprite.loadImage("resource/ui/bg.png");//加载并显示图片。
		*this.sprite.x=200;//设置 sprite 对象相对于父容器的水平方向坐标值。
		*this.sprite.y=200;//设置 sprite 对象相对于父容器的垂直方向坐标值。
		*this.sprite.pivotX=0;//设置 sprite 对象的水平方法轴心点坐标。
		*this.sprite.pivotY=0;//设置 sprite 对象的垂直方法轴心点坐标。
		*Laya.stage.addChild(this.sprite);//将此 sprite 对象添加到显示列表。
		*this.sprite.on(laya.events.Event.CLICK,this,this.onClickSprite);//给 sprite 对象添加点击事件侦听。
		*this.shape=new Sprite();//创建一个 Sprite 类的实例对象 sprite 。
		*this.shape.graphics.drawRect(0,0,100,100,"#ccff00","#ff0000",2);//绘制一个有边框的填充矩形。
		*this.shape.x=400;//设置 shape 对象相对于父容器的水平方向坐标值。
		*this.shape.y=200;//设置 shape 对象相对于父容器的垂直方向坐标值。
		*this.shape.width=100;//设置 shape 对象的宽度。
		*this.shape.height=100;//设置 shape 对象的高度。
		*this.shape.pivotX=50;//设置 shape 对象的水平方法轴心点坐标。
		*this.shape.pivotY=50;//设置 shape 对象的垂直方法轴心点坐标。
		*Laya.stage.addChild(this.shape);//将此 shape 对象添加到显示列表。
		*this.shape.on(laya.events.Event.CLICK,this,this.onClickShape);//给 shape 对象添加点击事件侦听。
		*}
	*private onClickSprite():void {
		*console.log("点击 sprite 对象。");
		*this.sprite.rotation+=5;//旋转 sprite 对象。
		*}
	*private onClickShape():void {
		*console.log("点击 shape 对象。");
		*this.shape.rotation+=5;//旋转 shape 对象。
		*}
	*}
*/
//class laya.display.Sprite extends laya.display.Node
var Sprite=(function(_super){
	function Sprite(){
		/**@private 矩阵变换信息。*/
		this._transform=null;
		/**@private */
		this._tfChanged=false;
		/**@private */
		this._x=0;
		/**@private */
		this._y=0;
		/**@private */
		this._width=0;
		/**@private */
		this._height=0;
		/**@private */
		this._repaint=1;
		/**@private 鼠标状态，0:auto,1:mouseEnabled=false,2:mouseEnabled=true。*/
		this._mouseEnableState=0;
		/**@private Z排序，数值越大越靠前。*/
		this._zOrder=0;
		/**@private */
		this._graphics=null;
		/**@private */
		this._renderType=0;
		/**@private */
		this._optimizeScrollRect=false;
		/**@private */
		this._texture=null;
		/**
		*<p>鼠标事件与此对象的碰撞检测是否可穿透。碰撞检测发生在鼠标事件的捕获阶段，此阶段引擎会从stage开始递归检测stage及其子对象，直到找到命中的目标对象或者未命中任何对象。</p>
		*<p>穿透表示鼠标事件发生的位置处于本对象绘图区域内时，才算命中，而与对象宽高和值为Rectangle对象的hitArea属性无关。如果sprite.hitArea值是HitArea对象，表示显式声明了此对象的鼠标事件响应区域，而忽略对象的宽高、mouseThrough属性。</p>
		*<p>影响对象鼠标事件响应区域的属性为：width、height、hitArea，优先级顺序为：hitArea(type:HitArea)>hitArea(type:Rectangle)>width/height。</p>
		*@default false 不可穿透，此对象的鼠标响应区域由width、height、hitArea属性决定。</p>
		*/
		this.mouseThrough=false;
		/**
		*<p>指定是否自动计算宽高数据。默认值为 false 。</p>
		*<p>Sprite宽高默认为0，并且不会随着绘制内容的变化而变化，如果想根据绘制内容获取宽高，可以设置本属性为true，或者通过getBounds方法获取。设置为true，对性能有一定影响。</p>
		*/
		this.autoSize=false;
		/**
		*<p>指定鼠标事件检测是优先检测自身，还是优先检测其子对象。鼠标事件检测发生在鼠标事件的捕获阶段，此阶段引擎会从stage开始递归检测stage及其子对象，直到找到命中的目标对象或者未命中任何对象。</p>
		*<p>如果为false，优先检测子对象，当有子对象被命中时，中断检测，获得命中目标。如果未命中任何子对象，最后再检测此对象；如果为true，则优先检测本对象，如果本对象没有被命中，直接中断检测，表示没有命中目标；如果本对象被命中，则进一步递归检测其子对象，以确认最终的命中目标。</p>
		*<p>合理使用本属性，能减少鼠标事件检测的节点，提高性能。可以设置为true的情况：开发者并不关心此节点的子节点的鼠标事件检测结果，也就是以此节点作为其子节点的鼠标事件检测依据。</p>
		*<p>Stage对象和UI的View组件默认为true。</p>
		*@default false 优先检测此对象的子对象，当递归检测完所有子对象后，仍然没有找到目标对象，最后再检测此对象。
		*/
		this.hitTestPrior=false;
		/**
		*<p>视口大小，视口外的子对象，将不被渲染(如果想实现裁剪效果，请使用srollRect)，合理使用能提高渲染性能。比如由一个个小图片拼成的地图块，viewport外面的小图片将不渲染</p>
		*<p>srollRect和viewport的区别：<br/>
		*1. srollRect自带裁剪效果，viewport只影响子对象渲染是否渲染，不具有裁剪效果（性能更高）。<br/>
		*2. 设置rect的x,y属性均能实现区域滚动效果，但scrollRect会保持0,0点位置不变。</p>
		*@default null
		*/
		this.viewport=null;
		Sprite.__super.call(this);
		this._style=Style.EMPTY;
	}

	__class(Sprite,'laya.display.Sprite',_super);
	var __proto=Sprite.prototype;
	Laya.imps(__proto,{"laya.display.ILayout":true})
	/**@private */
	__proto.createConchModel=function(){
		return new ConchNode();
	}

	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		this._releaseMem();
		_super.prototype.destroy.call(this,destroyChild);
		this._style && this._style.destroy();
		this._transform && this._transform.destroy();
		this._transform=null;
		this._style=null;
		this._graphics=null;
	}

	/**根据zOrder进行重新排序。*/
	__proto.updateZOrder=function(){
		Utils.updateOrder(this._childs)&& this.repaint();
	}

	/**在设置cacheAs的情况下，调用此方法会重新刷新缓存。*/
	__proto.reCache=function(){
		if (this._$P.cacheCanvas)this._$P.cacheCanvas.reCache=true;
		this._repaint=1;
	}

	/**
	*<p>设置对象在自身坐标系下的边界范围。与 <code>getSelfBounds</code> 对应。当 autoSize==true 时，会影响对象宽高。设置后，当需要获取自身边界范围时，就不再需要计算，合理使用能提高性能。比如 <code>getBounds</code> 会优先使用 <code>setBounds</code> 指定的值，如果没有指定则进行计算，此计算会对性能消耗比较大。</p>
	*<p><b>注意：</b> <code>setBounds</code> 与 <code>getBounds</code> 并非对应相等关系， <code>getBounds</code> 获取的是本对象在父容器坐标系下的边界范围，通过设置 <code>setBounds</code> 会影响 <code>getBounds</code> 的结果。</p>
	*@param bound bounds矩形区域
	*/
	__proto.setBounds=function(bound){
		this._set$P("uBounds",bound);
	}

	/**
	*<p>获取本对象在父容器坐标系的矩形显示区域。</p>
	*<p><b>注意：</b> 1.计算量较大，尽量少用，如果需要频繁使用，可以通过手动设置 <code>setBounds</code> 来缓存自身边界信息，从而避免比较消耗性能的计算。2. <code>setBounds</code> 与 <code>getBounds</code> 并非对应相等关系， <code>getBounds</code> 获取的是本对象在父容器坐标系下的边界范围，通过设置 <code>setBounds</code> 会影响 <code>getBounds</code> 的结果。</p>
	*@return 矩形区域。
	*/
	__proto.getBounds=function(){
		if (!this._$P.mBounds)this._set$P("mBounds",new Rectangle());
		return Rectangle._getWrapRec(this._boundPointsToParent(),this._$P.mBounds);
	}

	/**
	*获取对象在自身坐标系的边界范围。与 <code>setBounds</code> 对应。
	*<p><b>注意：</b>计算量较大，尽量少用，如果需要频繁使用，可以提前手动设置 <code>setBounds</code> 来缓存自身边界信息，从而避免比较消耗性能的计算。</p>
	*@return 矩形区域。
	*/
	__proto.getSelfBounds=function(){
		if (this._$P.uBounds)return this._$P.uBounds;
		if (!this._$P.mBounds)this._set$P("mBounds",new Rectangle());
		return Rectangle._getWrapRec(this._getBoundPointsM(false),this._$P.mBounds);
	}

	/**
	*@private
	*获取本对象在父容器坐标系的显示区域多边形顶点列表。
	*当显示对象链中有旋转时，返回多边形顶点列表，无旋转时返回矩形的四个顶点。
	*@param ifRotate （可选）之前的对象链中是否有旋转。
	*@return 顶点列表。结构：[x1,y1,x2,y2,x3,y3,...]。
	*/
	__proto._boundPointsToParent=function(ifRotate){
		(ifRotate===void 0)&& (ifRotate=false);
		var pX=0,pY=0;
		if (this._style){
			pX=this._style._tf.translateX;
			pY=this._style._tf.translateY;
			ifRotate=ifRotate || (this._style._tf.rotate!==0);
			if (this._style.scrollRect){
				pX+=this._style.scrollRect.x;
				pY+=this._style.scrollRect.y;
			}
		};
		var pList=this._getBoundPointsM(ifRotate);
		if (!pList || pList.length < 1)return pList;
		if (pList.length !=8){
			pList=ifRotate ? GrahamScan.scanPList(pList):Rectangle._getWrapRec(pList,Rectangle.TEMP)._getBoundPoints();
		}
		if (!this.transform){
			Utils.transPointList(pList,this._x-pX,this._y-pY);
			return pList;
		};
		var tPoint=Point.TEMP;
		var i=0,len=pList.length;
		for (i=0;i < len;i+=2){
			tPoint.x=pList[i];
			tPoint.y=pList[i+1];
			this.toParentPoint(tPoint);
			pList[i]=tPoint.x;
			pList[i+1]=tPoint.y;
		}
		return pList;
	}

	/**
	*返回此实例中的绘图对象（ <code>Graphics</code> ）的显示区域，不包括子对象。
	*@param realSize （可选）使用图片的真实大小，默认为false
	*@return 一个 Rectangle 对象，表示获取到的显示区域。
	*/
	__proto.getGraphicBounds=function(realSize){
		(realSize===void 0)&& (realSize=false);
		if (!this._graphics)return Rectangle.TEMP.setTo(0,0,0,0);
		return this._graphics.getBounds(realSize);
	}

	/**
	*@private
	*获取自己坐标系的显示区域多边形顶点列表
	*@param ifRotate （可选）当前的显示对象链是否由旋转
	*@return 顶点列表。结构：[x1,y1,x2,y2,x3,y3,...]。
	*/
	__proto._getBoundPointsM=function(ifRotate){
		(ifRotate===void 0)&& (ifRotate=false);
		if (this._$P.uBounds)return this._$P.uBounds._getBoundPoints();
		if (!this._$P.temBM)this._set$P("temBM",[]);
		if (this.scrollRect){
			var rst=Utils.clearArray(this._$P.temBM);
			var rec=Rectangle.TEMP;
			rec.copyFrom(this.scrollRect);
			Utils.concatArray(rst,rec._getBoundPoints());
			return rst;
		};
		var pList=this._graphics ? this._graphics.getBoundPoints():Utils.clearArray(this._$P.temBM);
		var child;
		var cList;
		var __childs;
		__childs=this._childs;
		for (var i=0,n=__childs.length;i < n;i++){
			child=__childs [i];
			if ((child instanceof laya.display.Sprite )&& child.visible==true){
				cList=child._boundPointsToParent(ifRotate);
				if (cList)
					pList=pList ? Utils.concatArray(pList,cList):cList;
			}
		}
		return pList;
	}

	/**
	*@private
	*获取样式。
	*@return 样式 Style 。
	*/
	__proto.getStyle=function(){
		this._style===Style.EMPTY && (this._style=new Style());
		return this._style;
	}

	/**
	*@private
	*设置样式。
	*@param value 样式。
	*/
	__proto.setStyle=function(value){
		this._style=value;
	}

	/**@private */
	__proto._adjustTransform=function(){
		this._tfChanged=false;
		var style=this._style;
		var tf=style._tf;
		var sx=tf.scaleX,sy=tf.scaleY;
		var m;
		if (tf.rotate || sx!==1 || sy!==1 || tf.skewX || tf.skewY){
			m=this._transform || (this._transform=Matrix.create());
			m.bTransform=true;
			var skx=(tf.rotate-tf.skewX)*0.0174532922222222;
			var sky=(tf.rotate+tf.skewY)*0.0174532922222222;
			var cx=Math.cos(sky);
			var ssx=Math.sin(sky);
			var cy=Math.sin(skx);
			var ssy=Math.cos(skx);
			m.a=sx *cx;
			m.b=sx *ssx;
			m.c=-sy *cy;
			m.d=sy *ssy;
			m.tx=m.ty=0;
			return m;
			}else {
			this._transform && this._transform.destroy();
			this._transform=null;
			this._renderType &=~0x04;
		}
		return m;
	}

	/**
	*<p>设置坐标位置。相当于分别设置x和y属性。</p>
	*<p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.pos(...).scale(...);</p>
	*@param x X轴坐标。
	*@param y Y轴坐标。
	*@param speedMode （可选）是否极速模式，正常是调用this.x=value进行赋值，极速模式直接调用内部函数处理，如果未重写x,y属性，建议设置为急速模式性能更高。
	*@return 返回对象本身。
	*/
	__proto.pos=function(x,y,speedMode){
		(speedMode===void 0)&& (speedMode=false);
		if (this._x!==x || this._y!==y){
			if (this.destroyed)return this;
			if (speedMode){
				this._x=x;
				this._y=y;
				this.conchModel && this.conchModel.pos(this._x,this._y);
				var p=this._parent;
				if (p && p._repaint===0){
					p._repaint=1;
					p.parentRepaint();
				}
				if (this._$P.maskParent && this._$P.maskParent._repaint===0){
					this._$P.maskParent._repaint=1;
					this._$P.maskParent.parentRepaint();
				}
				}else {
				this.x=x;
				this.y=y;
			}
		}
		return this;
	}

	/**
	*<p>设置轴心点。相当于分别设置pivotX和pivotY属性。</p>
	*<p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.pivot(...).pos(...);</p>
	*@param x X轴心点。
	*@param y Y轴心点。
	*@return 返回对象本身。
	*/
	__proto.pivot=function(x,y){
		this.pivotX=x;
		this.pivotY=y;
		return this;
	}

	/**
	*<p>设置宽高。相当于分别设置width和height属性。</p>
	*<p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.size(...).pos(...);</p>
	*@param width 宽度值。
	*@param hegiht 高度值。
	*@return 返回对象本身。
	*/
	__proto.size=function(width,height){
		this.width=width;
		this.height=height;
		return this;
	}

	/**
	*<p>设置缩放。相当于分别设置scaleX和scaleY属性。</p>
	*<p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.scale(...).pos(...);</p>
	*@param scaleX X轴缩放比例。
	*@param scaleY Y轴缩放比例。
	*@param speedMode （可选）是否极速模式，正常是调用this.scaleX=value进行赋值，极速模式直接调用内部函数处理，如果未重写scaleX,scaleY属性，建议设置为急速模式性能更高。
	*@return 返回对象本身。
	*/
	__proto.scale=function(scaleX,scaleY,speedMode){
		(speedMode===void 0)&& (speedMode=false);
		var style=this.getStyle();
		var _tf=style._tf;
		if (_tf.scaleX !=scaleX || _tf.scaleY !=scaleY){
			if (this.destroyed)return this;
			if (speedMode){
				style.setScale(scaleX,scaleY);
				this._tfChanged=true;
				this.conchModel && this.conchModel.scale(scaleX,scaleY);
				this._renderType |=0x04;
				var p=this._parent;
				if (p && p._repaint===0){
					p._repaint=1;
					p.parentRepaint();
				}
				}else {
				this.scaleX=scaleX;
				this.scaleY=scaleY;
			}
		}
		return this;
	}

	/**
	*<p>设置倾斜角度。相当于分别设置skewX和skewY属性。</p>
	*<p>因为返回值为Sprite对象本身，所以可以使用如下语法：spr.skew(...).pos(...);</p>
	*@param skewX 水平倾斜角度。
	*@param skewY 垂直倾斜角度。
	*@return 返回对象本身
	*/
	__proto.skew=function(skewX,skewY){
		this.skewX=skewX;
		this.skewY=skewY;
		return this;
	}

	/**
	*更新、呈现显示对象。由系统调用。
	*@param context 渲染的上下文引用。
	*@param x X轴坐标。
	*@param y Y轴坐标。
	*/
	__proto.render=function(context,x,y){
		Stat.spriteCount++;
		RenderSprite.renders[this._renderType]._fun(this,context,x+this._x,y+this._y);
		this._repaint=0;
	}

	/**
	*<p>绘制 当前<code>Sprite</code> 到 <code>Canvas</code> 上，并返回一个HtmlCanvas。</p>
	*<p>绘制的结果可以当作图片源，再次绘制到其他Sprite里面，示例：</p>
	*
	*var htmlCanvas:HTMLCanvas=sprite.drawToCanvas(100,100,0,0);//把精灵绘制到canvas上面
	*var texture:Texture=new Texture(htmlCanvas);//使用htmlCanvas创建Texture
	*var sp:Sprite=new Sprite().pos(0,200);//创建精灵并把它放倒200位置
	*sp.graphics.drawTexture(texture);//把截图绘制到精灵上
	*Laya.stage.addChild(sp);//把精灵显示到舞台
	*
	*<p>也可以获取原始图片数据，分享到网上，从而实现截图效果，示例：</p>
	*
	*var htmlCanvas:HTMLCanvas=sprite.drawToCanvas(100,100,0,0);//把精灵绘制到canvas上面
	*
	*htmlCanvas.toBase64("image/png",0.92,function(base64){//webgl和canvas模式下为同步方法，加速器下是异步方法
		*trace(base64);//打印图片base64信息，可以发给服务器或者保存为图片
		*});
	*
	*@param canvasWidth 画布宽度。
	*@param canvasHeight 画布高度。
	*@param x 绘制的 X 轴偏移量。
	*@param y 绘制的 Y 轴偏移量。
	*@return HTMLCanvas 对象。
	*/
	__proto.drawToCanvas=function(canvasWidth,canvasHeight,offsetX,offsetY){
		if (Render.isConchNode){
			var canvas=HTMLCanvas.create("2D");
			var context=new RenderContext(canvasWidth,canvasHeight,canvas);
			context.ctx.setCanvasType(1);
			this.conchModel.drawToCanvas(canvas.source,offsetX,offsetY);
			return canvas;
			}else {
			return RunDriver.drawToCanvas(this,this._renderType,canvasWidth,canvasHeight,offsetX,offsetY);
		}
	}

	/**
	*<p>自定义更新、呈现显示对象。一般用来扩展渲染模式，请合理使用，可能会导致在加速器上无法渲染。</p>
	*<p><b>注意</b>不要在此函数内增加或删除树节点，否则会对树节点遍历造成影响。</p>
	*@param context 渲染的上下文引用。
	*@param x X轴坐标。
	*@param y Y轴坐标。
	*/
	__proto.customRender=function(context,x,y){
		this._renderType |=0x400;
	}

	/**
	*@private
	*应用滤镜。
	*/
	__proto._applyFilters=function(){
		if (Render.isWebGL)return;
		var _filters;
		_filters=this._$P.filters;
		if (!_filters || _filters.length < 1)return;
		for (var i=0,n=_filters.length;i < n;i++){
			_filters[i].action.apply(this._$P.cacheCanvas);
		}
	}

	/**
	*@private
	*查看当前原件中是否包含发光滤镜。
	*@return 一个 Boolean 值，表示当前原件中是否包含发光滤镜。
	*/
	__proto._isHaveGlowFilter=function(){
		var i=0,len=0;
		if (this.filters){
			for (i=0;i < this.filters.length;i++){
				if (this.filters[i].type==0x08){
					return true;
				}
			}
		}
		for (i=0,len=this._childs.length;i < len;i++){
			if (this._childs[i]._isHaveGlowFilter()){
				return true;
			}
		}
		return false;
	}

	/**
	*把本地坐标转换为相对stage的全局坐标。
	*@param point 本地坐标点。
	*@param createNewPoint （可选）是否创建一个新的Point对象作为返回值，默认为false，使用输入的point对象返回，减少对象创建开销。
	*@return 转换后的坐标的点。
	*/
	__proto.localToGlobal=function(point,createNewPoint){
		(createNewPoint===void 0)&& (createNewPoint=false);
		if (createNewPoint===true){
			point=new Point(point.x,point.y);
		};
		var ele=this;
		while (ele){
			if (ele==Laya.stage)break ;
			point=ele.toParentPoint(point);
			ele=ele.parent;
		}
		return point;
	}

	/**
	*把stage的全局坐标转换为本地坐标。
	*@param point 全局坐标点。
	*@param createNewPoint （可选）是否创建一个新的Point对象作为返回值，默认为false，使用输入的point对象返回，减少对象创建开销。
	*@return 转换后的坐标的点。
	*/
	__proto.globalToLocal=function(point,createNewPoint){
		(createNewPoint===void 0)&& (createNewPoint=false);
		if (createNewPoint){
			point=new Point(point.x,point.y);
		};
		var ele=this;
		var list=[];
		while (ele){
			if (ele==Laya.stage)break ;
			list.push(ele);
			ele=ele.parent;
		};
		var i=list.length-1;
		while (i >=0){
			ele=list[i];
			point=ele.fromParentPoint(point);
			i--;
		}
		return point;
	}

	/**
	*将本地坐标系坐标转转换到父容器坐标系。
	*@param point 本地坐标点。
	*@return 转换后的点。
	*/
	__proto.toParentPoint=function(point){
		if (!point)return point;
		point.x-=this.pivotX;
		point.y-=this.pivotY;
		if (this.transform){
			this._transform.transformPoint(point);
		}
		point.x+=this._x;
		point.y+=this._y;
		var scroll=this._style.scrollRect;
		if (scroll){
			point.x-=scroll.x;
			point.y-=scroll.y;
		}
		return point;
	}

	/**
	*将父容器坐标系坐标转换到本地坐标系。
	*@param point 父容器坐标点。
	*@return 转换后的点。
	*/
	__proto.fromParentPoint=function(point){
		if (!point)return point;
		point.x-=this._x;
		point.y-=this._y;
		var scroll=this._style.scrollRect;
		if (scroll){
			point.x+=scroll.x;
			point.y+=scroll.y;
		}
		if (this.transform){
			this._transform.invertTransformPoint(point);
		}
		point.x+=this.pivotX;
		point.y+=this.pivotY;
		return point;
	}

	/**
	*<p>增加事件侦听器，以使侦听器能够接收事件通知。</p>
	*<p>如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。</p>
	*@param type 事件的类型。
	*@param caller 事件侦听函数的执行域。
	*@param listener 事件侦听函数。
	*@param args （可选）事件侦听函数的回调参数。
	*@return 此 EventDispatcher 对象。
	*/
	__proto.on=function(type,caller,listener,args){
		if (this._mouseEnableState!==1 && this.isMouseEvent(type)){
			this.mouseEnabled=true;
			this._setBit(0x2,true);
			if (this._parent){
				this._$2__onDisplay();
			}
			return this._createListener(type,caller,listener,args,false);
		}
		return _super.prototype.on.call(this,type,caller,listener,args);
	}

	/**
	*<p>增加事件侦听器，以使侦听器能够接收事件通知，此侦听事件响应一次后则自动移除侦听。</p>
	*<p>如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。</p>
	*@param type 事件的类型。
	*@param caller 事件侦听函数的执行域。
	*@param listener 事件侦听函数。
	*@param args （可选）事件侦听函数的回调参数。
	*@return 此 EventDispatcher 对象。
	*/
	__proto.once=function(type,caller,listener,args){
		if (this._mouseEnableState!==1 && this.isMouseEvent(type)){
			this.mouseEnabled=true;
			this._setBit(0x2,true);
			if (this._parent){
				this._$2__onDisplay();
			}
			return this._createListener(type,caller,listener,args,true);
		}
		return _super.prototype.once.call(this,type,caller,listener,args);
	}

	/**@private */
	__proto._$2__onDisplay=function(){
		if (this._mouseEnableState!==1){
			var ele=this;
			ele=ele.parent;
			while (ele && ele._mouseEnableState!==1){
				if (ele._getBit(0x2))break ;
				ele.mouseEnabled=true;
				ele._setBit(0x2,true);
				ele=ele.parent;
			}
		}
	}

	/**
	*<p>加载并显示一个图片。功能等同于graphics.loadImage方法。支持异步加载。</p>
	*<p>注意：多次调用loadImage绘制不同的图片，会同时显示。</p>
	*@param url 图片地址。
	*@param x （可选）显示图片的x位置。
	*@param y （可选）显示图片的y位置。
	*@param width （可选）显示图片的宽度，设置为0表示使用图片默认宽度。
	*@param height （可选）显示图片的高度，设置为0表示使用图片默认高度。
	*@param complete （可选）加载完成回调。
	*@return 返回精灵对象本身。
	*/
	__proto.loadImage=function(url,x,y,width,height,complete){
		var _$this=this;
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		(width===void 0)&& (width=0);
		(height===void 0)&& (height=0);
		function loaded (tex){
			if (!_$this.destroyed){
				_$this.size(x+(width || tex.width),y+(height || tex.height));
				_$this.repaint();
				complete && complete.runWith(tex);
			}
		}
		this.graphics.loadImage(url,x,y,width,height,loaded);
		return this;
	}

	/**cacheAs后，设置自己和父对象缓存失效。*/
	__proto.repaint=function(){
		this.conchModel && this.conchModel.repaint && this.conchModel.repaint();
		if (this._repaint===0){
			this._repaint=1;
			this.parentRepaint();
		}
		if (this._$P && this._$P.maskParent){
			this._$P.maskParent.repaint();
		}
	}

	/**
	*@private
	*获取是否重新缓存。
	*@return 如果重新缓存值为 true，否则值为 false。
	*/
	__proto._needRepaint=function(){
		return (this._repaint!==0)&& this._$P.cacheCanvas && this._$P.cacheCanvas.reCache;
	}

	/**@private */
	__proto._childChanged=function(child){
		if (this._childs.length)this._renderType |=0x800;
		else this._renderType &=~0x800;
		if (child && this._get$P("hasZorder"))Laya.timer.callLater(this,this.updateZOrder);
		this.repaint();
	}

	/**cacheAs时，设置所有父对象缓存失效。 */
	__proto.parentRepaint=function(){
		var p=this._parent;
		if (p && p._repaint===0){
			p._repaint=1;
			p.parentRepaint();
		}
	}

	/**
	*开始拖动此对象。
	*@param area （可选）拖动区域，此区域为当前对象注册点活动区域（不包括对象宽高），可选。
	*@param hasInertia （可选）鼠标松开后，是否还惯性滑动，默认为false，可选。
	*@param elasticDistance （可选）橡皮筋效果的距离值，0为无橡皮筋效果，默认为0，可选。
	*@param elasticBackTime （可选）橡皮筋回弹时间，单位为毫秒，默认为300毫秒，可选。
	*@param data （可选）拖动事件携带的数据，可选。
	*@param disableMouseEvent （可选）禁用其他对象的鼠标检测，默认为false，设置为true能提高性能。
	*@param ratio （可选）惯性阻尼系数，影响惯性力度和时长。
	*/
	__proto.startDrag=function(area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio){
		(hasInertia===void 0)&& (hasInertia=false);
		(elasticDistance===void 0)&& (elasticDistance=0);
		(elasticBackTime===void 0)&& (elasticBackTime=300);
		(disableMouseEvent===void 0)&& (disableMouseEvent=false);
		(ratio===void 0)&& (ratio=0.92);
		this._$P.dragging || (this._set$P("dragging",new Dragging()));
		this._$P.dragging.start(this,area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio);
	}

	/**停止拖动此对象。*/
	__proto.stopDrag=function(){
		this._$P.dragging && this._$P.dragging.stop();
	}

	__proto._releaseMem=function(){
		if (!this._$P)return;
		var cc=this._$P.cacheCanvas;
		if (cc && cc.ctx){
			Pool.recover("RenderContext",cc.ctx);
			cc.ctx.canvas.size(0,0);
			cc.ctx=null;
		};
		var fc=this._$P._filterCache;
		if (fc){
			fc.destroy();
			fc.recycle();
			this._set$P('_filterCache',null);
		}
		this._$P._isHaveGlowFilter && this._set$P('_isHaveGlowFilter',false);
		this._$P._isHaveGlowFilter=null;
	}

	/**@private */
	__proto._setDisplay=function(value){
		if (!value)this._releaseMem();
		_super.prototype._setDisplay.call(this,value);
	}

	/**
	*检测某个点是否在此对象内。
	*@param x 全局x坐标。
	*@param y 全局y坐标。
	*@return 表示是否在对象内。
	*/
	__proto.hitTestPoint=function(x,y){
		var point=this.globalToLocal(Point.TEMP.setTo(x,y));
		x=point.x;
		y=point.y;
		var rect=this._$P.hitArea ? this._$P.hitArea :(this._width > 0 && this._height > 0)? Rectangle.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds();
		return rect.contains(x,y);
	}

	/**获得相对于本对象上的鼠标坐标信息。*/
	__proto.getMousePoint=function(){
		return this.globalToLocal(Point.TEMP.setTo(Laya.stage.mouseX,Laya.stage.mouseY));
	}

	/**@private */
	__proto._getWords=function(){
		return null;
	}

	/**@private */
	__proto._addChildsToLayout=function(out){
		var words=this._getWords();
		if (words==null && this._childs.length==0)return false;
		if (words){
			for (var i=0,n=words.length;i < n;i++){
				out.push(words[i]);
			}
		}
		this._childs.forEach(function(o,index,array){
			o._style._enableLayout()&& o._addToLayout(out);
		});
		return true;
	}

	/**@private */
	__proto._addToLayout=function(out){
		if (this._style.absolute)return;
		this._style.block ? out.push(this):(this._addChildsToLayout(out)&& (this.x=this.y=0));
	}

	/**@private */
	__proto._isChar=function(){
		return false;
	}

	/**@private */
	__proto._getCSSStyle=function(){
		return this._style.getCSSStyle();
	}

	/**
	*@private
	*设置指定属性名的属性值。
	*@param name 属性名。
	*@param value 属性值。
	*/
	__proto._setAttributes=function(name,value){
		switch (name){
			case 'x':
				this.x=parseFloat(value);
				break ;
			case 'y':
				this.y=parseFloat(value);
				break ;
			case 'width':
				this.width=parseFloat(value);
				break ;
			case 'height':
				this.height=parseFloat(value);
				break ;
			default :
				this[name]=value;
			}
	}

	/**
	*@private
	*/
	__proto._layoutLater=function(){
		this.parent && (this.parent)._layoutLater();
	}

	/**
	*<p>指定是否对使用了 scrollRect 的显示对象进行优化处理。默认为false(不优化)。</p>
	*<p>当值为ture时：将对此对象使用了scrollRect 设定的显示区域以外的显示内容不进行渲染，以提高性能(如果子对象有旋转缩放或者中心点偏移，则显示筛选会不精确)。</p>
	*/
	__getset(0,__proto,'optimizeScrollRect',function(){
		return this._optimizeScrollRect;
		},function(b){
		if (this._optimizeScrollRect !=b){
			this._optimizeScrollRect=b;
			this.conchModel && this.conchModel.optimizeScrollRect(b);
		}
	});

	/**
	*设置是否开启自定义渲染，只有开启自定义渲染，才能使用customRender函数渲染。
	*/
	__getset(0,__proto,'customRenderEnable',null,function(b){
		if (b){
			this._renderType |=0x400;
			if (Render.isConchNode){
				Sprite.CustomList.push(this);
				var canvas=new HTMLCanvas("2d");
				canvas._setContext(new CanvasRenderingContext2D());
				this.customContext=new RenderContext(0,0,canvas);
				canvas.context.setCanvasType && canvas.context.setCanvasType(2);
				this.conchModel.custom(canvas.context);
			}
		}
	});

	/**
	*指定显示对象是否缓存为静态图像。功能同cacheAs的normal模式。建议优先使用cacheAs代替。
	*/
	__getset(0,__proto,'cacheAsBitmap',function(){
		return this.cacheAs!=="none";
		},function(value){
		this.cacheAs=value ? (this._$P["hasFilter"] ? "none" :"normal"):"none";
	});

	/**
	*<p>指定显示对象是否缓存为静态图像，cacheAs时，子对象发生变化，会自动重新缓存，同时也可以手动调用reCache方法更新缓存。</p>
	*<p>建议把不经常变化的“复杂内容”缓存为静态图像，能极大提高渲染性能。cacheAs有"none"，"normal"和"bitmap"三个值可选。
	*<li>默认为"none"，不做任何缓存。</li>
	*<li>当值为"normal"时，canvas模式下进行画布缓存，webgl模式下进行命令缓存。</li>
	*<li>当值为"bitmap"时，canvas模式下进行依然是画布缓存，webgl模式下使用renderTarget缓存。</li></p>
	*<p>webgl下renderTarget缓存模式缺点：会额外创建renderTarget对象，增加内存开销，缓存面积有最大2048限制，不断重绘时会增加CPU开销。优点：大幅减少drawcall，渲染性能最高。
	*webgl下命令缓存模式缺点：只会减少节点遍历及命令组织，不会减少drawcall数，性能中等。优点：没有额外内存开销，无需renderTarget支持。</p>
	*/
	__getset(0,__proto,'cacheAs',function(){
		return this._$P.cacheCanvas==null ? "none" :this._$P.cacheCanvas.type;
		},function(value){
		var cacheCanvas=this._$P.cacheCanvas;
		if (value===(cacheCanvas ? cacheCanvas.type :"none"))return;
		if (value!=="none"){
			if (!this._getBit(0x1))this._setUpNoticeType(0x1);
			cacheCanvas || (cacheCanvas=this._set$P("cacheCanvas",Pool.getItemByClass("cacheCanvas",Object)));
			cacheCanvas.type=value;
			cacheCanvas.reCache=true;
			this._renderType |=0x10;
			if (value=="bitmap")this.conchModel && this.conchModel.cacheAs(1);
			this._set$P("cacheForFilters",false);
			}else {
			if (this._$P["_mask"]){
			}else
			if (this._$P["hasFilter"]){
				this._set$P("cacheForFilters",true);
				}else {
				if (cacheCanvas){
					var cc=cacheCanvas;
					if (cc && cc.ctx){
						Pool.recover("RenderContext",cc.ctx);
						cc.ctx.canvas.size(0,0);
						cc.ctx=null;
					}
					Pool.recover("cacheCanvas",cacheCanvas);
				}
				this._$P.cacheCanvas=null;
				this._renderType &=~0x10;
				this.conchModel && this.conchModel.cacheAs(0);
			}
		}
		this.repaint();
	});

	/**z排序，更改此值，则会按照值的大小对同一容器的所有对象重新排序。值越大，越靠上。默认为0，则根据添加顺序排序。*/
	__getset(0,__proto,'zOrder',function(){
		return this._zOrder;
		},function(value){
		if (this._zOrder !=value){
			this._zOrder=value;
			this.conchModel && this.conchModel.setZOrder && this.conchModel.setZOrder(value);
			if (this._parent){
				value && this._parent._set$P("hasZorder",true);
				Laya.timer.callLater(this._parent,this.updateZOrder);
			}
		}
	});

	/**旋转角度，默认值为0。以角度为单位。*/
	__getset(0,__proto,'rotation',function(){
		return this._style._tf.rotate;
		},function(value){
		var style=this.getStyle();
		if (style._tf.rotate!==value){
			style.setRotate(value);
			this._tfChanged=true;
			this.conchModel && this.conchModel.rotate(value);
			this._renderType |=0x04;
			var p=this._parent;
			if (p && p._repaint===0){
				p._repaint=1;
				p.parentRepaint();
			}
		}
	});

	/**
	*<p>显示对象的宽度，单位为像素，默认为0。</p>
	*<p>此宽度用于鼠标碰撞检测，并不影响显示对象图像大小。需要对显示对象的图像进行缩放，请使用scale、scaleX、scaleY。</p>
	*<p>可以通过getbounds获取显示对象图像的实际宽度。</p>
	*/
	__getset(0,__proto,'width',function(){
		if (!this.autoSize)return this._width;
		return this.getSelfBounds().width;
		},function(value){
		if (this._width!==value){
			this._width=value;
			this.conchModel && this.conchModel.size(value,this._height)
			this.repaint();
		}
	});

	/**表示显示对象相对于父容器的水平方向坐标值。*/
	__getset(0,__proto,'x',function(){
		return this._x;
		},function(value){
		if (this._x!==value){
			if (this.destroyed)return;
			this._x=value;
			this.conchModel && this.conchModel.pos(value,this._y);
			var p=this._parent;
			if (p && p._repaint===0){
				p._repaint=1;
				p.parentRepaint();
			}
			if (this._$P.maskParent && this._$P.maskParent._repaint===0){
				this._$P.maskParent._repaint=1;
				this._$P.maskParent.parentRepaint();
			}
		}
	});

	/**
	*获得相对于stage的全局Y轴缩放值（会叠加父亲节点的缩放值）。
	*/
	__getset(0,__proto,'globalScaleY',function(){
		var scale=1;
		var ele=this;
		while (ele){
			if (ele===Laya.stage)break ;
			scale *=ele.scaleY;
			ele=ele.parent;
		}
		return scale;
	});

	/**
	*<p>可以设置一个Rectangle区域作为点击区域，或者设置一个<code>HitArea</code>实例作为点击区域，HitArea内可以设置可点击和不可点击区域。</p>
	*<p>如果不设置hitArea，则根据宽高形成的区域进行碰撞。</p>
	*/
	__getset(0,__proto,'hitArea',function(){
		return this._$P.hitArea;
		},function(value){
		this._set$P("hitArea",value);
	});

	/**
	*是否静态缓存此对象的当前帧的最终属性。为 true 时，子对象变化时不会自动更新缓存，但是可以通过调用 reCache 方法手动刷新。
	*<b>注意：</b> 1. 设置 cacheAs 为非空和非"none"时才有效。 2. 由于渲染的时机在脚本执行之后，也就是说当前帧渲染的是对象的最终属性，所以如果在当前帧渲染之前、设置静态缓存之后改变对象属性，则最终渲染结果表现的是对象的最终属性。
	*/
	__getset(0,__proto,'staticCache',function(){
		return this._$P.staticCache;
		},function(value){
		this._set$P("staticCache",value);
		if (!value)this.reCache();
	});

	/**设置一个Texture实例，并显示此图片（如果之前有其他绘制，则会被清除掉）。等同于graphics.clear();graphics.drawTexture()*/
	__getset(0,__proto,'texture',function(){
		return this._texture;
		},function(value){
		if (this._texture !=value){
			this._texture=value;
			this.graphics.cleanByTexture(value,0,0);
		}
	});

	/**表示显示对象相对于父容器的垂直方向坐标值。*/
	__getset(0,__proto,'y',function(){
		return this._y;
		},function(value){
		if (this._y!==value){
			if (this.destroyed)return;
			this._y=value;
			this.conchModel && this.conchModel.pos(this._x,value);
			var p=this._parent;
			if (p && p._repaint===0){
				p._repaint=1;
				p.parentRepaint();
			}
			if (this._$P.maskParent && this._$P.maskParent._repaint===0){
				this._$P.maskParent._repaint=1;
				this._$P.maskParent.parentRepaint();
			}
		}
	});

	/**
	*<p>显示对象的高度，单位为像素，默认为0。</p>
	*<p>此高度用于鼠标碰撞检测，并不影响显示对象图像大小。需要对显示对象的图像进行缩放，请使用scale、scaleX、scaleY。</p>
	*<p>可以通过getbounds获取显示对象图像的实际高度。</p>
	*/
	__getset(0,__proto,'height',function(){
		if (!this.autoSize)return this._height;
		return this.getSelfBounds().height;
		},function(value){
		if (this._height!==value){
			this._height=value;
			this.conchModel && this.conchModel.size(this._width,value);
			this.repaint();
		}
	});

	/**指定要使用的混合模式。目前只支持"lighter"。*/
	__getset(0,__proto,'blendMode',function(){
		return this._style.blendMode;
		},function(value){
		this.getStyle().blendMode=value;
		this.conchModel && this.conchModel.blendMode(value);
		if (value && value !="source-over")this._renderType |=0x08;
		else this._renderType &=~0x08;
		this.parentRepaint();
	});

	/**X轴缩放值，默认值为1。设置为负数，可以实现水平反转效果，比如scaleX=-1。*/
	__getset(0,__proto,'scaleX',function(){
		return this._style._tf.scaleX;
		},function(value){
		var style=this.getStyle();
		if (style._tf.scaleX!==value){
			style.setScaleX(value);
			this._tfChanged=true;
			this.conchModel && this.conchModel.scale(value,style._tf.scaleY);
			this._renderType |=0x04;
			var p=this._parent;
			if (p && p._repaint===0){
				p._repaint=1;
				p.parentRepaint();
			}
		}
	});

	/**Y轴缩放值，默认值为1。设置为负数，可以实现垂直反转效果，比如scaleX=-1。*/
	__getset(0,__proto,'scaleY',function(){
		return this._style._tf.scaleY;
		},function(value){
		var style=this.getStyle();
		if (style._tf.scaleY!==value){
			style.setScaleY(value);
			this._tfChanged=true;
			this.conchModel && this.conchModel.scale(style._tf.scaleX,value);
			this._renderType |=0x04;
			var p=this._parent;
			if (p && p._repaint===0){
				p._repaint=1;
				p.parentRepaint();
			}
		}
	});

	/**对舞台 <code>stage</code> 的引用。*/
	__getset(0,__proto,'stage',function(){
		return Laya.stage;
	});

	/**水平倾斜角度，默认值为0。以角度为单位。*/
	__getset(0,__proto,'skewX',function(){
		return this._style._tf.skewX;
		},function(value){
		var style=this.getStyle();
		if (style._tf.skewX!==value){
			style.setSkewX(value);
			this._tfChanged=true;
			this.conchModel && this.conchModel.skew(value,style._tf.skewY);
			this._renderType |=0x04;
			var p=this._parent;
			if (p && p._repaint===0){
				p._repaint=1;
				p.parentRepaint();
			}
		}
	});

	/**
	*<p>显示对象的滚动矩形范围，具有裁剪效果(如果只想限制子对象渲染区域，请使用viewport)，设置optimizeScrollRect=true，可以优化裁剪区域外的内容不进行渲染。</p>
	*<p> srollRect和viewport的区别：<br/>
	*1.srollRect自带裁剪效果，viewport只影响子对象渲染是否渲染，不具有裁剪效果（性能更高）。<br/>
	*2.设置rect的x,y属性均能实现区域滚动效果，但scrollRect会保持0,0点位置不变。</p>
	*/
	__getset(0,__proto,'scrollRect',function(){
		return this._style.scrollRect;
		},function(value){
		this.getStyle().scrollRect=value;
		this.repaint();
		if (value){
			this._renderType |=0x80;
			this.conchModel && this.conchModel.scrollRect(value.x,value.y,value.width,value.height);
			}else {
			this._renderType &=~0x80;
			if (this.conchModel){
				if (Sprite.RUNTIMEVERION < "0.9.1")
					this.conchModel.removeType(0x40);
				else
				this.conchModel.removeType(0x80);
			}
		}
	});

	/**垂直倾斜角度，默认值为0。以角度为单位。*/
	__getset(0,__proto,'skewY',function(){
		return this._style._tf.skewY;
		},function(value){
		var style=this.getStyle();
		if (style._tf.skewY!==value){
			style.setSkewY(value);
			this._tfChanged=true;
			this.conchModel && this.conchModel.skew(style._tf.skewX,value);
			this._renderType |=0x04;
			var p=this._parent;
			if (p && p._repaint===0){
				p._repaint=1;
				p.parentRepaint();
			}
		}
	});

	/**
	*<p>对象的矩阵信息。通过设置矩阵可以实现节点旋转，缩放，位移效果。</p>
	*<p>矩阵更多信息请参考 <code>Matrix</code></p>
	*/
	__getset(0,__proto,'transform',function(){
		return this._tfChanged ? this._adjustTransform():this._transform;
		},function(value){
		this._tfChanged=false;
		this._transform=value;
		if (value){
			this._x=value.tx;
			this._y=value.ty;
			value.tx=value.ty=0;
			this.conchModel && this.conchModel.transform(value.a,value.b,value.c,value.d,this._x,this._y);
		}
		if (value)this._renderType |=0x04;
		else {
			this._renderType &=~0x04;
			this.conchModel && this.conchModel.removeType(0x04);
		}
		this.parentRepaint();
	});

	/**X轴 轴心点的位置，单位为像素，默认为0。轴心点会影响对象位置，缩放中心，旋转中心。*/
	__getset(0,__proto,'pivotX',function(){
		return this._style._tf.translateX;
		},function(value){
		this.getStyle().setTranslateX(value);
		this.conchModel && this.conchModel.pivot(value,this._style._tf.translateY);
		this.repaint();
	});

	/**Y轴 轴心点的位置，单位为像素，默认为0。轴心点会影响对象位置，缩放中心，旋转中心。*/
	__getset(0,__proto,'pivotY',function(){
		return this._style._tf.translateY;
		},function(value){
		this.getStyle().setTranslateY(value);
		this.conchModel && this.conchModel.pivot(this._style._tf.translateX,value);
		this.repaint();
	});

	/**透明度，值为0-1，默认值为1，表示不透明。更改alpha值会影响drawcall。*/
	__getset(0,__proto,'alpha',function(){
		return this._style.alpha;
		},function(value){
		if (this._style && this._style.alpha!==value){
			value=value < 0 ? 0 :(value > 1 ? 1 :value);
			this.getStyle().alpha=value;
			this.conchModel && this.conchModel.alpha(value);
			if (value!==1)this._renderType |=0x02;
			else this._renderType &=~0x02;
			this.parentRepaint();
		}
	});

	/**表示是否可见，默认为true。如果设置不可见，节点将不被渲染。*/
	__getset(0,__proto,'visible',function(){
		return this._style.visible;
		},function(value){
		if (this._style && this._style.visible!==value){
			this.getStyle().visible=value;
			this.conchModel && this.conchModel.visible(value);
			this.parentRepaint();
		}
	});

	/**绘图对象。封装了绘制位图和矢量图的接口，Sprite所有的绘图操作都通过Graphics来实现的。*/
	__getset(0,__proto,'graphics',function(){
		return this._graphics || (this.graphics=RunDriver.createGraphics());
		},function(value){
		if (this._graphics)this._graphics._sp=null;
		this._graphics=value;
		if (value){
			this._renderType &=~0x01;
			this._renderType |=0x200;
			value._sp=this;
			this.conchModel && this.conchModel.graphics(this._graphics);
			}else {
			this._renderType &=~0x200;
			this._renderType &=~0x01;
			if (this.conchModel){
				if (Sprite.RUNTIMEVERION < "0.9.1")
					this.conchModel.removeType(0x100);
				else
				this.conchModel.removeType(0x200);
			}
		}
		this.repaint();
	});

	/**滤镜集合。可以设置多个滤镜组合。*/
	__getset(0,__proto,'filters',function(){
		return this._$P.filters;
		},function(value){
		value && value.length===0 && (value=null);
		if (this._$P.filters==value)return;
		this._set$P("filters",value ? value.slice():null);
		if (Render.isConchApp){
			if (this.conchModel){
				if (Sprite.RUNTIMEVERION < "0.9.1")
					this.conchModel.removeType(0x10);
				else
				this.conchModel.removeType(0x20);
			}
			if (this._$P.filters && this._$P.filters.length==1){
				this._$P.filters[0].callNative(this);
			}
		}
		if (Render.isWebGL){
			if (value && value.length){
				this._renderType |=0x20;
				}else {
				this._renderType &=~0x20;
			}
		}
		if (value && value.length > 0){
			if (!this._getBit(0x1))this._setUpNoticeType(0x1);
			if (!(Render.isWebGL && value.length==1 && (((value[0])instanceof laya.filters.ColorFilter )))){
				if (this.cacheAs !="bitmap"){
					if (!Render.isConchNode)this.cacheAs="bitmap";
					this._set$P("cacheForFilters",true);
				}
				this._set$P("hasFilter",true);
			}
			}else {
			this._set$P("hasFilter",false);
			if (this._$P["cacheForFilters"] && this.cacheAs=="bitmap"){
				this.cacheAs="none";
			}
		}
		this.repaint();
	});

	__getset(0,__proto,'parent',_super.prototype._$get_parent,function(value){
		Laya.superSet(Node,this,'parent',value);
		if (value && this._getBit(0x2)){
			this._$2__onDisplay();
		}
	});

	/**
	*<p>遮罩，可以设置一个对象(支持位图和矢量图)，根据对象形状进行遮罩显示。</p>
	*<p>【注意】遮罩对象坐标系是相对遮罩对象本身的，和Flash机制不同</p>
	*/
	__getset(0,__proto,'mask',function(){
		return this._$P._mask;
		},function(value){
		if (value && this.mask && this.mask._$P.maskParent)return;
		if (value){
			this.cacheAs="bitmap";
			this._set$P("_mask",value);
			value._set$P("maskParent",this);
			}else {
			this.mask && this.mask._set$P("maskParent",null);
			this._set$P("_mask",value);
			this.cacheAs="none";
		}
		this.conchModel && this.conchModel.mask(value ? value.conchModel :null);
		this._renderType |=0x40;
		this.parentRepaint();
	});

	/**
	*是否接受鼠标事件。
	*默认为false，如果监听鼠标事件，则会自动设置本对象及父节点的属性 mouseEnable 的值都为 true（如果父节点手动设置为false，则不会更改）。
	**/
	__getset(0,__proto,'mouseEnabled',function(){
		return this._mouseEnableState > 1;
		},function(value){
		this._mouseEnableState=value ? 2 :1;
	});

	/**
	*获得相对于stage的全局X轴缩放值（会叠加父亲节点的缩放值）。
	*/
	__getset(0,__proto,'globalScaleX',function(){
		var scale=1;
		var ele=this;
		while (ele){
			if (ele===Laya.stage)break ;
			scale *=ele.scaleX;
			ele=ele.parent;
		}
		return scale;
	});

	/**
	*返回鼠标在此对象坐标系上的 X 轴坐标信息。
	*/
	__getset(0,__proto,'mouseX',function(){
		return this.getMousePoint().x;
	});

	/**
	*返回鼠标在此对象坐标系上的 Y 轴坐标信息。
	*/
	__getset(0,__proto,'mouseY',function(){
		return this.getMousePoint().y;
	});

	Sprite.fromImage=function(url){
		return new Sprite().loadImage(url);
	}

	Sprite.CustomList=[];
	__static(Sprite,
	['RUNTIMEVERION',function(){return this.RUNTIMEVERION=window.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf('-')+1):'';}
	]);
	return Sprite;
})(Node)


//class fight.NormalAttack extends fight.TimerClass
var NormalAttack=(function(_super){
	function NormalAttack(){
		this.atk=null;
		this.def=null;
		this.skillId=0;
		NormalAttack.__super.call(this);
		this.startPo=new Point();
	}

	__class(NormalAttack,'fight.NormalAttack',_super);
	var __proto=NormalAttack.prototype;
	__proto.start=function(atk,def,skillId){
		this.skillId=skillId;
		this.def=def;
		this.atk=atk;
		var xx=0;
		var yy=0;
		if(atk.getDir()==0){
			xx=def.getDpo().x+90;
			yy=def.getDpo().y-60;
			}else{
			xx=def.getDpo().x-100;
			yy=def.getDpo().y+45;
			if((def instanceof fight.Wall )){
				xx=def.getDpo().x-200;
			}
		}
		atk.move();
		atk.zTop();
		this.startPo.setTo(atk.x,atk.y);
		this.scaleManager.tween(atk,{x:xx,y:yy},300,null,new Handler(this,this.moveOver));
	}

	__proto.moveOver=function(){
		this.scaleManager.addTimer(50,this,this.delayFun);
	}

	__proto.delayFun=function(){
		this.atk.attack();
		this.scaleManager.addTimer(600,this,this.attackOver);
		this.scaleManager.addTimer(500,this,this.defFun);
	}

	//播放挨打动画
	__proto.defFun=function(){
		this.def.hitEffectSkillId(1);
		this.event("HIT");
		BattleFileScene.playSound(1);
	}

	__proto.attackOver=function(){
		this.atk.move();
		this.scaleManager.tween(this.atk,{x:this.startPo.x,y:this.startPo.y},300,null,new Handler(this,this.backOver));
	}

	__proto.backOver=function(){
		this.atk.pos(this.startPo.x,this.startPo.y);
		this.atk.stand();
		this.atk.zBack();
	}

	NormalAttack.MOVE_TIME=300;
	NormalAttack.SKILL_ID=1;
	return NormalAttack;
})(TimerClass)


//class fight.RemoteAttack extends fight.TimerClass
var RemoteAttack=(function(_super){
	function RemoteAttack(){
		this.defDpo=null;
		RemoteAttack.__super.call(this);
	}

	__class(RemoteAttack,'fight.RemoteAttack',_super);
	var __proto=RemoteAttack.prototype;
	__proto.start=function(atkDpo,defDpo,time,skillId){
		this.defDpo=defDpo;
		atkDpo.attack();
		this.scaleManager.addTimer(time,this,this.hitFun,[skillId]);
	}

	__proto.hitFun=function(skillId){
		this.defDpo.hitEffectSkillId(skillId);
		this.event("HIT");
		BattleFileScene.playSound(3);
	}

	return RemoteAttack;
})(TimerClass)


//class fight.Shoot extends fight.TimerClass
var Shoot=(function(_super){
	function Shoot(){
		Shoot.__super.call(this);
	}

	__class(Shoot,'fight.Shoot',_super);
	var __proto=Shoot.prototype;
	/**
	*
	*@param atk
	*@param def
	*@param time
	*@param skillId
	*@param layer
	*@param shootType 射出去的物品是啥
	*/
	__proto.start=function(atk,def,time,skillId,layer,shootType){
		atk.attack();
		for (var i=0;i < atk.heroModel.disUI.numChildren;i++){
			var shootIMG=ShootIMG.getNew();
			shootIMG.setShootDpo(shootType);
			shootIMG.start(atk.heroModel.disUI.getChildAt(i),atk,def,layer);
		}
		this.scaleManager.addTimer(time,this,this.hitFun,[def,skillId]);
		if(shootType==4){
			BattleFileScene.playSound(4);
			}else{
			BattleFileScene.playSound(2);
		}
	}

	__proto.hitFunSend=function(){
		this.event("HIT");
	}

	__proto.hitFun=function(def,skillId){
		def.hitEffectSkillId(skillId);
		Laya.timer.callLater(this,this.hitFunSend);
	}

	return Shoot;
})(TimerClass)


//class fight.Skill extends fight.TimerClass
var Skill=(function(_super){
	function Skill(){
		this.heroArr=null;
		this.atkData=null;
		this.sp=null;
		this.sysSkillEffect=null;
		this.sysSkill=null;
		//3是打一竖排 2个
		this.skillCol={};
		this.skillRow={};
		this.skillAll={};
		this.type2obj=[];
		Skill.__super.call(this);
		this.type2obj[1]=this.skillCol;
		this.type2obj[2]=this.skillRow;
		this.type2obj[3]=this.skillAll;
		this.skillCol[2]=2;
		this.skillCol[5]=2;
		this.skillCol[1]=1;
		this.skillCol[4]=1;
		this.skillCol[0]=0;
		this.skillCol[3]=0;
		this.skillCol[6]=6;
		this.skillCol[9]=6;
		this.skillCol[7]=7;
		this.skillCol[10]=7;
		this.skillCol[8]=8;
		this.skillCol[11]=8;
		this.skillRow[6]=7;
		this.skillRow[7]=7;
		this.skillRow[8]=7;
		this.skillRow[9]=10;
		this.skillRow[10]=10;
		this.skillRow[11]=10;
		this.skillRow[0]=1;
		this.skillRow[1]=1;
		this.skillRow[2]=1;
		this.skillRow[3]=4;
		this.skillRow[4]=4;
		this.skillRow[5]=4;
		this.skillAll[0]=3;
		this.skillAll[1]=3;
		this.skillAll[2]=3;
		this.skillAll[3]=3;
		this.skillAll[4]=3;
		this.skillAll[5]=3;
		this.skillAll[6]=6;
		this.skillAll[7]=6;
		this.skillAll[8]=6;
		this.skillAll[9]=6;
		this.skillAll[10]=6;
		this.skillAll[11]=6;
	}

	__class(Skill,'fight.Skill',_super);
	var __proto=Skill.prototype;
	__proto.setAll=function(heroArr){
		this.heroArr=heroArr;
	}

	__proto.playSkill=function(atkData){
		this.atkData=atkData;
		this.sysSkill=ConfigManager.getConfig("sys_skill.txt",atkData.skillId);
		this.sysSkillEffect=ConfigManager.getConfig("sys_skill_effect.txt",this.sysSkill.skillEffect);
		var b=this.heroArr[atkData.heroIndex];
		b.addEffectByAni("buffDischarge");
		App.voiceManager.playSound("1030.wav");
		this.scaleManager.addTimer(1000,this,this.skillEffect);
	}

	__proto.skillEffect=function(){
		var b=this.heroArr[this.atkData.heroIndex];
		b.discharge();
		if(this.sysSkillEffect==null){
			this.event("HIT");
			return;
		}
		if(this.sysSkillEffect.effectRange==0){
			this.skillOne();
			}else{
			this.skillRange();
		}
		this.scaleManager.addTimer(300,this,this.sendEvent);
		App.voiceManager.playSound(this.sysSkillEffect.effectSound+".wav");
	}

	__proto.skillOne=function(){
		for (var i=0;i < this.atkData.defArr.length;i++){
			var heroIndex=this.atkData.defArr[i];
			var dpo=this.heroArr[heroIndex];
			dpo.addSkillEffect(this.atkData.skillId);
		}
	}

	__proto.skillRange=function(){
		var sysSkill=ConfigManager.getConfig("sys_skill.txt",this.atkData.skillId);
		var skillDpo=new SkillDpo();
		skillDpo.setSkillId(this.atkData.skillId);
		Skill.layer.addChild(skillDpo);
		var heroIndex=this.atkData.defArr[0];
		var boxIndex=this.type2obj[this.sysSkillEffect.effectRange][heroIndex];
		this.setBox(boxIndex,skillDpo);
	}

	//skillDpo.y-=10;
	__proto.setBox=function(boxIndex,dpo){
		var box=BattleFileScene.instance["box"+boxIndex];
		dpo.pos(box.x,box.y);
	}

	__proto.sendEvent=function(){
		for (var i=0;i < this.atkData.defArr.length;i++){
			var heroIndex=this.atkData.defArr[i];
			var dpo=this.heroArr[heroIndex];
			dpo.hitEffectSkillId(this.atkData.skillId);
		}
		this.event("HIT");
	}

	Skill.layer=null;
	Skill.ATTACK_ROW=0;
	Skill.ATTACK_COL=1;
	Skill.ATTACK_ALL=2;
	Skill.RANGE_TYPE_SELF=0;
	Skill.RANGE_TYPE_ENEMY_FRONT=1;
	Skill.RANGE_TYPE_ENEMY_BACK=2;
	Skill.RANGE_TYPE_ENEMY_COL=3;
	Skill.RANGE_TYPE_ENEMY_ROW=4;
	Skill.RANGE_TYPE_ENEMY_ALL=5;
	Skill.RANGE_TYPE_SELF_FRONT=6;
	Skill.RANGE_TYPE_SELF_BACK=7;
	Skill.RANGE_TYPE_SELF_COL=8;
	Skill.RANGE_TYPE_SELF_ROW=9;
	Skill.RANGE_TYPE_SELF_ALL=10;
	Skill.RANGE_TYPE_SELF_ALL_FRIEND=11;
	Skill.hhh=0;
	return Skill;
})(TimerClass)


//class fight.Wall extends fight.TimerClass
var Wall=(function(_super){
	function Wall(dpo,hitDpo){
		this.hp=0;
		this.dpo=null;
		this.hitDpo=null;
		this.hit1=null;
		this.hit2=null;
		Wall.__super.call(this);
		this.hitDpo=hitDpo;
		this.dpo=dpo;
		hitDpo.on("display",this,this.displayFun);
	}

	__class(Wall,'fight.Wall',_super);
	var __proto=Wall.prototype;
	Laya.imps(__proto,{"fight.IBattleDpo":true})
	//有的时候 一进游戏 城墙就是红的 有问题
	__proto.displayFun=function(){
		this.colorFun();
	}

	/**
	*被人打到的时候
	*/
	__proto.hitFun=function(){
		this.setFilter(BattleHeroDpo.RED_FILTER);
		this.scaleManager.addTimer(100,this,this.colorFun);
	}

	__proto.colorFun=function(){
		this.setFilter(BattleHeroDpo.NORMAL_FILTER);
	}

	__proto.hitEffectSkillId=function(skillId){
		var hitEffectDpo=new HitEffectDpo();
		var effectlayer=BattleFileScene.instance.effectlayer;
		effectlayer.addChild(hitEffectDpo);
		hitEffectDpo.setSkillId(skillId);
		var po=this.dpo.localToGlobal(new Point());
		hitEffectDpo.pos(this.dpo.x-80 ,this.dpo.y);
		this.hitFun();
	}

	__proto.addEffectByAni=function(ani){
		var hitEffectDpo=new HitEffectDpo();
		hitEffectDpo.addEffectAni(ani);
		var effectlayer=BattleFileScene.instance.effectlayer;
		effectlayer.addChild(hitEffectDpo);
		hitEffectDpo.x=this.dpo.x-85;
		hitEffectDpo.y=this.dpo.y;
	}

	__proto.setFilter=function(arr){
		this.hitDpo.visible=(arr==BattleHeroDpo.RED_FILTER);
	}

	//hit2.filters=arr;
	__proto.getDpo=function(){
		return this.dpo;
	}

	__proto.getDir=function(){
		return 1;
	}

	return Wall;
})(TimerClass)


//class game.base.manager.SocketManager extends laya.net.Socket
var SocketManager=(function(_super){
	function SocketManager(){
		this.host=null;
		this.port=0;
		this.datalen=-1;
		/**
		*心跳丢失次数
		*/
		this.missTime=0;
		this.sendByte=new Byte();
		this.maoByte=new Byte();
		this.receiveBa=new ByteArray();
		SocketManager.__super.call(this,null,0,ByteArray);
		this.endian="littleEndian";
		this.sendByte.endian=this.endian;
		this.receiveBa.endian=this.endian;
		this.maoByte.endian=this.endian;
		this.on("open",this,this.openFun);
		this.on("message",this,this.messageFun);
		this.on("close",this,this.closeFun);
		this.on("error",this,this.errorFun);
	}

	__class(SocketManager,'game.base.manager.SocketManager',_super);
	var __proto=SocketManager.prototype;
	/**
	*根据配置文件 连接服务器
	*/
	__proto.connectByConfig=function(){
		this.connectServer(App.configJson["serverIp"],App.configJson["serverPort"]);
	}

	__proto.connectServer=function(host,port){
		this.port=port;
		this.host=host;
		this.connect(host,port);
	}

	/**
	*主动关闭服务器
	*/
	__proto.closeSocket=function(){
		this.close();
		this.stopHeart();
		App.eventManager.event("SOCKET_CLOSE");
	}

	__proto.reConnect=function(){
		this.connect(this.host,this.port);
	}

	__proto.errorFun=function(){
		console.log("socket error");
	}

	__proto.closeFun=function(){
		console.log("socket close");
		App.eventManager.event("SOCKET_CLOSE_ACTIVE");
	}

	__proto.openFun=function(){
		App.eventManager.event("CONNECT_SERVER_OK");
		this.startHeart();
		this.clearTryConnect();
	}

	/**
	*开始检测心跳
	*/
	__proto.startHeart=function(){
		this.missTime=0;
		Laya.timer.loop(SocketManager.HEART,this,this.heartFun);
	}

	/**
	*停止心跳
	*/
	__proto.stopHeart=function(){
		this.missTime=0;
		Laya.timer.clear(this,this.heartFun);
	}

	__proto.heartFun=function(){
		if(this.missTime > SocketManager.MAX_MISS_TIMES){
			App.eventManager.event("NET_CLOSE");
			this.stopHeart();
			this.netBroken();
			return;
		}
		this.missTime++;
		this.sendByte.clear();
		this.sendByte.writeInt32(SocketManager.HEART_ACTION_ID);
		this.sendToServer();
	}

	/**
	*网断了 开始尝试连接
	*/
	__proto.netBroken=function(){
		Laya.timer.once(SocketManager.MAX_TRY_TIME,this,this.connectFailedFun);
		Laya.timer.loop(SocketManager.EVERY_TRY_TIME,this,this.tryConnectFun);
	}

	/**
	*尝试一次重连
	*/
	__proto.tryConnectFun=function(){
		if(SocketManager.isReconnection){
			this.reConnect();
		}
		App.eventManager.event("CONNECT_TRY_ONE");
	}

	/**
	*清除重连占用的资源 监听的事件
	*/
	__proto.clearTryConnect=function(){
		Laya.timer.clear(this,this.connectFailedFun);
		Laya.timer.clear(this,this.tryConnectFun);
	}

	/**
	*最终连接失败 不再尝试
	*/
	__proto.connectFailedFun=function(){
		this.clearTryConnect();
		this.closeSocket();
		App.eventManager.event("TRY_CONNECT_FAILED");
	}

	__proto.messageFun=function(message){
		this.input.position=0;
		while(this.input.bytesAvailable){
			if(this.datalen<0){
				if(this.input.bytesAvailable>=4){
					this.datalen=this.input.readInt();
				}
			}
			else{
				if(this.input.bytesAvailable>=this.datalen){
					this.receiveBa.clear();
					this.input.readBytes(this.receiveBa,0,this.datalen);
					this.datalen=-1;
					this.receiveBa.position=0;
					this.exeAction(this.receiveBa);
					}else{
					break ;
				}
			}
		}
	}

	__proto.sendToServer=function(){
		this.maoByte.writeInt32(this.sendByte.length);
		this.send(this.maoByte.buffer);
		this.send(this.sendByte.buffer);
		this.flush();
		this.maoByte.clear();
		this.sendByte.clear();
	}

	__proto.exeAction=function(ba){
		var actionId=ba.readInt();
		if(actionId==SocketManager.HEART_ACTION_ID){
			this.missTime=0;
			return;
		}
		if(App.getAction(actionId)){
			App.getAction(actionId).execute(ba);
			}else {
			console.log("忘记注册actionId："+actionId);
		}
	}

	SocketManager.HEART=5000;
	SocketManager.HEART_ACTION_ID=0;
	SocketManager.MAX_TRY_TIME=15 *1000;
	SocketManager.EVERY_TRY_TIME=5 *1000;
	SocketManager.isReconnection=true;
	SocketManager.MAX_MISS_TIMES=2;
	return SocketManager;
})(Socket)


//class game.base.initcmd.InitAllRegCMD extends game.mvc.OrderCommand
var InitAllRegCMD=(function(_super){
	function InitAllRegCMD(){
		InitAllRegCMD.__super.call(this);
	}

	__class(InitAllRegCMD,'game.base.initcmd.InitAllRegCMD',_super);
	var __proto=InitAllRegCMD.prototype;
	__proto.execute=function(data){
		App.INIT(data);
		OrderCommand.nextStep();
	}

	return InitAllRegCMD;
})(OrderCommand)


//class game.base.initcmd.LoadConfigTxtCMD extends game.mvc.OrderCommand
var LoadConfigTxtCMD=(function(_super){
	function LoadConfigTxtCMD(){
		LoadConfigTxtCMD.__super.call(this);
		if(Browser.window.config==null){
			App.loaderManager.load("","config.json",new Handler(this,this.overFun),null,"json");
			}else{
			Laya.timer.callLater(this,this.timerFun);
		}
	}

	__class(LoadConfigTxtCMD,'game.base.initcmd.LoadConfigTxtCMD',_super);
	var __proto=LoadConfigTxtCMD.prototype;
	__proto.timerFun=function(){
		var json=Browser.window.config;
		var obj={};
		obj["masterServer"]=json["masterServer"];
		obj["md5Ip"]=json["md5Ip"];
		obj["gmIp"]=json["gmIp"];
		json[ json["platformId"]]=obj;
		App.configJson=json;
		App.eventManager.event("CONFIG_TXT_OVER");
		OrderCommand.nextStep();
	}

	__proto.overFun=function(json){
		App.configJson=json;
		App.eventManager.event("CONFIG_TXT_OVER");
		OrderCommand.nextStep();
	}

	return LoadConfigTxtCMD;
})(OrderCommand)


//class game.base.initcmd.LoadConfigZipCMD extends game.mvc.OrderCommand
var LoadConfigZipCMD=(function(_super){
	function LoadConfigZipCMD(){
		LoadConfigZipCMD.__super.call(this);
		Laya.loader.load("config.cba",new Handler(this,this.comFun1),null,"arraybuffer");
	}

	__class(LoadConfigZipCMD,'game.base.initcmd.LoadConfigZipCMD',_super);
	var __proto=LoadConfigZipCMD.prototype;
	// Laya.loader.load("config.cba",new Handler(this,comFun1),null,Loader.BUFFER);
	__proto.comFun1=function(ab){
		var byteArray=new ByteArray();
		byteArray.writeArrayBuffer(ab);
		byteArray.position=0;
		byteArray.uncompress();
		var len=byteArray.readInt();
		var arr=[];
		for(var i=0;i < len;i++){
			var name=byteArray.readUTF();
			arr.push(name);
			var len2=byteArray.readInt();
			var ba2=new ByteArray();
			byteArray.readBytes(ba2,0,len2);
			ba2.position=0;
			var content=ba2.readUTFBytes(len2);
			arr.push(content);
		}
		ConfigManager.fun(arr);
		App.eventManager.event("SYS_CONFIG_OVER");
		this.overFun();
	}

	__proto.comFun=function(ab){
		var byteArray=new ByteArray();
		byteArray.writeArrayBuffer(ab);
		byteArray.position=0;
		byteArray.uncompress();
		var arr=[];
		while(byteArray.bytesAvailable){
			var len=byteArray.readInt();
			var name=byteArray.readUTF();
			var ba2=new ByteArray();
			byteArray.readBytes(ba2,0,len);
			ba2.position=0;
			var content=ba2.readUTFBytes(len);
			arr.push(name);
			arr.push(content);
			if(name=="sys_tips.txt"){
				console.log(name+"========================================");
				console.log(content);
			}
		}
		ConfigManager.fun(arr);
		App.eventManager.event("SYS_CONFIG_OVER");
		this.overFun();
	}

	__proto.overFun=function(){
		OrderCommand.nextStep();
	}

	return LoadConfigZipCMD;
})(OrderCommand)


//class game.base.initcmd.LoadUIJsonCMD extends game.mvc.OrderCommand
var LoadUIJsonCMD=(function(_super){
	function LoadUIJsonCMD(){
		LoadUIJsonCMD.__super.call(this);
		Laya.loader.load("ui.json",new Handler(this,this.jsonOverFun));
	}

	__class(LoadUIJsonCMD,'game.base.initcmd.LoadUIJsonCMD',_super);
	var __proto=LoadUIJsonCMD.prototype;
	__proto.jsonOverFun=function(json){
		LoadUIJsonCMD.overFun(json);
	}

	LoadUIJsonCMD.zipOverFun=function(arr){
		LoadUIJsonCMD.overFun(JSON.parse(arr[1]));
	}

	LoadUIJsonCMD.overFun=function(json){
		View.uiMap=json;
		App.eventManager.event("UI_JSON_OVER");
		OrderCommand.nextStep();
	}

	return LoadUIJsonCMD;
})(OrderCommand)


//class huamao.action.ActivityAction extends game.mvc.Action
var ActivityAction=(function(_super){
	function ActivityAction(){
		this.activitySession=null;
		ActivityAction.__super.call(this);
	}

	__class(ActivityAction,'huamao.action.ActivityAction',_super);
	var __proto=ActivityAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		switch (type){
			case 1:
				this.activitySession.closeActivityObj();
				var len=ba.readInt();
				for(var i=0;i<len;i++){
					this.readData(ba);
				}
				App.eventManager.event("HUODONGUPDATA");
				App.eventManager.event("REAPOINT",RedPointType.HUODONG);
				break ;
			case 2:
				this.readData(ba);
				App.eventManager.event("HUODONGUPDATA");
				App.eventManager.event("REAPOINT",RedPointType.HUODONG);
				break ;
			}
	}

	__proto.readData=function(ba){
		var data=new ActivityData();
		data.activityId=ba.readInt();
		data.activityType=ba.readInt();
		data.tarGetStatus=ba.readUTF();
		data.rewardStatus=ba.readInt();
		data.endTime=ba.readInt();
		this.activitySession.addActivity(data);
	}

	__proto.sendGoumai=function(){
		this.startByAction();
		this.putByte(4);
		this.send();
	}

	__proto.sendLingQu=function(id){
		this.startByAction();
		this.putByte(3);
		this.putInt(id);
		this.send();
	}

	__proto.sendKaBaoLingQu=function(id){
		this.startByAction();
		this.putByte(5);
		this.putInt(id);
		this.send();
	}

	return ActivityAction;
})(Action)


//class huamao.action.ArmsAction extends game.mvc.Action
var ArmsAction=(function(_super){
	function ArmsAction(){
		ArmsAction.__super.call(this);
	}

	__class(ArmsAction,'huamao.action.ArmsAction',_super);
	var __proto=ArmsAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		var heroId=ba.readInt();
		var armsId=ba.readInt();
		if(type==0){
			App.eventManager.event("ZHUAN_ZHI_SUCCESS");
			}else if(type==1){
			App.eventManager.event("STUDY_SUCCESS");
			}else if(type==2){
			App.eventManager.event("UNLOCK_SOLDIER_SUCCESS");
		}
	}

	//ifgold:0元宝转职 1：虎符解锁
	__proto.sendArms=function(heroId,armsId,ifgold){
		this.startByAction();
		this.putByte(0);
		this.putInt(heroId);
		this.putInt(armsId);
		this.putInt(ifgold);
		this.send();
	}

	__proto.sendStudy=function(heroId,armsId){
		this.startByAction();
		this.putByte(1);
		this.putInt(heroId);
		this.putInt(armsId);
		this.send();
	}

	//ifgold:0元宝解锁 1：兵书解锁
	__proto.sendUnlockSoldier=function(heroId,armsId,ifgold){
		this.startByAction();
		this.putByte(2);
		this.putInt(heroId);
		this.putInt(armsId);
		this.putInt(ifgold);
		this.send();
	}

	ArmsAction.TRANSFER=0;
	ArmsAction.STUDY=1;
	ArmsAction.UNLOCK=2;
	return ArmsAction;
})(Action)


//class huamao.action.BagAction extends game.mvc.Action
var BagAction=(function(_super){
	function BagAction(){
		this.bagSession=null;
		BagAction.__super.call(this);
		App.injOne(this);
	}

	__class(BagAction,'huamao.action.BagAction',_super);
	var __proto=BagAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readInt();
		console.log("bagaction type = "+type);
		if(type==0){
			this.bagSession.clearAll();
			var size=ba.readInt();
			for(var i=0;i<size;i++){
				var data=new BagItemData();
				data.onlyId=ba.readInt();
				data.playerId=ba.readInt();
				data.heroId=ba.readInt();
				data.itemId=ba.readInt();
				data.itemNum=ba.readInt();
				data.isLock=ba.readInt();
				data.lv=ba.readInt();
				data.overTime=ba.readInt();
				this.bagSession.setData(data);
			}
			this.bagSession.checkToFlush();
			}else if(type==1 || type==4 || type==5){
			this.oneItemDone(ba,type);
			}else if(type==2){
			var ary=[];
			var fromItemid=ba.readInt();
			size=ba.readInt();
			for(i=0;i<size;i++){
				var getid=ba.readInt();
				var getnum=ba.readInt();
				var ifadd=true;
				for(var j=0;j<ary.length;j+=2){
					if(getid==ary[j]){
						ary[j+1]+=getnum
						ifadd=false;
						break ;
					}
				}
				if(ifadd){
					ary.push(getid);
					ary.push(getnum);
				}
			}
			if(fromItemid==0){
				var str=this.getTipsStr(ary);
				FlyUpTips.setTips(str);
				}else{
				var sysitem=SysItem.getDataFromItemId(fromItemid);
				if(ary.length > 2){
					var tips=App.dialogManager.showMiniDialog(TipsGetItem,true,false);
					tips.setData(fromItemid,ary);
					}else{
					if(sysitem.itemTipsType==0){
						str=this.getTipsStr(ary);
						FlyUpTips.setTips(str);
						}else{
						tips=App.dialogManager.showMiniDialog(TipsGetItem,true,false);
						tips.setData(fromItemid,ary);
					}
				}
			}
			}else if(type==10){
			var lv=ba.readInt();
			FlyUpTips.setTips("装备成功强化至+"+lv);
			}else if(type==3){
			var sellId=ba.readInt();
			var sellNum=ba.readInt();
			var getId=ba.readInt();
			var getNum=ba.readInt();
			sysitem=ConfigManager.getConfig("sys_item.txt",sellId);
			if(sysitem !=null){
				var name=sysitem.itemName;
				var str1="获得"+getNum+"个银两";
				var str2="卖出："+name;
				var str3=TheGame.FONT(str1,"#ffffff",22,null)+"<br>"+TheGame.FONT(str2,"#ff0000",22,null);
				FlyUpTips.setHtml(str3);
			}
		}
	}

	__proto.oneItemDone=function(ba,type){
		var data=data=new BagItemData();
		data.onlyId=ba.readInt();
		data.playerId=ba.readInt();
		data.heroId=ba.readInt();
		data.itemId=ba.readInt();
		data.itemNum=ba.readInt();
		data.lv=ba.readInt();
		data.isLock=ba.readInt();
		data.overTime=ba.readInt();
		if(type==1){
			this.bagSession.flushOneData(data);
			}else if(type==4){
			this.bagSession.setData(data);
			this.bagSession.checkToFlush();
			}else if(type==5){
			this.bagSession.delData(data);
			this.bagSession.checkToFlush();
		}
	}

	__proto.getTipsStr=function(ary){
		var itemid=ary[0];
		var itemNum=ary[1];
		var name="";
		var sysitem=SysItem.getDataFromItemId(itemid);
		if(sysitem){
			return "获得 "+itemNum+"个"+sysitem.itemName;
			}else{
			var syshero=ConfigManager.getConfig("sys_hero.txt",itemNum);
			return "获得 "+1+"个"+syshero.heroName;
		}
	}

	//SysItem.getDataFromItemId(itemid).itemName;
	__proto.sendUseItem=function(onlyId,num){
		this.startByAction();
		this.putInt(0);
		this.putInt(onlyId);
		this.putInt(num);
		this.send();
	}

	__proto.sellEquip=function(onlyId){
		this.startByAction();
		this.putInt(1);
		this.putInt(onlyId);
		this.send();
	}

	//强化
	__proto.sendStronger=function(onlyId){
		this.startByAction();
		this.putInt(2);
		this.putInt(onlyId);
		this.send();
	}

	__proto.sendFenJie=function(onlyId){
		this.startByAction();
		this.putInt(3);
		this.putInt(onlyId);
		this.send();
	}

	__proto.sendSuoEquip=function(onlyId,suo){
		this.startByAction();
		this.putInt(4);
		this.putInt(onlyId);
		this.putInt(suo);
		this.send();
	}

	__proto.sendAllEquipBuyColor=function(color){
		this.startByAction();
		this.putInt(5);
		this.putInt(color);
		this.send();
	}

	BagAction.ITEM_USE=0;
	BagAction.EQUIP_SELL=1;
	BagAction.EQUIP_STRONGER=2;
	BagAction.EQUIP_FENJIE=3;
	BagAction.EQUIP_SUO=4;
	BagAction.EQUIP_SELL_BUY_COLOR=5;
	BagAction.flushAll=0;
	BagAction.flushOne=1;
	BagAction.flushTips=2;
	BagAction.sellSuc=3;
	BagAction.addOne=4;
	BagAction.delOne=5;
	BagAction.STRONGER_TIPS=10;
	return BagAction;
})(Action)


//class huamao.action.BannedAction extends game.mvc.Action
var BannedAction=(function(_super){
	function BannedAction(){
		BannedAction.__super.call(this);
		App.injOne(this);
	}

	__class(BannedAction,'huamao.action.BannedAction',_super);
	var __proto=BannedAction.prototype;
	__proto.execute=function(ba){
		FlyUpTips.setTips("因您的账号存在违规操作,现被永久封停");
		Laya.timer.once(2000,this,this.timeFun);
	}

	__proto.timeFun=function(){
		App.reload();
	}

	BannedAction.BANNED_TIPS="因您的账号存在违规操作,现被永久封停";
	return BannedAction;
})(Action)


//class huamao.action.ChangeServerAction extends game.mvc.Action
var ChangeServerAction=(function(_super){
	function ChangeServerAction(){
		this.loginSession=null;
		ChangeServerAction.__super.call(this);
	}

	__class(ChangeServerAction,'huamao.action.ChangeServerAction',_super);
	var __proto=ChangeServerAction.prototype;
	__proto.execute=function(ba){
		var ip=ba.readUTF();
		var port=ba.readInt();
		var token=ba.readUTF();
		App.socketManager.closeSocket();
		this.loginSession.connectServer(token,ip,port);
	}

	return ChangeServerAction;
})(Action)


//class huamao.action.DuoBaoAction extends game.mvc.Action
var DuoBaoAction=(function(_super){
	function DuoBaoAction(){
		this.duoBaoSession=null;
		this.bagSession=null;
		DuoBaoAction.__super.call(this);
		App.injOne(this);
	}

	__class(DuoBaoAction,'huamao.action.DuoBaoAction',_super);
	var __proto=DuoBaoAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readInt();
		if(type==1){
			this.duoBaoSession.duoBaoData.length=0;
			var remAllTimes=ba.readInt();
			var dayTimes=ba.readInt();
			var endTime=ba.readInt();
			var luckBox=ba.readUTF();
			var log=ba.readUTF();
			var juanNum=this.bagSession.getItemNumByItemId(10606);
			var duoBaoData=new DuoBaoData();
			duoBaoData.weekBaoXiangNum=remAllTimes;
			duoBaoData.freeJuan=dayTimes;
			duoBaoData.activityTime=endTime;
			duoBaoData.drawAwardLog=log;
			duoBaoData.drawBoxLog=luckBox;
			duoBaoData.juanNum=juanNum;
			if(endTime!=0 && endTime>GameUtils.GetServerTime()){
				this.duoBaoSession.duoBaoData.push(duoBaoData);
			}
			this.duoBaoSession.drawListArr.length=0;
			var item=log.split(";");
			for (var j=item.length-1;j >=0;j--){
				this.duoBaoSession.drawListArr.push(item[j]);
			}
			App.eventManager.event("DUOBAOFlUSH");
			App.eventManager.event("DUOBAOFlUSH");
			App.eventManager.event("REAPOINT",RedPointType.HUODONG);
			}else if(type==2){
			this.duoBaoSession.drawArr.length=0;
			var num=ba.readInt();
			for (var i=0;i < num;i++){
				var numid=ba.readInt();
				console.log("numid:"+numid);
				this.duoBaoSession.drawArr.push(numid);
			}
			App.eventManager.event("DUOBAOBACK",[num]);
			}else if(type==3){
			var num1=ba.readInt()
			App.eventManager.event("DUOBAOADDJUAN",[num1]);
		}
	}

	__proto.onDuoBaoGift=function(taskid){
		this.startByAction();
		this.putInt(DuoBaoAction.duoBao);
		this.putInt(taskid);
		this.send();
	}

	__proto.onBuyGift=function(taskid){
		this.startByAction();
		this.putInt(DuoBaoAction.duoBaoLingQu);
		this.putInt(taskid);
		this.send();
	}

	__proto.onMaiJuan=function(Juannum){
		this.startByAction();
		this.putInt(DuoBaoAction.duoBaoMaiJuan);
		this.putInt(Juannum);
		this.send();
	}

	DuoBaoAction.duoBao=1;
	DuoBaoAction.duoBaoLingQu=2;
	DuoBaoAction.duoBaoMaiJuan=3;
	return DuoBaoAction;
})(Action)


//class huamao.action.ErrorTipsAction extends game.mvc.Action
var ErrorTipsAction=(function(_super){
	function ErrorTipsAction(){
		/**商店刷新次数不足*/
		this.arr=[];
		ErrorTipsAction.__super.call(this);
		this.arr[ErrorTipsAction.Name_Exists]='名称已存在';
		this.arr[ErrorTipsAction.ChangeStyle]='形象已更新';
		this.arr[ErrorTipsAction.PLAYER_OFFLINE]='对方不在线';
		this.arr[ErrorTipsAction.COPPER_LACK]='铜钱不足';
		this.arr[ErrorTipsAction.FOOD_LACK]='粮草不足';
		this.arr[ErrorTipsAction.GOLD_LACK]='元宝不足';
		this.arr[ErrorTipsAction.SILVER_LACK]='银两不足';
		this.arr[ErrorTipsAction.ITEM_LACK]='道具不足';
		this.arr[ErrorTipsAction.TEAM_JOB_UNMATCH]='对方官职不匹配 ';
		this.arr[ErrorTipsAction.CAILIAOBUZU]='合成材料不足 ';
		this.arr[ErrorTipsAction.MAXLIMIT]='已达合成上限 ';
		this.arr[ErrorTipsAction.NO_JENERAL]='该武将尚未获得 ';
		this.arr[ErrorTipsAction.BEEN_DECOMPOSE]='该武将已被分解 ';
		this.arr[ErrorTipsAction.SOUL_LACK]='武魂数量不足 ';
		this.arr[ ErrorTipsAction.HERO_LV_LACK]="武将等级不对";
		this.arr[ ErrorTipsAction.HERO_SOLDIER_NO_NULL]="武将身上带有士兵，无法操作";
		this.arr[ ErrorTipsAction.ERROR_ARMTYPE]="错误的兵种id";
		this.arr[ ErrorTipsAction.ERROR_PLAYERID]="获取不到玩家信息，检查playerid";
		this.arr[ ErrorTipsAction.UNEQUIP_ALL_SUC]="您已卸除所有装备";
		this.arr[ ErrorTipsAction.CAN_NOT_CAPTIULATE]="公元220年后才可以投降";
		this.arr[ ErrorTipsAction.STRATAGEM_ORDER_LACK]="您没有足够的计策令";
		this.arr[ ErrorTipsAction.NOT_FREE]="只有空闲武将才能被分解";
		this.arr[ ErrorTipsAction.NOT_LEGION]="当前武将不是空闲状态";
		this.arr[ ErrorTipsAction.NOT_ENOUGH]="数量不足";
		this.arr[ ErrorTipsAction.SHOP_FLUSH_NOENOUGH]="商店刷新次数不足";
	}

	__class(ErrorTipsAction,'huamao.action.ErrorTipsAction',_super);
	var __proto=ErrorTipsAction.prototype;
	__proto.execute=function(ba){
		var errorId=ba.readInt();
		GameUtils.setError(errorId);
	}

	ErrorTipsAction.Name_Exists=1;
	ErrorTipsAction.ChangeStyle=2;
	ErrorTipsAction.PLAYER_OFFLINE=3;
	ErrorTipsAction.COPPER_LACK=4;
	ErrorTipsAction.FOOD_LACK=5;
	ErrorTipsAction.GOLD_LACK=6;
	ErrorTipsAction.SILVER_LACK=7;
	ErrorTipsAction.ITEM_LACK=8;
	ErrorTipsAction.TEAM_JOB_UNMATCH=9;
	ErrorTipsAction.CAILIAOBUZU=1001;
	ErrorTipsAction.MAXLIMIT=1002;
	ErrorTipsAction.NO_JENERAL=1003;
	ErrorTipsAction.BEEN_DECOMPOSE=1004;
	ErrorTipsAction.SOUL_LACK=1005;
	ErrorTipsAction.HERO_LV_LACK=1006;
	ErrorTipsAction.HERO_SOLDIER_NO_NULL=1007;
	ErrorTipsAction.ERROR_ARMTYPE=1008;
	ErrorTipsAction.ERROR_PLAYERID=1009;
	ErrorTipsAction.UNEQUIP_ALL_SUC=1010;
	ErrorTipsAction.CAN_NOT_CAPTIULATE=1011;
	ErrorTipsAction.STRATAGEM_ORDER_LACK=1012;
	ErrorTipsAction.NOT_FREE=1013;
	ErrorTipsAction.NOT_LEGION=1014;
	ErrorTipsAction.NOT_ENOUGH=1015;
	ErrorTipsAction.SHOP_FLUSH_NOENOUGH=1016;
	return ErrorTipsAction;
})(Action)


//class huamao.action.FlushPlayerNumAction extends game.mvc.Action
var FlushPlayerNumAction=(function(_super){
	function FlushPlayerNumAction(){
		this.mainPlayerSession=null;
		FlushPlayerNumAction.__super.call(this);
		App.injOne(this);
	}

	__class(FlushPlayerNumAction,'huamao.action.FlushPlayerNumAction',_super);
	var __proto=FlushPlayerNumAction.prototype;
	// this.reg(Silver,"gold");
	__proto.reg=function(type,value){}
	__proto.execute=function(ba){
		var type=ba.readInt();
		var num=ba.readInt();
		switch(type){
			case 0:
				this.mainPlayerSession.mainPlayerData.Lv=num;
				break ;
			case 1:
				this.mainPlayerSession.mainPlayerData.exp=num;
				break ;
			case 2:
				this.mainPlayerSession.mainPlayerData.gold=num;
				break ;
			case 3:
				this.mainPlayerSession.mainPlayerData.silver=num;
				break ;
			case 4:
				this.mainPlayerSession.mainPlayerData.heroExp=num;
				break ;
			case 5:
				this.mainPlayerSession.mainPlayerData.style=num;
				break ;
			case 6:
				if(this.mainPlayerSession.mainPlayerData.job==1001 && num > 1001){
					GuideMain.getMe().closeUI();
				}
				this.mainPlayerSession.mainPlayerData.job=num;
				break ;
			case 7:
				this.mainPlayerSession.mainPlayerData.jobScore=num;
				break ;
			case 8:
				this.mainPlayerSession.mainPlayerData.gameTimes=num;
				break ;
			case 9:
				this.mainPlayerSession.mainPlayerData.winTimes=num;
				break ;
			case 10:
				this.mainPlayerSession.mainPlayerData.tortoise=num;
				break ;
			case 11:
				this.mainPlayerSession.mainPlayerData.mars=num;
				break ;
			case 12:
				this.mainPlayerSession.mainPlayerData.wise=num;
				break ;
			case 13:
				this.mainPlayerSession.mainPlayerData.defeat=num;
				break ;
			case 18:
				this.mainPlayerSession.mainPlayerData.resetCount=num;
			}
		App.eventManager.event(FlushPlayerNumAction.EventAry[type]);
	}

	FlushPlayerNumAction.Lv=0;
	FlushPlayerNumAction.Exp=1;
	FlushPlayerNumAction.Gold=2;
	FlushPlayerNumAction.Silver=3;
	FlushPlayerNumAction.HeroExp=4;
	FlushPlayerNumAction.Style=5;
	FlushPlayerNumAction.Job=6;
	FlushPlayerNumAction.JobScore=7;
	FlushPlayerNumAction.GameTimes=8;
	FlushPlayerNumAction.WinTimes=9;
	FlushPlayerNumAction.Tortoise=10;
	FlushPlayerNumAction.Mars=11;
	FlushPlayerNumAction.Wise=12;
	FlushPlayerNumAction.Defeat=13;
	FlushPlayerNumAction.Reset=18;
	__static(FlushPlayerNumAction,
	['EventAry',function(){return this.EventAry=[
		"FLUSH_PLAYER_LV",
		"FLUSH_PLAYER_EXP",
		"FLUSH_PLAYER_GOLD",
		"FLUSH_PLAYER_SILVER",
		"FLUSH_PLAYER_HEROEXP",
		"FLUSH_PLAYER_STYLE",
		"FLUSH_PLAYER_JOB",
		"FLUSH_PLAYER_JOBSCORE",
		"FLUSH_PLAYER_GAMETIMES",
		"FLUSH_PLAYER_WINTIMES",
		"FLUSH_PLAYER_TORTOISE",
		"FLUSH_PLAYER_MARS",
		"FLUSH_PLAYER_WISE",
		"FLUSH_PLAYER_DEFEAT",
		"",
		"",
		"",
		"",
		"FLUSH_PLAYER_RESET"];}
	]);
	return FlushPlayerNumAction;
})(Action)


//class huamao.action.FriendAction extends game.mvc.Action
var FriendAction=(function(_super){
	function FriendAction(){
		//告诉后端已读消息
		this.friendSession=null;
		this.mainPlayerSession=null;
		this.mailSession=null;
		this.sensitiveSession=null;
		FriendAction.__super.call(this);
	}

	__class(FriendAction,'huamao.action.FriendAction',_super);
	var __proto=FriendAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		if(type==FriendAction.List){
			this.onList(ba);
		}
		else if(type==FriendAction.Find){
			this.onFindList(ba);
		}
		else if(type==FriendAction.UpdateFriend){
			var friend=this.readFriend(ba);
			App.eventManager.event("UPDATE_FRIEND",[friend]);
			console.log("更新好友-------------"+friend.isTop);
			App.eventManager.event("REAPOINT",RedPointType.SHENQING);
		}
		else if(type==FriendAction.Delete){
			var friendId=ba.readInt();
			this.friendSession.removeFriend(friendId);
			this.friendSession.removeChat(friendId);
			App.eventManager.event("DELETE_FRIEND",[friend]);
			App.eventManager.event("UPDATE_FRIEND",[friend]);
			console.log("删除好友");
		}
		else if(type==FriendAction.SendMsg){
			this.addMsg(ba);
		}
		else if(type==FriendAction.Embattle){
			this.friendSession.myZhenrong=ba.readUTF();
		}
		else if(type==FriendAction.Challenge){
			this.tianzhanFriend(ba);
		}
		else if(type==FriendAction.FriendBattleList){
			this.mailSession.IsZhanBaoRedServer=false;
			var len=ba.readInt();
			for(var i=0;i<len;i++){
				this.readBattle(ba);
			}
			App.eventManager.event("BATTLEUPDATA");
			App.eventManager.event("REAPOINT",RedPointType.ZHANBAO);
		}
		else if(type==FriendAction.FriendBattle){
			this.mailSession.IsZhanBaoRedServer=false;
			this.readBattle(ba);
			App.eventManager.event("BATTLEUPDATA");
			App.eventManager.event("REAPOINT",RedPointType.ZHANBAO);
		}
		else if(type==FriendAction.ShanchuBattle){
			var battleId=ba.readLong();
			this.mailSession.deleteBattle(battleId);
			App.eventManager.event("BATTLEUPDATA");
			App.eventManager.event("REAPOINT",RedPointType.ZHANBAO);
		}
		else if(type==FriendAction.ClearBattle){
			this.mailSession.deleteAllBattle();
			App.eventManager.event("BATTLEUPDATA");
			App.eventManager.event("REAPOINT",RedPointType.ZHANBAO);
		}
		else if(type==FriendAction.ReadAllBattle){
			this.mailSession.battleAllRead();
			App.eventManager.event("BATTLEUPDATA");
			App.eventManager.event("REAPOINT",RedPointType.ZHANBAO);
		}
		else if(type==FriendAction.ReadBattleGe){
			var bId=ba.readLong();
			this.mailSession.battleRead(bId);
			App.eventManager.event("BATTLEUPDATA");
			App.eventManager.event("REAPOINT",RedPointType.ZHANBAO);
		}
		else if(type==FriendAction.Accept){
			this.sendMsg(ba.readInt(),"我们成为了好友");
		}
		else if(type==FriendAction.MsgList){
			this.setFriendMsgList(ba);
		}
		else if(type==FriendAction.FriendState){
			friendId=ba.readInt();
			friend=this.friendSession.getFriend(friendId);
			friend.state=ba.readInt();
			friend.isOnLine=ba.readByte();
			friend.lastTime=ba.readInt();
			console.log("好友状态更新",friend.friendName,friend.isOnLine);
			App.eventManager.event("UPDATE_FRIEND",[friend]);
			App.eventManager.event("REAPOINT",RedPointType.SHENQING);
		}
		else if(type==FriendAction.FriendRedDot){
			this.mailSession.IsZhanBaoRedServer=true;
			App.eventManager.event("REAPOINT",RedPointType.ZHANBAO);
		}
		else if(type==FriendAction.FriendRed){
			var leng=ba.readInt();
			for(i=0;i<leng;i++){
				var fid=ba.readInt();
				this.friendSession.addRed(fid);
			}
			App.eventManager.event("REAPOINT",RedPointType.WEIDU);
		}
	}

	/**
	*读取消息
	*/
	__proto.readXiaoXi=function(friendId){
		this.friendSession.deleteRed(friendId);
		this.startByAction();
		this.putByte(FriendAction.FriendReadRed);
		this.putInt(friendId);
		this.send();
		App.eventManager.event("REAPOINT",RedPointType.WEIDU);
	}

	__proto.readBattle=function(ba){
		var data=new MailBattleData();
		data.battleId=ba.readLong();
		data.time=ba.readInt();
		data.type=ba.readByte();
		data.result=ba.readByte();
		data.atkName=ba.readUTF();
		data.atkTroops=ba.readInt();
		data.atkLoseReoops=ba.readInt();
		data.defenseName=ba.readUTF();
		data.defenseTroops=ba.readInt();
		data.defenseLoseTroops=ba.readInt();
		data.isRead=ba.readByte();
		data.friendId=ba.readInt();
		data.URL=ba.readUTF();
		this.mailSession.addBattle(data);
	}

	__proto.setFriendMsgList=function(ba){
		var friendId=ba.readInt();
		var size=ba.readInt();
		console.log("聊天内容长度"+size);
		for(var i=0;i < size;i++){
			var msgType=ba.readInt();
			var state=ba.readByte();
			var content=ba.readUTF();
			var time=ba.readInt();
			var chatData=new ChatData();
			chatData.msgType=msgType;
			if(state==0){
				chatData.fromId=this.mainPlayerSession.mainPlayerData.playerId;
				chatData.toId=friendId;
			}
			else{
				chatData.fromId=friendId;
				chatData.toId=this.mainPlayerSession.mainPlayerData.playerId;
			}
			chatData.isSelf=chatData.fromId==this.mainPlayerSession.mainPlayerData.playerId;
			chatData.content=content;
			chatData.time=time;
			this.friendSession.addChat(chatData);
		}
	}

	// App.eventManager.event(YouEvent.UPDATE_MSG_LIST,[friendId]);
	__proto.tianzhanFriend=function(ba){
		var friendId=ba.readInt();
		var battleId=ba.readLong();
		var battleEndTime=ba.readInt();
		var url=ba.readUTF();
		var friend=this.friendSession.getFriend(friendId);
		if(friend){
			friend.battleId=battleId;
			friend.battleEndTime=battleEndTime;
			friend.battleFileUrl=url;
			App.eventManager.event("UPDATE_FRIEND",[friend]);
		}
	}

	__proto.addMsg=function(ba){
		var chatData=new ChatData();
		chatData.msgType=ba.readInt();
		chatData.fromId=ba.readInt();
		chatData.toId=ba.readInt();
		chatData.isSelf=chatData.fromId==this.mainPlayerSession.mainPlayerData.playerId;
		chatData.content=ba.readUTF();
		console.log("说话了----------------------"+chatData.content);
		chatData.time=ba.readInt();
		var friendId=0;
		if(chatData.isSelf){
			friendId=chatData.toId;
		}
		else{
			friendId=chatData.fromId;
		}
		this.friendSession.addRed(friendId);
		App.eventManager.event("REAPOINT",RedPointType.WEIDU);
		this.friendSession.addChat(chatData);
	}

	__proto.onFindList=function(ba){
		var arr=[];
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			var friend=new FriendData();
			friend.friendId=ba.readInt();
			friend.friendName=ba.readUTF();
			friend.style=ba.readInt();
			friend.head=ba.readInt();
			friend.isFriend=ba.readByte();
			arr.push(friend);
		}
		App.eventManager.event("FIND_FRIEND_RESULT",[arr]);
	}

	__proto.onList=function(ba){
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			var friend=this.readFriend(ba);
			friend.battleEndTime=ba.readInt();
			friend.battleFileUrl=ba.readUTF();
			console.log("好友信息",friend.battleId,friend.battleEndTime,GameUtils.GetServerTime());
		}
		App.eventManager.event("REAPOINT",RedPointType.SHENQING);
	}

	__proto.readFriend=function(ba){
		var friendId=ba.readInt();
		var friend=this.friendSession.getFriend(friendId);
		friend.friendId=friendId;
		friend.friendName=ba.readUTF();
		friend.style=ba.readInt();
		friend.head=ba.readInt();
		friend.isTop=ba.readInt();
		friend.beizhu=ba.readUTF();
		friend.state=ba.readInt();
		friend.isOnLine=ba.readByte();
		friend.lastTime=ba.readInt();
		return friend;
	}

	__proto.onFind=function(str){
		this.startByAction();
		this.putByte(FriendAction.Find);
		this.putUtf(str);
		this.send();
	}

	__proto.onBeizhu=function(friendId,content){
		this.startByAction();
		this.putByte(FriendAction.Memo);
		this.putInt(friendId);
		this.putUtf(content);
		this.send();
	}

	__proto.sendMsgList=function(friendId){
		this.startByAction();
		this.putByte(FriendAction.MsgList);
		this.putInt(friendId);
		this.send();
	}

	__proto.sendApplyFriend=function(friendId){
		this.startByAction();
		this.putByte(FriendAction.Apply);
		this.putInt(friendId);
		this.send();
	}

	__proto.sendAddBlackList=function(friendId){
		this.startByAction();
		this.putByte(FriendAction.AddBlacklist);
		this.putInt(friendId);
		this.send();
	}

	__proto.onSend=function(type,friendId){
		this.startByAction();
		this.putByte(type);
		this.putInt(friendId);
		this.send();
	}

	__proto.onTop=function(friendId,top){
		this.startByAction();
		this.putByte(FriendAction.Top);
		this.putInt(friendId);
		this.putByte(top);
		this.send();
	}

	__proto.sendMsg=function(friendId,content){
		this.startByAction();
		this.putByte(FriendAction.SendMsg);
		this.putInt(friendId);
		content=this.sensitiveSession.getSensitiveWord(content);
		this.putUtf(content);
		this.send();
	}

	__proto.sendSaveZhenrong=function(zhenrong){
		this.startByAction();
		this.putByte(FriendAction.Embattle);
		this.putUtf(zhenrong);
		this.send();
	}

	__proto.sendChuzhan=function(friendId,zhenrong){
		this.startByAction();
		this.putByte(FriendAction.Challenge);
		this.putInt(friendId);
		this.putUtf(zhenrong);
		this.send();
	}

	/**
	*战报列表 每次游戏只请求一次
	*/
	__proto.sendBattleList=function(){
		if(this.mailSession.battleIsopen){
			this.mailSession.battleIsopen=false;
			this.startByAction();
			this.putByte(FriendAction.FriendBattleList);
			this.send();
		}
	}

	/**
	*删除战报
	*/
	__proto.sendDeleteBattle=function(id){
		this.startByAction();
		this.putByte(FriendAction.ShanchuBattle);
		this.putLong(id);
		this.send();
	}

	/**
	*读取一个
	*/
	__proto.readBattleYIGE=function(id){
		this.startByAction();
		this.putByte(FriendAction.ReadBattleGe);
		this.putLong(id);
		this.send();
	}

	/**
	*读取一个
	*/
	__proto.allReadBattle=function(){
		this.startByAction();
		this.putByte(FriendAction.ReadAllBattle);
		this.send();
	}

	/**
	*清空列表
	*/
	__proto.sendDeleteAllBattle=function(){
		this.startByAction();
		this.putByte(FriendAction.ClearBattle);
		this.send();
	}

	FriendAction.List=0;
	FriendAction.Find=1;
	FriendAction.Apply=2;
	FriendAction.Accept=3;
	FriendAction.Reject=4;
	FriendAction.Memo=5;
	FriendAction.Top=6;
	FriendAction.Delete=7;
	FriendAction.SubRecent=8;
	FriendAction.Embattle=9;
	FriendAction.Challenge=10;
	FriendAction.SendMsg=11;
	FriendAction.ClearMsg=12;
	FriendAction.MsgList=13;
	FriendAction.AddBlacklist=14;
	FriendAction.UpdateFriend=101;
	FriendAction.FriendBattleList=15;
	FriendAction.ReadBattleGe=16;
	FriendAction.ReadAllBattle=17;
	FriendAction.ClearBattle=18;
	FriendAction.ShanchuBattle=19;
	FriendAction.FriendBattle=102;
	FriendAction.FriendRedDot=103;
	FriendAction.FriendState=104;
	FriendAction.FriendRed=105;
	FriendAction.FriendReadRed=20;
	return FriendAction;
})(Action)


//class huamao.action.GPlayerTaskAction extends game.mvc.Action
var GPlayerTaskAction=(function(_super){
	function GPlayerTaskAction(){
		this.taskSession=null;
		GPlayerTaskAction.__super.call(this);
	}

	__class(GPlayerTaskAction,'huamao.action.GPlayerTaskAction',_super);
	var __proto=GPlayerTaskAction.prototype;
	__proto.execute=function(ba){
		var end=ba.readByte();
		var taskid=ba.readInt();
		var exp=ba.readInt();
		var isOk=ba.readByte();
		var td=this.taskSession.gNewplayer;
		if(this.taskSession.gNewplayer==null){
			td=this.taskSession.gNewplayer=new TaskData();
			td.type=103;
		}
		td.isOk=isOk;
		td.end=0;
		td.taskId=taskid;
		td.nowValue=exp;
		td.status=td.isOk?3:2;
		td.systask=ConfigManager.getConfig("sys_task.txt",taskid);
		if(end==1){
			this.taskSession.gNewplayer.status=0;
		}
		this.taskSession.sessionUpdataEvent("huamao.YouEvent.UPDATA_TASK_DATA");
	}

	return GPlayerTaskAction;
})(Action)


//class huamao.action.GuideAction extends game.mvc.Action
var GuideAction=(function(_super){
	function GuideAction(){
		//新手打点，字符串保存以便扩展
		this.unlockStr="";
		this.openFunctionSession=null;
		this.guideSession=null;
		GuideAction.__super.call(this);
		App.injOne(this);
	}

	__class(GuideAction,'huamao.action.GuideAction',_super);
	var __proto=GuideAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readInt();
		if(GuideAction.Step==type){
			var step=ba.readInt();
			console.log("获取新手引导数据 ---》 step = "+step);
			if(GuideAction.ifRead_Step){
				if(step >=SysGuide.getCurstep()){
					SysGuide.setCurStep(step);
					SysGuide.setKeyStep(step);
				}
				GuideAction.ifRead_Step=false;
				GuideMain.getMe();
				console.log("[guide] getMe() -------->");
			}
			}else if(GuideAction.Unlock==type){
			var str=ba.readUTF();
			if(GuideAction.ifRead_Unlock){
				GuideAction.ifRead_Unlock=false;
				this.unlockStr=str;
				console.log("获取新手引导数据 ---》 unlockStr = "+this.unlockStr);
				this.paseUnlockKey();
			}
			}else if(GuideAction.socketCB==type){
			GuideMain.removeUILoading();
			}else if(GuideAction.Video==type){
			var t=ba.readInt();
			this.guideSession.setVedio(t);
		}
	}

	__proto.sendGuideStep=function(_step){
		this.startByAction();
		this.putInt(GuideAction.Step);
		this.putInt(_step);
		this.send();
		SysGuide.setKeyStep(_step);
	}

	__proto.addUnlockKey=function(key){
		if(this.unlockStr==null || this.unlockStr.length==0){
			this.unlockStr=key;
			}else{
			this.unlockStr+=";"+key;
		}
		console.log("unlockStr = "+this.unlockStr);
	}

	__proto.paseUnlockKey=function(){
		var strary=this.unlockStr.split(";");
		for(var i=0;i<strary.length;i++){
			this.openFunctionSession.addItem(strary[i]);
		}
	}

	__proto.sendUnlockKey=function(key){
		App.eventManager.event("NEW_GUIDE_OPEN",key);
		this.addUnlockKey(key);
		this.paseUnlockKey();
		this.startByAction();
		this.putInt(GuideAction.Unlock);
		this.putUtf(this.unlockStr);
		this.send();
	}

	__proto.sendGuideVedio=function(vedeo){
		this.startByAction();
		this.putInt(GuideAction.Video);
		this.putInt(vedeo);
		this.send();
	}

	__proto.sendDotStr=function(dotstr){
		this.startByAction();
		this.putInt(GuideAction.Dot);
		this.putUtf(dotstr);
		this.send();
	}

	GuideAction.ifRead_Step=true;
	GuideAction.ifRead_Unlock=true;
	GuideAction.Step=1;
	GuideAction.Unlock=2;
	GuideAction.socketCB=3;
	GuideAction.Video=4;
	GuideAction.Dot=5;
	return GuideAction;
})(Action)


//class huamao.action.HeartAction extends game.mvc.Action
var HeartAction=(function(_super){
	function HeartAction(){
		HeartAction.__super.call(this);
	}

	__class(HeartAction,'huamao.action.HeartAction',_super);
	return HeartAction;
})(Action)


//class huamao.action.HeroTeamAction extends game.mvc.Action
var HeroTeamAction=(function(_super){
	function HeroTeamAction(){
		this.heroTeamSession=null;
		HeroTeamAction.__super.call(this);
	}

	__class(HeroTeamAction,'huamao.action.HeroTeamAction',_super);
	var __proto=HeroTeamAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		if(type==1){
			var len=ba.readByte();
			for (var i=0;i < len;i++){
				this.readHeroTeamData(ba);
			}
			}else if(type==2){
			this.readHeroTeamData(ba);
			App.eventManager.event("TEAM_CHANGE");
		}
	}

	__proto.readHeroTeamData=function(ba){
		console.log("武将队列");
		var teamIndex=ba.readInt();
		var data=this.heroTeamSession.getTeamByIndex(teamIndex);
		if(data==null){
			data=new HeroTeamData();
			data.teamIndex=teamIndex;
			this.heroTeamSession.teamArr.push(data);
		}
		data.teamName=ba.readUTF();
		var heroLen=ba.readInt();
		data.heroIdArr.length=0;
		for (var j=0;j < heroLen;j++){
			data.heroIdArr.push(ba.readInt());
		}
		return data;
	}

	__proto.sendTeam=function(teamIndex,arr,teamName){
		this.startByAction();
		this.putByte(2);
		this.putInt(teamIndex);
		this.putInt(arr.length);
		for (var i=0;i < arr.length;i++){
			this.putInt(arr[i]);
		}
		this.putUtf(teamName);
		this.send();
	}

	HeroTeamAction.SEND=1;
	HeroTeamAction.RESET=2;
	return HeroTeamAction;
})(Action)


//class huamao.action.HuoyueDayAction extends game.mvc.Action
var HuoyueDayAction=(function(_super){
	function HuoyueDayAction(){
		this.huoyueDaySession=null;
		HuoyueDayAction.__super.call(this);
	}

	__class(HuoyueDayAction,'huamao.action.HuoyueDayAction',_super);
	var __proto=HuoyueDayAction.prototype;
	__proto.execute=function(ba){
		console.log(5555555555555555555555);
		HuoyueDayData.getData();
		var taskize=ba.readByte();
		this.huoyueDaySession.arrData.length=0;
		for (var i=0;i < HuoyueDayData.sysNewArr.length;i++){
			var huoyueDayData=new HuoyueDayData();
			huoyueDayData.taskId=ba.readInt();
			huoyueDayData.getOne=ba.readInt();
			console.log("i:"+i+"huoyueDayData.getOne:"+huoyueDayData.getOne);
			huoyueDayData.isOk=ba.readByte();
			huoyueDayData.getStatus=ba.readByte();
			huoyueDayData.Disbtn=true;
			this.huoyueDaySession.arrData.push(huoyueDayData);
		}
		this.huoyueDaySession.giftArr.length=0;
		this.huoyueDaySession.huoYueDu=ba.readInt();
		for (var j=0;j < 3;j++){
			this.huoyueDaySession.giftArr[j]=ba.readByte();
		}
		App.eventManager.event("HUOYUEDAY");
		App.eventManager.event("REAPOINT",RedPointType.HUODONG);
	}

	__proto.onHuoYueDayGift=function(type,actionId){
		this.startByAction();
		this.putByte(type);
		this.putInt(actionId);
		this.send();
		console.log("type:"+type,"actionId:"+actionId)
	}

	return HuoyueDayAction;
})(Action)


//class huamao.action.InitServerTimeAction extends game.mvc.Action
var InitServerTimeAction=(function(_super){
	function InitServerTimeAction(){
		InitServerTimeAction.__super.call(this);
	}

	__class(InitServerTimeAction,'huamao.action.InitServerTimeAction',_super);
	var __proto=InitServerTimeAction.prototype;
	__proto.execute=function(ba){
		GameUtils.LoginTime=ba.readLong();
		GameUtils.LoginGet=Browser.now();
		console.log("TheGame.LoginTime = "+GameUtils.LoginTime+"   TheGame.LoginGet = "+GameUtils.LoginGet);
	}

	return InitServerTimeAction;
})(Action)


//class huamao.action.KickPlayerAction extends game.mvc.Action
var KickPlayerAction=(function(_super){
	function KickPlayerAction(){
		KickPlayerAction.__super.call(this);
	}

	__class(KickPlayerAction,'huamao.action.KickPlayerAction',_super);
	var __proto=KickPlayerAction.prototype;
	__proto.execute=function(ba){
		App.socketManager.closeSocket();
		FlyUpTips.setTips("您被踢下线了,正在转到登陆界面");
		Laya.timer.once(2000,this,this.timerFun);
		MouseManager.enabled=false;
	}

	__proto.timerFun=function(){
		App.reload();
	}

	return KickPlayerAction;
})(Action)


//class huamao.action.LoginAction extends game.mvc.Action
var LoginAction=(function(_super){
	function LoginAction(){
		this.mainPlayerSession=null;
		this.loginSession=null;
		LoginAction.__super.call(this);
	}

	__class(LoginAction,'huamao.action.LoginAction',_super);
	var __proto=LoginAction.prototype;
	__proto.execute=function(ba){
		var stat=ba.readByte();
		switch(stat){
			case 0:{
					var data=this.mainPlayerSession.mainPlayerData;
					data.playerId=ba.readInt();
					data.playerName=ba.readUTF();
					data.Lv=ba.readInt();
					data.style=ba.readInt();
					data.exp=ba.readInt();
					data.gold=ba.readInt();
					data.silver=ba.readInt();
					data.heroExp=ba.readInt();
					data.job=ba.readInt();
					data.jobScore=ba.readInt();
					data.gameTimes=ba.readInt();
					data.winTimes=ba.readInt();
					data.tortoise=ba.readInt();
					data.mars=ba.readInt();
					data.wise=ba.readInt();
					data.defeat=ba.readInt();
					data.cityStyle=ba.readInt();
					data.headFrame=ba.readInt();
					data.banner=ba.readInt();
					data.createTime=ba.readInt();
					data.resetCount=ba.readInt();
					App.sceneManager.setScene("MAIN_SCENE");
					App.eventManager.event("LOGIN_SUCCESS",data);
					break ;
				}
			case 1:{
					FlyUpTips.setTips("token错误或超时");
					App.socketManager.closeSocket();
					this.loginSession.loginMasterServer();
					break ;
				}
			case 2:{
					this.loginSession.delayConnectSubServer();
					break ;
				}
			default :{
					break ;
				}
			}
	}

	__proto.sendLogin=function(platformId,sdkPlayerId){
		this.startByAction();
		this.putByte(1);
		this.putInt(platformId);
		this.putUtf(sdkPlayerId);
		this.send();
	}

	__proto.sendCreateRole=function(platformId,sdkPlayerId,style,playerName){
		this.startByAction();
		this.putByte(2);
		this.putInt(platformId);
		this.putUtf(sdkPlayerId);
		this.putInt(style);
		this.putUtf(playerName);
		this.send();
	}

	__proto.sendLoginSubserver=function(token){
		this.startByAction();
		this.putUtf(token);
		this.send();
	}

	LoginAction.LOGIN=1;
	LoginAction.CREATE_ROLE=2;
	LoginAction.LOGIN_SUCCESS=0;
	LoginAction.TOKEN_NO=1;
	LoginAction.IS_LOGOUT=2;
	return LoginAction;
})(Action)


//class huamao.action.MailAction extends game.mvc.Action
var MailAction=(function(_super){
	function MailAction(){
		//初始化后端告知的小红点提示
		this.mailSession=null;
		MailAction.__super.call(this);
	}

	__class(MailAction,'huamao.action.MailAction',_super);
	var __proto=MailAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		var mailId=0;
		var mailData=null;
		switch (type){
			case 1:
				this.mailSession.IsRedServer=false;
				this.readMail(ba);
				App.eventManager.event("MAILUPDATA");
				App.eventManager.event("REAPOINT",RedPointType.YOUJIAN);
				break ;
			case 2:
				this.mailSession.IsRedServer=false;
				var len=ba.readInt();
				for(var i=0;i<len;i++){
					this.readMail(ba);
				}
				App.eventManager.event("MAILLIST");
				App.eventManager.event("REAPOINT",RedPointType.YOUJIAN);
				break ;
			case 3:
				mailId=ba.readInt();
				mailData=this.mailSession.getMail(mailId);
				if(mailData)mailData.isRead=1;
				App.eventManager.event("MAILUPDATA");
				break ;
			case 4:
				mailId=ba.readInt();
				this.mailSession.deleteMail(mailId);
				App.eventManager.event("MAILUPDATA");
				App.eventManager.event("DELETEMAIL");
				break ;
			case 5:
				this.mailSession.deleteALL();
				App.eventManager.event("MAILUPDATA");
				App.eventManager.event("DELETEALLMAIL");
				break ;
			case 6:
				mailId=ba.readInt();
				mailData=this.mailSession.getMail(mailId);
				if(mailData)mailData.isRead=2;
				App.eventManager.event("MAILUPDATA");
				App.eventManager.event("MAILGETITEM",mailId);
				break ;
			case 7:
				this.mailSession.IsRedServer=true;
				App.eventManager.event("REAPOINT",RedPointType.YOUJIAN);
				break ;
			}
	}

	/**
	*读取单个邮件
	*
	*/
	__proto.readMail=function(ba){
		var data=new MailData();
		data.mailId=ba.readInt();
		data.mailType=ba.readInt();
		data.isRead=ba.readByte();
		data.mailTitle=ba.readUTF();
		data.mailContent=ba.readUTF();
		data.item=ba.readUTF();
		data.time=ba.readInt();
		this.mailSession.addMail(data);
	}

	/**
	*请求邮件列表每次游戏 只请求一次切记,丘哥 “死活不让每次请求”;
	*/
	__proto.sendMailList=function(){
		if(this.mailSession.isOpen){
			this.mailSession.isOpen=false;
			this.startByAction();
			this.putByte(2);
			this.send();
		}
	}

	/**
	*读取邮件
	*
	*/
	__proto.readMailFun=function(id){
		this.startByAction();
		this.putByte(3);
		this.putInt(id);
		this.send();
	}

	/**
	*删除单个邮件
	*
	*/
	__proto.deleteMail=function(id){
		this.startByAction();
		this.putByte(4);
		this.putInt(id);
		this.send();
	}

	/**
	*删除全部邮件 保留未领取的邮件
	*
	*/
	__proto.deleteAll=function(){
		this.startByAction();
		this.putByte(5);
		this.send();
	}

	/**
	*提取邮件物品
	*
	*/
	__proto.getItem=function(id){
		this.startByAction();
		this.putByte(6);
		this.putInt(id);
		this.send();
	}

	MailAction.NEWMAIL=1;
	MailAction.MAILLIST=2;
	MailAction.READ=3;
	MailAction.DELETE=4;
	MailAction.DELETEALL=5;
	MailAction.GETITEM=6;
	MailAction.RED=7;
	return MailAction;
})(Action)


//class huamao.action.MapCityAction extends game.mvc.Action
var MapCityAction=(function(_super){
	function MapCityAction(){
		//10分钟开局
		this.isChuanZhiDrop=false;
		this.chuanZhiDropArray=[];
		this.mainPlayerSession=null;
		this.mapCitySession=null;
		this.wuJiangSession=null;
		this.dropGiftSession=null;
		this.typeNum=0;
		this.dianZanSession=null;
		MapCityAction.__super.call(this);
		App.injOne(this);
	}

	__class(MapCityAction,'huamao.action.MapCityAction',_super);
	var __proto=MapCityAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		if(type==51){
			this.enterMap(ba);
		}
		else if(type==52){
			this.exitMap(ba);
		}
		else if(type==55){
			this.addAction(ba);
		}
		else if(type==54){
			this.updatePlayerList(ba);
		}
		else if(type==59){
			this.innerCityInfo(ba);
		}
		else if(type==60){
			this.upgradeBuildSuccess(ba);
		}
		else if(type==57){
			this.updateSoldierInfo(ba);
		}
		else if(type==61){
			this.addBattle(ba);
		}
		else if(type==58){
			this.updateCityInfo(ba);
		}
		else if(type==56){
			this.updateLiangcao(ba);
		}
		else if(type==62){
			this.gameOver(ba);
		}
		else if(type==63){
			this.setCityLevel(ba);
		}
		else if(type==64){
			this.setCitysLevel(ba);
		}
		else if(type==22){
			this.zhenchaSuccess(ba);
		}
		else if(type==4){
			this.jieMeng(ba);
		}
		else if(type==5){
			this.quXiaoJieMeng(ba);
		}
		else if(type==53){
			this.tongYiJieMeng(ba);
		}
		else if(type==14){
			this.setZhanbaoList(ba);
			console.log("战报-------"+this.mapCitySession.zhanbaoList.length);
		}
		else if(type==26){
			this.addOneZhanbao(ba,true);
			console.log("添加了一个战报");
		}
		else if(type==15){
			this.setJianBao(ba);
		}
		else if(type==23){
			this.setEveryHourChanliang(ba);
		}
		else if(type==65){
			this.tongmeng(ba);
		}
		else if(type==66){
			this.flushDiDuiDu(ba);
		}
		else if(type==67){
			this.flushBaiJiang(ba);
		}
		else if(type==24){
			this.flushCityList(ba);
		}
		else if(type==25){
			this.wuJiangSession.clearHeroState();
		}
		else if(type==17){
			this.updateJiasu(ba);
		}
		else if(type==31){
			this.mapCitySession.clearData();
		}
		else if(type==50){
			console.log("去休息室");
			this.mapCitySession.clearData();
			this.mapCitySession.isGoMapCity=2;
			App.eventManager.event("GOTO_HOMEPAGE");
		}
		else if(type==68){
			this.mapCitySession.zhaobingmaimaTimes=ba.readInt();
			App.eventManager.event("ZHAOBINGMAIMA_TIMES");
		}
		else if(type==32){
			this.setZudui(ba);
		}
		else if(type==2){
			console.log("邀请好友组队");
			this.mapCitySession.invitedPlayerId=ba.readInt();
			App.eventManager.event("UPDATE_INVITED_FRIEND");
		}
		else if(type==19){
			var pId=ba.readInt();
			if(this.mapCitySession.invitedPlayerId==pId){
				this.mapCitySession.invitedPlayerId=-1;
				App.eventManager.event("UPDATE_INVITED_FRIEND");
			}
		}
		else if(type==18){
			this.swapHeros(ba);
		}
		else if(type==34){
			this.getGuideWuJiang(ba);
		}
		else if(type==8){
			var city=ba.readInt();
			this.mapCitySession.innerCityId=city;
			App.eventManager.event("JINRUCHENGNEI",city);
		}
		else if(type==70){
			this.typeNum=type;
			this.victoryDropGift(ba);
			console.log("掉落1111111111111");
		}
		else if(type==71){
			this.typeNum=type;
			this.victoryDropGift(ba);
			console.log("掉落2222222222");
			}else if(type==35){
			this.dropGiftSession.giftData.length=0;
			App.eventManager.event("FLUSHDROPGIFT");
			App.eventManager.event("REMOVEDROPGIFT");
			console.log("掉落领取44444444444");
			}else if(type==72){
			this.mapCitySession.setOpenWarTime(ba.readInt());
			var sysTips=ConfigManager.getConfig("sys_tips.txt",5006);
			PaoMaTips.getMe().setTips(sysTips.tipsDescribe);
		}
	}

	__proto.victoryDropGift=function(ba){
		console.log("掉落物品333333333333");
		var dropLength=0;
		if(this.typeNum==71){
			dropLength=1;
			}else if(this.typeNum==70){
			dropLength=ba.readInt();
			this.dropGiftSession.giftData.length=0;
		}
		this.chuanZhiDropArray.length=0;
		for (var i=0;i < dropLength;i++){
			var cityId=ba.readInt();
			var dropTime=ba.readInt();
			var dropStr=ba.readUTF();
			var dropData=new DropGiftData();
			dropData.cityId=cityId;
			dropData.dropTime=dropTime;
			dropData.dropStr=dropStr;
			this.chuanZhiDropArray.push(dropData.dropStr);
			this.dropGiftSession.giftData.push(dropData);
		}
		this.isChuanZhiDrop=true;
		App.eventManager.event("VIEWDROPGIFT");
	}

	__proto.clickDrop=function(){
		App.dialogManager.openDialogByStr("DROPGIFT",null,true,true);
	}

	__proto.getGuideWuJiang=function(ba){
		ba.readInt();
		var str=ba.readUTF();
		var ary=str.split(",");
		var animation=new HeroAnimation();
		animation.setData(ary);
	}

	__proto.swapHeros=function(ba){
		console.log("=========互换=========");
		var cityId=ba.readInt();
		var heroId1=ba.readInt();
		var index1=ba.readInt();
		var heroId2=ba.readInt();
		var index2=ba.readInt();
		var cityData=this.mapCitySession.getCity(cityId);
		var heroData1=cityData.heroObj[heroId1];
		heroData1.index=index1;
		var heroData2=cityData.heroObj[heroId2];
		heroData2.index=index2;
		App.eventManager.event("SWAP_HEROS",[heroData1,heroData2]);
	}

	__proto.setZudui=function(ba){
		this.mapCitySession.zuduiList.length=0;
		this.mapCitySession.unionList.length=0;
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			var zuduiData=new ZuduiPlayerData();
			zuduiData.playerId=ba.readInt();
			zuduiData.playerName=ba.readUTF();
			console.log("可以组队的好友============="+zuduiData.playerName,zuduiData.playerId);
			zuduiData.style=ba.readInt();
			zuduiData.head=ba.readInt();
			zuduiData.isOnLine=ba.readByte();
			this.mapCitySession.zuduiList.push(zuduiData);
		}
		size=ba.readInt();
		for(i=0;i < size;i++){
			zuduiData=new ZuduiPlayerData();
			zuduiData.playerId=ba.readInt();
			zuduiData.playerName=ba.readUTF();
			console.log("可以组队的联盟============="+zuduiData.playerName,zuduiData.playerId);
			zuduiData.style=ba.readInt();
			zuduiData.head=ba.readInt();
			zuduiData.isOnLine=ba.readByte();
			this.mapCitySession.unionList.push(zuduiData);
		}
		App.dialogManager.openDialogByStr("YAOQING_ZUDUI",null,true,true);
	}

	__proto.updateJiasu=function(ba){
		var actionId=ba.readLong();
		var endTime=ba.readInt();
		var jiasuTimes=ba.readInt();
		var actionData=this.mapCitySession.getActionById(actionId);
		actionData.remainingTime=endTime-GameUtils.GetServerTime();
		actionData.jiasuTimes=jiasuTimes;
		actionData.endTime=endTime;
		App.eventManager.event("UPDATE_XINGJUN_LIST");
	}

	//城池数据
	__proto.flushCityList=function(ba){
		this.mapCitySession.clearCityList();
		var citySize=ba.readInt();
		for(var i=0;i<citySize;i++){
			var data=new CityListData();
			data.cityId=ba.readInt();
			data.cityLv=ba.readInt();
			data.ifMainCityUp=ba.readByte();
			data.ifCityUp=ba.readByte();
			data.mjNum=ba.readByte();
			data.sjNum=ba.readByte();
			data.ntNum=ba.readByte();
			data.pjLv=ba.readInt();
			data.soldier=ba.readInt();
			data.heroNum=ba.readInt();
			data.heroSoldier=ba.readInt();
			data.soldierOutPut=ba.readInt();
			data.time=ba.readInt();
			this.mapCitySession.addCityList(data);
		}
		if(CityPanel.Open){
			console.log("刷新城市面板 "+citySize);
			App.eventManager.event("UPDATA_CITY_LIST");
			}else{
			console.log("打开城市面板 "+citySize);
			App.dialogManager.openDialogByStr("CHENGCHI",null,true,true);
		}
	}

	__proto.tongmeng=function(ba){
		var playerId=ba.readInt();
		var cityPlayerData=this.mapCitySession.getCityPlayer(playerId);
		console.log("更新盟友=========="+cityPlayerData.playerName);
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			var cityData=this.setCityInfo(ba,cityPlayerData);
			App.eventManager.event("UPDATE_CITY_INFO",[cityData,cityPlayerData]);
		}
	}

	//刷新 败将
	__proto.flushBaiJiang=function(ba){
		var playerid=ba.readInt();
		var baijiang=ba.readInt();
		var data=this.mapCitySession.getCityPlayer(playerid);
		data.isBaijiang=baijiang;
		App.eventManager.event("WAIJIAO_FLUSH");
	}

	//刷新 敌对度和仇敌
	__proto.flushDiDuiDu=function(ba){
		var playerid=ba.readInt();
		var diduidu=ba.readInt();
		var choudi=ba.readInt();
		var data=this.mapCitySession.getCityPlayer(playerid);
		data.diduidu=diduidu;
		data.isChoudi=choudi;
		App.eventManager.event("WAIJIAO_FLUSH");
	}

	//同意 好友申请，加为盟友
	__proto.tongYiJieMeng=function(ba){
		var playeridA=ba.readInt();
		var playeridB=ba.readInt();
		var playerDataA=this.mapCitySession.getCityPlayer(playeridA);
		var playerDataB=this.mapCitySession.getCityPlayer(playeridB);
		playerDataA.mengyouId=playeridB;
		playerDataB.mengyouId=playeridA;
		if(playeridA==this.mapCitySession.selfDataInfo.playerId){
			playerDataB.playerType=CityPlayerType.FRIEND;
		}
		if(playeridB==this.mapCitySession.selfDataInfo.playerId){
			playerDataA.playerType=CityPlayerType.FRIEND;
		}
		App.eventManager.event("WAIJIAO_FLUSH");
	}

	__proto.quXiaoJieMeng=function(ba){
		var playeridA=ba.readInt();
		var playeridB=ba.readInt();
		this.mapCitySession.getCityPlayer(playeridA).inviteToPlayerId=0;
		this.mapCitySession.getCityPlayer(playeridB).removeFromPlayerList(playeridA);
		FlyUpTips.setTips("取消申请成功！");
		App.eventManager.event("WAIJIAO_FLUSH");
	}

	__proto.jieMeng=function(ba){
		var playeridA=ba.readInt();
		var playeridB=ba.readInt();
		this.mapCitySession.getCityPlayer(playeridA).inviteToPlayerId=playeridB;
		this.mapCitySession.getCityPlayer(playeridB).inviteFromPlayerList.push(playeridA);
		FlyUpTips.setTips("结盟申请提交成功，等待对方回应！");
		App.eventManager.event("WAIJIAO_FLUSH");
	}

	__proto.enterMap=function(ba){
		var playerData=this.addPlayer(ba);
		console.log("进地图",this.mapCitySession.getCity(playerData.firstCityId).sysCity.cityName);
		App.eventManager.event("ADD_CITY_PLAYER",playerData);
		if(playerData.playerId==this.mainPlayerSession.mainPlayerData.playerId){
			this.mapCitySession.setOpenWarTime(ba.readInt());
			Dialog.manager.closeAll();
			App.eventManager.event("ENTER_MAP");
		}
	}

	// App.eventManager.event(MyEvent.CHECK_GUIDE);
	__proto.exitMap=function(ba){
		var exitPlayerId=ba.readInt();
		this.mapCitySession.removeCityPlayer(exitPlayerId);
	}

	__proto.addAction=function(ba){
		var wujiangSession=App.getSession("wuJiangSession");
		var actionNum=ba.readInt();
		for(var i=0;i < actionNum;i++){
			var actionData=new ActionData();
			actionData.actionId=ba.readLong();
			actionData.actionType=ba.readByte();
			actionData.actionPlayerId=ba.readInt();
			actionData.fromId=ba.readInt();
			actionData.toId=ba.readInt();
			var cityData=this.mapCitySession.getCity(actionData.toId);
			if(actionData.actionType==3 && cityData.playerId==this.mainPlayerSession.mainPlayerData.playerId && actionData.actionPlayerId !=this.mainPlayerSession.mainPlayerData.playerId){
				actionData.isWeixian=1;
				}else{
				actionData.isWeixian=0;
			};
			var endTime=ba.readInt();
			actionData.remainingTime=endTime-GameUtils.GetServerTime();
			actionData.jiasuTimes=ba.readInt();
			actionData.endTime=endTime;
			if(actionData.actionPlayerId==this.mainPlayerSession.mainPlayerData.playerId){
				actionData.yubeiyiNum=ba.readInt();
				actionData.heroList.length=0;
				var heroNum=ba.readByte();
				for(var j=0;j < heroNum;j++){
					var heroId=ba.readInt();
					if(heroId !=-1){
						var heroData=wujiangSession.getHero(heroId);
						heroData.cityId=-1;
						heroData.soldier=ba.readInt();
						heroData.heroState=1;
						actionData.heroList.push(heroData);
					}
				}
			}
			this.mapCitySession.addAction(actionData);
			console.log("添加action==========="+actionData.actionId,actionData.remainingTime);
		}
		App.eventManager.event("UPDATE_XINGJUN_LIST");
	}

	__proto.updatePlayerList=function(ba){
		var playerNum=ba.readInt();
		for(var i=0;i < playerNum;i++){
			var playerData=this.addPlayer(ba);
			if(playerData==null){
				continue ;
			};
			var playerType=ba.readByte();
			playerData.playerType=playerType;
			if(playerType==CityPlayerType.SELF){
				playerData.tongqian=ba.readInt();
				playerData.liangcao=ba.readInt();
				var cityNum=ba.readInt();
				for(var j=0;j < cityNum;j++){
					this.setCityInfo(ba,playerData);
				}
				playerData.inviteToPlayerId=ba.readInt();
				var invitedFromNum=ba.readInt();
				playerData.inviteFromPlayerList.length=0;
				for(j=0;j < invitedFromNum;j++){
					playerData.inviteFromPlayerList.push(ba.readInt());
				}
				this.mapCitySession.selfDataInfo=playerData;
			}
			else if(playerType==CityPlayerType.FRIEND){
				console.log("盟友======="+playerData.playerName,playerData.playerType);
				cityNum=ba.readInt();
				for(j=0;j < cityNum;j++){
					this.setCityInfo(ba,playerData);
				}
			}
			else if(playerType==CityPlayerType.ENEMY){
				cityNum=ba.readInt();
				for(j=0;j < cityNum;j++){
					var cityId=ba.readInt();
					var cityData=this.mapCitySession.getCity(cityId);
					cityData.playerId=playerData.playerId;
					cityData.playerType=playerData.playerType;
					cityData.heroObj=new Object();
				}
			}
		}
		console.log("地图上的玩家信息");
		this.mapCitySession.isGoMapCity=1;
		App.eventManager.event("GOTO_MAPCITY");
		App.eventManager.event("UPDATE_PLAYER_LIST");
		App.eventManager.event("SET_POSITION",[this.mapCitySession.selfDataInfo.firstCityId,0,0]);
		App.eventManager.event("WAIJIAO_FLUSH");
		this.mapCitySession.timerStart();
	}

	__proto.innerCityInfo=function(ba){
		this.mapCitySession.innerCityId=ba.readInt();
		this.mapCitySession.isAutoBubing=ba.readByte();
		this.mapCitySession.autoLvNum=ba.readInt();
		this.mapCitySession.innerCityYubeiyi=ba.readInt();
		this.mapCitySession.innerTongqianOutput=ba.readInt();
		this.mapCitySession.innerFoodOutput=ba.readInt();
		this.mapCitySession.innerYubeiyiOutput=ba.readInt();
		this.mapCitySession.innerBuildObj=new Object();
		this.mapCitySession.timeObj={};
		var buildNum=ba.readByte();
		for(var i=0;i < buildNum;i++){
			var innerBuildData=new BuildData();
			innerBuildData.cityId=this.mapCitySession.innerCityId;
			innerBuildData.index=ba.readByte();
			innerBuildData.isHas=ba.readByte();
			if(innerBuildData.isHas==1){
				innerBuildData.type=ba.readByte();
				innerBuildData.lv=ba.readInt();
				innerBuildData.sysBuilding=ConfigManager.getConfig("sys_building.txt",innerBuildData.type+"_"+innerBuildData.lv);
				var time=ba.readInt();
				innerBuildData.endTime=time==0 ? 0 :time-GameUtils.GetServerTime();
				innerBuildData.time=time;
			}
			if(innerBuildData.endTime>0){
				this.mapCitySession.timeObj[innerBuildData.index]=innerBuildData
			}
			this.mapCitySession.innerBuildObj[innerBuildData.index]=innerBuildData;
		}
		App.eventManager.event("GOTO_CITY_INNER");
		console.log("城内信息");
	}

	__proto.upgradeBuildSuccess=function(ba){
		var cityId=ba.readInt();
		var buildIndex=ba.readByte();
		var buildData=this.mapCitySession.getBuildDataByIndex(buildIndex);
		buildData.type=ba.readByte();
		buildData.isHas=1;
		buildData.lv=ba.readInt();
		buildData.sysBuilding=ConfigManager.getConfig("sys_building.txt",buildData.type+"_"+buildData.lv);
		var time=ba.readInt();
		buildData.time=time;
		buildData.endTime=time==0 ? 0 :time-GameUtils.GetServerTime();
		if(buildData.endTime>0){
			this.mapCitySession.timeObj[buildData.index]=buildData;
		}
		else{
		}
		App.eventManager.event("BUILD_LVUP_SUCCESS",buildData);
	}

	__proto.updateSoldierInfo=function(ba){
		var playerId=ba.readInt();
		var cityPlayerData=this.mapCitySession.getCityPlayer(playerId);
		var zhenchaTime=ba.readInt();
		console.log("侦查时间-----------"+zhenchaTime);
		var cityData=this.setCityInfo(ba,cityPlayerData);
		cityData.zhenchaTime=zhenchaTime;
		console.log("调整兵力成功");
		App.eventManager.event("UPDATE_CITY_INFO",[cityData,cityPlayerData]);
		var arr=this.mapCitySession.getActionAll();
		var boo=false;
		for(var i=0;i<arr.length;i++){
			var actionData=arr[i];
			if(actionData.actionType==3 && cityData.cityId==actionData.toId && cityData.playerId==this.mainPlayerSession.mainPlayerData.playerId && actionData.actionPlayerId !=this.mainPlayerSession.mainPlayerData.playerId){
				actionData.isWeixian=1;
				}else{
				actionData.isWeixian=0;
			}
		}
		App.eventManager.event("WEIXIAN_UPDATE");
	}

	__proto.addBattle=function(ba){
		var battle=new BattleReportData();
		battle.battleId=ba.readLong();
		battle.cityId=ba.readInt();
		battle.startTime=ba.readInt();
		battle.endTime=ba.readInt();
		battle.actionId=ba.readLong();
		battle.battleFileUrl=ba.readUTF();
		battle.remainingTime=battle.endTime-GameUtils.GetServerTime();
		this.mapCitySession.addBattle(battle);
		this.mapCitySession.updateAction(battle);
		console.log("添加一场战斗，id===="+battle.actionId,battle.remainingTime);
	}

	__proto.updateCityInfo=function(ba){
		var cityData=this.mapCitySession.getCity(ba.readInt());
		cityData.yubeiyiNum=ba.readInt();
		App.eventManager.event("UPDATE_CITY_INFO",[cityData,this.mapCitySession.getCityPlayer(cityData.playerId)]);
		console.log("更新城池预备役========"+cityData.cityId,cityData.sysCity.cityName,cityData.yubeiyiNum);
	}

	__proto.updateLiangcao=function(ba){
		var tongqian=ba.readInt();
		var liangcao=ba.readInt();
		if(this.mapCitySession.selfDataInfo){
			this.mapCitySession.selfDataInfo.tongqian=tongqian;
			this.mapCitySession.selfDataInfo.liangcao=liangcao;
			console.log("粮草============"+liangcao);
			App.eventManager.event("UPDATE_QIAN_LIANG");
		}
	}

	__proto.gameOver=function(ba){
		this.mapCitySession.gameOverData=new GameOverData();
		this.mapCitySession.gameOverData.year=ba.readInt();
		this.mapCitySession.gameOverData.killEnemyNum=ba.readInt();
		this.mapCitySession.gameOverData.maxCityNum=ba.readInt();
		this.mapCitySession.gameOverData.timeExp=ba.readInt();
		this.mapCitySession.gameOverData.taskType=ba.readInt();
		this.mapCitySession.gameOverData.tongyiReward=ba.readInt();
		this.mapCitySession.gameOverData.dutongReward=ba.readInt();
		this.mapCitySession.gameOverData.type=ba.readByte();
		this.mapCitySession.gameOverData.playerName=ba.readUTF();
		this.mapCitySession.gameOverData.grade=ba.readInt();
		this.mapCitySession.gameOverData.bawang=ba.readByte();
		this.mapCitySession.gameOverData.zhanshen=ba.readByte();
		this.mapCitySession.gameOverData.zhizhe=ba.readByte();
		this.mapCitySession.gameOverData.xibai=ba.readByte();
		this.mapCitySession.gameOverData.dizanList.length=0;
		var size=ba.readInt();
		this.dianZanSession.clearData();
		for(var i=0;i < size;i++){
			var playerId=ba.readInt();
			var playerName=ba.readUTF();
			var playerStyle=ba.readInt();
			this.mapCitySession.gameOverData.dizanList.push([playerId,playerName,playerStyle]);
			this.dianZanSession.addData(playerId,playerName,playerStyle);
		}
		GameState.state=6;
		App.eventManager.event("REMOVEDROPGIFT");
		console.log("掉落本局结束");
		App.eventManager.event("GAME_OVER");
		console.log("本局结束");
		this.wuJiangSession.clearState();
	}

	__proto.zhenchaSuccess=function(ba){
		var cityId=ba.readInt();
		App.dialogManager.openDialogByStr("QINGBAO",{cityId:cityId},true,true);
		FlyUpTips.setTips("侦查成功，6小时之内均可查看该城池的信息");
	}

	__proto.setZhanbaoList=function(ba){
		this.mapCitySession.zhanbaoList.length=0;
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			this.addOneZhanbao(ba,false);
		}
		this.mapCitySession.checkZhanBao();
	}

	__proto.addOneZhanbao=function(ba,isNew){
		var zhanbaoData=new ZhanBaoData();
		zhanbaoData.battleId=ba.readLong();
		zhanbaoData.startTime=ba.readInt();
		zhanbaoData.cityId=ba.readInt();
		zhanbaoData.isAttack=ba.readByte();
		zhanbaoData.secondName=ba.readUTF();
		zhanbaoData.isWin=ba.readByte();
		zhanbaoData.isRead=ba.readByte();
		console.log("战报状态",zhanbaoData.isRead);
		if(isNew){
			this.mapCitySession.zhanbaoList.unshift(zhanbaoData);
			App.eventManager.event("ADD_ZHANBAO");
		}
		else{
			this.mapCitySession.zhanbaoList.push(zhanbaoData);
		}
		this.mapCitySession.checkZhanBao();
	}

	__proto.setJianBao=function(ba){
		var zhanbaoInfo=new JianbaoData();
		zhanbaoInfo.battleId=ba.readLong();
		zhanbaoInfo.cityId=ba.readInt();
		zhanbaoInfo.isWin=ba.readByte();
		zhanbaoInfo.attName=ba.readUTF();
		zhanbaoInfo.attBingli=ba.readInt();
		zhanbaoInfo.attLoseBingli=ba.readInt();
		zhanbaoInfo.defName=ba.readUTF();
		zhanbaoInfo.defBingli=ba.readInt();
		zhanbaoInfo.defLoseBingli=ba.readInt();
		zhanbaoInfo.exp=ba.readInt();
		zhanbaoInfo.deltaExp=ba.readInt();
		zhanbaoInfo.battleFileUrl=ba.readUTF();
		App.dialogManager.openDialogByStr("JIANBAO",{data:zhanbaoInfo},true,true);
	}

	__proto.setCitysLevel=function(ba){
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			this.setCityLevel(ba);
		}
	}

	__proto.setCityLevel=function(ba){
		var cityData=this.mapCitySession.getCity(ba.readInt());
		cityData.level=ba.readInt();
	}

	__proto.addPlayer=function(ba){
		var playerId=ba.readInt();
		if(playerId==0){
			return null;
		};
		var playerData=new CityPlayerData();
		playerData.playerId=playerId;
		playerData.playerName=ba.readUTF();
		playerData.headId=ba.readInt();
		playerData.guanzhiId=ba.readInt();
		playerData.playerLv=ba.readInt();
		playerData.firstCityId=ba.readInt();
		playerData.mengyouId=ba.readInt();
		ba.readInt();
		playerData.diduidu=ba.readInt();
		playerData.isChoudi=ba.readByte();
		playerData.isBaijiang=ba.readByte();
		var firstCity=ConfigManager.getConfig("sys_city.txt",playerData.firstCityId);
		playerData.cityFlag=firstCity.cityFlag;
		this.mapCitySession.addCityPlayer(playerData);
		var cityData=this.mapCitySession.getCity(playerData.firstCityId);
		if(this.mapCitySession.selfDataInfo !=null && playerData.playerId==this.mapCitySession.selfDataInfo.mengyouId){
			cityData.playerType=CityPlayerType.FRIEND;
			playerData.playerType=CityPlayerType.FRIEND;
		}
		else{
			cityData.playerType=CityPlayerType.ENEMY;
			playerData.playerType=CityPlayerType.ENEMY;
		}
		return playerData;
	}

	__proto.setCityInfo=function(ba,cityPlayerData){
		var cityId=ba.readInt();
		var cityData=this.mapCitySession.getCity(cityId);
		cityData.playerId=cityPlayerData.playerId;
		cityData.playerType=cityPlayerData.playerType;
		cityData.clear();
		cityData.heroObj=new Object();
		var wujiangSession=App.getSession("wuJiangSession");
		var heroChildNum=ba.readInt();
		var yubeiyiNum=ba.readInt();
		var heroNum=ba.readInt();
		for(var i=0;i < heroNum;i++){
			var heroId=ba.readInt();
			var heroData;
			var test=false;
			if(cityPlayerData.playerType==CityPlayerType.SELF){
				heroData=wujiangSession.getHero(heroId);
				if(heroData==null){
					console.log("ERROR setCityInfo :"+heroId);
					heroData=new HeroData();
					test=true;
				}
				heroData.heroState=2;
			}
			else{
				heroData=new HeroData();
			}
			heroData.heroId=heroId;
			heroData.heroLv=ba.readInt();
			heroData.index=i;
			heroData.cityId=cityId;
			heroData.soldier=ba.readInt();
			cityData.heroObj[heroData.heroId]=heroData;
			if(test){
				console.log("hero data :",heroData);
			}
			console.log("城池的兵力信息",cityId,heroId,heroData.soldier);
		};
		var xiefangHeroNum=ba.readInt();
		var xiefangChildNum=0;
		if(xiefangHeroNum > 0){
			xiefangChildNum=ba.readInt();
			for(i=0;i < xiefangHeroNum;i++){
				if(cityPlayerData.playerType==CityPlayerType.SELF){
					heroData=wujiangSession.getHero(heroId);
					if(heroData==null){
						console.log("这个武将没有",cityPlayerData.playerName,heroId);
						heroData=new HeroData();
					}
					heroData.heroState=3;
				}
				else{
					heroData=new HeroData();
				}
				heroData.heroId=ba.readInt();
				heroData.heroLv=ba.readInt();
				heroData.index=i;
				heroData.cityId=cityId;
				heroData.soldier=ba.readInt();
				cityData.xiefangHeroObj[heroData.heroId]=heroData;
			}
		}
		cityData.heroNum=heroNum+xiefangHeroNum;
		cityData.childNum=heroChildNum+xiefangChildNum;
		cityData.yubeiyiNum=yubeiyiNum;
		return cityData;
	}

	__proto.setEveryHourChanliang=function(ba){
		var tongqian=ba.readInt();
		var liangcao=ba.readInt();
		App.eventManager.event("SHOW_CHANLIANG",[tongqian,liangcao]);
	}

	__proto.onStart=function(){
		this.startByAction();
		this.putByte(1);
		this.send();
	}

	/**type 1:出征自己城池,2:出征盟友城池,3:出征敌方城池*/
	__proto.onChuzheng=function(type,fromId,toId,bingli,heroIds,jiceType){
		(bingli===void 0)&& (bingli=0);
		(jiceType===void 0)&& (jiceType=0);
		this.startByAction();
		this.putByte(13);
		this.putInt(type);
		this.putInt(fromId);
		this.putInt(toId);
		this.putByte(jiceType);
		if(type==0){
			this.putInt(bingli);
		}
		else{
			this.putInt(heroIds.length);
			for(var i=0;i < heroIds.length;i++){
				this.putByte(heroIds[i][0]);
				this.putInt(heroIds[i][1]);
			}
		}
		this.send();
	}

	/**
	*
	*@param cityId
	*@param index 0:太守府，1-10对应的位置
	*@param type 0:太守府,1:民居,2:集市,3:农田
	*
	*/
	__proto.onLvupBuild=function(cityId,index,type){
		this.startByAction();
		this.putByte(11);
		this.putInt(cityId);
		this.putInt(index);
		this.putInt(type);
		this.send();
	}

	__proto.onRemoveBuild=function(cityId,index){
		this.startByAction();
		this.putByte(12);
		this.putInt(cityId);
		this.putInt(index);
		this.send();
	}

	/**进去城池*/
	__proto.onEnterCityById=function(cityId){
		this.startByAction();
		this.putByte(8);
		this.putInt(cityId);
		this.send();
	}

	__proto.onExitCityById=function(cityId){
		this.startByAction();
		this.putByte(9);
		this.putInt(cityId);
		this.send();
	}

	__proto.onSetBingli=function(cityId,heroArr){
		this.startByAction();
		this.putByte(10);
		this.putInt(cityId);
		var size=heroArr.length;
		this.putInt(size);
		for(var i=0;i < size;i++){
			var arr=heroArr[i];
			this.putInt(arr[0]);
			this.putInt(arr[1]);
			console.log("兵力信息",arr[0],arr[1]);
		}
		this.send();
	}

	__proto.onSwapHero=function(cityId,pos1,pos2){
		this.startByAction();
		this.putByte(18);
		this.putInt(cityId);
		this.putInt(pos1);
		this.putInt(pos2);
		this.send();
	}

	__proto.onAutoBubing=function(isBu){
		this.startByAction();
		this.putByte(20);
		this.putByte(isBu);
		this.send();
	}

	__proto.onAutoLv=function(num){
		this.startByAction();
		this.putByte(21);
		this.putInt(num);
		this.send();
	}

	__proto.onZhencha=function(cityId){
		this.startByAction();
		this.putByte(22);
		this.putInt(cityId);
		console.log("侦查"+cityId);
		this.send();
	}

	//申请同盟
	__proto.sendShenQingJiaMeng=function(playerId){
		this.startByAction();
		this.putByte(4);
		this.putInt(playerId);
		this.send();
	}

	//取消申请同盟
	__proto.sendQuXiaoShenQingJiaMeng=function(playerId){
		this.startByAction();
		this.putByte(5);
		this.putInt(playerId);
		this.send();
	}

	//同意结盟
	__proto.sendTongYiJieMeng=function(playerId){
		this.startByAction();
		this.putByte(6);
		this.putInt(playerId);
		this.send();
	}

	//投降
	__proto.sendTouXiang=function(){
		this.startByAction();
		this.putByte(7);
		this.send();
	}

	//请求城池列表
	__proto.sendCityList=function(){
		this.startByAction();
		this.putByte(24);
		this.send();
		console.log("请求城市列表--》");
	}

	__proto.sendJieSanAllJeneral=function(){
		this.startByAction();
		this.putByte(25);
		this.send();
	}

	__proto.onZhanbaoList=function(){
		this.startByAction();
		this.putByte(14);
		this.send();
	}

	__proto.onEveryHourZhanliang=function(){
		console.log("请求产量");
		this.startByAction();
		this.putByte(23);
		this.send();
	}

	__proto.onZhanbaoAllRead=function(){
		this.startByAction();
		this.putByte(16);
		this.send();
	}

	__proto.onJianbao=function(battleId){
		this.startByAction();
		this.putByte(15);
		this.putLong(battleId);
		this.send();
	}

	/**
	*
	*@param actionId
	*@param type 0道具 1元宝
	*
	*/
	__proto.onJiasu=function(actionId,type){
		this.startByAction();
		this.putByte(17);
		this.putLong(actionId);
		this.putByte(type);
		this.send();
	}

	__proto.onChefang=function(cityId){
		this.startByAction();
		this.putByte(27);
		this.putInt(cityId);
		this.send();
	}

	/**
	*
	*@param cityId
	*@param type 0道具 1元宝
	*
	*/
	__proto.onZhaobing=function(cityId,type){
		this.startByAction();
		this.putByte(28);
		this.putInt(cityId);
		this.putByte(type);
		this.send();
	}

	__proto.onNenggong=function(type){
		this.startByAction();
		this.putByte(29);
		this.putByte(type);
		this.send();
	}

	__proto.onLuban=function(type){
		this.startByAction();
		this.putByte(30);
		this.putByte(type);
		this.send();
	}

	__proto.clearData=function(){
		this.startByAction();
		this.putByte(31);
		this.send();
	}

	__proto.onZudui=function(){
		this.startByAction();
		this.putByte(32);
		this.send();
	}

	__proto.onYaoqing=function(playerId){
		this.startByAction();
		this.putByte(2);
		this.putInt(playerId);
		this.send();
	}

	__proto.onCancelYaoqing=function(playerId){
		this.startByAction();
		this.putByte(19);
		this.putInt(playerId);
		this.send();
	}

	__proto.onTongyiYaoqing=function(playerId){
		this.startByAction();
		this.putByte(3);
		this.putInt(playerId);
		this.send();
	}

	__proto.onJujueYaoqing=function(playerId){
		this.startByAction();
		this.putByte(33);
		this.putInt(playerId);
		this.send();
	}

	__proto.sendGuideWuJiang=function(type){
		this.startByAction();
		this.putByte(34);
		this.putInt(type);
		this.send();
	}

	__proto.sendDropGift=function(){
		this.startByAction();
		this.putByte(35);
		this.send();
	}

	MapCityAction.MATCH=1;
	MapCityAction.TEAM_INVITE=2;
	MapCityAction.TEAM_ACCEPT=3;
	MapCityAction.ALLY_INVITE=4;
	MapCityAction.ALLY_INVITE_CANCEL=5;
	MapCityAction.ALLY_ACCEPT=6;
	MapCityAction.CAPITULATE=7;
	MapCityAction.ENTER_CITY=8;
	MapCityAction.EXIT_CITY=9;
	MapCityAction.TROOPS_SET=10;
	MapCityAction.UPGRADE_BUILD=11;
	MapCityAction.REMOVE_BUILD=12;
	MapCityAction.MAP_ACTION=13;
	MapCityAction.ZHAN_BAO_LIST=14;
	MapCityAction.BATTLE_INFO=15;
	MapCityAction.BATTLE_READALL=16;
	MapCityAction.JIASU=17;
	MapCityAction.SWAP_HERO=18;
	MapCityAction.CANCEL_ZUDUI=19;
	MapCityAction.AUTO_ADDSOLDIER=20;
	MapCityAction.AUTO_UPGRADEBUILD=21;
	MapCityAction.ZHENCHA=22;
	MapCityAction.EVERY_HOUR_CHANLIANG=23;
	MapCityAction.CITY_LIST_INFO=24;
	MapCityAction.DISSOLVE_ALLHERO=25;
	MapCityAction.ADD_ZHAOBAO=26;
	MapCityAction.CHEFANG=27;
	MapCityAction.ZHAOBINGMAIMA=28;
	MapCityAction.NENGGONGQIAOJIANG=29;
	MapCityAction.LUBANZAISHI=30;
	MapCityAction.CLEARDATA=31;
	MapCityAction.ZUDUI=32;
	MapCityAction.JUJUE_YAOQING=33;
	MapCityAction.MAP_STEP=34;
	MapCityAction.Drop_Gift=35;
	MapCityAction.XIUXI=50;
	MapCityAction.ENTER=51;
	MapCityAction.EXIT=52;
	MapCityAction.ALLY=53;
	MapCityAction.GAMEPLAYER_INFO=54;
	MapCityAction.GAMEACTION_INFO=55;
	MapCityAction.COPPER_INFO=56;
	MapCityAction.TROOPS_INFO=57;
	MapCityAction.SOLDIER_INFO=58;
	MapCityAction.CITY_INFO=59;
	MapCityAction.BUILD_INFO=60;
	MapCityAction.CITY_BATTLE=61;
	MapCityAction.GAME_OVER=62;
	MapCityAction.CITY_LV_ONE=63;
	MapCityAction.CITY_LV_LIST=64;
	MapCityAction.ALLY_TROOPS_INFO=65;
	MapCityAction.HostileDegrees=66;
	MapCityAction.Defeated=67;
	MapCityAction.ZHAOBINGMAIMA_TIMES=68;
	MapCityAction.VICTORYDROPGIFT=70;
	MapCityAction.NEWVICTORYDROPGIFT=71;
	MapCityAction.TIPSGONGGAO=72;
	return MapCityAction;
})(Action)


//class huamao.action.Md5Action extends game.mvc.Action
var Md5Action=(function(_super){
	function Md5Action(){
		this.dotSesion=null;
		Md5Action.__super.call(this);
		App.injOne(this);
	}

	__class(Md5Action,'huamao.action.Md5Action',_super);
	var __proto=Md5Action.prototype;
	__proto.execute=function(ba){
		var type=ba.readInt();
		var content=ba.readUTF();
		var sign=ba.readUTF();
		this.dotSesion.md5Reback(type,content,sign);
	}

	return Md5Action;
})(Action)


//class huamao.action.NewPlayerTaskAction extends game.mvc.Action
var NewPlayerTaskAction=(function(_super){
	function NewPlayerTaskAction(){
		this.taskSession=null;
		NewPlayerTaskAction.__super.call(this);
	}

	__class(NewPlayerTaskAction,'huamao.action.NewPlayerTaskAction',_super);
	var __proto=NewPlayerTaskAction.prototype;
	__proto.execute=function(ba){
		var end=ba.readByte();
		var taskid=ba.readInt();
		var exp=ba.readInt();
		var isOk=ba.readByte();
		var td=this.taskSession.typeNewplayer;
		if(this.taskSession.typeNewplayer==null){
			td=this.taskSession.typeNewplayer=new TaskData();
			td.type=102;
		}
		td.isOk=isOk;
		td.end=0;
		td.taskId=taskid;
		td.nowValue=exp;
		td.status=td.isOk?3:2;
		td.systask=ConfigManager.getConfig("sys_task.txt",taskid);
		if(ba.readByte()==1){
			taskid=ba.readInt();
			exp=ba.readInt();
			isOk=ba.readByte();
			td=this.taskSession.typeNewplayerNo;
			if(this.taskSession.typeNewplayerNo==null || this.taskSession.typeNewplayerNo==this.taskSession.typeNewplayer){
				td=this.taskSession.typeNewplayerNo=new TaskData();
				td.type=102;
			}
			td.isOk=isOk;
			td.end=0;
			td.taskId=taskid;
			td.nowValue=exp;
			td.status=td.isOk?3:2;
			td.systask=ConfigManager.getConfig("sys_task.txt",taskid);
		}
		this.taskSession.typeNewplayerNo=this.taskSession.typeNewplayer;
		if(end==1){
			this.taskSession.typeNewplayerNo.status=0;
			this.taskSession.typeNewplayer.status=0;
		}
		this.taskSession.sessionUpdataEvent("huamao.YouEvent.UPDATA_TASK_DATA");
	}

	__proto.sendTask=function(){
		this.startByAction();
		this.send();
	}

	return NewPlayerTaskAction;
})(Action)


//class huamao.action.PaoMaAction extends game.mvc.Action
var PaoMaAction=(function(_super){
	function PaoMaAction(){
		//夺宝
		this.settingSession=null;
		PaoMaAction.__super.call(this);
	}

	__class(PaoMaAction,'huamao.action.PaoMaAction',_super);
	var __proto=PaoMaAction.prototype;
	__proto.execute=function(ba){
		if(this.settingSession.isOpenByKey(4)==false){
			return;
		};
		var type=ba.readInt();
		switch(type){
			case 1:
				this.kaiZhan(ba);
				break ;
			case 2:
				this.kingLogion(ba);
				break ;
			case 3:
				this.kaiZhanInWar(ba);
				break ;
			case 4:
				this.duoBao(ba);
				break ;
			}
	}

	__proto.kaiZhan=function(ba){
		var cityid=ba.readInt();
		var syscity=ConfigManager.getConfig("sys_city.txt",cityid);
		var sysTips=ConfigManager.getConfig("sys_tips.txt",5001);
		var des=sysTips.tipsDescribe;
		var result=GameUtils.replaceLocaleConfigFH(des,[syscity.cityName]);
		console.log("跑马 --》"+result);
		PaoMaTips.getMe().setTips(result);
	}

	__proto.kingLogion=function(ba){
		var name=ba.readUTF();
		var sysTips=ConfigManager.getConfig("sys_tips.txt",5002);
		var des=sysTips.tipsDescribe;
		var result=GameUtils.replaceLocaleConfigFH(des,[name]);
		PaoMaTips.getMe().setTips(result);
	}

	__proto.kaiZhanInWar=function(ba){
		var sysTips=ConfigManager.getConfig("sys_tips.txt",5005);
		var des=sysTips.tipsDescribe;
		PaoMaTips.getMe().setTips(des);
	}

	__proto.duoBao=function(ba){
		var name=ba.readUTF();
		var size=ba.readInt();
		name=" "+name+" ";
		var sysTips=ConfigManager.getConfig("sys_tips.txt",5003);
		var des=sysTips.tipsDescribe;
		var itemstr="";
		for(var i=0;i<size;i+=2){
			var itemid=ba.readInt();
			var itemnum=ba.readInt();
			var sysItem=ConfigManager.getConfig("sys_item.txt",itemid);
			var itemName=sysItem.itemName;
			if(itemstr.length==0){
				itemstr="["+itemName+"]"+"*"+itemnum;
				}else{
				itemstr=" "+"["+itemName+"]"+"*"+itemnum;
			}
		};
		var result=GameUtils.replaceLocaleConfigFH(des,[name,itemstr]);
		PaoMaTips.getMe().setTips(result);
	}

	PaoMaAction.FIGHT=1;
	PaoMaAction.KINGLOGIN=2;
	PaoMaAction.KAIZHAN=3;
	PaoMaAction.DUOBAO=4;
	return PaoMaAction;
})(Action)


//class huamao.action.PlayerInfoAction extends game.mvc.Action
var PlayerInfoAction=(function(_super){
	function PlayerInfoAction(){
		this.playerInfoSession=null;
		this.mainPlayerSession=null;
		this.remDaySalary=-1;
		this.praiseListIds=[];
		this.dianZanSession=null;
		PlayerInfoAction.__super.call(this);
		App.injOne(this);
	}

	__class(PlayerInfoAction,'huamao.action.PlayerInfoAction',_super);
	var __proto=PlayerInfoAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		switch(type){
			case 1:
				this.flushPlayerInfo(ba);
				break ;
			case 3:
				this.flushPlayerName(ba);
				break ;
			case 2:
				this.flushScore(ba);
				break ;
			case 13:
				this.getPlayerMes(ba);
				break ;
			case 4:
				this.flushDaySalaryStata(ba);
				break ;
			case 12:
				this.newScore(ba,true);
				break ;
			case 14:
				this.flushMonthGameTimes(ba);
				break ;
			case 6:
				this.flushJobBox(ba);
				break ;
			case 15:
				this.onPraiseList(ba);
				break ;
			case 11:
				this.onPraise(ba);
				break ;
			}
	}

	__proto.onPraise=function(ba){
		var playerId=ba.readInt();
		var isZan=ba.readBoolean();
		this.dianZanSession.setZan(playerId ,isZan?1:0);
	}

	__proto.onPraiseList=function(ba){
		this.praiseListIds.length=0;
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			var playerId=ba.readInt();
			this.praiseListIds.push(playerId);
			this.dianZanSession.setZan(playerId ,1);
		}
		App.eventManager.event("DIANZAN_LIST");
	}

	__proto.flushJobBox=function(ba){
		this.playerInfoSession.jobBoxList=ba.readUTF();
		App.eventManager.event("FLUSH_JOB_BOX");
		App.eventManager.event("REAPOINT",RedPointType.GUANZHI);
	}

	__proto.flushMonthGameTimes=function(ba){
		var size=ba.readInt();
		this.playerInfoSession.monthGameSize=size;
		App.eventManager.event("FLUSH_MONTHSALARY");
	}

	__proto.flushDaySalaryStata=function(ba){
		var old=this.playerInfoSession.daySalary;
		this.playerInfoSession.daySalary=ba.readInt();
		if(old !=this.playerInfoSession.daySalary){
			App.eventManager.event("FLUSH_MEJCLQZT");
			App.eventManager.event("REAPOINT",RedPointType.MEIR);
		}
	}

	__proto.getPlayerMes=function(ba){
		var one=new ViewPlayerMesData();
		one.playerId=ba.readInt();
		one.playerName=ba.readUTF();
		one.playerLv=ba.readInt();
		one.tortoise=ba.readInt();
		one.mars=ba.readInt();
		one.wise=ba.readInt();
		one.defeat=ba.readInt();
		one.playerJob=ba.readInt();
		one.heroNum=ba.readInt();
		one.gameTimes=ba.readInt();
		one.winTimes=ba.readInt();
		one.style=ba.readInt();
		var tips=App.dialogManager.showMiniDialog(TipsPlayerMessage,true,true);
		tips.setData(one);
	}

	__proto.newScore=function(ba,type){
		var one=new TplayerScorelog();
		one.type=ba.readInt();
		one.name=ba.readUTF();
		one.lv=ba.readInt();
		one.job=ba.readInt();
		one.jobScore=ba.readInt();
		one.exp=ba.readInt();
		one.straight=ba.readInt();
		one.addTime=ba.readInt();
		if(type){
			this.playerInfoSession.jifen=true;
			App.eventManager.event("GET_NEW_SCORE");
			App.eventManager.event("REAPOINT",RedPointType.JIFEN);
		}
		return one;
	}

	__proto.flushScore=function(ba){
		this.playerInfoSession.clearScoreLogAry();
		var size=ba.readInt();
		for(var i=0;i<size;i++){
			this.playerInfoSession.pushScorLog(this.newScore(ba,false));
		}
		App.dialogManager.showMiniDialog(TipsJiFenJiLu,true,true,true);
	}

	__proto.flushPlayerInfo=function(ba){
		this.playerInfoSession.daySalary=ba.readByte();
		this.playerInfoSession.monthSalary=ba.readInt();
		this.playerInfoSession.jobBoxList=ba.readUTF();
		this.playerInfoSession.styleList=ba.readUTF();
		this.playerInfoSession.cityStyleList=ba.readUTF();
		this.playerInfoSession.headFrameList=ba.readUTF();
		this.playerInfoSession.bannerList=ba.readUTF();
		this.playerInfoSession.monthMaxJob=ba.readInt();
		this.playerInfoSession.praise=ba.readInt();
		this.playerInfoSession.monthGameSize=ba.readInt();
		console.log("daySalary = "+this.playerInfoSession.daySalary);
		App.eventManager.event("FLUSH_MONTHSALARY");
		App.eventManager.event("REAPOINT",RedPointType.MEIR);
		App.eventManager.event("REAPOINT",RedPointType.MEIYUE);
		App.eventManager.event("REAPOINT",RedPointType.GUANZHI);
	}

	__proto.flushPlayerName=function(ba){
		var name=ba.readUTF();
		this.mainPlayerSession.mainPlayerData.playerName=name;
		App.eventManager.event("FLUSH_PLAYER_NAME");
	}

	__proto.sendGetDaySalary=function(){
		this.startByAction();
		this.putByte(4);
		this.send();
	}

	//领取官职礼包
	__proto.sendGetMonthPackage=function(){
		this.startByAction();
		this.putByte(5);
		this.send();
	}

	//改名
	__proto.sendChangeName=function(newname){
		this.startByAction();
		this.putByte(3);
		this.putUtf(newname);
		this.send();
	}

	//请求积分记录
	__proto.sendScoreList=function(){
		this.startByAction();
		this.putByte(2);
		this.send();
	}

	//请求查看玩家信息
	__proto.sendViewPlayerMes=function(playerid){
		this.startByAction();
		this.putByte(13);
		this.putInt(playerid);
		this.send();
	}

	//请求领取官职礼包
	__proto.sendGetJobBox=function(jobid){
		this.startByAction();
		this.putByte(6);
		this.putInt(jobid);
		this.send();
	}

	__proto.sendDianzan=function(playerId,isDian){
		this.startByAction();
		this.putByte(11);
		this.putInt(playerId);
		this.putByte(isDian);
		this.send();
	}

	__proto.getDianzanList=function(){
		this.startByAction();
		this.putByte(15);
		this.send();
	}

	//请求县长升职
	__proto.sendXZRaise=function(){
		this.startByAction();
		this.putByte(16);
		this.send();
	}

	PlayerInfoAction.PlayerInfo=1;
	PlayerInfoAction.ScorelogList=2;
	PlayerInfoAction.ChangeName=3;
	PlayerInfoAction.GetDaySalary=4;
	PlayerInfoAction.GetMonthSalary=5;
	PlayerInfoAction.GetJobBox=6;
	PlayerInfoAction.ChangeStyle=7;
	PlayerInfoAction.ChangeCityStyle=8;
	PlayerInfoAction.ChangeHeadFrame=9;
	PlayerInfoAction.ChangeBanner=10;
	PlayerInfoAction.Praise=11;
	PlayerInfoAction.NewScorelog=12;
	PlayerInfoAction.CheckPlayerMessage=13;
	PlayerInfoAction.MonthGameTimes=14;
	PlayerInfoAction.PraiseList=15;
	PlayerInfoAction.IF_Job_XZ=16;
	return PlayerInfoAction;
})(Action)


//class huamao.action.RankAction extends game.mvc.Action
var RankAction=(function(_super){
	function RankAction(){
		// 月获赞排行
		this.rankSession=null;
		this.index=0;
		RankAction.__super.call(this);
	}

	__class(RankAction,'huamao.action.RankAction',_super);
	var __proto=RankAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		this.rankSession.resetListByType(type);
		this.index=0;
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			this.addOneData(type,ba);
		}
		App.eventManager.event("REFRESH_RANK",[type]);
	}

	__proto.addOneData=function(type,ba){
		var data=new RankData();
		data.playerId=ba.readInt();
		data.playerName=ba.readUTF();
		data.job=ba.readInt();
		this.index++;
		data.index=this.index;
		data.type=type;
		if(type==1){
			data.playerLv=ba.readInt();
			data.jobScore=ba.readInt();
		}
		else{
			data.praise=ba.readInt();
		}
		this.rankSession.addData(data);
	}

	__proto.getListByType=function(type){
		this.startByAction();
		this.putByte(type);
		this.send();
	}

	RankAction.RANK_JOB=1;
	RankAction.RANK_LIKE=2;
	RankAction.RANK_MONTHLIKE=3;
	return RankAction;
})(Action)


//class huamao.action.RechargeAction extends game.mvc.Action
var RechargeAction=(function(_super){
	function RechargeAction(){
		this.rechargeSession=null;
		RechargeAction.__super.call(this);
	}

	__class(RechargeAction,'huamao.action.RechargeAction',_super);
	var __proto=RechargeAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		switch(type){
			case 1:
				this.rechargeSession.rechargeStr=ba.readUTF();
				this.rechargeSession.vipStr=ba.readUTF();
				App.eventManager.event("CHONGZHIUPDATA");
				break ;
			case 2:;
				var orderId=ba.readLong();
				var rtype=ba.readByte();
				var id=ba.readInt();
				this.rechargeSession.setRecharGeSdkJson(rtype,id,orderId);
				break ;
			}
	}

	/**
	*vipID
	*@param id
	*
	*/
	__proto.lingVip=function(id){
		this.startByAction();
		this.putByte(3);
		this.putInt(id);
		this.send();
	}

	/**
	*充值
	*@param type 0购买元宝 1购买会员
	*@param id 充值id 或者会员id
	*@param str sdk平台
	*
	*/
	__proto.sendGoumai=function(type,id,str){
		this.startByAction();
		this.putByte(2);
		this.putByte(type);
		this.putInt(id);
		str=App.configJson["platformId"];
		this.putUtf(str);
		this.send();
	}

	return RechargeAction;
})(Action)


//class huamao.action.SettingAction extends game.mvc.Action
var SettingAction=(function(_super){
	function SettingAction(){
		//聊天设置
		this.settingSession=null;
		SettingAction.__super.call(this);
	}

	__class(SettingAction,'huamao.action.SettingAction',_super);
	var __proto=SettingAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		if(type==1){
			this.settingSession.setValue(ba.readUTF());
		}
		else if(type==2){
			}else if(type==3){
			var str=ba.readUTF();
			console.log("接收聊天设置 =--》"+str);
			this.settingSession.setTalkSetting(str);
		}
	}

	__proto.onSendMsg=function(type,value){
		this.startByAction();
		this.putByte(type);
		this.putUtf(value);
		this.send();
	}

	SettingAction.SIGNIN=1;
	SettingAction.CDK=2;
	SettingAction.TALK=3;
	return SettingAction;
})(Action)


//class huamao.action.SevenTaskAction extends game.mvc.Action
var SevenTaskAction=(function(_super){
	function SevenTaskAction(){
		this.sevenrenwuSession=null;
		SevenTaskAction.__super.call(this);
	}

	__class(SevenTaskAction,'huamao.action.SevenTaskAction',_super);
	var __proto=SevenTaskAction.prototype;
	__proto.execute=function(ba){
		var overDay=ba.readInt();
		var actDay=ba.readByte();
		var dataRenwu=ba.readUTF();
		this.sevenrenwuSession.overDay=overDay;
		this.sevenrenwuSession.actDay=actDay;
		this.sevenrenwuSession.isSevenXian=true;
		var renWuArr=dataRenwu.split(";");
		this.sevenrenwuSession.dataRenwu.length=0;
		for (var i=0;i < 7;i++){
			var seven=new SevenData();
			var item=renWuArr[i].toString().split(",");
			seven.activityId=item[0];
			seven.isLing=item[1];
			seven.btnDis=true;
			seven.programArr=item;
			this.sevenrenwuSession.dataRenwu.push(seven);
		}
		SevenData.actDay=this.sevenrenwuSession.actDay;
		App.eventManager.event("REAPOINT",RedPointType.HUODONG);
	}

	__proto.onSevenGift=function(actionId){
		this.startByAction();
		this.putInt(actionId);
		this.send();
	}

	return SevenTaskAction;
})(Action)


//class huamao.action.ShopAction extends game.mvc.Action
var ShopAction=(function(_super){
	function ShopAction(){
		//购买银币
		this.ifFist=false;
		this.shopSession=null;
		ShopAction.__super.call(this);
		App.injOne(this);
	}

	__class(ShopAction,'huamao.action.ShopAction',_super);
	var __proto=ShopAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readInt();
		switch(type){
			case ShopAction.SHOP_INTIMACY:
				this.getFlushIntimacy(ba);
				break ;
			case ShopAction.SHOP_ITEM:
				this.getFlushItem(ba);
				break ;
			case ShopAction.SHOP_CD:
				this.getFlushShopCd(ba);
				break ;
			}
	}

	__proto.getFlushShopCd=function(ba){
		var shopcd=ba.readLong();
		this.shopSession.setShopCd(shopcd);
	}

	__proto.getFlushIntimacy=function(ba){
		var intimacyLv=ba.readInt();
		var intimacyNum=ba.readInt();
		this.shopSession.setIntimacy(intimacyLv,intimacyNum);
	}

	__proto.getFlushItem=function(ba){
		var itemid1=ba.readInt();
		var itemStata1=ba.readInt();
		var itemid2=ba.readInt();
		var itemStata2=ba.readInt();
		var itemid3=ba.readInt();
		var itemStata3=ba.readInt();
		var remTimes=ba.readInt();
		console.log("itemid1 = "+itemid1+" itemid2 = "+itemid2+" itemid3 = "+itemid3);
		var iftips=this.shopSession.setItemAndStata(itemid1,itemStata1,itemid2,itemStata2,itemid3,itemStata3,remTimes);
		if(this.ifFist && iftips){
			FlyUpTips.setTips("您的装备购买列表已刷新!");
			}else{
			this.ifFist=true;
		}
	}

	__proto.sendBuyItem=function(index){
		this.startByAction();
		this.putInt(ShopAction.SHOP_BUY);
		this.putInt(index);
		this.send();
	}

	__proto.sendFlushItemOrClearCD=function(){
		this.startByAction();
		this.putInt(ShopAction.SHOP_FLUSH_OR_CLEARCD);
		this.send();
	}

	__proto.sendBuySilver=function(id){
		this.startByAction();
		this.putInt(ShopAction.SHOP_BUY_SILVER);
		this.putInt(id);
		this.send();
	}

	ShopAction.SHOP_INTIMACY=0;
	ShopAction.SHOP_ITEM=1;
	ShopAction.SHOP_CD=2;
	ShopAction.SHOP_FLUSH_OR_CLEARCD=1;
	ShopAction.SHOP_BUY=2;
	ShopAction.SHOP_BUY_SILVER=3;
	return ShopAction;
})(Action)


/**
*收藏分享action
*@author Administrator
*
*/
//class huamao.action.ShouFenAction extends game.mvc.Action
var ShouFenAction=(function(_super){
	function ShouFenAction(){
		this.shouFenSession=null;
		ShouFenAction.__super.call(this);
	}

	__class(ShouFenAction,'huamao.action.ShouFenAction',_super);
	var __proto=ShouFenAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		if(type==1){
			this.setList(ba);
		}
		else if(type==2){
			var data=this.setData(ba);
			App.eventManager.event("SHOUCANG_SUCCESS",[data.battleId]);
		}
		else if(type==3){
			var battleId=ba.readLong();
			delete this.shouFenSession.dataObj[battleId];
			App.eventManager.event("SHOUCANG_SUCCESS",[battleId]);
		}
	}

	// }
	__proto.setList=function(ba){
		var size=ba.readInt();
		for(var i=0;i < size;i++){
			this.setData(ba);
		}
	}

	__proto.setData=function(ba){
		var data=new ShouFenData();
		data.battleId=ba.readLong();
		data.type=ba.readInt();
		data.dateTime=ba.readInt();
		data.cityId=ba.readInt();
		data.battleType=ba.readByte();
		data.result=ba.readByte();
		data.attackName=ba.readUTF();
		data.attackBingli=ba.readInt();
		data.attackLoseBingli=ba.readInt();
		data.defenseName=ba.readUTF();
		data.defenseBingli=ba.readInt();
		data.defenseLoseBingli=ba.readInt();
		data.exp=ba.readInt();
		data.deltaExp=ba.readInt();
		data.battleFileUrl=ba.readUTF();
		this.shouFenSession.dataObj[data.battleId]=data;
		console.log("收藏的战报"+data);
		return data;
	}

	__proto.getList=function(){
		this.startByAction();
		this.putByte(1);
		this.send();
	}

	__proto.sendFenxiang=function(url,pindaoArr,friendArr){
		this.startByAction();
		this.putByte(4);
		this.putUtf(url);
		this.putInt(pindaoArr.length);
		for(var i=0;i < pindaoArr.length;i++){
			this.putInt(pindaoArr[i]);
		}
		this.putInt(friendArr.length);
		for(i=0;i < friendArr.length;i++){
			this.putInt(friendArr[i]);
		}
		this.send();
	}

	__proto.sendQuxiao=function(battleId){
		this.startByAction();
		this.putByte(3);
		this.putLong(battleId);
		this.send();
	}

	/**
	*
	*@param battleId
	*@param type 1地图战报 0好友战报 2
	*
	*/
	__proto.sendShoucang=function(battleId,type,obj){
		(type===void 0)&& (type=1);
		this.startByAction();
		this.putByte(2);
		this.putLong(battleId);
		this.putByte(type);
		if(type==2){
			this.putInt(obj.time);
			this.putInt(obj.cityId);
			this.putByte(obj.type);
			this.putByte(obj.result);
			this.putUtf(obj.atkName);
			this.putInt(obj.atkTroops);
			this.putInt(obj.atkLoseTroops);
			this.putUtf(obj.defenseName);
			this.putInt(obj.defenseTroops);
			this.putInt(obj.defenseLoseTroops);
			this.putInt(obj.exp);
			this.putInt(obj.newexp);
			this.putUtf(obj.URL);
		}
		this.send();
	}

	ShouFenAction.LIST=1;
	ShouFenAction.SHOUCANG=2;
	ShouFenAction.CANCEL=3;
	ShouFenAction.SHARE=4;
	return ShouFenAction;
})(Action)


//class huamao.action.SignInAction extends game.mvc.Action
var SignInAction=(function(_super){
	function SignInAction(){
		this.signInSession=null;
		SignInAction.__super.call(this);
	}

	__class(SignInAction,'huamao.action.SignInAction',_super);
	var __proto=SignInAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		if(type==1){
			this.signInSession.totalDays=ba.readInt();
			this.signInSession.curMonth=ba.readInt();
			this.signInSession.curMonthDays=ba.readInt();
			this.signInSession.rewardState=ba.readUTF();
			App.eventManager.event("QIANDAO_DATA");
			App.eventManager.event("REAPOINT",RedPointType.HUODONG);
		}
	}

	__proto.onSignIn=function(index){
		this.startByAction();
		this.putByte(2);
		this.putInt(index);
		this.send();
	}

	SignInAction.INIT=1;
	SignInAction.SIGNIN=2;
	return SignInAction;
})(Action)


//class huamao.action.StratagemAction extends game.mvc.Action
var StratagemAction=(function(_super){
	function StratagemAction(){
		//购买兑换令
		this.stratagemSession=null;
		StratagemAction.__super.call(this);
		App.injOne(this);
	}

	__class(StratagemAction,'huamao.action.StratagemAction',_super);
	var __proto=StratagemAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readInt();
		if(type==3){
			var stratagemCD=ba.readLong();
			this.stratagemSession.setStratagemCd(stratagemCD);
			}else if(type==4){
			var order=ba.readInt();
			var tips=ba.readInt();
			if(tips==1){
				var t=order-this.stratagemSession.getStratagemOrder();
				if(t > 0){
					FlyUpTips.setTips("获得"+(order-this.stratagemSession.getStratagemOrder())+"计策令");
				}
			}
			this.stratagemSession.setStratagemOrder(order);
			App.eventManager.event("REAPOINT",RedPointType.JICE);
		}
	}

	//研究计策
	__proto.sendStratagem=function(id){
		this.startByAction();
		this.putInt(1);
		this.putInt(id);
		this.send();
	}

	//清除计策cd
	__proto.sendClearStratagemCD=function(){
		this.startByAction();
		this.putInt(2);
		this.send();
	}

	//购买计策兑换令
	__proto.sendBuyStratagemOrder=function(){
		this.startByAction();
		this.putInt(5);
		this.send();
	}

	StratagemAction.STRATAGEM_RESEARCH=1;
	StratagemAction.STRATAGEM_CLEAR_CD=2;
	StratagemAction.STRATAGEM_FLUSHCD=3;
	StratagemAction.STRATAGEM_FLUSH_ORDER=4;
	StratagemAction.STRATAGEM_BUY_ORDER=5;
	return StratagemAction;
})(Action)


//class huamao.action.TalkAction extends game.mvc.Action
var TalkAction=(function(_super){
	function TalkAction(){
		//系统消息
		this.talkSession=null;
		this.sensitiveSession=null;
		TalkAction.__super.call(this);
		App.injOne(this);
	}

	__class(TalkAction,'huamao.action.TalkAction',_super);
	var __proto=TalkAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readInt();
		if(type==TalkAction.MESSAGE){
			var data=new OtherTalkData();
			data.channelId=ba.readInt();
			data.playerset=ba.readInt();
			data.paoBg=ba.readInt();
			data.playerid=ba.readInt();
			data.playerstyle=ba.readInt();
			data.playerName=ba.readUTF();
			data.playerJob=ba.readInt();
			data.playerCountry=ba.readInt();
			data.playerCollege=ba.readInt();
			data.ColleageName=ba.readUTF();
			data.battleId=ba.readUTF();
			data.content=ba.readUTF();
			data.time=ba.readInt();
			this.talkSession.addATalk(data);
			}else if(type==TalkAction.SYS){
			var sysdata=new SysTalkData();
			sysdata.playerName=ba.readUTF();
			sysdata.type=ba.readInt();
			sysdata.cityId=ba.readInt();
			sysdata.time=ba.readInt();
			sysdata.leftCD=ba.readInt();
			console.log("系统文字----》 "+sysdata.playerName);
			this.talkSession.addStalk(sysdata);
		}
	}

	//弃用
	__proto.sendGM=function(str){
		this.startByAction();
		this.putInt(TalkAction.GM);
		this.putUtf(str);
		this.send();
	}

	//发送聊天
	__proto.sendOtherTalkData=function(data){
		this.startByAction();
		this.putInt(TalkAction.MESSAGE);
		this.putInt(data.channelId);
		this.putUtf(data.battleId);
		data.content=this.sensitiveSession.getSensitiveWord(data.content);
		this.putUtf(data.content);
		this.send();
	}

	TalkAction.GM=0;
	TalkAction.MESSAGE=1;
	TalkAction.SYS=2;
	return TalkAction;
})(Action)


//class huamao.action.TaskAction extends game.mvc.Action
var TaskAction=(function(_super){
	function TaskAction(){
		this.taskSession=null;
		this.huoyueSession=null;
		TaskAction.__super.call(this);
	}

	__class(TaskAction,'huamao.action.TaskAction',_super);
	var __proto=TaskAction.prototype;
	/**
	*
	*@param country 国家
	*@param zftype 招募类型 0招募令 1元宝
	*@param num 招募数量
	*
	*/
	__proto.sendTask=function(type){
		this.startByAction();
		this.putByte(type);
		this.send();
	}

	__proto.sendWeekTask=function(type,taskid){
		this.startByAction();
		this.putByte(type);
		this.putInt(taskid);
		this.send();
	}

	__proto.execute=function(ba){
		var type=ba.readByte();
		var taskid=ba.readInt();
		var exp=ba.readInt();
		var isOk=ba.readInt();
		var end=ba.readInt();
		var td=this.taskSession.typeHonour;
		td.taskId=taskid;
		td.nowValue=exp;
		td.isOk=isOk;
		td.end=end;
		td.status=isOk?3:2;
		td.systask=ConfigManager.getConfig("sys_task.txt",taskid);
		if(end==1){
			td.status=0;
		}
		taskid=ba.readInt();
		exp=ba.readInt();
		isOk=ba.readInt();
		end=ba.readInt();
		td=this.taskSession.typeKing;
		td.taskId=taskid;
		td.nowValue=exp;
		td.isOk=isOk;
		td.end=end;
		td.status=isOk?3:2;
		td.systask=ConfigManager.getConfig("sys_task.txt",taskid);
		if(end==1){
			td.status=0;
		}
		this.taskSession.sessionUpdataEvent("huamao.YouEvent.UPDATA_TASK_DATA");
		var task=ba.readInt();
		this.huoyueSession.arrData.length=0;
		for(var i=0;i<3;i++){
			taskid=ba.readInt();
			exp=ba.readInt();
			isOk=ba.readInt();
			end=ba.readInt();
			var tade=new TaskData();
			tade.taskId=taskid;
			tade.nowValue=exp;
			tade.isOk=isOk;
			tade.status=end;
			tade.systask=ConfigManager.getConfig("sys_task.txt",taskid);
			this.huoyueSession.arrData.push(tade);
		};
		var huoyuedu=ba.readInt();
		this.huoyueSession.huoyuedu=huoyuedu;
		TaskData.isboxVisble=task;
		this.huoyueSession.giftArr.length=0;
		for (var j=0;j < 3;j++){
			this.huoyueSession.giftArr[j]=ba.readByte();
		}
		App.eventManager.event("HUOYUEWEEK");
		App.eventManager.event("REAPOINT",RedPointType.HUODONG);
		console.log("bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb");
	}

	TaskAction.TypeInit=0;
	TaskAction.TypeHonourTaskReward=1;
	TaskAction.TypeKingTaskReward=2;
	TaskAction.NewPlayerTaskReward=7;
	TaskAction.GewPlayerTaskReward=10;
	return TaskAction;
})(Action)


//class huamao.action.UnionAction extends game.mvc.Action
var UnionAction=(function(_super){
	function UnionAction(){
		this.unionSession=null;
		this.mainPlayerSession=null;
		UnionAction.__super.call(this);
	}

	__class(UnionAction,'huamao.action.UnionAction',_super);
	var __proto=UnionAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		switch(type){
			case UnionAction.MyUnion:
				this.unionSession.unionId=ba.readInt();
				this.unionSession.unionName=ba.readUTF();
				this.unionSession.unionLv=ba.readInt();
				this.unionSession.unionExp=ba.readInt();
				this.unionSession.unionBanner=ba.readInt();
				this.unionSession.unionNotice=ba.readUTF();
				this.unionSession.unionMengzhuId=ba.readInt();
				this.unionSession.unionMengZhuName=ba.readUTF();
				this.unionSession.unionPlayerNum=ba.readInt();
				this.unionSession.nameUnionTime=ba.readInt();
				this.unionSession.unionOnLineNum=ba.readInt();
				App.eventManager.event("MYUNIONUPDATA");
				break ;
			case UnionAction.MyUnionPlayer:
				this.unionSession.unionId=ba.readInt();
				if(this.unionSession.unionId==0){
					this.unionSession.unionBanner=0;
				}
				this.unionSession.endTime=ba.readInt();
				this.unionSession.zhiWu=ba.readInt();
				this.unionSession.currhuoyue=ba.readInt();
				this.unionSession.maxhuoyue=ba.readInt();
				this.unionSession.feat=ba.readInt();
				this.unionSession.joinTime=ba.readInt();
				this.unionSession.buildTimes=ba.readUTF();
				this.unionSession.shoptimes=ba.readUTF();
				App.eventManager.event("UNIONUPDATA");
				break ;
			case UnionAction.UnionList:
				this.unionSession.currArr=[];
				this.unionSession.index=ba.readInt();
				this.unionSession.maxNum=ba.readInt();
				var leng=ba.readInt();
				for(var i=0;i<leng;i++){
					var data=new UnionData();
					data.id=ba.readInt();
					data.unionName=ba.readUTF();
					data.unionLv=ba.readInt();
					data.Banner=ba.readInt();
					data.playerNum=ba.readInt();
					data.notice=ba.readUTF();
					data.mengZhu=ba.readUTF();
					data.job=ba.readInt();
					this.unionSession.currArr.push(data);
				};
				var len=ba.readInt();
				this.unionSession.clearApply();
				for(i=0;i<len;i++){
					var applyId=ba.readInt();
					this.unionSession.addApplyId(applyId);
				}
				App.eventManager.event("UNIONLISTUPDATA");
				break ;
			case UnionAction.NewUnion:;
				var id=ba.readInt();
				App.eventManager.event("CHUANGJIANCOM");
				break ;
			case UnionAction.JoinUnion:;
				var lmId=ba.readInt();
				var pid=ba.readInt();
				if(this.mainPlayerSession.mainPlayerData.playerId==pid){
					this.unionSession.addApplyId(lmId);
					FlyUpTips.setTips("申请成功");
					App.eventManager.event("MYSHENQING");
				}
				break ;
			case UnionAction.Dissolve:
				this.unionSession.seleQizhi=1;
				App.eventManager.event("DISSOLVE");
				break ;
			case UnionAction.UnionMembers:
				this.unionSession.clearplayerList();
				len=ba.readInt();
				for(i=0;i<len;i++){
					var unionPlayer=new UnionPlayer();
					unionPlayer.playerId=ba.readInt();
					unionPlayer.playerName=ba.readUTF();
					unionPlayer.playerLv=ba.readInt();
					unionPlayer.zhiWu=ba.readInt();
					unionPlayer.dayScore=ba.readInt();
					unionPlayer.allScore=ba.readInt();
					unionPlayer.loginTime=ba.readInt();
					unionPlayer.logoutTime=ba.readInt();
					this.unionSession.addPlayer(unionPlayer);
				}
				App.eventManager.event("PLAYERLIST");
				break ;
			case UnionAction.UpdateChengYuan:
				unionPlayer=new UnionPlayer();
				unionPlayer.unionId=ba.readInt();
				this.unionSession.unionOnLineNum=ba.readInt();
				unionPlayer.playerId=ba.readInt();
				unionPlayer.playerName=ba.readUTF();
				unionPlayer.playerLv=ba.readInt();
				unionPlayer.zhiWu=ba.readInt();
				unionPlayer.dayScore=ba.readInt();
				unionPlayer.allScore=ba.readInt();
				unionPlayer.loginTime=ba.readInt();
				unionPlayer.logoutTime=ba.readInt();
				if(unionPlayer.unionId==0){
					this.unionSession.deletePlayer(unionPlayer.playerId);
					}else{
					this.unionSession.addPlayer(unionPlayer);
				}
				App.eventManager.event("PLAYERLIST");
				if(this.mainPlayerSession.mainPlayerData.playerId==unionPlayer.playerId){
					this.unionSession.unionId=unionPlayer.unionId;
					this.unionSession.zhiWu=unionPlayer.zhiWu;
					this.unionSession.currhuoyue=unionPlayer.dayScore;
					this.unionSession.maxhuoyue=unionPlayer.allScore;
					this.unionSession.joinTime=unionPlayer.loginTime;
					this.unionSession.endTime=unionPlayer.logoutTime;
					App.eventManager.event("UNIONUPDATA");
				}
				break ;
			case UnionAction.ShenQingList:
				this.unionSession.shenQingList=[];
				len=ba.readInt();
				for(i=0;i<len;i++){
					var sdata=new ShenQingData();
					sdata.playerId=ba.readInt();
					sdata.playerName=ba.readUTF();
					sdata.playerLv=ba.readInt();
					sdata.job=ba.readInt();
					sdata.time=ba.readInt();
					this.unionSession.shenQingList.push(sdata);
				}
				App.eventManager.event("SHENQING");
				break ;
			case UnionAction.ApplyPass:
				pid=ba.readInt();
				this.unionSession.deleteShenQing(pid);
				App.eventManager.event("SHENQING");
				if(this.mainPlayerSession.mainPlayerData.playerId==pid){
					App.eventManager.event("SHENQINGTONGGUO");
				}
				break ;
			case UnionAction.ApplyReject:
				pid=ba.readInt();
				applyId=ba.readInt();
				var unionName=ba.readUTF();
				this.unionSession.deleteShenQing(pid);
				App.eventManager.event("SHENQING");
				if(this.mainPlayerSession.mainPlayerData.playerId==pid){
					this.unionSession.deleteApplyId(applyId);
					App.eventManager.event("UNIONLISTUPDATA");
					FlyUpTips.setTips(unionName+"拒绝了您的申请");
					}else{
					FlyUpTips.setTips("拒绝成功");
				}
				break ;
			case UnionAction.Exit:
				this.unionSession.seleQizhi=1;
				App.eventManager.event("TUICHUCHENGGONG");
				break ;
			case UnionAction.Expel:
				pid=ba.readInt();
				if(this.mainPlayerSession.mainPlayerData.playerId==pid){
					this.unionSession.seleQizhi=1;
					App.eventManager.event("GUANBILIANMENG");
					GameUtils.setError(1030);
				}else{}
				break ;
			case UnionAction.ChaZhao:
				this.unionSession.souSuoList=[];
				len=ba.readInt();
				for(i=0;i<len;i++){
					data=new UnionData();
					data.id=ba.readInt();
					data.unionName=ba.readUTF();
					data.unionLv=ba.readInt();
					data.Banner=ba.readInt();
					data.playerNum=ba.readInt();
					data.notice=ba.readUTF();
					data.mengZhu=ba.readUTF();
					data.job=ba.readInt();
					this.unionSession.souSuoList.push(data);
				}
				App.eventManager.event("SOUSUOLIST");
				break ;
			case UnionAction.UpdateBanner:
				this.unionSession.unionBanner=ba.readInt();
				App.eventManager.event("QIZHIUPDATA");
				break ;
			case UnionAction.Build:
				id=ba.readInt();
				var sys=ConfigManager.getConfig("sys_society_cost.txt" ,id);
				var tips=App.dialogManager.showMiniDialog(TipsGetItem,true,true,false,false);
				var ary=[sys.contributionId,sys.contribution,sys.allianceLvupid,sys.allianceLvup];
				tips.setData(0,ary);
				break ;
			case UnionAction.UpdateNotice:
				this.unionSession.unionNotice=ba.readUTF();
				App.eventManager.event("UPDATAGONGGAO");
				break ;
			case UnionAction.Dynamic:
				len=ba.readInt();
				this.unionSession.dongtaiArr=[];
				for(i=0;i<len;i++){
					var obj={};
					obj.getType=ba.readInt();
					obj.time=ba.readInt();
					obj.content=ba.readUTF();
					this.unionSession.dongtaiArr.push(obj);
				}
				App.eventManager.event("UPDATADONGTAI");
				break ;
			case UnionAction.Appoint:;
				var zhiwu=ba.readInt();
				if(zhiwu==UnionAction.FUMENGZHU){
					GameUtils.setError(1031);
					}else if(zhiwu==UnionAction.CHENGYUAN){
					GameUtils.setError(1032);
					}else if(zhiwu==UnionAction.ZHUMENGZHU){
					GameUtils.setError(1033);
				}
				break ;
			case UnionAction.UPDATA:;
				var typeN=ba.readByte();
				if(typeN==1){
					this.unionSession.unionLv=ba.readInt();
					this.unionSession.unionExp=ba.readInt();
					App.eventManager.event("UNIONEXP");
					}else if(typeN==2){
					this.unionSession.unionMengZhuName=ba.readUTF();
					App.eventManager.event("UNIONMENGZHU");
					}else if(typeN==3){
					this.unionSession.unionPlayerNum=ba.readInt();
					this.unionSession.unionOnLineNum=ba.readInt();
					App.eventManager.event("UNIONRENSHU");
				}
				break ;
			}
	}

	__proto.sendGongGao=function(str){
		this.startByAction();
		this.putByte(UnionAction.UpdateNotice);
		this.putUtf(str);
		this.send();
	}

	/**获取动态*/
	__proto.sendDongTai=function(){
		this.startByAction();
		this.putByte(UnionAction.Dynamic);
		this.send();
	}

	/**更换旗帜*/
	__proto.sendQiZhi=function(id){
		this.startByAction();
		this.putByte(UnionAction.UpdateBanner);
		this.putInt(id);
		this.send();
	}

	/**
	*申请加入军团
	*@param id
	*/
	__proto.sendJiaRuId=function(id){
		this.startByAction();
		this.putByte(UnionAction.JoinUnion);
		this.putInt(id);
		this.send();
	}

	__proto.sendList=function(index,num){
		this.startByAction();
		this.putByte(UnionAction.UnionList);
		this.putInt(index);
		this.putInt(num);
		this.send();
	}

	__proto.sendNewUnion=function(unionName,banner,notice){
		this.startByAction();
		this.putByte(UnionAction.NewUnion);
		this.putUtf(unionName);
		this.putInt(banner);
		this.putUtf(notice);
		this.send();
	}

	/**
	*获取成员列表
	*/
	__proto.sendPlayerList=function(){
		this.startByAction();
		this.putByte(UnionAction.UnionMembers);
		this.send();
	}

	/**任命 id 要任命的职务id*/
	__proto.sendRenZhiCheXiao=function(id,zhiwu){
		this.startByAction();
		this.putByte(UnionAction.Appoint);
		this.putInt(id);
		this.putInt(zhiwu);
		this.send();
	}

	/**
	*申请列表请求
	*/
	__proto.sendShenQing=function(){
		this.startByAction();
		this.putByte(UnionAction.ShenQingList);
		this.send();
	}

	__proto.DissolveFun=function(){
		this.startByAction();
		this.putByte(UnionAction.Dissolve);
		this.send();
	}

	/**同意申请*/
	__proto.sendTongGuo=function(pid){
		this.startByAction();
		this.putByte(UnionAction.ApplyPass);
		this.putInt(pid);
		this.send();
	}

	/**拒绝申请*/
	__proto.ApplyJujue=function(pid){
		this.startByAction();
		this.putByte(UnionAction.ApplyReject);
		this.putInt(pid);
		this.send();
	}

	__proto.sendExit=function(){
		this.startByAction();
		this.putByte(UnionAction.Exit);
		this.send();
	}

	/**逐出军团*/
	__proto.sendZhuChu=function(id){
		this.startByAction();
		this.putByte(UnionAction.Expel);
		this.putInt(id);
		this.send();
	}

	/**查找联盟*/
	__proto.sendSuoSuo=function(str){
		this.startByAction();
		this.putByte(UnionAction.ChaZhao);
		this.putUtf(str);
		this.send();
	}

	/**建设*/
	__proto.sendjs=function(id){
		this.startByAction();
		this.putByte(UnionAction.Build);
		this.putInt(id);
		this.send();
	}

	/**商店购买*/
	__proto.sendShop=function(id){
		this.startByAction();
		this.putByte(UnionAction.Shop);
		this.putInt(id);
		this.send();
	}

	__proto.sendAllTongGuo=function(){
		this.startByAction();
		this.putByte(UnionAction.ApplyPassAll);
		this.send();
	}

	__proto.sendAllJuJue=function(){
		this.startByAction();
		this.putByte(UnionAction.ApplyRejectAll);
		this.send();
	}

	UnionAction.CHENGYUAN=0;
	UnionAction.FUMENGZHU=8;
	UnionAction.ZHUMENGZHU=9;
	UnionAction.MyUnion=0;
	UnionAction.MyUnionPlayer=1;
	UnionAction.UnionList=2;
	UnionAction.NewUnion=3;
	UnionAction.JoinUnion=4;
	UnionAction.UnionMembers=5;
	UnionAction.Appoint=6;
	UnionAction.Expel=7;
	UnionAction.ApplyPass=8;
	UnionAction.ApplyReject=9;
	UnionAction.ApplyPassAll=10;
	UnionAction.ApplyRejectAll=11;
	UnionAction.Exit=12;
	UnionAction.Dissolve=13;
	UnionAction.Build=14;
	UnionAction.Dynamic=15;
	UnionAction.Shop=16;
	UnionAction.UpdateBanner=17;
	UnionAction.UpdateNotice=18;
	UnionAction.UpdateChengYuan=19;
	UnionAction.ChaZhao=20;
	UnionAction.ShenQingList=21;
	UnionAction.UPDATA=22;
	return UnionAction;
})(Action)


//class huamao.action.VictoryBoxAction extends game.mvc.Action
var VictoryBoxAction=(function(_super){
	function VictoryBoxAction(){
		this.victoryBoxSession=null;
		VictoryBoxAction.__super.call(this);
	}

	__class(VictoryBoxAction,'huamao.action.VictoryBoxAction',_super);
	var __proto=VictoryBoxAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		if(type==0){
			var box=ba.readUTF();
			this.victoryBoxSession.boxStr=box;
		}
	}

	__proto.sendLingqu=function(id){
		this.startByAction();
		this.putByte(1);
		this.putInt(id);
		this.send();
	}

	__proto.sendDisBox=function(id){
		this.startByAction();
		this.putByte(3);
		this.putInt(id);
		this.send();
	}

	return VictoryBoxAction;
})(Action)


//class huamao.action.WuJiangAction extends game.mvc.Action
var WuJiangAction=(function(_super){
	function WuJiangAction(){
		//取消投票
		this.wuJiangSession=null;
		this.mapCitySession=null;
		this.heroAn=null;
		WuJiangAction.__super.call(this);
	}

	__class(WuJiangAction,'huamao.action.WuJiangAction',_super);
	var __proto=WuJiangAction.prototype;
	__proto.execute=function(ba){
		var type=ba.readByte();
		switch (type){
			case 1:
				this.wuJiangSession.clearHeroData();
				var len=ba.readInt();
				for(var i=0;i<len;i++){
					this.readHeroData(ba);
				}
				break ;
			case 2:;
				var data=this.readHeroData(ba);
				App.eventManager.event("HEROUPDATE",data.heroId);
				break ;
			case 4:;
				var id=ba.readInt();
				this.wuJiangSession.deleteHero(id);
				break ;
			case 11:;
				var heroId=ba.readInt();
				data=this.wuJiangSession.getHero(heroId);
				data.cityId=ba.readInt();
				data.soldier=ba.readInt();
				if(data.cityId==0){
					data.heroState=0;
				}
				console.log("战斗结束",heroId,data.cityId,data.soldier);
				var cityData=this.mapCitySession.getCity(data.cityId);
				if(cityData){
					cityData.heroObj[heroId]=data;
				}
				break ;
			case 3:;
				var heroId1=ba.readInt();
				var isXueCang=ba.readByte();
				this.wuJiangSession.setXueCang(heroId1,isXueCang);
				App.eventManager.event("HEROUPDATE",heroId1);
				break ;
			case 12:;
				var LVUP_heroId=ba.readInt();
				var LVUP_heroLv=ba.readInt();
				this.wuJiangSession.setHeroLv(LVUP_heroId,LVUP_heroLv);
				App.eventManager.event("HEROUPDATE",LVUP_heroId);
				break ;
			case 14:;
				var pData=new PropertyChangeData();
				pData.setBa(ba);
				App.eventManager.event("HERO_EQUIP_CHANGE",pData);
				break ;
			case 20:
				this.getPlayerHeroList(ba);
				break ;
			case 21:;
				var wujiangId=ba.readInt();
				this.setChenggong([wujiangId]);
				break ;
			case 22:;
				var wujiang=ba.readInt();
				App.eventManager.event("ADDLEGION",wujiang);
				break ;
			case 23:;
				var wujiangid=ba.readInt();
				App.eventManager.event("DELETELEGION",wujiangid);
				break ;
			case 24:
				this.getWuJiangFromItem(ba);
				break ;
			case 26:
				this.flushAssessData(ba);
				break ;
			}
	}

	__proto.flushAssessData=function(ba){
		var obj=new AssessData();
		obj.heroId=ba.readInt();
		obj.num11=ba.readInt();
		obj.num12=ba.readInt();
		obj.num13=ba.readInt();
		obj.num14=ba.readInt();
		obj.num21=ba.readInt();
		obj.num22=ba.readInt();
		obj.num23=ba.readInt();
		obj.num24=ba.readInt();
		obj.num31=ba.readInt();
		obj.num32=ba.readInt();
		obj.num33=ba.readInt();
		obj.num34=ba.readInt();
		this.wuJiangSession.assessData=obj;
		if(!HeroAssess.ifOpen){
			var tips=App.dialogManager.showMiniDialog(HeroAssess,true,true,false,false);
			tips.setHero(obj.heroId);
		}
		App.eventManager.event("ASSESS_VOTE_FLUSH");
	}

	/**添加副将*/
	__proto.sendAddLegion=function(heroId,legionId){
		this.startByAction();
		this.putByte(22);
		this.putInt(heroId);
		this.putInt(legionId);
		this.send();
	}

	/**删除副将*/
	__proto.sendDeleLegion=function(heroId,legionId){
		this.startByAction();
		this.putByte(23);
		this.putInt(heroId);
		this.putInt(legionId);
		this.send();
	}

	__proto.getWuJiangFromItem=function(ba){
		var str=ba.readUTF();
		var ary=str.split(",");
		var animation=new HeroAnimation();
		animation.setData(ary);
	}

	__proto.setChenggong=function(arr){
		if(!this.heroAn){
			this.heroAn=new HeroAnimation();
		}
		this.heroAn.setData(arr);
	}

	__proto.getPlayerHeroList=function(ba){
		var arr=[];
		var size=ba.readInt();
		for(var i=0;i<size;i++){
			var data=new HeroData();
			data.heroId=ba.readInt();
			data.heroLv=ba.readInt();
			arr.push(data);
		}
		arr.sort(this.sortColorSn);
		App.dialogManager.openDialogByStr("CHECK_OTHER_PLAYER",arr);
	}

	__proto.sortColorSn=function(a,b){
		if(b.sysHero.heroColor !=a.sysHero.heroColor){
			return b.sysHero.heroColor-a.sysHero.heroColor;
		}
		else{
			return b.heroLv-a.heroLv;
		}
	}

	__proto.readHeroData=function(ba){
		var heroId=ba.readInt();
		var data=this.wuJiangSession.getHero(heroId);
		if(data==null){
			data=new HeroData();
			data.heroId=heroId;
			this.wuJiangSession.addHero(data);
		}
		data.heroLv=ba.readInt();
		data.heroStar=ba.readInt();
		data.heroTime=ba.readInt();
		data.soldierType=ba.readInt();
		data.setStudy(ba.readUTF());
		data.setSodierUnlock(ba.readUTF());
		data.setAssess(ba.readUTF());
		data.isXueCang=ba.readByte();
		data.isResolve=ba.readByte();
		data.legion=ba.readUTF();
		data.masterId=ba.readInt();
		data.force=ba.readInt();
		data.resist=ba.readInt();
		data.wisdom=ba.readInt();
		data.might=ba.readInt();
		data.attack=ba.readInt();
		data.defense=ba.readInt();
		data.stratagemAttack=ba.readInt();
		data.stratagemDefense=ba.readInt();
		data.crit=ba.readInt();
		data.dodge=ba.readInt();
		data.insight=ba.readInt();
		data.parry=ba.readInt();
		data.damageAdd=ba.readInt();
		data.attackDamageAdd=ba.readInt();
		data.stratagemDamageAdd=ba.readInt();
		data.damageReduce=ba.readInt();
		data.attackDamageReduce=ba.readInt();
		data.stratagemDamageReduce=ba.readInt();
		data.fight=ba.readInt();
		data.soldierMax=ba.readInt();
		return data;
	}

	/**
	*@param heroId
	*@param value 0不藏 1藏
	*/
	__proto.sendXueCang=function(heroId,value){
		this.startByAction();
		this.putByte(3);
		this.putInt(heroId);
		this.putByte(value?1:0);
		this.send();
	}

	__proto.sendHeroLvUp=function(heroId){
		this.startByAction();
		this.putByte(12);
		this.putInt(heroId);
		this.send();
	}

	__proto.sendEquip=function(heroId,onlyId){
		this.startByAction();
		this.putByte(14);
		this.putInt(heroId);
		this.putInt(onlyId);
		this.send();
	}

	__proto.sendUnEquip=function(heroId,type){
		this.startByAction();
		this.putByte(15);
		this.putInt(heroId);
		this.putInt(type);
		this.send();
	}

	__proto.sendSoulLvUp=function(heroId){
		this.startByAction();
		this.putByte(16);
		this.putInt(heroId);
		this.send();
	}

	//武将-合成
	__proto.sendHeCheng=function(heroId){
		this.startByAction();
		this.putByte(18);
		this.putInt(heroId);
		this.send();
	}

	//武将-分解
	__proto.sendFenJie=function(heroId){
		this.startByAction();
		this.putByte(17);
		this.putInt(heroId);
		this.send();
	}

	//卸载武将全部装备（未解锁）
	__proto.sendUninstallAllEquip=function(){
		this.startByAction();
		this.putByte(19);
		this.send();
	}

	__proto.sendViewPlayerHeroList=function(playerid){
		this.startByAction();
		this.putByte(20);
		this.putInt(playerid);
		this.send();
	}

	/**
	*添加武将
	*@param heroId
	*@param legionHeroid
	*
	*/
	__proto.sendAddCorps=function(heroId,legionHeroid){
		this.startByAction();
		this.putByte(22);
		this.putInt(heroId);
		this.putInt(legionHeroid);
		this.send();
	}

	/**
	*删除武将
	*@param heroId
	*@param legionHeroid
	*
	*/
	__proto.sendDeleteCorps=function(heroId,legionHeroid){
		this.startByAction();
		this.putByte(23);
		this.putInt(heroId);
		this.putInt(legionHeroid);
		this.send();
	}

	//ifresetLv:0不重置等级 1：重置等级
	__proto.sendReset=function(heroId,type,ifresetLv){
		this.startByAction();
		this.putByte(25);
		this.putInt(heroId);
		this.putInt(type);
		this.putInt(ifresetLv);
		this.send();
	}

	//申请查看一个武将的评价
	__proto.sendViewPingJia=function(heroId){
		this.startByAction();
		this.putByte(26);
		this.putInt(heroId);
		this.send();
	}

	//投票
	__proto.sendTouPiao=function(heroId,question1,question2,question3){
		this.startByAction();
		this.putByte(27);
		this.putInt(heroId);
		this.putInt(question1);
		this.putInt(question2);
		this.putInt(question3);
		this.send();
	}

	//取消投票
	__proto.sendQuXiaoTouPiao=function(heroId){
		this.startByAction();
		this.putByte(28);
		this.putInt(heroId);
		this.send();
	}

	WuJiangAction.WU_JIANG=1;
	WuJiangAction.ADD_WU_JIANG=2;
	WuJiangAction.XUE_CANG=3;
	WuJiangAction.DELETE=4;
	WuJiangAction.HERO_STAT=11;
	WuJiangAction.HERO_LV_UP=12;
	WuJiangAction.HERO_EQUIP=14;
	WuJiangAction.UN_EQUIP=15;
	WuJiangAction.SOUL_LV_UP=16;
	WuJiangAction.HERO_FENJIE=17;
	WuJiangAction.HERO_HECHENG=18;
	WuJiangAction.EQUIP_UNINSTALL_ALL=19;
	WuJiangAction.CHECK_PLAYER_HERO_LIST=20;
	WuJiangAction.HECHENGCHENGGONG=21;
	WuJiangAction.ADDCORPS=22;
	WuJiangAction.DELETECORPS=23;
	WuJiangAction.ITEM_WJ=24;
	WuJiangAction.RESET=25;
	WuJiangAction.VIEW_ASSESS=26;
	WuJiangAction.VOTE=27;
	WuJiangAction.CANCEL_VOTE=28;
	return WuJiangAction;
})(Action)


//class huamao.action.ZhaoMuAction extends game.mvc.Action
var ZhaoMuAction=(function(_super){
	function ZhaoMuAction(){
		this.zhaoMuSession=null;
		ZhaoMuAction.__super.call(this);
	}

	__class(ZhaoMuAction,'huamao.action.ZhaoMuAction',_super);
	var __proto=ZhaoMuAction.prototype;
	/**
	*
	*@param country 国家
	*@param zftype 招募类型 0招募令 1元宝
	*@param num 招募数量
	*
	*/
	__proto.sendZhaoMu=function(type,country){
		(country===void 0)&& (country=0);
		this.startByAction();
		this.putByte(type);
		if(type==100 || type==101){}
			else{
			this.putByte(country);
		}
		this.send();
	}

	__proto.execute=function(ba){
		var type=ba.readByte();
		this.zhaoMuSession.actionType=type;
		if(type==101){
			var len=ba.readInt();
			var arr=[];
			for(var i=0;i<len;i++){
				var obj={};
				obj.timer=ba.readInt();
				obj.str=ba.readUTF();
				arr.push(obj);
			}
			this.zhaoMuSession.heroJl=arr;
			this.zhaoMuSession.sessionUpdataEvent("SHOWJL");
			}else{
			this.zhaoMuSession.num=ba.readInt()
			this.zhaoMuSession.freeTime=ba.readInt()
			this.zhaoMuSession.sessionUpdataEvent("huamao.session.ZhaoMuSession.InitEvent");
			App.eventManager.event("REAPOINT",RedPointType.HAOYIN);
			if(type!=100){
				App.voiceManager.playSound("zhaomu.wav");
				this.zhaoMuSession.lastStr=ba.readUTF();
				this.zhaoMuSession.sessionUpdataEvent("huamao.session.ZhaoMuSession.ShowEvent");
			}
		}
	}

	ZhaoMuAction.HeroToke=0;
	ZhaoMuAction.HeroToken_5=1;
	ZhaoMuAction.HeroGold=2;
	ZhaoMuAction.HeroGold_5=3;
	ZhaoMuAction.HeroRecruit_Init=100;
	ZhaoMuAction.HeroRecruit_Logs=101;
	return ZhaoMuAction;
})(Action)


/**
*翻牌动画
*/
//class huamao.panel.zhaomu.Animation1 extends game.base.utils.MyAnimation
var Animation1=(function(_super){
	function Animation1(ss_,showScale_){
		this.showScale=0.7;
		this.za=null;
		Animation1.__super.call(this,ss_);
		this.za=ss_;
		this.showScale=showScale_;
	}

	__class(Animation1,'huamao.panel.zhaomu.Animation1',_super);
	var __proto=Animation1.prototype;
	__proto.play=function(){
		this.reset();
		this.start();
		Laya.timer.once(600,this,this.go);
	}

	__proto.go=function(){
		Laya.timer.frameLoop(1,this,this.efe);
	}

	__proto.reset=function(){
		Laya.timer.clear(this,this.efe);
		Laya.timer.clear(this,this.go);
		this.index=0;
		this.ss.scaleX=this.ss.scaleY=this.showScale;
		this.za.kabei.visible=true;
	}

	__proto.efe=function(){
		var n1=0.08 *MyImg.EFEN;
		var n2=0.01 *MyImg.EFEN;
		if(this.index==0){
			if(this.ss.scaleX>0.1){
				this.ss.scaleX-=n1;
				}else{
				this.ss.scaleX=n2;
				this.index++;
			}
		}
		else if(this.index==1){
			if(this.ss.scaleX<this.showScale){
				this.za.kabei.visible=false;
				this.ss.scaleX+=n1;
				}else{
				this.ss.scaleX=this.showScale;
				Laya.timer.clear(this,this.efe);
				this.end();
			}
		}
	}

	return Animation1;
})(MyAnimation)


/**
*垂直飞行动画
*/
//class huamao.panel.zhaomu.Animation10 extends game.base.utils.MyAnimation
var Animation10=(function(_super){
	function Animation10(ss_,end_y_,delayT_){
		this.speed=100 *MyImg.EFEN;
		this.end_y=0;
		//目标点
		this.delayT=0;
		this.dy=0
		Animation10.__super.call(this,ss_);
		this.end_y=end_y_;
		this.delayT=delayT_;
	}

	__class(Animation10,'huamao.panel.zhaomu.Animation10',_super);
	var __proto=Animation10.prototype;
	__proto.play=function(){
		this.start();
		if(this.delayT!=0){
			Laya.timer.once(this.delayT ,this ,this.go);
			}else{
			this.go();
		}
	}

	__proto.go=function(){
		this.dy=this.ss.y;
		Laya.timer.frameLoop(1,this,this.efe);
		App.voiceManager.playSound("getsound.wav");
	}

	__proto.efe=function(){
		this.dy-=this.speed;
		if(this.dy > this.end_y){
			}else{
			this.dy=this.end_y;
			Laya.timer.clear(this,this.efe);
			this.end();
		}
		this.ss.y=this.dy;
	}

	return Animation10;
})(MyAnimation)


/**
*渐隐动画
*/
//class huamao.panel.zhaomu.Animation2 extends game.base.utils.MyAnimation
var Animation2=(function(_super){
	function Animation2(ss_){
		this.showScale=0.7;
		this.za=null;
		Animation2.__super.call(this,ss_);
		this.za=ss_;
	}

	__class(Animation2,'huamao.panel.zhaomu.Animation2',_super);
	var __proto=Animation2.prototype;
	__proto.play=function(){
		this.reset();
		this.start();
		Laya.timer.once(1000,this,this.go);
	}

	__proto.go=function(){
		Laya.timer.frameLoop(1,this,this.efe);
		App.voiceManager.playSound("getsoul.wav");
	}

	__proto.reset=function(){
		this.ss.alpha=1;
	}

	__proto.efe=function(){
		var n=0.05 *MyImg.EFEN;
		if(this.ss.alpha>0.05){
			this.ss.alpha-=n;
			}else{
			this.ss.alpha=0;
			Laya.timer.clear(this,this.efe);
			this.end();
		}
	}

	return Animation2;
})(MyAnimation)


/**
*水平飞行动画
*/
//class huamao.panel.zhaomu.Animation20 extends game.base.utils.MyAnimation
var Animation20=(function(_super){
	function Animation20(ss_,dx_){
		//private var card:ZhaomuCard;
		this.speed=10 *MyImg.EFEN;
		this.k=NaN;
		this.dx=0;
		Animation20.__super.call(this,ss_);
		this.dx=dx_;
	}

	__class(Animation20,'huamao.panel.zhaomu.Animation20',_super);
	var __proto=Animation20.prototype;
	__proto.play=function(){
		if(this.dx !=this.ss.x){
			this.k=this.dx-this.ss.x;
			this.speed=Math.abs(this.k)/ 26 *MyImg.EFEN;
			Laya.timer.frameLoop(1,this,this.efe);
			}else{
			this.end();
		}
	}

	__proto.end=function(){
		Laya.timer.clear(this,this.efe);
		_super.prototype.end.call(this);
	}

	__proto.efe=function(){
		if(this.k<0){
			this.ss.x-=this.speed;
			if(this.ss.x>this.dx){
				}else{
				this.ss.x=this.dx;
				this.end();
			}
			}else if(this.k >0){
			this.ss.x+=this.speed;
			if(this.ss.x<this.dx){
				}else{
				this.ss.x=this.dx;
				this.end();
			}
		}
	}

	return Animation20;
})(MyAnimation)


//class huamao.session.ActivitySession extends game.mvc.Session
var ActivitySession=(function(_super){
	function ActivitySession(){
		this._ativityObj={};
		this.jijinDataArr=[];
		this.leijiDataArr=[];
		this.huoyueDataArr=[];
		this.huoyueDayDataArr=[];
		this.leijiNewDataArr=[];
		this.kaBaoDataArr=[];
		this.sysjijinData=null;
		this.sysLeijiData=null;
		this.sysLeijiNewData=null;
		ActivitySession.__super.call(this);
		App.eventManager.on("CONFIG_OVER",this,this.init);
	}

	__class(ActivitySession,'huamao.session.ActivitySession',_super);
	var __proto=ActivitySession.prototype;
	__proto.init=function(){
		this.jijinDataArr=SysActivity.getArrByType(3);
		this.leijiDataArr=SysActivity.getArrByType(2);
		this.huoyueDataArr=SysActivity.getArrByType(7);
		this.huoyueDayDataArr=SysActivity.getArrByType(8);
		this.leijiNewDataArr=SysActivity.getArrByType(9);
		this.kaBaoDataArr=SysActivity.getArrByType(11);
		this.sysLeijiData=this.leijiDataArr[this.leijiDataArr.length-1];
		this.sysLeijiNewData=this.leijiNewDataArr[this.leijiNewDataArr.length-1];
		this.sysjijinData=this.jijinDataArr.shift();
	}

	__proto.addActivity=function(data){
		this._ativityObj[data.activityId]=data;
	}

	__proto.closeActivityObj=function(){
		this._ativityObj={};
	}

	/**
	*根据类型获取活动
	*@param type
	*@return
	*
	*/
	__proto.getTypeActivity=function(type){
		var data;
		for(var $each_data in this._ativityObj){
			data=this._ativityObj[$each_data];
			if(data.activityType==type){
				return data;
			}
		}
		return null;
	}

	__getset(0,__proto,'ativityObj',function(){
		return this._ativityObj;
		},function(value){
		this._ativityObj=value;
	});

	return ActivitySession;
})(Session)


//class huamao.session.BagSession extends game.mvc.Session
var BagSession=(function(_super){
	function BagSession(){
		this.itemAry=[];
		//道具
		this.equipAry=[];
		//装备
		this.boxAry=[];
		//宝箱
		this.IfFlushItem=false;
		this.IfFlushEquip=false;
		this.IfFlushBox=false;
		BagSession.__super.call(this);
	}

	__class(BagSession,'huamao.session.BagSession',_super);
	var __proto=BagSession.prototype;
	__proto.clearAll=function(){
		this.itemAry=[];
		this.equipAry=[];
		this.boxAry=[];
		this.IfFlushItem=false;
		this.IfFlushEquip=false;
		this.IfFlushBox=false;
	}

	__proto.setData=function(data){
		var itemid=data.itemId
		console.log("onlyid = "+data.onlyId+" itemid = "+itemid);
		var sysitem=ConfigManager.getConfig("sys_item.txt",itemid);
		switch(sysitem.itemTag){
			case SysItem.ITEM:
				this.itemAry.push(data);
				this.IfFlushItem=true;
				break ;
			case SysItem.EQUIP:
				this.equipAry.push(data);
				this.IfFlushEquip=true;
				break ;
			case SysItem.BOX:
				this.boxAry.push(data);
				this.IfFlushBox=true;
				break ;
			}
	}

	__proto.getIndex=function(ary,data){
		var result=-1;
		for(var i=0;i<ary.length;i++){
			var one=ary [i]
			if((one.onlyId==data.onlyId)&& (one.itemId==data.itemId)){
				return i;
			}
		}
		return result;
	}

	__proto.delData=function(data){
		var itemid=data.itemId
		console.log("onlyid = "+data.onlyId+" itemid = "+itemid);
		var sysitem=ConfigManager.getConfig("sys_item.txt",itemid);
		switch(sysitem.itemTag){
			case SysItem.ITEM:;
				var index=this.getIndex(this.itemAry,data);
				if(index !=-1){
					this.itemAry.splice(index,1);
					this.IfFlushItem=true;
				}
				break ;
			case SysItem.EQUIP:
				index=this.getIndex(this.equipAry,data);
				if(index !=-1){
					this.equipAry.splice(index,1);
					this.IfFlushEquip=true;
				}
				break ;
			case SysItem.BOX:
				index=this.getIndex(this.boxAry,data);
				if(index !=-1){
					this.boxAry.splice(index,1);
					this.IfFlushBox=true;
				}
				break ;
			}
	}

	__proto.resetOneData=function(ary,data){
		var size=ary.length;
		for(var i=0;i<size;i++){
			var one=ary [i]
			if(one.onlyId==data.onlyId && one.itemId==data.itemId){
				one.heroId=data.heroId;
				one.isLock=data.isLock;
				one.itemNum=data.itemNum;
				one.lv=data.lv;
				one.overTime=data.overTime;
				one.playerId=data.playerId;
				return true;
			}
		}
		return false;
	}

	//更新一个数据
	__proto.flushOneData=function(data){
		var onlyid=data.onlyId;
		var itemid=data.itemNum;
		if(this.resetOneData(this.itemAry,data)){
			App.eventManager.event("BAG_ITEM_FLUSH");
			}else if(this.resetOneData(this.equipAry,data)){
			App.eventManager.event("BAG_EQUIP_FLUSH");
			App.eventManager.event("HEROUPDATE",[data.heroId]);
			console.log("reset heroid = "+data.heroId);
			}else if(this.resetOneData(this.boxAry,data)){
			App.eventManager.event("BAG_BOX_FLUSH");
		}
	}

	__proto.checkToFlush=function(){
		if(this.IfFlushItem || this.itemAry.length==0){
			this.IfFlushItem=false;
			App.eventManager.event("BAG_ITEM_FLUSH");
		}
		if(this.IfFlushEquip || this.equipAry.length==0){
			this.IfFlushEquip=false;
			App.eventManager.event("BAG_EQUIP_FLUSH");
		}
		if(this.IfFlushBox || this.boxAry.length==0){
			this.IfFlushBox=false;
			App.eventManager.event("BAG_BOX_FLUSH");
		}
	}

	__proto.getItemAry=function(){
		return this.itemAry;
	}

	__proto.getEquipAry=function(){
		return this.equipAry;
	}

	__proto.getBoxAry=function(){
		return this.boxAry;
	}

	__proto._ItemNum=function(ary,id){
		var result=0;
		var size=ary.length;
		for(var i=0;i<size;i++){
			var data=ary [i]
			if(data.itemId==id){
				result+=data.itemNum;
			}
		}
		return result;
	}

	//获取物品数量
	__proto.getItemNumByItemId=function(itemid){
		var result=0;
		result=this._ItemNum(this.itemAry,itemid)+this._ItemNum(this.equipAry,itemid)+this._ItemNum(this.boxAry,itemid);
		return result;
	}

	//获取强化材料数量
	__proto.getEquipNum=function(onlyid,itemid){
		var result=0;
		var size=this.equipAry.length;
		for(var i=0;i<size;i++){
			var data=this.equipAry[i];
			if(data.onlyId !=onlyid && data.itemId==itemid && data.lv==0 && data.heroId==0){
				result++;
			}
		}
		return result;
	}

	__proto.getEquipByOnlyId=function(onlyId){
		for(var i=0;i < this.equipAry.length;i++){
			var data=this.equipAry[i];
			if(data.onlyId==onlyId){
				return data;
			}
		}
		return null;
	}

	//getEquipListByType(SysItem.EquipType_Wu,SysItem.Kong_Wu);//获取空闲武器 返回数组
	__proto.getEquipAryByType=function(maintype,stype){
		var ary=[];
		var size=this.equipAry.length;
		for(var i=0;i<size;i++){
			var data=this.equipAry[i];
			var sysitem=ConfigManager.getConfig("sys_item.txt",data.itemId);
			if(maintype==sysitem.itemType){
				if(stype==10 && data.heroId==0){
					ary.push(data);
					}else if(stype==12 && data.heroId==0){
					ary.push(data);
					}else if(stype==11 && data.heroId==0){
					ary.push(data);
					}else{
					var sysequip=ConfigManager.getConfig("sys_equip.txt",data.itemId);
					if(sysequip.detailType==stype){
						ary.push(data);
					}
				}
			}
		}
		return ary;
	}

	/**
	*@param bigType
	*@param smallType-1 是空闲的-2是全部的
	*/
	__proto.getEquip=function(bigType,smallType){
		console.log("getEquip bigtype = "+bigType+"  smalltype = "+smallType);
		var arr=[];
		var size=this.equipAry.length;
		for(var i=0;i < size;i++){
			var data=this.equipAry[i];
			var sys=ConfigManager.getConfig("sys_item.txt",data.itemId);
			if(sys.itemType==bigType){
				if((smallType==-1 && data.isEmpty())|| smallType==-2){
					arr.push(data);
					}else {
					var sysE=ConfigManager.getConfig("sys_equip.txt",data.itemId);
					if(sysE.detailType==smallType){
						arr.push(data);
					}
				}
			}
		}
		return arr;
	}

	__proto.getEquipByHeroId=function(heroId){
		var arr=[];
		for (var i=0;i < this.equipAry.length;i++){
			var data=this.equipAry[i];
			if(data.heroId==heroId){
				arr.push(data);
			}
		}
		return arr;
	}

	__proto.getEquipByPart=function(heroId,type){
		var arr=this.getEquipByHeroId(heroId);
		for (var i=0;i < arr.length;i++){
			var data=arr[i];
			var sys=ConfigManager.getConfig("sys_item.txt",data.itemId);
			if(type==sys.itemType){
				return data;
			}
		}
		return null;
	}

	__proto.getItemByType=function(itemType){
		var arr=[];
		for (var i=0;i < this.itemAry.length;i++){
			var data=this.itemAry [i];
			if(data.getSysItem().itemType==itemType){
				arr.push(data);
			}
		}
		return arr;
	}

	__proto.getItemData=function(itemId){
		for (var i=0;i < this.itemAry.length;i++){
			if((this.itemAry [i]).itemId==itemId){
				return this.itemAry[i];
			}
		}
		return null;
	}

	__proto.sortFun=function(dataA,dataB){
		var itemIdA=dataA.itemId;
		var ItemIdB=dataB.itemId;
		var sysitemA=ConfigManager.getConfig("sys_item.txt",itemIdA);
		var sysitemB=ConfigManager.getConfig("sys_item.txt",ItemIdB);
		var sysequipA=ConfigManager.getConfig("sys_equip.txt",itemIdA);
		var sysequipB=ConfigManager.getConfig("sys_equip.txt",ItemIdB);
		var aryequip=[0,4,3,1,2,5,6];
		var colorA=sysitemA.itemColor;
		var colorB=sysitemB.itemColor;
		var LvA=dataA.lv;
		var LvB=dataB.lv;
		var typeA=sysitemA.itemType;
		var typeB=sysitemB.itemType;
		var dtypeA=aryequip[sysequipA.detailType];
		var dtypeB=aryequip[sysequipB.detailType];
		if(colorA !=colorB){
			return colorB-colorA;
			}else if(LvA !=LvB){
			return LvB-LvA;
			}else if(typeA !=typeB){
			return typeB-typeA;
			}else{
			return dtypeB-dtypeA;
		}
	}

	BagSession.SOUL_ID=8001;
	BagSession.ZHUAN_ZHI_SHU=10301;
	return BagSession;
})(Session)


//class huamao.session.BattleSession extends game.mvc.Session
var BattleSession=(function(_super){
	function BattleSession(){
		this.battleStat=0;
		this.battleUrl=null;
		this.allMax=0;
		this.resMax=0;
		this.aniMax=0;
		this.aniArr=[];
		this.resArr=[];
		this.battleData=new BattleData();
		BattleSession.__super.call(this);
		BattleSession.instance=this;
		App.eventManager.on("BATTLE",this,this.setBattleUrl,[1]);
		App.eventManager.on("BATTLE_INFO",this,this.setBattleUrl,[2]);
		App.eventManager.on("GUIDE_ENTER_FIGHT",this,this.guideFun);
	}

	__class(BattleSession,'huamao.session.BattleSession',_super);
	var __proto=BattleSession.prototype;
	__proto.guideFun=function(){
		this.setBattleUrl(3,"res/load/guidebattle.zlib");
	}

	__proto.setBattleUrl=function(battleStat,battleUrl){
		this.battleStat=battleStat;
		this.battleUrl=battleUrl;
		if(battleStat !=2){
			App.sceneManager.setScene("BATTLE_FIELD",false,null,false);
			}else{
			this.loadBattleData();
		}
	}

	__proto.loadBattleData=function(){
		Laya.loader.load(this.battleUrl,new Handler(this,this.zlibComFun),null,"arraybuffer");
	}

	__proto.zlibComFun=function(ab){
		if(ab==null){
			FlyUpTips.setTips("战况回顾已过期");
			return;
		};
		var byteArray=new ByteArray();
		byteArray.endian="littleEndian";
		byteArray.writeArrayBuffer(ab);
		byteArray.uncompress();
		this.zipComFun([0,byteArray.__getBuffer()]);
	}

	__proto.zipComFun=function(arr){
		this.battleData.setArrayBuffer(arr[1]);
		this.battleData.isGuide=(this.battleStat==3);
		if(this.battleData.isGuide){
			this.battleData.nowCell.atkName="诸侯联军";
			this.battleData.nowCell.defName="董卓";
		}
		if(this.battleStat==2){
			App.eventManager.event("LOAD_BATTLE_FILE",this.battleData);
			return;
		}
		this.preLoadingRes();
		console.log(this.battleData);
	}

	__proto.checkLoadTime=function(){
		var time=this.battleData.getEndTime()-GameUtils.GetServerTime();
		if(time <=0){
			return;
		}
		Laya.timer.once(time,this,this.clearLoadSceneFun);
	}

	/**
	*如果战斗结束时间到了 还没有加载完资源 就弹出提示框
	*/
	__proto.clearLoadSceneFun=function(){
		FlyLittleUpTips.setTips("当前城池已被占领，战斗结束");
	}

	__proto.preLoadingRes=function(){
		this.resArr.length=0;
		this.resArr.push(SceneData.getResData("zhandou.atlas","ATLAS"));
		var urlArr=["10003_2.atlas"];
		for (var i4=0;i4 < this.battleData.cellArr.length;i4++){
			var cell=this.battleData.cellArr[i4];
			var concat=cell.initDataArr.concat();
			concat=concat.concat(cell.replaceHeroArr);
			for (var i=0;i < concat.length;i++){
				var data=concat [i];
				if(data==null){
					continue ;
				};
				var sys=ConfigManager.getConfig("sys_force.txt",data.type);
				var url=sys.forceResource+".atlas";
				if(urlArr.indexOf(url)==-1){
					urlArr.push(url);
				}
			}
		}
		this.aniArr.length=0;
		for (var i2=0;i2 < urlArr.length;i2++){
			this.aniArr.push((urlArr [i2]).replace("atlas","ani"));
		}
		for (var j=0;j < urlArr.length;j++){
			this.resArr.push(SceneData.getResData(urlArr[j],"BATTLE_CLIP"));
		}
		for (var i5=0;i5 < this.battleData.cellArr.length;i5++){
			var cell1=this.battleData.cellArr[i5];
			var skillArr=this.battleData.getSkillArr(cell1);
			for (var k=0;k < skillArr.length;k++){
				var skillUrl=SkillDpo.getSkillResUrl(skillArr[k]);
				if(skillUrl){
					this.resArr.push(SceneData.getResData(skillUrl,"SKILL"));
				}
			}
		}
		for (var i3=2;i3 < BattleFileScene.HEAD_ARR.length;i3++){
			var headUrl=BattleFileScene.getHeadEffect(i3);
			this.resArr.push(SceneData.getResData(headUrl,""));
		}
		this.allMax=this.resArr.length+this.aniArr.length+1;
		this.resMax=this.resArr.length;
		this.aniMax=this.aniArr.length;
		console.table(this.resArr);
		App.loaderManager.load(null,this.resArr,new Handler(this,this.resCompleteFun),new Handler(this,this.progressFun),null,1,true,"BATTLE_RES");
	}

	__proto.loadAni=function(){
		if(this.aniArr.length==0){
			this.loadBackImg();
			return;
		};
		var url=this.aniArr.shift();
		this.sendEvent(((this.aniMax-this.aniArr.length+this.resMax)/this.allMax),"");
		var animation=new Animation();
		var trueURL=App.loaderManager.getUrl("BATTLE_ANI",url);
		animation.loadAnimation(trueURL,new Handler(this,this.loadAni));
	}

	__proto.loadBackImg=function(){
		Laya.loader.load("comp/zhandou/zhandouditu211132a.jpg",new Handler(this,this.bgComFun));
	}

	__proto.bgComFun=function(){
		this.enterBattleField();
	}

	__proto.progressFun=function(value){
		var num=value *this.resMax / this.allMax;
		this.sendEvent(num,"");
	}

	__proto.sendEvent=function(value,text){
		var loadResData=new LoadResData();
		loadResData.value=value;
		loadResData.text2="正在加载中...";
		App.eventManager.event("LOAD_RES",loadResData);
	}

	__proto.resCompleteFun=function(){
		this.resArr.length=0;
		this.loadAni();
	}

	/**
	*彻底加载完毕 进入场景
	*/
	__proto.enterBattleField=function(){
		App.eventManager.event("CUSTOM_SCENE_LOAD_OVER");
	}

	BattleSession.loadResFun=function(){
		BattleSession.instance.loadBattleData();
		return null;
	}

	BattleSession.instance=null;
	BattleSession.STAT_BATTLE=1;
	BattleSession.STAT_INFO=2;
	BattleSession.STAT_GUIDE=3;
	BattleSession.BATTLE_RES="BATTLE_RES";
	return BattleSession;
})(Session)


//class huamao.session.BtnSoundSession extends game.mvc.Session
var BtnSoundSession=(function(_super){
	function BtnSoundSession(){
		this._sound={};
		BtnSoundSession.__super.call(this);
		this.init();
	}

	__class(BtnSoundSession,'huamao.session.BtnSoundSession',_super);
	var __proto=BtnSoundSession.prototype;
	__proto.init=function(){
		Laya.stage.on("click",this,this.clickFun);
		this._sound={};
	}

	__proto.clickFun=function(e){
		if((e.target instanceof laya.ui.Button )){
			var btn=e.target;
			var sys=ConfigManager.getConfig("sys_sound.txt",btn.name);
			if(!sys){
				App.voiceManager.playSound("click.wav");
			}
		}
	}

	__getset(0,__proto,'sound',function(){
		return this._sound;
		},function(value){
		this._sound=value;
	});

	return BtnSoundSession;
})(Session)


//class huamao.session.CreateRoleSession extends game.mvc.Session
var CreateRoleSession=(function(_super){
	function CreateRoleSession(){
		this.loginSession=null;
		CreateRoleSession.__super.call(this);
	}

	__class(CreateRoleSession,'huamao.session.CreateRoleSession',_super);
	var __proto=CreateRoleSession.prototype;
	/**
	*通过http创建角色
	*/
	__proto.createRoleByHttp=function(style,playerName){
		var http=new HttpRequest();
		var json={};
		json["action"]="Create";
		json["platformId"]=App.configJson["platformId"];
		json["platformPlayerId"]=this.loginSession.sdkPlayerId;
		json["style"]=style;
		json["playerName"]=playerName;
		json["deviceId"]=this.loginSession.getDeviceID();
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",this,this.createRoleFun,[playerName]);
	}

	__proto.createRoleFun=function(playername,data){
		App.eventManager.event("CREATE_ROLE_BACK");
		data=JSON.parse(data);
		console.log("创角信息",data["msg"]);
		switch(data["code"]){
			case 0:{
					App.eventManager.event("DOT_CREAT_ROLE_SUC",[data["id"],playername]);
					this.loginSession.connectServer(data["token"],data["ip"],data["port"]);
					App.layerManager.showLoadLayer(true);
					App.eventManager.event("LOAD_SCENE_AUTO");
					break ;
				}case 1:{
					FlyUpTips.setTips("已经创建角色");
					break ;
				}case 2:{
					FlyUpTips.setTips("子服务器未开");
					break ;
				}case 3:{
					FlyUpTips.setTips("昵称重复");
					break ;
				}case 9:{
					FlyUpTips.setTips("平台id错误");
					break ;
				}case 9:{
					FlyUpTips.setTips("名称不能为空");
					break ;
				}
			case 8:{
					FlyUpTips.setTips("因您的账号存在违规操作,现被永久封停");
					break ;
				}
			default :{
					break ;
				}
			}
	}

	CreateRoleSession.CREATE_SUCCESS=0;
	CreateRoleSession.ALREADY=1;
	CreateRoleSession.SERVER_CLOSE=2;
	CreateRoleSession.SAME_NAME=3;
	CreateRoleSession.FAIL=9;
	CreateRoleSession.NULL=9;
	return CreateRoleSession;
})(Session)


//class huamao.session.DianZanSession extends game.mvc.Session
var DianZanSession=(function(_super){
	function DianZanSession(){
		this.dianZanDataArr=[];
		DianZanSession.__super.call(this);
	}

	__class(DianZanSession,'huamao.session.DianZanSession',_super);
	var __proto=DianZanSession.prototype;
	__proto.clearData=function(){
		this.dianZanDataArr.length=0;
	}

	__proto.addData=function(playerId,playerName,style){
		var dianZanData=new DianZanData();
		dianZanData.playerId=playerId;
		dianZanData.playerName=playerName;
		dianZanData.playerStyle=style;
		this.dianZanDataArr.push(dianZanData);
	}

	__proto.setZan=function(playerId,zan){
		var data=this.getData(playerId);
		if(data==null){
			return;
		}
		data.isZan=zan;
		Laya.timer.callLater(this,this.sendFun);
	}

	__proto.sendFun=function(){
		App.eventManager.event("DIANZAN_CHANGE");
	}

	__proto.getData=function(playerId){
		for (var i=0;i < this.dianZanDataArr.length;i++){
			var data=this.dianZanDataArr[i];
			if(data.playerId==playerId){
				return data;
			}
		}
		return null;
	}

	return DianZanSession;
})(Session)


//class huamao.session.DotSesion extends game.mvc.Session
var DotSesion=(function(_super){
	function DotSesion(){
		//子服id
		this.loginSession=null;
		this.mainPlayerSession=null;
		this.ifhttp=true;
		DotSesion.__super.call(this);
		App.injOne(this);
		App.eventManager.on("DOT_LOGIN_SDK_SUC",this,this.loginSdkSuc);
		App.eventManager.on("DOT_MAIN_SERVER_LOGIN_SUC",this,this.mainServerLoginSuc);
		App.eventManager.on("CONNECT_SERVER_OK",this,this.sonServerLoginSuc);
		App.eventManager.on("DOT_CREAT_ROLE_SUC",this,this.creatRoleSuc);
		App.eventManager.on("FLUSH_PLAYER_LV",this,this.upPlayerLv);
		Laya.timer.loop(5*60*1000,this,this.sendfiveMininue);
	}

	__class(DotSesion,'huamao.session.DotSesion',_super);
	var __proto=DotSesion.prototype;
	__proto.initLangCB=function(){
		DotSesion.Lang_v=FaceBookManager.getLocale();
	}

	//--------------------------------------------------------
	__proto.send2Php=function(url,str,type){
		var http=new HttpRequest();
		str="json="+str;
		http.send(url,str,"post");
		http.once("complete",this,this.phpCallBack,[type]);
	}

	__proto.phpCallBack=function(type,data){
		var name=[
		"[打点] 登录SDK : type = ",
		"[打点] 登录主服 : type = ",
		"[打点] 登录子服 : type = ",
		"[打点] 创建角色 : type = ",
		"[打点] 角色升级 : type = ",
		"[打点] 五分钟    : type = ",]
	}

	//-----------------------------------------------------------
	__proto.getMd5String=function(type,obj,_keyAry){
		var str=this.getString(obj,_keyAry);
		if(this.ifhttp){
			var mdthttptoold=new Md5HttpTool(str,new Handler(this,this.md5Reback),type,obj);
			mdthttptoold.send();
			}else{
			this.start();
			this.putInt(1012);
			this.putInt(type);
			this.putUtf(str);
			this.send();
		}
	}

	__proto.getString=function(obj,_keyAry){
		var result="";
		for(var i=0;i<_keyAry.length;i++){
			result+=_keyAry[i]+"="+obj[_keyAry[i]];
		}
		return result;
	}

	__proto.getBrowNow=function(){
		return Math.floor(Browser.now()/1000);
	}

	__proto.md5Reback=function(type,obj,sign){
	    return;
		var url="";
		switch(type){
			case DotSesion.DOT_SDK_LOGIN:
				url=MyGameInit.getConfig("gmIp")+"sdkdoLogin";
				break ;
			case DotSesion.DOT_MAINSERVER_LOGIN:
				url=MyGameInit.getConfig("gmIp")+"maindoLogin";
				break ;
			case DotSesion.DOT_SONSERVER_LOGIN:
				url=MyGameInit.getConfig("gmIp")+"doLogin";
				break ;
			case DotSesion.DOT_CREAT_ROLE:
				url=MyGameInit.getConfig("gmIp")+"Level";
				break ;
			case DotSesion.DOT_PLAYER_LV_UP:
				url=MyGameInit.getConfig("gmIp")+"Level";
				break ;
			case DotSesion.DOT_FIVEMINUT:
				url=MyGameInit.getConfig("gmIp")+"LoginOut";
				break ;
			}
		if(url.length > 0){
			obj["sig"]=sign;
			var tophpStr=JSON.stringify(obj);
			this.send2Php(url,tophpStr,type);
		}
	}

	//打印排序数组
	__proto._printSortAry=function(ary){
		ary=ary.sort();
		for(var i=0;i<ary.length;i++){
			console.log(ary[i]);
		}
	}

	__proto.setSubServerId=function(serverid){
		DotSesion.server_subservice=serverid;
	}

	//登录sdk成功---------------------------------------------------
	__proto.loginSdkSuc=function(){
		this.initLangCB();
		var keyAry=["Lang_v","a","app_id","login_ch","platform","status","ts","user_player_id","user_sdk_id"];
		var i=0;
		var obj={};
		obj[keyAry[i++]]=DotSesion.Lang_v;
		obj[keyAry[i++]]="SDK";
		obj[keyAry[i++]]=DotSesion.app_id;
		obj[keyAry[i++]]=DotSesion.login_ch;
		obj[keyAry[i++]]=FaceBookManager.getPlatform();
		obj[keyAry[i++]]="1";
		obj[keyAry[i++]]=this.getBrowNow();
		obj[keyAry[i++]]="";
		obj[keyAry[i++]]=this.loginSession.sdkPlayerId;
		this.getMd5String(DotSesion.DOT_SDK_LOGIN,obj,keyAry);
	}

	//主服登录成功--------------------------------------------------
	__proto.mainServerLoginSuc=function(subserverId){
		this.setSubServerId(subserverId);
		var keyAry=["Lang_v","a","app_id","login_ch","platform","server_name","status","ts","user_player_id","user_sdk_id"];
		var obj={};
		var i=0;
		obj[keyAry[i++]]=DotSesion.Lang_v;
		obj[keyAry[i++]]="主服";
		obj[keyAry[i++]]=DotSesion.app_id;
		obj[keyAry[i++]]=DotSesion.login_ch;
		obj[keyAry[i++]]=FaceBookManager.getPlatform();
		obj[keyAry[i++]]=DotSesion.server_name;
		obj[keyAry[i++]]="1";
		obj[keyAry[i++]]=this.getBrowNow();
		obj[keyAry[i++]]="";
		obj[keyAry[i++]]=this.loginSession.sdkPlayerId;
		this.getMd5String(DotSesion.DOT_MAINSERVER_LOGIN,obj,keyAry);
	}

	//子服务器链接成功--------------------------------------------------
	__proto.sonServerLoginSuc=function(){
		var keyAry=["Lang_v","a","app_id","login_ch","platform","server_name","server_subservice","status","ts","user_player_id","user_sdk_id"];
		var obj={};
		var i=0;
		obj[keyAry[i++]]=DotSesion.Lang_v;
		obj[keyAry[i++]]="子服";
		obj[keyAry[i++]]=DotSesion.app_id;
		obj[keyAry[i++]]=DotSesion.login_ch;
		obj[keyAry[i++]]=FaceBookManager.getPlatform();
		obj[keyAry[i++]]=DotSesion.server_name;
		obj[keyAry[i++]]=DotSesion.server_subservice;
		obj[keyAry[i++]]="1";
		obj[keyAry[i++]]=this.getBrowNow();
		obj[keyAry[i++]]=((this.mainPlayerSession.mainPlayerData.playerId==0)? "" :this.mainPlayerSession.mainPlayerData.playerId);
		obj[keyAry[i++]]=this.loginSession.sdkPlayerId;
		this.getMd5String(DotSesion.DOT_SONSERVER_LOGIN,obj,keyAry);
	}

	//创建角色成功--------------------------------------------------
	__proto._creatRoleOrLv=function(type,name){
		var keyAry=["Lang_v","a","app_id","level","login_ch","name","platform","position","server_name","server_subservice","ts","user_player_id","user_sdk_id"];
		var obj={};
		var i=0;
		obj[keyAry[i++]]=DotSesion.Lang_v;
		obj[keyAry[i++]]=((type==DotSesion.DOT_CREAT_ROLE)? "创角":"升级");
		obj[keyAry[i++]]=DotSesion.app_id;
		obj[keyAry[i++]]=((this.mainPlayerSession.mainPlayerData.Lv > 0)? this.mainPlayerSession.mainPlayerData.Lv :"");
		obj[keyAry[i++]]=DotSesion.login_ch;
		obj[keyAry[i++]]=((name==null)? this.mainPlayerSession.mainPlayerData.playerName :name);
		obj[keyAry[i++]]=FaceBookManager.getPlatform();
		obj[keyAry[i++]]=this.mainPlayerSession.mainPlayerData.job;
		obj[keyAry[i++]]=DotSesion.server_name;
		obj[keyAry[i++]]=DotSesion.server_subservice;
		obj[keyAry[i++]]=this.getBrowNow();
		obj[keyAry[i++]]=((this.mainPlayerSession.mainPlayerData.playerId==0)? "" :this.mainPlayerSession.mainPlayerData.playerId);
		obj[keyAry[i++]]=this.loginSession.sdkPlayerId;
		this.getMd5String(type,obj,keyAry);
	}

	__proto.creatRoleSuc=function(subserverId,playername){
		this.setSubServerId(subserverId);
		this._creatRoleOrLv(DotSesion.DOT_CREAT_ROLE,playername);
	}

	//升级--------------------------------------------------
	__proto.upPlayerLv=function(){
		this._creatRoleOrLv(DotSesion.DOT_PLAYER_LV_UP);
	}

	//5分钟定时发送--------------------------------------------
	__proto.sendfiveMininue=function(){
		var keyAry=["Lang_v","a","app_id","login_ch","platform","status","ts","user_player_id","user_sdk_id"];
		var i=0;
		var obj={};
		obj[keyAry[i++]]=DotSesion.Lang_v;
		obj[keyAry[i++]]="SDK";
		obj[keyAry[i++]]=DotSesion.app_id;
		obj[keyAry[i++]]=DotSesion.login_ch;
		obj[keyAry[i++]]=FaceBookManager.getPlatform();
		obj[keyAry[i++]]="1";
		obj[keyAry[i++]]=this.getBrowNow();
		obj[keyAry[i++]]="";
		obj[keyAry[i++]]=this.loginSession.sdkPlayerId;
		this.getMd5String(DotSesion.DOT_FIVEMINUT,obj,keyAry);
	}

	DotSesion.DOT_SDK_LOGIN=0;
	DotSesion.DOT_MAINSERVER_LOGIN=1;
	DotSesion.DOT_SONSERVER_LOGIN=2;
	DotSesion.DOT_CREAT_ROLE=3;
	DotSesion.DOT_PLAYER_LV_UP=4;
	DotSesion.DOT_FIVEMINUT=5;
	DotSesion.Lang_v="CN";
	DotSesion.app_id="6036";
	DotSesion.server_name="";
	DotSesion.server_subservice="";
	__static(DotSesion,
	['login_ch',function(){return this.login_ch=App.configJson["platformId"];}
	]);
	return DotSesion;
})(Session)


//class huamao.session.DropGiftSession extends game.mvc.Session
var DropGiftSession=(function(_super){
	function DropGiftSession(){
		this.giftData=[];
		DropGiftSession.__super.call(this);
	}

	__class(DropGiftSession,'huamao.session.DropGiftSession',_super);
	return DropGiftSession;
})(Session)


//class huamao.session.DuoBaoSession extends game.mvc.Session
var DuoBaoSession=(function(_super){
	function DuoBaoSession(){
		this.duoBaoData=[];
		this.drawArr=[];
		this.drawListArr=[];
		DuoBaoSession.__super.call(this);
	}

	__class(DuoBaoSession,'huamao.session.DuoBaoSession',_super);
	return DuoBaoSession;
})(Session)


//class huamao.session.FaceBookSdkSession extends game.mvc.Session
var FaceBookSdkSession=(function(_super){
	function FaceBookSdkSession(){
		this.purchaseArr=[];
		this.purchase={};
		FaceBookSdkSession.__super.call(this);
		App.eventManager.on("SDK_INIT",this,this.initFun);
		App.eventManager.on("PAY",this,this.payFun);
		App.eventManager.on("LOGIN_MASTER_SERVER_SUCCESS",this,this.loginMasterFun);
	}

	__class(FaceBookSdkSession,'huamao.session.FaceBookSdkSession',_super);
	var __proto=FaceBookSdkSession.prototype;
	/**
	*初始化游戏时 处理以前没有消耗的订单
	*/
	__proto.loginMasterFun=function(){
		this.FaceBook().payments.getPurchasesAsync().then(function(purchases){
			try {
				this.payBackFun(purchases);
			}catch(error){}
		});
	}

	__proto.purchasesThenFun=function(purchases){
		try {
			this.payBackFun(purchases);
		}catch(error){}
	}

	__proto.payBackFun=function(arr){
		this.purchaseArr=arr;
		this.execute();
	}

	__proto.execute=function(){
		if(this.purchaseArr.length==0){
			return;
		}
		this.purchase=this.purchaseArr.shift();
		this.consumed(this.purchase["purchaseToken"]);
	}

	__proto.consumed=function(token){
		var _$this=this;
		this.FaceBook().payments.consumePurchaseAsync(token).then(function(){
			_$this.send2Server(_$this.purchase["signedRequest"]);
		});
	}

	__proto.consumedFun=function(){
		this.send2Server(this.purchase["signedRequest"]);
	}

	/**
	*fb的钱变成咱游戏的
	*@param signedRequest
	*/
	__proto.send2Server=function(signedRequest){
		var http=new HttpRequest();
		var json={};
		json["action"]="Facebook";
		json["signedRequest"]=signedRequest;
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",this,this.httpFun);
	}

	__proto.httpFun=function(str){
		var obj=JSON.parse(str);
		if(obj["code"]=="0" || obj["code"]==0){
			}else{
			console.log("充值失败"+obj["msg"]);
		}
		this.execute();
	}

	/**
	*支付方法
	*@param payData
	*/
	__proto.payFun=function(payData){
		var _$this=this;
		var productID=((payData.type==0)?'g':'v')+payData.id;
		var obj={};
		obj.productID=productID;
		obj.developerPayload=payData.cp_order_id;
		this.FaceBook().payments.purchaseAsync(obj).then(function(purchase){
			_$this.payBackFun([purchase]);
		});
	}

	__proto.purchaseAsyncThenFun=function(purchase){
		this.payBackFun([purchase]);
	}

	__proto.initFun=function(){
		Browser.window.canPay=0;
		this.FaceBook().payments.onReady(function(){
			Browser.window.canPay=1;
		});
		this.FaceBook().initializeAsync().then(function(){
			Browser.window.FBInstant.startGameAsync().then(function(){
				var fb_sdk_id=Browser.window.FBInstant.player.getID();
				console.log("得到fbid",fb_sdk_id);
				Browser.window.fbid=fb_sdk_id;
				App.eventManager.event("SET_SDK_ID",fb_sdk_id);
			});
		});
	}

	__proto.FaceBook=function(){
		return Browser.window.FBInstant;
	}

	return FaceBookSdkSession;
})(Session)


//class huamao.session.FlyGameSDKSession extends game.mvc.Session
var FlyGameSDKSession=(function(_super){
	function FlyGameSDKSession(){
		FlyGameSDKSession.__super.call(this);
		App.eventManager.on("PAY",this,this.payFun);
	}

	__class(FlyGameSDKSession,'huamao.session.FlyGameSDKSession',_super);
	var __proto=FlyGameSDKSession.prototype;
	__proto.payFun=function(payData){
		var data=JSON.stringify(payData);
		var MainActivity=Laya.PlatformClass.createClass("demo.MainActivity");
		MainActivity.call("PAY_SDK",data);
	}

	return FlyGameSDKSession;
})(Session)


//class huamao.session.FriendSession extends game.mvc.Session
var FriendSession=(function(_super){
	function FriendSession(){
		/**未读信息好友列表*/
		this.redObj={};
		this.myZhenrong="";
		this.selectedZhenrongObj=null;
		this._friendObj=new Object();
		this._chatObj=new Object();
		FriendSession.__super.call(this);
		Laya.timer.loop(1000,this,this.onLoop);
	}

	__class(FriendSession,'huamao.session.FriendSession',_super);
	var __proto=FriendSession.prototype;
	__proto.getRed=function(fid){
		return this.redObj[fid];
	}

	__proto.addRed=function(friend){
		this.redObj[friend]=1;
	}

	__proto.deleteRed=function(friend){
		delete this.redObj[friend];
	}

	__proto.getIsSelect=function(heroId){
		var data;
		for(var $each_data in this.selectedZhenrongObj){
			data=this.selectedZhenrongObj[$each_data];
			if(data.heroId==heroId){
				return true;
			}
		}
		return false;
	}

	__proto.onLoop=function(){
		var friend;
		for(var $each_friend in this._friendObj){
			friend=this._friendObj[$each_friend];
			if(friend.battleEndTime > 0 && friend.battleId > 0){
				if(GameUtils.GetServerTime()> friend.battleEndTime){
					friend.battleId=0;
					friend.battleEndTime=0;
					friend.battleFileUrl="";
				}
			}
		}
	}

	__proto.getFriendChatList=function(friendId){
		return this._chatObj[friendId];
	}

	__proto.addChat=function(data){
		var friendId=0;
		if(data.isSelf){
			friendId=data.toId;
		}
		else{
			friendId=data.fromId;
		}
		if(this._chatObj[friendId]==null){
			this._chatObj[friendId]=[];
		}
		this._chatObj[friendId].push(data);
		App.eventManager.event("ADD_CHAT_MSG",[data]);
	}

	__proto.addFriend=function(data){
		this._friendObj[data.friendId]=data;
	}

	__proto.getFriend=function(friendId){
		var data=this._friendObj[friendId];
		if(data==null){
			data=new FriendData();
			this._friendObj[friendId]=data;
		}
		return data;
	}

	__proto.removeChat=function(friendId){
		delete this._chatObj[friendId];
	}

	__proto.removeFriend=function(friendId){
		delete this._friendObj[friendId];
		delete this._chatObj[friendId];
	}

	__proto.getList=function(index){
		var state=0;
		if(index==0){
			state=1;
		}
		else if(index==1){
			state=2;
		}
		else if(index==2){
			state=8;
		};
		var arr=[];
		var data;
		for(var $each_data in this._friendObj){
			data=this._friendObj[$each_data];
			if(data.checkState(state)){
				arr.push(data);
			}
		}
		arr.sort(function(a,b){
			if(a.isTop==1){
				if(b.isTop==1){
					return b.lastTime-a.lastTime;
				}
				else{
					return-1;
				}
			}
			else{
				if(b.isTop==1){
					return 1;
				}
				else{
					return b.lastTime-a.lastTime;
				}
			}
		});
		return arr;
	}

	FriendSession.STATE_RECENT=1;
	FriendSession.STATE_FRIEND=2;
	FriendSession.STATE_FRIEND_APPLY=4;
	FriendSession.STATE_BLACKLIST=8;
	FriendSession.STATE_TEAM_INVITE=16;
	return FriendSession;
})(Session)


//class huamao.session.GuideSession extends game.mvc.Session
var GuideSession=(function(_super){
	function GuideSession(){
		this.video=0;
		GuideSession.__super.call(this);
	}

	__class(GuideSession,'huamao.session.GuideSession',_super);
	var __proto=GuideSession.prototype;
	__proto.setVedio=function(t){
		this.video=t;
		console.log("新手视频 video = "+t);
	}

	__proto.getVedioIsEnd=function(){
		return (this.video==1);
	}

	return GuideSession;
})(Session)


//class huamao.session.HeartSession extends game.mvc.Session
var HeartSession=(function(_super){
	function HeartSession(){
		this.loginSession=null;
		//App.sceneManager.setScene(MyGameInit.LOGIN_SCENE);
		this.tryTime=0;
		this.autoEvent=new AutoEvent();
		HeartSession.__super.call(this);
		App.eventManager.on("NET_CLOSE",this,this.closeFun);
		App.eventManager.on("SOCKET_CLOSE_ACTIVE",this,this.serverCloseFun);
	}

	__class(HeartSession,'huamao.session.HeartSession',_super);
	var __proto=HeartSession.prototype;
	__proto.serverCloseFun=function(){
		FlyUpTips.setTips("服务器已经关闭");
		Laya.timer.once(2000,this,this.timeFun);
	}

	__proto.timeFun=function(){
		App.reload();
	}

	__proto.closeFun=function(){
		this.tryTime=0;
		LoadMask.show();
		this.autoEvent.add("CONNECT_SERVER_OK",this,this.connectFun);
		this.autoEvent.add("TRY_CONNECT_FAILED",this,this.failedFun);
		this.autoEvent.add("CONNECT_TRY_ONE",this,this.tryOne);
		this.autoEvent.addEventNow();
		this.tryOne();
	}

	/**
	*彻底失败
	*/
	__proto.failedFun=function(){
		this.disposeAll();
		App.reload();
	}

	__proto.tryOne=function(){
		this.loginSession.loginMasterServer();
		this.tryTime++;
		FlyUpTips.setTips("正在尝试第"+this.tryTime+"次重连",1000);
	}

	/**
	*连上socket了
	*/
	__proto.connectFun=function(){
		this.disposeAll();
	}

	/**
	*移除事件监听 关闭ui
	*/
	__proto.disposeAll=function(){
		this.autoEvent.removeAllEvent();
		LoadMask.close();
	}

	return HeartSession;
})(Session)


//class huamao.session.HeroTeamSession extends game.mvc.Session
var HeroTeamSession=(function(_super){
	function HeroTeamSession(){
		this.wuJiangSession=null;
		this.teamArr=[];
		HeroTeamSession.__super.call(this);
	}

	__class(HeroTeamSession,'huamao.session.HeroTeamSession',_super);
	var __proto=HeroTeamSession.prototype;
	__proto.getTeamArr=function(){
		this.teamArr.sort(this.sortFun);
		return this.teamArr;
	}

	__proto.sortFun=function(a,b){
		return a.teamIndex-b.teamIndex;
	}

	__proto.getTeamByIndex=function(teamIndex){
		for (var i=0;i < this.teamArr.length;i++){
			var data=this.teamArr [i];
			if(data.teamIndex==teamIndex){
				return data;
			}
		}
		return null;
	}

	/**
	*@param teamData
	*@return
	*根据队列数据返回数组
	*/
	__proto.getTeam=function(teamData){
		var arr=[];
		for (var i=0;i < teamData.heroIdArr.length;i++){
			var heroId=teamData.heroIdArr[i];
			if(heroId==0){
				continue ;
			};
			var heroData=this.wuJiangSession.getHero(heroId);
			if(heroData && heroData.haveHero()&& !heroData.haveHide()){
				arr.push(heroData);
			}
		}
		return arr;
	}

	__proto.getBuduiList=function(curArr){
		var arr=[];
		var size=curArr.length;
		for(var i=0;i < size;i++){
			var heroData=curArr[i];
			if(heroData.cityId==0 && heroData.haveHero()&& heroData.masterId==0){
				arr.push(heroData);
			}
		}
		return arr;
	}

	return HeroTeamSession;
})(Session)


//class huamao.session.HuoyueSession extends game.mvc.Session
var HuoyueSession=(function(_super){
	function HuoyueSession(){
		this.arrData=[];
		this.StatusShowArray=[];
		this.huoyuedu=0;
		this.isboxVisble=0;
		this.giftArr=[];
		HuoyueSession.__super.call(this);
	}

	__class(HuoyueSession,'huamao.session.HuoyueSession',_super);
	return HuoyueSession;
})(Session)


//class huamao.session.LingQiSession extends game.mvc.Session
var LingQiSession=(function(_super){
	function LingQiSession(){
		this.sdkSession=null;
		this.lingqiData=new LingQiData();
		LingQiSession.__super.call(this);
		this.init();
	}

	__class(LingQiSession,'huamao.session.LingQiSession',_super);
	var __proto=LingQiSession.prototype;
	__proto.init=function(){
		App.injOne(this);
		App.eventManager.on("SDK_INIT",this,this.initFun);
		App.eventManager.on("PAY",this,this.payFun);
	}

	__proto.initFun=function(){
		var url=Browser.window.location.href;
		var str=url.split("?")[1];
		var split=str.split("&");
		console.log("wohahahahahahah!!!!!!!!!"+str);
		for (var i=0;i < split.length;i++){
			var str1=split[i];
			var split2=str1.split("=");
			this.lingqiData[ split2[0]]=split2[1];
		};
		var strr=this.sdkSession.sortKey(this.lingqiData);
		this.sdkSession.sendSign(strr,new Handler(this,this.loginFun));
	}

	__proto.loginFun=function(str){
		if(str==this.lingqiData.sign){
			App.eventManager.event("SET_SDK_ID",this.lingqiData.uid);
			}else{
			FlyUpTips.setTips("您的签名不对 无法登陆");
			App.eventManager.event("SIGN_ERROR");
		}
	}

	__proto.payFun=function(rechargeData){
		var pay_args={};
		pay_args.gamekey="821ad28d4c07f87d70660faf23ccd30e";
		pay_args.uid=this.lingqiData.uid;
		pay_args.time=GameUtils.GetServerTime();
		pay_args.ext_sdk="1";
		pay_args.goods_id=rechargeData.product_id;
		pay_args.goods_name=rechargeData.product_desc;
		pay_args.fee=rechargeData.product_price*100;
		pay_args.game_ordersn=rechargeData.cp_order_id;
		pay_args.ext_cp="1";
		pay_args.sign_type="md5";
		var sign=this.sdkSession.sortKey(pay_args);
		pay_args.sign=sign;
		pay_args.onPayCallback=this.payOk;
		pay_args.onPayCancel=this.payOk;
		Browser.window.h5sdk07073cp.pay(pay_args);
	}

	__proto.payOk=function(){
		FlyUpTips.setTips("支付成功");
	}

	__proto.payCancel=function(){
		FlyUpTips.setTips("取消支付");
	}

	return LingQiSession;
})(Session)


//class huamao.session.LoadSession extends game.mvc.Session
var LoadSession=(function(_super){
	function LoadSession(){
		LoadSession.__super.call(this);
		App.eventManager.on("SET_SCENE",this,this.startFun);
		App.eventManager.on("SET_SCENE_OVER",this,this.overFun);
		App.eventManager.on("START_NEW_GAME",this,this.startNewFun);
	}

	__class(LoadSession,'huamao.session.LoadSession',_super);
	var __proto=LoadSession.prototype;
	__proto.startNewFun=function(){
		App.layerManager.showLoadLayer(true);
		App.eventManager.event("LOAD_SCENE_AUTO");
		App.eventManager.once("ENTER_MAP",this,this.enterMapFun);
	}

	//如果永久监听这个 会在进入地图时打开 这时候mainscene还没有初始化完毕
	__proto.enterMapFun=function(){
		App.layerManager.showLoadLayer(false);
	}

	__proto.overFun=function(sceneName){
		App.layerManager.showLoadLayer(false);
	}

	__proto.startFun=function(sceneName){
		App.layerManager.showLoadLayer(true);
	}

	return LoadSession;
})(Session)


//class huamao.session.LoginSession extends game.mvc.Session
var LoginSession=(function(_super){
	function LoginSession(){
		this.loginAction=null;
		this.sdkPlayerId=null;
		this.token=null;
		this.signError=false;
		this.serverId=-1;
		LoginSession.__super.call(this);
		App.eventManager.on("SET_SDK_ID",this,this.sdkCallBackFun);
		App.eventManager.on("LOGOUT_SDK",this,this.logoutFun);
		App.eventManager.on("SIGN_ERROR",this,this.errorFun);
	}

	__class(LoginSession,'huamao.session.LoginSession',_super);
	var __proto=LoginSession.prototype;
	__proto.errorFun=function(){
		this.signError=true;
	}

	__proto.logoutFun=function(){
		Browser.window.location.reload();
	}

	/**
	*@param sdkPlayerId sdk登陆成功
	*/
	__proto.sdkCallBackFun=function(sdkPlayerId){
		console.log("设置sdk" ,sdkPlayerId);
		this.setSdkPlayerId(sdkPlayerId);
	}

	//this.loginMasterServer();
	__proto.setSdkPlayerId=function(sdkPlayerId){
		console.log("设置 并且 发送事件" ,sdkPlayerId);
		this.sdkPlayerId=sdkPlayerId;
		App.eventManager.event("DOT_LOGIN_SDK_SUC");
	}

	/**
	*新接口
	*先登陆中心服
	*@return
	*/
	__proto.loginMasterServer=function(){
		var http=new HttpRequest();
		var json={};
		json["action"]="Login";
		json["platformId"]=App.configJson["platformId"];
		json["platformPlayerId"]=this.sdkPlayerId;
		console.log("[登录逻辑 2 ] LoginSession.loginMasterServer() platformId = "+App.configJson["platformId"]+"  masterServer = "+MyGameInit.getConfig("masterServer"));
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",this,this.loginComFun);
	}

	__proto.loginComFun=function(data){
		App.eventManager.event("LOGIN_MASTER_SERVER_SUCCESS");
		data=JSON.parse(data);
		console.log("登陆信息:",data["msg"]);
		this.serverId=data["id"];
		switch(data["code"]){
			case 0:{
					App.eventManager.event("DOT_MAIN_SERVER_LOGIN_SUC",data["id"]);
					console.log("[登录逻辑 2 ] 主服登录成功 返回 token = "+data["token"]+" ip = "+data["ip"]+"  port = "+data["port"]);
					this.connectServer(data["token"],data["ip"],data["port"]);
					break ;
				}
			case 1:{
					App.sceneManager.setScene("CREATE_SCENE");
					App.eventManager.event("LOGIN_BACK_CLOSE_MASK");
					break ;
				}
			case 2:{
					FlyUpTips.setTips("子服务器未开");
					App.eventManager.event("LOGIN_BACK_CLOSE_MASK");
					break ;
				}
			case 3:{
					FlyUpTips.setTips("平台id错误");
					App.eventManager.event("LOGIN_BACK_CLOSE_MASK");
					break ;
				}
			case 8:{
					FlyUpTips.setTips("因您的账号存在违规操作,现被永久封停");
					break ;
				}
			default :{
					break ;
				}
			}
	}

	/**
	*连接子服务器
	*@param token
	*@param ip
	*@param port
	*/
	__proto.connectServer=function(token,ip,port){
		this.token=token;
		App.eventManager.once("CONNECT_SERVER_OK",this,this.connectSubServerFun);
		if(GameLoaderManager.isHttps){
			port=443;
		}
		App.socketManager.connectServer(ip,port);
	}

	/**
	*发送登陆请求
	*/
	__proto.connectSubServerFun=function(){
		this.loginAction.sendLoginSubserver(this.token);
	}

	/**
	*服务器在忙 一秒后再请求登陆
	*/
	__proto.delayConnectSubServer=function(){
		Laya.timer.once(1000,this,this.connectSubServerFun);
	}

	__proto.connectOkFun=function(){
		this.loginAction.sendLogin(this.getPlatformId(),this.sdkPlayerId);
	}

	/**
	*旧的 socket用的
	*@param style
	*@param playerName
	*/
	__proto.createRole=function(style,playerName){
		this.loginAction.sendCreateRole(this.getPlatformId(),this.sdkPlayerId,style,playerName);
	}

	__proto.reLogin=function(){
		this.loginAction.sendLogin(this.getPlatformId(),this.sdkPlayerId);
	}

	__proto.getPlatformId=function(){
		return parseInt(App.configJson["platformId"]);
	}

	/**
	*旧接口 直接连服务器的
	*/
	__proto.login=function(){
		App.eventManager.once("CONNECT_SERVER_OK",this,this.connectOkFun);
		App.socketManager.connectByConfig();
	}

	__proto.getDeviceID=function(){
		if(LocalStorage.getItem("DeviceID")==null){
			var str=Math.random()+""+Browser.now();
			LocalStorage.setItem("DeviceID",str);
		}
		return LocalStorage.getItem("DeviceID");
	}

	LoginSession.LOGIN_SUCCESS=0;
	LoginSession.NO_ROLE=1;
	LoginSession.SERVER_CLOSE=2;
	LoginSession.FAIL=3;
	LoginSession.BANNED=8;
	LoginSession.KEY="DeviceID";
	return LoginSession;
})(Session)


//class huamao.session.MailBattleSession extends game.mvc.Session
var MailBattleSession=(function(_super){
	function MailBattleSession(){
		this.currBattleUrl="";
		this.cityObj={};
		this.playerObj={};
		this.mapCitySession=null;
		this.mapCellObj={};
		this.currPlayerId=0;
		this.isopen=false;
		this.dataArr=[];
		this.mapScaleX=NaN;
		this.mapScaleY=NaN;
		this.battleArr=[];
		this.mainPlayerSession=null;
		/**创建时间*/
		this.newTime=0;
		/**结束时间*/
		this.endTime=0;
		/**开战时间*/
		this.openTime=0;
		this._$2_byte=null;
		/**当前进行到的时间*/
		this._currTime=0;
		this._fpsNum=0;
		this.fpsB=18;
		this.newdataArr=[];
		this.fpsTime=0;
		this.kz=180;
		MailBattleSession.__super.call(this);
	}

	__class(MailBattleSession,'huamao.session.MailBattleSession',_super);
	var __proto=MailBattleSession.prototype;
	__proto.init=function(){
		if(this.isopen)return;
		this.isopen=true;
		var sysCity;
		for(var $each_sysCity in ConfigManager.getDataArr("sys_city.txt")){
			sysCity=ConfigManager.getDataArr("sys_city.txt")[$each_sysCity];
			if(sysCity.cityId>0){
				var data=new MailCityData();
				data.cityId=sysCity.cityId;
				data.sysCity=sysCity;
				var arr=this.mapCitySession.mapPosObj[data.cityId];
				data.xx=arr[0];
				data.yy=arr[1];
				this.cityObj[data.cityId]=data;
			}
		}
	}

	__proto.getCity=function(cityId){
		return this.cityObj[cityId];
	}

	__proto.getCityObj=function(){
		return this.cityObj;
	}

	/**
	*获取人物数据
	*
	*/
	__proto.getPlayerData=function(pid){
		return this.playerObj[pid];
	}

	__proto.addPlayer=function(data){
		this.playerObj[data.playerId]=data;
		App.eventManager.event("BATTLEPLAYERUPDATA");
	}

	__proto.getPlayerArr=function(){
		MailBattleSession.ownCityPlayer=this.getPlayerData(this.mainPlayerSession.mainPlayerData.playerId);
		var playerArr=[];
		var data;
		for(var $each_data in this.playerObj){
			data=this.playerObj[$each_data];
			data.hasBorder=false;
			playerArr.push(data);
		}
		playerArr.sort(this.sortHandler);
		for(var i=0;i < playerArr.length-1;i++){
			var aa=playerArr[i];
			var bb=playerArr[i+1];
			if(aa.allyId==bb.playerId){
				aa.hasBorder=true;
			}
		}
		return playerArr;
	}

	__proto.sortHandler=function(a,b){
		if(MailBattleSession.ownCityPlayer){
			if(a.playerId==MailBattleSession.ownCityPlayer.playerId){
				return-1;
			}
			if(a.playerId==MailBattleSession.ownCityPlayer.allyId){
				if(b.playerId !=MailBattleSession.ownCityPlayer.playerId){
					return-1;
				}
				else{
					return 1;
				}
			}
		}
		else{
			return 1;
		};
		var hasBorder=b.playerId+b.allyId-a.playerId-a.allyId;
		return hasBorder;
	}

	__proto.removePlayer=function(pid){
		delete this.playerObj[pid];
		App.eventManager.event("BATTLEPLAYERUPDATA");
	}

	/**玩家进入*/
	__proto.panelEnter=function(byte){
		var data=new PlayerEnter();
		data.setData(byte);
		this.dataArr.push(data);
	}

	/**玩家结盟*/
	__proto.playerAlly=function(byte){
		var data=new PlayerAlly();
		data.setData(byte);
		this.dataArr.push(data);
	}

	/**攻击*/
	__proto.attack=function(byte){
		var data=new PlayerAttack();
		data.setData(byte);
		this.dataArr.push(data);
	}

	/**广播 玩家投降 走这里*/
	__proto.result=function(byte){
		var data=new PlayerResult();
		data.setData(byte);
		this.dataArr.push(data);
	}

	__proto.load=function(battleId){
		this.init();
		LoadMask.show();
		Laya.loader.load(battleId,new Handler(this,this.zlibComFun),null,"arraybuffer");
	}

	__proto.zlibComFun=function(ab){
		if(ab){
			var byteArray=new ByteArray();
			byteArray.endian="littleEndian";
			byteArray.writeArrayBuffer(ab);
			byteArray.uncompress();
			this.comFun([0,byteArray.__getBuffer()]);
		}
		else{
			FlyUpTips.setTips("战况回顾已过期");
		}
		LoadMask.close();
	}

	__proto.comFun=function(arr){
		this.setArrayBuffer(arr [1]);
		App.dialogManager.showMiniDialog(BattlePanel,true,true);
	}

	__proto.setArrayBuffer=function(ab){
		this.dataArr=[];
		this.newdataArr=[];
		this._$2_byte=new Byte(ab);
		var banben=this._$2_byte.getInt32();
		this.newTime=this._$2_byte.getInt32();
		this.openTime=this._$2_byte.getInt32();
		this.endTime=this._$2_byte.getInt32();
		var len=this._$2_byte.getInt32();
		for(var i=0;i<len;i++){
			var type=this._$2_byte.getByte();
			switch (type){
				case 1:
					this.panelEnter(this._$2_byte);
					break ;
				case 2:
					this.playerAlly(this._$2_byte);
					break ;
				case 3:
					this.attack(this._$2_byte);
					break ;
				case 4:
					this.result(this._$2_byte);
					break ;
				}
		}
		len=this._$2_byte.getInt32();
		this.battleArr=[];
		for(i=0;i<len;i++){
			var id=this.readLong(this._$2_byte);
			var time=this._$2_byte.getInt32();
			var cityId=this._$2_byte.getInt32();
			var isWin=this._$2_byte.getByte();
			var attId=this._$2_byte.getInt32();
			var attName=this._$2_byte.getUTFString();
			var attMax=this._$2_byte.getInt32();
			var attLose=this._$2_byte.getInt32();
			var atkExp=this._$2_byte.getInt32();
			var newatkExp=this._$2_byte.getInt32();
			var defenseId=this._$2_byte.getInt32();
			var defenseName=this._$2_byte.getUTFString();
			var defenseMax=this._$2_byte.getInt32();
			var defenseLose=this._$2_byte.getInt32();
			var defenseExp=this._$2_byte.getInt32();
			var newdefenseExp=this._$2_byte.getInt32();
			var url=this._$2_byte.getUTFString();
			if(attId==this.mainPlayerSession.mainPlayerData.playerId || defenseId==this.mainPlayerSession.mainPlayerData.playerId){
				var bData=new MailBattleData();
				bData.battleId=id;
				bData.time=time;
				bData.cityId=cityId;
				bData.type=isWin;
				bData.atkId=attId;
				bData.atkName=attName;
				bData.atkTroops=attMax;
				bData.atkLoseReoops=attLose;
				bData.atkExp=atkExp;
				bData.newatkExp=newatkExp;
				bData.defenseId=defenseId;
				bData.defenseName=defenseName;
				bData.defenseTroops=defenseMax;
				bData.defenseLoseTroops=defenseLose;
				bData.defenseExp=defenseExp;
				bData.newdefenseExp=newdefenseExp;
				bData.URL=url;
				this.battleArr.push(bData);
			}
		}
	}

	__proto.readLong=function(byte){
		return byte.getInt32()*10000000+byte.getInt32();
	}

	/**
	*数据读取完毕 播放动画
	*
	*/
	__proto.startFun=function(){
		App.eventManager.event("BATTLEPLAY",0);
		Laya.timer.loop(100,this,this.timeFun);
		this.timeFun();
	}

	__proto.colseTime=function(){
		Laya.timer.clear(this,this.timeFun);
		App.eventManager.event("BATTLEPLAY",1);
	}

	/**
	*重置数据
	*
	*/
	__proto.closeData=function(){
		this.currPlayerId=0;
		Laya.timer.clear(this,this.timeFun);
		this.closeCity();
		this.fpsNum=1;
		this._currTime=this.newTime;
		this.fpsTime=0;
		if(this.newdataArr.length>0){
			this.dataArr=this.newdataArr;
		}
		else{
			this.newdataArr=this.dataArr.concat();
		}
		App.eventManager.event("BATTLEJINDU",this.fpsTime);
	}

	__proto.timeFun=function(){
		if(this._currTime>=this.endTime){
			App.eventManager.event("BATTLEJINDU",this.fpsTime);
			this.colseTime();
			return;
		}
		App.eventManager.event("BATTLEJINDU",this.fpsTime);
		this.executeCurrData();
		this._currTime+=this.fpsNum;
		this.fpsTime+=this.fpsNum;
	}

	/**
	*执行当前时间要做的事
	*
	*/
	__proto.executeCurrData=function(){
		var arr=[];
		for(var i=0;i<this.dataArr.length;i++){
			if(this._currTime>=this.dataArr[i].startTime){
				this.execute(this.dataArr[i]);
			}
			else{
				arr.push(this.dataArr[i]);
			}
		}
		this.dataArr=arr;
	}

	__proto.execute=function(obj){
		switch(obj.type){
			case 1:
				this.executeEnter(obj);
				break ;
			case 2:
				this.executeAlly(obj);
				break ;
			case 3:
				this.executeAttack(obj);
				break ;
			case 4:
				this.executeResult(obj);
				break ;
			}
	}

	__proto.executeEnter=function(data){
		var pdata=new MailCityPlayerData();
		pdata.playerId=data.playerId;
		pdata.playerName=data.playerName;
		pdata.startTime=data.startTime;
		var firstCity=ConfigManager.getConfig("sys_city.txt",data.cityId);
		pdata.cityFlag=firstCity.cityFlag;
		this.addPlayer(pdata);
		var md=this.getCity(data.cityId);
		md.playerId=pdata.playerId;
		this.setCell(md);
	}

	__proto.executeAlly=function(data){
		var py=this.getPlayerData(data.playerId);
		var newP=this.getPlayerData(data.newPlayerId);
		App.eventManager.event("BATTLECHAT","玩家结盟：公元"+this.gongYuan(data.startTime)+"年，"+py.playerName+"与"+newP.playerName+"缔结了盟约");
		py.allyId=newP.playerId;
		newP.allyId=py.playerId;
		var ownCityPlayer=this.getPlayerData(this.mainPlayerSession.mainPlayerData.playerId);
		if(data.playerId==ownCityPlayer.playerId || data.newPlayerId==ownCityPlayer.playerId){
			var id=0;
			if(data.playerId==ownCityPlayer.playerId){
				id=data.newPlayerId;
			}
			else{
				id=data.playerId;
			}
			var cityData;
			for(var $each_cityData in this.getCityObj()){
				cityData=this.getCityObj()[$each_cityData];
				if(cityData.playerId==id){
					this.setCell(cityData);
				}
			}
		}
		this.sessionUpdataEvent("BATTLEPLAYERUPDATA");
	}

	//这里写人物列表框住结盟的人
	__proto.executeAttack=function(data){
		var md=this.getCity(data.cityId);
		var cell=this.mapCellObj [data.cityId];
		cell.setisAttack(true,data,md);
	}

	__proto.executeResult=function(data){
		switch(data.actionType){
			case 3:;
				var py=this.getPlayerData(data.playerId);
				App.eventManager.event("BATTLECHAT","玩家出局：公元"+this.gongYuan(data.startTime)+"年，"+py.playerName+"的最后一座城池被"+data.playerName+"攻占，全国覆灭。");
				this.shiBaiFun(data);
				break ;
			}
	}

	__proto.shiBaiFun=function(data){
		var ownCityPlayer=this.getPlayerData(data.playerId);
		var cityPlayer=this.getPlayerData(ownCityPlayer.allyId);
		if(cityPlayer)cityPlayer.allyId=0;
		this.removePlayer(data.playerId);
		var cityData;
		for(var $each_cityData in this.getCityObj()){
			cityData=this.getCityObj()[$each_cityData];
			if(cityData.playerId==data.playerId){
				cityData.playerId=0;
				this.setCell(cityData);
			}
		}
	}

	__proto.setCell=function(data){
		var cell=this.mapCellObj [data.cityId];
		cell.init(data);
	}

	/**
	*清空所有城池数据
	*
	*/
	__proto.closeCity=function(){
		var data;
		for(var $each_data in this.playerObj){
			data=this.playerObj[$each_data];
			this.removePlayer(data.playerId);
		}
		var cityData;
		for(var $each_cityData in this.getCityObj()){
			cityData=this.getCityObj()[$each_cityData];
			cityData.playerId=0;
			this.setCell(cityData);
		}
	}

	__proto.gongYuan=function(curr){
		return this.kz+Math.ceil(((curr-this.openTime)/1000)/60);
	}

	/**
	*@private
	*/
	/**这个就是快进的倍率*/
	__getset(0,__proto,'fpsNum',function(){
		return this._fpsNum;
		},function(value){
		this._fpsNum=this.fpsB*value;
	});

	MailBattleSession.ownCityPlayer=null;
	return MailBattleSession;
})(Session)


//class huamao.session.MailSession extends game.mvc.Session
var MailSession=(function(_super){
	function MailSession(){
		this.index=-1;
		this.currTiaoZhanData=null;
		this.battleIsopen=true;
		this.isOpen=true;
		this.sysObj=null;
		this.activityObj=null;
		this.IsRedServer=false;
		this.IsZhanBaoRedServer=false;
		this.mailArr=null;
		this.battleArr=null;
		this.mailData=new Object();
		this.battleData=new Object();
		MailSession.__super.call(this);
		App.eventManager.on("CONNECT_SERVER_OK",this,this.initData);
	}

	__class(MailSession,'huamao.session.MailSession',_super);
	var __proto=MailSession.prototype;
	__proto.initData=function(){
		this.sysObj={};
		this.activityObj={};
		var arr=ConfigManager.getDataArr("sys_mail.txt");
		for(var i=0;i<arr.length;i++){
			var mail=arr[i];
			if(!this.sysObj[mail.mailType]){
				this.sysObj[mail.mailType]=[];
			}
			this.sysObj[mail.mailType].push(mail);
		}
		arr=ConfigManager.getDataArr("sys_activity.txt");
		for(i=0;i<arr.length;i++){
			var d=arr[i];
			this.activityObj[d.activityType]=d;
		}
	}

	__proto.addMail=function(data){
		this.setMailData(data);
		this.mailData[data.mailId]=data;
	}

	__proto.deleteMail=function(id){
		delete this.mailData[id];
	}

	__proto.deleteALL=function(){
		var data;
		for(var $each_data in this.mailData){
			data=this.mailData[$each_data];
			if(data.item==""){
				this.deleteMail(data.mailId);
			}
			else if(data.item !="" && data.isRead==2){
				this.deleteMail(data.mailId);
			}
		}
	}

	__proto.getMail=function(id){
		return this.mailData[id];
	}

	__proto.getMailArr=function(){
		this.mailArr=[];
		var data;
		for(var $each_data in this.mailData){
			data=this.mailData[$each_data];
			this.mailArr.push(data);
		}
		this.mailArr.sort(this.sortHandler);
		var md=new MailData();
		md.mailType=MailType.ZHANBAO;
		md.mailTitle="好友战斗战报";
		this.mailArr.unshift(md);
		return this.mailArr;
	}

	__proto.sortHandler=function(a,b){
		return b.time-a.time;
	}

	__proto.sortReadHandler=function(a,b){
		return a.isRead-b.isRead;
	}

	/**
	*设置邮件数据
	*@param data
	*
	*/
	__proto.setMailData=function(data){
		if(data.item!="" && data.item!=null){
			var arr=data.item.split(",");
			data.itemArr=arr;
		}
		switch (data.mailType){
			case 0:
				break
			case 1:
				data.mailTitle="战况回顾";
				data.contentArr=data.mailContent.split(",");
				var cArr=data.contentArr.concat();
				cArr.shift();
				var sysArr=this.sysObj[data.mailType];
				if(cArr.length==1){
					data.mailContent=GameUtils.replaceLocaleConfigFH(sysArr[0].mailContent,[cArr[0]]);
				}
				else if(cArr.length==2){
					var str=cArr[0]+"与"+cArr[1];
					data.mailContent=GameUtils.replaceLocaleConfigFH(sysArr[0].mailContent,[str]);
				}
				else if(cArr.length==0){
					data.mailContent=sysArr[1].mailContent;
				}
				break ;
			case 2:;
				var mArr=this.sysObj[data.mailType];
				var dd;
				var md;
				for(var i=0;i<mArr.length;i++){
					md=mArr[i];
					if(md.activityType==parseInt(data.mailContent)){
						dd=this.activityObj[md.activityType];
						break ;
					}
				}
				data.mailTitle=dd.activityTitle;
				data.mailContent=md.mailContent;
				break ;
			case 3:;
				var tArr=this.sysObj[data.mailType];
				md=tArr[0];
				data.mailTitle="城池掉落";
				data.mailContent=md.mailContent;
				break ;
			}
	}

	__proto.addBattle=function(data){
		this.battleData[data.battleId]=data;
	}

	__proto.deleteBattle=function(id){
		delete this.battleData[id];
	}

	__proto.deleteAllBattle=function(){
		this.battleData={};
	}

	__proto.getBattleArr=function(){
		this.battleArr=[];
		var data;
		for(var $each_data in this.battleData){
			data=this.battleData[$each_data];
			this.battleArr.push(data);
		}
		this.battleArr.sort(this.sortHandler);
		return this.battleArr;
	}

	__proto.sortBattleHandler=function(a,b){
		return b.time-a.time;
	}

	__proto.battleAllRead=function(){
		var data;
		for(var $each_data in this.battleData){
			data=this.battleData[$each_data];
			this.battleRead(data.battleId);
		}
	}

	__proto.battleRead=function(id){
		this.battleData[id].isRead=1;
	}

	return MailSession;
})(Session)


//class huamao.session.MainPlayerSession extends game.mvc.Session
var MainPlayerSession=(function(_super){
	function MainPlayerSession(){
		this.jobJump=0;
		this.mainPlayerData=new PlayerData();
		MainPlayerSession.__super.call(this);
	}

	__class(MainPlayerSession,'huamao.session.MainPlayerSession',_super);
	var __proto=MainPlayerSession.prototype;
	__proto.checkIfInGuide=function(){
		if(this.mainPlayerData.job==1001){
			return true;
		}
		return false;
	}

	return MainPlayerSession;
})(Session)


//class huamao.session.MapCitySession extends game.mvc.Session
var MapCitySession=(function(_super){
	function MapCitySession(){
		this.gameOverData=null;
		this.zuduiList=[];
		this.unionList=[];
		this.invitedPlayerId=-1;
		this.zhanbaoList=[];
		this.chuzhengDic=null;
		/**-1啥也没有等于还没获取到数据 1地图 2休息室*/
		this.isGoMapCity=-1;
		this.selfDataInfo=null;
		this._openWarTime=0;
		/**开战剩余时间*/
		this.openWarRemainingTime=0;
		/**招兵买马的次数*/
		this.zhaobingmaimaTimes=0;
		//城内的数据
		this.innerCityId=0;
		this.isAutoBubing=0;
		this.autoLvNum=0;
		this.innerCityYubeiyi=0;
		this.innerFoodOutput=0;
		this.innerYubeiyiOutput=0;
		this.innerTongqianOutput=0;
		this.innerBuildObj=null;
		this.timeObj={};
		this.mainPlayerSession=null;
		this.mapCityAction=null;
		this.jiJieObj={};
		//-----------------城池---------------------------
		this._cityList=[];
		this._sendDataList=[];
		this._sysBuilding=null;
		MapCitySession.__super.call(this);
		this.mapPosObj=new Object();
		this.chuzhengParam=new ChuzhengParam();
		this.cityPlayerObj=new Object();
		this.actionObj=new Object();
		this.cityCellObj=new Object();
		this.openWarDate=new Date();
		this._cityObj=new Object();
		this._battleObj=new Object();
		App.eventManager.on("CONNECT_SERVER_OK",this,this.initCity);
		App.eventManager.on("BATTLE_INFO_IS_READ",this,this.checkZhanBao);
	}

	__class(MapCitySession,'huamao.session.MapCitySession',_super);
	var __proto=MapCitySession.prototype;
	__proto.timerStart=function(){
		Laya.timer.loop(1000,this,this.onStep);
	}

	__proto.checkZhanBao=function(){
		for (var i=0;i < this.zhanbaoList.length;i++){
			var zhan=this.zhanbaoList [i];
			if(zhan.isRead==0){
				App.eventManager.event("ZHAN_BAO_NOT_READ",1);
				return;
			}
		}
		App.eventManager.event("ZHAN_BAO_NOT_READ",0);
	}

	__proto.clearData=function(){
		this.gameOverData=null;
		this.invitedPlayerId=-1;
		this.cityPlayerObj=new Object();
		this.chuzhengDic=new Object();
		this.actionObj=new Object();
		this._openWarTime=this.openWarRemainingTime=-1;
		this._cityList.length=0;
		this.innerCityId=-1;
		this.isAutoBubing=-1;
		this.autoLvNum=-1;
		this.innerCityYubeiyi=-1;
		this.innerFoodOutput=-1;
		this.innerYubeiyiOutput=-1;
		this.innerTongqianOutput=-1;
		this.innerBuildObj=new Object();
		this.timeObj={};
		this._battleObj=new Object();
		Laya.timer.clear(this,this.onStep);
		var wujiangSession=App.getSession("wuJiangSession");
		var hero;
		for(var $each_hero in wujiangSession.heroArr){
			hero=wujiangSession.heroArr[$each_hero];
			hero.cityId=0;
			hero.soldier=0;
			hero.heroState=0;
		}
		this.initCity();
		this.zhanbaoList.length=0;
		this.checkZhanBao();
		App.eventManager.event("CLEAR_ALL_CITY");
	}

	__proto.getList=function(){
		this.zhanbaoList.sort(this.sortHandler);
		return this.zhanbaoList;
	}

	__proto.sortHandler=function(a,b){
		return b.startTime-a.startTime;
	}

	__proto.sortReadHandler=function(a,b){
		return a.isRead-b.isRead;
	}

	__proto.isAllRead=function(){
		var zhanbaoData;
		for(var $each_zhanbaoData in this.zhanbaoList){
			zhanbaoData=this.zhanbaoList[$each_zhanbaoData];
			if(zhanbaoData.isRead==0){
				return false;
			}
		}
		return true;
	}

	__proto.allRead=function(){
		var zhanbaoData;
		for(var $each_zhanbaoData in this.zhanbaoList){
			zhanbaoData=this.zhanbaoList[$each_zhanbaoData];
			zhanbaoData.isRead=1;
		}
		this.checkZhanBao();
	}

	// }
	__proto.getTongqian=function(){
		if(this.selfDataInfo==null){
			return 0;
		}
		return this.selfDataInfo.tongqian;
	}

	__proto.getLiangcao=function(){
		if(this.selfDataInfo==null){
			return 0;
		}
		return this.selfDataInfo.liangcao;
	}

	__proto.checkTongqian=function(value){
		return this.getTongqian()-value >=0;
	}

	__proto.checkLiangcao=function(value){
		return this.getLiangcao()-value >=0;
	}

	__proto.getBuduiHeros=function(cityId){
		var wujiangSession=App.getSession("wuJiangSession");
		var arr=[];
		var hero;
		for(var $each_hero in wujiangSession.heroArr){
			hero=wujiangSession.heroArr[$each_hero];
			if(hero.cityId==0 && hero.haveHero()&& hero.masterId==0 && !hero.haveHide()){
				arr.push(hero);
			}
		}
		arr.sort(function(a,b){
			if(b.sysHero.heroColor !=a.sysHero.heroColor){
				return b.sysHero.heroColor-a.sysHero.heroColor;
			}
			else{
				if(b.heroLv !=a.heroLv){
					return b.heroLv-a.heroLv;
				}
				else{
					if(b.fight !=a.fight){
						return b.fight-a.fight;
					}
					else{
						return a.sysHero.heroId-b.sysHero.heroId;
					}
				}
			}
		});
		return arr;
	}

	__proto.getBuduiBingli=function(cityId){
		var total=0;
		var cityData=this.getCity(cityId);
		var hero;
		for(var $each_hero in cityData.heroObj){
			hero=cityData.heroObj[$each_hero];
			total+=hero.soldier;
		}
		return total;
	}

	/**是否是自己的城池*/
	__proto.checkCityIsMine=function(cityId){
		var cityData=this.getCity(cityId);
		return cityData.playerType;
	}

	/**当前位置是否 有建筑*/
	__proto.ckeckCityBuildByIndex=function(index){
		var innerBuildData=this.innerBuildObj[index];
		return innerBuildData.isHas==1;
	}

	__proto.getBuildDataByIndex=function(index){
		return this.innerBuildObj[index];
	}

	__proto.setOpenWarTime=function(openWarTime){
		this._openWarTime=openWarTime;
		this.openWarDate.setTime(this._openWarTime *1000);
		this.openWarRemainingTime=this._openWarTime-GameUtils.GetServerTime();
		if(this.openWarRemainingTime > 0){
			Laya.timer.clear(this,this.onTimer);
			Laya.timer.loop(1000,this,this.onTimer);
			App.eventManager.event("ADD_BAOHUZHAO");
		}
		else{
			App.eventManager.event("REMOVE_BAOHUZHAO");
		}
	}

	//是否可以投降
	__proto.canTouXiang=function(){
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this.mainPlayerSession.mainPlayerData.job);
		var sysmatch=ConfigManager.getConfig("sys_match.txt",sysTitle.titleRoom);
		var ctime=GameUtils.GetServerTime()*1000;
		var toutime=this._openWarTime*1000+sysmatch.maxSurrenderLength*60000;
		if(ctime > toutime){
			return true;
		}
		return false;
	}

	__proto.onTimer=function(){
		this.openWarRemainingTime--;
		if(this.openWarRemainingTime==0){
			Laya.timer.clear(this,this.onTimer);
			App.eventManager.event("REMOVE_BAOHUZHAO");
		}
	}

	/**是否已开战*/
	__proto.getIsNotOpenFight=function(){
		return this.openWarRemainingTime > 0;
	}

	__proto.getNowTime=function(){
		if(this.gameOverData){
			var year1=184+this.gameOverData.year;
			return "公元"+year1+"年";
		}
		if(this.getIsNotOpenFight()){
			var hour=this.openWarDate.getHours();
			var min=this.openWarDate.getMinutes();
			return (hour < 10 ? "0"+hour :hour)+":"+(min < 10 ? "0"+min :min)+" 开战";
		};
		var deltaTime=GameUtils.GetServerTime()-this._openWarTime;
		var deltaHour=deltaTime / 3600;
		var year=184+parseInt(deltaHour+"");
		return "公元"+year+"年";
	}

	__proto.onStep=function(){
		var serverTime=GameUtils.GetServerTime();
		var action;
		for(var $each_action in this.actionObj){
			action=this.actionObj[$each_action];
			if(action.remainingTime > 0){
				action.remainingTime=action.endTime-GameUtils.GetServerTime();
			}
			if(action.isWeixian && action.remainingTime <=0){
				this.deleteAction(action.actionId);
			}
			if((action.battleId==0 && action.remainingTime <=0)|| action.battleId > 0){
				App.eventManager.event("DELETE_LINE",[action.actionId]);
				if(action.battleId > 0 && action.remainingTime <=0){
					this.delActionById(action.actionId);
				}
			}
			if(action.battleId==0 && action.remainingTime <=0){
				if(action.actionPlayerId==this.selfDataInfo.playerId){
					App.eventManager.event("DELETE_XINGJUN_ITEM",action.actionId);
				}
				if(action.actionType==CityPlayerType.SELF){
					this.delActionById(action.actionId);
				}
				else if(action.actionType==CityPlayerType.FRIEND){
					var cityData=this.getCity(action.toId);
					if(cityData.playerType !=CityPlayerType.FRIEND){
						this.delActionById(action.actionId);
					}
				}
				else if(action.actionType==CityPlayerType.ENEMY || action.actionType==CityPlayerType.KONG){
					cityData=this.getCity(action.toId);
					if(cityData.playerType !=CityPlayerType.ENEMY && action.actionType !=CityPlayerType.KONG){
						this.delActionById(action.actionId);
					}
				}
			}
		}
		var battle;
		for(var $each_battle in this._battleObj){
			battle=this._battleObj[$each_battle];
			battle.remainingTime=battle.endTime-GameUtils.GetServerTime();
			if(battle.remainingTime <=0){
				this.removeBattle(battle);
			}
		}
		var buildData;
		for(var $each_buildData in this.innerBuildObj){
			buildData=this.innerBuildObj[$each_buildData];
			if(buildData.endTime > 0){
				buildData.endTime=buildData.time-GameUtils.GetServerTime();
			}
		}
		App.eventManager.event("UPDATE_TIME",[this.getNowTime()]);
	}

	__proto.addAction=function(data){
		this.actionObj[data.actionId]=data;
	}

	__proto.getActionById=function(id){
		return this.actionObj[id];
	}

	__proto.getActionByToId=function(toId){
		var data;
		for(var $each_data in this.actionObj){
			data=this.actionObj[$each_data];
			if(data.toId==toId){
				return data;
			}
		}
		return null;
	}

	__proto.deleteAction=function(id){
		delete this.actionObj[id];
		App.eventManager.event("WEIXIAN_UPDATE");
	}

	__proto.delActionById=function(id){
		delete this.actionObj[id];
		App.eventManager.event("DELETE_XINGJUN_ITEM",id);
	}

	__proto.updateAction=function(battle){
		var action=this.actionObj[battle.actionId];
		if(action){
			action.battleId=battle.battleId;
			action.battleFileUrl=battle.battleFileUrl;
			action.remainingTime=battle.remainingTime;
			action.endTime=battle.endTime;
			App.eventManager.event("UPDATE_XINGJUN_LIST");
		}
	}

	__proto.getWeixianList=function(){
		var arr=[];
		var action;
		for(var $each_action in this.actionObj){
			action=this.actionObj[$each_action];
			if(action.isWeixian==1){
				arr.push(action);
			}
		}
		arr.sort(function(a,b){
			return b.remainingTime-a.remainingTime;});
		return arr;
	}

	//
	__proto.checkWeiXian=function(cityId){
		var arr=this.getWeixianList();
		for(var i=0;i<arr.length;i++){
			var actiondata=arr [i];
			if(cityId==actiondata.toId){
				return true;
			}
		}
		return false;
	}

	__proto.getActionAll=function(){
		var arr=[];
		var action;
		for(var $each_action in this.actionObj){
			action=this.actionObj[$each_action];
			arr.push(action);
		}
		return arr;
	}

	//获取行军列表
	__proto.getActionList=function(){
		var arr=[];
		var action;
		for(var $each_action in this.actionObj){
			action=this.actionObj[$each_action];
			if(action.actionPlayerId==this.selfDataInfo.playerId){
				if(action.remainingTime > 0 || action.battleId > 0 || action.actionType==CityPlayerType.FRIEND){
					arr.push(action);
				}
			}
		}
		return arr;
	}

	__proto.initCity=function(){
		this._cityObj=new Object();
		var sysCity;
		for(var $each_sysCity in ConfigManager.getDataArr("sys_city.txt")){
			sysCity=ConfigManager.getDataArr("sys_city.txt")[$each_sysCity];
			if(sysCity.cityId > 0){
				var data=new CityData();
				data.cityId=sysCity.cityId;
				data.sysCity=sysCity;
				this._cityObj[data.cityId]=data;
			}
		}
	}

	__proto.getCity=function(cityId){
		var data=this._cityObj[cityId];
		return data;
	}

	__proto.getCitysByPlayerId=function(playerId){
		var arr=[];
		var data;
		for(var $each_data in this._cityObj){
			data=this._cityObj[$each_data];
			if(data.playerId==playerId){
				arr[arr.length]=data;
			}
		}
		return arr;
	}

	__proto.getCityByPlayerIdAndCityId=function(playerId,cityId){
		var data;
		for(var $each_data in this._cityObj){
			data=this._cityObj[$each_data];
			if(data.playerId==playerId && data.cityId==cityId){
				return data;
			}
		}
		return null;
	}

	__proto.getMyCitys=function(){
		return this.getCitysByPlayerId(this.selfDataInfo.playerId);
	}

	__proto.getAllCitys=function(){
		return this._cityObj;
	}

	//--------------------进入地图的玩家----------------------
	__proto.addCityPlayer=function(cityPlayerData){
		this.cityPlayerObj[cityPlayerData.playerId]=cityPlayerData;
	}

	__proto.getCityPlayer=function(playerId){
		var data=this.cityPlayerObj[playerId];
		if(data==null){
			data=new CityPlayerData();
			this.addCityPlayer(data);
		}
		data.playerId=playerId;
		return data;
	}

	__proto.removeCityPlayer=function(playerId){
		var playerData=this.cityPlayerObj[playerId];
		var mengyouData=this.cityPlayerObj[playerData.mengyouId];
		mengyouData.mengyouId=0;
		delete this.cityPlayerObj[playerId];
		App.eventManager.event("REMVOE_CITY_PLAYER",playerId);
		App.eventManager.event("WAIJIAO_FLUSH");
	}

	__proto.getCityPlayerList=function(){
		var _$this=this;
		var tmpObj=new Object();
		var arr=[];
		arr.push(this.selfDataInfo);
		tmpObj[this.selfDataInfo.playerId]=this.selfDataInfo;
		if(this.selfDataInfo.mengyouId > 0){
			var mengyou=this.getCityPlayer(this.selfDataInfo.mengyouId);
			arr.push(mengyou);
			tmpObj[mengyou.playerId]=mengyou;
		}
		var data;
		for(var $each_data in this.cityPlayerObj){
			data=this.cityPlayerObj[$each_data];
			data.hasBorder=false;
			if(data.playerType==CityPlayerType.KONG){
				continue ;
			}
			if(data.playerId==this.selfDataInfo.playerId || data.playerId==this.selfDataInfo.mengyouId){
				continue ;
			}
			arr.push(data);
			tmpObj[data.playerId]=data;
		};
		var groupId=0;
		var $each_data;
		for($each_data in tmpObj){
			data=tmpObj[$each_data];
			if(data.mengyouId > 0){
				groupId++;
				data.groupId=groupId;
				var mengyouData=tmpObj[data.mengyouId];
				mengyouData.groupId=groupId;
				delete tmpObj[data.playerId];
				delete tmpObj[mengyouData.playerId];
			}
		}
		arr.sort(function(a,b){
			if(a.playerId==_$this.selfDataInfo.playerId){
				return-1;
				}else if(b.playerId==_$this.selfDataInfo.playerId){
				return 1;
			}
			if(a.playerId==_$this.selfDataInfo.mengyouId){
				return-1;
				}else if(b.playerId==_$this.selfDataInfo.mengyouId){
				return 1;
			};
			var hasBorder=b.groupId-a.groupId;
			return hasBorder;
		});
		for(var i=0;i < arr.length-1;i++){
			var aa=arr[i];
			var bb=arr[i+1];
			if(aa.mengyouId==bb.playerId){
				aa.hasBorder=true;
			}
		}
		return arr;
	}

	__proto.addBattle=function(battle){
		this._battleObj[battle.battleFileUrl]=battle;
		var cityData=this.getCity(battle.cityId);
		cityData.battleFileUrl=battle.battleFileUrl;
		console.log("城池着火了",cityData.sysCity.cityName,cityData.battleFileUrl);
		if(GameUtils.GetServerTime()< battle.endTime){
			App.eventManager.event("ADD_FIGHT_FIRE",cityData.cityId);
		}
	}

	__proto.getBattle=function(url){
		return this._battleObj[url];
	}

	__proto.removeBattle=function(battle){
		if(battle){
			this.delActionById(battle.actionId);
			var cityData=this.getCity(battle.cityId);
			cityData.battleFileUrl="";
			App.eventManager.event("REMOVE_FIGHT_FIRE",cityData.cityId);
			delete this._battleObj[battle.battleFileUrl];
		}
	}

	__proto.addCityList=function(data){
		this._cityList.push(data);
	}

	__proto.clearCityList=function(){
		this._cityList=[];
	}

	__proto.getCityListAry=function(){
		return this._cityList;
	}

	//拥有城池数
	__proto.getCityNum=function(){
		return this._cityList.length;
	}

	//总兵力
	__proto.getAllSoldier=function(){
		var result=0;
		var size=this.getCityNum();
		for(var i=0;i<size;i++){
			var data=this._cityList [i];
			result+=data.soldier+data.heroSoldier;
		}
		return result;
	}

	__proto.startJs=function(sysBuilding){
		this._sysBuilding=sysBuilding;
		this.onStart();
	}

	__proto.onStart=function(){
		if(this._sendDataList.length > 0){
			var arr=this._sendDataList.shift();
			Laya.timer.once(100,this,this.onBuild,arr);
			MouseManager.enabled=false;
			}else{
			MouseManager.enabled=true;
		}
	}

	__proto.onBuild=function(cityId,index){
		if(this.checkTongqian(this._sysBuilding.upgradeCost)==false){
			FlyUpTips.setTips("铜钱不足");
			MouseManager.enabled=true;
			return;
		}
		this.mapCityAction.onLvupBuild(cityId,index,this._sysBuilding.buildType);
		this.onStart();
	}

	__getset(0,__proto,'battleObj',function(){
		return this._battleObj;
	});

	return MapCitySession;
})(Session)


//class huamao.session.OpenFunctionSession extends game.mvc.Session
var OpenFunctionSession=(function(_super){
	function OpenFunctionSession(){
		this.mainPlayerSession=null;
		this.unionSession=null;
		this._funObj={};
		/**适用于步数的*/
		this.unlockObj=null;
		OpenFunctionSession.__super.call(this);
		this.init();
	}

	__class(OpenFunctionSession,'huamao.session.OpenFunctionSession',_super);
	var __proto=OpenFunctionSession.prototype;
	__proto.init=function(){
		App.eventManager.on("CONNECT_SERVER_OK",this,this.initData);
	}

	__proto.initData=function(){
		this.unlockObj={};
		var arr=ConfigManager.getDataArr("sys_unlock.txt");
		for(var i=0;i<arr.length;i++){
			var sys=arr[i];
			this.unlockObj[sys.unlockCondition]=sys;
		}
	}

	__proto.addItem=function(key){
		this._funObj[key]=1;
		this.sessionUpdataEvent("FUNCTIONNUM");
	}

	/**
	*true 开启 false未开启
	*@param key
	*@return
	*
	*/
	__proto.getFun=function(key){
		console.log("pppp",key);
		var job=this.mainPlayerSession.mainPlayerData.job;
		var sys=this.getSys(key);
		var boo=false;
		if(sys && sys.unlockBaseline==1){
			if(job>=1002){
				boo=true;
			}
		}
		if(sys && sys.unlockType!=0 && boo==false){
			if(sys.unlockType==1 && this.getYinDao(sys.unlockCondition)==false){
				return false;
			}
			else if(sys.unlockType==2 && job<parseInt(sys.unlockCondition)){
				return false;
			}
			else if(sys.unlockType==3 && this.mainPlayerSession.mainPlayerData.Lv<parseInt(sys.unlockCondition)){
				return false;
			}
		}
		return true;
	}

	__proto.getSys=function(key){
		var sys=ConfigManager.getConfig("sys_unlock.txt",key);
		return sys;
	}

	/**新手引导功能开启 true 开启 false未开启 */
	__proto.getYinDao=function(key){
		var job=this.mainPlayerSession.mainPlayerData.job;
		if(job==1001){
			return this._funObj.hasOwnProperty(key);
			}else{
			return true;
		}
	}

	/**
	*是否拦截面板 true拦截 false不拦截
	*@param panel
	*@return
	*
	*/
	__proto.isFunction=function(panel){
		console.log("pppp",panel);
		var job=this.mainPlayerSession.mainPlayerData.job;
		var sys=this.getSys(panel);
		var boo=true;
		if(sys && sys.unlockBaseline==1){
			if(job>=1002){
				boo=false;
			}
		}
		if(sys && sys.unlockType!=0 && boo==true){
			var sysTips=ConfigManager.getConfig("sys_tips.txt",sys.unlockTips);
			if(sys.unlockType==1 && this.getYinDao(sys.unlockCondition)==false){
				FlyUpTips.setTips(sysTips.tipsDescribe);
				return true;
			}
			else if(sys.unlockType==2 && job<parseInt(sys.unlockCondition)){
				FlyUpTips.setTips(sysTips.tipsDescribe);
				return true;
			}
			else if(sys.unlockType==3 && this.mainPlayerSession.mainPlayerData.Lv<parseInt(sys.unlockCondition)){
				FlyUpTips.setTips(sysTips.tipsDescribe);
				return true;
			}
		}
		return false;
	}

	__getset(0,__proto,'funObj',function(){
		return this._funObj;
		},function(value){
		this._funObj=value;
	});

	return OpenFunctionSession;
})(Session)


//class huamao.session.PlayerInfoSession extends game.mvc.Session
var PlayerInfoSession=(function(_super){
	function PlayerInfoSession(){
		this.daySalary=0;
		// 每日礼包(0:未领取,1:已领取)
		this.monthSalary=0;
		// 每月礼包(0:可领取,其他:剩余天数)
		this.monthGameSize=0;
		// 当月参与对局数
		this.jobBoxList=null;
		// 已领官职宝箱列表(分隔符：,)
		this.styleList=null;
		// 已获得君主形象列表(分隔符：,)
		this.cityStyleList=null;
		// 已获得城池外观列表(分隔符：,)
		this.headFrameList=null;
		// 已获得头像框列表(分隔符：,)
		this.bannerList=null;
		// 已获得旗帜列表(分隔符：,)
		this.monthMaxJob=0;
		//本月最大官职
		this.praise=0;
		// public var egg:int;//鸡蛋
		this.scorLogAry=[];
		this.jifen=false;
		PlayerInfoSession.__super.call(this);
	}

	__class(PlayerInfoSession,'huamao.session.PlayerInfoSession',_super);
	var __proto=PlayerInfoSession.prototype;
	__proto.clearScoreLogAry=function(){
		this.scorLogAry=[];
	}

	__proto.pushScorLog=function(data){
		this.scorLogAry.push(data);
	}

	__proto.getScorLogAry=function(){
		return this.scorLogAry;
	}

	__proto.checkJobBox=function(jobId){
		if(this.jobBoxList==null || this.jobBoxList.length==0)return false;
		var strary=this.jobBoxList.split(",");
		for(var i=0;i<strary.length;i++){
			var id=parseInt(strary[i]);
			if(id==jobId){
				return true;
			}
		}
		return false;
	}

	return PlayerInfoSession;
})(Session)


//class huamao.session.QiHuSession extends game.mvc.Session
var QiHuSession=(function(_super){
	function QiHuSession(){
		QiHuSession.__super.call(this);
		this.init();
	}

	__class(QiHuSession,'huamao.session.QiHuSession',_super);
	var __proto=QiHuSession.prototype;
	__proto.init=function(){
		if(Browser.onPC){
			App.setDevelopMode();
		}
		App.eventManager.on("SDK_INIT",this,this.initFun);
		App.eventManager.on("PAY",this,this.payFun);
	}

	__proto.payFun=function(payData){
		var http=new HttpRequest();
		var json={};
		json["action"]="QihuOrder";
		json["orderId"]=payData.cp_order_id;
		json["plat_user_id"]=QiHuSession.plat_user_id;
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",this,this.ChongZhiComFun);
	}

	__proto.ChongZhiComFun=function(str){
		var obj=JSON.parse(str);
		if(obj.code==0){
			Browser.window.aladdin.pay(obj.tid).then(function(result){
				var errno=parseInt(result.errno+"");
				if(errno==0){
					FlyUpTips.setTips("充值成功");
					}else{
					console.log(result.errmsg);
					FlyUpTips.setTips("充值失败");
				}
			})
			}else{
			console.log(str);
			FlyUpTips.setTips("充值失败");
		}
	}

	__proto.loginFun=function(){
		var _$this=this;
		Browser.window.aladdin.getUserInfo().then(function(userInfo){
			try {
				QiHuSession.plat_user_id=userInfo.plat_user_id;
				QiHuSession.sign=userInfo.sign;
				var http=new HttpRequest();
				var json={};
				json["action"]="QihuSign";
				json["content"]=QiHuSession.plat_user_id;
				http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
				http.once("complete",this,_$this.loginComFun);
			}catch(error){}
		});
	}

	//错误
	__proto.loginComFun=function(str){
		if(QiHuSession.sign==str){
			FlyUpTips.setTips("登录成功");
			App.eventManager.event("SET_SDK_ID",QiHuSession.plat_user_id);
			}else{
			console.log("后端返回的:"+str+"_____360返回的:"+QiHuSession.sign);
			FlyUpTips.setTips("登录失败");
			Laya.timer.once(2000,this,this.reloadFun);
		}
	}

	//alert.setAll(null,"登录失败,是否重新进入游戏?",new Handler(this,reloadFun));
	__proto.reloadFun=function(){
		App.reload();
	}

	__proto.initFun=function(){
		var data={};
		data.game_key="68c0ae99ad3d8abf346f7e9c50ef360f";
		Browser.window.aladdin.init(data);
		this.loginFun();
	}

	QiHuSession.plat_user_id=null;
	QiHuSession.sign=null;
	return QiHuSession;
})(Session)


//class huamao.session.QiYouSession extends game.mvc.Session
var QiYouSession=(function(_super){
	function QiYouSession(){
		this.sdkSession=null;
		this.mainPlayerSession=null;
		this.json=null;
		this.qiyouData=new QiYouData;
		QiYouSession.__super.call(this);
		this.init();
	}

	__class(QiYouSession,'huamao.session.QiYouSession',_super);
	var __proto=QiYouSession.prototype;
	__proto.init=function(){
		App.injOne(this);
		App.eventManager.on("SDK_INIT",this,this.initFun);
		App.eventManager.on("PAY",this,this.payFun);
	}

	__proto.initFun=function(){
		var url=Browser.window.location.href;
		var str=url.split("?")[1];
		var split=str.split("&");
		for (var i=0;i < split.length;i++){
			var str1=split[i];
			var split2=str1.split("=");
			this.qiyouData[ split2[0]]=split2[1];
		};
		var strr=this.sdkSession.sortKey(this.qiyouData);
		this.sdkSession.sendSign(strr,new Handler(this,this.loginFun));
	}

	__proto.loginFun=function(str){
		if(str==this.qiyouData.token){
			App.eventManager.event("SET_SDK_ID",this.qiyouData.username);
			}else{
			FlyUpTips.setTips("您的签名不对 无法登陆");
			App.eventManager.event("SIGN_ERROR");
		}
	}

	__proto.payFun=function(rechargeData){
		this.json={};
		this.json.username=this.qiyouData.username;
		this.json.productname=rechargeData.product_name;
		this.json.amount=rechargeData.product_price;
		this.json.roleid=this.mainPlayerSession.mainPlayerData.playerName;
		this.json.serverid="1";
		this.json.appid=60804;
		this.json.paytime=GameUtils.GetServerTime();
		this.json.attach="1";
		var strr=this.sdkSession.sortKey(this.json,false);
		this.sdkSession.sendSign(strr,new Handler(this,this.qianmingFun));
	}

	__proto.qianmingFun=function(str){
		this.json.token=str;
		var strr=this.sdkSession.sortKey(this.json,false)
		Browser.window.open("http://i.41188.com/pay/index?"+strr);
	}

	return QiYouSession;
})(Session)


//class huamao.session.QunHeiSdkSession extends game.mvc.Session
var QunHeiSdkSession=(function(_super){
	function QunHeiSdkSession(){
		QunHeiSdkSession.__super.call(this);
		if(Browser.onPC){
			App.setDevelopMode();
		}
		App.eventManager.on("SDK_INIT",this,this.initFun);
		App.eventManager.on("PAY",this,this.payFun);
		App.eventManager.on("DOT_CREAT_ROLE_SUC",this,this.createFun);
		App.eventManager.on("LOGIN_SUCCESS",this,this.loginFun);
	}

	__class(QunHeiSdkSession,'huamao.session.QunHeiSdkSession',_super);
	var __proto=QunHeiSdkSession.prototype;
	__proto.getSDK=function(){
		return Browser.window.qhsdk;
	}

	__proto.initFun=function(){
		var url=Browser.window.location.href;
		var str=url.split("?")[1];
		var split=str.split("&");
		for (var i=0;i < split.length;i++){
			var str1=split[i];
			var split2=str1.split("=");
			QunHeiSdkSession.qunHeiData[ split2[0]]=split2[1];
		};
		var initdata={
			"username":QunHeiSdkSession.qunHeiData.username,
			"gid":QunHeiSdkSession.GAME_ID,
			"qhchannel":QunHeiSdkSession.qunHeiData.qhchannel,
			"qhchannelid":QunHeiSdkSession.qunHeiData.qhchannelid,
			"time":QunHeiSdkSession.qunHeiData.time
		};
		this.getSDK().init(initdata);
		App.eventManager.event("SET_SDK_ID",QunHeiSdkSession.qunHeiData.username);
	}

	__proto.loginFun=function(data){
		this.createRole("2",data.playerName,data.playerId,data.Lv);
	}

	__proto.createFun=function(arr){
		this.createRole("1",arr[1],arr[0],1);
	}

	__proto.createRole=function(act,roleName,roleId,lv){
		QunHeiManager.roleName=roleName;
		QunHeiManager.roleId=roleId;
		var roledata={
			"act":"1",
			"serverid":QunHeiSdkSession.qunHeiData.serverid,
			"rolename":roleName,
			"roleid":roleId,
			"level":lv
		};
		this.getSDK().role(roledata);
	}

	__proto.payFun=function(rechargeData){
		var paydata={
			"userId":QunHeiSdkSession.qunHeiData.username,
			"gid":QunHeiSdkSession.GAME_ID,
			"roleName":QunHeiSdkSession.roleName,
			'goodsId':rechargeData.product_id,
			"goodsName":rechargeData.product_name,
			"money":rechargeData.product_price,
			"ext":rechargeData.cp_order_id,
			"serverId":QunHeiSdkSession.qunHeiData.serverid,
			"sign":""
		};
		this.getMd5(paydata);
	}

	__proto.getMd5=function(payData){
		var http=new HttpRequest();
		var json={};
		json["action"]="QunHeiSign";
		json["content"]=payData.money+payData.userId+payData.ext+"";
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",this,this.sendPay,[payData]);
	}

	__proto.sendPay=function(payData,md5){
		payData.sign=md5;
		this.getSDK().pay(payData,function(code,msg){
		});
	}

	QunHeiSdkSession.GAME_ID="4068";
	QunHeiSdkSession.roleName=null;
	QunHeiSdkSession.roleId=0;
	__static(QunHeiSdkSession,
	['qunHeiData',function(){return this.qunHeiData=new QunHeiData();}
	]);
	return QunHeiSdkSession;
})(Session)


//class huamao.session.RankSession extends game.mvc.Session
var RankSession=(function(_super){
	function RankSession(){
		this.mainPlayerSession=null;
		this.obj=new Object();
		this.myObj=new Object();
		RankSession.__super.call(this);
		App.injOne(this);
	}

	__class(RankSession,'huamao.session.RankSession',_super);
	var __proto=RankSession.prototype;
	__proto.resetListByType=function(type){
		this.obj[type]=[];
		this.myObj[type]=null;
	}

	__proto.getMyDataByType=function(type){
		return this.myObj[type];
	}

	__proto.getListByType=function(type){
		return this.obj[type];
	}

	__proto.addData=function(data){
		var arr=this.obj[data.type];
		arr.push(data);
		if(data.playerId==this.mainPlayerSession.mainPlayerData.playerId){
			this.myObj[data.type]=data;
		}
	}

	return RankSession;
})(Session)


//class huamao.session.RechargeSession extends game.mvc.Session
var RechargeSession=(function(_super){
	function RechargeSession(){
		this._rechargeStr=null;
		this._vipStr=null;
		this.rechargeObj=null;
		this.rechargeId=0;
		this.mainPlayerSession=null;
		this.vip=null;
		RechargeSession.__super.call(this);
		App.eventManager.on("CONFIG_OVER",this,this.init);
	}

	__class(RechargeSession,'huamao.session.RechargeSession',_super);
	var __proto=RechargeSession.prototype;
	__proto.init=function(){
		this.rechargeObj={};
		var arr=ConfigManager.getDataArr("sys_recharge_fytx.txt");
		for(var i=0;i<arr.length;i++){
			var data=arr [i];
			this.rechargeObj[data.rechargeId]=0;
		}
	}

	/**
	*根据类型 也就是ID获取vip是否购买 返回:[按钮状态，结束时间(秒)] 按钮状态:0未领取 1 已领取 空就是没有购买此会员
	*@return
	*
	*/
	__proto.getVip=function(id){
		return this.vip[id];
	}

	/**
	*
	*@param type 0购买元宝 1购买会员
	*@param id 充值id 或者会员id
	*@param orderId 订单ID
	*
	*/
	__proto.setRecharGeSdkJson=function(type,id,orderId){
		var sysr;
		var sys;
		var yuanbao=0;
		var qian=0;
		var data={};
		if(type==0){
			sysr=ConfigManager.getConfig("sys_recharge_fytx.txt",id);
			yuanbao=sysr.rechargeGold;
			qian=sysr.rechargeCost;
			data.product_name=yuanbao+"元宝";
			data.product_desc="购买"+yuanbao+"元宝";
		}
		else{
			sys=ConfigManager.getConfig("sys_member.txt",id);
			yuanbao=0;
			qian=sys.memberCost;
			data.product_name="VIP";
			data.product_desc="购买VIP";
		};
		var num=yuanbao/qian;
		data.yuanbao=yuanbao;
		data.cp_order_id=orderId;
		data.currency_name="元宝";
		data.exchange_rate=num;
		data.product_id=type+"_"+id;
		data.product_count="1";
		data.product_price=qian;
		data.ext=GameUtils.GetServerTime()+"";
		data.role_type=5;
		data.server_id="1";
		data.server_name="测试服";
		data.role_id=this.mainPlayerSession.mainPlayerData.playerId;
		data.role_name=this.mainPlayerSession.mainPlayerData.playerName;
		data.party_name="";
		data.role_level=this.mainPlayerSession.mainPlayerData.Lv;
		data.role_vip="0";
		data.role_balence=this.mainPlayerSession.mainPlayerData.gold;
		data.rolelevel_ctime=GameUtils.GetServerTime()+"";
		data.rolelevel_mtime=GameUtils.GetServerTime()+"";
		data.type=type;
		data.id=id;
		App.eventManager.event("PAY",data);
	}

	/**
	*@private
	*/
	/**充值 ID,购买次数*/
	__getset(0,__proto,'rechargeStr',function(){
		return this._rechargeStr;
		},function(value){
		this._rechargeStr=value;
		var arr=this._rechargeStr.split(",");
		for(var i=0;i<arr.length;i+=2){
			this.rechargeObj[arr[i]]=arr[i+1];
		}
	});

	/**
	*@private
	*/
	/**vip id，领取状态（1已领取0未领取），结束时间*/
	__getset(0,__proto,'vipStr',function(){
		return this._vipStr;
		},function(value){
		this._vipStr=value;
		this.vip={};
		this.mainPlayerSession.mainPlayerData.vipId=[];
		var arr=this._vipStr.split(",");
		for(var i=0;i<arr.length;i+=3){
			this.vip[arr[i]]=[arr[i+1],arr[i+2]];
			this.mainPlayerSession.mainPlayerData.vipId.push(arr[i]);
		}
	});

	RechargeSession.VIP1=1;
	RechargeSession.VIP2=2;
	return RechargeSession;
})(Session)


//class huamao.session.RedPoingSession extends game.mvc.Session
var RedPoingSession=(function(_super){
	function RedPoingSession(){
		this.redList={};
		RedPoingSession.__super.call(this);
		App.eventManager.on("REAPOINT",this,this.execute);App.eventManager.event("REAPOINT",RedPointType.ZHAOMU);
		App.eventManager.on("BAG_ITEM_FLUSH",this,this.zhaoMu);
	}

	__class(RedPoingSession,'huamao.session.RedPoingSession',_super);
	var __proto=RedPoingSession.prototype;
	/**
	*注册小红点
	*@param sp
	*
	*/
	__proto.setRed=function(sp){
		this.redList[sp.type]=sp;
		this.execute(sp.type);
	}

	/**
	*获取小红点
	*@param type
	*@return
	*
	*/
	__proto.getRed=function(type){
		var sp=this.redList[type];
		return sp;
	}

	__proto.deleteRed=function(type){
		delete this.redList[type];
	}

	__proto.execute=function(type){
		switch(type){
			case RedPointType.ZHAOMU:
				this.zhaoMu();
				break ;
			case RedPointType.HAOYIN:
				this.zhaoMu();
				break ;
			case RedPointType.JICE:
				this.jiCe();
				break ;
			case RedPointType.JIFEN:
				this.xinXi();
				break ;
			case RedPointType.MEIR:
				this.xinXi();
				break ;
			case RedPointType.MEIYUE:
				this.xinXi();
				break ;
			case RedPointType.GRXX:
				this.xinXi();
				break ;
			case RedPointType.GUANZHI:
				this.xinXi();
				break ;
			case RedPointType.HAOYOU:
				this.haoYou();
				break ;
			case RedPointType.ZUIJIN:
				this.haoYou();
				break ;
			case RedPointType.PENGYOU:
				this.haoYou();
				break ;
			case RedPointType.YOUJIAN:
				this.haoYou();
				break ;
			case RedPointType.ZHANBAO:
				this.haoYou();
				break ;
			case RedPointType.WEIDU:
				this.haoYou();
				break ;
			case RedPointType.SHENQING:
				this.haoYou();
				break ;
			case RedPointType.HUODONG:
				this.huodong();
				break ;
			case RedPointType.LIANXU:
				this.huodong();
				break ;
			case RedPointType.XINSHOUQITIAN:
				this.huodong();
				break ;
			case RedPointType.MEIHZOUHUOYUE:
				this.huodong();
				break ;
			case RedPointType.CHENGZHANG:
				this.huodong();
				break ;
			case RedPointType.RENWU:
				this.huodong();
				break ;
			case RedPointType.LEIJI:
				this.huodong();
				break ;
			}
	}

	__proto.huodong=function(){
		var boo=false;
		var signInSession=App.getSession("signInSession");
		var arr=SysActivity.getSigninData(signInSession.curMonth==1 ? 0 :999);
		var red=this.getRed(RedPointType.LIANXU);
		if(red)red.visible=false;
		for(var i=0;i<arr.length;i++){
			var sys=arr [i];
			var _index=sys.subNumber-1;
			if(_index <=signInSession.curMonthDays){
				if(signInSession.isSignin(_index)==false){
					boo=true;
					if(red)red.visible=true;
					break ;
				}
			}
		};
		var sevenrenwuSession=App.getSession("sevenrenwuSession");
		arr=sevenrenwuSession.dataRenwu;
		red=this.getRed(RedPointType.XINSHOUQITIAN);
		if(red)red.visible=false;
		for(i=0;i<arr.length;i++){
			var data=arr [i];
			if(data){
				data.isGetPrograss(i);
				if(data.btnDis==false && data.isLing==0){
					boo=true;
					if(red)red.visible=true;
					break ;
				}
			}
		};
		var activitySession=App.getSession("activitySession");
		arr=activitySession.leijiDataArr;
		red=this.getRed(RedPointType.LEIJI);
		if(red)red.visible=false;
		for(i=0;i<arr.length;i++){
			var sysa=arr [i];
			var activityData=activitySession.ativityObj[sysa.activityId];
			if(activityData && activityData.rewardStatus==1){
				boo=true;
				if(red)red.visible=true;
				break ;
			}
		}
		arr=activitySession.jijinDataArr;
		red=this.getRed(RedPointType.CHENGZHANG);
		if(red)red.visible=false;
		for(i=0;i<arr.length;i++){
			sysa=arr [i];
			activityData=activitySession.ativityObj[sysa.activityId];
			if(activityData && activityData.rewardStatus==1){
				boo=true;
				if(red)red.visible=true;
				break ;
			}
		};
		var huoyueDaySession=App.getSession("huoyueDaySession");
		arr=huoyueDaySession.arrData;
		red=this.getRed(RedPointType.RIHUOYUE);
		if(red)red.visible=false;
		for(i=0;i<arr.length;i++){
			var hydayData=arr [i];
			if(hydayData && hydayData.isOk==1&&hydayData.getStatus==0){
				boo=true;
				if(red)red.visible=true;
				break ;
			}
		};
		var huoyueSession=App.getSession("huoyueSession");
		arr=huoyueSession.arrData;
		red=this.getRed(RedPointType.MEIHZOUHUOYUE);
		if(red)red.visible=false;
		for(i=0;i<arr.length;i++){
			var task=arr [i];
			if(task && task.status==1 && task.isOk==1){
				boo=true;
				if(red)red.visible=true;
				break ;
			}
		}
		arr=activitySession.leijiNewDataArr;
		red=this.getRed(RedPointType.NEWLEIJI);
		if(red)red.visible=false;
		for(i=0;i<arr.length;i++){
			sysa=arr [i];
			activityData=activitySession.ativityObj[sysa.activityId];
			if(activityData && activityData.rewardStatus==1){
				boo=true;
				if(red)red.visible=true;
				break ;
			}
		};
		var duoBaoSession=App.getSession("duoBaoSession");
		var dataArr=duoBaoSession.duoBaoData[0];
		red=this.getRed(RedPointType.DUOBAO);
		if(red)red.visible=false;
		if(dataArr && dataArr.freeJuan==0){
			boo=true;
			if(red)red.visible=true;
		}
		App.eventManager.event("HUO_DONG_NOT_READ",boo);
	}

	__proto.haoYou=function(){
		var session=App.getSession("mailSession");
		var arr=session.getMailArr();
		var redYj=this.getRed(RedPointType.YOUJIAN);
		var boo=false;
		if(redYj)redYj.visible=false;
		if(!session.IsRedServer){
			for(var i=0;i<arr.length;i++){
				var data=arr[i];
				if(data.itemArr.length>0){
					if(data.isRead!=2){
						if(redYj)redYj.visible=true;
						boo=true;
						break ;
					}
					}else{
					if(data.isRead!=1 && data.mailType!=MailType.ZHANBAO){
						if(redYj)redYj.visible=true;
						boo=true;
						break ;
					}
				}
			}
			}else{
			if(redYj)redYj.visible=true;
			boo=true;
		};
		var redZb=this.getRed(RedPointType.ZHANBAO);
		if(redZb)redZb.visible=false;
		if(!session.IsZhanBaoRedServer){
			arr=session.getBattleArr();
			for(i=0;i<arr.length;i++){
				var datab=arr[i];
				if(datab.isRead!=1){
					if(redZb)redZb.visible=true;
					if(redYj)redYj.visible=true;
					boo=true;
					break ;
				}
			}
		}
		else{
			if(redZb)redZb.visible=true;
			if(redYj)redYj.visible=true;
			boo=true;
		};
		var friendSession=App.getSession("friendSession");
		var arrF=friendSession.getList(0);
		var redZj=this.getRed(RedPointType.ZUIJIN);
		var redPy=this.getRed(RedPointType.PENGYOU);
		if(redZj)redZj.visible=false;
		if(redPy)redPy.visible=false;
		for(i=0;i<arrF.length;i++){
			var fData=arrF[i];
			if(friendSession.getRed(fData.friendId)){
				if(redZj)redZj.visible=true;
				boo=true;
				if(fData.checkState(2)){
					if(redPy)redPy.visible=true;
					break ;
				}
			}
		}
		for(i=0;i<arrF.length;i++){
			var dataf=arrF[i];
			var isApply=dataf.checkState(4);
			var isInvite=dataf.checkState(16);
			if(isApply){
				boo=true;
				if(redZj)redZj.visible=true;
			}
			else if(isInvite){
				if(redZj)redZj.visible=true;
				if(redPy)redPy.visible=true;
				boo=true;
			}
		};
		var red=this.getRed(RedPointType.HAOYOU);
		if(boo==true){
			if(red)red.visible=true;
		}
		else{
			if(red)red.visible=false;
		}
	}

	__proto.xinXi=function(){
		var mainPlayerSession=App.getSession("mainPlayerSession");
		var session=App.getSession("playerInfoSession");
		var boo=false;
		var redjili=this.getRed(RedPointType.JIFEN);
		if(session.jifen==true){
			if(redjili)redjili.visible=true;
			boo=true;
		}
		else{
			if(redjili)redjili.visible=false;
		};
		var redmr=this.getRed(RedPointType.MEIR);
		var job=mainPlayerSession.mainPlayerData.job;
		var sysTitlePlayer=ConfigManager.getConfig("sys_title_player.txt",job);
		var str=sysTitlePlayer.titleBonusStrategyPack;
		if(session.daySalary==0 && str!="0"){
			boo=true;
			if(redmr)redmr.visible=true;
		}
		else{
			if(redmr)redmr.visible=false;
		};
		var dropId=sysTitlePlayer.titleSalary;
		var dropAry=[];
		var monthSalary=session.monthSalary;
		var monthGameSize=session.monthGameSize;
		var systimetake=ConfigManager.getConfig("sys_timetake.txt",43);
		var maxTimes=systimetake.timeCd;
		var redmy=this.getRed(RedPointType.MEIYUE);
		if(redmy)redmy.visible=false;
		if(dropId !=0){
			var sysdrop=ConfigManager.getConfig("sys_drop.txt",dropId);
			dropAry=sysdrop.getDropList();
		};
		var droplen=dropAry.length;
		if(droplen > 0){
			if(monthGameSize >=maxTimes){
				if(monthSalary==0){
					boo=true;
					if(redmy)redmy.visible=true;
					}else{
					if(redmy)redmy.visible=false;
				}
				}else{
				if(redmy)redmy.visible=false;
			}
		};
		var redGz=this.getRed(RedPointType.GUANZHI);
		if(redGz)redGz.visible=false;
		var myjobid=mainPlayerSession.mainPlayerData.job;
		for(var i=1001;i<=myjobid;i++){
			var systitleplayer=ConfigManager.getConfig("sys_title_player.txt",i);
			if(systitleplayer.titlePackage > 0){
				if(!session.checkJobBox(i)){
					if(redGz)redGz.visible=true;
					boo=true;
					break ;
				}
			}
		};
		var red=this.getRed(RedPointType.GRXX);
		if(boo==true){
			if(red)red.visible=true;
		}
		else{
			if(red)red.visible=false;
		}
	}

	__proto.jiCe=function(){
		var session=App.getSession("stratagemSession");
		var boo=false;
		if(session.getStratagemOrder()>=80){
			boo=true;
		};
		var red=this.getRed(RedPointType.JICE);
		if(red)red.visible=boo;
	}

	__proto.zhaoMu=function(){
		var session=App.getSession("zhaoMuSession");
		var serverS=GameUtils.GetServerTime();
		var ft=session.freeTime-serverS;
		var red=this.getRed(RedPointType.ZHAOMU);
		if(red)red.visible=false;
		var red1=this.getRed(RedPointType.HAOYIN);
		if(red1)red1.visible=false;
		var boo=false;
		if(ft<=0){
			if(red1)red1.visible=true;
			boo=true;
		};
		var bagSession=App.getSession("bagSession");
		var num=bagSession.getItemNumByItemId(7001);
		if(num>0){
			boo=true;
		}
		if(boo){
			if(red)red.visible=true;
		}
	}

	return RedPoingSession;
})(Session)


/**
*统一管理所有sdk 如果有特殊需求写这里
*@author chengxu03
*/
//class huamao.session.SdkSession extends game.mvc.Session
var SdkSession=(function(_super){
	function SdkSession(){
		this.sdkMap={};
		SdkSession.__super.call(this);
		this.reg("1001",WebTestSession);
		this.reg("1002",FlyGameSDKSession);
		this.reg("1003",FaceBookSdkSession);
		this.reg("1004",QunHeiSdkSession);
		this.reg("1005",XuYangSession);
		this.reg("1007",SiSanJiuJiuSession);
		this.reg("1006",QiHuSession);
		this.reg("1008",WanH5Session);
		this.reg("1009",QiYouSession);
		this.reg("1010",LingQiSession);
		Laya.timer.callLater(this,this.initFun);
	}

	__class(SdkSession,'huamao.session.SdkSession',_super);
	var __proto=SdkSession.prototype;
	//config一定在这前面 所以监听事件不管用 这时其他session还没初始化完呢 下面发的事件 人家接不到
	__proto.initFun=function(){
		var plat=App.configJson["platformId"];
		var sdkClass=this.sdkMap[plat];
		if(sdkClass==null){
			return;
		}
		App.regSession(sdkClass);
		App.eventManager.event("SDK_INIT");
	}

	__proto.reg=function(id,session){
		this.sdkMap[id]=session;
	}

	__proto.canPayFun=function(){
		return (Browser.window.canPay==1);
	}

	__proto.checkFBPay=function(){
		if(MyGameInit.isFaceBook()){
			var payPanel;
			if(FaceBookManager.getPlatform()=="IOS"){
				payPanel=App.dialogManager.showMiniDialog(PayInfoPanel);
				payPanel.setInfo(3);
				payPanel.show();
				return false;
			}
			if(this.canPayFun()==false){
				App.eventManager.event("NO_PAY_API");
				payPanel=App.dialogManager.showMiniDialog(PayInfoPanel);
				payPanel.setInfo(1);
				payPanel.show();
				return false;
			}
		}
		return true;
	}

	/**获取签名*/
	__proto.sendSign=function(str,fun){
		var http=new HttpRequest();
		var json={};
		json["action"]="Md5Sign";
		json["content"]=str;
		json["platformId"]=App.configJson["platformId"];
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",fun.caller,fun.method);
	}

	__proto.sortKey=function(obj,boo){
		(boo===void 0)&& (boo=true);
		var str="";
		var arr=[];
		for(var key in obj){
			arr.push(key);
		}
		if(boo){
			arr.sort();
		}
		for(var i=0;i<arr.length;i++){
			var keys=arr[i];
			var value=obj[keys];
			if(keys=="sign" || keys=="sign_type" || value==null || value===""){
				continue ;
			}
			str+=arr[i]+"="+obj[arr[i]]+"&";
		}
		str=str.substr(0,str.length-1);
		return str;
	}

	return SdkSession;
})(Session)


//class huamao.session.SensitiveSession extends game.mvc.Session
var SensitiveSession=(function(_super){
	function SensitiveSession(){
		this.wordsVec=new Array;
		this.testFilter=new WordFilter;
		SensitiveSession.__super.call(this);
		App.eventManager.on("CONFIG_OVER",this,this.init);
	}

	__class(SensitiveSession,'huamao.session.SensitiveSession',_super);
	var __proto=SensitiveSession.prototype;
	__proto.init=function(){
		this.setSensitive(GameUtils.PINGBI);
	}

	__proto.setSensitive=function(txt){
		var arr=txt.split("|");
		arr.sort(this.onSort);
		var str;
		for(var $each_str in arr){
			str=arr[$each_str];
			this.wordsVec.push(str);
		}
		this.testFilter.regSensitiveWords(this.wordsVec);
	}

	__proto.onSort=function(a,b){
		if(a.length > b.length){
			return 1;
			}else {
			return-1;
		}
	}

	__proto.getSensitiveWord=function(str){
		return this.testFilter.findSensitiveWordsIn(str);
	}

	/**
	*是否可通过敏感字检测
	*@return false:有敏感字 true:没有敏感字
	*/
	__proto.IsSensitiveWord=function(str){
		return this.testFilter.IsSensitiveWord(str);
	}

	return SensitiveSession;
})(Session)


//class huamao.session.SettingSession extends game.mvc.Session
var SettingSession=(function(_super){
	function SettingSession(){
		this.settingValue=null;
		this.arr=[0,1,2,3,4];
		this.talkkey=[0,1,2,3,4,5,6,7];
		this.talkSetting=null;
		this.obj=new Object();
		this.talkObj=new Object();
		SettingSession.__super.call(this);
	}

	__class(SettingSession,'huamao.session.SettingSession',_super);
	var __proto=SettingSession.prototype;
	__proto.setValue=function(str){
		this.settingValue=str;
		console.log("设置参数==========="+str);
		for(var i=0;i < this.arr.length;i++){
			var key=this.arr[i];
			var value=parseInt(str.charAt(key));
			this.obj[key]=value;
		}
		App.eventManager.event("SETTING_INIT");
	}

	__proto.isOpenByKey=function(key){
		var value=this.obj[key];
		return value==0;
	}

	__proto.getValueByKey=function(key){
		return this.obj[key];
	}

	__proto.setValueByType=function(key,value){
		this.obj[key]=value;
		App.eventManager.event("UPDATE_SETTING",key);
	}

	__proto.getValue=function(){
		var str="";
		var vv;
		for(var $each_vv in this.obj){
			vv=this.obj[$each_vv];
			str+=vv;
		}
		return str;
	}

	__proto.setTalkSetting=function(param0){
		this.talkObj
		this.talkSetting=param0;
		for(var i=0;i < this.talkkey.length;i++){
			var key=this.talkkey[i];
			var value=parseInt(param0.charAt(key));
			this.talkObj[key]=value;
		}
		this.resetSetting();
	}

	__proto.resetSetting=function(){
		TipsTalkSet.VIEW=this.getTalkSetting(0);
		TipsTalkSet.PINDAO_SHIJIE=(this.getTalkSetting(1)==1)? true:false;
		TipsTalkSet.PINDAO_DANGQIAN=(this.getTalkSetting(2)==1)? true:false;
		TipsTalkSet.PINDAO_XITONG=(this.getTalkSetting(4)==1)? true:false;
		TipsTalkSet.PINDAO_DUIWU=(this.getTalkSetting(3)==1)? true:false;
		TipsTalkSet.PINDAO_GUOJIA=(this.getTalkSetting(5)==1)? true:false;
		TipsTalkSet.PINDAO_LIANMENG=(this.getTalkSetting(6)==1)? true:false;
		TipsTalkSet.QIPAO=this.getTalkSetting(7);
	}

	__proto.getTalkSetting=function(key){
		return this.talkObj[key];
	}

	SettingSession.yinxiao=0;
	SettingSession.yinyue=1;
	SettingSession.tuisong=2;
	SettingSession.yunwu=3;
	SettingSession.gonggao=4;
	SettingSession.view=0;
	SettingSession.shijie=1;
	SettingSession.dangqian=2;
	SettingSession.duiwu=3;
	SettingSession.xitong=4;
	SettingSession.guojia=5;
	SettingSession.lianmeng=6;
	SettingSession.qipao=7;
	return SettingSession;
})(Session)


//class huamao.session.SevenrenwuSession extends game.mvc.Session
var SevenrenwuSession=(function(_super){
	function SevenrenwuSession(){
		this.overDay=0;
		this.actDay=0;
		this.dataRenwu=[];
		this.actDayArr=[true,true,true,true,true,true,true];
		//是否显示7天任务
		this.isSevenXian=false;
		SevenrenwuSession.__super.call(this);
	}

	__class(SevenrenwuSession,'huamao.session.SevenrenwuSession',_super);
	return SevenrenwuSession;
})(Session)


//class huamao.session.ShopSession extends game.mvc.Session
var ShopSession=(function(_super){
	function ShopSession(){
		this._intimacyNum=0;
		//当前亲密度值
		this._intimacyLv=0;
		this._ramFlushTimes=0;
		this._shopCd=NaN;
		//商店倒计时 （秒）
		this.shopAction=null;
		this._itemAry=new Array(0,0,0,0,0,0);
		ShopSession.__super.call(this);
		App.injOne(this);
		App.eventManager.on("LOGOUT_SDK",this,this.logoutCB);
	}

	__class(ShopSession,'huamao.session.ShopSession',_super);
	var __proto=ShopSession.prototype;
	__proto.logoutCB=function(){
		this.shopAction.ifFist=false;
	}

	__proto.getIntimacyNum=function(){
		return this._intimacyNum;
	}

	__proto.getIntimacyLv=function(){
		return this._intimacyLv;
	}

	__proto.getItemAry=function(){
		return this._itemAry;
	}

	__proto.getShopCD=function(){
		return this._shopCd;
	}

	//刷新商店检测特殊物品，返回特殊物品的序列
	__proto.getSpecialIndexAry=function(){
		var ary=[];
		var count=0;
		for(var i=0;i<3;i++){
			var itemid=this._itemAry[i*2];
			var stata=this._itemAry[i*2+1];
			var sys_item=ConfigManager.getConfig("sys_item.txt",itemid);
			var color=sys_item.itemColor;
			var sysshop=ConfigManager.getConfig("sys_shop.txt",itemid);
			var buyType=sysshop.getPriceType();
			if((color >=MyGameConst.COLOR_PURPLE || buyType==MyGameConst.GOLD_ID)&& stata==0){
				ary[count++]=i;
			}
		}
		return ary;
	}

	__proto.setIntimacy=function(intimacyLv,intimacyNum){
		this._intimacyNum=intimacyNum;
		this._intimacyLv=intimacyLv;
		App.eventManager.event("SHOP_INTIMACY");
	}

	__proto.setItemAndStata=function(itemid1,itemStata1,itemid2,itemStata2,itemid3,itemStata3,times){
		var result=true;
		if(this._itemAry[0]==itemid1 && this._itemAry[2]==itemid2 && this._itemAry[4]==itemid3){
			result=false;
		}
		this._itemAry[0]=itemid1;
		this._itemAry[1]=itemStata1;
		this._itemAry[2]=itemid2;
		this._itemAry[3]=itemStata2;
		this._itemAry[4]=itemid3;
		this._itemAry[5]=itemStata3;
		this._ramFlushTimes=times;
		App.eventManager.event("SHOP_ITEM");
		return result;
	}

	__proto.setShopCd=function(shopcd){
		this._shopCd=shopcd;
		App.eventManager.event("SHOP_CD");
	}

	return ShopSession;
})(Session)


//class huamao.session.ShouFenSession extends game.mvc.Session
var ShouFenSession=(function(_super){
	function ShouFenSession(){
		this.dataObj=new Object();
		ShouFenSession.__super.call(this);
	}

	__class(ShouFenSession,'huamao.session.ShouFenSession',_super);
	var __proto=ShouFenSession.prototype;
	__proto.getIsHas=function(battleId){
		return this.dataObj.hasOwnProperty(battleId);
	}

	__proto.getDataList=function(){
		var arr=[]
		var data;
		for(var $each_data in this.dataObj){
			data=this.dataObj[$each_data];
			arr.push(data);
		}
		arr.sort(function(a,b){
			return a.dateTime-b.dateTime;
		});
		return arr;
	}

	return ShouFenSession;
})(Session)


//class huamao.session.SignInSession extends game.mvc.Session
var SignInSession=(function(_super){
	function SignInSession(){
		this.totalDays=0;
		this.curMonth=0;
		this.curMonthDays=0;
		this.rewardState=null;
		SignInSession.__super.call(this);
	}

	__class(SignInSession,'huamao.session.SignInSession',_super);
	var __proto=SignInSession.prototype;
	__proto.isSignin=function(index){
		if(this.rewardState){
			return this.rewardState.charAt(index)=="1";
			}else{
			return true;
		}
	}

	return SignInSession;
})(Session)


//class huamao.session.SiSanJiuJiuSession extends game.mvc.Session
var SiSanJiuJiuSession=(function(_super){
	function SiSanJiuJiuSession(){
		//https://cdn.h5wan.4399sj.com/h5web-frame/dist/static/js/api.js 这个是sdk地址
		this.sdkSession=null;
		this.sisanData=new SiSanData();
		SiSanJiuJiuSession.__super.call(this);
		this.init();
	}

	__class(SiSanJiuJiuSession,'huamao.session.SiSanJiuJiuSession',_super);
	var __proto=SiSanJiuJiuSession.prototype;
	__proto.init=function(){
		App.injOne(this);
		App.eventManager.on("SDK_INIT",this,this.initFun);
		App.eventManager.on("PAY",this,this.payFun);
	}

	__proto.payFun=function(rechargeData){
		Browser.window.H5API.openPay(rechargeData.product_price,rechargeData.cp_order_id,1,"");
	}

	__proto.initFun=function(){
		var url=Browser.window.location.href;
		var str=url.split("?")[1];
		var split=str.split("&");
		console.log("wohahahahahahah!!!!!!!!!"+str);
		for (var i=0;i < split.length;i++){
			var str1=split[i];
			var split2=str1.split("=");
			this.sisanData[ split2[0]]=split2[1];
		};
		var strr="gameId="+this.sisanData.gameId+"time="+this.sisanData.time+"userId="+this.sisanData.userId+"userName="+this.sisanData.userName;
		console.log("wohahahahahahha"+this.sisanData);
		this.sdkSession.sendSign(strr,new Handler(this,this.loginFun));
	}

	__proto.loginFun=function(str){
		if(str==this.sisanData.sign){
			App.eventManager.event("SET_SDK_ID",this.sisanData.userId);
			}else{
			FlyUpTips.setTips("您的签名不对 无法登陆");
			App.eventManager.event("SIGN_ERROR");
		}
	}

	return SiSanJiuJiuSession;
})(Session)


//class huamao.session.SoundSession extends game.mvc.Session
var SoundSession=(function(_super){
	function SoundSession(){
		this.settingSession=null;
		SoundSession.__super.call(this);
		App.injOne(this);
		App.eventManager.on("UPDATE_SETTING",this,this.updateFun);
		App.eventManager.on("SETTING_INIT",this,this.initFun);
	}

	__class(SoundSession,'huamao.session.SoundSession',_super);
	var __proto=SoundSession.prototype;
	__proto.initFun=function(){
		this.updateFun(0);
		this.updateFun(1);
	}

	__proto.updateFun=function(key){
		var value=this.settingSession.getValueByKey(key);
		value=((value==0)?1:0);
		if(key==0){
			App.voiceManager.setSound(value);
			}else if(key==1){
			App.voiceManager.setMusic(value);
		}
	}

	return SoundSession;
})(Session)


//class huamao.session.StratagemSession extends game.mvc.Session
var StratagemSession=(function(_super){
	function StratagemSession(){
		this._stratagemCd=NaN;
		this._stratagemOrder=NaN;
		StratagemSession.__super.call(this);
	}

	__class(StratagemSession,'huamao.session.StratagemSession',_super);
	var __proto=StratagemSession.prototype;
	__proto.setStratagemCd=function(number){
		this._stratagemCd=number;
		console.log("_stratagemCd = "+this._stratagemCd);
		App.eventManager.event("STRATAGEM_CD");
	}

	__proto.getStratagemCd=function(){
		return this._stratagemCd;
	}

	__proto.setStratagemOrder=function(number){
		this._stratagemOrder=number;
		App.eventManager.event("STRATAGEM_ORDER");
	}

	__proto.getStratagemOrder=function(){
		return this._stratagemOrder;
	}

	return StratagemSession;
})(Session)


//class huamao.session.TalkSession extends game.mvc.Session
var TalkSession=(function(_super){
	function TalkSession(){
		//最大数量
		this.aryCurrent=[];
		this.aryWord=[];
		this.aryTeam=[];
		this.aryColeage=[];
		this.friendSession=null;
		this.arySys=[];
		TalkSession.__super.call(this);
		App.injOne(this);
	}

	__class(TalkSession,'huamao.session.TalkSession',_super);
	var __proto=TalkSession.prototype;
	__proto.addStalk=function(data){
		if(this.arySys.length > TalkSession.MAXSIZE){
			this.arySys.shift();
		}
		this.arySys.push(data);
		App.eventManager.event("TALK_FLUSH_SYS");
	}

	//是否在好友黑名单里
	__proto.ifNotInBlackList=function(playerid){
		var ary=this.friendSession.getList(2);
		for(var i=0;i<ary.length;i++){
			var frienddata=ary [i];
			if(frienddata.friendId==playerid){
				return true;
			}
		}
		return false;
	}

	__proto.addATalk=function(data){
		var channel=data.channelId;
		if(!this.ifNotInBlackList(data.playerid)){
			switch(channel){
				case 1:
					this.putToCurrent(data);
					break ;
				case 2:
					this.putToWordAry(data);
					break ;
				case 3:
					break ;
				case 4:
					this.putToTeamAry(data);
					break ;
				case 5:
					this.putToColeageAry(data);
					break ;
				}
		}
	}

	__proto.putToCurrent=function(data){
		if(this.aryCurrent.length >=TalkSession.MAXSIZE){
			this.aryCurrent.shift();
		}
		this.aryCurrent.push(data);
		App.eventManager.event("TALK_FLUSH_CURRENT");
	}

	__proto.putToWordAry=function(data){
		if(this.aryWord.length >=TalkSession.MAXSIZE){
			this.aryWord.shift();
		}
		this.aryWord.push(data);
		App.eventManager.event("TALK_FLUSH_WORD");
	}

	__proto.putToTeamAry=function(data){
		if(this.aryTeam.length >=TalkSession.MAXSIZE){
			this.aryTeam.shift();
		}
		this.aryTeam.push(data);
		App.eventManager.event("TALK_FLUSH_TEAM");
	}

	__proto.putToColeageAry=function(data){
		if(this.aryColeage.length >=TalkSession.MAXSIZE){
			this.aryColeage.shift();
		}
		this.aryColeage.push(data);
		App.eventManager.event("TALK_FLUSH_COLEAGE");
	}

	TalkSession.MAXSIZE=50;
	return TalkSession;
})(Session)


//class huamao.session.TaskSession extends game.mvc.Session
var TaskSession=(function(_super){
	function TaskSession(){
		this.typeHonour=null;
		this.typeKing=null;
		/**已经完成的任务*/
		this.typeNewplayer=null;
		/**未完成的任务*/
		this.typeNewplayerNo=null;
		/**成长任务*/
		this.gNewplayer=null;
		TaskSession.__super.call(this);
		this.typeHonour=new TaskData();
		this.typeHonour.type=100;
		this.typeKing=new TaskData();
		this.typeKing.type=101;
	}

	__class(TaskSession,'huamao.session.TaskSession',_super);
	return TaskSession;
})(Session)


//class huamao.session.UnionSession extends game.mvc.Session
var UnionSession=(function(_super){
	function UnionSession(){
		this.titleTxt={1:"初级建设",2:"中级建设",3:"高级建设"};
		/**职务 0 成员 8副盟主 9主盟主 */
		this.zhiWu=0;
		/**联盟ID */
		this.unionId=0;
		/**退盟时间点 秒 */
		this.endTime=0;
		/**当日活跃度*/
		this.currhuoyue=0;
		/**总活跃度 */
		this.maxhuoyue=0;
		/**帮贡*/
		this.feat=0;
		/**进盟时间点 秒 */
		this.joinTime=0;
		this._buildTimes=null;
		this._shoptimes=null;
		/**申请联盟数*/
		this.appLyNum=0;
		/**联盟名称*/
		this.unionName=null;
		/**联盟等级*/
		this.unionLv=0;
		/**联盟经验值*/
		this.unionExp=0;
		/**联盟旗帜*/
		this.unionBanner=0;
		/**联盟公告*/
		this.unionNotice=null;
		/**联盟盟主ID*/
		this.unionMengzhuId=0;
		/**盟主名字*/
		this.unionMengZhuName=null;
		/**联盟成员数*/
		this.unionPlayerNum=0;
		/**联盟创建时间*/
		this.nameUnionTime=0;
		/**联盟在线人数*/
		this.unionOnLineNum=0;
		/**联盟列表 只有当前页*/
		this.currArr=[];
		/**本页第一条数据下标是多少*/
		this.index=0;
		/**一共有多少个联盟*/
		this.maxNum=0;
		/**申请过的联盟ID列表*/
		this.applyList={};
		this.zhiwuObj={0:"成员",8:"副盟主",9:"盟主"};
		this.shenQingList=[];
		/**搜索列表*/
		this.souSuoList=[];
		this.qizhiList=[1,2,3,4,5,6];
		this.seleQizhi=1;
		this.dongtaiArr=[];
		this.shopObj={};
		this.buildObj={};
		this.playerList={};
		UnionSession.__super.call(this);
		App.eventManager.on("CHUANGJIANCOM",this,this.upData);
		App.eventManager.on("SHENQINGTONGGUO",this,this.closePanel);
		App.eventManager.on("DISSOLVE",this,this.upData);
		App.eventManager.on("TUICHUCHENGGONG",this,this.upData);
		App.eventManager.on("GUANBILIANMENG",this,this.closePanel);
	}

	__class(UnionSession,'huamao.session.UnionSession',_super);
	var __proto=UnionSession.prototype;
	/**是否有联盟*/
	__proto.isUnion=function(){
		return this.unionId>0 ? true :false;
	}

	__proto.closePanel=function(){
		App.dialogManager.closeDialogByStr("NEWUNIONPANEL");
		App.dialogManager.closeDialogByStr("UNIONPANEL");
	}

	__proto.deleteShenQing=function(id){
		for(var i=0;i<this.shenQingList.length;i++){
			if(this.shenQingList[i].playerId==id){
				this.shenQingList.splice(i,1);
			}
		}
	}

	__proto.clearplayerList=function(){
		this.playerList={};
	}

	__proto.addPlayer=function(data){
		this.playerList[data.playerId]=data;
	}

	__proto.deletePlayer=function(id){
		delete this.playerList[id];
	}

	__proto.getPlayerList=function(line){
		var arr=[];
		var data;
		for(var $each_data in this.playerList){
			data=this.playerList[$each_data];
			if(line==true){
				if(data.getLine()==1){
					arr.push(data);
				}
				}else{
				arr.push(data);
			}
		}
		arr.sort(UnionSession.sortGongxian);
		arr.sort(UnionSession.sortScore);
		arr.sort(UnionSession.sortLv);
		arr.sort(UnionSession.sortZhiwu);
		arr.sort(UnionSession.sortLine);
		return arr;
	}

	__proto.upData=function(){
		this.openUnion();
	}

	__proto.addApplyId=function(id){
		this.applyList[id]=1;
	}

	__proto.getApplyId=function(id){
		return this.applyList[id];
	}

	__proto.deleteApplyId=function(id){
		delete this.applyList[id];
	}

	__proto.clearApply=function(){
		this.applyList={};
	}

	__proto.openUnion=function(){
		this.closePanel();
		if(this.unionId>0){
			App.dialogManager.openDialogByStr("UNIONPANEL",null,true,true);
			}else{
			App.dialogManager.openDialogByStr("NEWUNIONPANEL",null,true,true);
		}
	}

	/**
	*@private
	*/
	/**商品ID，购买次数*/
	__getset(0,__proto,'shoptimes',function(){
		return this._shoptimes;
		},function(value){
		this.shopObj={};
		this._shoptimes=value;
		var arr=this._shoptimes.split(",");
		for(var i=0;i<arr.length;i+=2){
			this.shopObj[arr[i]]=arr[i+1];
		}
	});

	/**
	*@private
	*/
	/**建设ID，建设次数 */
	__getset(0,__proto,'buildTimes',function(){
		return this._buildTimes;
		},function(value){
		this.buildObj={};
		this._buildTimes=value;
		var arr=this._buildTimes.split(",");
		for(var i=0;i<arr.length;i+=2){
			this.buildObj[arr[i]]=arr[i+1];
		}
	});

	UnionSession.sortGongxian=function(a,b){
		return b.dayScore-a.dayScore;
	}

	UnionSession.sortScore=function(a,b){
		return b.allScore-a.allScore;
	}

	UnionSession.sortLv=function(a,b){
		return b.playerLv-a.playerLv;
	}

	UnionSession.sortZhiwu=function(a,b){
		return b.zhiWu-a.zhiWu;
	}

	UnionSession.sortLine=function(a,b){
		return b.getLine()-a.getLine();
	}

	return UnionSession;
})(Session)


//class huamao.session.VictoryBoxSession extends game.mvc.Session
var VictoryBoxSession=(function(_super){
	function VictoryBoxSession(){
		this._boxStr="";
		this.boxArr=[];
		VictoryBoxSession.__super.call(this);
	}

	__class(VictoryBoxSession,'huamao.session.VictoryBoxSession',_super);
	var __proto=VictoryBoxSession.prototype;
	__getset(0,__proto,'boxStr',function(){
		return this._boxStr;
		},function(value){
		this._boxStr=value;
		this.boxArr=[];
		if(value!=""){
			var arr=this._boxStr.split(":");
			for(var i=0;i<arr.length;i++){
				var num=arr[i].split(",");
				var data=new BoxData();
				data.boxId=num[0];
				data.itemId=num[1];
				data.startTime=num[2];
				data.endTime=num[3];
				this.boxArr.push(data);
			}
		}
		this.sessionUpdataEvent("BAG_BOX_FLUSH");
	});

	return VictoryBoxSession;
})(Session)


//class huamao.session.VideoSession extends game.mvc.Session
var VideoSession=(function(_super){
	function VideoSession(){
		this.isVideo=0;
		VideoSession.__super.call(this);
		this.init();
	}

	__class(VideoSession,'huamao.session.VideoSession',_super);
	var __proto=VideoSession.prototype;
	__proto.init=function(){}
	return VideoSession;
})(Session)


//class huamao.session.WanH5Session extends game.mvc.Session
var WanH5Session=(function(_super){
	function WanH5Session(){
		this.mainPlayerSession=null;
		this.recharge={};
		this.timer=0;
		this.wanData=new WanH5Data();
		WanH5Session.__super.call(this);
		this.init();
	}

	__class(WanH5Session,'huamao.session.WanH5Session',_super);
	var __proto=WanH5Session.prototype;
	__proto.init=function(){
		App.injOne(this);
		App.eventManager.on("SDK_INIT",this,this.initFun);
		App.eventManager.on("LOGIN_SUCCESS",this,this.loginFun);
		App.eventManager.on("PAY",this,this.payFun);
		App.eventManager.on("FLUSH_PLAYER_LV",this,this.updataLv);
	}

	__proto.loginFun=function(){
		this.pushFun("access");
	}

	__proto.initFun=function(){
		var url=Browser.window.location.href;
		var str=url.split("?")[1];
		var split=str.split("&");
		for (var i=0;i < split.length;i++){
			var str1=split[i];
			var split2=str1.split("=");
			this.wanData[ split2[0]]=split2[1];
		}
		this.sendSign(str,this.httpFun);
	}

	/**登录游戏验证签名*/
	__proto.httpFun=function(str){
		if(str==this.wanData.sign){
			App.eventManager.event("SET_SDK_ID",this.wanData.openid);
			}else{
			FlyUpTips.setTips("您的签名不对 无法登陆");
			App.eventManager.event("SIGN_ERROR");
		}
	}

	__proto.payFun=function(rechargeData){
		this.recharge=rechargeData;
		this.timer=GameUtils.GetServerTime();
		var str="openid="+this.wanData.openid+"&gkey="+this.wanData.gkey+"&skey=1&money="+rechargeData.product_price+"&gold="+rechargeData.yuanbao+"&orderno="+rechargeData.cp_order_id+"&remark="+rechargeData.product_desc+"&time="+this.timer+"&sign="+this.wanData.sign;
		this.sendSign(str,this.sendPayFun);
	}

	/**充值*/
	__proto.sendPayFun=function(str){
		var json={};
		json["openid"]=this.wanData.openid;
		json["gkey"]=this.wanData.gkey;
		json["skey"]=1;
		json["money"]=this.recharge.product_price;
		json["gold"]=this.recharge.yuanbao;
		json["orderno"]=this.recharge.cp_order_id;
		json["remark"]=this.recharge.product_desc;
		json["time"]=this.timer;
		json["sign"]=str;
		Browser.window.wanOpenSdk.pay(json,function(ret){
			if (ret.errno==0 && ret.errmsg=='ok'){
				FlyUpTips.setTips("充值成功");
			}
		});
	}

	__proto.updataLv=function(){
		this.pushFun("levelup");
	}

	__proto.pushFun=function(type){
		var lv=this.mainPlayerSession.mainPlayerData.Lv;
		var json={};
		json["openid"]=this.wanData.openid;
		json["gkey"]=this.wanData.gkey;
		json["skey"]=1;
		json["type"]=type;
		json["time"]=GameUtils.GetServerTime();
		var obj={};
		obj["roleid"]=this.mainPlayerSession.mainPlayerData.playerId;
		obj["rolename"]=this.mainPlayerSession.mainPlayerData.playerName;
		obj["level"]=this.mainPlayerSession.mainPlayerData.Lv+10000;
		json["data"]=JSON.stringify(obj);
		Browser.window.wanOpenSdk.push(json);
	}

	/**获取签名*/
	__proto.sendSign=function(str,fun){
		var http=new HttpRequest();
		var json={};
		json["action"]="Sign188wan";
		json["content"]=str;
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",this,fun);
	}

	return WanH5Session;
})(Session)


//class huamao.session.WebTestSession extends game.mvc.Session
var WebTestSession=(function(_super){
	function WebTestSession(){
		WebTestSession.__super.call(this);
		App.eventManager.on("SDK_INIT",this,this.initFun);
	}

	__class(WebTestSession,'huamao.session.WebTestSession',_super);
	var __proto=WebTestSession.prototype;
	__proto.initFun=function(){
		if(Browser.onPC){
			App.setDevelopMode();
		}
	}

	return WebTestSession;
})(Session)


//class huamao.session.WuJiangSession extends game.mvc.Session
var WuJiangSession=(function(_super){
	function WuJiangSession(){
		this._heroArr=[];
		this.heroAll={};
		this.assessData=null;
		WuJiangSession.__super.call(this);
	}

	__class(WuJiangSession,'huamao.session.WuJiangSession',_super);
	var __proto=WuJiangSession.prototype;
	/**
	*过滤掉副将
	*@param _arr[]
	*@param isdisplay false不显示 true显示
	*@param isxuecang false 不显示 true 显示
	*@return
	*
	*/
	__proto.filterLegion=function(_arr,isdisplay,isxuecang){
		(isdisplay===void 0)&& (isdisplay=false);
		(isxuecang===void 0)&& (isxuecang=false);
		var arr=[];
		var legionArr=[];
		var xarr=[];
		var xlegionArr=[];
		var resultAry=[];
		for(var i=0;i<_arr.length;i++){
			var data=this.getHero(_arr[i].heroId);
			if(data.masterId==0){
				if(data.haveHide()){
					xarr.push(_arr[i]);
					if(data.legion !=""){
						var legArr=data.legion.split(",");
						for(var j=0;j<legArr.length;j++){
							xlegionArr.push(legArr[j]);
						}
					}
					}else{
					arr.push(_arr[i]);
					if(data.legion !=""){
						var legArr1=data.legion.split(",");
						for(var j=0;j<legArr1.length;j++){
							legionArr.push(legArr1[j]);
						}
					}
				}
			}
		}
		if(isdisplay==true){
			for(i=0;i<legionArr.length;i++){
				for(j=0;j<arr.length;j++){
					data=this.getHero(legionArr[i]);
					if(data.masterId==arr[j].heroId){
						var index=j+1;
						if(index >=arr.length){
							index=-1;
							arr.push(data);
							}else{
							arr.splice(index,0,data);
						}
						break ;
					}
				}
			}
			resultAry=resultAry.concat(arr);
			if(isxuecang==true){
				for(i=0;i<xlegionArr.length;i++){
					for(j=0;j<xarr.length;j++){
						data=this.getHero(xlegionArr[i]);
						if(data.masterId==xarr[j].heroId){
							index=j+1;
							if(index >=xarr.length){
								index=-1;
								xarr.push(data);
								}else{
								xarr.splice(index,0,data);
							}
							break ;
						}
					}
				}
				resultAry=resultAry.concat(xarr);
			}
			}else{
			resultAry=resultAry.concat(arr);
			if(isxuecang==true){
				resultAry=resultAry.concat(xarr);
			}
		}
		return resultAry;
	}

	__proto.clearHeroData=function(){
		this.heroArr.length=0;
		this.heroAll={};
	}

	__proto.clearHeroState=function(){
		for (var i=0;i < this._heroArr.length;i++){
			var heroData=this._heroArr [i];
			if(heroData.heroState==2){
				heroData.heroState=0;
			}
		}
	}

	/**
	*得到经过排序的
	*@return
	*/
	__proto.getHeroSnArr=function(){
		var arr=this.getNoFenJie();
		arr.sort(WuJiangSession.sortColorSn);
		return arr;
	}

	/**
	*根据国家得到列表
	*@param country
	*@return
	*/
	__proto.getHeroByCountry=function(country){
		if(country==-1){
			var arr1=this.getNoFenJie();
			arr1.sort(WuJiangSession.sortColorSn);
			return arr1;
		};
		var returnArr=[];
		var arr=this.getNoFenJie();
		for (var i=0;i < arr.length;i++){
			var heroData=arr [i];
			if(heroData.sysHero.heroCountry==country){
				returnArr.push(heroData);
			}
		}
		returnArr.sort(WuJiangSession.sortColorSn);
		return returnArr;
	}

	__proto.getNoFenJie=function(){
		var arr=[];
		for (var i=0;i < this._heroArr.length;i++){
			var heroData=this._heroArr [i];
			if(heroData.haveHero()){
				arr.push(heroData);
			}
		}
		return arr;
	}

	__proto.getHecheng=function(){
		var newArr=[];
		for(var i=0;i<this._heroArr.length;i++){
			if(!this._heroArr[i].haveHero()){
				newArr.push(this._heroArr[i]);
			}
		}
		newArr.sort(WuJiangSession.sortColorSn);
		return newArr;
	}

	__proto.getHideArr=function(hide){
		var arr=[];
		for (var i=0;i < this._heroArr.length;i++){
			var heroData=this._heroArr [i];
			if(heroData.isXueCang==hide){
				arr.push(heroData);
			}
		}
		arr.sort(WuJiangSession.sortColorSn);
		return arr;
	}

	__proto.clearState=function(){
		for (var i=0;i < this._heroArr.length;i++){
			var heroData=this._heroArr [i];
			heroData.heroState=0;
		}
	}

	__proto.addHero=function(data){
		this.heroAll[data.heroId]=data;
		this.heroArr.push(data);
	}

	__proto.deleteHero=function(heroId){
		var i=0;
		for(i=0;i<this.heroArr.length;i++){
			if(this.heroArr[i].heroId==heroId){
				this.heroArr.splice(i,1);
				break ;
			}
		}
		delete this.heroAll[heroId];
	}

	__proto.getHero=function(heroId){
		return this.heroAll[heroId];
	}

	__proto.setXueCang=function(heroId,isXueCang){
		this.getHero(heroId).isXueCang=isXueCang;
		App.eventManager.event("XUE_CANG",heroId);
	}

	__proto.setHeroLv=function(heroId,lv){
		this.getHero(heroId).heroLv=lv;
		App.eventManager.event("HERO_LV_UP",heroId);
		FlyUpTips.setTips("升级成功!");
	}

	__getset(0,__proto,'heroArr',function(){
		return this._heroArr;
		},function(value){
		this._heroArr=value;
	});

	WuJiangSession.sortColorSn=function(a,b){
		if(b.sysHero.heroColor !=a.sysHero.heroColor){
			return b.sysHero.heroColor-a.sysHero.heroColor;
		}
		else{
			if(b.heroLv !=a.heroLv){
				return b.heroLv-a.heroLv;
			}
			else{
				if(b.fight !=a.fight){
					return b.fight-a.fight;
				}
				else{
					return a.sysHero.heroId-b.sysHero.heroId;
				}
			}
		}
	}

	return WuJiangSession;
})(Session)


//class huamao.session.WujiangXinxiSession extends game.mvc.Session
var WujiangXinxiSession=(function(_super){
	function WujiangXinxiSession(){
		this.currId=0;
		WujiangXinxiSession.__super.call(this);
	}

	__class(WujiangXinxiSession,'huamao.session.WujiangXinxiSession',_super);
	return WujiangXinxiSession;
})(Session)


//class huamao.session.XuYangSession extends game.mvc.Session
var XuYangSession=(function(_super){
	function XuYangSession(){
		this.loginSession=null;
		this.xuYangData=new XuYangData();
		XuYangSession.__super.call(this);
		App.injOne(this);
		App.eventManager.on("SDK_INIT",this,this.initFun);
		App.eventManager.on("LOGIN_SUCCESS",this,this.loginFun);
		App.eventManager.on("PAY",this,this.payFun);
		Browser.window.addEventListener("message",function(messageEvent){
			var data=messageEvent.json;
			if(data["code"]=="1" || data["code"]==1){
				FlyUpTips.setTips("发货成功");
				}else if(data["code"]=="2" || data["code"]==2){
				FlyUpTips.setTips("发货失败");
				}else {
				FlyUpTips.setTips("订单重复");
			}
		});
	}

	__class(XuYangSession,'huamao.session.XuYangSession',_super);
	var __proto=XuYangSession.prototype;
	__proto.payFun=function(rechargeData){
		var json={};
		json["gameOther"]=rechargeData.cp_order_id+"";
		json["sid"]=this.loginSession.serverId+"";
		json["apid"]=rechargeData.product_id+"";
		json["transactionId"]=rechargeData.cp_order_id+"";
		json["price"]=rechargeData.product_price;
		this.sendSdk("purchaseAction",json);
	}

	__proto.loginFun=function(data){
		var json={};
		json["sid"]=this.loginSession.serverId+"";
		json["role"]=data.Lv+"";
		json["roleName"]=data.playerName+"";
		this.sendSdk("serviceAction",json);
	}

	__proto.initFun=function(){
		var url=Browser.window.location.href;
		var str=url.split("?")[1];
		var split=str.split("&");
		for (var i=0;i < split.length;i++){
			var str1=split[i];
			var split2=str1.split("=");
			this.xuYangData[ split2[0]]=split2[1];
		};
		var http=new HttpRequest();
		var json={};
		json["action"]="XuYangSign";
		json["accountName"]=this.xuYangData.accountName;
		json["uid"]=this.xuYangData.uid;
		json["token"]=this.xuYangData.token;
		json["sdkVersionCode"]=this.xuYangData.sdkVersionCode;
		json["gid"]=this.xuYangData.gid;
		json["sign"]=this.xuYangData.sign;
		http.send(MyGameInit.getConfig("masterServer"),JSON.stringify(json),"post");
		http.once("complete",this,this.httpFun);
	}

	__proto.httpFun=function(str){
		if(str==this.xuYangData.sign){
			App.eventManager.event("SET_SDK_ID",this.xuYangData.uid);
			}else{
			FlyUpTips.setTips("您的签名不对 无法登陆");
			App.eventManager.event("SIGN_ERROR");
		}
	}

	__proto.sendSdk=function(type,data){
		var json={};
		json["type"]=type;
		json["json"]=data;
		Browser.window["p"+"arent"].postMessage(json,"http://applyapi.ggxx.net");
	}

	XuYangSession.url="http://applyapi.ggxx.net";
	return XuYangSession;
})(Session)


//class huamao.session.ZhaoMuSession extends game.mvc.Session
var ZhaoMuSession=(function(_super){
	function ZhaoMuSession(){
		/**重金招募次数*/
		this.num=0;
		/**下次免费时间*/
		this.freeTime=0;
		// public var itemnum:int ;//当前招募令数量
		this.lastStr=null;
		this.actionType=0;
		/**名将录所有武将数据*/
		this.mjlData=null;
		/**招募记录*/
		this.heroJl=[];
		/**当前国家前七天必须是蜀国 0蜀 1吴 2魏 3群*/
		this.country=0;
		this.mainPlayerSession=null;
		ZhaoMuSession.__super.call(this);
		App.injOne(this);
	}

	__class(ZhaoMuSession,'huamao.session.ZhaoMuSession',_super);
	var __proto=ZhaoMuSession.prototype;
	/**
	*true能换国家 false不能换国家
	*@return
	*
	*/
	__proto.getGHCountry=function(){
		var day=86400*7;
		var boo=true;
		var num=this.mainPlayerSession.mainPlayerData.createTime+day;
		if(num>GameUtils.GetServerTime()){
			boo=false;
		}
		return boo;
	}

	return ZhaoMuSession;
})(Session)


/**
*<code>AnimationTemplet</code> 类用于动画模板资源。
*/
//class laya.ani.AnimationTemplet extends laya.resource.Resource
var AnimationTemplet=(function(_super){
	function AnimationTemplet(){
		/**@private */
		//this._aniVersion=null;
		/**@private */
		this._aniMap={};
		/**@private */
		//this._publicExtData=null;
		/**@private */
		//this._useParent=false;
		/**@private */
		//this.unfixedCurrentFrameIndexes=null;
		/**@private */
		//this.unfixedCurrentTimes=null;
		/**@private */
		//this.unfixedKeyframes=null;
		/**@private */
		this.unfixedLastAniIndex=-1;
		/**@private */
		//this._aniClassName=null;
		/**@private */
		//this._animationDatasCache=null;
		AnimationTemplet.__super.call(this);
		this._anis=new Array;
	}

	__class(AnimationTemplet,'laya.ani.AnimationTemplet',_super);
	var __proto=AnimationTemplet.prototype;
	/**
	*@private
	*/
	__proto.parse=function(data){
		var reader=new Byte(data);
		this._aniVersion=reader.readUTFString();
		AnimationParser01.parse(this,reader);
	}

	/**
	*@private
	*/
	__proto._calculateKeyFrame=function(node,keyframeCount,keyframeDataCount){
		var keyFrames=node.keyFrame;
		keyFrames[keyframeCount]=keyFrames[0];
		for (var i=0;i < keyframeCount;i++){
			var keyFrame=keyFrames[i];
			keyFrame.nextData=(keyFrame.duration===0)? keyFrame.data :keyFrames[i+1].data;
		}
		keyFrames.length--;
	}

	/**
	*@inheritDoc
	*/
	__proto.onAsynLoaded=function(url,data,params){
		var reader=new Byte(data);
		this._aniVersion=reader.readUTFString();
		switch (this._aniVersion){
			case "LAYAANIMATION:02":
				AnimationParser02.parse(this,reader);
				break ;
			default :
				AnimationParser01.parse(this,reader);
			}
		this._endLoaded();
	}

	/**
	*@inheritDoc
	*/
	__proto.disposeResource=function(){
		this._aniVersion=null;
		this._anis=null;
		this._aniMap=null;
		this._publicExtData=null;
		this.unfixedCurrentFrameIndexes=null;
		this.unfixedCurrentTimes=null;
		this.unfixedKeyframes=null;
		this._aniClassName=null;
		this._animationDatasCache=null;
	}

	__proto.getAnimationCount=function(){
		return this._anis.length;
	}

	__proto.getAnimation=function(aniIndex){
		return this._anis[aniIndex];
	}

	__proto.getAniDuration=function(aniIndex){
		return this._anis[aniIndex].playTime;
	}

	__proto.getNodes=function(aniIndex){
		return this._anis[aniIndex].nodes;
	}

	__proto.getNodeIndexWithName=function(aniIndex,name){
		return this._anis[aniIndex].bone3DMap[name];
	}

	__proto.getNodeCount=function(aniIndex){
		return this._anis[aniIndex].nodes.length;
	}

	__proto.getTotalkeyframesLength=function(aniIndex){
		return this._anis[aniIndex].totalKeyframeDatasLength;
	}

	__proto.getPublicExtData=function(){
		return this._publicExtData;
	}

	__proto.getAnimationDataWithCache=function(key,cacheDatas,aniIndex,frameIndex){
		var aniDatas=cacheDatas[aniIndex];
		if (!aniDatas){
			return null;
			}else {
			var keyDatas=aniDatas[key];
			if (!keyDatas)
				return null;
			else {
				return keyDatas[frameIndex];
			}
		}
	}

	__proto.setAnimationDataWithCache=function(key,cacheDatas,aniIndex,frameIndex,data){
		var aniDatas=(cacheDatas[aniIndex])|| (cacheDatas[aniIndex]={});
		var aniDatasCache=(aniDatas[key])|| (aniDatas[key]=[]);
		aniDatasCache[frameIndex]=data;
	}

	__proto.getOriginalData=function(aniIndex,originalData,nodesFrameIndices,frameIndex,playCurTime){
		var oneAni=this._anis[aniIndex];
		var nodes=oneAni.nodes;
		var j=0;
		for (var i=0,n=nodes.length,outOfs=0;i < n;i++){
			var node=nodes[i];
			var key;
			key=node.keyFrame[nodesFrameIndices[i][frameIndex]];
			node.dataOffset=outOfs;
			var dt=playCurTime-key.startTime;
			var lerpType=node.lerpType;
			if (lerpType){
				switch (lerpType){
					case 0:
					case 1:
						for (j=0;j < node.keyframeWidth;)
						j+=node.interpolationMethod[j](node,j,originalData,outOfs+j,key.data,dt,null,key.duration,key.nextData);
						break ;
					case 2:;
						var interpolationData=key.interpolationData;
						var interDataLen=interpolationData.length;
						var dataIndex=0;
						for (j=0;j < interDataLen;){
							var type=interpolationData[j];
						switch (type){
							case 6:
								j+=AnimationTemplet.interpolation[type](node,dataIndex,originalData,outOfs+dataIndex,key.data,dt,null,key.duration,key.nextData,interpolationData,j+1);
								break ;
							case 7:
								j+=AnimationTemplet.interpolation[type](node,dataIndex,originalData,outOfs+dataIndex,key.data,dt,null,key.duration,key.nextData,interpolationData,j+1);
								break ;
							default :
								j+=AnimationTemplet.interpolation[type](node,dataIndex,originalData,outOfs+dataIndex,key.data,dt,null,key.duration,key.nextData);
							}
						dataIndex++;
					}
					break ;
				}
				}else {
				for (j=0;j < node.keyframeWidth;)
				j+=node.interpolationMethod[j](node,j,originalData,outOfs+j,key.data,dt,null,key.duration,key.nextData);
			}
			outOfs+=node.keyframeWidth;
		}
	}

	__proto.getNodesCurrentFrameIndex=function(aniIndex,playCurTime){
		var ani=this._anis[aniIndex];
		var nodes=ani.nodes;
		if (aniIndex!==this.unfixedLastAniIndex){
			this.unfixedCurrentFrameIndexes=new Uint32Array(nodes.length);
			this.unfixedCurrentTimes=new Float32Array(nodes.length);
			this.unfixedLastAniIndex=aniIndex;
		}
		for (var i=0,n=nodes.length,outOfs=0;i < n;i++){
			var node=nodes[i];
			if (playCurTime < this.unfixedCurrentTimes[i])
				this.unfixedCurrentFrameIndexes[i]=0;
			this.unfixedCurrentTimes[i]=playCurTime;
			while ((this.unfixedCurrentFrameIndexes[i] < node.keyFrame.length)){
				if (node.keyFrame[this.unfixedCurrentFrameIndexes[i]].startTime > this.unfixedCurrentTimes[i])
					break ;
				this.unfixedCurrentFrameIndexes[i]++;
			}
			this.unfixedCurrentFrameIndexes[i]--;
		}
		return this.unfixedCurrentFrameIndexes;
	}

	__proto.getOriginalDataUnfixedRate=function(aniIndex,originalData,playCurTime){
		var oneAni=this._anis[aniIndex];
		var nodes=oneAni.nodes;
		if (aniIndex!==this.unfixedLastAniIndex){
			this.unfixedCurrentFrameIndexes=new Uint32Array(nodes.length);
			this.unfixedCurrentTimes=new Float32Array(nodes.length);
			this.unfixedKeyframes=__newvec(nodes.length);
			this.unfixedLastAniIndex=aniIndex;
		};
		var j=0;
		for (var i=0,n=nodes.length,outOfs=0;i < n;i++){
			var node=nodes[i];
			if (playCurTime < this.unfixedCurrentTimes[i])
				this.unfixedCurrentFrameIndexes[i]=0;
			this.unfixedCurrentTimes[i]=playCurTime;
			while (this.unfixedCurrentFrameIndexes[i] < node.keyFrame.length){
				if (node.keyFrame[this.unfixedCurrentFrameIndexes[i]].startTime > this.unfixedCurrentTimes[i])
					break ;
				this.unfixedKeyframes[i]=node.keyFrame[this.unfixedCurrentFrameIndexes[i]];
				this.unfixedCurrentFrameIndexes[i]++;
			};
			var key=this.unfixedKeyframes[i];
			node.dataOffset=outOfs;
			var dt=playCurTime-key.startTime;
			var lerpType=node.lerpType;
			if (lerpType){
				switch (node.lerpType){
					case 0:
					case 1:
						for (j=0;j < node.keyframeWidth;)
						j+=node.interpolationMethod[j](node,j,originalData,outOfs+j,key.data,dt,null,key.duration,key.nextData);
						break ;
					case 2:;
						var interpolationData=key.interpolationData;
						var interDataLen=interpolationData.length;
						var dataIndex=0;
						for (j=0;j < interDataLen;){
							var type=interpolationData[j];
						switch (type){
							case 6:
								j+=AnimationTemplet.interpolation[type](node,dataIndex,originalData,outOfs+dataIndex,key.data,dt,null,key.duration,key.nextData,interpolationData,j+1);
								break ;
							case 7:
								j+=AnimationTemplet.interpolation[type](node,dataIndex,originalData,outOfs+dataIndex,key.data,dt,null,key.duration,key.nextData,interpolationData,j+1);
								break ;
							default :
								j+=AnimationTemplet.interpolation[type](node,dataIndex,originalData,outOfs+dataIndex,key.data,dt,null,key.duration,key.nextData);
							}
						dataIndex++;
					}
					break ;
				}
				}else {
				for (j=0;j < node.keyframeWidth;)
				j+=node.interpolationMethod[j](node,j,originalData,outOfs+j,key.data,dt,null,key.duration,key.nextData);
			}
			outOfs+=node.keyframeWidth;
		}
	}

	AnimationTemplet._LinearInterpolation_0=function(bone,index,out,outOfs,data,dt,dData,duration,nextData,interData){
		var amount=duration===0 ? 0 :dt / duration;
		out[outOfs]=(1.0-amount)*data[index]+amount *nextData[index];
		return 1;
	}

	AnimationTemplet._QuaternionInterpolation_1=function(bone,index,out,outOfs,data,dt,dData,duration,nextData,interData){
		var amount=duration===0 ? 0 :dt / duration;
		MathUtil.slerpQuaternionArray(data,index,nextData,index,amount,out,outOfs);
		return 4;
	}

	AnimationTemplet._AngleInterpolation_2=function(bone,index,out,outOfs,data,dt,dData,duration,nextData,interData){
		return 0;
	}

	AnimationTemplet._RadiansInterpolation_3=function(bone,index,out,outOfs,data,dt,dData,duration,nextData,interData){
		return 0;
	}

	AnimationTemplet._Matrix4x4Interpolation_4=function(bone,index,out,outOfs,data,dt,dData,duration,nextData,interData){
		for (var i=0;i < 16;i++,index++)
		out[outOfs+i]=data[index]+dt *dData[index];
		return 16;
	}

	AnimationTemplet._NoInterpolation_5=function(bone,index,out,outOfs,data,dt,dData,duration,nextData,interData){
		out[outOfs]=data[index];
		return 1;
	}

	AnimationTemplet._BezierInterpolation_6=function(bone,index,out,outOfs,data,dt,dData,duration,nextData,interData,offset){
		(offset===void 0)&& (offset=0);
		out[outOfs]=data[index]+(nextData[index]-data[index])*BezierLerp.getBezierRate(dt / duration,interData[offset],interData[offset+1],interData[offset+2],interData[offset+3]);
		return 5;
	}

	AnimationTemplet._BezierInterpolation_7=function(bone,index,out,outOfs,data,dt,dData,duration,nextData,interData,offset){
		(offset===void 0)&& (offset=0);
		out[outOfs]=interData[offset+4]+interData[offset+5] *BezierLerp.getBezierRate((dt *0.001+interData[offset+6])/ interData[offset+7],interData[offset],interData[offset+1],interData[offset+2],interData[offset+3]);
		return 9;
	}

	AnimationTemplet.load=function(url){
		return Laya.loader.create(url,null,null,AnimationTemplet);
	}

	AnimationTemplet.interpolation=[AnimationTemplet._LinearInterpolation_0,AnimationTemplet._QuaternionInterpolation_1,AnimationTemplet._AngleInterpolation_2,AnimationTemplet._RadiansInterpolation_3,AnimationTemplet._Matrix4x4Interpolation_4,AnimationTemplet._NoInterpolation_5,AnimationTemplet._BezierInterpolation_6,AnimationTemplet._BezierInterpolation_7];
	return AnimationTemplet;
})(Resource)


//class laya.webgl.utils.Buffer extends laya.resource.Resource
var Buffer=(function(_super){
	function Buffer(){
		this._glBuffer=null;
		this._buffer=null;
		//可能为Float32Array、Uint16Array、Uint8Array、ArrayBuffer等。
		this._bufferType=0;
		this._bufferUsage=0;
		this._byteLength=0;
		Buffer.__super.call(this);
		Buffer._gl=WebGL.mainContext;
	}

	__class(Buffer,'laya.webgl.utils.Buffer',_super);
	var __proto=Buffer.prototype;
	__proto._bind=function(){
		this.activeResource();
		if (Buffer._bindActive[this._bufferType]!==this._glBuffer){
			(this._bufferType===0x8892)&& (Buffer._bindVertexBuffer=this._glBuffer);
			Buffer._gl.bindBuffer(this._bufferType,Buffer._bindActive[this._bufferType]=this._glBuffer);
			BaseShader.activeShader=null;
		}
	}

	__proto.recreateResource=function(){
		this._glBuffer || (this._glBuffer=Buffer._gl.createBuffer());
		this.completeCreate();
	}

	__proto.disposeResource=function(){
		if (this._glBuffer){
			WebGL.mainContext.deleteBuffer(this._glBuffer);
			this._glBuffer=null;
		}
		this.memorySize=0;
	}

	__getset(0,__proto,'bufferUsage',function(){
		return this._bufferUsage;
	});

	Buffer._gl=null;
	Buffer._bindActive={};
	Buffer._bindVertexBuffer=null;
	Buffer._enableAtributes=[];
	return Buffer;
})(Resource)


/**
*...
*@author ...
*/
//class laya.webgl.shader.BaseShader extends laya.resource.Resource
var BaseShader=(function(_super){
	function BaseShader(){
		BaseShader.__super.call(this);
		this.lock=true;
	}

	__class(BaseShader,'laya.webgl.shader.BaseShader',_super);
	BaseShader.activeShader=null;
	BaseShader.bindShader=null;
	return BaseShader;
})(Resource)


/**
*@private
*<code>Bitmap</code> 是图片资源类。
*/
//class laya.resource.Bitmap extends laya.resource.Resource
var Bitmap=(function(_super){
	function Bitmap(){
		/**@private
		*HTML Image或HTML Canvas或WebGL Texture。
		**/
		//this._source=null;
		/**@private 宽度*/
		//this._w=NaN;
		/**@private 高度*/
		//this._h=NaN;
		Bitmap.__super.call(this);
		this._w=0;
		this._h=0;
	}

	__class(Bitmap,'laya.resource.Bitmap',_super);
	var __proto=Bitmap.prototype;
	/***
	*宽度。
	*/
	__getset(0,__proto,'width',function(){
		return this._w;
	});

	/***
	*高度。
	*/
	__getset(0,__proto,'height',function(){
		return this._h;
	});

	/***
	*HTML Image 或 HTML Canvas 或 WebGL Texture 。
	*/
	__getset(0,__proto,'source',function(){
		return this._source;
	});

	return Bitmap;
})(Resource)


/**
*...
*@author ww
*/
//class laya.debug.tools.enginehook.LoaderHook extends laya.net.LoaderManager
var LoaderHook=(function(_super){
	function LoaderHook(){
		LoaderHook.__super.call(this);
	}

	__class(LoaderHook,'laya.debug.tools.enginehook.LoaderHook',_super);
	var __proto=LoaderHook.prototype;
	__proto.checkUrls=function(url){
		var tarUrl;
		if ((typeof url=='string')){
			tarUrl=url;
			}else{
			tarUrl=url.url;
		}
		if (LoaderHook.preFails[tarUrl]){
			if (LoaderHook.enableFailDebugger){
				debugger;
			}
		}
	}

	__proto.chekUrlList=function(urls){
		var i=0,len=0;
		len=urls.length;
		for (i=0;i < len;i++){
			this.checkUrls(urls[i]);
		}
	}

	__proto.load=function(url,complete,progress,type,priority,cache,group,ignoreCache){
		(priority===void 0)&& (priority=1);
		(cache===void 0)&& (cache=true);
		(ignoreCache===void 0)&& (ignoreCache=false);
		if ((url instanceof Array)){
			this.chekUrlList(url);
			}else{
			this.checkUrls(url);
		}
		return _super.prototype.load.call(this,url,complete,progress,type,priority,cache,group,ignoreCache);
	}

	LoaderHook.init=function(){
		if (LoaderHook.isInited)return;
		LoaderHook.isInited=true;
		Laya.loader=new LoaderHook();
		Laya.loader.on("error",null,LoaderHook.onFail);
		LoaderHook.preFails=LocalStorage.getJSON("LoadFailItems");
		if (!LoaderHook.preFails)LoaderHook.preFails={};
	}

	LoaderHook.onFail=function(failFile){
		OutPutView.I.dTrace("LoadFail:"+failFile);
		LoaderHook.nowFails[failFile]=true;
		LocalStorage.setJSON("LoadFailItems",LoaderHook.nowFails);
	}

	LoaderHook.resetFails=function(){
		LoaderHook.nowFails={};
		LocalStorage.setJSON("LoadFailItems",LoaderHook.nowFails);
	}

	LoaderHook.preFails={};
	LoaderHook.nowFails={};
	LoaderHook.enableFailDebugger=true;
	LoaderHook.FailSign="LoadFailItems";
	LoaderHook.isInited=false;
	return LoaderHook;
})(LoaderManager)


/**
*@private
*audio标签播放声音的音轨控制
*/
//class laya.media.h5audio.AudioSoundChannel extends laya.media.SoundChannel
var AudioSoundChannel=(function(_super){
	function AudioSoundChannel(audio){
		/**
		*播放用的audio标签
		*/
		this._audio=null;
		this._onEnd=null;
		this._resumePlay=null;
		AudioSoundChannel.__super.call(this);
		this._onEnd=Utils.bind(this.__onEnd,this);
		this._resumePlay=Utils.bind(this.__resumePlay,this);
		audio.addEventListener("ended",this._onEnd);
		this._audio=audio;
	}

	__class(AudioSoundChannel,'laya.media.h5audio.AudioSoundChannel',_super);
	var __proto=AudioSoundChannel.prototype;
	__proto.__onEnd=function(){
		if (this.loops==1){
			if (this.completeHandler){
				Laya.timer.once(10,this,this.__runComplete,[this.completeHandler],false);
				this.completeHandler=null;
			}
			this.stop();
			this.event("complete");
			return;
		}
		if (this.loops > 0){
			this.loops--;
		}
		this.startTime=0;
		this.play();
	}

	__proto.__resumePlay=function(){
		if(this._audio)this._audio.removeEventListener("canplay",this._resumePlay);
		try {
			this._audio.currentTime=this.startTime;
			Browser.container.appendChild(this._audio);
			this._audio.play();
			}catch (e){
			this.event("error");
		}
	}

	/**
	*播放
	*/
	__proto.play=function(){
		this.isStopped=false;
		try {
			this._audio.playbackRate=SoundManager.playbackRate;
			this._audio.currentTime=this.startTime;
			}catch (e){
			this._audio.addEventListener("canplay",this._resumePlay);
			return;
		}
		SoundManager.addChannel(this);
		Browser.container.appendChild(this._audio);
		if("play" in this._audio)
			this._audio.play();
	}

	/**
	*停止播放
	*
	*/
	__proto.stop=function(){
		this.isStopped=true;
		SoundManager.removeChannel(this);
		this.completeHandler=null;
		if (!this._audio)
			return;
		if ("pause" in this._audio)
			if (Render.isConchApp){
			this._audio.stop();
		}
		this._audio.pause();
		this._audio.removeEventListener("ended",this._onEnd);
		this._audio.removeEventListener("canplay",this._resumePlay);
		if (!Browser.onIE){
			if (this._audio!=AudioSound._musicAudio){
				Pool.recover("audio:"+this.url,this._audio);
			}
		}
		Browser.removeElement(this._audio);
		this._audio=null;
	}

	__proto.pause=function(){
		this.isStopped=true;
		SoundManager.removeChannel(this);
		if("pause" in this._audio)
			this._audio.pause();
	}

	__proto.resume=function(){
		if (!this._audio)
			return;
		this.isStopped=false;
		SoundManager.addChannel(this);
		if("play" in this._audio)
			this._audio.play();
	}

	/**
	*当前播放到的位置
	*@return
	*
	*/
	__getset(0,__proto,'position',function(){
		if (!this._audio)
			return 0;
		return this._audio.currentTime;
	});

	/**
	*获取总时间。
	*/
	__getset(0,__proto,'duration',function(){
		if (!this._audio)
			return 0;
		return this._audio.duration;
	});

	/**
	*设置音量
	*@param v
	*
	*/
	/**
	*获取音量
	*@return
	*
	*/
	__getset(0,__proto,'volume',function(){
		if (!this._audio)return 1;
		return this._audio.volume;
		},function(v){
		if (!this._audio)return;
		this._audio.volume=v;
	});

	return AudioSoundChannel;
})(SoundChannel)


/**
*@private
*web audio api方式播放声音的音轨控制
*/
//class laya.media.webaudio.WebAudioSoundChannel extends laya.media.SoundChannel
var WebAudioSoundChannel=(function(_super){
	function WebAudioSoundChannel(){
		/**
		*声音原始文件数据
		*/
		this.audioBuffer=null;
		/**
		*gain节点
		*/
		this.gain=null;
		/**
		*播放用的数据
		*/
		this.bufferSource=null;
		/**
		*当前时间
		*/
		this._currentTime=0;
		/**
		*当前音量
		*/
		this._volume=1;
		/**
		*播放开始时的时间戳
		*/
		this._startTime=0;
		this._pauseTime=0;
		this._onPlayEnd=null;
		this.context=WebAudioSound.ctx;
		WebAudioSoundChannel.__super.call(this);
		this._onPlayEnd=Utils.bind(this.__onPlayEnd,this);
		if (this.context["createGain"]){
			this.gain=this.context["createGain"]();
			}else {
			this.gain=this.context["createGainNode"]();
		}
	}

	__class(WebAudioSoundChannel,'laya.media.webaudio.WebAudioSoundChannel',_super);
	var __proto=WebAudioSoundChannel.prototype;
	/**
	*播放声音
	*/
	__proto.play=function(){
		SoundManager.addChannel(this);
		this.isStopped=false;
		this._clearBufferSource();
		if (!this.audioBuffer)return;
		var context=this.context;
		var gain=this.gain;
		var bufferSource=context.createBufferSource();
		this.bufferSource=bufferSource;
		bufferSource.buffer=this.audioBuffer;
		bufferSource.connect(gain);
		if (gain)
			gain.disconnect();
		gain.connect(context.destination);
		bufferSource.onended=this._onPlayEnd;
		if (this.startTime >=this.duration)this.startTime=0;
		this._startTime=Browser.now();
		this.gain.gain.value=this._volume;
		if (this.loops==0){
			bufferSource.loop=true;
		}
		bufferSource.playbackRate.value=SoundManager.playbackRate;
		bufferSource.start(0,this.startTime);
		this._currentTime=0;
	}

	__proto.__onPlayEnd=function(){
		if (this.loops==1){
			if (this.completeHandler){
				Laya.timer.once(10,this,this.__runComplete,[this.completeHandler],false);
				this.completeHandler=null;
			}
			this.stop();
			this.event("complete");
			return;
		}
		if (this.loops > 0){
			this.loops--;
		}
		this.startTime=0;
		this.play();
	}

	__proto._clearBufferSource=function(){
		if (this.bufferSource){
			var sourceNode=this.bufferSource;
			if (sourceNode.stop){
				sourceNode.stop(0);
				}else {
				sourceNode.noteOff(0);
			}
			sourceNode.disconnect(0);
			sourceNode.onended=null;
			if (!WebAudioSoundChannel._tryCleanFailed)this._tryClearBuffer(sourceNode);
			this.bufferSource=null;
		}
	}

	__proto._tryClearBuffer=function(sourceNode){
		if (!Browser.onMac){
			try{
				sourceNode.buffer=null;
				}catch (e){
				WebAudioSoundChannel._tryCleanFailed=true;
			}
			return;
		}
		try {sourceNode.buffer=WebAudioSound._miniBuffer;}catch (e){WebAudioSoundChannel._tryCleanFailed=true;}
	}

	/**
	*停止播放
	*/
	__proto.stop=function(){
		this._clearBufferSource();
		this.audioBuffer=null;
		if (this.gain)
			this.gain.disconnect();
		this.isStopped=true;
		SoundManager.removeChannel(this);
		this.completeHandler=null;
		if(SoundManager.autoReleaseSound)
			Laya.timer.once(5000,null,SoundManager.disposeSoundIfNotUsed,[this.url],false);
	}

	__proto.pause=function(){
		if (!this.isStopped){
			this._pauseTime=this.position;
		}
		this._clearBufferSource();
		if (this.gain)
			this.gain.disconnect();
		this.isStopped=true;
		SoundManager.removeChannel(this);
		if(SoundManager.autoReleaseSound)
			Laya.timer.once(5000,null,SoundManager.disposeSoundIfNotUsed,[this.url],false);
	}

	__proto.resume=function(){
		this.startTime=this._pauseTime;
		this.play();
	}

	/**
	*获取当前播放位置
	*/
	__getset(0,__proto,'position',function(){
		if (this.bufferSource){
			return (Browser.now()-this._startTime)/ 1000+this.startTime;
		}
		return 0;
	});

	__getset(0,__proto,'duration',function(){
		if (this.audioBuffer){
			return this.audioBuffer.duration;
		}
		return 0;
	});

	/**
	*设置音量
	*/
	/**
	*获取音量
	*/
	__getset(0,__proto,'volume',function(){
		return this._volume;
		},function(v){
		if (this.isStopped){
			return;
		}
		this._volume=v;
		this.gain.gain.value=v;
	});

	WebAudioSoundChannel._tryCleanFailed=false;
	return WebAudioSoundChannel;
})(SoundChannel)


/**
*@private
*简化mesh绘制，多顶点mesh改为四顶点mesh，只绘制矩形不绘制三角形
*/
//class laya.ani.bone.canvasmesh.SimpleSkinMeshCanvas extends laya.ani.bone.canvasmesh.SkinMeshCanvas
var SimpleSkinMeshCanvas=(function(_super){
	function SimpleSkinMeshCanvas(){
		/**
		*当前mesh数据是否可用
		*/
		this.cacheOK=false;
		/**
		*当前渲染数据是否可用
		*/
		this.cacheCmdOK=false;
		/**
		*transform参数缓存
		*/
		this.transformCmds=[];
		/**
		*drawImage参数缓存
		*/
		this.drawCmds=[]
		SimpleSkinMeshCanvas.__super.call(this);
		this.tempMesh=new MeshData();
	}

	__class(SimpleSkinMeshCanvas,'laya.ani.bone.canvasmesh.SimpleSkinMeshCanvas',_super);
	var __proto=SimpleSkinMeshCanvas.prototype;
	__proto.init2=function(texture,vs,ps,verticles,uvs){
		_super.prototype.init2.call(this,texture,vs,ps,verticles,uvs);
		this.cacheOK=false;
		this.cacheCmdOK=false;
		this.transformCmds.length=6;
		this.drawCmds.length=9;
	}

	__proto.renderToContext=function(context){
		this.context=context.ctx || context;
		if (this.mesh){
			if (this.mesh.uvs.length <=8){
				if (this.mode==0){
					this._renderWithIndexes(this.mesh);
				}
				else {
					this._renderNoIndexes(this.mesh);
				}
				return;
			}
			if (!this.cacheOK){
				this.tempMesh.texture=this.mesh.texture;
				this.tempMesh.uvs=this.mesh.texture.uv;
				this.tempMesh.vertices=MeshTools.solveMesh(this.mesh,this.tempMesh.vertices);
				this.cacheOK=true;
			}
			if (this.mode==0){
				this._renderWithIndexes(this.tempMesh);
			}
			else {
				this._renderNoIndexes(this.tempMesh);
			}
		}
	}

	__proto._renderWithIndexes=function(mesh){
		if(this.cacheCmdOK){
			this.renderByCache(mesh);
			return;
		};
		var indexes=mesh.indexes;
		var i=0,len=indexes.length;
		if (len > 1)
			len=1;
		for (i=0;i < len;i+=3){
			var index0=indexes[i] *2;
			var index1=indexes[i+1] *2;
			var index2=indexes[i+2] *2;
			this._renderDrawTriangle(mesh,index0,index1,index2);
		}
		this.cacheCmdOK=true;
	}

	__proto._renderDrawTriangle=function(mesh,index0,index1,index2){
		var context=this.context;
		var uvs=mesh.uvs;
		var vertices=mesh.vertices;
		var texture=mesh.texture;
		var source=texture.bitmap;
		var textureSource=source.source;
		var textureWidth=texture.width;
		var textureHeight=texture.height;
		var sourceWidth=source.width;
		var sourceHeight=source.height;
		var u0=NaN;
		var u1=NaN;
		var u2=NaN;
		var v0=NaN;
		var v1=NaN;
		var v2=NaN;
		if (mesh.useUvTransform){
			var ut=mesh.uvTransform;
			u0=((uvs[index0] *ut.a)+(uvs[index0+1] *ut.c)+ut.tx)*sourceWidth;
			u1=((uvs[index1] *ut.a)+(uvs[index1+1] *ut.c)+ut.tx)*sourceWidth;
			u2=((uvs[index2] *ut.a)+(uvs[index2+1] *ut.c)+ut.tx)*sourceWidth;
			v0=((uvs[index0] *ut.b)+(uvs[index0+1] *ut.d)+ut.ty)*sourceHeight;
			v1=((uvs[index1] *ut.b)+(uvs[index1+1] *ut.d)+ut.ty)*sourceHeight;
			v2=((uvs[index2] *ut.b)+(uvs[index2+1] *ut.d)+ut.ty)*sourceHeight;
		}
		else {
			u0=uvs[index0] *sourceWidth;
			u1=uvs[index1] *sourceWidth;
			u2=uvs[index2] *sourceWidth;
			v0=uvs[index0+1] *sourceHeight;
			v1=uvs[index1+1] *sourceHeight;
			v2=uvs[index2+1] *sourceHeight;
		};
		var x0=vertices[index0];
		var x1=vertices[index1];
		var x2=vertices[index2];
		var y0=vertices[index0+1];
		var y1=vertices[index1+1];
		var y2=vertices[index2+1];
		var delta=(u0 *v1)+(v0 *u2)+(u1 *v2)-(v1 *u2)-(v0 *u1)-(u0 *v2);
		var dDelta=1 / delta;
		var deltaA=(x0 *v1)+(v0 *x2)+(x1 *v2)-(v1 *x2)-(v0 *x1)-(x0 *v2);
		var deltaB=(u0 *x1)+(x0 *u2)+(u1 *x2)-(x1 *u2)-(x0 *u1)-(u0 *x2);
		var deltaC=(u0 *v1 *x2)+(v0 *x1 *u2)+(x0 *u1 *v2)-(x0 *v1 *u2)-(v0 *u1 *x2)-(u0 *x1 *v2);
		var deltaD=(y0 *v1)+(v0 *y2)+(y1 *v2)-(v1 *y2)-(v0 *y1)-(y0 *v2);
		var deltaE=(u0 *y1)+(y0 *u2)+(u1 *y2)-(y1 *u2)-(y0 *u1)-(u0 *y2);
		var deltaF=(u0 *v1 *y2)+(v0 *y1 *u2)+(y0 *u1 *v2)-(y0 *v1 *u2)-(v0 *u1 *y2)-(u0 *y1 *v2);
		this.transformCmds[0]=deltaA *dDelta;
		this.transformCmds[1]=deltaD *dDelta;
		this.transformCmds[2]=deltaB *dDelta;
		this.transformCmds[3]=deltaE *dDelta;
		this.transformCmds[4]=deltaC *dDelta;
		this.transformCmds[5]=deltaF *dDelta;
		this.drawCmds[0]=textureSource;
		this.drawCmds[1]=texture.uv[0] *sourceWidth;
		this.drawCmds[2]=texture.uv[1] *sourceHeight;
		this.drawCmds[3]=textureWidth;
		this.drawCmds[4]=textureHeight;
		this.drawCmds[5]=texture.uv[0] *sourceWidth;
		this.drawCmds[6]=texture.uv[1] *sourceHeight;
		this.drawCmds[7]=textureWidth;
		this.drawCmds[8]=textureHeight;
		context.save();
		if (this.transform){
			var mt=this.transform;
			context.transform(mt.a,mt.b,mt.c,mt.d,mt.tx,mt.ty);
		}
		context.transform.apply(context,this.transformCmds);
		context.drawImage.apply(context,this.drawCmds);
		context.restore();
	}

	/**
	*绘制缓存的命令
	*@param mesh
	*
	*/
	__proto.renderByCache=function(mesh){
		var context=this.context;
		context.save();
		if (this.transform){
			var mt=this.transform;
			context.transform(mt.a,mt.b,mt.c,mt.d,mt.tx,mt.ty);
		}
		context.transform.apply(context,this.transformCmds);
		context.drawImage.apply(context,this.drawCmds);
		context.restore();
	}

	return SimpleSkinMeshCanvas;
})(SkinMeshCanvas)


//class laya.webgl.resource.RenderTarget2D extends laya.resource.Texture
var RenderTarget2D=(function(_super){
	function RenderTarget2D(width,height,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){
		this._type=0;
		this._svWidth=NaN;
		this._svHeight=NaN;
		this._preRenderTarget=null;
		//TODO:.........................................................
		this._alreadyResolved=false;
		this._looked=false;
		this._surfaceFormat=0;
		this._surfaceType=0;
		this._depthStencilFormat=0;
		this._mipMap=false;
		this._repeat=false;
		this._minFifter=0;
		this._magFifter=0;
		this._destroy=false;
		(surfaceFormat===void 0)&& (surfaceFormat=0x1908);
		(surfaceType===void 0)&& (surfaceType=0x1401);
		(depthStencilFormat===void 0)&& (depthStencilFormat=0x84F9);
		(mipMap===void 0)&& (mipMap=false);
		(repeat===void 0)&& (repeat=false);
		(minFifter===void 0)&& (minFifter=-1);
		(magFifter===void 0)&& (magFifter=-1);
		this._type=1;
		this._w=width;
		this._h=height;
		this._surfaceFormat=surfaceFormat;
		this._surfaceType=surfaceType;
		this._depthStencilFormat=depthStencilFormat;
		if (Render.isConchWebGL && this._depthStencilFormat===0x84F9){
			this._depthStencilFormat=0x81A5;
		}
		this._mipMap=mipMap;
		this._repeat=repeat;
		this._minFifter=minFifter;
		this._magFifter=magFifter;
		this._createWebGLRenderTarget();
		this.bitmap.lock=true;
		RenderTarget2D.__super.call(this,this.bitmap,Texture.INV_UV);
	}

	__class(RenderTarget2D,'laya.webgl.resource.RenderTarget2D',_super);
	var __proto=RenderTarget2D.prototype;
	Laya.imps(__proto,{"laya.resource.IDispose":true})
	//TODO:临时......................................................
	__proto.getType=function(){
		return this._type;
	}

	//*/
	__proto.getTexture=function(){
		return this;
	}

	__proto.size=function(w,h){
		if (this._w==w && this._h==h)return;
		this._w=w;
		this._h=h;
		this.release();
		if (this._w !=0 && this._h !=0)this._createWebGLRenderTarget();
	}

	__proto.release=function(){
		this.destroy();
	}

	__proto.recycle=function(){
		RenderTarget2D.POOL.push(this);
	}

	__proto.start=function(){
		var gl=WebGL.mainContext;
		this._preRenderTarget=RenderState2D.curRenderTarget;
		RenderState2D.curRenderTarget=this;
		gl.bindFramebuffer(0x8D40,this.bitmap.frameBuffer);
		this._alreadyResolved=false;
		if (this._type==1){
			gl.viewport(0,0,this._w,this._h);
			this._svWidth=RenderState2D.width;
			this._svHeight=RenderState2D.height;
			RenderState2D.width=this._w;
			RenderState2D.height=this._h;
			BaseShader.activeShader=null;
		}
		return this;
	}

	__proto.clear=function(r,g,b,a){
		(r===void 0)&& (r=0.0);
		(g===void 0)&& (g=0.0);
		(b===void 0)&& (b=0.0);
		(a===void 0)&& (a=1.0);
		var gl=WebGL.mainContext;
		gl.clearColor(r,g,b,a);
		var clearFlag=0x00004000;
		switch (this._depthStencilFormat){
			case 0x81A5:
				clearFlag |=0x00000100;
				break ;
			case 0x8D48:
				clearFlag |=0x00000400;
				break ;
			case 0x84F9:
				clearFlag |=0x00000100;
				clearFlag |=0x00000400
				break ;
			}
		gl.clear(clearFlag);
	}

	__proto.end=function(){
		var gl=WebGL.mainContext;
		gl.bindFramebuffer(0x8D40,this._preRenderTarget ? this._preRenderTarget.bitmap.frameBuffer :null);
		this._alreadyResolved=true;
		RenderState2D.curRenderTarget=this._preRenderTarget;
		if (this._type==1){
			gl.viewport(0,0,this._svWidth,this._svHeight);
			RenderState2D.width=this._svWidth;
			RenderState2D.height=this._svHeight;
			BaseShader.activeShader=null;
		}else gl.viewport(0,0,Laya.stage.width,Laya.stage.height);
	}

	__proto.getData=function(x,y,width,height){
		var gl=WebGL.mainContext;
		gl.bindFramebuffer(0x8D40,(this.bitmap).frameBuffer);
		var canRead=(gl.checkFramebufferStatus(0x8D40)===0x8CD5);
		if (!canRead){
			gl.bindFramebuffer(0x8D40,null);
			return null;
		};
		var pixels=new Uint8Array(this._w *this._h *4);
		gl.readPixels(x,y,width,height,this._surfaceFormat,this._surfaceType,pixels);
		gl.bindFramebuffer(0x8D40,null);
		return pixels;
	}

	/**彻底清理资源,注意会强制解锁清理*/
	__proto.destroy=function(foreDiposeTexture){
		(foreDiposeTexture===void 0)&& (foreDiposeTexture=false);
		if (!this._destroy){
			this._loaded=false;
			this.bitmap.offAll();
			this.bitmap.disposeResource();
			this.bitmap.dispose();
			this.offAll();
			this.bitmap=null;
			this._alreadyResolved=false;
			this._destroy=true;
			_super.prototype.destroy.call(this);
		}
	}

	//待测试
	__proto.dispose=function(){}
	__proto._createWebGLRenderTarget=function(){
		this.bitmap=new WebGLRenderTarget(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter);
		this.bitmap.activeResource();
		this._alreadyResolved=true;
		this._destroy=false;
		this._loaded=true;
		this.bitmap.on("recovered",this,function(e){
			this.event("recovered");
		})
	}

	__getset(0,__proto,'surfaceFormat',function(){
		return this._surfaceFormat;
	});

	__getset(0,__proto,'magFifter',function(){
		return this._magFifter;
	});

	__getset(0,__proto,'surfaceType',function(){
		return this._surfaceType;
	});

	__getset(0,__proto,'mipMap',function(){
		return this._mipMap;
	});

	__getset(0,__proto,'depthStencilFormat',function(){
		return this._depthStencilFormat;
	});

	//}
	__getset(0,__proto,'minFifter',function(){
		return this._minFifter;
	});

	/**返回RenderTarget的Texture*/
	__getset(0,__proto,'source',function(){
		if (this._alreadyResolved)
			return Laya.superGet(Texture,this,'source');
		return null;
	});

	RenderTarget2D.create=function(w,h,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){
		(surfaceFormat===void 0)&& (surfaceFormat=0x1908);
		(surfaceType===void 0)&& (surfaceType=0x1401);
		(depthStencilFormat===void 0)&& (depthStencilFormat=0x84F9);
		(mipMap===void 0)&& (mipMap=false);
		(repeat===void 0)&& (repeat=false);
		(minFifter===void 0)&& (minFifter=-1);
		(magFifter===void 0)&& (magFifter=-1);
		var t=RenderTarget2D.POOL.pop();
		t || (t=new RenderTarget2D(w,h));
		if (!t.bitmap || t._w !=w || t._h !=h || t._surfaceFormat !=surfaceFormat || t._surfaceType !=surfaceType || t._depthStencilFormat !=depthStencilFormat || t._mipMap !=mipMap || t._repeat !=repeat || t._minFifter !=minFifter || t._magFifter !=magFifter){
			t._w=w;
			t._h=h;
			t._surfaceFormat=surfaceFormat;
			t._surfaceType=surfaceType;
			t._depthStencilFormat=depthStencilFormat;
			if (Render.isConchWebGL && t._depthStencilFormat===0x84F9){
				t._depthStencilFormat=0x81A5;
			}
			t._mipMap=mipMap;
			t._repeat=repeat;
			t._minFifter=minFifter;
			t._magFifter=magFifter;
			t.release();
			t._createWebGLRenderTarget();
		}
		return t;
	}

	RenderTarget2D.TYPE2D=1;
	RenderTarget2D.TYPE3D=2;
	RenderTarget2D.POOL=[];
	return RenderTarget2D;
})(Texture)


/**
*@private
*/
//class laya.particle.ParticleTemplate2D extends laya.particle.ParticleTemplateWebGL
var ParticleTemplate2D=(function(_super){
	function ParticleTemplate2D(parSetting){
		this._vertexBuffer2D=null;
		this._indexBuffer2D=null;
		this.x=0;
		this.y=0;
		this._blendFn=null;
		this._startTime=0;
		this.sv=new ParticleShaderValue();
		ParticleTemplate2D.__super.call(this,parSetting);
		var _this=this;
		Laya.loader.load(this.settings.textureName,Handler.create(null,function(texture){
			(texture.bitmap).enableMerageInAtlas=false;
			_this.texture=texture;
		}));
		this.sv.u_Duration=this.settings.duration;
		this.sv.u_Gravity=this.settings.gravity;
		this.sv.u_EndVelocity=this.settings.endVelocity;
		this._blendFn=BlendMode.fns[parSetting.blendState];
		this.initialize();
		this._vertexBuffer=this._vertexBuffer2D=VertexBuffer2D.create(-1,0x88E8);
		this._indexBuffer=this._indexBuffer2D=IndexBuffer2D.create(0x88E4);
		this.loadContent();
	}

	__class(ParticleTemplate2D,'laya.particle.ParticleTemplate2D',_super);
	var __proto=ParticleTemplate2D.prototype;
	Laya.imps(__proto,{"laya.webgl.submit.ISubmit":true})
	__proto.getRenderType=function(){return-111}
	__proto.releaseRender=function(){}
	__proto.addParticleArray=function(position,velocity){
		position[0]+=this.x;
		position[1]+=this.y;
		_super.prototype.addParticleArray.call(this,position,velocity);
	}

	__proto.loadContent=function(){
		var indexes=new Uint16Array(this.settings.maxPartices *6);
		for (var i=0;i < this.settings.maxPartices;i++){
			indexes[i *6+0]=(i *4+0);
			indexes[i *6+1]=(i *4+1);
			indexes[i *6+2]=(i *4+2);
			indexes[i *6+3]=(i *4+0);
			indexes[i *6+4]=(i *4+2);
			indexes[i *6+5]=(i *4+3);
		}
		this._indexBuffer2D.clear();
		this._indexBuffer2D.append(indexes);
		this._indexBuffer2D.upload();
	}

	__proto.addNewParticlesToVertexBuffer=function(){
		this._vertexBuffer2D.clear();
		this._vertexBuffer2D.append(this._vertices);
		var start=0;
		if (this._firstNewElement < this._firstFreeElement){
			start=this._firstNewElement *4 *this._floatCountPerVertex *4;
			this._vertexBuffer2D.subUpload(start,start,start+(this._firstFreeElement-this._firstNewElement)*4 *this._floatCountPerVertex *4);
			}else {
			start=this._firstNewElement *4 *this._floatCountPerVertex *4;
			this._vertexBuffer2D.subUpload(start,start,start+(this.settings.maxPartices-this._firstNewElement)*4 *this._floatCountPerVertex *4);
			if (this._firstFreeElement > 0){
				this._vertexBuffer2D.setNeedUpload();
				this._vertexBuffer2D.subUpload(0,0,this._firstFreeElement *4 *this._floatCountPerVertex *4);
			}
		}
		this._firstNewElement=this._firstFreeElement;
	}

	__proto.renderSubmit=function(){
		if (this.texture&&this.texture.loaded){
			this.update(Laya.timer.delta);
			this.sv.u_CurrentTime=this._currentTime;
			if (this._firstNewElement !=this._firstFreeElement){
				this.addNewParticlesToVertexBuffer();
			}
			this.blend();
			if (this._firstActiveElement !=this._firstFreeElement){
				var gl=WebGL.mainContext;
				this._vertexBuffer2D.bind(this._indexBuffer2D);
				this.sv.u_texture=this.texture.source;
				this.sv.upload();
				if (this._firstActiveElement < this._firstFreeElement){
					WebGL.mainContext.drawElements(0x0004,(this._firstFreeElement-this._firstActiveElement)*6,0x1403,this._firstActiveElement *6 *2);
				}
				else{
					WebGL.mainContext.drawElements(0x0004,(this.settings.maxPartices-this._firstActiveElement)*6,0x1403,this._firstActiveElement *6 *2);
					if (this._firstFreeElement > 0)
						WebGL.mainContext.drawElements(0x0004,this._firstFreeElement *6,0x1403,0);
				}
				Stat.drawCall++;
			}
			this._drawCounter++;
		}
		return 1;
	}

	__proto.blend=function(){
		if (BlendMode.activeBlendFunction!==this._blendFn){
			var gl=WebGL.mainContext;
			gl.enable(0x0BE2);
			this._blendFn(gl);
			BlendMode.activeBlendFunction=this._blendFn;
		}
	}

	__proto.dispose=function(){
		this._vertexBuffer2D.dispose();
		this._indexBuffer2D.dispose();
	}

	ParticleTemplate2D.activeBlendType=-1;
	return ParticleTemplate2D;
})(ParticleTemplateWebGL)


/**
*@private
*/
//class laya.particle.shader.value.ParticleShaderValue extends laya.webgl.shader.d2.value.Value2D
var ParticleShaderValue=(function(_super){
	function ParticleShaderValue(){
		this.a_CornerTextureCoordinate=[4,0x1406,false,116,0];
		this.a_Position=[3,0x1406,false,116,16];
		this.a_Velocity=[3,0x1406,false,116,28];
		this.a_StartColor=[4,0x1406,false,116,40];
		this.a_EndColor=[4,0x1406,false,116,56];
		this.a_SizeRotation=[3,0x1406,false,116,72];
		this.a_Radius=[2,0x1406,false,116,84];
		this.a_Radian=[4,0x1406,false,116,92];
		this.a_AgeAddScale=[1,0x1406,false,116,108];
		this.a_Time=[1,0x1406,false,116,112];
		this.u_CurrentTime=NaN;
		this.u_Duration=NaN;
		this.u_Gravity=null;
		//v3
		this.u_EndVelocity=NaN;
		this.u_texture=null;
		ParticleShaderValue.__super.call(this,0,0);
	}

	__class(ParticleShaderValue,'laya.particle.shader.value.ParticleShaderValue',_super);
	var __proto=ParticleShaderValue.prototype;
	__proto.upload=function(){
		this.refresh();
		ParticleShaderValue.pShader.upload(this);
	}

	__static(ParticleShaderValue,
	['pShader',function(){return this.pShader=new ParticleShader();}
	]);
	return ParticleShaderValue;
})(Value2D)


//class laya.webgl.shader.d2.skinAnishader.SkinSV extends laya.webgl.shader.d2.value.Value2D
var SkinSV=(function(_super){
	function SkinSV(type){
		this.texcoord=null;
		this.offsetX=300;
		this.offsetY=0;
		SkinSV.__super.call(this,0x200,0);
		var _vlen=8 *CONST3D2D.BYTES_PE;
		this.position=[2,0x1406,false,_vlen,0];
		this.texcoord=[2,0x1406,false,_vlen,2 *CONST3D2D.BYTES_PE];
		this.color=[4,0x1406,false,_vlen,4 *CONST3D2D.BYTES_PE];
	}

	__class(SkinSV,'laya.webgl.shader.d2.skinAnishader.SkinSV',_super);
	return SkinSV;
})(Value2D)


//class laya.webgl.shader.d2.value.Color2dSV extends laya.webgl.shader.d2.value.Value2D
var Color2dSV=(function(_super){
	function Color2dSV(args){
		Color2dSV.__super.call(this,0x02,0);
		this.color=[];
	}

	__class(Color2dSV,'laya.webgl.shader.d2.value.Color2dSV',_super);
	var __proto=Color2dSV.prototype;
	__proto.setValue=function(value){
		value.fillStyle&&(this.color=value.fillStyle._color._color);
		value.strokeStyle&&(this.color=value.strokeStyle._color._color);
	}

	return Color2dSV;
})(Value2D)


//class laya.webgl.shader.d2.value.FillTextureSV extends laya.webgl.shader.d2.value.Value2D
var FillTextureSV=(function(_super){
	function FillTextureSV(type){
		this.u_colorMatrix=null;
		this.strength=0;
		this.colorMat=null;
		this.colorAlpha=null;
		this.u_TexRange=[0,1,0,1];
		this.u_offset=[0,0];
		this.texcoord=Value2D._TEXCOORD;
		FillTextureSV.__super.call(this,0x100,0);
	}

	__class(FillTextureSV,'laya.webgl.shader.d2.value.FillTextureSV',_super);
	var __proto=FillTextureSV.prototype;
	//this.color=[4,WebGLContext.FLOAT,false,_vlen,4 *CONST3D2D.BYTES_PE];
	__proto.setValue=function(vo){
		this.ALPHA=vo.ALPHA;
		vo.filters && this.setFilters(vo.filters);
	}

	__proto.clear=function(){
		this.texture=null;
		this.shader=null;
		this.defines.setValue(0);
	}

	return FillTextureSV;
})(Value2D)


//class laya.webgl.shader.d2.value.TextureSV extends laya.webgl.shader.d2.value.Value2D
var TextureSV=(function(_super){
	function TextureSV(subID){
		this.u_colorMatrix=null;
		this.strength=0;
		this.blurInfo=null;
		this.colorMat=null;
		this.colorAlpha=null;
		this.texcoord=Value2D._TEXCOORD;
		(subID===void 0)&& (subID=0);
		TextureSV.__super.call(this,0x01,subID);
	}

	__class(TextureSV,'laya.webgl.shader.d2.value.TextureSV',_super);
	var __proto=TextureSV.prototype;
	__proto.setValue=function(vo){
		this.ALPHA=vo.ALPHA;
		vo.filters && this.setFilters(vo.filters);
	}

	__proto.clear=function(){
		this.texture=null;
		this.shader=null;
		this.defines.setValue(0);
	}

	return TextureSV;
})(Value2D)


//class laya.webgl.shader.d2.value.PrimitiveSV extends laya.webgl.shader.d2.value.Value2D
var PrimitiveSV=(function(_super){
	function PrimitiveSV(args){
		this.a_color=null;
		this.u_pos=[0,0];
		PrimitiveSV.__super.call(this,0x04,0);
		this.position=[2,0x1406,false,5 *CONST3D2D.BYTES_PE,0];
		this.a_color=[3,0x1406,false,5 *CONST3D2D.BYTES_PE,2 *CONST3D2D.BYTES_PE];
	}

	__class(PrimitiveSV,'laya.webgl.shader.d2.value.PrimitiveSV',_super);
	return PrimitiveSV;
})(Value2D)


//class Baozha extends laya.display.Sprite
var Baozha=(function(_super){
	function Baozha(){
		this.mc=null;
		Baozha.__super.call(this);
	}

	__class(Baozha,'Baozha',_super);
	var __proto=Baozha.prototype;
	__proto.start=function(){
		this.addFun();
	}

	__proto.addFun=function(){
		this.mc=new DragonBonesMc(false);
		this.mc.playByTimes(1);
		this.mc.setUrl("res/load/baozha.sk");
		this.addChild(this.mc);
		this.mc.pos(-1,8);
		this.scaleX=2.48;
		this.scaleY=2.4;
	}

	__proto.stop=function(){
		if(this.mc)this.mc.removeSelf();
		Laya.timer.clear(this,this.addFun);
	}

	return Baozha;
})(Sprite)


//class game.base.Scene extends laya.display.Sprite
var Scene=(function(_super){
	function Scene(){
		this.resizeArr=[];
		Scene.__super.call(this);
		this.group=Math.random()+"";
	}

	__class(Scene,'game.base.Scene',_super);
	var __proto=Scene.prototype;
	/**
	*view需要有自己的大小
	*@param view
	*/
	__proto.setMainUI=function(view){
		this.addChild(view);
		this.size(Laya.stage.width,Laya.stage.height);
		view.centerX=0;
	}

	__proto.load=function(resType,url){
		App.layerManager.showLoadLayer(true);
		App.loaderManager.load(resType,url ,new Handler(this,this.comFun),new Handler(this,this.progressFun),null,1,true,this.group);
	}

	__proto.progressFun=function(value){
		App.eventManager.event("SCENE_LOAD_PROGRESS",value);
	}

	__proto.comFun=function(){
		App.layerManager.showLoadLayer(false);
		this.start();
	}

	/**
	*覆盖用的
	*/
	__proto.start=function(){}
	/**
	*点击就打开某个面板 一般都会用到的功能
	*@param btn
	*@param panel
	*/
	__proto.regClickDialog=function(btn,panel,haveBlackMask){
		(haveBlackMask===void 0)&& (haveBlackMask=false);
		btn.clickHandler=new Handler(this,this.openDialogFun,[panel,haveBlackMask]);
	}

	__proto.openDialogFun=function(panel,haveBlackMask){
		(haveBlackMask===void 0)&& (haveBlackMask=false);
		App.dialogManager.openDialogByStr(panel,null,true,haveBlackMask);
	}

	/**
	*设置后 当这个场景被移除时 加载的所有资源会被释放掉 典型比如登陆界面 创角界面等
	*你也可以在构造方法里自定义group
	*/
	__proto.setChangeClearRes=function(){
		this.on("removed",this,this.removeFun);
	}

	__proto.removeFun=function(){
		Laya.loader.clearResByGroup(this.group);
	}

	/**添加改变大小的监听 这个一般在页游里用到 */
	__proto.setAddResize=function(){
		Laya.stage.on("resize",this,this.resizeFun);
		this.on("undisplay",this,this.undisFun);
		this.resizeFun();
	}

	__proto.undisFun=function(){
		Laya.stage.off("resize",this,this.resizeFun);
	}

	__proto.resizeFun=function(){
		for (var i=0;i < this.resizeArr.length;i++){
			(this.resizeArr [i]).size(this.stage.width,this.stage.height);
		}
	}

	__proto.setResizeUI=function(sp){
		this.resizeArr.push(sp);
		Laya.timer.callLater(this,this.setAddResize);
	}

	return Scene;
})(Sprite)


/**
*<code>Component</code> 是ui控件类的基类。
*<p>生命周期：preinitialize > createChildren > initialize > 组件构造函数</p>
*/
//class laya.ui.Component extends laya.display.Sprite
var Component=(function(_super){
	function Component(){
		this._comXml=null;
		/**@private 控件的元数据。 */
		this._dataSource=null;
		/**@private 鼠标悬停提示 */
		this._toolTip=null;
		/**@private 标签 */
		this._tag=null;
		/**@private 禁用 */
		this._disabled=false;
		/**@private 变灰*/
		this._gray=false;
		/**
		*是否启用相对布局
		*/
		this.layoutEnabled=true;
		Component.__super.call(this);
		this._layout=LayoutStyle.EMPTY;
		this.preinitialize();
		this.createChildren();
		this.initialize();
	}

	__class(Component,'laya.ui.Component',_super);
	var __proto=Component.prototype;
	Laya.imps(__proto,{"laya.ui.IComponent":true})
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._dataSource=this._layout=null;
		this._tag=null;
		this._toolTip=null;
	}

	/**
	*<p>预初始化。</p>
	*@internal 子类可在此函数内设置、修改属性默认值
	*/
	__proto.preinitialize=function(){}
	/**
	*<p>创建并添加控件子节点。</p>
	*@internal 子类可在此函数内创建并添加子节点。
	*/
	__proto.createChildren=function(){}
	/**
	*<p>控件初始化。</p>
	*@internal 在此子对象已被创建，可以对子对象进行修改。
	*/
	__proto.initialize=function(){}
	/**
	*<p>延迟运行指定的函数。</p>
	*<p>在控件被显示在屏幕之前调用，一般用于延迟计算数据。</p>
	*@param method 要执行的函数的名称。例如，functionName。
	*@param args 传递给 <code>method</code> 函数的可选参数列表。
	*
	*@see #runCallLater()
	*/
	__proto.callLater=function(method,args){
		Laya.timer.callLater(this,method,args);
	}

	/**
	*<p>如果有需要延迟调用的函数（通过 <code>callLater</code> 函数设置），则立即执行延迟调用函数。</p>
	*@param method 要执行的函数名称。例如，functionName。
	*@see #callLater()
	*/
	__proto.runCallLater=function(method){
		Laya.timer.runCallLater(this,method);
	}

	/**
	*<p>立即执行影响宽高度量的延迟调用函数。</p>
	*@internal <p>使用 <code>runCallLater</code> 函数，立即执行影响宽高度量的延迟运行函数(使用 <code>callLater</code> 设置延迟执行函数)。</p>
	*@see #callLater()
	*@see #runCallLater()
	*/
	__proto.commitMeasure=function(){}
	/**
	*<p>重新调整对象的大小。</p>
	*/
	__proto.changeSize=function(){
		this.event("resize");
	}

	/**
	*@private
	*<p>获取对象的布局样式。</p>
	*/
	__proto.getLayout=function(){
		this._layout===LayoutStyle.EMPTY && (this._layout=new LayoutStyle());
		return this._layout;
	}

	/**
	*@private
	*<p>指定对象是否可使用布局。</p>
	*<p>如果值为true,则此对象可以使用布局样式，否则不使用布局样式。</p>
	*@param value 一个 Boolean 值，指定对象是否可使用布局。
	*/
	__proto._setLayoutEnabled=function(value){
		if (this._layout && this._layout.enable !=value){
			this._layout.enable=value;
			this.on("added",this,this.onAdded);
			this.on("removed",this,this.onRemoved);
			if (this.parent){
				this.onAdded();
			}
		}
	}

	/**
	*对象从显示列表移除的事件侦听处理函数。
	*/
	__proto.onRemoved=function(){
		this.parent.off("resize",this,this.onCompResize);
	}

	/**
	*对象被添加到显示列表的事件侦听处理函数。
	*/
	__proto.onAdded=function(){
		this.parent.on("resize",this,this.onCompResize);
		this.resetLayoutX();
		this.resetLayoutY();
	}

	/**
	*父容器的 <code>Event.RESIZE</code> 事件侦听处理函数。
	*/
	__proto.onCompResize=function(){
		if (this._layout && this._layout.enable){
			this.resetLayoutX();
			this.resetLayoutY();
		}
	}

	/**
	*<p>重置对象的 <code>X</code> 轴（水平方向）布局。</p>
	*/
	__proto.resetLayoutX=function(){
		var layout=this._layout;
		if (!isNaN(layout.anchorX))this.pivotX=layout.anchorX *this.width;
		if (!this.layoutEnabled)return;
		var parent=this.parent;
		if (parent){
			if (!isNaN(layout.centerX)){
				this.x=Math.round((parent.width-this.displayWidth)*0.5+layout.centerX+this.pivotX *this.scaleX);
				}else if (!isNaN(layout.left)){
				this.x=Math.round(layout.left+this.pivotX *this.scaleX);
				if (!isNaN(layout.right)){
					this.width=(parent._width-layout.left-layout.right)/ (this.scaleX || 0.01);
				}
				}else if (!isNaN(layout.right)){
				this.x=Math.round(parent.width-this.displayWidth-layout.right+this.pivotX *this.scaleX);
			}
		}
	}

	/**
	*<p>重置对象的 <code>Y</code> 轴（垂直方向）布局。</p>
	*/
	__proto.resetLayoutY=function(){
		var layout=this._layout;
		if (!isNaN(layout.anchorY))this.pivotY=layout.anchorY *this.height;
		if (!this.layoutEnabled)return;
		var parent=this.parent;
		if (parent){
			if (!isNaN(layout.centerY)){
				this.y=Math.round((parent.height-this.displayHeight)*0.5+layout.centerY+this.pivotY *this.scaleY);
				}else if (!isNaN(layout.top)){
				this.y=Math.round(layout.top+this.pivotY *this.scaleY);
				if (!isNaN(layout.bottom)){
					this.height=(parent._height-layout.top-layout.bottom)/ (this.scaleY || 0.01);
				}
				}else if (!isNaN(layout.bottom)){
				this.y=Math.round(parent.height-this.displayHeight-layout.bottom+this.pivotY *this.scaleY);
			}
		}
	}

	/**
	*对象的 <code>Event.MOUSE_OVER</code> 事件侦听处理函数。
	*/
	__proto.onMouseOver=function(e){
		Laya.stage.event("showtip",this._toolTip);
	}

	/**
	*对象的 <code>Event.MOUSE_OUT</code> 事件侦听处理函数。
	*/
	__proto.onMouseOut=function(e){
		Laya.stage.event("hidetip",this._toolTip);
	}

	/**
	*<p>对象的显示宽度（以像素为单位）。</p>
	*/
	__getset(0,__proto,'displayWidth',function(){
		return this.width *this.scaleX;
	});

	/**
	*<p>表示显示对象的宽度，以像素为单位。</p>
	*<p><b>注：</b>当值为0时，宽度为自适应大小。</p>
	*/
	__getset(0,__proto,'width',function(){
		if (this._width)return this._width;
		return this.measureWidth;
		},function(value){
		if (this._width !=value){
			this._width=value;
			this.conchModel && this.conchModel.size(this._width,this._height);
			this.callLater(this.changeSize);
			if (this._layout.enable && (!isNaN(this._layout.centerX)|| !isNaN(this._layout.right)|| !isNaN(this._layout.anchorX)))this.resetLayoutX();
		}
	});

	/**
	*<p>显示对象的实际显示区域宽度（以像素为单位）。</p>
	*/
	__getset(0,__proto,'measureWidth',function(){
		var max=0;
		this.commitMeasure();
		for (var i=this.numChildren-1;i >-1;i--){
			var comp=this.getChildAt(i);
			if (comp.visible){
				max=Math.max(comp.x+comp.width *comp.scaleX,max);
			}
		}
		return max;
	});

	/**
	*<p>对象的显示高度（以像素为单位）。</p>
	*/
	__getset(0,__proto,'displayHeight',function(){
		return this.height *this.scaleY;
	});

	/**
	*<p>表示显示对象的高度，以像素为单位。</p>
	*<p><b>注：</b>当值为0时，高度为自适应大小。</p>
	*/
	__getset(0,__proto,'height',function(){
		if (this._height)return this._height;
		return this.measureHeight;
		},function(value){
		if (this._height !=value){
			this._height=value;
			this.conchModel && this.conchModel.size(this._width,this._height);
			this.callLater(this.changeSize);
			if (this._layout.enable && (!isNaN(this._layout.centerY)|| !isNaN(this._layout.bottom)|| !isNaN(this._layout.anchorY)))this.resetLayoutY();
		}
	});

	/**
	*<p>数据赋值，通过对UI赋值来控制UI显示逻辑。</p>
	*<p>简单赋值会更改组件的默认属性，使用大括号可以指定组件的任意属性进行赋值。</p>
	*@example
	//默认属性赋值
	dataSource={label1:"改变了label",checkbox1:true};//(更改了label1的text属性值，更改checkbox1的selected属性)。
	//任意属性赋值
	dataSource={label2:{text:"改变了label",size:14},checkbox2:{selected:true,x:10}};
	*/
	__getset(0,__proto,'dataSource',function(){
		return this._dataSource;
		},function(value){
		this._dataSource=value;
		for (var prop in this._dataSource){
			if (this.hasOwnProperty(prop)&& !((typeof (this[prop])=='function'))){
				this[prop]=this._dataSource[prop];
			}
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'scaleY',_super.prototype._$get_scaleY,function(value){
		if (Laya.superGet(Sprite,this,'scaleY')!=value){
			Laya.superSet(Sprite,this,'scaleY',value);
			this.callLater(this.changeSize);
			this._layout.enable && this.resetLayoutY();
		}
	});

	/**
	*<p>显示对象的实际显示区域高度（以像素为单位）。</p>
	*/
	__getset(0,__proto,'measureHeight',function(){
		var max=0;
		this.commitMeasure();
		for (var i=this.numChildren-1;i >-1;i--){
			var comp=this.getChildAt(i);
			if (comp.visible){
				max=Math.max(comp.y+comp.height *comp.scaleY,max);
			}
		}
		return max;
	});

	/**@inheritDoc */
	__getset(0,__proto,'scaleX',_super.prototype._$get_scaleX,function(value){
		if (Laya.superGet(Sprite,this,'scaleX')!=value){
			Laya.superSet(Sprite,this,'scaleX',value);
			this.callLater(this.changeSize);
			this._layout.enable && this.resetLayoutX();
		}
	});

	/**
	*<p>从组件顶边到其内容区域顶边之间的垂直距离（以像素为单位）。</p>
	*/
	__getset(0,__proto,'top',function(){
		return this._layout.top;
		},function(value){
		if (value !=this._layout.top){
			this.getLayout().top=value;
			this._setLayoutEnabled(true);
		}
		this.resetLayoutY();
	});

	/**
	*<p>从组件底边到其内容区域底边之间的垂直距离（以像素为单位）。</p>
	*/
	__getset(0,__proto,'bottom',function(){
		return this._layout.bottom;
		},function(value){
		if (value !=this._layout.bottom){
			this.getLayout().bottom=value;
			this._setLayoutEnabled(true);
		}
		this.resetLayoutY();
	});

	/**
	*<p>从组件左边到其内容区域左边之间的水平距离（以像素为单位）。</p>
	*/
	__getset(0,__proto,'left',function(){
		return this._layout.left;
		},function(value){
		if (value !=this._layout.left){
			this.getLayout().left=value;
			this._setLayoutEnabled(true);
		}
		this.resetLayoutX();
	});

	/**
	*<p>从组件右边到其内容区域右边之间的水平距离（以像素为单位）。</p>
	*/
	__getset(0,__proto,'right',function(){
		return this._layout.right;
		},function(value){
		if (value !=this._layout.right){
			this.getLayout().right=value;
			this._setLayoutEnabled(true);
		}
		this.resetLayoutX();
	});

	/**
	*<p>在父容器中，此对象的水平方向中轴线与父容器的水平方向中心线的距离（以像素为单位）。</p>
	*/
	__getset(0,__proto,'centerX',function(){
		return this._layout.centerX;
		},function(value){
		if (value !=this._layout.centerX){
			this.getLayout().centerX=value;
			this._setLayoutEnabled(true);
		}
		this.resetLayoutX();
	});

	/**
	*<p>在父容器中，此对象的垂直方向中轴线与父容器的垂直方向中心线的距离（以像素为单位）。</p>
	*/
	__getset(0,__proto,'centerY',function(){
		return this._layout.centerY;
		},function(value){
		if (value !=this._layout.centerY){
			this.getLayout().centerY=value;
			this._setLayoutEnabled(true);
		}
		this.resetLayoutY();
	});

	/**X轴锚点，值为0-1*/
	__getset(0,__proto,'anchorX',function(){
		return this._layout.anchorX;
		},function(value){
		if (value !=this._layout.anchorX){
			this.getLayout().anchorX=value;
			this._setLayoutEnabled(true);
		}
		this.resetLayoutX();
	});

	/**Y轴锚点，值为0-1*/
	__getset(0,__proto,'anchorY',function(){
		return this._layout.anchorY;
		},function(value){
		if (value !=this._layout.anchorY){
			this.getLayout().anchorY=value;
			this._setLayoutEnabled(true);
		}
		this.resetLayoutY();
	});

	/**
	*<p>对象的标签。</p>
	*@internal 冗余字段，可以用来储存数据。
	*/
	__getset(0,__proto,'tag',function(){
		return this._tag;
		},function(value){
		this._tag=value;
	});

	/**
	*<p>鼠标悬停提示。</p>
	*<p>可以赋值为文本 <code>String</code> 或函数 <code>Handler</code> ，用来实现自定义样式的鼠标提示和参数携带等。</p>
	*@example
	*private var _testTips:TestTipsUI=new TestTipsUI();
	*private function testTips():void {
		//简单鼠标提示
		*btn2.toolTip="这里是鼠标提示&lt;b&gt;粗体&lt;/b&gt;&lt;br&gt;换行";
		//自定义的鼠标提示
		*btn1.toolTip=showTips1;
		//带参数的自定义鼠标提示
		*clip.toolTip=new Handler(this,showTips2,["clip"]);
		*}
	*private function showTips1():void {
		*_testTips.label.text="这里是按钮["+btn1.label+"]";
		*tip.addChild(_testTips);
		*}
	*private function showTips2(name:String):void {
		*_testTips.label.text="这里是"+name;
		*tip.addChild(_testTips);
		*}
	*/
	__getset(0,__proto,'toolTip',function(){
		return this._toolTip;
		},function(value){
		if (this._toolTip !=value){
			this._toolTip=value;
			if (value !=null){
				this.on("mouseover",this,this.onMouseOver);
				this.on("mouseout",this,this.onMouseOut);
				}else {
				this.off("mouseover",this,this.onMouseOver);
				this.off("mouseout",this,this.onMouseOut);
			}
		}
	});

	/**
	*XML 数据。
	*/
	__getset(0,__proto,'comXml',function(){
		return this._comXml;
		},function(value){
		this._comXml=value;
	});

	/**是否变灰。*/
	__getset(0,__proto,'gray',function(){
		return this._gray;
		},function(value){
		if (value!==this._gray){
			this._gray=value;
			UIUtils.gray(this,value);
		}
	});

	/**是否禁用页面，设置为true后，会变灰并且禁用鼠标。*/
	__getset(0,__proto,'disabled',function(){
		return this._disabled;
		},function(value){
		if (value!==this._disabled){
			this.gray=this._disabled=value;
			this.mouseEnabled=!value;
		}
	});

	return Component;
})(Sprite)


//class fight.BattleHeroDpo extends laya.display.Sprite
var BattleHeroDpo=(function(_super){
	function BattleHeroDpo(){
		this.arr=[];
		this.bl=null;
		this.spStat=null;
		this.dir=0;
		this.x1=0;
		this.y1=0;
		this.heroModel=null;
		this.bloodBar=null;
		this.maxHp=0;
		this.nowHp=0;
		this.data=null;
		this._myZorder=0;
		this.bloodUI=null;
		this.scaleManager=null;
		BattleHeroDpo.__super.call(this);
		this.buffSp=new Sprite();
		if(BattleFileScene.instance){
			this.scaleManager=BattleFileScene.instance.scaleManager;
		}
	}

	__class(BattleHeroDpo,'fight.BattleHeroDpo',_super);
	var __proto=BattleHeroDpo.prototype;
	Laya.imps(__proto,{"fight.IBattleDpo":true})
	__proto.setAll=function(modelId,disUI,dir,blood,anger,checkHouZhui){
		(blood===void 0)&& (blood=true);
		(anger===void 0)&& (anger=true);
		(checkHouZhui===void 0)&& (checkHouZhui=false);
		this.dir=dir;
		if(this.heroModel==null){
			this.heroModel=new HeroModel();
		};
		var hou="";
		if(checkHouZhui){
			hou=((dir==0)?"_":"");
		}
		this.heroModel.setModelId(modelId,disUI+hou);
		this.heroModel.setDir(dir);
		this.addChild(this.heroModel);
		if(blood){
			this.bloodUI=new bloodSeatUI();
			this.bloodBar=new ScrollRectProgressBar(this.bloodUI.blood.hongtiao);
			this.bl=this.bloodUI.blood;
			this.addChild(this.bloodUI);
			var angerArr=[this.bloodUI.h1,this.bloodUI.h2,this.bloodUI.h3,this.bloodUI.h4,this.bloodUI.h5];
			if(anger){
				this.spStat=new SpStat();
				this.spStat.setBtnArr(angerArr);
				}else{
				for (var i=0;i < angerArr.length;i++){
					angerArr[i].visible=false;
				}
			}
		}
		this.addChild(this.buffSp);
	}

	__proto.setPo=function(s,x1,y1){
		s.pos(Math.sin(Math.PI *60 / 180)*(x1-y1),Math.cos(Math.PI *60 / 180)*(x1+y1));
	}

	__proto.attack=function(){
		this.heroModel.attack();
	}

	__proto.move=function(){
		this.heroModel.move();
	}

	__proto.stand=function(){
		this.heroModel.stand();
	}

	__proto.hit=function(){
		this.heroModel.hit();
	}

	__proto.die=function(){
		this.heroModel.die();
	}

	__proto.discharge=function(){
		this.heroModel.discharge();
	}

	__proto.setBattleInitData=function(data){
		var sysf=ConfigManager.getConfig("sys_force.txt",data.type);
		this.setAll(sysf.forceResource ,sysf.forceResource,((data.index >=6)?1:0),true,true,true);
		this.data=data;
		this.maxHp=data.maxHp;
		var sys=ConfigManager.getConfig("sys_hero.txt",data.heroId);
		var skill=ConfigManager.getConfig("sys_skill.txt",sys.heroDefaultSkill);
		this.bl.name0.text="LV"+data.heroLv+" "+sys.heroName;
		this.bl.name0.color=this.getHeroNameColor(sys.heroColor);
		this.setHp(data.hp);
		if(this.spStat){
			this.spStat.setMaxBtn(skill.skillRage);
			this.setAnger(data.anger);
		}
		for (var i=0;i < data.bufferIdArr.length;i++){
			this.addBuffer(data.bufferIdArr[i]);
		}
		this.stand();
	}

	__proto.setHero=function(heroData,heroModel){
		(heroModel===void 0)&& (heroModel=1);
		var sysf=ConfigManager.getConfig("sys_force.txt",heroData.soldierType);
		this.setAll(sysf.forceResource ,sysf.forceResource,heroModel,false,false,true);
		this.stand();
	}

	__proto.getHeroNameColor=function(quality){
		switch(quality){
			case MyGameConst.COLOR_GREEN:
				return "#00fc00";
			case MyGameConst.COLOR_BLUE:
				return "#017bf8";
			case MyGameConst.COLOR_PURPLE:
				return "#ae20ff";
			case MyGameConst.COLOR_YELLOW:
				return "#f56e01";
			}
		return "#ffffff";
	}

	__proto.setAnger=function(value){
		this.spStat.setBtnNow(value);
	}

	__proto.setHp=function(nowHp){
		this.nowHp=nowHp;
		this.bloodBar.setValue(nowHp / this.maxHp);
		this.bl.txt0.text=nowHp+"/"+this.maxHp;
		if(nowHp==0){
			if(!Laya.stage.isVisibility){
				this.dieOverFun();
				return;
			}
			if(this.heroModel.nowAction=="Hurt"){
				this.heroModel.setComHandler(new Handler(this,this.dieMc));
				}else{
				this.dieOverFun();
			}
		}
	}

	__proto.dieMc=function(){
		this.die();
		this.heroModel.setComHandler(new Handler(this,this.dieOverFun));
	}

	__proto.dieOverFun=function(){
		this.removeSelf();
	}

	__proto.hitEffectSkillId=function(skillId){
		this.hit();
		this.setFilter(BattleHeroDpo.RED_FILTER);
		this.scaleManager.addTimer(100,this,this.colorFun);
		var sysSkill=ConfigManager.getConfig("sys_skill.txt",skillId);
		var sysSkillEffect=ConfigManager.getConfig("sys_skill_effect.txt",sysSkill.skillEffect);
		if(sysSkillEffect.hit==0){
			this.addEffectByAni(sysSkillEffect.effectAni);
			}else{
			var sysSkillEffect2=ConfigManager.getConfig("sys_skill_effect.txt",sysSkillEffect.hit);
			this.addEffectByAni(sysSkillEffect2.effectAni);
		}
		if(sysSkill.shake==0){
			Shake.shakeByUI(BattleFileScene.instance.shakeLayer);
		}
	}

	__proto.colorFun=function(){
		this.setFilter(BattleHeroDpo.NORMAL_FILTER);
	}

	__proto.setFilter=function(arr){
		this.heroModel.filters=arr;
	}

	__proto.zTop=function(){
		this._myZorder=this.zOrder;
		this.zOrder=this._myZorder+10;
	}

	__proto.zBack=function(){
		this.zOrder=this._myZorder;
	}

	/**挨打的主体 */
	__proto.getDpo=function(){
		return this;
	}

	__proto.getDir=function(){
		return this.dir;
	}

	/**射谁 */
	__proto.shoot=function(def,time,skillId,layer){
		this.scaleManager.addTimer(500 ,this,this.flyFun);
	}

	__proto.flyFun=function(){
		this.attack();
	}

	/**
	*显示一个buff 会循环播放动画
	*@param bufferId
	*/
	__proto.addBuffer=function(bufferId,flash){
		(flash===void 0)&& (flash=false);
		var bufferDpo=new BufferDpo();
		if(flash){
			bufferDpo.autoRemove=true;
			}else{
			bufferDpo.name="buff_"+bufferId;
		}
		bufferDpo.setBufferId(bufferId);
		this.buffSp.addChild(bufferDpo);
	}

	__proto.removeBuffer=function(bufferId){
		var node=this.buffSp.getChildByName("buff_"+bufferId);
		if(node){
			node.removeSelf();
		}
	}

	/**
	*显示一个effect 只会播放一次
	*/
	__proto.addEffect=function(skillId){
		var hitEffectDpo=new HitEffectDpo();
		hitEffectDpo.setSkillId(skillId);
		this.addChild(hitEffectDpo);
	}

	__proto.addEffectByAni=function(ani){
		var hitEffectDpo=new HitEffectDpo();
		hitEffectDpo.addEffectAni(ani);
		this.addChild(hitEffectDpo);
	}

	/**
	*在身上播放技能
	*/
	__proto.addSkillEffect=function(skillId){
		var skillDpo=new SkillDpo();
		skillDpo.setSkillId(skillId);
		this.addChild(skillDpo);
	}

	BattleHeroDpo.NORMAL_FILTER=[];
	__static(BattleHeroDpo,
	['RED_FILTER',function(){return this.RED_FILTER=[new ColorFilter([
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,1,0,])];}
	]);
	return BattleHeroDpo;
})(Sprite)


//class fight.BufferDpo extends laya.display.Sprite
var BufferDpo=(function(_super){
	function BufferDpo(){
		this.autoRemove=false;
		BufferDpo.__super.call(this);
	}

	__class(BufferDpo,'fight.BufferDpo',_super);
	var __proto=BufferDpo.prototype;
	__proto.setBufferId=function(bufferId){
		var sysBuff=ConfigManager.getConfig("sys_buff.txt",bufferId);
		var sysSkillEffect=ConfigManager.getConfig("sys_skill_effect.txt",sysBuff.buffEffect);
		if(sysSkillEffect==null){
			return;
		}
		this.setEffectAni(sysSkillEffect.effectAni);
	}

	__proto.setEffectAni=function(str){
		var resName=BufferDpo.getResName(str);
		App.loaderManager.load("BUFFER",resName,new Handler(this,this.loadOverFun,[str]));
	}

	__proto.loadOverFun=function(str){
		var view=ClassUtils.getInstance(str);
		this.addChild(view);
		var ani=view.getChildAt(0);
		if(this.autoRemove){
			ani.once("complete",this,this.comFun);
			ani.play(0,false);
			}else{
			ani.play();
		}
	}

	__proto.comFun=function(){
		this.removeSelf();
	}

	BufferDpo.getResName=function(effectAni){
		var resName=effectAni.replace("buffSeat","");
		if(resName.length==1){
			resName="0"+resName;
		}
		return "buff_"+resName+".atlas";
	}

	return BufferDpo;
})(Sprite)


//class fight.HeroModel extends laya.display.Sprite
var HeroModel=(function(_super){
	function HeroModel(){
		this.disUI=null;
		this.titleName=null;
		this.modelId=null;
		this.nowAction=null;
		this.loop=false;
		this.dis=null;
		//这里有可能会给com赋值 所以
		this.completeHandler=null;
		HeroModel.__super.call(this);
	}

	__class(HeroModel,'fight.HeroModel',_super);
	var __proto=HeroModel.prototype;
	/**
	*@param modelId 资源id
	*@param dis 显示的ui
	*/
	__proto.setModelId=function(modelId,dis){
		this.dis=dis;
		this.modelId=modelId;
		this.loadOverFun();
	}

	//App.loaderManager.load(MyGameInit.BATTLE_CLIP,modelId+".atlas",new Handler(this,loadOverFun));
	__proto.loadOverFun=function(){
		this.removeChildren();
		this.disUI=ClassUtils.getInstance(this.dis);
		this.addChild(this.disUI);
	}

	/**
	*@param dir 朝向
	*/
	__proto.setDir=function(dir){
		this.titleName=((dir==1)?("right"):("left"));
	}

	__proto.playAction=function(action){
		this.nowAction=action;
		if(this.disUI==null){
			return;
		}
		for (var i=0;i < this.disUI.numChildren;i++){
			var animation=this.disUI.getChildAt(i);
			var haveCom=HeroModel.ACTION_MAP[action];
			animation.play(0,haveCom==null,this.titleName+action);
			if(i==0){
				if(haveCom){
					animation.once("complete",this,this.comHandler);
				}
			}
		}
	}

	__proto.move=function(){
		this.playAction("Move");
	}

	__proto.stand=function(){
		this.playAction("Wait");
	}

	__proto.attack=function(){
		this.playAction("Attack");
		this.setComHandler(new Handler(this,this.stand));
	}

	__proto.hit=function(){
		this.playAction("Hurt");
		this.setComHandler(new Handler(this,this.stand));
	}

	__proto.die=function(){
		this.playAction("Dead");
	}

	/**施法动作 */
	__proto.discharge=function(){
		this.playAction("Discharge");
		this.setComHandler(new Handler(this,this.stand));
	}

	__proto.comHandler=function(){
		if(this.completeHandler){
			var copy=this.completeHandler;
			this.completeHandler=null;
			copy.run();
		}
	}

	__proto.setComHandler=function(com){
		this.completeHandler=com;
	}

	HeroModel.LEFT=0;
	HeroModel.RIGHT=1;
	HeroModel.HURT="Hurt";
	HeroModel.ATTACK="Attack";
	HeroModel.DISCHARGE="Discharge";
	HeroModel.DIE="Dead";
	__static(HeroModel,
	['ACTION_MAP',function(){return this.ACTION_MAP={"Attack":1,"Hurt":1,"Discharge":1,"Dead":1};}
	]);
	return HeroModel;
})(Sprite)


//class fight.HitEffectDpo extends laya.display.Sprite
var HitEffectDpo=(function(_super){
	function HitEffectDpo(){
		this.ani=null;
		HitEffectDpo.__super.call(this);
	}

	__class(HitEffectDpo,'fight.HitEffectDpo',_super);
	var __proto=HitEffectDpo.prototype;
	__proto.setSkillId=function(skillId){
		var sysSkill=ConfigManager.getConfig("sys_skill.txt",skillId);
		var sysSkillEffect=ConfigManager.getConfig("sys_skill_effect.txt",sysSkill.skillEffect);
		this.addEffectAni(sysSkillEffect.effectAni);
	}

	__proto.addEffectAni=function(ani){
		this.ani=ani;
		App.loaderManager.load("BUFFER",ani+".atlas",new Handler(this,this.comFun));
	}

	__proto.comFun=function(){
		var view=ClassUtils.getInstance(this.ani);
		var animation=view.getChildAt(0);
		animation.play();
		animation.on("complete",this,this.effectOverFun);
		this.addChild(view);
	}

	__proto.effectOverFun=function(){
		this.removeSelf();
	}

	return HitEffectDpo;
})(Sprite)


//class fight.SkillDpo extends laya.display.Sprite
var SkillDpo=(function(_super){
	function SkillDpo(){
		/**
		*className
		*/
		this.ani=null;
		SkillDpo.__super.call(this);
	}

	__class(SkillDpo,'fight.SkillDpo',_super);
	var __proto=SkillDpo.prototype;
	__proto.setSkillId=function(skillId){
		var sys=SkillDpo.getSysSkillEffect(skillId);
		this.addEffectAni(sys.effectAni,sys.effectRes);
	}

	__proto.addEffectAni=function(ani,res){
		this.ani=ani;
		App.loaderManager.load("SKILL",res+".atlas",new Handler(this,this.comFun));
	}

	__proto.comFun=function(){
		var view=ClassUtils.getInstance(this.ani);
		var animation=view.getChildAt(0);
		animation.interval=animation.interval/ScaleManager.nowSpeedScale;
		animation.interval=1000/24;
		animation.play(0,false);
		animation.on("complete",this,this.effectOverFun);
		this.addChild(view);
	}

	__proto.effectOverFun=function(){
		this.removeSelf();
	}

	SkillDpo.getSkillResUrl=function(skillId){
		var sys=SkillDpo.getSysSkillEffect(skillId);
		if(sys==null){
			return null;
		}
		return sys.effectRes+".atlas";
	}

	SkillDpo.getSysSkillEffect=function(skillId){
		var sysSkill=ConfigManager.getConfig("sys_skill.txt",skillId);
		var sysSkillEffect=ConfigManager.getConfig("sys_skill_effect.txt",sysSkill.skillEffect);
		return sysSkillEffect;
	}

	return SkillDpo;
})(Sprite)


/**
*这个类的大小永远和stage一样
*/
//class game.base.display.StageSprite extends laya.display.Sprite
var StageSprite=(function(_super){
	function StageSprite(){
		StageSprite.__super.call(this);
		this.on("undisplay",this,this.undisFun);
		this.on("display",this,this.disFun);
		this.resizeFun();
	}

	__class(StageSprite,'game.base.display.StageSprite',_super);
	var __proto=StageSprite.prototype;
	__proto.disFun=function(){
		this.stage.on("resize",this,this.resizeFun);
	}

	__proto.undisFun=function(){
		this.stage.off("resize",this,this.resizeFun);
	}

	__proto.resizeFun=function(){
		this.size(this.stage.width,this.stage.height);
		this.resize();
	}

	__proto.resize=function(){}
	return StageSprite;
})(Sprite)


//class game.base.display.DragonBonesMc extends laya.display.Sprite
var DragonBonesMc=(function(_super){
	function DragonBonesMc(usePool,isBlendMode){
		this.url=null;
		this.sk=null;
		this.playTimes=0;
		this.nowTimes=0;
		this.usePool=false;
		this.isClear=false;
		this.overClear=true;
		this.autoClear=true;
		this.backRate=1;
		DragonBonesMc.__super.call(this);
		(isBlendMode===void 0)&& (isBlendMode=true);
		if(isBlendMode)this.blendMode="lighter";
		this.usePool=usePool;
		this.on("removed",this,this.removeFun);
	}

	__class(DragonBonesMc,'game.base.display.DragonBonesMc',_super);
	var __proto=DragonBonesMc.prototype;
	__proto.removeFun=function(){
		if(this.autoClear==false){
			return;
		}
		this.clear();
	}

	__proto.setUrl=function(url){
		this.url=url;
		this.resetSk();
	}

	/**
	*根据次数播放
	*@param playTimes
	*/
	__proto.playByTimes=function(playTimes,overClear){
		(overClear===void 0)&& (overClear=true);
		this.overClear=overClear;
		this.playTimes=playTimes;
		this.nowTimes=0;
	}

	/**
	*根据结束时间播放
	*@param endTime
	*/
	__proto.playByEndTime=function(endTime){
		this.nowTimes=0;
		Laya.timer.once(endTime-App.getServerTime(),this,this.timeFun);
	}

	/**
	*设置动画播放速率
	*@param value 1为标准速率
	*/
	__proto.playbackRate=function(num){
		this.backRate=num;
	}

	__proto.resetSk=function(){
		var sk=App.dragonBonesManager.getSkeleton(this.url);
		if(sk==null){
			App.dragonBonesManager.load(this.url);
			App.dragonBonesManager.on("DB_LOAD_OVER",this,this.loadOver);
			}else{
			sk.playbackRate(this.backRate);
			this.setSk(sk);
		}
	}

	__proto.loadOver=function(url){
		if(this.url==url){
			App.dragonBonesManager.off("DB_LOAD_OVER",this,this.loadOver);
			this.resetSk();
		}
	}

	__proto.timeFun=function(){
		this.clear();
	}

	__proto.setSk=function(sk){
		this.sk=sk;
		if(this.playTimes > 0){
			sk.on("stopped",this,this.stopHandler);
			sk.play(0,false);
			}else{
			sk.play(0,true);
		}
		this.addChild(sk);
	}

	__proto.play=function(){
		if(this.sk !=null){
			this.sk.play(0,true);
		}
	}

	__proto.stopHandler=function(){
		this.nowTimes++;
		if(this.nowTimes >=this.playTimes){
			this.sk.off("stopped",this,this.stopHandler);
			this.event("stopped");
			if(this.overClear){
				this.clear();
			}
			}else{
			this.sk.play(0,false);
		}
	}

	__proto.clear=function(){
		if(this.isClear){
			return;
		}
		this.isClear=true;
		this.removeSelf();
		if(this.sk){
			this.sk.stop();
		}
		if(this.usePool){
			Pool.recover(this.url,this);
			}else {
			this.destroy();
		}
	}

	__proto.dispose=function(){
		if(this.sk){
			Loader.clearRes(this.sk.templet["_skBufferUrl"]);
			this.sk.templet.dispose();
		}
	}

	return DragonBonesMc;
})(Sprite)


//class game.base.display.DragonMc extends laya.display.Sprite
var DragonMc=(function(_super){
	function DragonMc(){
		this.templet=null;
		this.sk=null;
		this.playTime=0;
		DragonMc.__super.call(this);
	}

	__class(DragonMc,'game.base.display.DragonMc',_super);
	var __proto=DragonMc.prototype;
	__proto.setUrl=function(url,playTime){
		(playTime===void 0)&& (playTime=0);
		this.playTime=playTime;
		this.templet=new Templet();
		this.templet.on("complete",this,this.comFun);
		this.templet.loadAni(url);
	}

	__proto.comFun=function(){
		this.sk=this.templet.buildArmature(0);
		this.addChild(this.sk);
		if(this.playTime==0){
			this.sk.play(0,true);
			}else{
			this.sk.play(0,false);
			this.sk.on("stopped",this,this.stopHandler);
		}
	}

	__proto.stopHandler=function(){
		this.removeSelf();
	}

	__proto.dispose=function(){
		if(this.sk){
			Loader.clearRes(this.templet["_skBufferUrl"]);
			this.templet.dispose();
		}
	}

	return DragonMc;
})(Sprite)


/**
*
*@author chengxu03
*
*/
//class game.base.display.FontSprite extends laya.display.Sprite
var FontSprite=(function(_super){
	function FontSprite(){
		this.imgArr=[];
		this.flyY=0;
		this.flyTime=0;
		this.offset=0;
		FontSprite.__super.call(this);
		this.titleImage=new Image();
		this.fontSp=new Sprite();
		this.po=new Point();
		this.addChild(this.titleImage);
		for (var i=0;i < 10;i++){
			var img=new Image();
			this.imgArr.push(img);
			this.fontSp.addChild(img);
			img.visible=false;
		}
		this.titleImage.anchorX=1;
		this.addChild(this.fontSp);
	}

	__class(FontSprite,'game.base.display.FontSprite',_super);
	var __proto=FontSprite.prototype;
	/**
	*
	*@param pngType-1代表没有
	*@param value
	*@param fontStr
	*
	*/
	__proto.setValue=function(pngType,value,fontType,flyY,flyTime){
		(flyY===void 0)&& (flyY=100);
		(flyTime===void 0)&& (flyTime=700);
		this.flyY=flyY;
		this.flyTime=flyTime;
		if(pngType==-1){
			this.titleImage.skin=null;
			}else{
			this.titleImage.skin=App.pngManager.getUrl(pngType);
		}
		value=Math.abs(parseInt(value+""));
		for (var j=0;j < this.imgArr.length;j++){
			(this.imgArr [j]).visible=false;
		}
		if(value==0){
			return;
		};
		var str=value+"";
		for (var i=0;i < str.length;i++){
			var img=this.imgArr[i];
			img.skin=App.pngManager.getUrl(fontType)+str.charAt(i)+".png";
			img.x=(img.width-this.offset)*i;
			img.visible=true;
		}
	}

	__proto.tween=function(){
		var targetY=this.y-this.flyY;
		var tween=new Tween();
		tween.to(this,{y:targetY},this.flyTime,Ease.strongIn,Handler.create(this,this.overFun));
		this.once("undisplay",this,this.unDisFun);
	}

	__proto.unDisFun=function(){
		this.overFun();
	}

	__proto.overFun=function(){
		this.removeSelf();
		Pool.recover(App.getInstanceClassName(this),this);
		this.off("undisplay",this,this.unDisFun);
	}

	__proto.setPos=function(container,target,xx,yy){
		(xx===void 0)&& (xx=0);
		(yy===void 0)&& (yy=0);
		this.po.setTo(0,0);
		target.localToGlobal(this.po);
		container.addChild(this);
		this.pos(this.po.x+xx,this.po.y+yy);
		this.tween();
	}

	FontSprite.getNew=function(){
		return Pool.getItemByClass("FontSprite",FontSprite);
	}

	return FontSprite;
})(Sprite)


//class game.base.display.ImageFont extends laya.display.Sprite
var ImageFont=(function(_super){
	function ImageFont(fontType){
		this.fontType=0;
		ImageFont.__super.call(this);
		this.fontType=fontType;
	}

	__class(ImageFont,'game.base.display.ImageFont',_super);
	var __proto=ImageFont.prototype;
	__proto.setValue=function(value){
		this.removeChildren();
		var str=value+"";
		for (var i=0;i < str.length;i++){
			var img=new Image();
			img.skin=App.pngManager.getUrl(this.fontType)+str.charAt(i)+".png";
			img.x=img.width *i;
			this.addChild(img);
		}
	}

	return ImageFont;
})(Sprite)


/**
*两个状态切换 有一定长度
*@author chengxu03
*
*/
//class game.base.display.SpStat extends laya.display.Sprite
var SpStat=(function(_super){
	function SpStat(){
		this.disArr=[];
		this.urlArr=[];
		this.wid=0;
		this.haveBg=false;
		this.skin=null;
		this.btnArr=[];
		this.stat=0;
		SpStat.__super.call(this);
	}

	__class(SpStat,'game.base.display.SpStat',_super);
	var __proto=SpStat.prototype;
	__proto.setURL=function(trueURL,falseURL){
		this.urlArr.push(trueURL,falseURL);
	}

	__proto.setPngType=function(trueURL,falseURL){
		this.setURL(App.pngManager.getUrl(trueURL),App.pngManager.getUrl(falseURL));
	}

	__proto.setMax=function(wid,value){
		this.wid=wid;
		for (var i=0;i < value;i++){
			var image=new Image();
			this.addChild(image);
			this.disArr.push(image);
			image.x=wid *i;
		}
	}

	__proto.setNow=function(value){
		for (var i=0;i < this.disArr.length;i++){
			var img=this.disArr [i];
			img.skin=((value > i)? this.urlArr[0] :this.urlArr[1]);
		}
	}

	__proto.setButton=function(skin,stat){
		this.stat=stat;
		this.skin=skin;
	}

	__proto.setBtnMax=function(wid,max){
		this.removeChildren();
		this.btnArr.length=0;
		for (var i=0;i < max;i++){
			var button=new Button(this.skin);
			button.mouseEnabled=false;
			button.stateNum=this.stat;
			this.addChild(button);
			button.x=i *wid;
			this.btnArr.push(button);
		}
	}

	__proto.setBtnNow=function(value){
		for (var i=0;i < this.btnArr.length;i++){
			var btn=this.btnArr [i];
			btn.selected=i < value;
		}
	}

	__proto.setBtnArr=function(arr){
		for (var i=0;i < arr.length;i++){
			var btn=arr [i];
			this.btnArr.push(btn);
		}
	}

	__proto.setMaxBtn=function(max){
		for (var i=0;i < this.btnArr.length;i++){
			var btn=this.btnArr [i];
			btn.visible=i < max;
		}
	}

	return SpStat;
})(Sprite)


//class huamao.panel.haoyou.ChatView extends laya.display.Sprite
var ChatView=(function(_super){
	function ChatView(){
		this._rect=null;
		this._maxHeight=0;
		this.viewHeight=485;
		this._content=new Sprite;
		ChatView.__super.call(this);
		this.scrollRect=new Rectangle(0,0,493,this.viewHeight);
		this.addChild(this._content);
		this._content.on("mousedown",this,this.onDown);
		this._content.on("mouseup",this,this.onUp);
	}

	__class(ChatView,'huamao.panel.haoyou.ChatView',_super);
	var __proto=ChatView.prototype;
	__proto.onUp=function(){
		this._content.stopDrag();
	}

	__proto.onDown=function(){
		this._content.startDrag(this._rect,true);
	}

	__proto.clear=function(){
		this._content.removeChildren();
		this._content.size(400,this.viewHeight);
		this._rect=new Rectangle(0,0,0,0);
		this._maxHeight=0;
	}

	__proto.addMsg=function(data){
		var item=new ChatItem();
		item.update(data);
		this._content.addChild(item);
		item.y=this._maxHeight;
		this._maxHeight+=item.hh;
		this._content.size(482,Math.max(this.viewHeight,this._maxHeight));
		this._rect=new Rectangle(0,this.viewHeight-this._content.height,0,this._content.height-this.viewHeight);
		if(this._maxHeight > this.viewHeight){
			this._content.y=this.viewHeight-this._content.height;
		}
		else{
			this._content.y=0;
		}
	}

	return ChatView;
})(Sprite)


//class huamao.panel.haoyou.youjian.BattleMapCell extends laya.display.Sprite
var BattleMapCell=(function(_super){
	function BattleMapCell(){
		this.mailBattleSession=null;
		this._selectBorder=null;
		this._borderColor="#fff000";
		this.attackImg=null;
		this.mainPlayerSession=null;
		this.playerId=0;
		this._cityData=null;
		BattleMapCell.__super.call(this);
		App.injOne(this);
		this._selectBorder=new Sprite();
		this.addChild(this._selectBorder);
		this.mouseThrough=true;
		this.isSelect=false;
		this.attackImg=new Image("comp/G/zd.png");
		this.addChild(this.attackImg);
		this.attackImg.pos(-15,-20);
		this.setisAttack(false);
	}

	__class(BattleMapCell,'huamao.panel.haoyou.youjian.BattleMapCell',_super);
	var __proto=BattleMapCell.prototype;
	__proto.setisAttack=function(value,data,cityData){
		Laya.timer.clear(this,this.onUpdate);
		this.attackImg.visible=value;
		if(value==true){
			Laya.timer.loop(700,this,this.onUpdate,[data,cityData]);
		}
		else{
			Laya.timer.clear(this,this.onUpdate);
		}
	}

	__proto.onUpdate=function(data,cityData){
		this.setisAttack(false);
		if(data.isWin==1){
			cityData.playerId=data.playerId;
		}
		this.init(cityData);
	}

	__proto.init=function(cityData){
		this.playerId=cityData.playerId;
		this._cityData=cityData;
		var cityPlayerData=this.mailBattleSession.getPlayerData(cityData.playerId);
		var color;
		if(!cityPlayerData){
			color="#ffffff";
		}
		else{
			color="#"+cityPlayerData.cityFlag;
		}
		if(cityData.sysCity.cityType==0){
			this.graphics.drawRect(-5,-5,10,10,color);
			this._selectBorder.graphics.drawLines(0,0,[-5,-5,5,-5,5,5,-5,5,-5,-5],this._borderColor,2);
		}
		else{
			var points=[-8,5,8,5,8,-2,5,-2,5,-5,-5,-5,-5,-2,-8,-2,-8,5];
			this.graphics.drawPoly(0,0,points,color);
			this._selectBorder.graphics.drawLines(0,0,points,this._borderColor,2);
		};
		var ownCityPlayer=this.mailBattleSession.getPlayerData(this.mainPlayerSession.mainPlayerData.playerId);
		if(cityData.playerId==this.mainPlayerSession.mainPlayerData.playerId){
			this.filters=[BattleMapCell.selfFilter];
		}
		else if(ownCityPlayer && ownCityPlayer.allyId==cityData.playerId){
			this.filters=[BattleMapCell.friendFilter];
		}
		else{
			this.filters=[BattleMapCell.enemyFilter];
		}
		if(cityData.playerId==0){
			this.filters=[];
		}
		if(this.mailBattleSession.currPlayerId==cityData.playerId && cityData.playerId!=0){
			this.isSelect=true;
		}
		else{
			this.isSelect=false;
		}
		this.x=cityData.xx / this.mailBattleSession.mapScaleX;
		this.y=cityData.yy / this.mailBattleSession.mapScaleY;
	}

	__getset(0,__proto,'isSelect',null,function(value){
		this._selectBorder.visible=value;
	});

	__static(BattleMapCell,
	['selfFilter',function(){return this.selfFilter=new GlowFilter("#00ff06",6,0,0);},'friendFilter',function(){return this.friendFilter=new GlowFilter("#00deff",6,0,0);},'enemyFilter',function(){return this.enemyFilter=new GlowFilter("#ff004e",6,0,0);}
	]);
	return BattleMapCell;
})(Sprite)


//class huamao.panel.haoyou.youjian.MailPanel extends laya.display.Sprite
var MailPanel=(function(_super){
	function MailPanel(){
		this.list=null;
		this.arr=[];
		this.mailSession=null;
		this.mailAction=null;
		this.autoEvent=null;
		this._index=-1;
		this.mdata=null;
		MailPanel.__super.call(this);
		this.init();
	}

	__class(MailPanel,'huamao.panel.haoyou.youjian.MailPanel',_super);
	var __proto=MailPanel.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.mailAction.sendMailList();
		this.mailSession.index=-1;
		this.list=new List();
		this.list.itemRender=MailItem;
		this.list.repeatX=1;
		this.list.repeatY=6;
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.selectHandler=new Handler(this,this.selectHandler);
		this.list.vScrollBarSkin="";
		this.list.selectEnable=true;
		this.addChild(this.list);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("MAILUPDATA",this,this.upData);
		this.autoEvent.add("MAILLIST",this,this.newList);
		this.autoEvent.add("DELETEALLMAIL",this,this.deleteFun);
		this.autoEvent.add("DELETEMAIL",this,this.deleteFun);
		this.autoEvent.add("MAILGETITEM",this,this.itemFun);
		this.autoEvent.addEventNow();
		this.newList();
	}

	__proto.itemFun=function(id){
		if(this.mdata && this.mdata.mailId==id){
			App.eventManager.event("MAILCLICK",this.list.array[this.list.selectedIndex]);
		}
	}

	__proto.deleteFun=function(){
		this.setSelect();
	}

	__proto.newList=function(){
		this.upData();
		this.setSelect();
	}

	__proto.setSelect=function(){
		if(this.arr.length>1){
			this.list.scrollTo(0);
			this.list.selectedIndex=-1;
			this.list.selectedIndex=1;
		}
		else{
			App.eventManager.event("MAILUI");
			this.list.selectedIndex=-1;
		}
	}

	__proto.selectHandler=function(index){
		if(index>0){
			this.mdata=null;
			var item;
			if(this._index!=-1){
				item=this.list.getCell(this._index);
				if(item)item.selectBtn(false);
			}
			this._index=index;
			this.mailSession.index=index;
			item=this.list.getCell(index);
			item.selectBtn(true);
			this.mdata=this.list.array [index];
			if(this.mdata && this.mdata.isRead==0){
				this.mailAction.readMailFun(this.mdata.mailId);
			}
			App.eventManager.event("MAILCLICK",this.list.array[index]);
		}
		else{
			if(index==0){
				App.eventManager.event("MAILCLICK",this.list.array[index]);
			}
			if(this.list.array.length>1){
				this.list.selectedIndex=this._index;
			}
			else{
				this.list.selectedIndex=-1;
			}
		}
	}

	__proto.upData=function(){
		this.arr=this.mailSession.getMailArr();
		this.list.array=this.arr;
	}

	__proto.updateItem=function(item,index){
		if(this.mailSession.index==index){
			item.selectBtn(true);
		}
		else{
			item.selectBtn(false);
		}
		item.update(item.dataSource);
	}

	return MailPanel;
})(Sprite)


//class huamao.panel.redpoing.RedPoint extends laya.display.Sprite
var RedPoint=(function(_super){
	function RedPoint(ty,_sp){
		this.pointWidth=5;
		this._type=0;
		this.redPoingSession=null;
		//private var redMc:Clip;
		this.red=null;
		RedPoint.__super.call(this);
		this.autoSize=true;
		App.injOne(this);
		this.type=ty;
		this.init();
		_sp.addChild(this);
		this.x=_sp.width-this.pointWidth;
		this.y=5;
		if(this.type>0)this.redPoingSession.setRed(this);
	}

	__class(RedPoint,'huamao.panel.redpoing.RedPoint',_super);
	var __proto=RedPoint.prototype;
	__proto.setPos=function(xx,yy){
		(xx===void 0)&& (xx=0);
		(yy===void 0)&& (yy=0);
		this.x+=xx;
		this.y+=yy;
	}

	__proto.init=function(){
		this.red=new Animation();
		this.red.source="hongdian.ani";
		this.addChild(this.red);
		this.on("display",this,this.addFun);
		this.on("undisplay",this,this.remove);
	}

	__proto.addFun=function(){
		if(this.type>0){
			this.redPoingSession.setRed(this);
		}
		this.red.play();
	}

	__proto.remove=function(){
		if(this.type>0){
			this.redPoingSession.deleteRed(this.type);
		}
		this.red.stop();
	}

	__getset(0,__proto,'type',function(){
		return this._type;
		},function(value){
		this._type=value;
	});

	return RedPoint;
})(Sprite)


//class huamao.panel.talk.SysCell extends laya.display.Sprite
var SysCell=(function(_super){
	function SysCell(str,type){
		this.html=null;
		(str===void 0)&& (str="");
		(type===void 0)&& (type=0);
		SysCell.__super.call(this);
		this.html=new HTMLDivElement();
		if(type==0){
			this.width=this.html.width=365;
			}else if(type==1){
			this.width=this.html.width=TalkPanel.PANEL_W;
		}
		this.addChild(this.html);
		this.flushData(str);
	}

	__class(SysCell,'huamao.panel.talk.SysCell',_super);
	var __proto=SysCell.prototype;
	__proto.flushData=function(str){
		if(str.length==0)return;
		this.html.innerHTML=str;
		this.height=this.html.height=this.html.contextHeight+4;
	}

	__proto.flushSentence=function(index){
		this.html.innerHTML="<img src='comp/icon/lt_dangqin.png'></img>"+TheGame.FONT("武将经验获得武将经验获得武将经验获得武将经验获得 "+index,SysTitlePlayer.red,20,SysTalkData.font);
		this.height=this.html.height=this.html.contextHeight;
	}

	SysCell.TYPE_MAIN=0;
	SysCell.TYPE_UI=1;
	return SysCell;
})(Sprite)


//class huamao.panel.worldMap.MapCell extends laya.display.Sprite
var MapCell=(function(_super){
	function MapCell(){
		this.mapCitySession=null;
		this._selectBorder=null;
		this._borderColor="#fff000";
		this.warImg=null;
		this.dangerousImg=null;
		this.playerId=0;
		this._cityData=null;
		this.battle=null;
		this.action=null;
		MapCell.__super.call(this);
		App.injOne(this);
		this._selectBorder=new Sprite();
		this.addChild(this._selectBorder);
		this.warImg=new Image("comp/G/zd.png");
		this.addChild(this.warImg);
		this.warImg.pos(-15,-20);
		this.dangerousImg=new Image("comp/G/wx.png");
		this.addChild(this.dangerousImg);
		this.dangerousImg.pos(-15,-20);
		this.mouseThrough=true;
		this.isWar=this.isDangerous=this.isSelect=false;
	}

	__class(MapCell,'huamao.panel.worldMap.MapCell',_super);
	var __proto=MapCell.prototype;
	__proto.init=function(cityData,mapScaleX,mapScaleY){
		this.graphics.clear();
		this._selectBorder.graphics.clear();
		this.playerId=cityData.playerId;
		this._cityData=cityData;
		var cityPlayerData=this.mapCitySession.getCityPlayer(cityData.playerId);
		var color;
		if(cityPlayerData.playerId==0){
			color="#ffffff";
		}
		else{
			color="#"+cityPlayerData.cityFlag;
		}
		if(cityData.sysCity.cityType==0){
			this.graphics.drawRect(-5,-5,10,10,color);
			this._selectBorder.graphics.drawLines(0,0,[-5,-5,5,-5,5,5,-5,5,-5,-5],this._borderColor,2);
		}
		else{
			var points=[-8,5,8,5,8,-2,5,-2,5,-5,-5,-5,-5,-2,-8,-2,-8,5];
			this.graphics.drawPoly(0,0,points,color);
			this._selectBorder.graphics.drawLines(0,0,points,this._borderColor,2);
		}
		if(cityData.playerType==CityPlayerType.SELF){
			this.filters=[MapCell.selfFilter];
		}
		else if(cityData.playerType==CityPlayerType.FRIEND){
			this.filters=[MapCell.friendFilter];
		}
		else if(cityData.playerType==CityPlayerType.ENEMY){
			this.filters=[MapCell.enemyFilter];
		}
		if(cityPlayerData.playerId==0){
			this.filters=[];
		};
		var pos=this.mapCitySession.mapPosObj[cityData.cityId];
		this.x=pos[0] / mapScaleX;
		this.y=pos[1] / mapScaleY;
		if(cityData.battleFileUrl.length > 0){
			this.battle=cityData.battleFileUrl[0];
			this.isWar=true;
		}
		if(cityData.playerType==CityPlayerType.SELF){
			this.action=this.mapCitySession.getActionByToId(cityData.cityId);
			if(this.action && this.action.actionType==3){
				this.isDangerous=true;
			}
		}
	}

	__proto.onUpdate=function(){
		this.battle=this.mapCitySession.getBattle(this._cityData.battleFileUrl);
		if(this.battle && GameUtils.GetServerTime()>=this.battle.endTime){
			this.isWar=false;
			this.battle=null;
		}
		if(this.battle==null){
			this.isWar=false;
		}
	}

	__proto.onUpdate2=function(){
		if(this.action && this.action.remainingTime <=0){
			this.isDangerous=false;
			this.action=null;
		}
		if(this.action==null){
			this.isDangerous=false;
		}
	}

	__getset(0,__proto,'isDangerous',null,function(value){
		this.dangerousImg.visible=value;
		if(value==true){
			Laya.timer.loop(1000,this,this.onUpdate2);
		}
		else{
			Laya.timer.clear(this,this.onUpdate2);
		}
	});

	__getset(0,__proto,'isSelect',null,function(value){
		this._selectBorder.visible=value;
	});

	__getset(0,__proto,'isWar',null,function(value){
		this.warImg.visible=value;
		if(value==true){
			Laya.timer.loop(1000,this,this.onUpdate);
		}
		else{
			Laya.timer.clear(this,this.onUpdate);
		}
	});

	__static(MapCell,
	['selfFilter',function(){return this.selfFilter=new GlowFilter("#00ff06",6,0,0);},'friendFilter',function(){return this.friendFilter=new GlowFilter("#00deff",6,0,0);},'enemyFilter',function(){return this.enemyFilter=new GlowFilter("#ff004e",6,0,0);}
	]);
	return MapCell;
})(Sprite)


//class huamao.panel.wujiang.HeroBoxSprite extends laya.display.Sprite
var HeroBoxSprite=(function(_super){
	function HeroBoxSprite(){
		this.heroBox=null;
		this.heroData=null;
		this.team=0;
		this.equip=false;
		HeroBoxSprite.__super.call(this);
		this.size(160,228);
	}

	__class(HeroBoxSprite,'huamao.panel.wujiang.HeroBoxSprite',_super);
	var __proto=HeroBoxSprite.prototype;
	//this.graphics.drawRect(0,0,160,228,"#ffffff");
	__proto.renderNow=function(){
		this.checkBox();
		if(this.haveRes()==false){
			this.heroBox.visible=false;
			this.loadRes();
			}else{
			this.resetData();
		}
	}

	__proto.checkBox=function(){
		if(this.heroBox==null){
			this.heroBox=new HeroBox();
		}
		this.addChild(this.heroBox);
	}

	__proto.loadRes=function(){
		var heroSkin=GameUtils.getHeroSkin(this.heroData.heroId);
		var texture=Laya.loader.getRes(heroSkin);
		if(texture==null){
			Laya.loader.load(heroSkin,new Handler(this,this.loadFun,[this.heroData.heroId]));
		}
	}

	__proto.loadFun=function(heroId){
		if(heroId==this.heroData.heroId){
			this.resetData();
			}else{
			HeroBoxSprite.timeCall();
		}
	}

	__proto.haveRes=function(){
		var heroSkin=GameUtils.getHeroSkin(this.heroData.heroId);
		return Laya.loader.getRes(heroSkin)!=null;
	}

	__proto.comFun=function(){
		HeroBoxSprite.nextFun();
	}

	__proto.setAll=function(heroData,equip,team){
		this.team=team;
		this.equip=equip;
		this.heroData=heroData;
		if(this.haveRes()){
			}else{
			if(this.heroBox !=null){
				this.heroBox.visible=false;
			}
		}
		HeroBoxSprite.addRenderArr(this);
	}

	__proto.resetData=function(){
		this.heroBox.setHeroData(this.heroData);
		this.heroBox.setEquip(this.equip);
		this.heroBox.setTeam(this.team);
		this.heroBox.visible=true;
		HeroBoxSprite.timeCall();
	}

	HeroBoxSprite.addRenderArr=function(sp){
		HeroBoxSprite.timeCall();
		var index=HeroBoxSprite.arr.indexOf(sp);
		if(index !=-1){
			HeroBoxSprite.arr.splice(index,1);
		}
		HeroBoxSprite.arr.push(sp);
	}

	HeroBoxSprite.timeCall=function(){
		Laya.timer.callLater(HeroBoxSprite,HeroBoxSprite.nextFun);
	}

	HeroBoxSprite.nextFun=function(){
		if(HeroBoxSprite.arr.length==0){
			return;
		};
		var sp=HeroBoxSprite.arr.shift();
		sp.renderNow();
	}

	HeroBoxSprite.arr=[];
	return HeroBoxSprite;
})(Sprite)


//class huamao.panel.wujiang.MyList extends laya.display.Sprite
var MyList=(function(_super){
	function MyList(){
		this.itemRender=null;
		this.renderHandler=null;
		this.repeatX=0;
		this.repeatY=0;
		this.spaceX=0;
		this.spaceY=0;
		this.contentHeight=0;
		this.nowY=0;
		this.contentY=0;
		this.disArr=[];
		this.rectArr=[];
		MyList.__super.call(this);
		this.contentSp=new Sprite();
		this.addChild(this.contentSp);
		this.on("mousedown",this,this.downFun);
	}

	__class(MyList,'huamao.panel.wujiang.MyList',_super);
	var __proto=MyList.prototype;
	__proto.downFun=function(){
		this.stage.once("mouseup",this,this.stopListDrag);
		this.stage.once("mouseout",this,this.stopListDrag);
		this.nowY=Laya.stage.mouseY;
		this.contentY=this.contentSp.y;
		this.timer.loop(1,this,this.scrollFun);
	}

	__proto.scrollFun=function(){
		this.contentSp.y=(this.contentY-(this.nowY-this.stage.mouseY));
		this.contentSp.y=TheGame.between(this.contentSp.y ,-(this.contentHeight-this.height),0);
	}

	__proto.stopListDrag=function(){
		this.timer.clear(this,this.scrollFun);
	}

	__proto.setArr=function(arr){
		this.contentSp.removeChildren();
		this.rectArr.length=0;
		this.disArr.length=0;
		for (var i=0;i < arr.length;i++){
			var sprite=new this.itemRender();
			this.contentSp.addChild(sprite);
			sprite.x=i % this.repeatX *this.spaceX;
			sprite.y=Math.floor((i / this.repeatX))*this.spaceY;
			this.renderHandler.runWith([sprite,i]);
			var rectangle=new Rectangle(sprite.x,sprite.y,sprite.width,sprite.height);
			this.rectArr.push(rectangle);
			this.disArr.push(sprite);
		}
		this.contentHeight=Math.ceil(arr.length / 3)*this.spaceY;
	}

	__proto.setSize=function(width1,height1){
		this.size(width1,height1);
		this.scrollRect=new Rectangle(0,0,width1,height1);
	}

	__proto.getDisIndex=function(sp){
		for (var i=0;i < this.disArr.length;i++){
			if(this.disArr[i]==sp){
				return i;
			}
		}
		return-1;
	}

	__proto.scrollTo=function(value){
		var sp=this.disArr[value];
		var targetY=-sp.y;
		targetY=TheGame.between(targetY ,-(this.contentHeight-this.height),0);
		var tween=new Tween();
		tween.to(this.contentSp,{y:targetY},200);
	}

	return MyList;
})(Sprite)


//class huamao.panel.wujiangxinxi.Info extends laya.display.Sprite
var Info=(function(_super){
	function Info(){
		this._hh=NaN;
		this._heroData=null;
		this._sysHero=null;
		this._tianfu=new wujiang_ka1_0UI;
		this._shuxing=new wujiang_ka1_0UI;
		Info.__super.call(this);
		this.autoSize=true;
		this._tianfu.z0.text="天赋";
		this._shuxing.z0.text="属性";
	}

	__class(Info,'huamao.panel.wujiangxinxi.Info',_super);
	var __proto=Info.prototype;
	__proto.update=function(heroData){
		this.removeChildren();
		this._heroData=heroData;
		this._sysHero=heroData.sysHero;
		this._tianfu.y=10;
		this.addTianfu();
		this.addShuxing();
		this._hh+=10;
	}

	__proto.addTianfu=function(){
		this.addChild(this._tianfu);
		this._hh=this._tianfu.y+this._tianfu.height+10;
		for(var i=1;i <=this._sysHero.talentArr.length;i++){
			var t=this._sysHero.talentArr[i-1];
			var label=new HTMLDivElement();
			label.color="#ffffff";
			label.width=280;
			label.height=24;
			label.x=10;
			label.style.fontSize=20;
			var sysTalent=ConfigManager.getConfig("sys_talent.txt",t.id);
			label.innerHTML="<font color='#d29a62'>"+sysTalent.talentName+":</font>    <font color='#ffffff'>"+sysTalent.talentDescription+"</font><font color='#4bd438'>+"+t.value+"</font>";
			this.addChild(label);
			label.y=this._hh;
			this._hh+=label.height;
			if(this._heroData.heroStar < i){
				label=new HTMLDivElement();
				label.color="#c8af7f";
				label.width=280;
				label.height=24;
				label.x=10;
				label.style.fontSize=20;
				label.innerHTML="(进阶至"+i+"星激活)";
				this.addChild(label);
				label.y=this._hh;
				this._hh+=label.height;
			}
		}
	}

	__proto.addShuxing=function(){
		this._hh+=10;
		this.addChild(this._shuxing);
		this._shuxing.y=this._hh;
		this._hh+=this._shuxing.height+10;
		if(this._heroData.attack > 0){
			this.addOne(1005,this._heroData.attack);
		}
		if(this._heroData.defense > 0){
			this.addOne(1006,this._heroData.defense);
		}
		if(this._heroData.stratagemAttack > 0){
			this.addOne(1007,this._heroData.stratagemAttack);
		}
		if(this._heroData.stratagemDefense > 0){
			this.addOne(1008,this._heroData.stratagemDefense);
		}
		if(this._heroData.soldierMax > 0){
			this.addOne(1009,this._heroData.soldierMax);
		}
		if(this._heroData.growth > 0){
			this.addOne(1010,this._heroData.growth);
		}
		if(this._heroData.initAnger > 0){
			this.addOne(1011,this._heroData.initAnger);
		}
		if(this._heroData.crit > 0){
			this.addOne(1012,this._heroData.crit);
		}
		if(this._heroData.dodge > 0){
			this.addOne(1013,this._heroData.dodge);
		}
		if(this._heroData.insight > 0){
			this.addOne(1014,this._heroData.insight);
		}
		if(this._heroData.attackDamageReduce > 0){
			this.addOne(1015,this._heroData.attackDamageReduce);
		}
		if(this._heroData.stratagemDamageReduce > 0){
			this.addOne(1016,this._heroData.stratagemDamageReduce);
		}
		if(this._heroData.damageReduce > 0){
			this.addOne(1017,this._heroData.damageReduce);
		}
	}

	__proto.addOne=function(id,value){
		var label=new HTMLDivElement();
		label.color="#ffffff";
		label.width=280;
		label.height=24;
		label.x=10;
		label.style.font="隶书";
		label.style.fontSize=20;
		var sysName=ConfigManager.getConfig("sys_attr_name.txt",id);
		label.innerHTML="<font color='#d29a62'>"+sysName.attrName+":</font>    <font color='#ffffff'>"+value+"</font>";
		this.addChild(label);
		label.y=this._hh;
		this._hh+=label.height;
	}

	return Info;
})(Sprite)


//class huamao.panel.zhaomu.ZhaomuCard extends laya.display.Sprite
var ZhaomuCard=(function(_super){
	function ZhaomuCard(hid,sunm){
		this.sunm_=0;
		this._kar=new ZhaomuAnimation();
		ZhaomuCard.__super.call(this);
		this.addChild(this._kar);
		var sysh=ConfigManager.getConfig("sys_hero.txt",hid);
		this.kar.setData(hid,sunm);
		this.sunm_=sunm;
	}

	__class(ZhaomuCard,'huamao.panel.zhaomu.ZhaomuCard',_super);
	var __proto=ZhaomuCard.prototype;
	__proto.getDiWidth=function(){
		return this._kar.di.width;
	}

	__proto.getDiHeight=function(){
		return this._kar.di.height;
	}

	__proto.getSunm=function(){
		return this.sunm_;
	}

	__getset(0,__proto,'kar',function(){
		return this._kar;
		},function(value){
		this._kar=value;
	});

	return ZhaomuCard;
})(Sprite)


//class huamao.utils.FlyLittleUpTips extends laya.display.Sprite
var FlyLittleUpTips=(function(_super){
	function FlyLittleUpTips(){
		this._txt=null;
		this._bg=null;
		this._htmlDiv=null;
		this.screenW=0;
		this.screenH=0;
		FlyLittleUpTips.__super.call(this);
		this._bg=new Image("comp/GG/tishikuang.png");
		this._bg.sizeGrid="17,16,22,15";
		this._bg.anchorX=this._bg.anchorY=0.5;
		this.addChild(this._bg);
		this._txt=new Label();
		this._txt.bold=true;
		this._txt.color="#ffffff";
		this._txt.fontSize=20;
		this._txt.align="CENTER";
		this._txt.anchorX=this._txt.anchorY=0.5;
		this._bg.addChild(this._txt);
		this._htmlDiv=new HTMLDivElement();
		this._htmlDiv.width=440;
		this._htmlDiv.height=300;
		this._htmlDiv.style.lineHeight=20;
		this._bg.addChild(this._htmlDiv);
		this.screenW=Laya.stage.width;
		this.screenH=Laya.stage.height;
	}

	__class(FlyLittleUpTips,'huamao.utils.FlyLittleUpTips',_super);
	var __proto=FlyLittleUpTips.prototype;
	__proto.reg1=function(sp,caller,fun){
		if((typeof caller=='string')){
			sp.on("click",this,this.dis,[caller]);
			}else{
			var handler=new Handler(caller,fun);
			sp.on("click",this,this.dis,[handler]);
		}
		sp.once("undisplay",this,this.removeFun,[sp]);
	}

	__proto.dis=function(value){
		if(huamao.utils.FlyLittleUpTips.getinstance().parent){
			huamao.utils.FlyLittleUpTips.getinstance().close();
			return;
		}
		if((typeof value=='string')){
			this.setTips(value);
			}else{
			this.setTips((value).run());
		}
		Laya.timer.callLater(this,this.nextFun);
	}

	__proto.nextFun=function(){
		Laya.stage.once("click",this,this.undis);
	}

	__proto.undis=function(){
		if(huamao.utils.FlyLittleUpTips.getinstance().parent){
			huamao.utils.FlyLittleUpTips.getinstance().close();
		}
	}

	__proto.removeFun=function(sp){
		sp.offAll("click");
		Laya.stage.off("click",this,this.undis);
		this.undis();
	}

	__proto.setTips=function(str,ww){
		(ww===void 0)&& (ww=0);
		if(str==null || str==""){
			return;
		};
		var _W=0;
		var _H=0;
		this._txt.width=0;
		if(ww>0){
			this._txt.width=ww;
			this._txt.wordWrap=true;
		}
		else{
			this._txt.wordWrap=false;
		}
		this._txt.text=str;
		_W=this._txt.textField.textWidth+60;
		if(ww>0){
			_W=ww+60;
		}
		_H=this._txt.textField.textHeight+20;
		this.size(_W,_H);
		this._bg.size(_W,_H);
		this._txt.pos(_W/2,_H/2);
		var mousex=Laya.stage.mouseX;
		var mousey=Laya.stage.mouseY;
		if(mousex <=this.screenW/2){
			if(mousey <=this.screenH/2){
				this._bg.anchorX=0;
				this._bg.anchorY=0;
				}else{
				this._bg.anchorX=0;
				this._bg.anchorY=1;
			}
			}else{
			if(mousey <=this.screenH/2){
				this._bg.anchorX=1;
				this._bg.anchorY=0;
				}else{
				this._bg.anchorX=1;
				this._bg.anchorY=1;
			}
		}
		this.pos(Laya.stage.mouseX,Laya.stage.mouseY);
		App.layerManager.tipsLayer.addChild(this);
		this.alpha=1;
		Laya.stage.off("click",this,this.close);
		Laya.stage.timerOnce(100,this,this.doCB);
	}

	// Tween.to(this,{y:Laya.stage.height *0.5-50},delay,null,Handler.create(this,onCom));
	__proto.setColorTips=function(str,value){
		(value===void 0)&& (value=440);
		if(str==null || str==""){
			return;
		}
		this._htmlDiv.innerHTML=str;
		var _W=0;
		var _H=0;
		this._htmlDiv.width=440;
		this._htmlDiv.width=value;
		_W=this._htmlDiv.width+60;
		_H=this._htmlDiv.contextHeight+40;
		this.size(_W,_H);
		this._bg.size(_W,_H);
		this._htmlDiv.pos(30,20);
		var mousex=Laya.stage.mouseX;
		var mousey=Laya.stage.mouseY;
		if(mousex <=this.screenW/2){
			if(mousey <=this.screenH/2){
				this._bg.anchorX=0;
				this._bg.anchorY=0;
				}else{
				this._bg.anchorX=0;
				this._bg.anchorY=1;
			}
			}else{
			if(mousey <=this.screenH/2){
				this._bg.anchorX=1;
				this._bg.anchorY=0;
				}else{
				this._bg.anchorX=1;
				this._bg.anchorY=1;
			}
		}
		this.pos(Laya.stage.mouseX,Laya.stage.mouseY);
		App.layerManager.tipsLayer.addChild(this);
		this.alpha=1;
		Laya.stage.off("click",this,this.close);
		Laya.stage.timerOnce(100,this,this.doCB);
	}

	__proto.doCB=function(){
		Laya.stage.on("click",this,this.close);
	}

	__proto.close=function(){
		Laya.stage.off("click",this,this.close);
		this.removeSelf();
		this._txt.text="";
		this._htmlDiv.innerHTML="";
	}

	FlyLittleUpTips.regByFun=function(sp,caller,fun){
		FlyLittleUpTips.getinstance().reg1(sp,caller,fun);
	}

	FlyLittleUpTips.regByString=function(sp,str){
		FlyLittleUpTips.getinstance().reg1(sp,str);
	}

	FlyLittleUpTips.getinstance=function(){
		if(FlyLittleUpTips._fly==null){
			FlyLittleUpTips._fly=new FlyLittleUpTips();
		}
		return FlyLittleUpTips._fly;
	}

	FlyLittleUpTips.setTips=function(str,ww){
		(ww===void 0)&& (ww=0);
		if(FlyLittleUpTips._fly==null){
			FlyLittleUpTips._fly=new FlyLittleUpTips();
		}
		if(FlyLittleUpTips._fly.parent){
			FlyLittleUpTips._fly.close();
		}
		else{
			FlyLittleUpTips._fly.setTips(str,ww);
		}
	}

	FlyLittleUpTips.setColorTips=function(str,ww){
		(ww===void 0)&& (ww=0);
		if(FlyLittleUpTips._fly==null){
			FlyLittleUpTips._fly=new FlyLittleUpTips();
		}
		if(FlyLittleUpTips._fly.parent){
			FlyLittleUpTips._fly.close();
		}
		else{
			FlyLittleUpTips._fly.setColorTips(str,ww);
		}
	}

	FlyLittleUpTips._fly=null;
	return FlyLittleUpTips;
})(Sprite)


//class huamao.utils.FlyUpTips extends laya.display.Sprite
var FlyUpTips=(function(_super){
	function FlyUpTips(){
		this._txt=null;
		this._bg=null;
		this.tw=null;
		FlyUpTips.__super.call(this);
		this._bg=new Image("tishikuang.png");
		this._bg.sizeGrid="17,16,22,15";
		this.addChild(this._bg);
		this._bg.anchorX=this._bg.anchorY=0.5;
		this._txt=new Label();
		this._txt.bold=true;
		this._txt.color="#ffffff";
		this._txt.fontSize=20;
		this._txt.align="CENTER";
		this.addChild(this._txt);
		this._txt.anchorX=this._txt.anchorY=0.5;
	}

	__class(FlyUpTips,'huamao.utils.FlyUpTips',_super);
	var __proto=FlyUpTips.prototype;
	__proto.setTips=function(str,delay,color,arr){
		(color===void 0)&& (color="#ffffff");
		if(str==null || str==""){
			return;
		}
		Tween.clearTween(this);
		if(arr){
			TheGame.lang(this._txt,str,arr[0]);
			this._txt.anchorX=this._txt.anchorY=0.5;
			}else{
			this._txt.text=str;
		}
		this._txt.color=color;
		this._bg.size(this._txt.textField.textWidth+200,this._txt.textField.textHeight+40);
		this.pos(Laya.stage.width *0.5,Laya.stage.height *0.5);
		App.layerManager.tipsLayer.addChild(this);
		this.alpha=1;
		Tween.to(this,{y:Laya.stage.height *0.5-50},delay,null,Handler.create(this,this.onCom));
	}

	__proto.flyMc=function(htmlDiv){
		this.onCom2();
		htmlDiv.pos(0,0);
		this.addChild(htmlDiv);
		this._bg.size(htmlDiv.contextWidth+200,htmlDiv.contextHeight+40);
		htmlDiv.x=-htmlDiv.contextWidth/2;
		htmlDiv.y=-htmlDiv.contextHeight/2;
		this.pos(Laya.stage.width *0.5,Laya.stage.height *0.5);
		App.layerManager.tipsLayer.addChild(this);
		this.alpha=1;
		this.tw=Tween.to(this,{y:Laya.stage.height *0.5-50},1000,null,Handler.create(this,this.onCom2));
	}

	__proto.onCom2=function(){
		this.onCom();
		FlyUpTips.htmlDiv.removeSelf();
		if(this.tw){
			this.tw.clear();
			this.tw=null;
		}
	}

	__proto.onCom=function(){
		this.removeSelf();
		this._txt.text="";
	}

	FlyUpTips.setTips=function(str,delay,color,arr){
		(delay===void 0)&& (delay=1000);
		(color===void 0)&& (color="#ffffff");
		if(FlyUpTips._fly==null){
			FlyUpTips._fly=new FlyUpTips();
		}
		FlyUpTips._fly.setTips(str,delay,color,arr);
	}

	FlyUpTips.setHtml=function(str){
		FlyUpTips.htmlDiv.innerHTML=str;
		if(FlyUpTips._fly==null){
			FlyUpTips._fly=new FlyUpTips();
		}
		FlyUpTips._fly.flyMc(FlyUpTips.htmlDiv);
	}

	FlyUpTips._fly=null;
	__static(FlyUpTips,
	['htmlDiv',function(){return this.htmlDiv=new HTMLDivElement();}
	]);
	return FlyUpTips;
})(Sprite)


//class huamao.utils.PaoMaTips extends laya.display.Sprite
var PaoMaTips=(function(_super){
	function PaoMaTips(){
		this._WIDTH=400;
		this._HEIGHT=40;
		this.text=null;
		this.label=null;
		this.ary=null;
		this.STATE=false;
		PaoMaTips.__super.call(this);
		this.init();
	}

	__class(PaoMaTips,'huamao.utils.PaoMaTips',_super);
	var __proto=PaoMaTips.prototype;
	__proto.init=function(){
		this.ary=[];
		this.scrollRect=new Rectangle(0,0,this._WIDTH,this._HEIGHT);
		var bg=new Image("comp/G/k_zdd.png");
		bg.sizeGrid="14,34,16,34";
		bg.size(this._WIDTH,this._HEIGHT);
		this.addChild(bg);
		this.label=new Label;
		this.label.align="left";
		this.label.valign="middle";
		this.label.height=this._HEIGHT;
		this.label.pos(0,0);
		this.label.color="#efe1e1";
		this.label.fontSize=24;
		this.label.text="测试蚊子xxxxxxx";
		bg.addChild(this.label);
		this.pos((Laya.stage.width-this._WIDTH)/2,Laya.stage.height/4-this._HEIGHT);
	}

	__proto.setTips=function(str){
		(str===void 0)&& (str="");
		if(str.length==0)return;
		this.ary.push(str);
		if(!this.STATE){
			this.STATE=true;
			App.layerManager.tipsLayer.addChild(this);
			Laya.stage.timerLoop(10,this,this.textCB);
			this.label.x=this._WIDTH;
			this.label.text=this.ary.shift();
		}
	}

	__proto.textCB=function(){
		this.label.x-=1;
		if(this.label.x+this.label.getBounds().width < 0){
			if(this.ary.length > 0){
				this.label.x=this._WIDTH;
				this.label.text=this.ary.shift();
				}else{
				this.STATE=false;
				Laya.stage.clearTimer(this,this.textCB);
				this.removeSelf();
			}
		}
	}

	PaoMaTips.getMe=function(){
		if(PaoMaTips.me==null){
			PaoMaTips.me=new PaoMaTips();
		}
		return PaoMaTips.me;
	}

	PaoMaTips.me=null;
	return PaoMaTips;
})(Sprite)


//class huamao.utils.UiLoading extends laya.display.Sprite
var UiLoading=(function(_super){
	function UiLoading(x,y,w,h){
		this.clip=null;
		UiLoading.__super.call(this);
		this.init(x,y,w,h);
	}

	__class(UiLoading,'huamao.utils.UiLoading',_super);
	var __proto=UiLoading.prototype;
	__proto.init=function(x,y,w,h){
		this.pos(x,y);
		this.size(w,h);
		this.alpha=0.5;
		this.graphics.drawRect(0,0,w,h,"#000000");
		this.clip=new Clip("res/load/clip_he.png",4,2);
		this.clip.play();
		this.clip.centerX=this.clip.centerY=0;
		this.addChild(this.clip);
		this.mouseEnabled=true;
		this.zOrder=99;
	}

	return UiLoading;
})(Sprite)


//class map.CityCell extends laya.display.Sprite
var CityCell=(function(_super){
	function CityCell(){
		this.mapCitySession=null;
		this.bagSession=null;
		this.mainPlayerSession=null;
		this.mapCityAction=null;
		this.cityPlayerData=null;
		this.cityData=null;
		this.sysCity=null;
		this._ui=null;
		this.title=null;
		this._curX=NaN;
		this._curY=NaN;
		this.qianli=null;
		this.guideCitys=[1001,1002,1007,2001,2002,2006];
		this.guideQizhi="1e5fa3";
		/**1:出征自己城池,2:出征盟友城池,3:出征敌方城池*/
		this.chuzhengType=-1;
		this._fromId=-1;
		this._startY=0;
		this._juli=0;
		this._isAdd=false;
		this.firea=null;
		this.jian=null;
		//private var mc:DragonBonesMc;
		this.baohu=null;
		this.nowStat=0;
		CityCell.__super.call(this);
		this.img=new Image();
		App.injOne(this);
		this._ui=new map_1UI();
		this.addChild(this._ui);
		this._ui.pos(-this._ui.width *0.5,-this._ui.height *0.5);
		this._ui.chengshiming.text=this._ui.wanjiaming.text="";
		this._ui.zhenying.visible=this._ui.xing.visible=false;
		this._ui.on("mousedown",this,this.onClickDown);
		this._ui.on("mouseup",this,this.onClickUp);
		this.title=new map_1_0UI();
		this.addChild(this.title);
		this.title.pos(this._ui.x+20,this._ui.y-50);
		this.title.jindutiaoa.visible=false;
		this.title.wujiangxinxi.visible=false;
		this.title.txt0.text="";
		this.qianli=ConfigManager.getConfig("sys_timetake.txt",30);
		this.setStat(2);
	}

	__class(CityCell,'map.CityCell',_super);
	var __proto=CityCell.prototype;
	__proto.hideInfo=function(){
		this.title.wujiangxinxi.visible=false;
		this.title.jindutiaoa.visible=false;
		this.title.txt0.text="";
	}

	__proto.onClickDown=function(){
		this._curX=Laya.stage.mouseX;
		this._curY=Laya.stage.mouseY;
	}

	__proto.onClickUp=function(){
		if(Math.abs(Laya.stage.mouseX-this._curX)> 10 && Math.abs(Laya.stage.mouseY-this._curY)> 10){
			return;
		}
		if(this.cityData && this.cityData.battleFileUrl.length > 0){
			App.eventManager.event("BATTLE",this.cityData.battleFileUrl+"");
			return;
		}
		if(GameState.state==2){
			App.eventManager.event("SHOW_HEADER",this);
		}
		else if(GameState.state==3){
			if(this.mapCitySession.getIsNotOpenFight()&& this.sysCity.cityType==1 && this.cityData.playerType !=CityPlayerType.SELF){
				FlyUpTips.setTips("城池还在保护时间内");
				return;
			}
			if(this.chuzhengType !=-1 && this._fromId !=-1){
				if(this.chuzhengType==CityPlayerType.FRIEND){
					UseJice.ins.onUse(4007,this.qianli.timeCd,new Handler(this,this.useHandler,[0]),new Handler(this,this.useHandler,[1]));
					return;
				}
				this.mapCitySession.chuzhengParam.setData(this.chuzhengType,this._fromId,this.sysCity.cityId,this._juli);
				App.dialogManager.openDialogByStr("CHUZHENG",null,true,true);
			}
		}
		else if(GameState.state==5){
			if(this.chuzhengType !=-1 && this._fromId !=-1){
				this.mapCitySession.chuzhengParam.setData(-1,this._fromId,this.sysCity.cityId,this._juli);
				App.dialogManager.openDialogByStr("YUNSHU_BINGLI",null,true,true);
			}
		}
	}

	__proto.useHandler=function(type){
		UseJice.ins.close();
		if(type==0){
			var num=this.bagSession.getItemNumByItemId(4005);
			if(num==0){
				var openFunctionSession=App.getSession("openFunctionSession");
				if(openFunctionSession.isFunction("jice")){
					return;
				}
				App.dialogManager.openDialogByStr("DIALOG_STRATAGEM",null,true,true);
				return;
			}
		}
		else if(type==1){
			if(this.mainPlayerSession.mainPlayerData.gold < this.qianli.timeCd){
				FlyUpTips.setTips("元宝不足");
				return;
			}
			if(UseJiceTips.QianLiChiYuan_IFVIEW){
				var tips=App.dialogManager.showMiniDialog(UseJiceTips,true,true);
				tips.setHandler(4007,this.qianli.timeCd,new Handler(this,this.useJiceTipsCB,[this.chuzhengType,this._fromId,this.sysCity.cityId,this._juli,type]));
				return;
			}
		}
		this.useJiceTipsCB(this.chuzhengType,this._fromId,this.sysCity.cityId,this._juli,type);
	}

	__proto.useJiceTipsCB=function(cType,fId,tId,distance,type){
		App.voiceManager.playSound("yongjimou.wav");
		this.mapCitySession.chuzhengParam.setData(cType,fId,tId,distance,type);
		App.dialogManager.openDialogByStr("CHUZHENG",null,true,true);
	}

	__proto.initCity=function(cityId){
		this.cityData=this.mapCitySession.getCity(cityId);
		this.sysCity=this.cityData.sysCity;
		this._ui.city1.skin="comp/G/city"+this.sysCity.cityType+".png";
		this._ui.chengshiming.text=this.sysCity.cityName;
		this._ui.fang.visible=false;
		if(this.sysCity.cityType==1){
			this.title.y=this._ui.y-50;
			}else{
			this.title.y=this._ui.y-25;
		}
		this.checkDongzuo(cityId);
	}

	//addFirea();
	__proto.checkDongzuo=function(cityId){
		if(this.mainPlayerSession.checkIfInGuide()){
			if((cityId==2010 && SysGuide.getGuideViewDongZhuo())|| (this.guideCitys.indexOf(parseInt(cityId+""))!=-1 && this.cityData.playerId <=0)){
				console.log("董卓的城池");
				this._ui.xing.visible=this._ui.zhenying.visible=true;
				this._ui.wanjiaming.text="董卓";
				this._ui.xing.text=this._ui.wanjiaming.text.charAt(0);
				this._ui.wanjiaming.color="#ca896f";
				this._ui.zhenying.skin="comp/GG/"+this.guideQizhi+".png";
			}
		}
	}

	__proto.updateCity=function(){
		this.clearChuzhengType();
		this._ui.fang.visible=this.cityData.xiefangHeroNum > 0;
		this._ui.zhenying.visible=this._ui.xing.visible=this.cityPlayerData.playerType !=CityPlayerType.KONG;
		this._ui.wanjiaming.text="";
		if(this.cityPlayerData.playerType !=CityPlayerType.KONG){
			this._ui.wanjiaming.text=""+this.cityPlayerData.playerName;
			if(this.cityPlayerData.playerType==CityPlayerType.SELF){
				this._ui.wanjiaming.color="#73d663";
				this._ui.chengshiming.color="#fffd68";
			}
			else if(this.cityPlayerData.playerType==CityPlayerType.FRIEND){
				this._ui.wanjiaming.color="#00deff";
			}
			else{
				this._ui.wanjiaming.color="#ca896f";
				this._ui.chengshiming.color="#ffffff";
			}
			this._ui.zhenying.skin="comp/GG/"+this.cityPlayerData.cityFlag+".png";
			this._ui.xing.text=this._ui.wanjiaming.text.charAt(0);
		}
		this.cityInfo();
		console.trace("输出堆栈:");
	}

	__proto.refresh=function(){
		if(this.cityPlayerData==null){
			return;
		}
		this.setPlayer(this.cityData,this.cityPlayerData);
	}

	__proto.setPlayer=function(cityData1,playerData){
		this.cityPlayerData=playerData;
		this.cityData=this.mapCitySession.getCity(cityData1.cityId);
		this.updateCity();
		this.cityInfo();
		this.checkDongzuo(this.cityData.cityId);
	}

	__proto.cityInfo=function(){
		this.title.jindutiaoa.visible=this.title.txt0.visible=this.cityData.yubeiyiNum > 0;
		this.title.xue.scrollRect=new Rectangle(0,0,this.cityData.yubeiyiNum / 50000 *136,18);
		this.title.txt0.text=""+this.cityData.yubeiyiNum;
		if(this.cityPlayerData !=null && (this.cityPlayerData.playerType==CityPlayerType.SELF || this.cityPlayerData.playerType==CityPlayerType.FRIEND)){
			this.title.jindutiaoa.visible=this.title.txt0.visible=true;
		}
		this.title.wujiangxinxi.visible=this.cityData.heroNum > 0;
		this.title.wujiangshu.text=""+this.cityData.heroNum;
		this.title.shibingshu.text=this.showNum(this.cityData.childNum);
	}

	__proto.showNum=function(num){
		if(num > 10000){
			num=num / 1000;
			num=parseInt(num+"");
			return num+"K";
		}
		else{
			return ""+num;
		}
	}

	__proto.clearChuzhengType=function(){
		this._fromId=-1;
		this.chuzhengType=-1;
		this.img.removeSelf();
		Laya.timer.clear(this,this.onJiantou);
		this.setStat(2);
	}

	__proto.resetCity=function(){
		this.clearChuzhengType();
		var cityData=new CityData();
		cityData.cityId=this.sysCity.cityId;
		cityData.sysCity=this.sysCity;
		var pData=new CityPlayerData();
		pData.playerType=CityPlayerType.KONG;
		this.setPlayer(cityData,pData);
		this.removeFightFire();
	}

	__proto.setChuzhengType=function(fromId,juli){
		this._fromId=fromId;
		this._juli=juli;
		this.chuzhengType=this.cityData.playerType;
		if(this.chuzhengType==CityPlayerType.KONG){
			this.chuzhengType=CityPlayerType.ENEMY;
		}
		this.img.skin="comp/GG/chuzheng_"+this.chuzhengType+".png";
		console.log("出征类型",this.sysCity.cityName,this.chuzhengType,juli);
	}

	__proto.startJiantou=function(){
		this.addChild(this.img);
		this.img.pos(-7,-60);
		this._startY=this.img.y;
		this._isAdd=false;
		Laya.timer.frameLoop(1,this,this.onJiantou);
		this.setStat(3);
	}

	__proto.onJiantou=function(){
		if(this._isAdd){
			this.img.y+=1;
			if(this.img.y > this._startY+10){
				this._isAdd=false;
			}
		}
		else{
			this.img.y-=1;
			if(this.img.y < this._startY-10){
				this._isAdd=true;
			}
		}
	}

	/**外部添加战火*/
	__proto.addFightFire=function(){
		this.addFire();
		this.title.wujiangxinxi.visible=this.title.jindutiaoa.visible=this.title.txt0.visible=false;
	}

	/**外部添加战火*/
	__proto.addFire=function(){
		this.addFirea();
	}

	/**外部移除战火*/
	__proto.removeFire=function(){
		this.clearFirea();
		this.setStat(2);
	}

	/**外部移除战火*/
	__proto.removeFightFire=function(){
		this.clearFirea();
		this.cityInfo();
		this.setStat(2);
	}

	/**内部添加战火*/
	__proto.addFirea=function(){
		this.clearFirea();
		this.firea=new ClipMc();
		this.firea.blendMode="lighter";
		this.firea.setClipName("zhanhuo_5_6");
		this.firea.autoPlay=true;
		this.jian=new ClipMc();
		this.jian.interval=80;
		this.jian.setClipName("jian_3_5");
		this.jian.autoPlay=true;
		if(this.sysCity.cityType==1){
			this.firea.scale(1,0.8);
			this.jian.scale(0.9,0.9);
			this.firea.y=-15;
			this.jian.y=-70;
			}else{
			this.firea.scale(0.8,0.6);
			this.jian.scale(0.7,0.7);
			this.firea.y=-5;
			this.jian.y=-55;
		}
		this.addChild(this.firea);
		this.addChild(this.jian);
		this.setStat(1);
	}

	/**内部移除战火*/
	__proto.clearFirea=function(){
		if(this.firea){
			this.firea.autoPlay=false;
			this.firea.stop();
			this.firea.removeSelf();
			this.firea.destroy();
			this.firea=null;
			this.jian.autoPlay=false;
			this.jian.stop();
			this.jian.removeSelf();
			this.jian.destroy();
			this.jian=null;
		}
	}

	__proto.setBaohuzhao=function(){
		if(this.sysCity.cityType==1){
			if(this.mapCitySession.getIsNotOpenFight()){
				this.addBaohuzhao();
			}
			else{
				this.removeBaohuzhao();
			}
		}
	}

	__proto.addBaohuzhao=function(){
		if(this.sysCity.cityType==0){
			return;
		}
		if(this.baohu){
			this.baohu.destroy();
			this.baohu=null;
		}
		this.baohu=new ClipMc();
		this.baohu.interval=80;
		this.baohu.blendMode="lighter";
		this.baohu.y=-20;
		this.baohu.setClipName("bao_3_3");
		this.baohu.autoPlay=true;
		this.addChild(this.baohu);
		this.setStat(0);
	}

	__proto.removeBaohuzhao=function(){
		if(this.baohu){
			this.baohu.dispose();
			this.baohu.destroy();
			this.baohu=null;
		}
		this.setStat(2);
	}

	__proto.setStat=function(stat){
		this.nowStat=stat;
		Laya.timer.callLater(this,this.nextFun);
	}

	__proto.nextFun=function(){
		if(this.nowStat==0 || this.nowStat==1 || this.nowStat==3){
			this.cacheAs="none";
			this._ui.cacheAs="bitmap";
			this.title.cacheAs="bitmap";
			}else{
			this.cacheAs="bitmap";
			this._ui.cacheAs="none";
			this.title.cacheAs="none";
		}
	}

	CityCell.BAOHU=0;
	CityCell.ZHANHUO=1;
	CityCell.NO=2;
	CityCell.CHUZHENG=3;
	return CityCell;
})(Sprite)


//class map.CloudLayer extends laya.display.Sprite
var CloudLayer=(function(_super){
	function CloudLayer(){
		this.mainPlayerSession=null;
		this.settingSession=null;
		this._yun=null;
		this._yunMove=null;
		CloudLayer.__super.call(this);
		App.injOne(this);
		this.mouseEnabled=false;
	}

	__class(CloudLayer,'map.CloudLayer',_super);
	var __proto=CloudLayer.prototype;
	__proto.update=function(){
		if(this.mainPlayerSession.checkIfInGuide()){
			this._yunMove && this._yunMove.removeSelf();
			if(this._yun==null){
				this._yun=new yuncengUI();
			}
			this.addChild(this._yun);
		}
		else{
			if(this.settingSession.isOpenByKey(3)==false){
				this._yunMove && this._yunMove.removeSelf();
				return;
			}
			this._yun && this._yun.removeSelf();
			if(this._yunMove==null){
				this._yunMove=new yuncengdongUI();
				this._yunMove.x=-this._yunMove.width;
			}
			this._yunMove.offAll();
			this._yunMove.on("display",this,this.start);
			this._yunMove.on("undisplay",this,this.stop);
			this.addChild(this._yunMove);
		}
	}

	__proto.start=function(){
		Laya.timer.frameLoop(1,this,this.onStep);
	}

	__proto.onStep=function(){
		this._yunMove.x+=1;
		if(this._yunMove.x > this._yunMove.width){
			this._yunMove.x=-this._yunMove.width;
		}
	}

	__proto.stop=function(){
		Laya.timer.clear(this,this.onStep);
	}

	return CloudLayer;
})(Sprite)


//class map.MapCity extends laya.display.Sprite
var MapCity=(function(_super){
	function MapCity(){
		this._mapView=null;
		this.mapCitySession=null;
		this._cityCellList=[];
		this._distance=0;
		this._fromCityId=0;
		this._findedList=[];
		MapCity.__super.call(this);
		App.injOne(this);
		this._mapView=new MapDrag();
		this.addChild(this._mapView);
	}

	__class(MapCity,'map.MapCity',_super);
	var __proto=MapCity.prototype;
	__proto.updateCloud=function(){
		this._mapView.updateCloud();
	}

	__proto.clearChuzhengType=function(){
		var ce;
		for(var $each_ce in this._cityCellList){
			ce=this._cityCellList[$each_ce];
			if(ce.parent){
				ce.clearChuzhengType();
			}
		}
	}

	__proto.startJiantou=function(){
		var ce;
		for(var $each_ce in this._cityCellList){
			ce=this._cityCellList[$each_ce];
			if(ce.parent){
				ce.startJiantou();
			}
		}
	}

	/**可以运输的城池*/
	__proto.setBingliYunshu=function(fromCityId){
		this._distance=0;
		this._findedList.length=this._cityCellList.length=0;
		this._fromCityId=fromCityId;
		var curData=this.mapCitySession.getCity(fromCityId);
		var arr=curData.sysCity.cityRelation.split(",");
		this._findedList.push(fromCityId);
		this.findPath(arr,true);
		this.startJiantou();
	}

	/**可以出征的城池*/
	__proto.setCanChuzhengCitys=function(fromCityId){
		this._distance=0;
		this._findedList.length=this._cityCellList.length=0;
		this._fromCityId=fromCityId;
		var curData=this.mapCitySession.getCity(fromCityId);
		var arr=curData.sysCity.cityRelation.split(",");
		this._findedList.push(fromCityId);
		this.findPath(arr);
		this.startJiantou();
	}

	/**递归可达到的城池*/
	__proto.findPath=function(curFindArr,isYunshu){
		(isYunshu===void 0)&& (isYunshu=false);
		console.log("当前要找的"+curFindArr);
		this._distance++;
		var nextFindArr=[];
		for(var i=0;i < curFindArr.length;i++){
			var nextId=parseInt(curFindArr[i]);
			if(this._findedList.indexOf(nextId)!=-1){
				continue ;
			}
			console.log("查找的城池"+nextId);
			this._findedList.push(nextId);
			var nextData=this.mapCitySession.getCity(nextId);
			var nextCity=this._mapView.cityDic[nextId];
			var playerType=nextData.playerType;
			if(nextData.battleFileUrl.length > 0){
				continue ;
			}
			if(isYunshu){
				if(playerType==CityPlayerType.SELF){
					this._cityCellList.push(nextCity);
					nextCity.setChuzhengType(this._fromCityId,this._distance);
					var curData=this.mapCitySession.getCity(nextId);
					var arr=curData.sysCity.cityRelation.split(",");
					nextFindArr=nextFindArr.concat(arr);
				}
			}
			else{
				this._cityCellList.push(nextCity);
				if(playerType==CityPlayerType.SELF || playerType==CityPlayerType.FRIEND){
					nextCity.setChuzhengType(this._fromCityId,this._distance);
					curData=this.mapCitySession.getCity(nextId);
					arr=curData.sysCity.cityRelation.split(",");
					nextFindArr=nextFindArr.concat(arr);
				}
				else{
					nextCity.setChuzhengType(this._fromCityId,this._distance);
				}
			}
		}
		if(nextFindArr.length > 0){
			this.findPath(nextFindArr,isYunshu);
		}
	}

	__proto.updateActions=function(){
		this._mapView.updateActions();
	}

	__proto.deleteAction=function(ationId){
		this._mapView.deleteAction(ationId);
	}

	return MapCity;
})(Sprite)


//class map.MapDrag extends laya.display.Sprite
var MapDrag=(function(_super){
	function MapDrag(){
		this.maxScale=2;
		this._lastDistance=0;
		//上次记录的两个触模点之间距离
		this._mapImg=null;
		this._curMapWidth=4800;
		this._curMapHeight=2700;
		this._maxXishu=NaN;
		this._dragArea=null;
		this._localPoint=null;
		this._downScale=0;
		this._cityLayer=null;
		this._actionLayer=null;
		this._cityHeader=null;
		this._cloudLayer=null;
		//private var _niaoLayer:NiaoLayer;
		this.mapCityAction=null;
		this.mapCitySession=null;
		this.mainPlayerSession=null;
		this._isInit=false;
		this.cityId=0;
		this.tw=null;
		this.uiui=null;
		this.guideLine=null;
		//-------------------------拖拽结束-----------------------------
		this.tww=null;
		this.cityDic=new Object();
		this._actionLineObj=new Object();
		MapDrag.__super.call(this);
		App.injOne(this);
		this._mapImg=new MapLayer();
		this.addChild(this._mapImg);
		this._actionLayer=new Sprite();
		this._mapImg.addChild(this._actionLayer)
		this._cityLayer=new Sprite();
		this._mapImg.addChild(this._cityLayer);
		this._cloudLayer=new CloudLayer();
		this._mapImg.addChild(this._cloudLayer);
		this._cityHeader=new CityHeader();
		GuideMain.getMe().cityHeader=this._cityHeader;
		Laya.stage.on("mouseup",this,this.onMouseUp);
		Laya.stage.on("mouseout",this,this.onMouseUp);
		Laya.stage.on("resize",this,this.onResize);
		this.onResize();
		this.init();
	}

	__class(MapDrag,'map.MapDrag',_super);
	var __proto=MapDrag.prototype;
	__proto.updateCloud=function(){
		this._cloudLayer.update();
	}

	//_niaoLayer.update();
	__proto.clearCitys=function(playerId){
		var cell;
		for(var $each_cell in this.cityDic){
			cell=this.cityDic[$each_cell];
			if(cell.cityPlayerData && cell.cityPlayerData.playerId==playerId){
				cell.resetCity();
			}
		}
	}

	__proto.clearAllCitys=function(){
		var cell;
		for(var $each_cell in this.cityDic){
			cell=this.cityDic[$each_cell];
			cell.resetCity();
		}
		var line;
		for(var $each_line in this._actionLineObj){
			line=this._actionLineObj[$each_line];
			if(line){
				line.removeSelf();
			}
		}
	}

	__proto.updateActions=function(){
		if(this._isInit==false){
			return;
		}
		var action;
		for(var $each_action in this.mapCitySession.actionObj){
			action=this.mapCitySession.actionObj[$each_action];
			if(action.battleId <=0 && action.remainingTime > 0){
				this.addAction(action);
			}
		}
	}

	//检测两个城市间是否有线
	__proto.checkMidCity=function(fromX,fromY,toX,toY){
		var ary=[];
		var line;
		for(var $each_line in this._actionLineObj){
			line=this._actionLineObj[$each_line];
			var linebox=line;
			if(linebox.fromx==toX && linebox.fromy==toY && linebox.tox==fromX && linebox.toy==fromY){
				ary.push(linebox);
			}
		}
		return ary;
	}

	/**添加一根线，红线或者黄线*/
	__proto.addAction=function(action){
		var fromCity=this.cityDic[action.fromId];
		var toCity=this.cityDic[action.toId];
		if(this._actionLineObj[action.actionId]==null){
			var fromX=fromCity.x;
			var fromY=fromCity.y;
			var tox=toCity.x;
			var toY=toCity.y;
			if(fromCity.cityData.sysCity.cityType==0){
				fromY=fromY+10;
			}
			if(toCity.cityData.sysCity.cityType==0){
				toY=toY+10;
			};
			var ary=this.checkMidCity(fromX,fromY,tox,toY);
			this._actionLineObj[action.actionId]=MapArrow.drawArrow(fromX,fromY,tox,toY,action.actionType,this._actionLayer,ary);
		}
	}

	__proto.deleteAction=function(ationId){
		var line=this._actionLineObj[ationId];
		if(line){
			line.removeSelf();
			delete this._actionLineObj[ationId];
			console.log("删除一根线");
		}
	}

	/**点击城池弹出的菜单按钮*/
	__proto.showHeader=function(cityCell){
		console.log("点击城池弹出的菜单按钮");
		this._cityLayer.addChild(this._cityHeader);
		this._cityHeader.setHeader(cityCell);
		this._cityHeader.pos(cityCell.x-235,cityCell.y-145);
	}

	__proto.onZhencha=function(cityId){
		if(this.mapCitySession.checkLiangcao(10000)==false){
			FlyUpTips.setTips("粮草不足");
			return;
		}
		this.mapCityAction.onZhencha(cityId);
	}

	__proto.resetCitys=function(){
		var city;
		for(var $each_city in this.cityDic){
			city=this.cityDic[$each_city];
			city.removeSelf();
			if(this.mainPlayerSession.checkIfInGuide()){
				if(city.sysCity.cityGuide !=0){
					this._cityLayer.addChild(city);
				}
			}
			else{
				this._cityLayer.addChild(city);
			}
		}
	}

	__proto.init=function(){
		this._isInit=true;
		this._curMapWidth=GameMap.mapWidth;
		this._curMapHeight=GameMap.mapHeight;
		for(var cityId=0 in this.mapCitySession.mapPosObj){
			var pos=this.mapCitySession.mapPosObj[cityId];
			var city=new CityCell();
			city.initCity(cityId);
			city.pos(pos[0],pos[1]);
			this.cityDic[cityId]=city;
			this.mapCitySession.cityCellObj[cityId]=city;
		}
		this._mapImg.setImg();
		this._maxXishu=Math.max(Laya.stage.width / this._curMapWidth,Laya.stage.height / this._curMapHeight);
		this.setDragArea(this._curMapWidth,this._curMapHeight);
		this._mapImg.on("mousedown",this,this.onMouseDown);
		if(this.mapCitySession.selfDataInfo){
			this.setPosToCity(this.mapCitySession.selfDataInfo.firstCityId,0,0);
		}
		else{
			this.setPosToCity(0,0,0);
		}
		this.setPlayerInfo();
		this.updateActions();
		this.updateFightFire();
		this.setBaohuzhao();
		App.eventManager.on("SHOW_HEADER",this,this.showHeader);
		App.eventManager.on("ADD_CITY_PLAYER",this,this.addOnePlayer);
		App.eventManager.on("UPDATE_PLAYER_LIST",this,this.setPlayerInfo);
		App.eventManager.on("REMVOE_CITY_PLAYER",this,this.clearCitys);
		App.eventManager.on("UPDATE_CITY_INFO",this,this.updateCity);
		App.eventManager.on("ADD_FIGHT_FIRE",this,this.addFightFire);
		App.eventManager.on("REMOVE_FIGHT_FIRE",this,this.removeFightFire);
		App.eventManager.on("SET_POSITION",this,this.setPosToCity);
		App.eventManager.on("REMOVE_BAOHUZHAO",this,this.setBaohuzhao);
		App.eventManager.on("ADD_BAOHUZHAO",this,this.setBaohuzhao);
		App.eventManager.on("CLEAR_ALL_CITY",this,this.clearAllCitys);
		App.eventManager.on("UPDATE_SETTING",this,this.updateSettingCloud);
		App.eventManager.event("SET_SMALL_MAP");
		App.eventManager.on("ADD_GUIDE_LINE",this,this.addGuideLine);
		App.eventManager.on("REMOVE_GUIDE_LINE",this,this.removeGuideLine);
		App.eventManager.on("ADD_GUIDE_FIRE",this,this.addGuideFire);
		App.eventManager.on("REMOVE_GUIDE_FIRE",this,this.removeGuideFire);
		App.eventManager.on("RESET_GUIDE_CITY",this,this.resetGuideCity);
		App.eventManager.on("OPENYUN",this,this.openYun);
		App.eventManager.on("MAPROLL",this,this.mapRoll)
	}

	__proto.openYun=function(_cityId){
		this.yunCom();
		this.mapFun();
		this._mapImg.scale(this._maxXishu,this._maxXishu);
		this.openFun();
		this.uiui=new yun_zhanUI();
		this.uiui.ani1.stop();
		this.uiui.ani1.on("complete",this,this.yunCom);
		Laya.stage.addChild(this.uiui);
		this.cityId=_cityId;
		Dialog.manager.setLockView(null);
		Dialog.manager.lock(true);
		Laya.timer.once(500,this,this.methodFun);
	}

	__proto.methodFun=function(){
		this.uiui.ani1.play(0,false);
		this.tw=Tween.to(this._mapImg,{scaleX:1,scaleY:1},1700,Ease.circIn,new Handler(this,this.mapFun));
		this.tw.update=new Handler(this,this.openFun);
	}

	__proto.yunCom=function(){
		Laya.timer.clear(this,this.methodFun);
		if(this.uiui){
			this.uiui.ani1.stop();
			this.uiui.removeSelf();
			this.uiui.destroy();
			this.uiui=null;
		}
	}

	__proto.mapFun=function(){
		Dialog.manager.lock(false);
		this.cityId=0;
		if(this.tw){
			App.eventManager.event("YUNOVER");
			this.tw.clear();
			this.tw=null;
		}
	}

	__proto.openFun=function(){
		this.setPosToCity(this.cityId);
	}

	__proto.resetGuideCity=function(cityId){
		console.log("董卓的城变回玩家的");
		var cityCell=this.cityDic[cityId];
		cityCell && cityCell.updateCity();
	}

	__proto.addGuideLine=function(fromId,toId){
		var fromCity=this.cityDic[fromId];
		var toCity=this.cityDic[toId];
		this.guideLine=MapArrow.drawArrow(fromCity.x,fromCity.y,toCity.x,toCity.y,3,this._actionLayer);
	}

	__proto.removeGuideLine=function(){
		this.guideLine && this.guideLine.removeSelf();
	}

	__proto.addGuideFire=function(cityId){
		var cell=this.cityDic[cityId];
		cell && cell.addFire();
	}

	__proto.removeGuideFire=function(cityId){
		var cell=this.cityDic[cityId];
		cell && cell.removeFire();
	}

	__proto.updateSettingCloud=function(key){
		if(key==3){
			this._cloudLayer && this._cloudLayer.update();
		}
	}

	__proto.setBaohuzhao=function(){
		var cell;
		for(var $each_cell in this.cityDic){
			cell=this.cityDic[$each_cell];
			cell.setBaohuzhao();
		}
	}

	/**
	*设置地图的位置 （城市id或者位置）
	*@param cityId 根据城市id设置
	*@param xx 根据位置设置
	*@param yy
	*
	*/
	__proto.setPosToCity=function(cityId,xx,yy){
		(xx===void 0)&& (xx=0);
		(yy===void 0)&& (yy=0);
		var cityCell=this.cityDic[cityId];
		var posx=0;
		var posy=0;
		if(cityId==0){
			posx=xx;
			posy=yy;
		}
		else{
			posx=cityCell.x *this._mapImg.scaleX;
			posy=cityCell.y *this._mapImg.scaleY;
		}
		this._mapImg.pos(Laya.stage.width *0.5-posx,Laya.stage.height *0.5-posy);
		var scaleWidth=this._curMapWidth *this._mapImg.scaleX;
		var scaleHeight=this._curMapHeight *this._mapImg.scaleY;
		scaleWidth=this._curMapWidth *this._mapImg.scaleX;
		scaleHeight=this._curMapHeight *this._mapImg.scaleY;
		this.setDragArea(scaleWidth,scaleHeight);
		this._mapImg.x=Math.max(this._mapImg.x,Laya.stage.width-scaleWidth);
		this._mapImg.y=Math.max(this._mapImg.y,Laya.stage.height-scaleHeight);
		this._mapImg.x=Math.min(this._mapImg.x,0);
		this._mapImg.y=Math.min(this._mapImg.y,0);
		this.setScale();
	}

	__proto.setScale=function(){
		console.log("设置scale");
		var scaleWidth=this._curMapWidth *this._mapImg.scaleX;
		var scaleHeight=this._curMapHeight *this._mapImg.scaleY;
		GameMap.scaleWidth=scaleWidth;
		GameMap.scaleHeight=scaleHeight;
		GameMap.windowScaleX=scaleWidth / Laya.stage.width;
		GameMap.windowScaleY=scaleHeight / Laya.stage.height;
		this.setPos();
	}

	/**添加战火*/
	__proto.addFightFire=function(cityId){
		var cell=this.cityDic[cityId];
		var cityData=this.mapCitySession.getCity(cityId);
		if(cityData.battleFileUrl.length > 0){
			cell && cell.addFightFire();
		}
		else{
			cell && cell.removeFightFire();
		}
	}

	/**移除战火*/
	__proto.removeFightFire=function(cityId){
		var cell=this.cityDic[cityId];
		var cityData=this.mapCitySession.getCity(cityId);
		if(cityData.battleFileUrl==""){
			cell && cell.removeFightFire();
		}
	}

	/**初始化有战火的城池*/
	__proto.updateFightFire=function(){
		var battle;
		for(var $each_battle in this.mapCitySession.battleObj){
			battle=this.mapCitySession.battleObj[$each_battle];
			this.addFightFire(battle.cityId);
		}
	}

	__proto.updateCity=function(cityData,cityPlayer){
		var cityCell=this.cityDic[cityData.cityId];
		cityCell && cityCell.setPlayer(cityData,cityPlayer);
	}

	__proto.setPlayerInfo=function(){
		console.log("设置玩家"+this.mapCitySession.cityPlayerObj);
		var data;
		for(var $each_data in this.mapCitySession.cityPlayerObj){
			data=this.mapCitySession.cityPlayerObj[$each_data];
			this.addOnePlayer(data);
		}
		this.resetCitys();
	}

	__proto.addOnePlayer=function(data){
		var cityArr=this.mapCitySession.getCitysByPlayerId(data.playerId);
		console.log("添加一个新玩家"+cityArr.length);
		for(var i=0;i < cityArr.length;i++){
			var cityData=cityArr[i];
			this.setCity(data,cityData.cityId);
		}
	}

	__proto.setCity=function(data,cityId){
		var cityCell=this.cityDic[cityId];
		cityCell && cityCell.setPlayer(this.mapCitySession.getCity(cityId),data);
	}

	__proto.onMouseUp=function(e){
		Laya.timer.clear(this,this.setPos);
		Laya.stage.off("mousemove",this,this.onMouseMove);
		if((e.target instanceof laya.ui.Button )){
			var btn=e.target;
			if(btn.parent.parent==this._cityHeader){
				var btnName=btn.name;
				var cityId=this._cityHeader.cityData.cityId;
				if(btnName=="jinBtn"){
					this.mapCityAction.onEnterCityById(cityId);
				}
				else if(btnName=="buBtn"){
					App.dialogManager.openDialogByStr("CITY_BUDUI",{cityId:cityId,isShowBtn:true},true,true);
				}
				else if(btnName=="chaBtn"){
					var normalAlert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
					normalAlert.setAll(null,"侦查该城需要花费10000粮食，确定侦查吗？(侦查只能获得当前状态，侦查后敌情可能有变)",new Handler(this,this.onZhencha,[cityId]));
				}
				else if(btnName=="qingbaoBtn"){
					App.dialogManager.openDialogByStr("QINGBAO",{cityId:cityId},true,true);
				}
				this._cityHeader.removeSelf();
			}
		}
	}

	__proto.onResize=function(){
		var scaleWidth=this._curMapWidth *this._mapImg.scaleX;
		var scaleHeight=this._curMapHeight *this._mapImg.scaleY;
		this.setDragArea(scaleWidth,scaleHeight);
		this._mapImg.x=Math.max(this._mapImg.x,Laya.stage.width-scaleWidth);
		this._mapImg.y=Math.max(this._mapImg.y,Laya.stage.height-scaleHeight);
		this._mapImg.x=Math.min(this._mapImg.x,0);
		this._mapImg.y=Math.min(this._mapImg.y,0);
	}

	//-------------------------拖拽开始-----------------------------
	__proto.setDragArea=function(mapW,mapH){
		var mapHalfW=mapW *0.5;
		var mapHalfH=mapH *0.5;
		var deltaW=(mapW-Laya.stage.width)*0.5;
		var deltaH=(mapH-Laya.stage.height)*0.5;
		this._dragArea=new Rectangle(Laya.stage.width-mapW,Laya.stage.height-mapH,mapW-Laya.stage.width,mapH-Laya.stage.height);
	}

	__proto.onMouseDown=function(e){
		if(e.target==this._mapImg || (e.target instanceof ui.SLGGAME.map_1UI )){
			this._cityHeader.removeSelf();
			var touches=e.touches;
			if(touches && touches.length==2){
				this._mapImg.stopDrag();
				this._lastDistance=this.getDistance(touches);
				this._downScale=this._mapImg.scaleX;
				this._localPoint=this._mapImg.globalToLocal(new Point(touches[0].stageX,touches[0].stageY));
				Laya.stage.on("mousemove",this,this.onMouseMove);
			}
			else{
				this._lastDistance=0;
				this._mapImg.startDrag(this._dragArea,true);
				Laya.timer.frameLoop(1,this,this.setPos);
			}
		}
	}

	__proto.setPos=function(){
		GameMap.tempX=Laya.stage.width *0.5-this._mapImg.x;
		GameMap.tempY=Laya.stage.height *0.5-this._mapImg.y;
		App.eventManager.event("RESIZE_MAP");
	}

	__proto.onMouseMove=function(e){
		var touches=e.touches;
		if(touches && touches.length==2){
			var distance=this.getDistance(touches);
			var a=distance / this._lastDistance;
			this._mapImg.scale(this._downScale *a ,this._downScale *a);
			var scaleWidth=this._curMapWidth *this._mapImg.scaleX;
			var scaleHeight=this._curMapHeight *this._mapImg.scaleY;
			if(this._mapImg.scaleX > this.maxScale || this._mapImg.scaleY > this.maxScale){
				this._mapImg.scale(this.maxScale,this.maxScale);
			}
			if(scaleWidth <=Laya.stage.width || scaleHeight <=Laya.stage.height){
				this._mapImg.scale(this._maxXishu,this._maxXishu);
			};
			var aaa=this._localPoint.x *this._mapImg.scaleX;
			var bbb=this._localPoint.y *this._mapImg.scaleY;
			this._mapImg.x=-(aaa-touches[0].stageX);
			this._mapImg.y=-(bbb-touches[0].stageY);
			scaleWidth=this._curMapWidth *this._mapImg.scaleX;
			scaleHeight=this._curMapHeight *this._mapImg.scaleY;
			this.setDragArea(scaleWidth,scaleHeight);
			this._mapImg.x=Math.max(this._mapImg.x,Laya.stage.width-scaleWidth);
			this._mapImg.y=Math.max(this._mapImg.y,Laya.stage.height-scaleHeight);
			this._mapImg.x=Math.min(this._mapImg.x,0);
			this._mapImg.y=Math.min(this._mapImg.y,0);
			this.setScale();
		}
	}

	/**计算两个触摸点之间的距离*/
	__proto.getDistance=function(points){
		var distance=0;
		if (points && points.length==2){
			var dx=points[0].stageX-points[1].stageX;
			var dy=points[0].stageY-points[1].stageY;
			distance=Math.sqrt(dx *dx+dy *dy);
		}
		return distance;
	}

	__proto.mapRoll=function(cityId){
		this.setPosToCityRoll(cityId);
	}

	/**
	*平移到设置地图的位置 （城市id或者位置）
	*@param cityId 根据城市id设置
	*@param xx 根据位置设置
	*@param yy
	*
	*/
	__proto.setPosToCityRoll=function(cityId,xx,yy){
		(xx===void 0)&& (xx=0);
		(yy===void 0)&& (yy=0);
		Dialog.manager.setLockView(null);
		Dialog.manager.lock(true);
		var cityCell=this.cityDic[cityId];
		var posx=0;
		var posy=0;
		if(cityId==0){
			posx=xx;
			posy=yy;
			}else{
			posx=cityCell.x *this._mapImg.scaleX;
			posy=cityCell.y *this._mapImg.scaleY;
		}
		this.tww=Tween.to(this._mapImg,{x:Laya.stage.width *0.5-posx,y:Laya.stage.height *0.5-posy},1500,null,new Handler(this,this.rollCom));
		this.tww.update=new Handler(this,this.roll);
		var scaleWidth=this._curMapWidth *this._mapImg.scaleX;
		var scaleHeight=this._curMapHeight *this._mapImg.scaleY;
		scaleWidth=this._curMapWidth *this._mapImg.scaleX;
		scaleHeight=this._curMapHeight *this._mapImg.scaleY;
		this.setDragArea(scaleWidth,scaleHeight);
		this.setScale();
	}

	__proto.rollCom=function(){
		Dialog.manager.lock(false);
		if(this.tww){
			App.eventManager.event("ROLLOVER");
			this.tww.clear();
			this.tww=null;
		}
	}

	__proto.roll=function(){
		this._mapImg.x=Math.max(this._mapImg.x,Laya.stage.width-this._curMapWidth *this._mapImg.scaleX);
		this._mapImg.y=Math.max(this._mapImg.y,Laya.stage.height-this._curMapHeight *this._mapImg.scaleY);
		this._mapImg.x=Math.min(this._mapImg.x,0);
		this._mapImg.y=Math.min(this._mapImg.y,0);
	}

	return MapDrag;
})(Sprite)


//class map.MapLayer extends laya.display.Sprite
var MapLayer=(function(_super){
	function MapLayer(){
		MapLayer.__super.call(this);
		this.size(GameMap.mapWidth,GameMap.mapHeight);
	}

	__class(MapLayer,'map.MapLayer',_super);
	var __proto=MapLayer.prototype;
	__proto.setImg=function(){
		var glowFilter=new GlowFilter("#ff0000",15,0,0)
		for(var i=0;i < 4;i++){
			for(var j=0;j < 3;j++){
				var sprite=new Image();
				sprite.skin="testMap/yasuo/"+10000+"_"+i+"_"+j+".jpg";
				this.addChild(sprite);
				sprite.pos(i *1024,j *1024);
				sprite.zOrder=-1;
			}
		}
	}

	return MapLayer;
})(Sprite)


//class map.NiaoItem extends laya.display.Sprite
var NiaoItem=(function(_super){
	function NiaoItem(){
		this.arr=[0,0];
		//
		this.mcArr=[];
		this.zhengSpeed=0.5+Math.random()*0.3;
		this.fuSpeed=-this.zhengSpeed;
		this.speed=this.zhengSpeed;
		NiaoItem.__super.call(this);
		this.init();
	}

	__class(NiaoItem,'map.NiaoItem',_super);
	var __proto=NiaoItem.prototype;
	__proto.init=function(){
		this.clear();
		var num=0.3+Math.random()*0.3;
		if(this.mcArr.length==0){
			for(var i=0;i<this.arr.length;i+=2){
				var mc=new DragonBonesMc(false);
				mc.blendMode="lighter";
				mc.scaleX=mc.scaleY=num;
				mc.playbackRate(0.7);
				mc.setUrl("res/load/xiaoniao.sk");
				this.addChild(mc);
				this.mcArr.push(mc);
				mc.pos(this.arr[i],this.arr[i+1]);
			}
		}
		Laya.timer.frameLoop(1,this,this.roll);
	}

	__proto.roll=function(){
		this.x+=this.speed;
		if(this.x>=3940){
			this.scaleX=-1;
			this.speed=this.fuSpeed;
			}else if(this.x<=100){
			this.scaleX=1;
			this.speed=this.zhengSpeed;
		}
	}

	__proto.clear=function(){
		Laya.timer.clear(this,this.roll);
	}

	return NiaoItem;
})(Sprite)


//class MyImg extends laya.display.Sprite
var MyImg=(function(_super){
	function MyImg(){
		MyImg.__super.call(this);
		this.img=new Image("1.png");
		this.addChild(this.img);
		this.img.centerX=this.img.centerY=0;
		this.img.scaleY=0.05;
	}

	__class(MyImg,'MyImg',_super);
	var __proto=MyImg.prototype;
	__proto.resetAndGo=function(){
		this.img.scaleX=0.5+(0.5*Math.random());
		this.rotation=Math.random()*360;
		this.img.alpha=1;
		Laya.timer.frameLoop(1,this,this.efe);
	}

	__proto.efe=function(){
		if(this.img.scaleX < 5){
			this.img.scaleX+=0.08*MyImg.EFEN;
		}
		this.img.alpha-=0.02*MyImg.EFEN;
		if(this.img.alpha<=0){
			this.event("MyImg_ImgOver");
		}
	}

	MyImg.ImgOver="MyImg_ImgOver";
	__static(MyImg,
	['EFEN',function(){return this.EFEN=(60/30);}
	]);
	return MyImg;
})(Sprite)


//class PaoGuang extends laya.display.Sprite
var PaoGuang=(function(_super){
	function PaoGuang(){
		this.mc=null;
		PaoGuang.__super.call(this);
	}

	__class(PaoGuang,'PaoGuang',_super);
	var __proto=PaoGuang.prototype;
	__proto.start=function(){
		Laya.timer.once(2000,this,this.addFun);
	}

	__proto.addFun=function(){
		this.mc=new DragonBonesMc(false);
		this.mc.setUrl("res/load/paoguang.sk");
		this.addChild(this.mc);
		this.mc.scrollRect=new Rectangle(-80,-119,170,237);
		this.scaleX=this.mc.scaleY=1.8;
		this.mc.x=-85;
		this.mc.y=-206;
	}

	__proto.stop=function(){
		if(this.mc)this.mc.removeSelf();
		Laya.timer.clear(this,this.addFun);
	}

	return PaoGuang;
})(Sprite)


//class TClass extends laya.display.Sprite
var TClass=(function(_super){
	function TClass(){
		this.mc=null;
		TClass.__super.call(this);
	}

	__class(TClass,'TClass',_super);
	var __proto=TClass.prototype;
	__proto.start=function(){
		this.mc=new DragonBonesMc(false);
		this.mc.setUrl("res/load/fg.sk");
		this.addChild(this.mc);
		this.mc.scaleX=this.mc.scaleY=1.8;
	}

	__proto.stop=function(){
		if(this.mc)this.mc.removeSelf();
	}

	return TClass;
})(Sprite)


/**
*骨骼动画由<code>Templet</code>，<code>AnimationPlayer</code>，<code>Skeleton</code>三部分组成。
*/
//class laya.ani.bone.Skeleton extends laya.display.Sprite
var Skeleton=(function(_super){
	function Skeleton(templet,aniMode){
		this._templet=null;
		/**@private */
		this._player=null;
		/**@private */
		this._curOriginalData=null;
		//当前骨骼的偏移数据
		this._boneMatrixArray=[];
		//当前骨骼动画的最终结果数据
		this._lastTime=0;
		//上次的帧时间
		this._currAniName=null;
		this._currAniIndex=-1;
		this._pause=true;
		/**@private */
		this._aniClipIndex=-1;
		/**@private */
		this._clipIndex=-1;
		this._skinIndex=0;
		this._skinName="default";
		this._aniMode=0;
		//当前动画自己的缓冲区
		this._graphicsCache=null;
		this._boneSlotDic=null;
		this._bindBoneBoneSlotDic=null;
		this._boneSlotArray=null;
		this._index=-1;
		this._total=-1;
		this._indexControl=false;
		//加载路径
		this._aniPath=null;
		this._texturePath=null;
		this._complete=null;
		this._loadAniMode=0;
		this._yReverseMatrix=null;
		this._ikArr=null;
		this._tfArr=null;
		this._pathDic=null;
		this._rootBone=null;
		/**@private */
		this._boneList=null;
		/**@private */
		this._aniSectionDic=null;
		this._eventIndex=0;
		this._drawOrderIndex=0;
		this._drawOrder=null;
		this._lastAniClipIndex=-1;
		this._lastUpdateAniClipIndex=-1;
		Skeleton.__super.call(this);
		(aniMode===void 0)&& (aniMode=0);
		if (templet)this.init(templet,aniMode);
	}

	__class(Skeleton,'laya.ani.bone.Skeleton',_super);
	var __proto=Skeleton.prototype;
	/**
	*初始化动画
	*@param templet 模板
	*@param aniMode 动画模式
	*<table>
	*<tr><th>模式</th><th>描述</th></tr>
	*<tr>
	*<td>0</td> <td>使用模板缓冲的数据，模板缓冲的数据，不允许修改（内存开销小，计算开销小，不支持换装）</td>
	*</tr>
	*<tr>
	*<td>1</td> <td>使用动画自己的缓冲区，每个动画都会有自己的缓冲区，相当耗费内存 （内存开销大，计算开销小，支持换装）</td>
	*</tr>
	*<tr>
	*<td>2</td> <td>使用动态方式，去实时去画（内存开销小，计算开销大，支持换装,不建议使用）</td>
	*</tr>
	*</table>
	*/
	__proto.init=function(templet,aniMode){
		(aniMode===void 0)&& (aniMode=0);
		var i=0,n=0;
		if (aniMode==1){
			this._graphicsCache=[];
			for (i=0,n=templet.getAnimationCount();i < n;i++){
				this._graphicsCache.push([]);
			}
		}
		this._yReverseMatrix=templet.yReverseMatrix;
		this._aniMode=aniMode;
		this._templet=templet;
		this._player=new AnimationPlayer();
		this._player.cacheFrameRate=templet.rate;
		this._player.templet=templet;
		this._player.play();
		this._parseSrcBoneMatrix();
		this._boneList=templet.mBoneArr;
		this._rootBone=templet.mRootBone;
		this._aniSectionDic=templet.aniSectionDic;
		if (templet.ikArr.length > 0){
			this._ikArr=[];
			for (i=0,n=templet.ikArr.length;i < n;i++){
				this._ikArr.push(new IkConstraint(templet.ikArr[i],this._boneList));
			}
		}
		if (templet.pathArr.length > 0){
			var tPathData;
			var tPathConstraint;
			if (this._pathDic==null)this._pathDic={};
			var tBoneSlot;
			for (i=0,n=templet.pathArr.length;i < n;i++){
				tPathData=templet.pathArr[i];
				tPathConstraint=new PathConstraint(tPathData,this._boneList);
				tBoneSlot=this._boneSlotDic[tPathData.name];
				if (tBoneSlot){
					tPathConstraint=new PathConstraint(tPathData,this._boneList);
					tPathConstraint.target=tBoneSlot;
				}
				this._pathDic[tPathData.name]=tPathConstraint;
			}
		}
		if (templet.tfArr.length > 0){
			this._tfArr=[];
			for (i=0,n=templet.tfArr.length;i < n;i++){
				this._tfArr.push(new TfConstraint(templet.tfArr[i],this._boneList));
			}
		}
		if (templet.skinDataArray.length > 0){
			var tSkinData=this._templet.skinDataArray[this._skinIndex];
			this._skinName=tSkinData.name;
		}
		this._player.on("played",this,this._onPlay);
		this._player.on("stopped",this,this._onStop);
		this._player.on("paused",this,this._onPause);
	}

	/**
	*通过加载直接创建动画
	*@param path 要加载的动画文件路径
	*@param complete 加载完成的回调函数
	*@param aniMode 与<code>Skeleton.init</code>的<code>aniMode</code>作用一致
	*/
	__proto.load=function(path,complete,aniMode){
		(aniMode===void 0)&& (aniMode=0);
		this._aniPath=path;
		this._complete=complete;
		this._loadAniMode=aniMode;
		Laya.loader.load([{url:path,type:"arraybuffer"}],Handler.create(this,this._onLoaded));
	}

	/**
	*加载完成
	*/
	__proto._onLoaded=function(){
		var arraybuffer=Loader.getRes(this._aniPath);
		if (arraybuffer==null)return;
		if (Templet.TEMPLET_DICTIONARY==null){
			Templet.TEMPLET_DICTIONARY={};
		};
		var tFactory;
		tFactory=Templet.TEMPLET_DICTIONARY[this._aniPath];
		if (tFactory){
			if (tFactory.isParseFail){
				this._parseFail();
				}else {
				if (tFactory.isParserComplete){
					this._parseComplete();
					}else {
					tFactory.on("complete",this,this._parseComplete);
					tFactory.on("error",this,this._parseFail);
				}
			}
			}else {
			tFactory=new Templet();
			tFactory._setUrl(this._aniPath);
			Templet.TEMPLET_DICTIONARY[this._aniPath]=tFactory;
			tFactory.on("complete",this,this._parseComplete);
			tFactory.on("error",this,this._parseFail);
			tFactory.isParserComplete=false;
			tFactory.parseData(null,arraybuffer);
		}
	}

	/**
	*解析完成
	*/
	__proto._parseComplete=function(){
		var tTemple=Templet.TEMPLET_DICTIONARY[this._aniPath];
		if (tTemple){
			this.init(tTemple,this._loadAniMode);
			this.play(0,true);
		}
		this._complete && this._complete.runWith(this);
	}

	/**
	*解析失败
	*/
	__proto._parseFail=function(){
		console.log("[Error]:"+this._aniPath+"解析失败");
	}

	/**
	*传递PLAY事件
	*/
	__proto._onPlay=function(){
		this.event("played");
	}

	/**
	*传递STOP事件
	*/
	__proto._onStop=function(){
		var tEventData;
		var tEventAniArr=this._templet.eventAniArr;
		var tEventArr=tEventAniArr[this._aniClipIndex];
		if (tEventArr && this._eventIndex < tEventArr.length){
			for (;this._eventIndex < tEventArr.length;this._eventIndex++){
				tEventData=tEventArr[this._eventIndex];
				if (tEventData.time >=this._player.playStart && tEventData.time <=this._player.playEnd){
					this.event("label",tEventData);
				}
			}
		}
		this._eventIndex=0;
		this._drawOrder=null;
		this.event("stopped");
	}

	/**
	*传递PAUSE事件
	*/
	__proto._onPause=function(){
		this.event("paused");
	}

	/**
	*创建骨骼的矩阵，保存每次计算的最终结果
	*/
	__proto._parseSrcBoneMatrix=function(){
		var i=0,n=0;
		n=this._templet.srcBoneMatrixArr.length;
		for (i=0;i < n;i++){
			this._boneMatrixArray.push(new Matrix());
		}
		if (this._aniMode==0){
			this._boneSlotDic=this._templet.boneSlotDic;
			this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic;
			this._boneSlotArray=this._templet.boneSlotArray;
			}else {
			if (this._boneSlotDic==null)this._boneSlotDic={};
			if (this._bindBoneBoneSlotDic==null)this._bindBoneBoneSlotDic={};
			if (this._boneSlotArray==null)this._boneSlotArray=[];
			var tArr=this._templet.boneSlotArray;
			var tBS;
			var tBSArr;
			for (i=0,n=tArr.length;i < n;i++){
				tBS=tArr[i];
				tBSArr=this._bindBoneBoneSlotDic[tBS.parent];
				if (tBSArr==null){
					this._bindBoneBoneSlotDic[tBS.parent]=tBSArr=[];
				}
				this._boneSlotDic[tBS.name]=tBS=tBS.copy();
				tBSArr.push(tBS);
				this._boneSlotArray.push(tBS);
			}
		}
	}

	__proto._emitMissedEvents=function(startTime,endTime,startIndex){
		(startIndex===void 0)&& (startIndex=0);
		var tEventAniArr=this._templet.eventAniArr;
		var tEventArr=tEventAniArr[this._player.currentAnimationClipIndex];
		if (tEventArr){
			var i=0,len=0;
			var tEventData;
			len=tEventArr.length;
			for (i=startIndex;i < len;i++){
				tEventData=tEventArr[i];
				if (tEventData.time >=this._player.playStart && tEventData.time <=this._player.playEnd){
					this.event("label",tEventData);
				}
			}
		}
	}

	/**
	*更新动画
	*@param autoKey true为正常更新，false为index手动更新
	*/
	__proto._update=function(autoKey){
		(autoKey===void 0)&& (autoKey=true);
		if (this._pause)return;
		if (autoKey && this._indexControl){
			return;
		};
		var tCurrTime=this.timer.currTimer;
		var preIndex=this._player.currentKeyframeIndex;
		var dTime=tCurrTime-this._lastTime;
		if (autoKey){
			this._player._update(dTime);
			}else {
			preIndex=-1;
		}
		this._lastTime=tCurrTime;
		if (!this._player)return;
		this._index=this._clipIndex=this._player.currentKeyframeIndex;
		if (this._index < 0)return;
		if (dTime > 0 && this._clipIndex==preIndex && this._lastUpdateAniClipIndex==this._aniClipIndex){
			return;
		}
		this._lastUpdateAniClipIndex=this._aniClipIndex;
		if (preIndex > this._clipIndex && this._eventIndex !=0){
			this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex);
			this._eventIndex=0;
		};
		var tEventData;
		var tEventAniArr=this._templet.eventAniArr;
		var tEventArr=tEventAniArr[this._aniClipIndex];
		if (tEventArr && this._eventIndex < tEventArr.length){
			tEventData=tEventArr[this._eventIndex];
			if (tEventData.time >=this._player.playStart && tEventData.time <=this._player.playEnd){
				if (this._player.currentPlayTime >=tEventData.time){
					this.event("label",tEventData);
					this._eventIndex++;
				}
				}else {
				this._eventIndex++;
			}
		};
		var tGraphics;
		if (this._aniMode==0){
			tGraphics=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex);
			if (tGraphics){
				if (this.graphics !=tGraphics){
					this.graphics=tGraphics;
				}
				return;
				}else {
				var i=0,minIndex=0;
				minIndex=this._clipIndex;
				while ((!this._templet.getGrahicsDataWithCache(this._aniClipIndex,minIndex-1))&& (minIndex > 0)){
					minIndex--;
				}
				if (minIndex < this._clipIndex){
					for (i=minIndex;i < this._clipIndex;i++){
						this._createGraphics(i);
					}
				}
			}
			}else if (this._aniMode==1){
			tGraphics=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex);
			if (tGraphics){
				if (this.graphics !=tGraphics){
					this.graphics=tGraphics;
				}
				return;
				}else {
				minIndex=this._clipIndex;
				while ((!this._getGrahicsDataWithCache(this._aniClipIndex,minIndex-1))&& (minIndex > 0)){
					minIndex--;
				}
				if (minIndex < this._clipIndex){
					for (i=minIndex;i < this._clipIndex;i++){
						this._createGraphics(i);
					}
				}
			}
		}
		this._createGraphics();
	}

	/**
	*@private
	*创建grahics图像
	*/
	__proto._createGraphics=function(_clipIndex){
		(_clipIndex===void 0)&& (_clipIndex=-1);
		if (_clipIndex==-1)_clipIndex=this._clipIndex;
		var curTime=_clipIndex *this._player.cacheFrameRateInterval;
		var tDrawOrderData;
		var tDrawOrderAniArr=this._templet.drawOrderAniArr;
		var tDrawOrderArr=tDrawOrderAniArr[this._aniClipIndex];
		if (tDrawOrderArr && tDrawOrderArr.length > 0){
			this._drawOrderIndex=0;
			tDrawOrderData=tDrawOrderArr[this._drawOrderIndex];
			while (curTime >=tDrawOrderData.time){
				this._drawOrder=tDrawOrderData.drawOrder;
				this._drawOrderIndex++;
				if (this._drawOrderIndex >=tDrawOrderArr.length){
					break ;
				}
				tDrawOrderData=tDrawOrderArr[this._drawOrderIndex];
			}
		};
		var tGraphics;
		if (this._aniMode==0 || this._aniMode==1){
			this.graphics=GraphicsAni.create();
			}else {
			if ((this.graphics instanceof laya.ani.GraphicsAni )){
				this.graphics.clear();
				}else {
				this.graphics=GraphicsAni.create();
			}
		}
		tGraphics=this.graphics;
		var bones=this._templet.getNodes(this._aniClipIndex);
		this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],_clipIndex,curTime);
		var tSectionArr=this._aniSectionDic[this._aniClipIndex];
		var tParentMatrix;
		var tStartIndex=0;
		var i=0,j=0,k=0,n=0;
		var tDBBoneSlot;
		var tDBBoneSlotArr;
		var tParentTransform;
		var tSrcBone;
		var boneCount=this._templet.srcBoneMatrixArr.length;
		for (i=0,n=tSectionArr[0];i < boneCount;i++){
			tSrcBone=this._boneList[i];
			tParentTransform=this._templet.srcBoneMatrixArr[i];
			tSrcBone.resultTransform.scX=tParentTransform.scX *this._curOriginalData[tStartIndex++];
			tSrcBone.resultTransform.skX=tParentTransform.skX+this._curOriginalData[tStartIndex++];
			tSrcBone.resultTransform.skY=tParentTransform.skY+this._curOriginalData[tStartIndex++];
			tSrcBone.resultTransform.scY=tParentTransform.scY *this._curOriginalData[tStartIndex++];
			tSrcBone.resultTransform.x=tParentTransform.x+this._curOriginalData[tStartIndex++];
			tSrcBone.resultTransform.y=tParentTransform.y+this._curOriginalData[tStartIndex++];
			if (this._templet.tMatrixDataLen===8){
				tSrcBone.resultTransform.skewX=tParentTransform.skewX+this._curOriginalData[tStartIndex++];
				tSrcBone.resultTransform.skewY=tParentTransform.skewY+this._curOriginalData[tStartIndex++];
			}
		};
		var tSlotDic={};
		var tSlotAlphaDic={};
		var tBoneData;
		for (n+=tSectionArr[1];i < n;i++){
			tBoneData=bones[i];
			tSlotDic[tBoneData.name]=this._curOriginalData[tStartIndex++];
			tSlotAlphaDic[tBoneData.name]=this._curOriginalData[tStartIndex++];
			this._curOriginalData[tStartIndex++];
			this._curOriginalData[tStartIndex++];
			this._curOriginalData[tStartIndex++];
			this._curOriginalData[tStartIndex++];
		};
		var tBendDirectionDic={};
		var tMixDic={};
		for (n+=tSectionArr[2];i < n;i++){
			tBoneData=bones[i];
			tBendDirectionDic[tBoneData.name]=this._curOriginalData[tStartIndex++];
			tMixDic[tBoneData.name]=this._curOriginalData[tStartIndex++];
			this._curOriginalData[tStartIndex++];
			this._curOriginalData[tStartIndex++];
			this._curOriginalData[tStartIndex++];
			this._curOriginalData[tStartIndex++];
		}
		if (this._pathDic){
			var tPathConstraint;
			for (n+=tSectionArr[3];i < n;i++){
				tBoneData=bones[i];
				tPathConstraint=this._pathDic[tBoneData.name];
				if (tPathConstraint){
					var tByte=new Byte(tBoneData.extenData);
					switch (tByte.getByte()){
						case 1:
							tPathConstraint.position=this._curOriginalData[tStartIndex++];
							break ;
						case 2:
							tPathConstraint.spacing=this._curOriginalData[tStartIndex++];
							break ;
						case 3:
							tPathConstraint.rotateMix=this._curOriginalData[tStartIndex++];
							tPathConstraint.translateMix=this._curOriginalData[tStartIndex++];
							break ;
						}
				}
			}
		}
		if (this._yReverseMatrix){
			this._rootBone.update(this._yReverseMatrix);
			}else {
			this._rootBone.update(Matrix.TEMP.identity());
		}
		if (this._ikArr){
			var tIkConstraint;
			for (i=0,n=this._ikArr.length;i < n;i++){
				tIkConstraint=this._ikArr[i];
				if (tBendDirectionDic.hasOwnProperty(tIkConstraint.name)){
					tIkConstraint.bendDirection=tBendDirectionDic[tIkConstraint.name];
				}
				if (tMixDic.hasOwnProperty(tIkConstraint.name)){
					tIkConstraint.mix=tMixDic[tIkConstraint.name]
				}
				tIkConstraint.apply();
			}
		}
		if (this._pathDic){
			for (var tPathStr in this._pathDic){
				tPathConstraint=this._pathDic[tPathStr];
				tPathConstraint.apply(this._boneList,tGraphics);
			}
		}
		if (this._tfArr){
			var tTfConstraint;
			for (i=0,k=this._tfArr.length;i < k;i++){
				tTfConstraint=this._tfArr[i];
				tTfConstraint.apply();
			}
		}
		for (i=0,k=this._boneList.length;i < k;i++){
			tSrcBone=this._boneList[i];
			tDBBoneSlotArr=this._bindBoneBoneSlotDic[tSrcBone.name];
			tSrcBone.resultMatrix.copyTo(this._boneMatrixArray[i]);
			if (tDBBoneSlotArr){
				for (j=0,n=tDBBoneSlotArr.length;j < n;j++){
					tDBBoneSlot=tDBBoneSlotArr[j];
					if (tDBBoneSlot){
						tDBBoneSlot.setParentMatrix(tSrcBone.resultMatrix);
					}
				}
			}
		};
		var tDeformDic={};
		var tDeformAniArr=this._templet.deformAniArr;
		var tDeformAniData;
		var tDeformSlotData;
		var tDeformSlotDisplayData;
		if (tDeformAniArr && tDeformAniArr.length > 0){
			if (this._lastAniClipIndex !=this._aniClipIndex){
				this._lastAniClipIndex=this._aniClipIndex;
				for (i=0,n=this._boneSlotArray.length;i < n;i++){
					tDBBoneSlot=this._boneSlotArray[i];
					tDBBoneSlot.deformData=null;
				}
			};
			var tSkinDeformAni=tDeformAniArr[this._aniClipIndex];
			tDeformAniData=(tSkinDeformAni["default"]);
			this._setDeform(tDeformAniData,tDeformDic,this._boneSlotArray,curTime);
			var tSkin;
			for (tSkin in tSkinDeformAni){
				if (tSkin !="default" && tSkin !=this._skinName){
					tDeformAniData=tSkinDeformAni [tSkin];
					this._setDeform(tDeformAniData,tDeformDic,this._boneSlotArray,curTime);
				}
			}
			tDeformAniData=(tSkinDeformAni[this._skinName]);
			this._setDeform(tDeformAniData,tDeformDic,this._boneSlotArray,curTime);
		};
		var tSlotData2;
		var tSlotData3;
		var tObject;
		if (this._drawOrder){
			for (i=0,n=this._drawOrder.length;i < n;i++){
				tDBBoneSlot=this._boneSlotArray[this._drawOrder[i]];
				tSlotData2=tSlotDic[tDBBoneSlot.name];
				tSlotData3=tSlotAlphaDic[tDBBoneSlot.name];
				if (!isNaN(tSlotData3)){
					tGraphics.save();
					tGraphics.alpha(tSlotData3);
				}
				if (!isNaN(tSlotData2)&& tSlotData2 !=-2){
					if (this._templet.attachmentNames){
						tDBBoneSlot.showDisplayByName(this._templet.attachmentNames[tSlotData2]);
						}else {
						tDBBoneSlot.showDisplayByIndex(tSlotData2);
					}
				}
				if (tDeformDic[this._drawOrder[i]]){
					tObject=tDeformDic[this._drawOrder[i]];
					if (tDBBoneSlot.currDisplayData && tObject[tDBBoneSlot.currDisplayData.attachmentName]){
						tDBBoneSlot.deformData=tObject[tDBBoneSlot.currDisplayData.attachmentName];
						}else {
						tDBBoneSlot.deformData=null;
					}
					}else {
					tDBBoneSlot.deformData=null;
				}
				if (!isNaN(tSlotData3)){
					tDBBoneSlot.draw(tGraphics,this._boneMatrixArray,this._aniMode==2,tSlotData3);
					}else {
					tDBBoneSlot.draw(tGraphics,this._boneMatrixArray,this._aniMode==2);
				}
				if (!isNaN(tSlotData3)){
					tGraphics.restore();
				}
			}
			}else {
			for (i=0,n=this._boneSlotArray.length;i < n;i++){
				tDBBoneSlot=this._boneSlotArray[i];
				tSlotData2=tSlotDic[tDBBoneSlot.name];
				tSlotData3=tSlotAlphaDic[tDBBoneSlot.name];
				if (!isNaN(tSlotData3)){
					tGraphics.save();
					tGraphics.alpha(tSlotData3);
				}
				if (!isNaN(tSlotData2)&& tSlotData2 !=-2){
					if (this._templet.attachmentNames){
						tDBBoneSlot.showDisplayByName(this._templet.attachmentNames[tSlotData2]);
						}else {
						tDBBoneSlot.showDisplayByIndex(tSlotData2);
					}
				}
				if (tDeformDic[i]){
					tObject=tDeformDic[i];
					if (tDBBoneSlot.currDisplayData && tObject[tDBBoneSlot.currDisplayData.attachmentName]){
						tDBBoneSlot.deformData=tObject[tDBBoneSlot.currDisplayData.attachmentName];
						}else {
						tDBBoneSlot.deformData=null;
					}
					}else {
					tDBBoneSlot.deformData=null;
				}
				if (!isNaN(tSlotData3)){
					tDBBoneSlot.draw(tGraphics,this._boneMatrixArray,this._aniMode==2,tSlotData3);
					}else {
					tDBBoneSlot.draw(tGraphics,this._boneMatrixArray,this._aniMode==2);
				}
				if (!isNaN(tSlotData3)){
					tGraphics.restore();
				}
			}
		}
		if (this._aniMode==0){
			this._templet.setGrahicsDataWithCache(this._aniClipIndex,_clipIndex,tGraphics);
			}else if (this._aniMode==1){
			this._setGrahicsDataWithCache(this._aniClipIndex,_clipIndex,tGraphics);
		}
	}

	/**
	*设置deform数据
	*@param tDeformAniData
	*@param tDeformDic
	*@param _boneSlotArray
	*@param curTime
	*/
	__proto._setDeform=function(tDeformAniData,tDeformDic,_boneSlotArray,curTime){
		if (!tDeformAniData)return;
		var tDeformSlotData;
		var tDeformSlotDisplayData;
		var tDBBoneSlot;
		var i=0,n=0,j=0;
		if (tDeformAniData){
			for (i=0,n=tDeformAniData.deformSlotDataList.length;i < n;i++){
				tDeformSlotData=tDeformAniData.deformSlotDataList[i];
				for (j=0;j < tDeformSlotData.deformSlotDisplayList.length;j++){
					tDeformSlotDisplayData=tDeformSlotData.deformSlotDisplayList[j];
					tDBBoneSlot=_boneSlotArray[tDeformSlotDisplayData.slotIndex];
					tDeformSlotDisplayData.apply(curTime,tDBBoneSlot);
					if (!tDeformDic[tDeformSlotDisplayData.slotIndex]){
						tDeformDic[tDeformSlotDisplayData.slotIndex]={};
					}
					tDeformDic[tDeformSlotDisplayData.slotIndex][tDeformSlotDisplayData.attachment]=tDeformSlotDisplayData.deformData;
				}
			}
		}
	}

	/**
	*得到当前动画的数量
	*@return 当前动画的数量
	*/
	__proto.getAnimNum=function(){
		return this._templet.getAnimationCount();
	}

	/**
	*得到指定动画的名字
	*@param index 动画的索引
	*/
	__proto.getAniNameByIndex=function(index){
		return this._templet.getAniNameByIndex(index);
	}

	/**
	*通过名字得到插槽的引用
	*@param name 动画的名字
	*@return 插槽的引用
	*/
	__proto.getSlotByName=function(name){
		return this._boneSlotDic[name];
	}

	/**
	*通过名字显示一套皮肤
	*@param name 皮肤的名字
	*@param freshSlotIndex 是否将插槽纹理重置到初始化状态
	*/
	__proto.showSkinByName=function(name,freshSlotIndex){
		(freshSlotIndex===void 0)&& (freshSlotIndex=true);
		this.showSkinByIndex(this._templet.getSkinIndexByName(name),freshSlotIndex);
	}

	/**
	*通过索引显示一套皮肤
	*@param skinIndex 皮肤索引
	*@param freshSlotIndex 是否将插槽纹理重置到初始化状态
	*/
	__proto.showSkinByIndex=function(skinIndex,freshSlotIndex){
		(freshSlotIndex===void 0)&& (freshSlotIndex=true);
		for (var i=0;i < this._boneSlotArray.length;i++){
			(this._boneSlotArray [i]).showSlotData(null,freshSlotIndex);
		}
		if (this._templet.showSkinByIndex(this._boneSlotDic,skinIndex,freshSlotIndex)){
			var tSkinData=this._templet.skinDataArray[skinIndex];
			this._skinIndex=skinIndex;
			this._skinName=tSkinData.name;
		}
		this._clearCache();
	}

	/**
	*设置某插槽的皮肤
	*@param slotName 插槽名称
	*@param index 插糟皮肤的索引
	*/
	__proto.showSlotSkinByIndex=function(slotName,index){
		if (this._aniMode==0)return;
		var tBoneSlot=this.getSlotByName(slotName);
		if (tBoneSlot){
			tBoneSlot.showDisplayByIndex(index);
		}
		this._clearCache();
	}

	/**
	*设置某插槽的皮肤
	*@param slotName 插槽名称
	*@param name 皮肤名称
	*/
	__proto.showSlotSkinByName=function(slotName,name){
		if (this._aniMode==0)return;
		var tBoneSlot=this.getSlotByName(slotName);
		if (tBoneSlot){
			tBoneSlot.showDisplayByName(name);
		}
		this._clearCache();
	}

	/**
	*替换插槽贴图名
	*@param slotName 插槽名称
	*@param oldName 要替换的贴图名
	*@param newName 替换后的贴图名
	*/
	__proto.replaceSlotSkinName=function(slotName,oldName,newName){
		if (this._aniMode==0)return;
		var tBoneSlot=this.getSlotByName(slotName);
		if (tBoneSlot){
			tBoneSlot.replaceDisplayByName(oldName,newName);
		}
		this._clearCache();
	}

	/**
	*替换插槽的贴图索引
	*@param slotName 插槽名称
	*@param oldIndex 要替换的索引
	*@param newIndex 替换后的索引
	*/
	__proto.replaceSlotSkinByIndex=function(slotName,oldIndex,newIndex){
		if (this._aniMode==0)return;
		var tBoneSlot=this.getSlotByName(slotName);
		if (tBoneSlot){
			tBoneSlot.replaceDisplayByIndex(oldIndex,newIndex);
		}
		this._clearCache();
	}

	/**
	*设置自定义皮肤
	*@param name 插糟的名字
	*@param texture 自定义的纹理
	*/
	__proto.setSlotSkin=function(slotName,texture){
		if (this._aniMode==0)return;
		var tBoneSlot=this.getSlotByName(slotName);
		if (tBoneSlot){
			tBoneSlot.replaceSkin(texture);
		}
		this._clearCache();
	}

	/**
	*换装的时候，需要清一下缓冲区
	*/
	__proto._clearCache=function(){
		if (this._aniMode==1){
			for (var i=0,n=this._graphicsCache.length;i < n;i++){
				for (var j=0,len=this._graphicsCache[i].length;j < len;j++){
					var gp=this._graphicsCache[i][j];
					if (gp !=this.graphics){
						GraphicsAni.recycle(gp);
					}
				}
				this._graphicsCache[i].length=0;
			}
		}
	}

	/**
	*播放动画
	*
	*@param nameOrIndex 动画名字或者索引
	*@param loop 是否循环播放
	*@param force false,如果要播的动画跟上一个相同就不生效,true,强制生效
	*@param start 起始时间
	*@param end 结束时间
	*@param freshSkin 是否刷新皮肤数据
	*/
	__proto.play=function(nameOrIndex,loop,force,start,end,freshSkin){
		(force===void 0)&& (force=true);
		(start===void 0)&& (start=0);
		(end===void 0)&& (end=0);
		(freshSkin===void 0)&& (freshSkin=true);
		this._indexControl=false;
		var index=-1;
		var duration=NaN;
		if (loop){
			duration=2147483647;
			}else {
			duration=0;
		}
		if ((typeof nameOrIndex=='string')){
			for (var i=0,n=this._templet.getAnimationCount();i < n;i++){
				var animation=this._templet.getAnimation(i);
				if (animation && nameOrIndex==animation.name){
					index=i;
					break ;
				}
			}
			}else {
			index=nameOrIndex;
		}
		if (index >-1 && index < this.getAnimNum()){
			this._aniClipIndex=index;
			if (force || this._pause || this._currAniIndex !=index){
				this._currAniIndex=index;
				this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(index));
				this._drawOrder=null;
				this._eventIndex=0;
				this._player.play(index,this._player.playbackRate,duration,start,end);
				if (freshSkin)
					this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex);
				if (this._pause){
					this._pause=false;
					this._lastTime=Browser.now();
					this.timer.frameLoop(1,this,this._update,null,true);
				}
				this._update();
			}
		}
	}

	/**
	*停止动画
	*/
	__proto.stop=function(){
		if (!this._pause){
			this._pause=true;
			if (this._player){
				this._player.stop(true);
			}
			this.timer.clear(this,this._update);
		}
	}

	/**
	*设置动画播放速率
	*@param value 1为标准速率
	*/
	__proto.playbackRate=function(value){
		if (this._player){
			this._player.playbackRate=value;
		}
	}

	/**
	*暂停动画的播放
	*/
	__proto.paused=function(){
		if (!this._pause){
			this._pause=true;
			if (this._player){
				this._player.paused=true;
			}
			this.timer.clear(this,this._update);
		}
	}

	/**
	*恢复动画的播放
	*/
	__proto.resume=function(){
		this._indexControl=false;
		if (this._pause){
			this._pause=false;
			if (this._player){
				this._player.paused=false;
			}
			this._lastTime=Browser.now();
			this.timer.frameLoop(1,this,this._update,null,true);
		}
	}

	/**
	*@private
	*得到缓冲数据
	*@param aniIndex
	*@param frameIndex
	*@return
	*/
	__proto._getGrahicsDataWithCache=function(aniIndex,frameIndex){
		return this._graphicsCache[aniIndex][frameIndex];
	}

	/**
	*@private
	*保存缓冲grahpics
	*@param aniIndex
	*@param frameIndex
	*@param graphics
	*/
	__proto._setGrahicsDataWithCache=function(aniIndex,frameIndex,graphics){
		this._graphicsCache[aniIndex][frameIndex]=graphics;
	}

	/**
	*销毁当前动画
	*/
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._templet=null;
		if (this._player)this._player.offAll();
		this._player=null;
		this._curOriginalData=null;
		this._boneMatrixArray.length=0;
		this._lastTime=0;
		this.timer.clear(this,this._update);
	}

	/**
	*设置动画路径
	*/
	/**
	*得到资源的URL
	*/
	__getset(0,__proto,'url',function(){
		return this._aniPath;
		},function(path){
		this.load(path);
	});

	/**
	*@private
	*设置帧索引
	*/
	/**
	*@private
	*得到帧索引
	*/
	__getset(0,__proto,'index',function(){
		return this._index;
		},function(value){
		if (this.player){
			this._index=value;
			this._player.currentTime=this._index *1000 / this._player.cacheFrameRate;
			this._indexControl=true;
			this._update(false);
		}
	});

	/**
	*得到总帧数据
	*/
	__getset(0,__proto,'total',function(){
		if (this._templet && this._player){
			this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/ 1000 *this._player.cacheFrameRate);
			}else {
			this._total=-1;
		}
		return this._total;
	});

	/**
	*得到动画模板的引用
	*/
	__getset(0,__proto,'templet',function(){
		return this._templet;
	});

	/**
	*得到播放器的引用
	*/
	__getset(0,__proto,'player',function(){
		return this._player;
	});

	Skeleton.useSimpleMeshInCanvas=false;
	return Skeleton;
})(Sprite)


/**
*
*@author ww
*@version 1.0
*
*@created 2015-12-30 下午2:03:32
*/
//class laya.debug.tools.comps.ArrowLine extends laya.display.Sprite
var ArrowLine=(function(_super){
	function ArrowLine(sign){
		this.lineLen=160;
		this.arrowLen=10;
		this.sign="Y";
		this._targetChanger=null;
		this._isMoving=false;
		this.lenControl=new Rect();
		this.rotationControl=new Rect();
		this.lenChanger=ValueChanger.create(this,"lineLen");
		this.lenControlXChanger=ValueChanger.create(this.lenControl,"x");
		(sign===void 0)&& (sign="X");
		ArrowLine.__super.call(this);
		this.sign=sign;
		this.addChild(this.lenControl);
		this.addChild(this.rotationControl);
		this.lenControl.on("mousedown",this,this.controlMouseDown);
		this.drawMe();
	}

	__class(ArrowLine,'laya.debug.tools.comps.ArrowLine',_super);
	var __proto=ArrowLine.prototype;
	__proto.drawMe=function(){
		var g;
		g=this.graphics;
		g.clear();
		g.drawLine(0,0,this.lineLen,0,"#ffff00");
		g.drawLine(this.lineLen,0,this.lineLen-this.arrowLen,-this.arrowLen,"#ff0000");
		g.drawLine(this.lineLen,0,this.lineLen-this.arrowLen,this.arrowLen,"#ff0000");
		g.fillText(this.sign,50,-5,"","#ff0000","left");
		if(this._isMoving&&this._targetChanger){
			g.fillText(this._targetChanger.key+":"+this._targetChanger.value.toFixed(2),this.lineLen-15,-25,"","#ffff00","center");
		}
		this.lenControl.posTo(this.lineLen-15,0);
		this.rotationControl.posTo(this.lineLen+10,0);
		this.size(this.arrowLen,this.lineLen);
	}

	__proto.clearMoveEvents=function(){
		Laya.stage.off("mousemove",this,this.stageMouseMove);
		Laya.stage.off("mouseup",this,this.stageMouseUp);
	}

	__proto.controlMouseDown=function(e){
		this.clearMoveEvents();
		this.lenControlXChanger.record();
		this.lenChanger.record();
		if(this.targetChanger){
			this.targetChanger.record();
		}
		this._isMoving=true;
		Laya.stage.on("mousemove",this,this.stageMouseMove);
		Laya.stage.on("mouseup",this,this.stageMouseUp);
	}

	__proto.stageMouseMove=function(e){
		this.lenControlXChanger.value=this.mouseX;
		this.lenChanger.showValueByScale(this.lenControlXChanger.scaleValue);
		if(this.targetChanger){
			this.targetChanger.showValueByScale(this.lenControlXChanger.scaleValue);
		}
		this.drawMe();
	}

	__proto.stageMouseUp=function(e){
		this._isMoving=false;
		this.noticeChange();
		this.clearMoveEvents();
		this.lenControlXChanger.recover();
		this.lenChanger.recover();
		this.drawMe();
	}

	__proto.noticeChange=function(){
		var dLen=NaN;
		dLen=this.lenChanger.dValue;
		console.log("lenChange:",dLen);
	}

	__getset(0,__proto,'targetChanger',function(){
		return this._targetChanger;
		},function(changer){
		if(this._targetChanger){
			this._targetChanger.dispose();
		}
		this._targetChanger=changer;
	});

	return ArrowLine;
})(Sprite)


/**
*
*@author ww
*@version 1.0
*
*@created 2015-12-30 下午2:37:05
*/
//class laya.debug.tools.comps.Axis extends laya.display.Sprite
var Axis=(function(_super){
	function Axis(){
		this._target=null;
		this._lenType=
		[
		["width","height"],
		["scaleX","scaleY"]];
		this._type=1;
		this.xAxis=new ArrowLine("X");
		this.yAxis=new ArrowLine("Y");
		this.controlBox=new Rect();
		this._point=new Point();
		this.oPoint=new Point();
		this.myRotationChanger=ValueChanger.create(this,"rotation");
		this.targetRotationChanger=ValueChanger.create(null,"rotation");
		this.stageMouseRotationChanger=new ValueChanger();
		Axis.__super.call(this);
		this.mouseEnabled=true;
		this.size(1,1);
		this.initMe();
		this.xAxis.rotationControl.on("mousedown",this,this.controlMouseDown);
		this.yAxis.rotationControl.on("mousedown",this,this.controlMouseDown);
		this.controlBox.on("mousedown",this,this.controlBoxMouseDown);
		this.on("dragmove",this,this.dragging);
	}

	__class(Axis,'laya.debug.tools.comps.Axis',_super);
	var __proto=Axis.prototype;
	__proto.updateChanges=function(){
		if(this._target){
			var params;
			params=this._lenType[this._type];
			this.xAxis.targetChanger=ValueChanger.create(this._target,params[0]);
			this.yAxis.targetChanger=ValueChanger.create(this._target,params[1]);
		}
	}

	__proto.switchType=function(){
		this._type++;
		this._type=this._type%this._lenType.length;
		this.type=this._type;
	}

	__proto.controlBoxMouseDown=function(e){
		this.startDrag();
	}

	__proto.dragging=function(){
		if (this._target){
			this._point.setTo(this.x,this.y);
			DisControlTool.transPoint(this.parent,this._target.parent,this._point);
			this._target.pos(this._point.x,this._point.y);
		}
	}

	__proto.initMe=function(){
		this.addChild(this.xAxis);
		this.addChild(this.yAxis);
		this.yAxis.rotation=90;
		this.addChild(this.controlBox);
		this.controlBox.posTo(0,0);
	}

	__proto.clearMoveEvents=function(){
		Laya.stage.off("mousemove",this,this.stageMouseMove);
		Laya.stage.off("mouseup",this,this.stageMouseUp);
	}

	__proto.controlMouseDown=function(e){
		this.targetRotationChanger.target=this.target;
		this.clearMoveEvents();
		this.oPoint.setTo(0,0);
		this.myRotationChanger.record();
		this.oPoint=this.localToGlobal(this.oPoint);
		this.stageMouseRotationChanger.value=this.getStageMouseRatation();
		this.stageMouseRotationChanger.record();
		this.targetRotationChanger.record();
		Laya.stage.on("mousemove",this,this.stageMouseMove);
		Laya.stage.on("mouseup",this,this.stageMouseUp);
	}

	__proto.getStageMouseRatation=function(){
		return MathUtil.getRotation(this.oPoint.x,this.oPoint.y,Laya.stage.mouseX,Laya.stage.mouseY);
	}

	__proto.stageMouseMove=function(e){
		this.stageMouseRotationChanger.value=this.getStageMouseRatation();
		var dRotation=NaN;
		dRotation=-this.stageMouseRotationChanger.dValue;
		if(this.target){
			this.targetRotationChanger.showValueByAdd(dRotation);
			}else{
			this.myRotationChanger.showValueByAdd(dRotation);
		}
	}

	__proto.stageMouseUp=function(e){
		this.noticeChange();
		this.clearMoveEvents();
	}

	__proto.noticeChange=function(){
		console.log("rotate:",-this.stageMouseRotationChanger.dValue);
	}

	__getset(0,__proto,'target',function(){
		return this._target;
		},function(tar){
		this._target=tar;
		this.updateChanges();
	});

	__getset(0,__proto,'type',function(){
		return this._type;
		},function(lenType){
		this._type=lenType;
		this.updateChanges();
	});

	return Axis;
})(Sprite)


/**
*
*@author ww
*@version 1.0
*
*@created 2015-12-30 下午3:23:06
*/
//class laya.debug.tools.comps.Rect extends laya.display.Sprite
var Rect=(function(_super){
	function Rect(){
		this.recWidth=10;
		Rect.__super.call(this);
		this.drawMe();
	}

	__class(Rect,'laya.debug.tools.comps.Rect',_super);
	var __proto=Rect.prototype;
	__proto.drawMe=function(){
		var g;
		g=this.graphics;
		g.clear();
		g.drawRect(0,0,this.recWidth,this.recWidth,"#22ff22");
		this.size(this.recWidth,this.recWidth);
	}

	__proto.posTo=function(x,y){
		this.x=x-this.recWidth*0.5;
		this.y=y-this.recWidth*0.5;
	}

	return Rect;
})(Sprite)


/**
*<p> <code>Text</code> 类用于创建显示对象以显示文本。</p>
*<p>
*注意：如果运行时系统找不到设定的字体，则用系统默认的字体渲染文字，从而导致显示异常。(通常电脑上显示正常，在一些移动端因缺少设置的字体而显示异常)。
*</p>
*@example
*package
*{
	*import laya.display.Text;
	*public class Text_Example
	*{
		*public function Text_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*onInit();
			*}
		*private function onInit():void
		*{
			*var text:Text=new Text();//创建一个 Text 类的实例对象 text 。
			*text.text="这个是一个 Text 文本示例。";
			*text.color="#008fff";//设置 text 的文本颜色。
			*text.font="Arial";//设置 text 的文本字体。
			*text.bold=true;//设置 text 的文本显示为粗体。
			*text.fontSize=30;//设置 text 的字体大小。
			*text.wordWrap=true;//设置 text 的文本自动换行。
			*text.x=100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。
			*text.y=100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。
			*text.width=300;//设置 text 的宽度。
			*text.height=200;//设置 text 的高度。
			*text.italic=true;//设置 text 的文本显示为斜体。
			*text.borderColor="#fff000";//设置 text 的文本边框颜色。
			*Laya.stage.addChild(text);//将 text 添加到显示列表。
			*}
		*}
	*}
*@example
*Text_Example();
*function Text_Example()
*{
	*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
	*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
	*onInit();
	*}
*function onInit()
*{
	*var text=new laya.display.Text();//创建一个 Text 类的实例对象 text 。
	*text.text="这个是一个 Text 文本示例。";
	*text.color="#008fff";//设置 text 的文本颜色。
	*text.font="Arial";//设置 text 的文本字体。
	*text.bold=true;//设置 text 的文本显示为粗体。
	*text.fontSize=30;//设置 text 的字体大小。
	*text.wordWrap=true;//设置 text 的文本自动换行。
	*text.x=100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。
	*text.y=100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。
	*text.width=300;//设置 text 的宽度。
	*text.height=200;//设置 text 的高度。
	*text.italic=true;//设置 text 的文本显示为斜体。
	*text.borderColor="#fff000";//设置 text 的文本边框颜色。
	*Laya.stage.addChild(text);//将 text 添加到显示列表。
	*}
*@example
*class Text_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*this.onInit();
		*}
	*private onInit():void {
		*var text:laya.display.Text=new laya.display.Text();//创建一个 Text 类的实例对象 text 。
		*text.text="这个是一个 Text 文本示例。";
		*text.color="#008fff";//设置 text 的文本颜色。
		*text.font="Arial";//设置 text 的文本字体。
		*text.bold=true;//设置 text 的文本显示为粗体。
		*text.fontSize=30;//设置 text 的字体大小。
		*text.wordWrap=true;//设置 text 的文本自动换行。
		*text.x=100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。
		*text.y=100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。
		*text.width=300;//设置 text 的宽度。
		*text.height=200;//设置 text 的高度。
		*text.italic=true;//设置 text 的文本显示为斜体。
		*text.borderColor="#fff000";//设置 text 的文本边框颜色。
		*Laya.stage.addChild(text);//将 text 添加到显示列表。
		*}
	*}
*/
//class laya.display.Text extends laya.display.Sprite
var Text=(function(_super){
	function Text(){
		/**@private */
		this._clipPoint=null;
		/**当前使用的位置字体。*/
		this._currBitmapFont=null;
		/**@private 表示文本内容字符串。*/
		this._text=null;
		/**@private 表示文本内容是否发生改变。*/
		this._isChanged=false;
		/**@private 表示文本的宽度，以像素为单位。*/
		this._textWidth=0;
		/**@private 表示文本的高度，以像素为单位。*/
		this._textHeight=0;
		/**@private 存储文字行数信息。*/
		this._lines=[];
		/**@private 保存每行宽度*/
		this._lineWidths=[];
		/**@private 文本的内容位置 X 轴信息。*/
		this._startX=NaN;
		/**@private 文本的内容位置X轴信息。 */
		this._startY=NaN;
		/**@private 当前可视行索引。*/
		this._lastVisibleLineIndex=-1;
		/**@private 当前可视行索引。*/
		this._words=null;
		/**@private */
		this._charSize={};
		/**
		*是否显示下划线。
		*/
		this.underline=false;
		/**
		*下划线的颜色，为null则使用字体颜色。
		*/
		this._underlineColor=null;
		Text.__super.call(this);
		this.overflow=Text.VISIBLE;
		this._style=new CSSStyle(this);
		(this._style).wordWrap=false;
	}

	__class(Text,'laya.display.Text',_super);
	var __proto=Text.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._lines=null;
		if (this._words){
			this._words.length=0;
			this._words=null;
		}
	}

	/**
	*@private
	*@inheritDoc
	*/
	__proto._getBoundPointsM=function(ifRotate){
		(ifRotate===void 0)&& (ifRotate=false);
		var rec=Rectangle.TEMP;
		rec.setTo(0,0,this.width,this.height);
		return rec._getBoundPoints();
	}

	/**
	*@inheritDoc
	*/
	__proto.getGraphicBounds=function(realSize){
		(realSize===void 0)&& (realSize=false);
		var rec=Rectangle.TEMP;
		rec.setTo(0,0,this.width,this.height);
		return rec;
	}

	/**
	*@private
	*@inheritDoc
	*/
	__proto._getCSSStyle=function(){
		return this._style;
	}

	/**
	*<p>根据指定的文本，从语言包中取当前语言的文本内容。并对此文本中的{i}文本进行替换。</p>
	*<p>设置Text.langPacks语言包后，即可使用lang获取里面的语言</p>
	*<p>例如：
	*<li>（1）text 的值为“我的名字”，先取到这个文本对应的当前语言版本里的值“My name”，将“My name”设置为当前文本的内容。</li>
	*<li>（2）text 的值为“恭喜你赢得{0}个钻石，{1}经验。”，arg1 的值为100，arg2 的值为200。
	*则先取到这个文本对应的当前语言版本里的值“Congratulations on your winning {0}diamonds,{1}experience.”，
	*然后将文本里的{0}、{1}，依据括号里的数字从0开始替换为 arg1、arg2 的值。
	*将替换处理后的文本“Congratulations on your winning 100 diamonds,200 experience.”设置为当前文本的内容。
	*</li>
	*</p>
	*@param text 文本内容。
	*@param ...args 文本替换参数。
	*/
	__proto.lang=function(text,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10){
		text=Text.langPacks && Text.langPacks[text] ? Text.langPacks[text] :text;
		if (arguments.length < 2){
			this._text=text;
			}else {
			for (var i=0,n=arguments.length;i < n;i++){
				text=text.replace("{"+i+"}",arguments[i+1]);
			}
			this._text=text;
		}
	}

	/**
	*@private
	*/
	__proto._isPassWordMode=function(){
		var style=this._style;
		var password=style.password;
		if (("prompt" in this)&& this['prompt']==this._text)
			password=false;
		return password;
	}

	/**
	*@private
	*/
	__proto._getPassWordTxt=function(txt){
		var len=txt.length;
		var word;
		word="";
		for (var j=len;j > 0;j--){
			word+="●";
		}
		return word;
	}

	/**
	*渲染文字。
	*@param begin 开始渲染的行索引。
	*@param visibleLineCount 渲染的行数。
	*/
	__proto.renderText=function(begin,visibleLineCount){
		var graphics=this.graphics;
		graphics.clear(true);
		var ctxFont=(this.italic ? "italic " :"")+(this.bold ? "bold " :"")+this.fontSize+"px "+(Browser.onIPhone ? (laya.display.Text._fontFamilyMap[this.font] || this.font):this.font);
		Browser.context.font=ctxFont;
		var padding=this.padding;
		var startX=padding[3];
		var textAlgin="left";
		var lines=this._lines;
		var lineHeight=this.leading+this._charSize.height;
		var tCurrBitmapFont=this._currBitmapFont;
		if (tCurrBitmapFont){
			lineHeight=this.leading+tCurrBitmapFont.getMaxHeight();
		};
		var startY=padding[0];
		if ((!tCurrBitmapFont)&& this._width > 0 && this._textWidth <=this._width){
			if (this.align=="right"){
				textAlgin="right";
				startX=this._width-padding[1];
				}else if (this.align=="center"){
				textAlgin="center";
				startX=this._width *0.5+padding[3]-padding[1];
			}
		}
		if (this._height > 0){
			var tempVAlign=(this._textHeight > this._height)? "top" :this.valign;
			if (tempVAlign==="middle")
				startY=(this._height-visibleLineCount *lineHeight)*0.5+padding[0]-padding[2];
			else if (tempVAlign==="bottom")
			startY=this._height-visibleLineCount *lineHeight-padding[2];
		};
		var style=this._style;
		if (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize){
			var bitmapScale=tCurrBitmapFont.fontSize / this.fontSize;
		}
		if (this._clipPoint){
			graphics.save();
			if (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize){
				var tClipWidth=0;
				var tClipHeight=0;
				this._width ? tClipWidth=(this._width-padding[3]-padding[1]):tClipWidth=this._textWidth;
				this._height ? tClipHeight=(this._height-padding[0]-padding[2]):tClipHeight=this._textHeight;
				tClipWidth *=bitmapScale;
				tClipHeight *=bitmapScale;
				graphics.clipRect(padding[3],padding[0],tClipWidth,tClipHeight);
				}else {
				graphics.clipRect(padding[3],padding[0],this._width ? (this._width-padding[3]-padding[1]):this._textWidth,this._height ? (this._height-padding[0]-padding[2]):this._textHeight);
			}
		};
		var password=style.password;
		if (("prompt" in this)&& this['prompt']==this._text)
			password=false;
		var x=0,y=0;
		var end=Math.min(this._lines.length,visibleLineCount+begin)|| 1;
		for (var i=begin;i < end;i++){
			var word=lines[i];
			var _word;
			if (password){
				var len=word.length;
				word="";
				for (var j=len;j > 0;j--){
					word+="●";
				}
			}
			x=startX-(this._clipPoint ? this._clipPoint.x :0);
			y=startY+lineHeight *i-(this._clipPoint ? this._clipPoint.y :0);
			this.underline && this.drawUnderline(textAlgin,x,y,i);
			if (tCurrBitmapFont){
				var tWidth=this.width;
				if (tCurrBitmapFont.autoScaleSize){
					tWidth=this.width *bitmapScale;
				}
				tCurrBitmapFont.drawText(word,this,x,y,this.align,tWidth);
				}else {
				if (Render.isWebGL){
					this._words || (this._words=[]);
					_word=this._words.length > (i-begin)? this._words[i-begin] :new WordText();
					_word.setText(word);
					}else {
					_word=word;
				}
				style.stroke ? graphics.fillBorderText(_word,x,y,ctxFont,this.color,style.strokeColor,style.stroke,textAlgin):graphics.fillText(_word,x,y,ctxFont,this.color,textAlgin);
			}
		}
		if (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize){
			var tScale=1 / bitmapScale;
			this.scale(tScale,tScale);
		}
		if (this._clipPoint)
			graphics.restore();
		this._startX=startX;
		this._startY=startY;
	}

	/**
	*绘制下划线
	*@param x 本行坐标
	*@param y 本行坐标
	*@param lineIndex 本行索引
	*/
	__proto.drawUnderline=function(align,x,y,lineIndex){
		var lineWidth=this._lineWidths[lineIndex];
		switch (align){
			case 'center':
				x-=lineWidth / 2;
				break ;
			case 'right':
				x-=lineWidth;
				break ;
			case 'left':
			default :
				break ;
			}
		y+=this._charSize.height;
		this._graphics.drawLine(x,y,x+lineWidth,y,this.underlineColor || this.color,1);
	}

	/**
	*<p>排版文本。</p>
	*<p>进行宽高计算，渲染、重绘文本。</p>
	*/
	__proto.typeset=function(){
		this._isChanged=false;
		if (!this._text){
			this._clipPoint=null;
			this._textWidth=this._textHeight=0;
			this.graphics.clear(true);
			return;
		}
		Browser.context.font=this._getCSSStyle().font;
		this._lines.length=0;
		this._lineWidths.length=0;
		if (this._isPassWordMode()){
			this.parseLines(this._getPassWordTxt(this._text));
		}else
		this.parseLines(this._text);
		this.evalTextSize();
		if (this.checkEnabledViewportOrNot())
			this._clipPoint || (this._clipPoint=new Point(0,0));
		else
		this._clipPoint=null;
		var lineCount=this._lines.length;
		if (this.overflow !=Text.VISIBLE){
			var func=this.overflow==Text.HIDDEN ? Math.floor :Math.ceil;
			lineCount=Math.min(lineCount,func((this.height-this.padding[0]-this.padding[2])/ (this.leading+this._charSize.height)));
		};
		var startLine=this.scrollY / (this._charSize.height+this.leading)| 0;
		this.renderText(startLine,lineCount);
		this.repaint();
	}

	__proto.evalTextSize=function(){
		var nw=NaN,nh=NaN;
		nw=Math.max.apply(this,this._lineWidths);
		if (this._currBitmapFont)
			nh=this._lines.length *(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2];
		else
		nh=this._lines.length *(this._charSize.height+this.leading)+this.padding[0]+this.padding[2];
		if (nw !=this._textWidth || nh !=this._textHeight){
			this._textWidth=nw;
			this._textHeight=nh;
			if (!this._width || !this._height)
				this.conchModel && this.conchModel.size(this._width || this._textWidth,this._height || this._textHeight);
		}
	}

	__proto.checkEnabledViewportOrNot=function(){
		return this.overflow==Text.SCROLL && ((this._width > 0 && this._textWidth > this._width)|| (this._height > 0 && this._textHeight > this._height));
	}

	/**
	*<p>快速更改显示文本。不进行排版计算，效率较高。</p>
	*<p>如果只更改文字内容，不更改文字样式，建议使用此接口，能提高效率。</p>
	*@param text 文本内容。
	*/
	__proto.changeText=function(text){
		if (this._text!==text){
			this.lang(text+"");
			if (this._graphics && this._graphics.replaceText(this._text)){
				}else {
				this.typeset();
			}
		}
	}

	/**
	*@private
	*分析文本换行。
	*/
	__proto.parseLines=function(text){
		var needWordWrapOrTruncate=this.wordWrap || this.overflow==Text.HIDDEN;
		if (needWordWrapOrTruncate){
			var wordWrapWidth=this.getWordWrapWidth();
		}
		if (this._currBitmapFont){
			this._charSize.width=this._currBitmapFont.getMaxWidth();
			this._charSize.height=this._currBitmapFont.getMaxHeight();
			}else {
			var measureResult=Browser.context.measureText(Text._testWord);
			this._charSize.width=measureResult.width;
			this._charSize.height=(measureResult.height || this.fontSize);
		};
		var lines=text.replace(/\r\n/g,"\n").split("\n");
		for (var i=0,n=lines.length;i < n;i++){
			var line=lines[i];
			if (needWordWrapOrTruncate)
				this.parseLine(line,wordWrapWidth);
			else {
				this._lineWidths.push(this.getTextWidth(line));
				this._lines.push(line);
			}
		}
	}

	/**
	*@private
	*解析行文本。
	*@param line 某行的文本。
	*@param wordWrapWidth 文本的显示宽度。
	*/
	__proto.parseLine=function(line,wordWrapWidth){
		var ctx=Browser.context;
		var lines=this._lines;
		var maybeIndex=0;
		var execResult;
		var charsWidth=NaN;
		var wordWidth=NaN;
		var startIndex=0;
		charsWidth=this.getTextWidth(line);
		if (charsWidth <=wordWrapWidth){
			lines.push(line);
			this._lineWidths.push(charsWidth);
			return;
		}
		charsWidth=this._charSize.width;
		maybeIndex=Math.floor(wordWrapWidth / charsWidth);
		(maybeIndex==0)&& (maybeIndex=1);
		charsWidth=this.getTextWidth(line.substring(0,maybeIndex));
		wordWidth=charsWidth;
		for (var j=maybeIndex,m=line.length;j < m;j++){
			charsWidth=this.getTextWidth(line.charAt(j));
			wordWidth+=charsWidth;
			if (wordWidth > wordWrapWidth){
				if (this.wordWrap){
					var newLine=line.substring(startIndex,j);
					if (newLine.charCodeAt(newLine.length-1)< 255){
						execResult=/(?:\w|-)+$/.exec(newLine);
						if (execResult){
							j=execResult.index+startIndex;
							if (execResult.index==0)
								j+=newLine.length;
							else
							newLine=line.substring(startIndex,j);
						}
					}else
					if (Text.RightToLeft){
						execResult=/([\u0600-\u06FF])+$/.exec(newLine);
						if(execResult){
							j=execResult.index+startIndex;
							if (execResult.index==0)
								j+=newLine.length;
							else
							newLine=line.substring(startIndex,j);
						}
					}
					lines.push(newLine);
					this._lineWidths.push(wordWidth-charsWidth);
					startIndex=j;
					if (j+maybeIndex < m){
						j+=maybeIndex;
						charsWidth=this.getTextWidth(line.substring(startIndex,j));
						wordWidth=charsWidth;
						j--;
						}else {
						lines.push(line.substring(startIndex,m));
						this._lineWidths.push(this.getTextWidth(lines[lines.length-1]));
						startIndex=-1;
						break ;
					}
					}else if (this.overflow==Text.HIDDEN){
					lines.push(line.substring(0,j));
					this._lineWidths.push(this.getTextWidth(lines[lines.length-1]));
					return;
				}
			}
		}
		if (this.wordWrap && startIndex !=-1){
			lines.push(line.substring(startIndex,m));
			this._lineWidths.push(this.getTextWidth(lines[lines.length-1]));
		}
	}

	__proto.getTextWidth=function(text){
		if (this._currBitmapFont)
			return this._currBitmapFont.getTextWidth(text);
		else
		return Browser.context.measureText(text).width;
	}

	/**
	*获取换行所需的宽度。
	*/
	__proto.getWordWrapWidth=function(){
		var p=this.padding;
		var w=NaN;
		if (this._currBitmapFont && this._currBitmapFont.autoScaleSize)
			w=this._width *(this._currBitmapFont.fontSize / this.fontSize);
		else
		w=this._width;
		if (w <=0){
			w=this.wordWrap ? 100 :Browser.width;
		}
		w <=0 && (w=100);
		return w-p[3]-p[1];
	}

	/**
	*返回字符在本类实例的父坐标系下的坐标。
	*@param charIndex 索引位置。
	*@param out （可选）输出的Point引用。
	*@return Point 字符在本类实例的父坐标系下的坐标。如果out参数不为空，则将结果赋值给指定的Point对象，否则创建一个新的Point对象返回。建议使用Point.TEMP作为out参数，可以省去Point对象创建和垃圾回收的开销，尤其是在需要频繁执行的逻辑中，比如帧循环和MOUSE_MOVE事件回调函数里面。
	*/
	__proto.getCharPoint=function(charIndex,out){
		this._isChanged && Laya.timer.runCallLater(this,this.typeset);
		var len=0,lines=this._lines,startIndex=0;
		for (var i=0,n=lines.length;i < n;i++){
			len+=lines[i].length;
			if (charIndex < len){
				var line=i;
				break ;
			}
			startIndex=len;
		};
		var ctxFont=(this.italic ? "italic " :"")+(this.bold ? "bold " :"")+this.fontSize+"px "+this.font;
		Browser.context.font=ctxFont;
		var width=this.getTextWidth(this._text.substring(startIndex,charIndex));
		var point=out || new Point();
		return point.setTo(this._startX+width-(this._clipPoint ? this._clipPoint.x :0),this._startY+line *(this._charSize.height+this.leading)-(this._clipPoint ? this._clipPoint.y :0));
	}

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'width',function(){
		if (this._width)
			return this._width;
		return this.textWidth+this.padding[1]+this.padding[3];
		},function(value){
		if (value !=this._width){
			Laya.superSet(Sprite,this,'width',value);
			this.isChanged=true;
		}
	});

	/**
	*表示文本的宽度，以像素为单位。
	*/
	__getset(0,__proto,'textWidth',function(){
		this._isChanged && Laya.timer.runCallLater(this,this.typeset);
		return this._textWidth;
	});

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'height',function(){
		if (this._height)return this._height;
		return this.textHeight+this.padding[0]+this.padding[2];
		},function(value){
		if (value !=this._height){
			Laya.superSet(Sprite,this,'height',value);
			this.isChanged=true;
		}
	});

	/**
	*表示文本的高度，以像素为单位。
	*/
	__getset(0,__proto,'textHeight',function(){
		this._isChanged && Laya.timer.runCallLater(this,this.typeset);
		return this._textHeight;
	});

	/**
	*<p>边距信息。</p>
	*<p>数据格式：[上边距，右边距，下边距，左边距]（边距以像素为单位）。</p>
	*/
	__getset(0,__proto,'padding',function(){
		return this._getCSSStyle().padding;
		},function(value){
		this._getCSSStyle().padding=value;
		this.isChanged=true;
	});

	/**
	*<p>指定文本是否为粗体字。</p>
	*<p>默认值为 false，这意味着不使用粗体字。如果值为 true，则文本为粗体字。</p>
	*/
	__getset(0,__proto,'bold',function(){
		return this._getCSSStyle().bold;
		},function(value){
		this._getCSSStyle().bold=value;
		this.isChanged=true;
	});

	/**当前文本的内容字符串。*/
	__getset(0,__proto,'text',function(){
		return this._text || "";
		},function(value){
		if (this._text!==value){
			this.lang(value+"");
			this.isChanged=true;
			this.event("change");
		}
	});

	/**
	*<p>表示文本的颜色值。可以通过 <code>Text.defaultColor</code> 设置默认颜色。</p>
	*<p>默认值为黑色。</p>
	*/
	__getset(0,__proto,'color',function(){
		return this._getCSSStyle().color;
		},function(value){
		if (this._getCSSStyle().color !=value){
			this._getCSSStyle().color=value;
			if (!this._isChanged && this._graphics){
				this._graphics.replaceTextColor(this.color)
				}else {
				this.isChanged=true;
			}
		}
	});

	/**
	*<p>文本的字体名称，以字符串形式表示。</p>
	*<p>默认值为："Arial"，可以通过Font.defaultFont设置默认字体。</p>
	*<p>如果运行时系统找不到设定的字体，则用系统默认的字体渲染文字，从而导致显示异常。(通常电脑上显示正常，在一些移动端因缺少设置的字体而显示异常)。</p>
	*@see laya.display.css.Font#defaultFamily
	*/
	__getset(0,__proto,'font',function(){
		return this._getCSSStyle().fontFamily;
		},function(value){
		if (this._currBitmapFont){
			this._currBitmapFont=null;
			this.scale(1,1);
		}
		if (Text._bitmapFonts && Text._bitmapFonts[value]){
			this._currBitmapFont=Text._bitmapFonts[value];
		}
		this._getCSSStyle().fontFamily=value;
		this.isChanged=true;
	});

	/**
	*<p>指定文本的字体大小（以像素为单位）。</p>
	*<p>默认为20像素，可以通过 <code>Text.defaultSize</code> 设置默认大小。</p>
	*/
	__getset(0,__proto,'fontSize',function(){
		return this._getCSSStyle().fontSize;
		},function(value){
		this._getCSSStyle().fontSize=value;
		this.isChanged=true;
	});

	/**
	*<p>表示使用此文本格式的文本是否为斜体。</p>
	*<p>默认值为 false，这意味着不使用斜体。如果值为 true，则文本为斜体。</p>
	*/
	__getset(0,__proto,'italic',function(){
		return this._getCSSStyle().italic;
		},function(value){
		this._getCSSStyle().italic=value;
		this.isChanged=true;
	});

	/**
	*<p>表示文本的水平显示方式。</p>
	*<p><b>取值：</b>
	*<li>"left"： 居左对齐显示。</li>
	*<li>"center"： 居中对齐显示。</li>
	*<li>"right"： 居右对齐显示。</li>
	*</p>
	*/
	__getset(0,__proto,'align',function(){
		return this._getCSSStyle().align;
		},function(value){
		this._getCSSStyle().align=value;
		this.isChanged=true;
	});

	/**
	*<p>表示文本的垂直显示方式。</p>
	*<p><b>取值：</b>
	*<li>"top"： 居顶部对齐显示。</li>
	*<li>"middle"： 居中对齐显示。</li>
	*<li>"bottom"： 居底部对齐显示。</li>
	*</p>
	*/
	__getset(0,__proto,'valign',function(){
		return this._getCSSStyle().valign;
		},function(value){
		this._getCSSStyle().valign=value;
		this.isChanged=true;
	});

	/**
	*<p>表示文本是否自动换行，默认为false。</p>
	*<p>若值为true，则自动换行；否则不自动换行。</p>
	*/
	__getset(0,__proto,'wordWrap',function(){
		return this._getCSSStyle().wordWrap;
		},function(value){
		this._getCSSStyle().wordWrap=value;
		this.isChanged=true;
	});

	/**
	*垂直行间距（以像素为单位）。
	*/
	__getset(0,__proto,'leading',function(){
		return this._getCSSStyle().leading;
		},function(value){
		this._getCSSStyle().leading=value;
		this.isChanged=true;
	});

	/**
	*文本背景颜色，以字符串表示。
	*/
	__getset(0,__proto,'bgColor',function(){
		return this._getCSSStyle().backgroundColor;
		},function(value){
		this._getCSSStyle().backgroundColor=value;
		this.isChanged=true;
	});

	/**
	*文本边框背景颜色，以字符串表示。
	*/
	__getset(0,__proto,'borderColor',function(){
		return this._getCSSStyle().borderColor;
		},function(value){
		this._getCSSStyle().borderColor=value;
		this.isChanged=true;
	});

	/**
	*<p>描边宽度（以像素为单位）。</p>
	*<p>默认值0，表示不描边。</p>
	*/
	__getset(0,__proto,'stroke',function(){
		return this._getCSSStyle().stroke;
		},function(value){
		this._getCSSStyle().stroke=value;
		this.isChanged=true;
	});

	/**
	*<p>描边颜色，以字符串表示。</p>
	*<p>默认值为 "#000000"（黑色）;</p>
	*/
	__getset(0,__proto,'strokeColor',function(){
		return this._getCSSStyle().strokeColor;
		},function(value){
		this._getCSSStyle().strokeColor=value;
		this.isChanged=true;
	});

	/**
	*一个布尔值，表示文本的属性是否有改变。若为true表示有改变。
	*/
	__getset(0,__proto,'isChanged',null,function(value){
		if (this._isChanged!==value){
			this._isChanged=value;
			value && Laya.timer.callLater(this,this.typeset);
		}
	});

	/**
	*<p>设置横向滚动量。</p>
	*<p>即使设置超出滚动范围的值，也会被自动限制在可能的最大值处。</p>
	*/
	/**
	*获取横向滚动量。
	*/
	__getset(0,__proto,'scrollX',function(){
		if (!this._clipPoint)
			return 0;
		return this._clipPoint.x;
		},function(value){
		if (this.overflow !=Text.SCROLL || (this.textWidth < this._width || !this._clipPoint))
			return;
		value=value < this.padding[3] ? this.padding[3] :value;
		var maxScrollX=this._textWidth-this._width;
		value=value > maxScrollX ? maxScrollX :value;
		var visibleLineCount=this._height / (this._charSize.height+this.leading)| 0+1;
		this._clipPoint.x=value;
		this.renderText(this._lastVisibleLineIndex,visibleLineCount);
	});

	/**
	*设置纵向滚动量（px)。即使设置超出滚动范围的值，也会被自动限制在可能的最大值处。
	*/
	/**
	*获取纵向滚动量。
	*/
	__getset(0,__proto,'scrollY',function(){
		if (!this._clipPoint)
			return 0;
		return this._clipPoint.y;
		},function(value){
		if (this.overflow !=Text.SCROLL || (this.textHeight < this._height || !this._clipPoint))
			return;
		value=value < this.padding[0] ? this.padding[0] :value;
		var maxScrollY=this._textHeight-this._height;
		value=value > maxScrollY ? maxScrollY :value;
		var startLine=value / (this._charSize.height+this.leading)| 0;
		this._lastVisibleLineIndex=startLine;
		var visibleLineCount=(this._height / (this._charSize.height+this.leading)| 0)+1;
		this._clipPoint.y=value;
		this.renderText(startLine,visibleLineCount);
	});

	/**
	*获取横向可滚动最大值。
	*/
	__getset(0,__proto,'maxScrollX',function(){
		return (this.textWidth < this._width)? 0 :this._textWidth-this._width;
	});

	/**
	*获取纵向可滚动最大值。
	*/
	__getset(0,__proto,'maxScrollY',function(){
		return (this.textHeight < this._height)? 0 :this._textHeight-this._height;
	});

	__getset(0,__proto,'lines',function(){
		if (this._isChanged)
			this.typeset();
		return this._lines;
	});

	__getset(0,__proto,'underlineColor',function(){
		return this._underlineColor;
		},function(value){
		this._underlineColor=value;
		this._isChanged=true;
		this.typeset();
	});

	Text.registerBitmapFont=function(name,bitmapFont){
		Text._bitmapFonts || (Text._bitmapFonts={});
		Text._bitmapFonts[name]=bitmapFont;
	}

	Text.unregisterBitmapFont=function(name,destroy){
		(destroy===void 0)&& (destroy=true);
		if (Text._bitmapFonts && Text._bitmapFonts[name]){
			var tBitmapFont=Text._bitmapFonts[name];
			if (destroy){
				tBitmapFont.destroy();
			}
			delete Text._bitmapFonts[name];
		}
	}

	Text.setTextRightToLeft=function(){
		var style;
		style=Browser.canvas.source.style;
		style.display="none";
		style.position="absolute";
		style.direction="rtl";
		Render._mainCanvas.source.style.direction="rtl";
		laya.display.Text.RightToLeft=true;
		Browser.document.body.appendChild(Browser.canvas.source);
	}

	Text.supportFont=function(font){
		Browser.context.font="10px sans-serif";
		var defaultFontWidth=Browser.context.measureText("abcji").width;
		Browser.context.font="10px "+font;
		var customFontWidth=Browser.context.measureText("abcji").width;
		console.log(defaultFontWidth,customFontWidth);
		if (defaultFontWidth===customFontWidth)return false;
		else return true;
	}

	Text._testWord="游";
	Text.langPacks=null;
	Text.VISIBLE="visible";
	Text.SCROLL="scroll";
	Text.HIDDEN="hidden";
	Text.CharacterCache=true;
	Text.RightToLeft=false;
	Text._bitmapFonts=null;
	__static(Text,
	['_fontFamilyMap',function(){return this._fontFamilyMap={"报隶" :"报隶-简","黑体" :"黑体-简","楷体" :"楷体-简","兰亭黑" :"兰亭黑-简","隶变" :"隶变-简","凌慧体" :"凌慧体-简","翩翩体" :"翩翩体-简","苹方" :"苹方-简","手札体" :"手札体-简","宋体" :"宋体-简","娃娃体" :"娃娃体-简","魏碑" :"魏碑-简","行楷" :"行楷-简","雅痞" :"雅痞-简","圆体" :"圆体-简"};}
	]);
	return Text;
})(Sprite)


/**水平飞行后变大*/
//class huamao.panel.zhaomu.Animation3 extends huamao.panel.zhaomu.Animation20
var Animation3=(function(_super){
	function Animation3(ss_,dx_){
		this.step=0;
		this.scale=1.2;
		this.card=null;
		Animation3.__super.call(this,ss_,dx_);
		this.card=ss_;
	}

	__class(Animation3,'huamao.panel.zhaomu.Animation3',_super);
	var __proto=Animation3.prototype;
	__proto.play=function(){
		this.k=Math.floor(this.dx-this.ss.x);
		this.speed=Math.abs(this.k)/ 18 *MyImg.EFEN;
		Laya.timer.frameLoop(1,this,this.efe);
		App.voiceManager.playSound("gethero.wav");
	}

	__proto.getCard=function(){
		return this.card;
	}

	__proto.efe=function(){
		if(this.step==0){
			if(this.k<0){
				this.ss.x-=this.speed;
				if(this.ss.x>this.dx){
					}else{
					this.ss.x=this.dx;
					this.step++;
				}
				}else if(this.k >0){
				this.ss.x+=this.speed;
				if(this.ss.x<this.dx){
					}else{
					this.ss.x=this.dx;
					this.step++;
				}
				}else if(this.k==0){
				this.step++;
			}
			}else if(this.step==1){
			var kar=this.card.kar;
			if(kar.scaleX<this.scale){
				kar.scaleX+=0.01 *MyImg.EFEN;
			}
			if(kar.scaleX>=this.scale){
				kar.scaleX=this.scale;
				this.end();
			}
			kar.scaleY=kar.scaleX;
		}
	}

	return Animation3;
})(Animation20)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.DebugInfoLayer extends laya.display.Sprite
var DebugInfoLayer=(function(_super){
	function DebugInfoLayer(){
		this.nodeRecInfoLayer=null;
		this.lineLayer=null;
		this.txtLayer=null;
		this.popLayer=null;
		this.graphicLayer=null;
		this.cacheViewLayer=null;
		DebugInfoLayer.__super.call(this);
		this.nodeRecInfoLayer=new Sprite();
		this.lineLayer=new Sprite();
		this.txtLayer=new Sprite();
		this.popLayer=new Sprite();
		this.graphicLayer=new Sprite();
		this.cacheViewLayer=new Sprite();
		this.nodeRecInfoLayer.name="nodeRecInfoLayer";
		this.lineLayer.name="lineLayer";
		this.txtLayer.name="txtLayer";
		this.popLayer.name="popLayer";
		this.graphicLayer.name="graphicLayer";
		this.cacheViewLayer.name="cacheViewLayer";
		this.addChild(this.lineLayer);
		this.addChild(this.cacheViewLayer);
		this.addChild(this.nodeRecInfoLayer);
		this.addChild(this.txtLayer);
		this.addChild(this.popLayer);
		this.addChild(this.graphicLayer);
		DebugInfoLayer.I=this;
		this.zOrder=999;
		Laya.stage.on("doubleclick",this,this.setTop);
	}

	__class(DebugInfoLayer,'laya.debug.view.nodeInfo.DebugInfoLayer',_super);
	var __proto=DebugInfoLayer.prototype;
	__proto.setTop=function(){
		DisControlTool.setTop(this);
	}

	__proto.isDebugItem=function(sprite){
		return DisControlTool.isInTree(this,sprite);
	}

	DebugInfoLayer.init=function(){
		if (!DebugInfoLayer.I){
			new DebugInfoLayer();
			Laya.stage.addChild(DebugInfoLayer.I);
		}
	}

	DebugInfoLayer.I=null;
	return DebugInfoLayer;
})(Sprite)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.NodeInfoPanel extends laya.display.Sprite
var NodeInfoPanel=(function(_super){
	function NodeInfoPanel(){
		this._stateDic={};
		this.isWorkState=false;
		NodeInfoPanel.__super.call(this);
	}

	__class(NodeInfoPanel,'laya.debug.view.nodeInfo.NodeInfoPanel',_super);
	var __proto=NodeInfoPanel.prototype;
	__proto.showDisInfo=function(node){
		this.recoverNodes();
		NodeInfosItem.showDisInfos(node);
		this.showOnly(node);
		this.isWorkState=true;
	}

	__proto.showOnly=function(node){
		if (!node)
			return;
		this.hideBrothers(node);
		this.showOnly(node.parent);
	}

	__proto.recoverNodes=function(){
		NodeInfosItem.hideAllInfos();
		var key;
		var data;
		var tTar;
		for (key in this._stateDic){
			data=this._stateDic[key];
			tTar=data["target"];
			if (tTar){
				try{
					tTar.visible=data.visible;
					}catch (e){
				}
			}
		}
		this.isWorkState=false;
	}

	__proto.hideOtherChain=function(node){
		if (!node)
			return;
		while (node){
			this.hideBrothers(node);
			node=node.parent;
		}
	}

	__proto.hideChilds=function(node){
		if (!node)
			return;
		var i=0,len=0;
		var cList;
		cList=node._childs;
		len=cList.length;
		var tChild;
		for (i=0;i < len;i++){
			tChild=cList[i];
			if (tChild==NodeInfosItem.NodeInfoContainer)continue ;
			this.saveNodeInfo(tChild);
			tChild.visible=false;
		}
	}

	__proto.hideBrothers=function(node){
		if (!node)
			return;
		var p;
		p=node.parent;
		if (!p)
			return;
		var i=0,len=0;
		var cList;
		cList=p._childs;
		len=cList.length;
		var tChild;
		for (i=0;i < len;i++){
			tChild=cList[i];
			if (tChild==NodeInfosItem.NodeInfoContainer)continue ;
			if (tChild !=node){
				this.saveNodeInfo(tChild);
				tChild.visible=false;
			}
		}
	}

	__proto.saveNodeInfo=function(node){
		IDTools.idObj(node);
		if(this._stateDic.hasOwnProperty(IDTools.getObjID(node)))return;
		var data;
		data={};
		data.target=node;
		data.visible=node.visible;
		this._stateDic[IDTools.getObjID(node)]=data;
	}

	__proto.recoverNodeInfo=function(node){
		IDTools.idObj(node);
		if (this._stateDic.hasOwnProperty(IDTools.getObjID(node))){
			var data;
			data=this._stateDic[IDTools.getObjID(node)];
			node["visible"]=data.visible;
		}
	}

	NodeInfoPanel.init=function(){
		if (!NodeInfoPanel.I){
			NodeInfoPanel.I=new NodeInfoPanel();
			NodeInfosItem.init();
			ToolPanel.init();
		}
	}

	NodeInfoPanel.I=null;
	return NodeInfoPanel;
})(Sprite)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.NodeInfosItem extends laya.display.Sprite
var NodeInfosItem=(function(_super){
	function NodeInfosItem(){
		//addChild(_infoTxt);
		this._infoTxt=null;
		this._tar=null;
		NodeInfosItem.__super.call(this);
		this._infoTxt=new Text();
		this._infoTxt.color="#ff0000";
		this._infoTxt.bgColor="#00ff00";
		this._infoTxt.fontSize=12;
	}

	__class(NodeInfosItem,'laya.debug.view.nodeInfo.NodeInfosItem',_super);
	var __proto=NodeInfosItem.prototype;
	__proto.removeSelf=function(){
		this._infoTxt.removeSelf();
		return laya.display.Node.prototype.removeSelf.call(this);
	}

	__proto.showToUI=function(){
		NodeInfosItem.NodeInfoContainer.nodeRecInfoLayer.addChild(this);
		this._infoTxt.removeSelf();
		NodeInfosItem.NodeInfoContainer.txtLayer.addChild(this._infoTxt);
		this.findOkPos();
	}

	__proto.randomAPos=function(r){
		this._infoTxt.x=this.x+Laya.stage.width*Math.random();
		this._infoTxt.y=this.y+r *Math.random();
	}

	__proto.findOkPos=function(){
		var len=0;
		len=20;
		this.randomAPos(len);
		return;
		var count=0;
		count=1;
		while (!this.isPosOk()){
			count++;
			if (count >=500){
				len+=10;
				count=0;
			}
			this.randomAPos(len);
		}
	}

	__proto.isPosOk=function(){
		var tParent;
		tParent=NodeInfosItem.NodeInfoContainer.nodeRecInfoLayer;
		var i=0,len=0;
		var cList;
		cList=tParent._childs;
		len=cList.length;
		var tChild;
		var mRec;
		mRec=this._infoTxt.getBounds();
		if (mRec.x < 0)return false;
		if (mRec.y < 0)return false;
		if (mRec.right > Laya.stage.width)return false;
		for (i=0;i < len;i++){
			tChild=cList[i];
			if (tChild==this._infoTxt)continue ;
			if (mRec.intersects(tChild.getBounds()))return false;
		}
		return true;
	}

	__proto.showInfo=function(node){
		this._tar=node;
		if (!node)return;
		NodeInfosItem._txts.length=0;
		var i=0,len=0;
		var tKey;
		len=NodeInfosItem.showValues.length;
		if (node.name){
			NodeInfosItem._txts.push(ClassTool.getClassName(node)+"("+node.name+")");
			}else{
			NodeInfosItem._txts.push(ClassTool.getClassName(node));
		}
		for (i=0;i < len;i++){
			tKey=NodeInfosItem.showValues[i];
			NodeInfosItem._txts.push(tKey+":"+NodeInfosItem.getNodeValue(node,tKey));
		}
		this._infoTxt.text=NodeInfosItem._txts.join("\n");
		this.graphics.clear();
		var pointList;
		pointList=node._getBoundPointsM(true);
		if(!pointList||pointList.length<1)return;
		pointList=GrahamScan.pListToPointList(pointList,true);
		WalkTools.walkArr(pointList,node.localToGlobal,node);
		pointList=GrahamScan.pointListToPlist(pointList);
		NodeInfosItem._disBoundRec=Rectangle._getWrapRec(pointList,NodeInfosItem._disBoundRec);
		this.graphics.drawRect(0,0,NodeInfosItem._disBoundRec.width,NodeInfosItem._disBoundRec.height,null,"#00ffff");
		this.pos(NodeInfosItem._disBoundRec.x,NodeInfosItem._disBoundRec.y);
	}

	__proto.fresh=function(){
		this.showInfo(this._tar);
	}

	__proto.clearMe=function(){
		this._tar=null;
	}

	__proto.recover=function(){
		Pool.recover("NodeInfosItem",this);
	}

	NodeInfosItem.init=function(){
		if (!NodeInfosItem.NodeInfoContainer){
			DebugInfoLayer.init();
			NodeInfosItem.NodeInfoContainer=DebugInfoLayer.I;
			Laya.stage.addChild(NodeInfosItem.NodeInfoContainer);
		}
	}

	NodeInfosItem.getNodeInfoByNode=function(node){
		IDTools.idObj(node);
		var key=0;
		key=IDTools.getObjID(node);
		if (!NodeInfosItem._nodeInfoDic[key]){
			NodeInfosItem._nodeInfoDic[key]=new NodeInfosItem();
		}
		return NodeInfosItem._nodeInfoDic[key];
	}

	NodeInfosItem.hideAllInfos=function(){
		var key;
		var tInfo;
		for (key in NodeInfosItem._nodeInfoDic){
			tInfo=NodeInfosItem._nodeInfoDic[key];
			tInfo.removeSelf();
		}
		NodeInfosItem.clearRelations();
	}

	NodeInfosItem.showNodeInfo=function(node){
		var nodeInfo;
		nodeInfo=NodeInfosItem.getNodeInfoByNode(node);
		nodeInfo.showInfo(node);
		nodeInfo.showToUI();
	}

	NodeInfosItem.showDisInfos=function(node){
		var _node;
		_node=node;
		if (!node)
			return;
		while (node){
			NodeInfosItem.showNodeInfo(node);
			node=node.parent;
		}
		DisControlTool.setTop(NodeInfosItem.NodeInfoContainer);
		NodeInfosItem.apdtTxtInfoPoss(_node);
		NodeInfosItem.updateRelations();
	}

	NodeInfosItem.apdtTxtInfoPoss=function(node){
		var disList;
		disList=[];
		while (node){
			disList.push(node);
			node=node.parent;
		};
		var i=0,len=0;
		var tInfo;
		var tTxt;
		len=disList.length;
		var xPos=NaN;
		xPos=Laya.stage.width-150;
		var heightLen=0;
		heightLen=100;
		node=disList[0];
		if (node){
			tInfo=NodeInfosItem.getNodeInfoByNode(node);
			if (tInfo){
				tTxt=tInfo._infoTxt;
				xPos=Laya.stage.width-tTxt.width-10;
				heightLen=tTxt.height+10;
			}
		}
		disList=disList.reverse();
		for (i=0;i < len;i++){
			node=disList[i];
			tInfo=NodeInfosItem.getNodeInfoByNode(node);
			if (tInfo){
				tTxt=tInfo._infoTxt;
				tTxt.pos(xPos,heightLen *i);
			}
		}
	}

	NodeInfosItem.clearRelations=function(){
		var g;
		g=NodeInfosItem.NodeInfoContainer.lineLayer.graphics;
		g.clear();
	}

	NodeInfosItem.updateRelations=function(){
		var g;
		g=NodeInfosItem.NodeInfoContainer.lineLayer.graphics;
		g.clear();
		var key;
		var tInfo;
		for (key in NodeInfosItem._nodeInfoDic){
			tInfo=NodeInfosItem._nodeInfoDic[key];
			if (tInfo.parent){
				g.drawLine(tInfo.x,tInfo.y,tInfo._infoTxt.x,tInfo._infoTxt.y,"#0000ff");
			}
		}
	}

	NodeInfosItem.getNodeValue=function(node,key){
		var rst;
		NodeInfosItem._nodePoint.setTo(0,0);
		switch(key){
			case "x":
				rst=node["x"]+" (g:"+node.localToGlobal(NodeInfosItem._nodePoint).x+")"
				break ;
			case "y":
				rst=node["y"]+" (g:"+node.localToGlobal(NodeInfosItem._nodePoint).y+")"
				break ;
			default :
				rst=node[key];
			}
		return rst;
	}

	NodeInfosItem.NodeInfoContainer=null;
	NodeInfosItem._nodeInfoDic={};
	NodeInfosItem._txts=[];
	__static(NodeInfosItem,
	['showValues',function(){return this.showValues=["x","y","scaleX","scaleY","width","height","visible","mouseEnabled"];},'_disBoundRec',function(){return this._disBoundRec=new Rectangle();},'_nodePoint',function(){return this._nodePoint=new Point();}
	]);
	return NodeInfosItem;
})(Sprite)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.recinfos.NodeRecInfo extends laya.display.Sprite
var NodeRecInfo=(function(_super){
	function NodeRecInfo(){
		this.txt=null;
		this._tar=null;
		this.recColor="#00ff00";
		NodeRecInfo.__super.call(this);
		this.txt=new Text();
		this.txt.color="#ff0000";
		this.txt.bgColor="#00ff00";
		this.txt.fontSize=12;
		this.addChild(this.txt);
	}

	__class(NodeRecInfo,'laya.debug.view.nodeInfo.recinfos.NodeRecInfo',_super);
	var __proto=NodeRecInfo.prototype;
	__proto.setInfo=function(str){
		this.txt.text=str;
	}

	__proto.setTarget=function(tar){
		this._tar=tar;
	}

	__proto.showInfo=function(node){
		this._tar=node;
		if (!node)return;
		if(!node._$P)return;
		this.graphics.clear();
		var pointList;
		pointList=node._getBoundPointsM(true);
		if(!pointList||pointList.length<1)return;
		pointList=GrahamScan.pListToPointList(pointList,true);
		WalkTools.walkArr(pointList,node.localToGlobal,node);
		pointList=GrahamScan.pointListToPlist(pointList);
		NodeRecInfo._disBoundRec=Rectangle._getWrapRec(pointList,NodeRecInfo._disBoundRec);
		this.graphics.drawRect(0,0,NodeRecInfo._disBoundRec.width,NodeRecInfo._disBoundRec.height,null,DebugConsts.RECACHE_REC_COLOR,2);
		this.pos(NodeRecInfo._disBoundRec.x,NodeRecInfo._disBoundRec.y);
	}

	__proto.fresh=function(){
		this.showInfo(this._tar);
	}

	__proto.clearMe=function(){
		this._tar=null;
	}

	__static(NodeRecInfo,
	['_disBoundRec',function(){return this._disBoundRec=new Rectangle();}
	]);
	return NodeRecInfo;
})(Sprite)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.ToolPanel extends laya.display.Sprite
var ToolPanel=(function(_super){
	function ToolPanel(){
		ToolPanel.__super.call(this);
		Base64AtlasManager.base64.preLoad(Handler.create(this,this.showToolBar));
		ContextMenu.init();
		DisResizer.init();
		var tipManager;
		tipManager=new TipManagerForDebug();
	}

	__class(ToolPanel,'laya.debug.view.nodeInfo.ToolPanel',_super);
	var __proto=ToolPanel.prototype;
	//Laya.timer.once(1000,this,showToolBar);
	__proto.showToolBar=function(){
		DebugPanelView.I.show();
	}

	__proto.createViews=function(){
		ToolPanel.typeClassDic["Find"]=FindView;
		ToolPanel.typeClassDic["Filter"]=FilterView;
		ToolPanel.typeClassDic["TxtInfo"]=TxtInfoView;
		ToolPanel.typeClassDic["Tree"]=NodeTreeView;
	}

	__proto.switchShow=function(type){
		var view;
		view=this.getView(type);
		if (view){
			view.switchShow();
		}
	}

	__proto.getView=function(type){
		var view;
		view=ToolPanel.viewDic[type];
		if (!view && ToolPanel.typeClassDic[type]){
			view=ToolPanel.viewDic[type]=new ToolPanel.typeClassDic[type]();
		}
		return view;
	}

	__proto.showTxtInfo=function(txt){
		OutPutView.I.showTxt(txt);
	}

	__proto.showNodeTree=function(node){
		NodeTree.I.setDis(node);
		DebugPanelView.I.switchToTree();
	}

	__proto.showSelectInStage=function(node){
		NodeTree.I.showSelectInStage(node);
		DebugPanelView.I.switchToTree();
	}

	__proto.showSelectItems=function(selectList){
		DebugPanelView.I.swichToSelect();
		SelectInfosView.I.setSelectList(selectList);
	}

	ToolPanel.init=function(){
		if (!ToolPanel.I)ToolPanel.I=new ToolPanel();
	}

	ToolPanel.I=null;
	ToolPanel.viewDic={};
	ToolPanel.Find="Find";
	ToolPanel.Filter="Filter";
	ToolPanel.TxtInfo="TxtInfo";
	ToolPanel.Tree="Tree";
	__static(ToolPanel,
	['typeClassDic',function(){return this.typeClassDic={
	};}

	]);
	return ToolPanel;
})(Sprite)


/**
*<p>动画播放基类，提供了基础的动画播放控制方法和帧标签事件相关功能。</p>
*<p>可以继承此类，但不要直接实例化此类，因为有些方法需要由子类实现。</p>
*/
//class laya.display.AnimationPlayerBase extends laya.display.Sprite
var AnimationPlayerBase=(function(_super){
	function AnimationPlayerBase(){
		/**
		*是否循环播放，调用play(...)方法时，会将此值设置为指定的参数值。
		*/
		this.loop=false;
		/**
		*<p>播放顺序类型：AnimationPlayerBase.WRAP_POSITIVE为正序播放，AnimationPlayerBase.WRAP_REVERSE为倒序播放，AnimationPlayerBase.WRAP_PINGPONG为pingpong播放(当按指定顺序播放完结尾后，如果继续播发，则会改变播放顺序)。</p>
		*<p>默认为正序播放。</p>
		*/
		this.wrapMode=0;
		/**@private */
		this._index=0;
		/**@private */
		this._count=0;
		/**@private */
		this._isPlaying=false;
		/**@private */
		this._labels=null;
		/**是否是逆序播放*/
		this._isReverse=false;
		/**@private */
		this._frameRateChanged=false;
		/**@private */
		this._controlNode=null;
		/**@private */
		this._actionName=null;
		AnimationPlayerBase.__super.call(this);
		this._interval=Config.animationInterval;
		this._setUpNoticeType(0x1);
	}

	__class(AnimationPlayerBase,'laya.display.AnimationPlayerBase',_super);
	var __proto=AnimationPlayerBase.prototype;
	/**
	*<p>开始播放动画。play(...)方法被设计为在创建实例后的任何时候都可以被调用，当相应的资源加载完毕、调用动画帧填充方法(set frames)或者将实例显示在舞台上时，会判断是否正在播放中，如果是，则进行播放。</p>
	*<p>配合wrapMode属性，可设置动画播放顺序类型。</p>
	*@param start （可选）指定动画播放开始的索引(int)或帧标签(String)。帧标签可以通过addLabel(...)和removeLabel(...)进行添加和删除。
	*@param loop （可选）是否循环播放。
	*@param name （可选）动画名称。
	*@param showWarn（可选）是否动画不存在时打印警告
	*/
	__proto.play=function(start,loop,name,showWarn){
		(start===void 0)&& (start=0);
		(loop===void 0)&& (loop=true);
		(name===void 0)&& (name="");
		(showWarn===void 0)&& (showWarn=true);
		this._isPlaying=true;
		this.index=((typeof start=='string'))? this._getFrameByLabel(start):start;
		this.loop=loop;
		this._actionName=name;
		this._isReverse=this.wrapMode==1;
		if (this.interval > 0){
			this.timerLoop(this.interval,this,this._frameLoop,null,true,true);
		}
	}

	/**@private */
	__proto._getFrameByLabel=function(label){
		var i=0;
		for (i=0;i < this._count;i++){
			if (this._labels[i] && (this._labels [i]).indexOf(label)>=0)return i;
		}
		return 0;
	}

	/**@private */
	__proto._frameLoop=function(){
		if (this._isReverse){
			this._index--;
			if (this._index < 0){
				if (this.loop){
					if (this.wrapMode==2){
						this._index=this._count > 0 ? 1 :0;
						this._isReverse=false;
						}else {
						this._index=this._count-1;
					}
					this.event("complete");
					}else {
					this._index=0;
					this.stop();
					this.event("complete");
					return;
				}
			}
			}else {
			this._index++;
			if (this._index >=this._count){
				if (this.loop){
					if (this.wrapMode==2){
						this._index=this._count-2 >=0 ? this._count-2 :0;
						this._isReverse=true;
						}else {
						this._index=0;
					}
					this.event("complete");
					}else {
					this._index--;
					this.stop();
					this.event("complete");
					return;
				}
			}
		}
		this.index=this._index;
	}

	/**@private */
	__proto._setControlNode=function(node){
		if (this._controlNode){
			this._controlNode.off("display",this,this._checkResumePlaying);
			this._controlNode.off("undisplay",this,this._checkResumePlaying);
		}
		this._controlNode=node;
		if (node && node !=this){
			node.on("display",this,this._checkResumePlaying);
			node.on("undisplay",this,this._checkResumePlaying);
		}
	}

	/**@private */
	__proto._setDisplay=function(value){
		_super.prototype._setDisplay.call(this,value);
		this._checkResumePlaying();
	}

	/**@private */
	__proto._checkResumePlaying=function(){
		if (this._isPlaying){
			if (this._controlNode.displayedInStage)this.play(this._index,this.loop,this._actionName);
			else this.clearTimer(this,this._frameLoop);
		}
	}

	/**
	*停止动画播放。
	*/
	__proto.stop=function(){
		this._isPlaying=false;
		this.clearTimer(this,this._frameLoop);
	}

	/**
	*增加一个帧标签到指定索引的帧上。当动画播放到此索引的帧时会派发Event.LABEL事件，派发事件是在完成当前帧画面更新之后。
	*@param label 帧标签名称
	*@param index 帧索引
	*/
	__proto.addLabel=function(label,index){
		if (!this._labels)this._labels={};
		if (!this._labels[index])this._labels[index]=[];
		this._labels[index].push(label);
	}

	/**
	*删除指定的帧标签。
	*@param label 帧标签名称。注意：如果为空，则删除所有帧标签！
	*/
	__proto.removeLabel=function(label){
		if (!label)this._labels=null;
		else if (this._labels){
			for (var name in this._labels){
				this._removeLabelFromLabelList(this._labels[name],label);
			}
		}
	}

	/**@private */
	__proto._removeLabelFromLabelList=function(list,label){
		if (!list)return;
		for (var i=list.length-1;i >=0;i--){
			if (list[i]==label){
				list.splice(i,1);
			}
		}
	}

	/**
	*将动画切换到指定帧并停在那里。
	*@param position 帧索引或帧标签
	*/
	__proto.gotoAndStop=function(position){
		this.index=((typeof position=='string'))? this._getFrameByLabel(position):position;
		this.stop();
	}

	/**
	*@private
	*显示到某帧
	*@param value 帧索引
	*/
	__proto._displayToIndex=function(value){}
	/**
	*停止动画播放，并清理对象属性。之后可存入对象池，方便对象复用。
	*/
	__proto.clear=function(){
		this.stop();
		this._labels=null;
	}

	/**
	*<p>动画播放的帧间隔时间(单位：毫秒)。默认值依赖于Config.animationInterval=50，通过Config.animationInterval可以修改默认帧间隔时间。</p>
	*<p>要想为某动画设置独立的帧间隔时间，可以使用set interval，注意：如果动画正在播放，设置后会重置帧循环定时器的起始时间为当前时间，也就是说，如果频繁设置interval，会导致动画帧更新的时间间隔会比预想的要慢，甚至不更新。</p>
	*/
	__getset(0,__proto,'interval',function(){
		return this._interval;
		},function(value){
		if (this._interval !=value){
			this._frameRateChanged=true;
			this._interval=value;
			if (this._isPlaying && value > 0){
				this.timerLoop(value,this,this._frameLoop,null,true,true);
			}
		}
	});

	/**
	*是否正在播放中。
	*/
	__getset(0,__proto,'isPlaying',function(){
		return this._isPlaying;
	});

	/**
	*动画当前帧的索引。
	*/
	__getset(0,__proto,'index',function(){
		return this._index;
		},function(value){
		this._index=value;
		this._displayToIndex(value);
		if (this._labels && this._labels[value]){
			var tArr=this._labels[value];
			for (var i=0,len=tArr.length;i < len;i++){
				this.event("label",tArr[i]);
			}
		}
	});

	/**
	*当前动画中帧的总数。
	*/
	__getset(0,__proto,'count',function(){
		return this._count;
	});

	AnimationPlayerBase.WRAP_POSITIVE=0;
	AnimationPlayerBase.WRAP_REVERSE=1;
	AnimationPlayerBase.WRAP_PINGPONG=2;
	return AnimationPlayerBase;
})(Sprite)


/**
*<p> <code>Stage</code> 是舞台类，显示列表的根节点，所有显示对象都在舞台上显示。通过 Laya.stage 单例访问。</p>
*<p>Stage提供几种适配模式，不同的适配模式会产生不同的画布大小，画布越大，渲染压力越大，所以要选择合适的适配方案。</p>
*<p>Stage提供不同的帧率模式，帧率越高，渲染压力越大，越费电，合理使用帧率甚至动态更改帧率有利于改进手机耗电。</p>
*/
//class laya.display.Stage extends laya.display.Sprite
var Stage=(function(_super){
	function Stage(){
		/**当前焦点对象，此对象会影响当前键盘事件的派发主体。*/
		this.focus=null;
		/**设计宽度（初始化时设置的宽度Laya.init(width,height)）*/
		this.designWidth=0;
		/**设计高度（初始化时设置的高度Laya.init(width,height)）*/
		this.designHeight=0;
		/**画布是否发生翻转。*/
		this.canvasRotation=false;
		/**画布的旋转角度。*/
		this.canvasDegree=0;
		/**
		*<p>设置是否渲染，设置为false，可以停止渲染，画面会停留到最后一次渲染上，减少cpu消耗，此设置不影响时钟。</p>
		*<p>比如非激活状态，可以设置renderingEnabled=true以节省消耗。</p>
		**/
		this.renderingEnabled=true;
		/**是否启用屏幕适配，可以适配后，在某个时候关闭屏幕适配，防止某些操作导致的屏幕以外改变*/
		this.screenAdaptationEnabled=true;
		/**@private */
		this._screenMode="none";
		/**@private */
		this._scaleMode="noscale";
		/**@private */
		this._alignV="top";
		/**@private */
		this._alignH="left";
		/**@private */
		this._bgColor="black";
		/**@private */
		this._mouseMoveTime=0;
		/**@private */
		this._renderCount=0;
		/**@private */
		this._frameStartTime=NaN;
		/**@private */
		this._isFocused=false;
		/**@private */
		this._isVisibility=false;
		/**@private 3D场景*/
		this._scenes=null;
		/**@private */
		this._frameRate="fast";
		Stage.__super.call(this);
		this.offset=new Point();
		this._canvasTransform=new Matrix();
		this._previousOrientation=Browser.window.orientation;
		var _$this=this;
		this.transform=Matrix.create();
		this._scenes=[];
		this.mouseEnabled=true;
		this.hitTestPrior=true;
		this.autoSize=false;
		this._displayedInStage=true;
		this._isFocused=true;
		this._isVisibility=true;
		var window=Browser.window;
		var _this=this;
		window.addEventListener("focus",function(){
			_$this._isFocused=true;
			_this.event("focus");
			_this.event("focuschange");
		});
		window.addEventListener("blur",function(){
			_$this._isFocused=false;
			_this.event("blur");
			_this.event("focuschange");
			if (_this._isInputting())Input["inputElement"].target.focus=false;
		});
		var hidden="hidden",state="visibilityState",visibilityChange="visibilitychange";
		var document=window.document;
		if (typeof document.hidden!=="undefined"){
			visibilityChange="visibilitychange";
			state="visibilityState";
			}else if (typeof document.mozHidden!=="undefined"){
			visibilityChange="mozvisibilitychange";
			state="mozVisibilityState";
			}else if (typeof document.msHidden!=="undefined"){
			visibilityChange="msvisibilitychange";
			state="msVisibilityState";
			}else if (typeof document.webkitHidden!=="undefined"){
			visibilityChange="webkitvisibilitychange";
			state="webkitVisibilityState";
		}
		window.document.addEventListener(visibilityChange,visibleChangeFun);
		function visibleChangeFun (){
			if (Browser.document[state]=="hidden"){
				_this._setStageVisible(false);
				}else {
				_this._setStageVisible(true);
			}
		}
		window.document.addEventListener("qbrowserVisibilityChange",qbroserVisibleChangeFun);
		function qbroserVisibleChangeFun (e){
			_this._setStageVisible(!e.hidden);
		}
		window.addEventListener("resize",function(){
			var orientation=Browser.window.orientation;
			if (orientation !=null && orientation !=_$this._previousOrientation && _this._isInputting()){
				Input["inputElement"].target.focus=false;
			}
			_$this._previousOrientation=orientation;
			if (_this._isInputting())return;
			_this._resetCanvas();
		});
		window.addEventListener("orientationchange",function(e){
			_this._resetCanvas();
		});
		this.on("mousemove",this,this._onmouseMove);
		if (Browser.onMobile)this.on("mousedown",this,this._onmouseMove);
	}

	__class(Stage,'laya.display.Stage',_super);
	var __proto=Stage.prototype;
	__proto._setStageVisible=function(value){
		if (this._isVisibility==value)return;
		this._isVisibility=value;
		if (!this._isVisibility)if (this._isInputting())Input["inputElement"].target.focus=false;
		this.event("visibilitychange");
	}

	/**
	*@private
	*在移动端输入时，输入法弹出期间不进行画布尺寸重置。
	*/
	__proto._isInputting=function(){
		return (Browser.onMobile && Input.isInputting);
	}

	/**@private */
	__proto._changeCanvasSize=function(){
		this.setScreenSize(Browser.clientWidth *Browser.pixelRatio,Browser.clientHeight *Browser.pixelRatio);
	}

	/**@private */
	__proto._resetCanvas=function(){
		if (!this.screenAdaptationEnabled)return;
		var canvas=Render._mainCanvas;
		var canvasStyle=canvas.source.style;
		canvas.size(1,1);
		Laya.timer.once(100,this,this._changeCanvasSize);
	}

	/**
	*设置屏幕大小，场景会根据屏幕大小进行适配。可以动态调用此方法，来更改游戏显示的大小。
	*@param screenWidth 屏幕宽度。
	*@param screenHeight 屏幕高度。
	*/
	__proto.setScreenSize=function(screenWidth,screenHeight){
		var rotation=false;
		if (this._screenMode!=="none"){
			var screenType=screenWidth / screenHeight < 1 ? "vertical" :"horizontal";
			rotation=screenType!==this._screenMode;
			if (rotation){
				var temp=screenHeight;
				screenHeight=screenWidth;
				screenWidth=temp;
			}
		}
		this.canvasRotation=rotation;
		var canvas=Render._mainCanvas;
		var canvasStyle=canvas.source.style;
		var mat=this._canvasTransform.identity();
		var scaleMode=this._scaleMode;
		var scaleX=screenWidth / this.designWidth;
		var scaleY=screenHeight / this.designHeight;
		var canvasWidth=this.designWidth;
		var canvasHeight=this.designHeight;
		var realWidth=screenWidth;
		var realHeight=screenHeight;
		var pixelRatio=Browser.pixelRatio;
		this._width=this.designWidth;
		this._height=this.designHeight;
		switch (scaleMode){
			case "noscale":
				scaleX=scaleY=1;
				realWidth=this.designWidth;
				realHeight=this.designHeight;
				break ;
			case "showall":
				scaleX=scaleY=Math.min(scaleX,scaleY);
				canvasWidth=realWidth=Math.round(this.designWidth *scaleX);
				canvasHeight=realHeight=Math.round(this.designHeight *scaleY);
				break ;
			case "noborder":
				scaleX=scaleY=Math.max(scaleX,scaleY);
				realWidth=Math.round(this.designWidth *scaleX);
				realHeight=Math.round(this.designHeight *scaleY);
				break ;
			case "full":
				scaleX=scaleY=1;
				this._width=canvasWidth=screenWidth;
				this._height=canvasHeight=screenHeight;
				break ;
			case "fixedwidth":
				scaleY=scaleX;
				this._height=canvasHeight=Math.round(screenHeight / scaleX);
				break ;
			case "fixedheight":
				scaleX=scaleY;
				this._width=canvasWidth=Math.round(screenWidth / scaleY);
				break ;
			case "fixedauto":
				if ((screenWidth / screenHeight)< (this.designWidth / this.designHeight)){
					scaleY=scaleX;
					this._height=canvasHeight=Math.round(screenHeight / scaleX);
					}else {
					scaleX=scaleY;
					this._width=canvasWidth=Math.round(screenWidth / scaleY);
				}
				break ;
			}
		if (this.conchModel)this.conchModel.size(this._width,this._height);
		scaleX *=this.scaleX;
		scaleY *=this.scaleY;
		if (scaleX===1 && scaleY===1){
			this.transform.identity();
			}else {
			this.transform.a=this._formatData(scaleX / (realWidth / canvasWidth));
			this.transform.d=this._formatData(scaleY / (realHeight / canvasHeight));
			this.conchModel && this.conchModel.scale(this.transform.a,this.transform.d);
		}
		canvas.size(canvasWidth,canvasHeight);
		RunDriver.changeWebGLSize(canvasWidth,canvasHeight);
		mat.scale(realWidth / canvasWidth / pixelRatio,realHeight / canvasHeight / pixelRatio);
		if (this._alignH==="left")this.offset.x=0;
		else if (this._alignH==="right")this.offset.x=(screenWidth-realWidth)/pixelRatio;
		else this.offset.x=(screenWidth-realWidth)*0.5 / pixelRatio;
		if (this._alignV==="top")this.offset.y=0;
		else if (this._alignV==="bottom")this.offset.y=(screenHeight-realHeight)/pixelRatio;
		else this.offset.y=(screenHeight-realHeight)*0.5 / pixelRatio;
		this.offset.x=Math.round(this.offset.x);
		this.offset.y=Math.round(this.offset.y);
		mat.translate(this.offset.x,this.offset.y);
		this.canvasDegree=0;
		if (rotation){
			if (this._screenMode==="horizontal"){
				mat.rotate(Math.PI / 2);
				mat.translate(screenHeight / pixelRatio,0);
				this.canvasDegree=90;
				}else {
				mat.rotate(-Math.PI / 2);
				mat.translate(0,screenWidth / pixelRatio);
				this.canvasDegree=-90;
			}
		}
		mat.a=this._formatData(mat.a);
		mat.d=this._formatData(mat.d);
		mat.tx=this._formatData(mat.tx);
		mat.ty=this._formatData(mat.ty);
		canvasStyle.transformOrigin=canvasStyle.webkitTransformOrigin=canvasStyle.msTransformOrigin=canvasStyle.mozTransformOrigin=canvasStyle.oTransformOrigin="0px 0px 0px";
		canvasStyle.transform=canvasStyle.webkitTransform=canvasStyle.msTransform=canvasStyle.mozTransform=canvasStyle.oTransform="matrix("+mat.toString()+")";
		mat.translate(parseInt(canvasStyle.left)|| 0,parseInt(canvasStyle.top)|| 0);
		this.visible=true;
		this._repaint=1;
		this.event("resize");
	}

	/**@private */
	__proto._formatData=function(value){
		if (Math.abs(value)< 0.000001)return 0;
		if (Math.abs(1-value)< 0.001)return value > 0 ? 1 :-1;
		return value;
	}

	/**@inheritDoc */
	__proto.getMousePoint=function(){
		return Point.TEMP.setTo(this.mouseX,this.mouseY);
	}

	/**@inheritDoc */
	__proto.repaint=function(){
		this._repaint=1;
	}

	/**@inheritDoc */
	__proto.parentRepaint=function(){}
	/**@private */
	__proto._loop=function(){
		this.render(Render.context,0,0);
		return true;
	}

	/**@private */
	__proto._onmouseMove=function(e){
		this._mouseMoveTime=Browser.now();
	}

	/**
	*<p>获得距当前帧开始后，过了多少时间，单位为毫秒。</p>
	*<p>可以用来判断函数内时间消耗，通过合理控制每帧函数处理消耗时长，避免一帧做事情太多，对复杂计算分帧处理，能有效降低帧率波动。</p>
	*/
	__proto.getTimeFromFrameStart=function(){
		return Browser.now()-this._frameStartTime;
	}

	/**@inheritDoc */
	__proto.render=function(context,x,y){
		if (this._frameRate==="sleep" && !Render.isConchApp){
			var now=Browser.now();
			if (now-this._frameStartTime >=1000)this._frameStartTime=now;
			else return;
		}
		this._renderCount++;
		Render.isFlash && this.repaint();
		if (!this._style.visible){
			if (this._renderCount % 5===0){
				Stat.loopCount++;
				MouseManager.instance.runEvent();
				Laya.timer._update();
			}
			return;
		}
		this._frameStartTime=Browser.now();
		var frameMode=this._frameRate==="mouse" ? (((this._frameStartTime-this._mouseMoveTime)< 2000)? "fast" :"slow"):this._frameRate;
		var isFastMode=(frameMode!=="slow");
		var isDoubleLoop=(this._renderCount % 2===0);
		Stat.renderSlow=!isFastMode;
		if (isFastMode || isDoubleLoop || Render.isConchApp){
			Stat.loopCount++;
			MouseManager.instance.runEvent();
			Laya.timer._update();
			RunDriver.update3DLoop();
			var scene;
			var i=0,n=0;
			if (Render.isConchNode){
				for (i=0,n=this._scenes.length;i < n;i++){
					scene=this._scenes[i];
					(scene)&& (scene._updateSceneConch());
				}
				}else {
				for (i=0,n=this._scenes.length;i < n;i++){
					scene=this._scenes[i];
					(scene)&& (scene._updateScene());
				}
			}
			if (Render.isConchNode){
				var customList=Sprite["CustomList"];
				for (i=0,n=customList.length;i < n;i++){
					var customItem=customList[i];
					customItem.customRender(customItem.customContext,0,0);
				}
				return;
			}
		}
		if (Render.isConchNode)return;
		if (this.renderingEnabled && (isFastMode || !isDoubleLoop)){
			if (Render.isWebGL){
				context.clear();
				_super.prototype.render.call(this,context,x,y);
				Stat._show&& Stat._sp && Stat._sp.render(context,x,y);
				RunDriver.clear(this._bgColor);
				RunDriver.beginFlush();
				context.flush();
				RunDriver.endFinish();
				VectorGraphManager.instance && VectorGraphManager.getInstance().endDispose();
				}else {
				RunDriver.clear(this._bgColor);
				_super.prototype.render.call(this,context,x,y);
				Stat._show&& Stat._sp && Stat._sp.render(context,x,y);
			}
		}
	}

	/**@private */
	__proto._requestFullscreen=function(){
		var element=Browser.document.documentElement;
		if (element.requestFullscreen){
			element.requestFullscreen();
			}else if (element.mozRequestFullScreen){
			element.mozRequestFullScreen();
			}else if (element.webkitRequestFullscreen){
			element.webkitRequestFullscreen();
			}else if (element.msRequestFullscreen){
			element.msRequestFullscreen();
		}
	}

	/**@private */
	__proto._fullScreenChanged=function(){
		Laya.stage.event("fullscreenchange");
	}

	/**退出全屏模式*/
	__proto.exitFullscreen=function(){
		var document=Browser.document;
		if (document.exitFullscreen){
			document.exitFullscreen();
			}else if (document.mozCancelFullScreen){
			document.mozCancelFullScreen();
			}else if (document.webkitExitFullscreen){
			document.webkitExitFullscreen();
		}
	}

	/**当前视窗由缩放模式导致的 X 轴缩放系数。*/
	__getset(0,__proto,'clientScaleX',function(){
		return this._transform ? this._transform.getScaleX():1;
	});

	//[Deprecated]
	__getset(0,__proto,'desginHeight',function(){
		console.debug("desginHeight已经弃用，请使用designHeight代替");
		return this.designHeight;
	});

	/**帧率类型，支持三种模式：fast-60帧(默认)，slow-30帧，mouse-30帧（鼠标活动后会自动加速到60，鼠标不动2秒后降低为30帧，以节省消耗），sleep-1帧。*/
	__getset(0,__proto,'frameRate',function(){
		return this._frameRate;
		},function(value){
		this._frameRate=value;
		if (Render.isConchApp){
			switch (this._frameRate){
				case "slow":
					Browser.window.conch && Browser.window.conchConfig.setSlowFrame && Browser.window.conchConfig.setSlowFrame(true);
					break ;
				case "fast":
					Browser.window.conch && Browser.window.conchConfig.setSlowFrame && Browser.window.conchConfig.setSlowFrame(false);
					break ;
				case "mouse":
					Browser.window.conch && Browser.window.conchConfig.setMouseFrame && Browser.window.conchConfig.setMouseFrame(2000);
					break ;
				case "sleep":
					Browser.window.conch && Browser.window.conchConfig.setLimitFPS && Browser.window.conchConfig.setLimitFPS(1);
					break ;
				default :
					throw new Error("Stage:frameRate invalid.");
					break ;
				}
		}
	});

	/**当前视窗由缩放模式导致的 Y 轴缩放系数。*/
	__getset(0,__proto,'clientScaleY',function(){
		return this._transform ? this._transform.getScaleY():1;
	});

	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		this.designWidth=value;
		Laya.superSet(Sprite,this,'width',value);
		Laya.timer.callLater(this,this._changeCanvasSize);
	});

	/**
	*<p>水平对齐方式。默认值为"left"。</p>
	*<p><ul>取值范围：
	*<li>"left" ：居左对齐；</li>
	*<li>"center" ：居中对齐；</li>
	*<li>"right" ：居右对齐；</li>
	*</ul></p>
	*/
	__getset(0,__proto,'alignH',function(){
		return this._alignH;
		},function(value){
		this._alignH=value;
		Laya.timer.callLater(this,this._changeCanvasSize);
	});

	/**
	*舞台是否获得焦点。
	*/
	__getset(0,__proto,'isFocused',function(){
		return this._isFocused;
	});

	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		this.designHeight=value;
		Laya.superSet(Sprite,this,'height',value);
		Laya.timer.callLater(this,this._changeCanvasSize);
	});

	__getset(0,__proto,'transform',function(){
		if (this._tfChanged)this._adjustTransform();
		return this._transform=this._transform|| Matrix.create();
	},_super.prototype._$set_transform);

	/**
	*舞台是否处于可见状态(是否进入后台)。
	*/
	__getset(0,__proto,'isVisibility',function(){
		return this._isVisibility;
	});

	//[Deprecated]
	__getset(0,__proto,'desginWidth',function(){
		console.debug("desginWidth已经弃用，请使用designWidth代替");
		return this.designWidth;
	});

	/**
	*<p>缩放模式。默认值为 "noscale"。</p>
	*<p><ul>取值范围：
	*<li>"noscale" ：不缩放；</li>
	*<li>"exactfit" ：全屏不等比缩放；</li>
	*<li>"showall" ：最小比例缩放；</li>
	*<li>"noborder" ：最大比例缩放；</li>
	*<li>"full" ：不缩放，stage的宽高等于屏幕宽高；</li>
	*<li>"fixedwidth" ：宽度不变，高度根据屏幕比缩放；</li>
	*<li>"fixedheight" ：高度不变，宽度根据屏幕比缩放；</li>
	*<li>"fixedauto" ：根据宽高比，自动选择使用fixedwidth或fixedheight；</li>
	*</ul></p>
	*/
	__getset(0,__proto,'scaleMode',function(){
		return this._scaleMode;
		},function(value){
		this._scaleMode=value;
		Laya.timer.callLater(this,this._changeCanvasSize);
	});

	/**
	*<p>垂直对齐方式。默认值为"top"。</p>
	*<p><ul>取值范围：
	*<li>"top" ：居顶部对齐；</li>
	*<li>"middle" ：居中对齐；</li>
	*<li>"bottom" ：居底部对齐；</li>
	*</ul></p>
	*/
	__getset(0,__proto,'alignV',function(){
		return this._alignV;
		},function(value){
		this._alignV=value;
		Laya.timer.callLater(this,this._changeCanvasSize);
	});

	/**舞台的背景颜色，默认为黑色，null为透明。*/
	__getset(0,__proto,'bgColor',function(){
		return this._bgColor;
		},function(value){
		this._bgColor=value;
		this.conchModel && this.conchModel.bgColor(value);
		if (Render.isWebGL){
			if (value){
				Stage._wgColor=Color$1.create(value)._color;
				}else {
				if (!Browser.onMiniGame)Stage._wgColor=null;
			}
		}
		if (Browser.onLimixiu){
			Stage._wgColor=Color$1.create(value)._color;
		}else
		if (value){
			Render.canvas.style.background=value;
			}else {
			Render.canvas.style.background="none";
		}
	});

	/**鼠标在 Stage 上的 X 轴坐标。*/
	__getset(0,__proto,'mouseX',function(){
		return Math.round(MouseManager.instance.mouseX / this.clientScaleX);
	});

	/**鼠标在 Stage 上的 Y 轴坐标。*/
	__getset(0,__proto,'mouseY',function(){
		return Math.round(MouseManager.instance.mouseY / this.clientScaleY);
	});

	/**
	*<p>场景布局类型。</p>
	*<p><ul>取值范围：
	*<li>"none" ：不更改屏幕</li>
	*<li>"horizontal" ：自动横屏</li>
	*<li>"vertical" ：自动竖屏</li>
	*</ul></p>
	*/
	__getset(0,__proto,'screenMode',function(){
		return this._screenMode;
		},function(value){
		this._screenMode=value;
	});

	__getset(0,__proto,'visible',_super.prototype._$get_visible,function(value){
		if (this.visible!==value){
			Laya.superSet(Sprite,this,'visible',value);
			var style=Render._mainCanvas.source.style;
			style.visibility=value ? "visible" :"hidden";
		}
	});

	/**
	*<p>是否开启全屏，用户点击后进入全屏。</p>
	*<p>兼容性提示：部分浏览器不允许点击进入全屏，比如Iphone等。</p>
	*/
	__getset(0,__proto,'fullScreenEnabled',null,function(value){
		var document=Browser.document;
		var canvas=Render.canvas;
		if (value){
			canvas.addEventListener('mousedown',this._requestFullscreen);
			canvas.addEventListener('touchstart',this._requestFullscreen);
			document.addEventListener("fullscreenchange",this._fullScreenChanged);
			document.addEventListener("mozfullscreenchange",this._fullScreenChanged);
			document.addEventListener("webkitfullscreenchange",this._fullScreenChanged);
			document.addEventListener("msfullscreenchange",this._fullScreenChanged);
			}else {
			canvas.removeEventListener('mousedown',this._requestFullscreen);
			canvas.removeEventListener('touchstart',this._requestFullscreen);
			document.removeEventListener("fullscreenchange",this._fullScreenChanged);
			document.removeEventListener("mozfullscreenchange",this._fullScreenChanged);
			document.removeEventListener("webkitfullscreenchange",this._fullScreenChanged);
			document.removeEventListener("msfullscreenchange",this._fullScreenChanged);
		}
	});

	Stage.SCALE_NOSCALE="noscale";
	Stage.SCALE_EXACTFIT="exactfit";
	Stage.SCALE_SHOWALL="showall";
	Stage.SCALE_NOBORDER="noborder";
	Stage.SCALE_FULL="full";
	Stage.SCALE_FIXED_WIDTH="fixedwidth";
	Stage.SCALE_FIXED_HEIGHT="fixedheight";
	Stage.SCALE_FIXED_AUTO="fixedauto";
	Stage.ALIGN_LEFT="left";
	Stage.ALIGN_RIGHT="right";
	Stage.ALIGN_CENTER="center";
	Stage.ALIGN_TOP="top";
	Stage.ALIGN_MIDDLE="middle";
	Stage.ALIGN_BOTTOM="bottom";
	Stage.SCREEN_NONE="none";
	Stage.SCREEN_HORIZONTAL="horizontal";
	Stage.SCREEN_VERTICAL="vertical";
	Stage.FRAME_FAST="fast";
	Stage.FRAME_SLOW="slow";
	Stage.FRAME_MOUSE="mouse";
	Stage.FRAME_SLEEP="sleep";
	Stage.FRAME_MOUSE_THREDHOLD=2000;
	__static(Stage,
	['_wgColor',function(){return this._wgColor=[0,0,0,1];}
	]);
	return Stage;
})(Sprite)


/**
*@private
*/
//class laya.html.dom.HTMLElement extends laya.display.Sprite
var HTMLElement=(function(_super){
	function HTMLElement(){
		this.URI=null;
		this._href=null;
		HTMLElement.__super.call(this);
		this._text=HTMLElement._EMPTYTEXT;
		this.setStyle(new CSSStyle(this));
		this._getCSSStyle().valign="middle";
		this.mouseEnabled=true;
	}

	__class(HTMLElement,'laya.html.dom.HTMLElement',_super);
	var __proto=HTMLElement.prototype;
	/**
	*@private
	*/
	__proto.layaoutCallNative=function(){
		var n=0;
		if (this._childs &&(n=this._childs.length)> 0){
			for (var i=0;i < n;i++){
				this._childs[i].layaoutCallNative && this._childs[i].layaoutCallNative();
			}
		};
		var word=this._getWords();
		word ? laya.html.dom.HTMLElement.fillWords(this,word,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear();
	}

	__proto.appendChild=function(c){
		return this.addChild(c);
	}

	/**
	*rtl模式的getWords函數
	*/
	__proto._getWords2=function(){
		var txt=this._text.text;
		if (!txt || txt.length===0)
			return null;
		var i=0,n=0;
		var realWords;
		var drawWords;
		if (!this._text.drawWords){
			realWords=txt.split(" ");
			n=realWords.length-1;
			drawWords=[];
			for (i=0;i < n;i++){
				drawWords.push(realWords[i]," ")
			}
			if(n>=0)
				drawWords.push(realWords[n]);
			this._text.drawWords=drawWords;
			}else{
			drawWords=this._text.drawWords;
		};
		var words=this._text.words;
		if (words && words.length===drawWords.length)
			return words;
		words===null && (this._text.words=words=[]);
		words.length=drawWords.length;
		var size;
		var style=this.style;
		var fontStr=style.font;
		for (i=0,n=drawWords.length;i < n;i++){
			size=Utils.measureText(drawWords[i],fontStr);
			var tHTMLChar=words[i]=new HTMLChar(drawWords[i],size.width,size.height || style.fontSize,style);
			if (tHTMLChar.char.length > 1){
				tHTMLChar.charNum=tHTMLChar.char;
			}
			if (this.href){
				var tSprite=new Sprite();
				this.addChild(tSprite);
				tHTMLChar.setSprite(tSprite);
			}
		}
		return words;
	}

	__proto._getWords=function(){
		if (!Text.CharacterCache)return this._getWords2();
		var txt=this._text.text;
		if (!txt || txt.length===0)
			return null;
		var words=this._text.words;
		if (words && words.length===txt.length)
			return words;
		words===null && (this._text.words=words=[]);
		words.length=txt.length;
		var size;
		var style=this.style;
		var fontStr=style.font;
		var startX=0;
		for (var i=0,n=txt.length;i < n;i++){
			size=Utils.measureText(txt.charAt(i),fontStr);
			var tHTMLChar=words[i]=new HTMLChar(txt.charAt(i),size.width,size.height||style.fontSize,style);
			if (this.href){
				var tSprite=new Sprite();
				this.addChild(tSprite);
				tHTMLChar.setSprite(tSprite);
			}
		}
		return words;
	}

	__proto.showLinkSprite=function(){
		var words=this._text.words;
		if (words){
			var tLinkSpriteList=[];
			var tSprite;
			var tHtmlChar;
			for (var i=0;i < words.length;i++){
				tHtmlChar=words[i];
				tSprite=new Sprite();
				tSprite.graphics.drawRect(0,0,tHtmlChar.width,tHtmlChar.height,"#ff0000");
				tSprite.width=tHtmlChar.width;
				tSprite.height=tHtmlChar.height;
				this.addChild(tSprite);
				tLinkSpriteList.push(tSprite);
			}
		}
	}

	__proto._layoutLater=function(){
		var style=this.style;
		if ((style._type & 0x200))return;
		if (style.widthed(this)&& (this._childs.length>0 || this._getWords()!=null)&& style.block){
			Layout.later(this);
			style._type |=0x200;
		}
		else{
			this.parent && (this.parent)._layoutLater();
		}
	}

	__proto._setAttributes=function(name,value){
		switch (name){
			case 'style':
				this.style.cssText(value);
				return;
			case 'class':
				this.className=value;
				return;
			}
		_super.prototype._setAttributes.call(this,name,value);
	}

	__proto.updateHref=function(){
		if (this._href !=null){
			var words=this._getWords();
			if (words){
				var tHTMLChar;
				var tSprite;
				for (var i=0;i < words.length;i++){
					tHTMLChar=words[i];
					tSprite=tHTMLChar.getSprite();
					if (tSprite){
						tSprite.size(tHTMLChar.width,tHTMLChar.height);
						tSprite.on("click",this,this.onLinkHandler);
					}
				}
			}
		}
	}

	__proto.onLinkHandler=function(e){
		switch(e.type){
			case "click":;
				var target=this;
				while (target){
					target.event("link",[this.href]);
					target=target.parent;
				}
				break ;
			}
	}

	__proto.formatURL=function(url){
		if (!this.URI)return url;
		return URL.formatURL(url,this.URI ? this.URI.path :null);
	}

	__getset(0,__proto,'href',function(){
		return this._href;
		},function(url){
		this._href=url;
		if (url !=null){
			this._getCSSStyle().underLine=1;
			this.updateHref();
		}
	});

	__getset(0,__proto,'color',null,function(value){
		this.style.color=value;
	});

	__getset(0,__proto,'onClick',null,function(value){
		var fn;
		Laya._runScript("fn=function(event){"+value+";}");
		this.on("click",this,fn);
	});

	__getset(0,__proto,'id',null,function(value){
		HTMLDocument.document.setElementById(value,this);
	});

	__getset(0,__proto,'innerTEXT',function(){
		return this._text.text;
		},function(value){
		this.text=value;
	});

	__getset(0,__proto,'style',function(){
		return this._style;
	});

	__getset(0,__proto,'text',function(){
		return this._text.text;
		},function(value){
		if (this._text==HTMLElement._EMPTYTEXT){
			this._text={text:value,words:null};
		}
		else{
			this._text.text=value;
			this._text.words && (this._text.words.length=0);
		}
		Render.isConchApp && this.layaoutCallNative();
		this._renderType |=0x800;
		this.repaint();
		this.updateHref();
	});

	__getset(0,__proto,'parent',_super.prototype._$get_parent,function(value){
		if ((value instanceof laya.html.dom.HTMLElement )){
			var p=value;
			this.URI || (this.URI=p.URI);
			this.style.inherit(p.style);
		}
		Laya.superSet(Sprite,this,'parent',value);
	});

	__getset(0,__proto,'className',null,function(value){
		this.style.attrs(HTMLDocument.document.styleSheets['.'+value]);
	});

	HTMLElement.fillWords=function(ele,words,x,y,font,color,underLine){
		ele.graphics.clear();
		for (var i=0,n=words.length;i < n;i++){
			var a=words[i];
			ele.graphics.fillText(a.char,a.x+x,a.y+y,font,color,'left',underLine);
		}
	}

	HTMLElement._EMPTYTEXT={text:null,words:null};
	return HTMLElement;
})(Sprite)


/**
*<code>Particle2D</code> 类是2D粒子播放类
*
*/
//class laya.particle.Particle2D extends laya.display.Sprite
var Particle2D=(function(_super){
	function Particle2D(setting){
		/**@private */
		this._matrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];
		/**@private */
		this._particleTemplate=null;
		/**@private */
		this._canvasTemplate=null;
		/**@private */
		this._emitter=null;
		/**是否自动播放*/
		this.autoPlay=true;
		Particle2D.__super.call(this);
		if (setting)this.setParticleSetting(setting);
	}

	__class(Particle2D,'laya.particle.Particle2D',_super);
	var __proto=Particle2D.prototype;
	/**
	*加载粒子文件
	*@param url 粒子文件地址
	*/
	__proto.load=function(url){
		Laya.loader.load(url,Handler.create(this,this.setParticleSetting),null,"json");
	}

	/**
	*设置粒子配置数据
	*@param settings 粒子配置数据
	*/
	__proto.setParticleSetting=function(setting){
		var _$this=this;
		if (!setting)return this.stop();
		ParticleSetting.checkSetting(setting);
		if(!window.ConchParticleTemplate2D||Render.isWebGL)this.customRenderEnable=true;
		if (Render.isWebGL){
			this._particleTemplate=new ParticleTemplate2D(setting);
			this.graphics._saveToCmd(Render.context._drawParticle,[this._particleTemplate]);
		}
		else if (Render.isConchApp&&window.ConchParticleTemplate2D){
			this._particleTemplate=new ConchParticleTemplate2D();
			var _this=this;
			Laya.loader.load(setting.textureName,Handler.create(null,function(texture){
				_this._particleTemplate.texture=texture;
				_this._particleTemplate.settings=setting;
				if (Render.isConchNode){
					_this.graphics.drawParticle(_this._particleTemplate);
				}
				else{
					_this.graphics._saveToCmd(Render.context._drawParticle,[_$this._particleTemplate]);
				}
			}));
			this._emitter={start:function (){}};
			this.play=this._particleTemplate.play.bind(this._particleTemplate);
			this.stop=this._particleTemplate.stop.bind(this._particleTemplate);
			if (this.autoPlay)this.play();
			return;
		}
		else {
			this._particleTemplate=this._canvasTemplate=new ParticleTemplateCanvas(setting);
		}
		if (!this._emitter){
			this._emitter=new Emitter2D(this._particleTemplate);
			}else {
			(this._emitter).template=this._particleTemplate;
		}
		if (this.autoPlay){
			this.emitter.start();
			this.play();
		}
	}

	/**
	*播放
	*/
	__proto.play=function(){
		this.timer.frameLoop(1,this,this._loop);
	}

	/**
	*停止
	*/
	__proto.stop=function(){
		this.timer.clear(this,this._loop);
	}

	/**@private */
	__proto._loop=function(){
		this.advanceTime(1 / 60);
	}

	/**
	*时钟前进
	*@param passedTime 时钟前进时间
	*/
	__proto.advanceTime=function(passedTime){
		(passedTime===void 0)&& (passedTime=1);
		if (this._canvasTemplate){
			this._canvasTemplate.advanceTime(passedTime);
		}
		if (this._emitter){
			this._emitter.advanceTime(passedTime);
		}
	}

	__proto.customRender=function(context,x,y){
		if (Render.isWebGL){
			this._matrix4[0]=context.ctx._curMat.a;
			this._matrix4[1]=context.ctx._curMat.b;
			this._matrix4[4]=context.ctx._curMat.c;
			this._matrix4[5]=context.ctx._curMat.d;
			this._matrix4[12]=context.ctx._curMat.tx;
			this._matrix4[13]=context.ctx._curMat.ty;
			var sv=(this._particleTemplate).sv;
			sv.u_mmat=this._matrix4;
		}
		if (this._canvasTemplate){
			this._canvasTemplate.render(context,x,y);
		}
	}

	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		if ((this._particleTemplate instanceof laya.particle.ParticleTemplate2D ))
			(this._particleTemplate).dispose();
		_super.prototype.destroy.call(this,destroyChild);
	}

	/**
	*设置 粒子文件地址
	*@param path 粒子文件地址
	*/
	__getset(0,__proto,'url',null,function(url){
		this.load(url);
	});

	/**
	*获取粒子发射器
	*/
	__getset(0,__proto,'emitter',function(){
		return this._emitter;
	});

	return Particle2D;
})(Sprite)


/**
*<code>DialogManager</code> 对话框管理容器，所有的对话框都在该容器内，并且受管理器管理。
*任意对话框打开和关闭，都会出发管理类的open和close事件
*可以通过UIConfig设置弹出框背景透明度，模式窗口点击边缘是否关闭，点击窗口是否切换层次等
*通过设置对话框的zOrder属性，可以更改弹出的层次
*/
//class laya.ui.DialogManager extends laya.display.Sprite
var DialogManager=(function(_super){
	function DialogManager(){
		/**锁屏层*/
		this.lockLayer=null;
		/**@private 全局默认弹出对话框效果，可以设置一个效果代替默认的弹出效果，如果不想有任何效果，可以赋值为null*/
		this.popupEffect=function(dialog){
			dialog.scale(1,1);
			Tween.from(dialog,{x:Laya.stage.width / 2,y:Laya.stage.height / 2,scaleX:0,scaleY:0},300,Ease.backOut,Handler.create(this,this.doOpen,[dialog]));
		}
		/**@private 全局默认关闭对话框效果，可以设置一个效果代替默认的关闭效果，如果不想有任何效果，可以赋值为null*/
		this.closeEffect=function(dialog,type){
			Tween.to(dialog,{x:Laya.stage.width / 2,y:Laya.stage.height / 2,scaleX:0,scaleY:0},300,Ease.strongOut,Handler.create(this,this.doClose,[dialog,type]));
		}
		DialogManager.__super.call(this);
		this.maskLayer=new Sprite();
		this.popupEffectHandler=new Handler(this,this.popupEffect);
		this.closeEffectHandler=new Handler(this,this.closeEffect);
		this.mouseEnabled=this.maskLayer.mouseEnabled=true;
		this.zOrder=1000;
		Laya.stage.addChild(this);
		Laya.stage.on("resize",this,this._onResize);
		if (UIConfig.closeDialogOnSide)this.maskLayer.on("click",this,this._closeOnSide);
		this._onResize(null);
	}

	__class(DialogManager,'laya.ui.DialogManager',_super);
	var __proto=DialogManager.prototype;
	__proto._closeOnSide=function(){
		var dialog=this.getChildAt(this.numChildren-1);
		if ((dialog instanceof laya.ui.Dialog ))dialog.close("side");
	}

	/**设置锁定界面，如果为空则什么都不显示*/
	__proto.setLockView=function(value){
		if (!this.lockLayer){
			this.lockLayer=new Box();
			this.lockLayer.mouseEnabled=true;
			this.lockLayer.size(Laya.stage.width,Laya.stage.height);
		}
		this.lockLayer.removeChildren();
		if (value){
			value.centerX=value.centerY=0;
			this.lockLayer.addChild(value);
		}
	}

	/**@private */
	__proto._onResize=function(e){
		var width=this.maskLayer.width=Laya.stage.width;
		var height=this.maskLayer.height=Laya.stage.height;
		if (this.lockLayer)this.lockLayer.size(width,height);
		this.maskLayer.graphics.clear();
		this.maskLayer.graphics.drawRect(0,0,width,height,UIConfig.popupBgColor);
		this.maskLayer.alpha=UIConfig.popupBgAlpha;
		for (var i=this.numChildren-1;i >-1;i--){
			var item=this.getChildAt(i);
			if (item.popupCenter)this._centerDialog(item);
		}
	}

	__proto._centerDialog=function(dialog){
		dialog.x=Math.round(((Laya.stage.width-dialog.width)>> 1)+dialog.pivotX);
		dialog.y=Math.round(((Laya.stage.height-dialog.height)>> 1)+dialog.pivotY);
	}

	/**
	*显示对话框(非模式窗口类型)。
	*@param dialog 需要显示的对象框 <code>Dialog</code> 实例。
	*@param closeOther 是否关闭其它对话框，若值为ture，则关闭其它的对话框。
	*@param showEffect 是否显示弹出效果
	*/
	__proto.open=function(dialog,closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=false);
		if (closeOther)this._closeAll();
		if (dialog.popupCenter)this._centerDialog(dialog);
		this.addChild(dialog);
		if (dialog.isModal || this._$P["hasZorder"])this.timer.callLater(this,this._checkMask);
		if (showEffect && dialog.popupEffect !=null)dialog.popupEffect.runWith(dialog);
		else this.doOpen(dialog);
		this.event("open");
	}

	/**
	*执行打开对话框。
	*@param dialog 需要关闭的对象框 <code>Dialog</code> 实例。
	*@param type 关闭的类型，默认为空
	*/
	__proto.doOpen=function(dialog){
		dialog.onOpened();
	}

	/**
	*锁定所有层，显示加载条信息，防止双击
	*/
	__proto.lock=function(value){
		if (this.lockLayer){
			if (value)this.addChild(this.lockLayer);
			else this.lockLayer.removeSelf();
		}
	}

	/**
	*关闭对话框。
	*@param dialog 需要关闭的对象框 <code>Dialog</code> 实例。
	*@param type 关闭的类型，默认为空
	*@param showEffect 是否显示弹出效果
	*/
	__proto.close=function(dialog,type,showEffect){
		(showEffect===void 0)&& (showEffect=false);
		if (showEffect && dialog.closeEffect !=null)dialog.closeEffect.runWith([dialog,type]);
		else this.doClose(dialog,type);
		this.event("close");
	}

	/**
	*执行关闭对话框。
	*@param dialog 需要关闭的对象框 <code>Dialog</code> 实例。
	*@param type 关闭的类型，默认为空
	*/
	__proto.doClose=function(dialog,type){
		dialog.removeSelf();
		dialog.isModal && this._checkMask();
		dialog.closeHandler && dialog.closeHandler.runWith(type);
		dialog.onClosed(type);
	}

	/**
	*关闭所有的对话框。
	*/
	__proto.closeAll=function(){
		this._closeAll();
		this.event("close");
	}

	/**@private */
	__proto._closeAll=function(){
		for (var i=this.numChildren-1;i >-1;i--){
			var item=this.getChildAt(i);
			if (item && item.close !=null){
				this.doClose(item);
			}
		}
	}

	/**
	*根据组获取所有对话框
	*@param group 组名称
	*@return 对话框数组
	*/
	__proto.getDialogsByGroup=function(group){
		var arr=[];
		for (var i=this.numChildren-1;i >-1;i--){
			var item=this.getChildAt(i);
			if (item && item.group===group){
				arr.push(item);
			}
		}
		return arr;
	}

	/**
	*根据组关闭所有弹出框
	*@param group 需要关闭的组名称
	*@return 需要关闭的对话框数组
	*/
	__proto.closeByGroup=function(group){
		var arr=[];
		for (var i=this.numChildren-1;i >-1;i--){
			var item=this.getChildAt(i);
			if (item && item.group===group){
				item.close();
				arr.push(item);
			}
		}
		return arr;
	}

	/**@private 发生层次改变后，重新检查遮罩层是否正确*/
	__proto._checkMask=function(){
		this.maskLayer.removeSelf();
		for (var i=this.numChildren-1;i >-1;i--){
			var dialog=this.getChildAt(i);
			if (dialog && dialog.isModal){
				this.addChildAt(this.maskLayer,i);
				return;
			}
		}
	}

	return DialogManager;
})(Sprite)


/**
*动画模板类
*/
//class laya.ani.bone.Templet extends laya.ani.AnimationTemplet
var Templet=(function(_super){
	function Templet(){
		this._mainTexture=null;
		this._textureJson=null;
		this._graphicsCache=[];
		/**存放原始骨骼信息 */
		this.srcBoneMatrixArr=[];
		/**IK数据 */
		this.ikArr=[];
		/**transform数据 */
		this.tfArr=[];
		/**path数据 */
		this.pathArr=[];
		/**存放插槽数据的字典 */
		this.boneSlotDic={};
		/**绑定插槽数据的字典 */
		this.bindBoneBoneSlotDic={};
		/**存放插糟数据的数组 */
		this.boneSlotArray=[];
		/**皮肤数据 */
		this.skinDataArray=[];
		/**皮肤的字典数据 */
		this.skinDic={};
		/**存放纹理数据 */
		this.subTextureDic={};
		/**是否解析失败 */
		this.isParseFail=false;
		/**反转矩阵，有些骨骼动画要反转才能显示 */
		this.yReverseMatrix=null;
		/**渲染顺序动画数据 */
		this.drawOrderAniArr=[];
		/**事件动画数据 */
		this.eventAniArr=[];
		/**@private 索引对应的名称 */
		this.attachmentNames=null;
		/**顶点动画数据 */
		this.deformAniArr=[];
		this._isDestroyed=false;
		this._rate=30;
		this.isParserComplete=false;
		this.aniSectionDic={};
		this._skBufferUrl=null;
		this._textureDic={};
		this._loadList=null;
		this._path=null;
		/**@private */
		this.tMatrixDataLen=0;
		this.mRootBone=null;
		Templet.__super.call(this);
		this.skinSlotDisplayDataArr=[];
		this.mBoneArr=[];
	}

	__class(Templet,'laya.ani.bone.Templet',_super);
	var __proto=Templet.prototype;
	__proto.loadAni=function(url){
		this._skBufferUrl=url;
		Laya.loader.load(url,Handler.create(this,this.onComplete),null,"arraybuffer");
	}

	__proto.onComplete=function(content){
		if (this._isDestroyed){
			this.destroy();
			return;
		};
		var tSkBuffer=Loader.getRes(this._skBufferUrl);
		if (!tSkBuffer){
			this.event("error","load failed:"+this._skBufferUrl);
			return;
		}
		this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/";
		this.parseData(null,tSkBuffer);
	}

	/**
	*解析骨骼动画数据
	*@param texture 骨骼动画用到的纹理
	*@param skeletonData 骨骼动画信息及纹理分块信息
	*@param playbackRate 缓冲的帧率数据（会根据帧率去分帧）
	*/
	__proto.parseData=function(texture,skeletonData,playbackRate){
		(playbackRate===void 0)&& (playbackRate=30);
		if(!this._path&&this.url)this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/";
		this._mainTexture=texture;
		if (this._mainTexture){
			if (Render.isWebGL && texture.bitmap){
				texture.bitmap.enableMerageInAtlas=false;
			}
		}
		this._rate=playbackRate;
		this.parse(skeletonData);
	}

	/**
	*创建动画
	*0,使用模板缓冲的数据，模板缓冲的数据，不允许修改 （内存开销小，计算开销小，不支持换装）
	*1,使用动画自己的缓冲区，每个动画都会有自己的缓冲区，相当耗费内存 （内存开销大，计算开销小，支持换装）
	*2,使用动态方式，去实时去画 （内存开销小，计算开销大，支持换装,不建议使用）
	*@param aniMode 0 动画模式，0:不支持换装,1,2支持换装
	*@return
	*/
	__proto.buildArmature=function(aniMode){
		(aniMode===void 0)&& (aniMode=0);
		return new Skeleton(this,aniMode);
	}

	/**
	*@private
	*解析动画
	*@param data 解析的二进制数据
	*@param playbackRate 帧率
	*/
	__proto.parse=function(data){
		_super.prototype.parse.call(this,data);
		this._endLoaded();
		if (this._aniVersion !=Templet.LAYA_ANIMATION_VISION){
			console.log("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+Templet.LAYA_ANIMATION_VISION);
			this._loaded=false;
		}
		if (this.loaded){
			if (this._mainTexture){
				this._parsePublicExtData();
				}else {
				this._parseTexturePath();
			}
			}else {
			this.event("error",this);
			this.isParseFail=true;
		}
	}

	__proto._parseTexturePath=function(){
		if (this._isDestroyed){
			this.destroy();
			return;
		};
		var i=0;
		this._loadList=[];
		var tByte=new Byte(this.getPublicExtData());
		var tX=0,tY=0,tWidth=0,tHeight=0;
		var tFrameX=0,tFrameY=0,tFrameWidth=0,tFrameHeight=0;
		var tTempleData=0;
		var tTextureLen=tByte.getInt32();
		var tTextureName=tByte.readUTFString();
		var tTextureNameArr=tTextureName.split("\n");
		var tTexture;
		var tSrcTexturePath;
		for (i=0;i < tTextureLen;i++){
			tSrcTexturePath=this._path+tTextureNameArr[i *2];
			tTextureName=tTextureNameArr[i *2+1];
			tX=tByte.getFloat32();
			tY=tByte.getFloat32();
			tWidth=tByte.getFloat32();
			tHeight=tByte.getFloat32();
			tTempleData=tByte.getFloat32();
			tFrameX=isNaN(tTempleData)? 0 :tTempleData;
			tTempleData=tByte.getFloat32();
			tFrameY=isNaN(tTempleData)? 0 :tTempleData;
			tTempleData=tByte.getFloat32();
			tFrameWidth=isNaN(tTempleData)? tWidth :tTempleData;
			tTempleData=tByte.getFloat32();
			tFrameHeight=isNaN(tTempleData)? tHeight :tTempleData;
			if (this._loadList.indexOf(tSrcTexturePath)==-1){
				this._loadList.push(tSrcTexturePath);
			}
		}
		Laya.loader.load(this._loadList,Handler.create(this,this._textureComplete));
	}

	/**
	*纹理加载完成
	*/
	__proto._textureComplete=function(){
		var tTexture;
		var tTextureName;
		for (var i=0,n=this._loadList.length;i < n;i++){
			tTextureName=this._loadList[i];
			tTexture=this._textureDic[tTextureName]=Loader.getRes(tTextureName);
			if (Render.isWebGL && tTexture && tTexture.bitmap){
				tTexture.bitmap.enableMerageInAtlas=false;
			}
		}
		this._parsePublicExtData();
	}

	/**
	*解析自定义数据
	*/
	__proto._parsePublicExtData=function(){
		var i=0,j=0,k=0,l=0,n=0;
		for (i=0,n=this.getAnimationCount();i < n;i++){
			this._graphicsCache.push([]);
		};
		var isSpine=false;
		isSpine=this._aniClassName !="Dragon";
		var tByte=new Byte(this.getPublicExtData());
		var tX=0,tY=0,tWidth=0,tHeight=0;
		var tFrameX=0,tFrameY=0,tFrameWidth=0,tFrameHeight=0;
		var tTempleData=0;
		var tTextureLen=tByte.getInt32();
		var tTextureName=tByte.readUTFString();
		var tTextureNameArr=tTextureName.split("\n");
		var tTexture;
		var tSrcTexturePath;
		for (i=0;i < tTextureLen;i++){
			tTexture=this._mainTexture;
			tSrcTexturePath=this._path+tTextureNameArr[i *2];
			tTextureName=tTextureNameArr[i *2+1];
			if (this._mainTexture==null){
				tTexture=this._textureDic[tSrcTexturePath];
			}
			if (!tTexture){
				this.event("error",this);
				this.isParseFail=true;
				return;
			}
			tX=tByte.getFloat32();
			tY=tByte.getFloat32();
			tWidth=tByte.getFloat32();
			tHeight=tByte.getFloat32();
			tTempleData=tByte.getFloat32();
			tFrameX=isNaN(tTempleData)? 0 :tTempleData;
			tTempleData=tByte.getFloat32();
			tFrameY=isNaN(tTempleData)? 0 :tTempleData;
			tTempleData=tByte.getFloat32();
			tFrameWidth=isNaN(tTempleData)? tWidth :tTempleData;
			tTempleData=tByte.getFloat32();
			tFrameHeight=isNaN(tTempleData)? tHeight :tTempleData;
			this.subTextureDic[tTextureName]=Texture.create(tTexture,tX,tY,tWidth,tHeight,-tFrameX,-tFrameY,tFrameWidth,tFrameHeight);
		}
		this._mainTexture=tTexture;
		var tAniCount=tByte.getUint16();
		var tSectionArr;
		for (i=0;i < tAniCount;i++){
			tSectionArr=[];
			tSectionArr.push(tByte.getUint16());
			tSectionArr.push(tByte.getUint16());
			tSectionArr.push(tByte.getUint16());
			tSectionArr.push(tByte.getUint16());
			this.aniSectionDic[i]=tSectionArr;
		};
		var tBone;
		var tParentBone;
		var tName;
		var tParentName;
		var tBoneLen=tByte.getInt16();
		var tBoneDic={};
		var tRootBone;
		for (i=0;i < tBoneLen;i++){
			tBone=new Bone();
			if (i==0){
				tRootBone=tBone;
				}else {
				tBone.root=tRootBone;
			}
			tBone.d=isSpine?-1:1;
			tName=tByte.readUTFString();
			tParentName=tByte.readUTFString();
			tBone.length=tByte.getFloat32();
			if (tByte.getByte()==1){
				tBone.inheritRotation=false;
			}
			if (tByte.getByte()==1){
				tBone.inheritScale=false;
			}
			tBone.name=tName;
			if (tParentName){
				tParentBone=tBoneDic[tParentName];
				if (tParentBone){
					tParentBone.addChild(tBone);
					}else {
					this.mRootBone=tBone;
				}
			}
			tBoneDic[tName]=tBone;
			this.mBoneArr.push(tBone);
		}
		this.tMatrixDataLen=tByte.getUint16();
		var tLen=tByte.getUint16();
		var parentIndex=0;
		var boneLength=Math.floor(tLen / this.tMatrixDataLen);
		var tResultTransform;
		var tMatrixArray=this.srcBoneMatrixArr;
		for (i=0;i < boneLength;i++){
			tResultTransform=new Transform();
			tResultTransform.scX=tByte.getFloat32();
			tResultTransform.skX=tByte.getFloat32();
			tResultTransform.skY=tByte.getFloat32();
			tResultTransform.scY=tByte.getFloat32();
			tResultTransform.x=tByte.getFloat32();
			tResultTransform.y=tByte.getFloat32();
			if (this.tMatrixDataLen===8){
				tResultTransform.skewX=tByte.getFloat32();
				tResultTransform.skewY=tByte.getFloat32();
			}
			tMatrixArray.push(tResultTransform);
			tBone=this.mBoneArr[i];
			tBone.transform=tResultTransform;
		};
		var tIkConstraintData;
		var tIkLen=tByte.getUint16();
		var tIkBoneLen=0;
		for (i=0;i < tIkLen;i++){
			tIkConstraintData=new IkConstraintData();
			tIkBoneLen=tByte.getUint16();
			for (j=0;j < tIkBoneLen;j++){
				tIkConstraintData.boneNames.push(tByte.readUTFString());
				tIkConstraintData.boneIndexs.push(tByte.getInt16());
			}
			tIkConstraintData.name=tByte.readUTFString();
			tIkConstraintData.targetBoneName=tByte.readUTFString();
			tIkConstraintData.targetBoneIndex=tByte.getInt16();
			tIkConstraintData.bendDirection=tByte.getFloat32();
			tIkConstraintData.mix=tByte.getFloat32();
			tIkConstraintData.isSpine=isSpine;
			this.ikArr.push(tIkConstraintData);
		};
		var tTfConstraintData;
		var tTfLen=tByte.getUint16();
		var tTfBoneLen=0;
		for (i=0;i < tTfLen;i++){
			tTfConstraintData=new TfConstraintData();
			tTfBoneLen=tByte.getUint16();
			for (j=0;j < tTfBoneLen;j++){
				tTfConstraintData.boneIndexs.push(tByte.getInt16());
			}
			tTfConstraintData.name=tByte.getUTFString();
			tTfConstraintData.targetIndex=tByte.getInt16();
			tTfConstraintData.rotateMix=tByte.getFloat32();
			tTfConstraintData.translateMix=tByte.getFloat32();
			tTfConstraintData.scaleMix=tByte.getFloat32();
			tTfConstraintData.shearMix=tByte.getFloat32();
			tTfConstraintData.offsetRotation=tByte.getFloat32();
			tTfConstraintData.offsetX=tByte.getFloat32();
			tTfConstraintData.offsetY=tByte.getFloat32();
			tTfConstraintData.offsetScaleX=tByte.getFloat32();
			tTfConstraintData.offsetScaleY=tByte.getFloat32();
			tTfConstraintData.offsetShearY=tByte.getFloat32();
			this.tfArr.push(tTfConstraintData);
		};
		var tPathConstraintData;
		var tPathLen=tByte.getUint16();
		var tPathBoneLen=0;
		for (i=0;i < tPathLen;i++){
			tPathConstraintData=new PathConstraintData();
			tPathConstraintData.name=tByte.readUTFString();
			tPathBoneLen=tByte.getUint16();
			for (j=0;j < tPathBoneLen;j++){
				tPathConstraintData.bones.push(tByte.getInt16());
			}
			tPathConstraintData.target=tByte.readUTFString();
			tPathConstraintData.positionMode=tByte.readUTFString();
			tPathConstraintData.spacingMode=tByte.readUTFString();
			tPathConstraintData.rotateMode=tByte.readUTFString();
			tPathConstraintData.offsetRotation=tByte.getFloat32();
			tPathConstraintData.position=tByte.getFloat32();
			tPathConstraintData.spacing=tByte.getFloat32();
			tPathConstraintData.rotateMix=tByte.getFloat32();
			tPathConstraintData.translateMix=tByte.getFloat32();
			this.pathArr.push(tPathConstraintData);
		};
		var tDeformSlotLen=0;
		var tDeformSlotDisplayLen=0;
		var tDSlotIndex=0;
		var tDAttachment;
		var tDeformTimeLen=0;
		var tDTime=NaN;
		var tDeformVecticesLen=0;
		var tDeformAniData;
		var tDeformSlotData;
		var tDeformSlotDisplayData;
		var tDeformVectices;
		var tDeformAniLen=tByte.getInt16();
		for (i=0;i < tDeformAniLen;i++){
			var tDeformSkinLen=tByte.getUint8();
			var tSkinDic={};
			this.deformAniArr.push(tSkinDic);
			for (var f=0;f < tDeformSkinLen;f++){
				tDeformAniData=new DeformAniData();
				tDeformAniData.skinName=tByte.getUTFString();
				tSkinDic[tDeformAniData.skinName]=tDeformAniData;
				tDeformSlotLen=tByte.getInt16();
				for (j=0;j < tDeformSlotLen;j++){
					tDeformSlotData=new DeformSlotData();
					tDeformAniData.deformSlotDataList.push(tDeformSlotData);
					tDeformSlotDisplayLen=tByte.getInt16();
					for (k=0;k < tDeformSlotDisplayLen;k++){
						tDeformSlotDisplayData=new DeformSlotDisplayData();
						tDeformSlotData.deformSlotDisplayList.push(tDeformSlotDisplayData);
						tDeformSlotDisplayData.slotIndex=tDSlotIndex=tByte.getInt16();
						tDeformSlotDisplayData.attachment=tDAttachment=tByte.getUTFString();
						tDeformTimeLen=tByte.getInt16();
						for (l=0;l < tDeformTimeLen;l++){
							if (tByte.getByte()==1){
								tDeformSlotDisplayData.tweenKeyList.push(true);
								}else {
								tDeformSlotDisplayData.tweenKeyList.push(false);
							}
							tDTime=tByte.getFloat32();
							tDeformSlotDisplayData.timeList.push(tDTime);
							tDeformVectices=[];
							tDeformSlotDisplayData.vectices.push(tDeformVectices);
							tDeformVecticesLen=tByte.getInt16();
							for (n=0;n < tDeformVecticesLen;n++){
								tDeformVectices.push(tByte.getFloat32());
							}
						}
					}
				}
			}
		};
		var tDrawOrderArr;
		var tDrawOrderAniLen=tByte.getInt16();
		var tDrawOrderLen=0;
		var tDrawOrderData;
		var tDoLen=0;
		for (i=0;i < tDrawOrderAniLen;i++){
			tDrawOrderLen=tByte.getInt16();
			tDrawOrderArr=[];
			for (j=0;j < tDrawOrderLen;j++){
				tDrawOrderData=new DrawOrderData();
				tDrawOrderData.time=tByte.getFloat32();
				tDoLen=tByte.getInt16();
				for (k=0;k < tDoLen;k++){
					tDrawOrderData.drawOrder.push(tByte.getInt16());
				}
				tDrawOrderArr.push(tDrawOrderData);
			}
			this.drawOrderAniArr.push(tDrawOrderArr);
		};
		var tEventArr;
		var tEventAniLen=tByte.getInt16();
		var tEventLen=0;
		var tEventData;
		for (i=0;i < tEventAniLen;i++){
			tEventLen=tByte.getInt16();
			tEventArr=[];
			for (j=0;j < tEventLen;j++){
				tEventData=new EventData();
				tEventData.name=tByte.getUTFString();
				tEventData.intValue=tByte.getInt32();
				tEventData.floatValue=tByte.getFloat32();
				tEventData.stringValue=tByte.getUTFString();
				tEventData.time=tByte.getFloat32();
				tEventArr.push(tEventData);
			}
			this.eventAniArr.push(tEventArr);
		};
		var tAttachmentLen=tByte.getInt16();
		if (tAttachmentLen > 0){
			this.attachmentNames=[];
			for (i=0;i < tAttachmentLen;i++){
				this.attachmentNames.push(tByte.getUTFString());
			}
		};
		var tBoneSlotLen=tByte.getInt16();
		var tDBBoneSlot;
		var tDBBoneSlotArr;
		for (i=0;i < tBoneSlotLen;i++){
			tDBBoneSlot=new BoneSlot();
			tDBBoneSlot.name=tByte.readUTFString();
			tDBBoneSlot.parent=tByte.readUTFString();
			tDBBoneSlot.attachmentName=tByte.readUTFString();
			tDBBoneSlot.srcDisplayIndex=tDBBoneSlot.displayIndex=tByte.getInt16();
			tDBBoneSlot.templet=this;
			this.boneSlotDic[tDBBoneSlot.name]=tDBBoneSlot;
			tDBBoneSlotArr=this.bindBoneBoneSlotDic[tDBBoneSlot.parent];
			if (tDBBoneSlotArr==null){
				this.bindBoneBoneSlotDic[tDBBoneSlot.parent]=tDBBoneSlotArr=[];
			}
			tDBBoneSlotArr.push(tDBBoneSlot);
			this.boneSlotArray.push(tDBBoneSlot);
		};
		var tNameString=tByte.readUTFString();
		var tNameArray=tNameString.split("\n");
		var tNameStartIndex=0;
		var tSkinDataLen=tByte.getUint8();
		var tSkinData,tSlotData,tDisplayData;
		var tSlotDataLen=0,tDisplayDataLen=0;
		var tUvLen=0,tWeightLen=0,tTriangleLen=0,tVerticeLen=0,tLengthLen=0;
		for (i=0;i < tSkinDataLen;i++){
			tSkinData=new SkinData();
			tSkinData.name=tNameArray[tNameStartIndex++];
			tSlotDataLen=tByte.getUint8();
			for (j=0;j < tSlotDataLen;j++){
				tSlotData=new SlotData();
				tSlotData.name=tNameArray[tNameStartIndex++];
				tDBBoneSlot=this.boneSlotDic[tSlotData.name];
				tDisplayDataLen=tByte.getUint8();
				for (k=0;k < tDisplayDataLen;k++){
					tDisplayData=new SkinSlotDisplayData();
					this.skinSlotDisplayDataArr.push(tDisplayData);
					tDisplayData.name=tNameArray[tNameStartIndex++];
					tDisplayData.attachmentName=tNameArray[tNameStartIndex++];
					tDisplayData.transform=new Transform();
					tDisplayData.transform.scX=tByte.getFloat32();
					tDisplayData.transform.skX=tByte.getFloat32();
					tDisplayData.transform.skY=tByte.getFloat32();
					tDisplayData.transform.scY=tByte.getFloat32();
					tDisplayData.transform.x=tByte.getFloat32();
					tDisplayData.transform.y=tByte.getFloat32();
					tSlotData.displayArr.push(tDisplayData);
					tDisplayData.width=tByte.getFloat32();
					tDisplayData.height=tByte.getFloat32();
					tDisplayData.type=tByte.getUint8();
					tDisplayData.verLen=tByte.getUint16();
					tBoneLen=tByte.getUint16();
					if (tBoneLen > 0){
						tDisplayData.bones=[];
						for (l=0;l < tBoneLen;l++){
							var tBoneId=tByte.getUint16();
							tDisplayData.bones.push(tBoneId);
						}
					}
					tUvLen=tByte.getUint16();
					if (tUvLen > 0){
						tDisplayData.uvs=[];
						for (l=0;l < tUvLen;l++){
							tDisplayData.uvs.push(tByte.getFloat32());
						}
					}
					tWeightLen=tByte.getUint16();
					if (tWeightLen > 0){
						tDisplayData.weights=[];
						for (l=0;l < tWeightLen;l++){
							tDisplayData.weights.push(tByte.getFloat32());
						}
					}
					tTriangleLen=tByte.getUint16();
					if (tTriangleLen > 0){
						tDisplayData.triangles=[];
						for (l=0;l < tTriangleLen;l++){
							tDisplayData.triangles.push(tByte.getUint16());
						}
					}
					tVerticeLen=tByte.getUint16();
					if (tVerticeLen > 0){
						tDisplayData.vertices=[];
						for (l=0;l < tVerticeLen;l++){
							tDisplayData.vertices.push(tByte.getFloat32());
						}
					}
					tLengthLen=tByte.getUint16();
					if (tLengthLen > 0){
						tDisplayData.lengths=[];
						for (l=0;l < tLengthLen;l++){
							tDisplayData.lengths.push(tByte.getFloat32());
						}
					}
				}
				tSkinData.slotArr.push(tSlotData);
			}
			this.skinDic[tSkinData.name]=tSkinData;
			this.skinDataArray.push(tSkinData);
		};
		var tReverse=tByte.getUint8();
		if (tReverse==1){
			this.yReverseMatrix=new Matrix(1,0,0,-1,0,0);
			if (tRootBone){
				tRootBone.setTempMatrix(this.yReverseMatrix);
			}
			}else {
			if (tRootBone){
				tRootBone.setTempMatrix(new Matrix());
			}
		}
		this.showSkinByIndex(this.boneSlotDic,0);
		this.isParserComplete=true;
		this.event("complete",this);
	}

	/**
	*得到指定的纹理
	*@param name 纹理的名字
	*@return
	*/
	__proto.getTexture=function(name){
		var tTexture=this.subTextureDic[name];
		if (!tTexture){
			tTexture=this.subTextureDic[name.substr(0,name.length-1)];
		}
		if (tTexture==null){
			return this._mainTexture;
		}
		return tTexture;
	}

	/**
	*@private
	*显示指定的皮肤
	*@param boneSlotDic 插糟字典的引用
	*@param skinIndex 皮肤的索引
	*@param freshDisplayIndex 是否重置插槽纹理
	*/
	__proto.showSkinByIndex=function(boneSlotDic,skinIndex,freshDisplayIndex){
		(freshDisplayIndex===void 0)&& (freshDisplayIndex=true);
		if (skinIndex < 0 && skinIndex >=this.skinDataArray.length)return false;
		var i=0,n=0;
		var tBoneSlot;
		var tSlotData;
		var tSkinData=this.skinDataArray[skinIndex];
		if (tSkinData){
			for (i=0,n=tSkinData.slotArr.length;i < n;i++){
				tSlotData=tSkinData.slotArr[i];
				if (tSlotData){
					tBoneSlot=boneSlotDic[tSlotData.name];
					if (tBoneSlot){
						tBoneSlot.showSlotData(tSlotData,freshDisplayIndex);
						if (freshDisplayIndex&&tBoneSlot.attachmentName !="undefined" && tBoneSlot.attachmentName !="null"){
							tBoneSlot.showDisplayByName(tBoneSlot.attachmentName);
							}else {
							tBoneSlot.showDisplayByIndex(tBoneSlot.displayIndex);
						}
					}
				}
			}
			return true;
		}
		return false;
	}

	/**
	*通过皮肤名字得到皮肤索引
	*@param skinName 皮肤名称
	*@return
	*/
	__proto.getSkinIndexByName=function(skinName){
		var tSkinData;
		for (var i=0,n=this.skinDataArray.length;i < n;i++){
			tSkinData=this.skinDataArray[i];
			if (tSkinData.name==skinName){
				return i;
			}
		}
		return-1;
	}

	/**
	*@private
	*得到缓冲数据
	*@param aniIndex 动画索引
	*@param frameIndex 帧索引
	*@return
	*/
	__proto.getGrahicsDataWithCache=function(aniIndex,frameIndex){
		return this._graphicsCache[aniIndex][frameIndex];
	}

	/**
	*@private
	*保存缓冲grahpics
	*@param aniIndex 动画索引
	*@param frameIndex 帧索引
	*@param graphics 要保存的数据
	*/
	__proto.setGrahicsDataWithCache=function(aniIndex,frameIndex,graphics){
		this._graphicsCache[aniIndex][frameIndex]=graphics;
	}

	/**
	*释放纹理
	*/
	__proto.destroy=function(){
		this._isDestroyed=true;
		var tTexture;
		for(var $each_tTexture in this.subTextureDic){
			tTexture=this.subTextureDic[$each_tTexture];
			if(tTexture)
				tTexture.destroy();
		}
		var $each_tTexture;
		for($each_tTexture in this._textureDic){
			tTexture=this._textureDic[$each_tTexture];
			if(tTexture)
				tTexture.destroy();
		};
		var tSkinSlotDisplayData;
		for (var i=0,n=this.skinSlotDisplayDataArr.length;i < n;i++){
			tSkinSlotDisplayData=this.skinSlotDisplayDataArr[i];
			tSkinSlotDisplayData.destory();
		}
		this.skinSlotDisplayDataArr.length=0;
		if (this.url){
			delete Templet.TEMPLET_DICTIONARY[this.url];
		}
		laya.resource.Resource.prototype.destroy.call(this);
	}

	/**
	*通过索引得动画名称
	*@param index
	*@return
	*/
	__proto.getAniNameByIndex=function(index){
		var tAni=this.getAnimation(index);
		if (tAni)return tAni.name;
		return null;
	}

	__getset(0,__proto,'rate',function(){
		return this._rate;
		},function(v){
		this._rate=v;
	});

	Templet.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0";
	Templet.TEMPLET_DICTIONARY=null;
	return Templet;
})(AnimationTemplet)


//class laya.webgl.shader.Shader extends laya.webgl.shader.BaseShader
var Shader=(function(_super){
	function Shader(vs,ps,saveName,nameMap){
		//this._nameMap=null;
		//shader参数别名，语义
		//this._vs=null;
		//this._ps=null;
		this._curActTexIndex=0;
		//this._reCompile=false;
		//存储一些私有变量
		this.tag={};
		//this._vshader=null;
		//this._pshader=null;
		this._program=null;
		this._params=null;
		this._paramsMap={};
		this._offset=0;
		//this._id=0;
		Shader.__super.call(this);
		if ((!vs)|| (!ps))throw "Shader Error";
		this._id=++Shader._count;
		this._vs=vs;
		this._ps=ps;
		this._nameMap=nameMap ? nameMap :{};
		saveName !=null && (Shader.sharders[saveName]=this);
	}

	__class(Shader,'laya.webgl.shader.Shader',_super);
	var __proto=Shader.prototype;
	__proto.recreateResource=function(){
		this._compile();
		this.completeCreate();
		this.memorySize=0;
	}

	//忽略尺寸尺寸
	__proto.disposeResource=function(){
		WebGL.mainContext.deleteShader(this._vshader);
		WebGL.mainContext.deleteShader(this._pshader);
		WebGL.mainContext.deleteProgram(this._program);
		this._vshader=this._pshader=this._program=null;
		this._params=null;
		this._paramsMap={};
		this.memorySize=0;
		this._curActTexIndex=0;
	}

	__proto._compile=function(){
		if (!this._vs || !this._ps || this._params)
			return;
		this._reCompile=true;
		this._params=[];
		var text=[this._vs,this._ps];
		var result;
		var gl=WebGL.mainContext;
		this._program=gl.createProgram();
		this._vshader=Shader._createShader(gl,text[0],0x8B31);
		this._pshader=Shader._createShader(gl,text[1],0x8B30);
		gl.attachShader(this._program,this._vshader);
		gl.attachShader(this._program,this._pshader);
		gl.linkProgram(this._program);
		if (!Render.isConchApp && !gl.getProgramParameter(this._program,0x8B82)){
			throw gl.getProgramInfoLog(this._program);
		};
		var one,i=0,j=0,n=0,location;
		var attribNum=0;
		if (Render.isConchApp){
			attribNum=gl.getProgramParameterEx(this._vs,this._ps,"",0x8B89);
		}
		else{
			attribNum=gl.getProgramParameter(this._program,0x8B89);
		}
		for (i=0;i < attribNum;i++){
			var attrib=null;
			if (Render.isConchApp){
				attrib=gl.getActiveAttribEx(this._vs,this._ps,"",i);
			}
			else{
				attrib=gl.getActiveAttrib(this._program,i);
			}
			location=gl.getAttribLocation(this._program,attrib.name);
			one={vartype:"attribute",glfun:null,ivartype:0,attrib:attrib,location:location,name:attrib.name,type:attrib.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};
			this._params.push(one);
		};
		var nUniformNum=0;
		if (Render.isConchApp){
			nUniformNum=gl.getProgramParameterEx(this._vs,this._ps,"",0x8B86);
		}
		else{
			nUniformNum=gl.getProgramParameter(this._program,0x8B86);
		}
		for (i=0;i < nUniformNum;i++){
			var uniform=null;
			if (Render.isConchApp){
				uniform=gl.getActiveUniformEx(this._vs,this._ps,"",i);
			}
			else{
				uniform=gl.getActiveUniform(this._program,i);
			}
			location=gl.getUniformLocation(this._program,uniform.name);
			one={vartype:"uniform",glfun:null,ivartype:1,attrib:attrib,location:location,name:uniform.name,type:uniform.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};
			if (one.name.indexOf('[0]')> 0){
				one.name=one.name.substr(0,one.name.length-3);
				one.isArray=true;
				one.location=gl.getUniformLocation(this._program,one.name);
			}
			this._params.push(one);
		}
		for (i=0,n=this._params.length;i < n;i++){
			one=this._params[i];
			one.indexOfParams=i;
			one.index=1;
			one.value=[one.location,null];
			one.codename=one.name;
			one.name=this._nameMap[one.codename] ? this._nameMap[one.codename] :one.codename;
			this._paramsMap[one.name]=one;
			one._this=this;
			one.uploadedValue=[];
			if (one.vartype==="attribute"){
				one.fun=this._attribute;
				continue ;
			}
			switch (one.type){
				case 0x1404:
					one.fun=one.isArray ? this._uniform1iv :this._uniform1i;
					break ;
				case 0x1406:
					one.fun=one.isArray ? this._uniform1fv :this._uniform1f;
					break ;
				case 0x8B50:
					one.fun=one.isArray ? this._uniform_vec2v:this._uniform_vec2;
					break ;
				case 0x8B51:
					one.fun=one.isArray ? this._uniform_vec3v:this._uniform_vec3;
					break ;
				case 0x8B52:
					one.fun=one.isArray ? this._uniform_vec4v:this._uniform_vec4;
					break ;
				case 0x8B5E:
					one.fun=this._uniform_sampler2D;
					break ;
				case 0x8B60:
					one.fun=this._uniform_samplerCube;
					break ;
				case 0x8B5C:
					one.glfun=gl.uniformMatrix4fv;
					one.fun=this._uniformMatrix4fv;
					break ;
				case 0x8B56:
					one.fun=this._uniform1i;
					break ;
				case 0x8B5A:
				case 0x8B5B:
					throw new Error("compile shader err!");
					break ;
				default :
					throw new Error("compile shader err!");
					break ;
				}
		}
	}

	/**
	*根据变量名字获得
	*@param name
	*@return
	*/
	__proto.getUniform=function(name){
		return this._paramsMap[name];
	}

	__proto._attribute=function(one,value){
		var gl=WebGL.mainContext;
		var enableAtributes=Buffer._enableAtributes;
		var location=one.location;
		(enableAtributes[location])||(gl.enableVertexAttribArray(location));
		gl.vertexAttribPointer(location,value[0],value[1],value[2],value[3],value[4]+this._offset);
		enableAtributes[location]=Buffer._bindVertexBuffer;
		return 1;
	}

	__proto._uniform1f=function(one,value){
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]!==value){
			WebGL.mainContext.uniform1f(one.location,uploadedValue[0]=value);
			return 1;
		}
		return 0;
	}

	__proto._uniform1fv=function(one,value){
		if (value.length < 4){
			var uploadedValue=one.uploadedValue;
			if (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){
				WebGL.mainContext.uniform1fv(one.location,value);
				uploadedValue[0]=value[0];
				uploadedValue[1]=value[1];
				uploadedValue[2]=value[2];
				uploadedValue[3]=value[3];
				return 1;
			}
			return 0;
			}else {
			WebGL.mainContext.uniform1fv(one.location,value);
			return 1;
		}
	}

	__proto._uniform_vec2=function(one,value){
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1]){
			WebGL.mainContext.uniform2f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);
			return 1;
		}
		return 0;
	}

	__proto._uniform_vec2v=function(one,value){
		if (value.length < 2){
			var uploadedValue=one.uploadedValue;
			if (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){
				WebGL.mainContext.uniform2fv(one.location,value);
				uploadedValue[0]=value[0];
				uploadedValue[1]=value[1];
				uploadedValue[2]=value[2];
				uploadedValue[3]=value[3];
				return 1;
			}
			return 0;
			}else {
			WebGL.mainContext.uniform2fv(one.location,value);
			return 1;
		}
	}

	__proto._uniform_vec3=function(one,value){
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2]){
			WebGL.mainContext.uniform3f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);
			return 1;
		}
		return 0;
	}

	__proto._uniform_vec3v=function(one,value){
		WebGL.mainContext.uniform3fv(one.location,value);
		return 1;
	}

	__proto._uniform_vec4=function(one,value){
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){
			WebGL.mainContext.uniform4f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);
			return 1;
		}
		return 0;
	}

	__proto._uniform_vec4v=function(one,value){
		WebGL.mainContext.uniform4fv(one.location,value);
		return 1;
	}

	__proto._uniformMatrix2fv=function(one,value){
		WebGL.mainContext.uniformMatrix2fv(one.location,false,value);
		return 1;
	}

	__proto._uniformMatrix3fv=function(one,value){
		WebGL.mainContext.uniformMatrix3fv(one.location,false,value);
		return 1;
	}

	__proto._uniformMatrix4fv=function(one,value){
		WebGL.mainContext.uniformMatrix4fv(one.location,false,value);
		return 1;
	}

	__proto._uniform1i=function(one,value){
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]!==value){
			WebGL.mainContext.uniform1i(one.location,uploadedValue[0]=value);
			return 1;
		}
		return 0;
	}

	__proto._uniform1iv=function(one,value){
		WebGL.mainContext.uniform1iv(one.location,value);
		return 1;
	}

	__proto._uniform_ivec2=function(one,value){
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1]){
			WebGL.mainContext.uniform2i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);
			return 1;
		}
		return 0;
	}

	__proto._uniform_ivec2v=function(one,value){
		WebGL.mainContext.uniform2iv(one.location,value);
		return 1;
	}

	__proto._uniform_vec3i=function(one,value){
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2]){
			WebGL.mainContext.uniform3i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);
			return 1;
		}
		return 0;
	}

	__proto._uniform_vec3vi=function(one,value){
		WebGL.mainContext.uniform3iv(one.location,value);
		return 1;
	}

	__proto._uniform_vec4i=function(one,value){
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){
			WebGL.mainContext.uniform4i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);
			return 1;
		}
		return 0;
	}

	__proto._uniform_vec4vi=function(one,value){
		WebGL.mainContext.uniform4iv(one.location,value);
		return 1;
	}

	__proto._uniform_sampler2D=function(one,value){
		var gl=WebGL.mainContext;
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]==null){
			uploadedValue[0]=this._curActTexIndex;
			gl.uniform1i(one.location,this._curActTexIndex);
			gl.activeTexture(Shader._TEXTURES[this._curActTexIndex]);
			WebGLContext.bindTexture(gl,0x0DE1,value);
			this._curActTexIndex++;
			return 1;
			}else {
			gl.activeTexture(Shader._TEXTURES[uploadedValue[0]]);
			WebGLContext.bindTexture(gl,0x0DE1,value);
			return 0;
		}
	}

	__proto._uniform_samplerCube=function(one,value){
		var gl=WebGL.mainContext;
		var uploadedValue=one.uploadedValue;
		if (uploadedValue[0]==null){
			uploadedValue[0]=this._curActTexIndex;
			gl.uniform1i(one.location,this._curActTexIndex);
			gl.activeTexture(Shader._TEXTURES[this._curActTexIndex]);
			WebGLContext.bindTexture(gl,0x8513,value);
			this._curActTexIndex++;
			return 1;
			}else {
			gl.activeTexture(Shader._TEXTURES[uploadedValue[0]]);
			WebGLContext.bindTexture(gl,0x8513,value);
			return 0;
		}
	}

	__proto._noSetValue=function(one){
		console.log("no....:"+one.name);
	}

	//throw new Error("upload shader err,must set value:"+one.name);
	__proto.uploadOne=function(name,value){
		this.activeResource();
		WebGLContext.UseProgram(this._program);
		var one=this._paramsMap[name];
		one.fun.call(this,one,value);
	}

	__proto.uploadTexture2D=function(value){
		Stat.shaderCall++;
		var gl=WebGL.mainContext;
		gl.activeTexture(0x84C0);
		WebGLContext.bindTexture(gl,0x0DE1,value);
	}

	/**
	*提交shader到GPU
	*@param shaderValue
	*/
	__proto.upload=function(shaderValue,params){
		BaseShader.activeShader=BaseShader.bindShader=this;
		this._lastUseFrameCount===Stat.loopCount || this.activeResource();
		WebGLContext.UseProgram(this._program);
		if (this._reCompile){
			params=this._params;
			this._reCompile=false;
			}else {
			params=params || this._params;
		};
		var gl=WebGL.mainContext;
		var one,value,n=params.length,shaderCall=0;
		for (var i=0;i < n;i++){
			one=params[i];
			if ((value=shaderValue[one.name])!==null)
				shaderCall+=one.fun.call(this,one,value);
		}
		Stat.shaderCall+=shaderCall;
	}

	/**
	*按数组的定义提交
	*@param shaderValue 数组格式[name,value,...]
	*/
	__proto.uploadArray=function(shaderValue,length,_bufferUsage){
		BaseShader.activeShader=this;
		BaseShader.bindShader=this;
		this.activeResource();
		WebGLContext.UseProgram(this._program);
		var params=this._params,value;
		var one,shaderCall=0;
		for (var i=length-2;i >=0;i-=2){
			one=this._paramsMap[shaderValue[i]];
			if (!one)
				continue ;
			value=shaderValue[i+1];
			if (value !=null){
				_bufferUsage && _bufferUsage[one.name] && _bufferUsage[one.name].bind();
				shaderCall+=one.fun.call(this,one,value);
			}
		}
		Stat.shaderCall+=shaderCall;
	}

	/**
	*得到编译后的变量及相关预定义
	*@return
	*/
	__proto.getParams=function(){
		return this._params;
	}

	Shader.getShader=function(name){
		return Shader.sharders[name];
	}

	Shader.create=function(vs,ps,saveName,nameMap){
		return new Shader(vs,ps,saveName,nameMap);
	}

	Shader.withCompile=function(nameID,define,shaderName,createShader){
		if (shaderName && Shader.sharders[shaderName])
			return Shader.sharders[shaderName];
		var pre=Shader._preCompileShader[0.0002 *nameID];
		if (!pre)
			throw new Error("withCompile shader err!"+nameID);
		return pre.createShader(define,shaderName,createShader);
	}

	Shader.withCompile2D=function(nameID,mainID,define,shaderName,createShader){
		if (shaderName && Shader.sharders[shaderName])
			return Shader.sharders[shaderName];
		var pre=Shader._preCompileShader[0.0002 *nameID+mainID];
		if (!pre)
			throw new Error("withCompile shader err!"+nameID+" "+mainID);
		return pre.createShader(define,shaderName,createShader);
	}

	Shader.addInclude=function(fileName,txt){
		ShaderCompile.addInclude(fileName,txt);
	}

	Shader.preCompile=function(nameID,vs,ps,nameMap){
		var id=0.0002 *nameID;
		Shader._preCompileShader[id]=new ShaderCompile(id,vs,ps,nameMap);
	}

	Shader.preCompile2D=function(nameID,mainID,vs,ps,nameMap){
		var id=0.0002 *nameID+mainID;
		Shader._preCompileShader[id]=new ShaderCompile(id,vs,ps,nameMap);
	}

	Shader._createShader=function(gl,str,type){
		var shader=gl.createShader(type);
		gl.shaderSource(shader,str);
		gl.compileShader(shader);
		return shader;
	}

	Shader._TEXTURES=[0x84C0,0x84C1,0x84C2,0x84C3,0x84C4,0x84C5,0x84C6,,0x84C7,0x84C8];
	Shader._count=0;
	Shader._preCompileShader={};
	Shader.SHADERNAME2ID=0.0002;
	Shader.sharders=(Shader.sharders=[],Shader.sharders.length=0x20,Shader.sharders);
	__static(Shader,
	['nameKey',function(){return this.nameKey=new StringKey();}
	]);
	return Shader;
})(BaseShader)


//class laya.webgl.utils.Buffer2D extends laya.webgl.utils.Buffer
var Buffer2D=(function(_super){
	function Buffer2D(){
		this._maxsize=0;
		this._upload=true;
		this._uploadSize=0;
		Buffer2D.__super.call(this);
		this.lock=true;
	}

	__class(Buffer2D,'laya.webgl.utils.Buffer2D',_super);
	var __proto=Buffer2D.prototype;
	/**
	*在当前的基础上需要多大空间，单位是byte
	*@param sz
	*@return 增加大小之前的写位置。单位是byte
	*/
	__proto.needSize=function(sz){
		var old=this._byteLength;
		if (sz){
			var needsz=this._byteLength+sz;
			needsz <=this._buffer.byteLength || (this._resizeBuffer(needsz << 1,true));
			this._byteLength=needsz;
		}
		return old;
	}

	__proto._bufferData=function(){
		this._maxsize=Math.max(this._maxsize,this._byteLength);
		if (Stat.loopCount % 30==0){
			if (this._buffer.byteLength > (this._maxsize+64)){
				this.memorySize=this._buffer.byteLength;
				this._buffer=this._buffer.slice(0,this._maxsize+64);
				this._checkArrayUse();
			}
			this._maxsize=this._byteLength;
		}
		if (this._uploadSize < this._buffer.byteLength){
			this._uploadSize=this._buffer.byteLength;
			Buffer._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);
			this.memorySize=this._uploadSize;
		}
		Buffer._gl.bufferSubData(this._bufferType,0,this._buffer);
	}

	__proto._bufferSubData=function(offset,dataStart,dataLength){
		(offset===void 0)&& (offset=0);
		(dataStart===void 0)&& (dataStart=0);
		(dataLength===void 0)&& (dataLength=0);
		this._maxsize=Math.max(this._maxsize,this._byteLength);
		if (Stat.loopCount % 30==0){
			if (this._buffer.byteLength > (this._maxsize+64)){
				this.memorySize=this._buffer.byteLength;
				this._buffer=this._buffer.slice(0,this._maxsize+64);
				this._checkArrayUse();
			}
			this._maxsize=this._byteLength;
		}
		if (this._uploadSize < this._buffer.byteLength){
			this._uploadSize=this._buffer.byteLength;
			Buffer._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);
			this.memorySize=this._uploadSize;
		}
		if (dataStart || dataLength){
			var subBuffer=this._buffer.slice(dataStart,dataLength);
			Buffer._gl.bufferSubData(this._bufferType,offset,subBuffer);
			}else {
			Buffer._gl.bufferSubData(this._bufferType,offset,this._buffer);
		}
	}

	__proto._checkArrayUse=function(){}
	__proto._bind_upload=function(){
		if (!this._upload)
			return false;
		this._upload=false;
		this._bind();
		this._bufferData();
		return true;
	}

	__proto._bind_subUpload=function(offset,dataStart,dataLength){
		(offset===void 0)&& (offset=0);
		(dataStart===void 0)&& (dataStart=0);
		(dataLength===void 0)&& (dataLength=0);
		if (!this._upload)
			return false;
		this._upload=false;
		this._bind();
		this._bufferSubData(offset,dataStart,dataLength);
		return true;
	}

	__proto._resizeBuffer=function(nsz,copy){
		if (nsz < this._buffer.byteLength)
			return this;
		this.memorySize=nsz;
		if (copy && this._buffer && this._buffer.byteLength > 0){
			var newbuffer=new ArrayBuffer(nsz);
			var n=new Uint8Array(newbuffer);
			n.set(new Uint8Array(this._buffer),0);
			this._buffer=newbuffer;
		}else
		this._buffer=new ArrayBuffer(nsz);
		this._checkArrayUse();
		this._upload=true;
		return this;
	}

	__proto.append=function(data){
		this._upload=true;
		var byteLen=0,n;
		byteLen=data.byteLength;
		if ((data instanceof Uint8Array)){
			this._resizeBuffer(this._byteLength+byteLen,true);
			n=new Uint8Array(this._buffer,this._byteLength);
			}else if ((data instanceof Uint16Array)){
			this._resizeBuffer(this._byteLength+byteLen,true);
			n=new Uint16Array(this._buffer,this._byteLength);
			}else if ((data instanceof Float32Array)){
			this._resizeBuffer(this._byteLength+byteLen,true);
			n=new Float32Array(this._buffer,this._byteLength);
		}
		n.set(data,0);
		this._byteLength+=byteLen;
		this._checkArrayUse();
	}

	/**
	*附加Uint16Array的数据。数据长度是len。byte的话要*2
	*@param data
	*@param len
	*/
	__proto.appendU16Array=function(data,len){
		this._resizeBuffer(this._byteLength+len*2,true);
		var u=new Uint16Array(this._buffer,this._byteLength,len);
		for (var i=0;i < len;i++){
			u[i]=data[i];
		}
		this._byteLength+=len *2;
		this._checkArrayUse();
	}

	__proto.appendEx=function(data,type){
		this._upload=true;
		var byteLen=0,n;
		byteLen=data.byteLength;
		this._resizeBuffer(this._byteLength+byteLen,true);
		n=new type(this._buffer,this._byteLength);
		n.set(data,0);
		this._byteLength+=byteLen;
		this._checkArrayUse();
	}

	__proto.appendEx2=function(data,type,dataLen,perDataLen){
		(perDataLen===void 0)&& (perDataLen=1);
		this._upload=true;
		var byteLen=0,n;
		byteLen=dataLen*perDataLen;
		this._resizeBuffer(this._byteLength+byteLen,true);
		n=new type(this._buffer,this._byteLength);
		var i=0;
		for (i=0;i < dataLen;i++){
			n[i]=data[i];
		}
		this._byteLength+=byteLen;
		this._checkArrayUse();
	}

	__proto.getBuffer=function(){
		return this._buffer;
	}

	__proto.setNeedUpload=function(){
		this._upload=true;
	}

	__proto.getNeedUpload=function(){
		return this._upload;
	}

	__proto.upload=function(){
		var scuess=this._bind_upload();
		Buffer._gl.bindBuffer(this._bufferType,null);
		Buffer._bindActive[this._bufferType]=null;
		BaseShader.activeShader=null
		return scuess;
	}

	__proto.subUpload=function(offset,dataStart,dataLength){
		(offset===void 0)&& (offset=0);
		(dataStart===void 0)&& (dataStart=0);
		(dataLength===void 0)&& (dataLength=0);
		var scuess=this._bind_subUpload();
		Buffer._gl.bindBuffer(this._bufferType,null);
		Buffer._bindActive[this._bufferType]=null;
		BaseShader.activeShader=null
		return scuess;
	}

	__proto.disposeResource=function(){
		_super.prototype.disposeResource.call(this);
		this._upload=true;
		this._uploadSize=0;
	}

	__proto.clear=function(){
		this._byteLength=0;
		this._upload=true;
	}

	__getset(0,__proto,'bufferLength',function(){
		return this._buffer.byteLength;
	});

	__getset(0,__proto,'byteLength',null,function(value){
		if (this._byteLength===value)
			return;
		value <=this._buffer.byteLength || (this._resizeBuffer(value *2+256,true));
		this._byteLength=value;
	});

	Buffer2D.__int__=function(gl){
		IndexBuffer2D.QuadrangleIB=IndexBuffer2D.create(0x88E4);
		GlUtils.fillIBQuadrangle(IndexBuffer2D.QuadrangleIB,16);
	}

	Buffer2D.FLOAT32=4;
	Buffer2D.SHORT=2;
	return Buffer2D;
})(Buffer)


/**
*@private
*<code>FileBitmap</code> 是图片文件资源类。
*/
//class laya.resource.FileBitmap extends laya.resource.Bitmap
var FileBitmap=(function(_super){
	function FileBitmap(){
		/**@private 文件路径全名。*/
		this._src=null;
		/**@private onload触发函数*/
		this._onload=null;
		/**@private onerror触发函数*/
		this._onerror=null;
		FileBitmap.__super.call(this);
	}

	__class(FileBitmap,'laya.resource.FileBitmap',_super);
	var __proto=FileBitmap.prototype;
	/**
	*文件路径全名。
	*/
	__getset(0,__proto,'src',function(){
		return this._src;
		},function(value){
		this._src=value;
	});

	/**
	*载入完成处理函数。
	*/
	__getset(0,__proto,'onload',null,function(value){
	});

	/**
	*错误处理函数。
	*/
	__getset(0,__proto,'onerror',null,function(value){
	});

	return FileBitmap;
})(Bitmap)


/**
*<code>HTMLCanvas</code> 是 Html Canvas 的代理类，封装了 Canvas 的属性和方法。。请不要直接使用 new HTMLCanvas！
*/
//class laya.resource.HTMLCanvas extends laya.resource.Bitmap
var HTMLCanvas=(function(_super){
	function HTMLCanvas(type,canvas){
		//this._ctx=null;
		this._is2D=false;
		HTMLCanvas.__super.call(this);
		var _$this=this;
		this._source=this;
		if (type==="2D" || (type==="AUTO" && !Render.isWebGL)){
			this._is2D=true;
			this._source=canvas || Browser.createElement("canvas");
			this._w=this._source.width;
			this._h=this._source.height;
			var o=this;
			o.getContext=function (contextID,other){
				if (_$this._ctx)return _$this._ctx;
				var ctx=_$this._ctx=_$this._source.getContext(contextID,other);
				if (ctx){
					ctx._canvas=o;
					if(!Render.isFlash&&!Browser.onLimixiu)ctx.size=function (w,h){
					};
				}
				return ctx;
			}
		}
		this.lock=true;
	}

	__class(HTMLCanvas,'laya.resource.HTMLCanvas',_super);
	var __proto=HTMLCanvas.prototype;
	/**
	*清空画布内容。
	*/
	__proto.clear=function(){
		this._ctx && this._ctx.clear();
	}

	/**
	*销毁。
	*/
	__proto.destroy=function(){
		this._ctx && this._ctx.destroy();
		this._ctx=null;
		laya.resource.Resource.prototype.destroy.call(this);
	}

	/**
	*释放。
	*/
	__proto.release=function(){}
	/**
	*@private
	*设置 Canvas 渲染上下文。
	*@param context Canvas 渲染上下文。
	*/
	__proto._setContext=function(context){
		this._ctx=context;
	}

	/**
	*获取 Canvas 渲染上下文。
	*@param contextID 上下文ID.
	*@param other
	*@return Canvas 渲染上下文 Context 对象。
	*/
	__proto.getContext=function(contextID,other){
		return this._ctx ? this._ctx :(this._ctx=HTMLCanvas._createContext(this));
	}

	/**
	*获取内存大小。
	*@return 内存大小。
	*/
	__proto.getMemSize=function(){
		return 0;
	}

	/**
	*设置宽高。
	*@param w 宽度。
	*@param h 高度。
	*/
	__proto.size=function(w,h){
		if (this._w !=w || this._h !=h ||(this._source && (this._source.width!=w || this._source.height!=h))){
			this._w=w;
			this._h=h;
			this.memorySize=this._w *this._h *4;
			this._ctx && this._ctx.size(w,h);
			this._source && (this._source.height=h,this._source.width=w);
		}
	}

	__proto.getCanvas=function(){
		return this._source;
	}

	__proto.toBase64=function(type,encoderOptions,callBack){
		if (this._source){
			if (Render.isConchApp && this._source.toBase64){
				this._source.toBase64(type,encoderOptions,callBack);
			}
			else {
				var base64Data=this._source.toDataURL(type,encoderOptions);
				callBack.call(this,base64Data);
			}
		}
	}

	/**
	*Canvas 渲染上下文。
	*/
	__getset(0,__proto,'context',function(){
		return this._ctx;
	});

	/**
	*是否当作 Bitmap 对象。
	*/
	__getset(0,__proto,'asBitmap',null,function(value){
	});

	HTMLCanvas.create=function(type,canvas){
		return new HTMLCanvas(type,canvas);
	}

	HTMLCanvas.TYPE2D="2D";
	HTMLCanvas.TYPE3D="3D";
	HTMLCanvas.TYPEAUTO="AUTO";
	HTMLCanvas._createContext=null;
	return HTMLCanvas;
})(Bitmap)


/**
*@private
*/
//class laya.resource.HTMLSubImage extends laya.resource.Bitmap
var HTMLSubImage=(function(_super){
	//请不要直接使用new HTMLSubImage
	function HTMLSubImage(canvas,offsetX,offsetY,width,height,atlasImage,src,allowMerageInAtlas){
		HTMLSubImage.__super.call(this);
		throw new Error("不允许new！");
	}

	__class(HTMLSubImage,'laya.resource.HTMLSubImage',_super);
	HTMLSubImage.create=function(canvas,offsetX,offsetY,width,height,atlasImage,src,allowMerageInAtlas){
		(allowMerageInAtlas===void 0)&& (allowMerageInAtlas=false);
		return new HTMLSubImage(canvas,offsetX,offsetY,width,height,atlasImage,src,allowMerageInAtlas);
	}

	return HTMLSubImage;
})(Bitmap)


//class laya.webgl.atlas.AtlasWebGLCanvas extends laya.resource.Bitmap
var AtlasWebGLCanvas=(function(_super){
	function AtlasWebGLCanvas(){
		this._atlaser=null;
		/**兼容Stage3D使用*/
		this._flashCacheImage=null;
		this._flashCacheImageNeedFlush=false;
		AtlasWebGLCanvas.__super.call(this);
	}

	__class(AtlasWebGLCanvas,'laya.webgl.atlas.AtlasWebGLCanvas',_super);
	var __proto=AtlasWebGLCanvas.prototype;
	/***重新创建资源*/
	__proto.recreateResource=function(){
		var gl=WebGL.mainContext;
		var glTex=this._source=gl.createTexture();
		var preTarget=WebGLContext.curBindTexTarget;
		var preTexture=WebGLContext.curBindTexValue;
		WebGLContext.bindTexture(gl,0x0DE1,glTex);
		gl.texImage2D(0x0DE1,0,0x1908,this._w,this._h,0,0x1908,0x1401,null);
		gl.texParameteri(0x0DE1,0x2801,0x2601);
		gl.texParameteri(0x0DE1,0x2800,0x2601);
		gl.texParameteri(0x0DE1,0x2802,0x812F);
		gl.texParameteri(0x0DE1,0x2803,0x812F);
		(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
		this.memorySize=this._w *this._h *4;
		this.completeCreate();
	}

	/***销毁资源*/
	__proto.disposeResource=function(){
		if (this._source){
			WebGL.mainContext.deleteTexture(this._source);
			this._source=null;
			this.memorySize=0;
		}
	}

	/**采样image到WebGLTexture的一部分*/
	__proto.texSubImage2D=function(xoffset,yoffset,bitmap){
		if (!Render.isFlash){
			var gl=WebGL.mainContext;
			var preTarget=WebGLContext.curBindTexTarget;
			var preTexture=WebGLContext.curBindTexValue;
			WebGLContext.bindTexture(gl,0x0DE1,this._source);
			if (Render.isConchWebGL){
				(xoffset-1 >=0)&& (gl.texSubImage2DEx(true,0x0DE1,0,xoffset-1,yoffset,0x1908,0x1401,bitmap));
				(xoffset+1 <=this._w)&& (gl.texSubImage2DEx(true,0x0DE1,0,xoffset+1,yoffset,0x1908,0x1401,bitmap));
				(yoffset-1 >=0)&& (gl.texSubImage2DEx(true,0x0DE1,0,xoffset,yoffset-1,0x1908,0x1401,bitmap));
				(yoffset+1 <=this._h)&& (gl.texSubImage2DEx(true,0x0DE1,0,xoffset,yoffset+1,0x1908,0x1401,bitmap));
				gl.texSubImage2DEx(true,0x0DE1,0,xoffset,yoffset,0x1908,0x1401,bitmap);
			}
			else {
				gl.pixelStorei(0x9241,true);
				(xoffset-1 >=0)&& (gl.texSubImage2D(0x0DE1,0,xoffset-1,yoffset,0x1908,0x1401,bitmap));
				(xoffset+1 <=this._w)&& (gl.texSubImage2D(0x0DE1,0,xoffset+1,yoffset,0x1908,0x1401,bitmap));
				(yoffset-1 >=0)&& (gl.texSubImage2D(0x0DE1,0,xoffset,yoffset-1,0x1908,0x1401,bitmap));
				(yoffset+1 <=this._h)&& (gl.texSubImage2D(0x0DE1,0,xoffset,yoffset+1,0x1908,0x1401,bitmap));
				gl.texSubImage2D(0x0DE1,0,xoffset,yoffset,0x1908,0x1401,bitmap);
				gl.pixelStorei(0x9241,false);
			}
			(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
			}else {
			if (!this._flashCacheImage){
				this._flashCacheImage=HTMLImage.create("");
				this._flashCacheImage._image.createCanvas(this._w,this._h);
			};
			var bmData=bitmap.bitmapdata;
			this._flashCacheImage._image.copyPixels(bmData,0,0,bmData.width,bmData.height,xoffset,yoffset);
			(this._flashCacheImageNeedFlush)|| (this._flashCacheImageNeedFlush=true);
		}
	}

	/**采样image到WebGLTexture的一部分*/
	__proto.texSubImage2DPixel=function(xoffset,yoffset,width,height,pixel){
		var gl=WebGL.mainContext;
		var preTarget=WebGLContext.curBindTexTarget;
		var preTexture=WebGLContext.curBindTexValue;
		WebGLContext.bindTexture(gl,0x0DE1,this._source);
		var pixels=new Uint8Array(pixel.data);
		if (Render.isConchWebGL){
			gl.texSubImage2DEx(true,0x0DE1,0,xoffset,yoffset,width,height,0x1908,0x1401,pixels);
		}
		else {
			gl.pixelStorei(0x9241,true);
			gl.texSubImage2D(0x0DE1,0,xoffset,yoffset,width,height,0x1908,0x1401,pixels);
			gl.pixelStorei(0x9241,false);
		}
		(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
	}

	/***
	*设置图片宽度
	*@param value 图片宽度
	*/
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		this._w=value;
	});

	/***
	*设置图片高度
	*@param value 图片高度
	*/
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		this._h=value;
	});

	return AtlasWebGLCanvas;
})(Bitmap)


/**@private */
//class laya.webgl.resource.WebGLCanvas extends laya.resource.Bitmap
var WebGLCanvas=(function(_super){
	function WebGLCanvas(){
		this.flipY=true;
		//上传的时候是否上下颠倒
		this.premulAlpha=false;
		//上传的时候是否预乘alpha
		//this._ctx=null;
		/**HTML Canvas*/
		//this._canvas=null;
		//this._imgData=null;
		//}
		//this.iscpuSource=false;
		this.alwaysChange=false;
		WebGLCanvas.__super.call(this);
	}

	__class(WebGLCanvas,'laya.webgl.resource.WebGLCanvas',_super);
	var __proto=WebGLCanvas.prototype;
	//}
	__proto.getCanvas=function(){
		return this._canvas;
	}

	__proto.clear=function(){
		this._ctx && this._ctx.clear();
	}

	__proto.destroy=function(){
		this._ctx && this._ctx.destroy();
		this._ctx=null;
	}

	__proto._setContext=function(context){
		this._ctx=context;
	}

	__proto.getContext=function(contextID,other){
		return this._ctx ? this._ctx :(this._ctx=WebGLCanvas._createContext(this));
	}

	/*override public function copyTo(dec:Bitmap):void {
	super.copyTo(dec);
	(dec as WebGLCanvas)._ctx=_ctx;
}*/


__proto.size=function(w,h){
	if (this._w !=w || this._h !=h){
		this._w=w;
		this._h=h;
		this._ctx && this._ctx.size(w,h);
		this._canvas && (this._canvas.height=h,this._canvas.width=w);
	}

}


__proto.activeResource=function(force){
	(force===void 0)&& (force=false);
	if (!this._source){
		this.recreateResource();
	}

}


__proto.recreateResource=function(){
	this.createWebGlTexture();
	this.completeCreate();
}


__proto.disposeResource=function(){
	if (this._source && !this.iscpuSource){
		WebGL.mainContext.deleteTexture(this._source);
		this._source=null;
		this.memorySize=0;
	}

}


__proto.createWebGlTexture=function(){
	var gl=WebGL.mainContext;
	if (!this._canvas){
	};

	var glTex=this._source=gl.createTexture();
	this.iscpuSource=false;
	var preTarget=WebGLContext.curBindTexTarget;
	var preTexture=WebGLContext.curBindTexValue;
	WebGLContext.bindTexture(gl,0x0DE1,glTex);
	gl.pixelStorei(0x9240,this.flipY?1:0);
	if (Render.isConchWebGL){
		gl.texImage2DEx(this.premulAlpha,0x0DE1,0,0x1908,0x1908,0x1401,this._imgData);
	}

	else {
		this.premulAlpha&&gl.pixelStorei(0x9241,true);
		gl.texImage2D(0x0DE1,0,0x1908,0x1908,0x1401,this._imgData);
		this.premulAlpha && gl.pixelStorei(0x9241,false);
	}

	gl.texParameteri(0x0DE1,0x2800,0x2601);
	gl.texParameteri(0x0DE1,0x2801,0x2601);
	gl.texParameteri(0x0DE1,0x2802,0x812F);
	gl.texParameteri(0x0DE1,0x2803,0x812F);
	gl.pixelStorei(0x9240,0);
	this.memorySize=this._w *this._h *4;
	(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
}


//_canvas=null;
__proto.reloadCanvasData=function(){
	var gl=WebGL.mainContext;
	if (!this._source){
		throw "reloadCanvasData error, gl texture not created!";
	};

	var preTarget=WebGLContext.curBindTexTarget;
	var preTexture=WebGLContext.curBindTexValue;
	WebGLContext.bindTexture(gl,0x0DE1,this._source);
	if (Render.isConchWebGL){
		gl.texImage2DEx(this.premulAlpha,0x0DE1,0,0x1908,0x1908,0x1401,this._imgData);
	}

	else {
		this.premulAlpha&&gl.pixelStorei(0x9241,true);
		gl.texImage2D(0x0DE1,0,0x1908,0x1908,0x1401,this._imgData);
		this.premulAlpha && gl.pixelStorei(0x9241,false);
	}

	gl.pixelStorei(0x9240,0);
	(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
}


//_canvas=null;
__proto.texSubImage2D=function(webglCanvas,xoffset,yoffset){
	var gl=WebGL.mainContext;
	var preTarget=WebGLContext.curBindTexTarget;
	var preTexture=WebGLContext.curBindTexValue;
	WebGLContext.bindTexture(gl,0x0DE1,this._source);
	if (Render.isConchWebGL){
		gl.texSubImage2DEx(true,0x0DE1,0,xoffset,yoffset,0x1908,0x1401,webglCanvas._source);
	}

	else {
		gl.pixelStorei(0x9241,true);
		gl.texSubImage2D(0x0DE1,0,xoffset,yoffset,0x1908,0x1401,webglCanvas._source);
		gl.pixelStorei(0x9241,false);
	}

	(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
}


__proto.toBase64=function(type,encoderOptions,callBack){
	var base64Data=null;
	if (this._canvas){
		base64Data=this._canvas.toDataURL(type,encoderOptions);
	}

	callBack.call(this,base64Data);
}


__getset(0,__proto,'context',function(){
	return this._ctx;
});


__getset(0,__proto,'source',function(){
	if (this.alwaysChange)this.reloadCanvasData();
	return this._source;
});


__getset(0,__proto,'asBitmap',null,function(value){
	this._ctx && (this._ctx.asBitmap=value);
});


WebGLCanvas._createContext=null;
return WebGLCanvas;
})(Bitmap)


//class laya.webgl.resource.WebGLCharImage extends laya.resource.Bitmap
var WebGLCharImage=(function(_super){
	function WebGLCharImage(content,drawValue){
		this.CborderSize=12;
		//this._ctx=null;
		/***是否创建私有Source*/
		//this._allowMerageInAtlas=false;
		/**是否允许加入大图合集*/
		//this._enableMerageInAtlas=false;
		/**HTML Canvas，绘制字符载体,非私有数据载体*/
		//this.canvas=null;
		/**********************************************************************************/
		//this.cw=NaN;
		//this.ch=NaN;
		//this.xs=NaN;
		//this.ys=NaN;
		//this.char=null;
		//this.fillColor=null;
		//this.borderColor=null;
		//this.borderSize=0;
		//this.font=null;
		//this.fontSize=0;
		//this.texture=null;
		//this.lineWidth=0;
		//this.UV=null;
		//this.isSpace=false;
		//this.underLine=0;
		WebGLCharImage.__super.call(this);
		this.char=content;
		this.isSpace=content===' ';
		this.xs=drawValue.scaleX;
		this.ys=drawValue.scaleY;
		this.font=drawValue.font.toString();
		this.fontSize=drawValue.font.size;
		this.fillColor=drawValue.fillColor;
		this.borderColor=drawValue.borderColor;
		this.lineWidth=drawValue.lineWidth;
		this.underLine=drawValue.underLine;
		var bIsConchApp=Render.isConchApp;
		var pCanvas;
		if (bIsConchApp){
			pCanvas=ConchTextCanvas;
			pCanvas._source=ConchTextCanvas;
			pCanvas._source.canvas=ConchTextCanvas;
			}else {
			pCanvas=Browser.canvas.source;
		}
		this.canvas=pCanvas;
		this._enableMerageInAtlas=true;
		if (bIsConchApp){
			this._ctx=pCanvas;
			}else {
			this._ctx=this.canvas.getContext('2d',undefined);
		};
		var t=Utils.measureText(this.char,this.font);
		this.cw=t.width *this.xs;
		this.ch=(t.height || this.fontSize)*this.ys;
		this.onresize(this.cw+this.CborderSize *2,this.ch+this.CborderSize *2);
		this.texture=new Texture(this);
	}

	__class(WebGLCharImage,'laya.webgl.resource.WebGLCharImage',_super);
	var __proto=WebGLCharImage.prototype;
	Laya.imps(__proto,{"laya.webgl.resource.IMergeAtlasBitmap":true})
	__proto.active=function(){
		this.texture.active();
	}

	__proto.recreateResource=function(){
		var bIsConchApp=Render.isConchApp;
		this.onresize(this.cw+this.CborderSize *2,this.ch+this.CborderSize *2);
		this.canvas && (this.canvas.height=this._h,this.canvas.width=this._w);
		if (bIsConchApp){
			var nFontSize=this.fontSize;
			if (this.xs !=1 || this.ys !=1){
				nFontSize=parseInt(nFontSize *((this.xs > this.ys)? this.xs :this.ys)+"");
			};
			var sFont="normal 100 "+nFontSize+"px Arial";
			if (this.borderColor){
				sFont+=" 1 "+this.borderColor;
			}
			this._ctx.font=sFont;
			this._ctx.textBaseline="top";
			this._ctx.fillStyle=this.fillColor;
			this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null);
			}else {
			this._ctx.save();
			(this._ctx).clearRect(0,0,this.cw+this.CborderSize *2,this.ch+this.CborderSize *2);
			this._ctx.font=this.font;
			if (Text.RightToLeft){
				this._ctx.textAlign="end";
			}
			this._ctx.textBaseline="top";
			this._ctx.translate(this.CborderSize,this.CborderSize);
			if (this.xs !=1 || this.ys !=1){
				this._ctx.scale(this.xs,this.ys);
			}
			if (this.fillColor && this.borderColor){
				this._ctx.strokeStyle=this.borderColor;
				this._ctx.lineWidth=this.lineWidth;
				this._ctx.strokeText(this.char,0,0,null,null,0,null);
				this._ctx.fillStyle=this.fillColor;
				this._ctx.fillText(this.char,0,0,null,null,null);
				}else {
				if (this.lineWidth===-1){
					this._ctx.fillStyle=this.fillColor ? this.fillColor :"white";
					this._ctx.fillText(this.char,0,0,null,null,null);
					}else {
					this._ctx.strokeStyle=this.borderColor?this.borderColor:'white';
					this._ctx.lineWidth=this.lineWidth;
					this._ctx.strokeText(this.char,0,0,null,null,0,null);
				}
			}
			if (this.underLine){
				this._ctx.lineWidth=1;
				this._ctx.strokeStyle=this.fillColor;
				this._ctx.beginPath();
				this._ctx.moveTo(0,this.fontSize+1);
				var nW=this._ctx.measureText(this.char).width+1;
				this._ctx.lineTo(nW,this.fontSize+1);
				this._ctx.stroke();
			}
			this._ctx.restore();
		}
		this.borderSize=this.CborderSize;
		this.completeCreate();
	}

	__proto.onresize=function(w,h){
		this._w=w;
		this._h=h;
		this._allowMerageInAtlas=true;
	}

	__proto.clearAtlasSource=function(){}
	/**
	*是否创建私有Source
	*@return 是否创建
	*/
	__getset(0,__proto,'allowMerageInAtlas',function(){
		return this._allowMerageInAtlas;
	});

	__getset(0,__proto,'atlasSource',function(){
		return this.canvas;
	});

	/**
	*是否创建私有Source,通常禁止修改
	*@param value 是否创建
	*/
	/**
	*是否创建私有Source
	*@return 是否创建
	*/
	__getset(0,__proto,'enableMerageInAtlas',function(){
		return this._enableMerageInAtlas;
		},function(value){
		this._enableMerageInAtlas=value;
	});

	WebGLCharImage.createOneChar=function(content,drawValue){
		var char=new WebGLCharImage(content,drawValue);
		return char;
	}

	return WebGLCharImage;
})(Bitmap)


//class laya.webgl.resource.WebGLRenderTarget extends laya.resource.Bitmap
var WebGLRenderTarget=(function(_super){
	function WebGLRenderTarget(width,height,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){
		//this._frameBuffer=null;
		//this._depthStencilBuffer=null;
		//this._surfaceFormat=0;
		//this._surfaceType=0;
		//this._depthStencilFormat=0;
		//this._mipMap=false;
		//this._repeat=false;
		//this._minFifter=0;
		//this._magFifter=0;
		(surfaceFormat===void 0)&& (surfaceFormat=0x1908);
		(surfaceType===void 0)&& (surfaceType=0x1401);
		(depthStencilFormat===void 0)&& (depthStencilFormat=0x84F9);
		(mipMap===void 0)&& (mipMap=false);
		(repeat===void 0)&& (repeat=false);
		(minFifter===void 0)&& (minFifter=-1);
		(magFifter===void 0)&& (magFifter=1);
		WebGLRenderTarget.__super.call(this);
		this._w=width;
		this._h=height;
		this._surfaceFormat=surfaceFormat;
		this._surfaceType=surfaceType;
		this._depthStencilFormat=depthStencilFormat;
		if (Render.isConchWebGL && this._depthStencilFormat===0x84F9){
			this._depthStencilFormat=0x81A5;
		}
		this._mipMap=mipMap;
		this._repeat=repeat;
		this._minFifter=minFifter;
		this._magFifter=magFifter;
	}

	__class(WebGLRenderTarget,'laya.webgl.resource.WebGLRenderTarget',_super);
	var __proto=WebGLRenderTarget.prototype;
	__proto.recreateResource=function(){
		var gl=WebGL.mainContext;
		this._frameBuffer || (this._frameBuffer=gl.createFramebuffer());
		this._source || (this._source=gl.createTexture());
		var preTarget=WebGLContext.curBindTexTarget;
		var preTexture=WebGLContext.curBindTexValue;
		WebGLContext.bindTexture(gl,0x0DE1,this._source);
		gl.texImage2D(0x0DE1,0,0x1908,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);
		var minFifter=this._minFifter;
		var magFifter=this._magFifter;
		var repeat=this._repeat ? 0x2901 :0x812F;
		var isPot=Arith.isPOT(this._w,this._h);
		if (isPot){
			if (this._mipMap)
				(minFifter!==-1)|| (minFifter=0x2703);
			else
			(minFifter!==-1)|| (minFifter=0x2601);
			(magFifter!==-1)|| (magFifter=0x2601);
			gl.texParameteri(0x0DE1,0x2801,minFifter);
			gl.texParameteri(0x0DE1,0x2800,magFifter);
			gl.texParameteri(0x0DE1,0x2802,repeat);
			gl.texParameteri(0x0DE1,0x2803,repeat);
			this._mipMap && gl.generateMipmap(0x0DE1);
			}else {
			(minFifter!==-1)|| (minFifter=0x2601);
			(magFifter!==-1)|| (magFifter=0x2601);
			gl.texParameteri(0x0DE1,0x2801,minFifter);
			gl.texParameteri(0x0DE1,0x2800,magFifter);
			gl.texParameteri(0x0DE1,0x2802,0x812F);
			gl.texParameteri(0x0DE1,0x2803,0x812F);
		}
		gl.bindFramebuffer(0x8D40,this._frameBuffer);
		gl.framebufferTexture2D(0x8D40,0x8CE0,0x0DE1,this._source,0);
		if (this._depthStencilFormat){
			this._depthStencilBuffer || (this._depthStencilBuffer=gl.createRenderbuffer());
			gl.bindRenderbuffer(0x8D41,this._depthStencilBuffer);
			gl.renderbufferStorage(0x8D41,this._depthStencilFormat,this._w,this._h);
			switch (this._depthStencilFormat){
				case 0x81A5:
					gl.framebufferRenderbuffer(0x8D40,0x8D00,0x8D41,this._depthStencilBuffer);
					break ;
				case 0x8D48:
					gl.framebufferRenderbuffer(0x8D40,0x8D20,0x8D41,this._depthStencilBuffer);
					break ;
				case 0x84F9:
					gl.framebufferRenderbuffer(0x8D40,0x821A,0x8D41,this._depthStencilBuffer);
					break ;
				}
		}
		gl.bindFramebuffer(0x8D40,null);
		(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
		gl.bindRenderbuffer(0x8D41,null);
		if (isPot && this._mipMap)
			this.memorySize=this._w *this._h *4 *(1+1 / 3);
		else
		this.memorySize=this._w *this._h *4;
		this.completeCreate();
	}

	__proto.disposeResource=function(){
		if (this._frameBuffer){
			WebGL.mainContext.deleteTexture(this._source);
			WebGL.mainContext.deleteFramebuffer(this._frameBuffer);
			WebGL.mainContext.deleteRenderbuffer(this._depthStencilBuffer);
			this._source=null;
			this._frameBuffer=null;
			this._depthStencilBuffer=null;
			this.memorySize=0;
		}
	}

	__getset(0,__proto,'depthStencilBuffer',function(){
		return this._depthStencilBuffer;
	});

	__getset(0,__proto,'frameBuffer',function(){
		return this._frameBuffer;
	});

	return WebGLRenderTarget;
})(Bitmap)


//class laya.webgl.resource.WebGLSubImage extends laya.resource.Bitmap
var WebGLSubImage=(function(_super){
	function WebGLSubImage(canvas,offsetX,offsetY,width,height,atlasImage,src){
		/**HTML Context*/
		//this._ctx=null;
		/***是否创建私有Source,值为false时不根据src创建私有WebGLTexture,同时销毁时也只清空source=null,不调用WebGL.mainContext.deleteTexture类似函数，调用资源激活前有效*/
		//this._allowMerageInAtlas=false;
		/**是否允许加入大图合集*/
		//this._enableMerageInAtlas=false;
		/**HTML Canvas，绘制子图载体,非私有数据载体*/
		//this.canvas=null;
		/**是否使用重复模式纹理寻址*/
		//this.repeat=false;
		/**是否使用mipLevel*/
		//this.mipmap=false;
		/**缩小过滤器*/
		//this.minFifter=0;
		/**放大过滤器*/
		//this.magFifter=0;
		//动态默认值，判断是否可生成miplevel
		//this.atlasImage=null;
		this.offsetX=0;
		this.offsetY=0;
		//this.src=null;
		WebGLSubImage.__super.call(this);
		this.repeat=true;
		this.mipmap=false;
		this.minFifter=-1;
		this.magFifter=-1;
		this.atlasImage=atlasImage;
		this.canvas=canvas;
		this._ctx=canvas.getContext('2d',undefined);
		this._w=width;
		this._h=height;
		this.offsetX=offsetX;
		this.offsetY=offsetY;
		this.src=src;
		this._enableMerageInAtlas=true;
		(AtlasResourceManager.enabled)&& (this._w < AtlasResourceManager.atlasLimitWidth && this._h < AtlasResourceManager.atlasLimitHeight)? this._allowMerageInAtlas=true :this._allowMerageInAtlas=false;
	}

	__class(WebGLSubImage,'laya.webgl.resource.WebGLSubImage',_super);
	var __proto=WebGLSubImage.prototype;
	Laya.imps(__proto,{"laya.webgl.resource.IMergeAtlasBitmap":true})
	/*override public function copyTo(dec:Bitmap):void {
	var d:WebGLSubImage=dec as WebGLSubImage;
	super.copyTo(dec);
	d._ctx=_ctx;
}*/


__proto.size=function(w,h){
	this._w=w;
	this._h=h;
	this._ctx && this._ctx.size(w,h);
	this.canvas && (this.canvas.height=h,this.canvas.width=w);
}


__proto.recreateResource=function(){
	this.size(this._w,this._h);
	this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h);
	(!(this._allowMerageInAtlas && this._enableMerageInAtlas))? (this.createWebGlTexture()):(this.memorySize=0);
	this.completeCreate();
}


__proto.createWebGlTexture=function(){
	var gl=WebGL.mainContext;
	if (!this.canvas){
		throw "create GLTextur err:no data:"+this.canvas;
	};

	var glTex=this._source=gl.createTexture();
	var preTarget=WebGLContext.curBindTexTarget;
	var preTexture=WebGLContext.curBindTexValue;
	WebGLContext.bindTexture(gl,0x0DE1,glTex);
	if (Render.isConchWebGL){
		gl.texImage2DEx(true,0x0DE1,0,0x1908,0x1908,0x1401,this.canvas);
	}

	else {
		gl.pixelStorei(0x9241,true);
		gl.texImage2D(0x0DE1,0,0x1908,0x1908,0x1401,this.canvas);
		gl.pixelStorei(0x9241,false);
	};

	var minFifter=this.minFifter;
	var magFifter=this.magFifter;
	var repeat=this.repeat ? 0x2901 :0x812F;
	var isPOT=Arith.isPOT(this.width,this.height);
	if (isPOT){
		if (this.mipmap)
			(minFifter!==-1)|| (minFifter=0x2703);
		else
		(minFifter!==-1)|| (minFifter=0x2601);
		(magFifter!==-1)|| (magFifter=0x2601);
		gl.texParameteri(0x0DE1,0x2800,magFifter);
		gl.texParameteri(0x0DE1,0x2801,minFifter);
		gl.texParameteri(0x0DE1,0x2802,repeat);
		gl.texParameteri(0x0DE1,0x2803,repeat);
		this.mipmap && gl.generateMipmap(0x0DE1);
		}else {
		(minFifter!==-1)|| (minFifter=0x2601);
		(magFifter!==-1)|| (magFifter=0x2601);
		gl.texParameteri(0x0DE1,0x2801,minFifter);
		gl.texParameteri(0x0DE1,0x2800,magFifter);
		gl.texParameteri(0x0DE1,0x2802,0x812F);
		gl.texParameteri(0x0DE1,0x2803,0x812F);
	}

	(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
	this.canvas=null;
	if (isPOT && this.mipmap)
		this.memorySize=this._w *this._h *4 *(1+1 / 3);
	else
	this.memorySize=this._w *this._h *4;
}


__proto.disposeResource=function(){
	if (!(AtlasResourceManager.enabled && this._allowMerageInAtlas)&& this._source){
		WebGL.mainContext.deleteTexture(this._source);
		this._source=null;
		this.memorySize=0;
	}

}


//}
__proto.clearAtlasSource=function(){}
/**
*是否创建私有Source
*@return 是否创建
*/
__getset(0,__proto,'allowMerageInAtlas',function(){
	return this._allowMerageInAtlas;
});


//public var createFromPixel:Boolean=true;
__getset(0,__proto,'atlasSource',function(){
	return this.canvas;
});


/**
*是否创建私有Source,通常禁止修改
*@param value 是否创建
*/
/**
*是否创建私有Source
*@return 是否创建
*/
__getset(0,__proto,'enableMerageInAtlas',function(){
	return this._allowMerageInAtlas;
	},function(value){

	this._allowMerageInAtlas=value;
});


return WebGLSubImage;
})(Bitmap)


//class laya.webgl.shader.d2.value.TextSV extends laya.webgl.shader.d2.value.TextureSV
var TextSV=(function(_super){
	function TextSV(args){
		TextSV.__super.call(this,0x40);
		this.defines.add(0x40);
	}

	__class(TextSV,'laya.webgl.shader.d2.value.TextSV',_super);
	var __proto=TextSV.prototype;
	__proto.release=function(){
		TextSV.pool[TextSV._length++]=this;
		this.clear();
	}

	__proto.clear=function(){
		_super.prototype.clear.call(this);
	}

	TextSV.create=function(){
		if (TextSV._length)return TextSV.pool[--TextSV._length];
		else return new TextSV(null);
	}

	TextSV.pool=[];
	TextSV._length=0;
	return TextSV;
})(TextureSV)


//class CreateRoleScene extends game.base.Scene
var CreateRoleScene=(function(_super){
	function CreateRoleScene(){
		this.createRoleSession=null;
		this.createRoleUI=null;
		this.sysArr=null;
		this.btnArr=[];
		this.chioceBtn=0;
		this.sensitiveSession=null;
		this.auto=null;
		this.dragonBonesMc=null;
		this.settingsOther=null;
		this.arr=["zhujueyi","zhujueer","zhujuesan","juesesi"];
		// }
		this.map=[];
		this.select=0;
		this.signNameIndex=0;
		CreateRoleScene.__super.call(this);
		App.injOne(this);
		this.auto=new AutoEvent(this);
		this.auto.add("CREATE_ROLE_BACK",this,this.createRoleFun);
		this.sysArr=ConfigManager.getDataArr("sys_name.txt");
		this._$4_comFun();
		this.on("undisplay",this,this._$4_undisFun);
	}

	__class(CreateRoleScene,'CreateRoleScene',_super);
	var __proto=CreateRoleScene.prototype;
	//Laya.loader.load("huo2.part",Handler.create(this,playParticle,null,false),null,Loader.JSON);
	__proto._$4_undisFun=function(){
		Loader.clearResByGroup("CreateRoleScene");
		for (var i=0;i < this.map.length;i++){
			if(this.map[i] !=null){
				var mc=this.map [i];
				mc.dispose();
			}
		};
		var resurl=null;
		try {
			resurl=this.createRoleUI.huo2["_particleTemplate"]["settings"]["textureName"];
		}
		catch(error){}
		if(resurl){
			Loader.clearRes(resurl);
		}
	}

	__proto.choiceRole=function(index){
		if(this.dragonBonesMc!=null){
			var ss=Tween.to(this.dragonBonesMc,{x:this.dragonBonesMc.x-800,alpha:0},1600,Ease["quartOut"],new Handler(this,this.removeDra,[this.dragonBonesMc]));
		}
		this.dragonBonesMc=new DragonMc();
		this.dragonBonesMc.setUrl("res/load/"+this.arr[index]+".sk");
		this.createRoleUI.addChild(this.dragonBonesMc);
		this.dragonBonesMc.alpha=0;
		this.dragonBonesMc.scrollRect=new Rectangle(-930,-650,1300,600);
		Tween.to(this.dragonBonesMc,{x:this.dragonBonesMc.x-500,alpha:1},1600,Ease["quartOut"]);
		this.map[index]=this.dragonBonesMc;
	}

	__proto.removeDra=function(dragonBonesMc){
		dragonBonesMc.removeSelf();
	}

	__proto.goBack=function(){
		App.sceneManager.setScene("LOGIN_SCENE");
	}

	__proto.randomName=function(numArr,chioceBtn){
		var str="";
		var arr=[];
		var arrInt=[];
		if(chioceBtn==0||chioceBtn==2){
			arr=["adjective","noun","familyName","name"];
			arrInt.push(numArr[0],numArr[1],numArr[2],numArr[3]);
			}else{
			arr=["adjective","noun","familyName","femaleName"];
			arrInt.push(numArr[0],numArr[1],numArr[2],numArr[4]);
		}
		for (var i=0;i < arrInt.length;i++){
			var value=Math.floor((arrInt[i]-1)*Math.random());
			str+=this.sysArr[value][arr[i]];
		}
		return str;
	}

	__proto.getNameLength=function(sysArr,str){
		for (var i=0;i < sysArr.length;i++){
			if(sysArr[i][str]==""){
				var name=i;
				return name;
			}
		}
		return name=sysArr.length;
	}

	__proto._$4_comFun=function(){
		this.createRoleUI=new CreateRoleUI();
		this.addChild(this.createRoleUI);
		this.choiceName();
		this.createRoleUI.goBtn.clickHandler=new Handler(this,this.goFun);
		this.createRoleUI.btn0.clickHandler=new Handler(this,this.choiceName);
		this.createRoleUI.fanhui.clickHandler=new Handler(this,this.goBack);
		this.createRoleUI.xian.zOrder=1;
		this.btnArr.push(this.createRoleUI.role1,this.createRoleUI.role2);
		this.btnArr.push(this.createRoleUI.role3,this.createRoleUI.role4);
		for (var i=0;i < this.btnArr.length;i++){
			var btn=this.btnArr [i];
			btn.clickHandler=new Handler(this,this.choicePic,[btn,i]);
		}
		this.choicePic(this.createRoleUI.role1,0);
		this.width=Laya.stage.width;
		this.createRoleUI.centerX=0;
		this.createRoleUI.role1.zOrder=this.createRoleUI.role2.zOrder=this.createRoleUI.role3.zOrder=this.createRoleUI.role4.zOrder=2;
	}

	__proto.goFun=function(){
		var newName=this.createRoleUI.txt0.text;
		if(newName.indexOf(" ")!=-1){
			FlyUpTips.setTips("名称包含空格符");
			return;
		};
		var namelen=GameUtils.getStringCharLen(newName);
		if(namelen > 12 || namelen < 4){
			FlyUpTips.setTips("名字长度应在4-12个字符之间");
			return;
		}
		if(!this.sensitiveSession.IsSensitiveWord(newName)){
			FlyUpTips.setTips("名称包含敏感字符");
			return;
		}
		this.createRoleSession.createRoleByHttp(this.select,newName);
		LoadMask.show(3000);
	}

	__proto.createRoleFun=function(){
		LoadMask.close();
	}

	__proto.choiceName=function(){
		var numArr=[];
		var nameArr=["adjective","noun","familyName","name","femaleName"];
		for (var i=0;i < nameArr.length;i++){
			numArr.push(this.getNameLength(this.sysArr,nameArr[i]));
		};
		var newName=this.randomName(numArr,this.chioceBtn);
		if(!this.sensitiveSession.IsSensitiveWord(newName)){
			this.choiceName();
			return;
		}
		this.createRoleUI.txt0.text=newName;
	}

	__proto.choicePic=function(btn1,selectIndex){
		this.chioceBtn=selectIndex;
		if(this.signNameIndex!=selectIndex){
			this.choiceName();
		}
		for (var i=0;i < this.btnArr.length;i++){
			var btn=this.btnArr [i];
			btn.selected=false;
		}
		btn1.selected=true;
		this.select=this.signNameIndex=selectIndex;
		this.choiceRole(selectIndex);
	}

	CreateRoleScene.GROUP="CreateRoleScene";
	return CreateRoleScene;
})(Scene)


/**
*<code>Box</code> 类是一个控件容器类。
*/
//class laya.ui.Box extends laya.ui.Component
var Box=(function(_super){
	function Box(){
		Box.__super.call(this);;
	}

	__class(Box,'laya.ui.Box',_super);
	var __proto=Box.prototype;
	Laya.imps(__proto,{"laya.ui.IBox":true})
	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		for (var name in value){
			var comp=this.getChildByName(name);
			if (comp)comp.dataSource=value[name];
			else if (this.hasOwnProperty(name)&& !((typeof (this[name])=='function')))this[name]=value[name];
		}
	});

	return Box;
})(Component)


//class fight.SBufferDpo extends fight.BufferDpo
var SBufferDpo=(function(_super){
	function SBufferDpo(){
		SBufferDpo.__super.call(this);
	}

	__class(SBufferDpo,'fight.SBufferDpo',_super);
	var __proto=SBufferDpo.prototype;
	__proto.loadOverFun=function(str){
		var view=ClassUtils.getInstance("S"+str);
		this.addChild(view);
		(view.getChildAt(0)).play();
	}

	return SBufferDpo;
})(BufferDpo)


/**
*<p> <code>Clip</code> 类是位图切片动画。</p>
*<p> <code>Clip</code> 可将一张图片，按横向分割数量 <code>clipX</code> 、竖向分割数量 <code>clipY</code> ，
*或横向分割每个切片的宽度 <code>clipWidth</code> 、竖向分割每个切片的高度 <code>clipHeight</code> ，
*从左向右，从上到下，分割组合为一个切片动画。</p>
*Image和Clip组件是唯一支持异步加载的两个组件，比如clip.skin="abc/xxx.png"，其他UI组件均不支持异步加载。
*
*@example <caption>以下示例代码，创建了一个 <code>Clip</code> 实例。</caption>
*package
*{
	*import laya.ui.Clip;
	*public class Clip_Example
	*{
		*private var clip:Clip;
		*public function Clip_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*onInit();
			*}
		*private function onInit():void
		*{
			*clip=new Clip("resource/ui/clip_num.png",10,1);//创建一个 Clip 类的实例对象 clip ,传入它的皮肤skin和横向分割数量、竖向分割数量。
			*clip.autoPlay=true;//设置 clip 动画自动播放。
			*clip.interval=100;//设置 clip 动画的播放时间间隔。
			*clip.x=100;//设置 clip 对象的属性 x 的值，用于控制 clip 对象的显示位置。
			*clip.y=100;//设置 clip 对象的属性 y 的值，用于控制 clip 对象的显示位置。
			*clip.on(Event.CLICK,this,onClick);//给 clip 添加点击事件函数侦听。
			*Laya.stage.addChild(clip);//将此 clip 对象添加到显示列表。
			*}
		*private function onClick():void
		*{
			*trace("clip 的点击事件侦听处理函数。clip.total="+clip.total);
			*if (clip.isPlaying==true)
			*{
				*clip.stop();//停止动画。
				*}else {
				*clip.play();//播放动画。
				*}
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*var clip;
*Laya.loader.load("resource/ui/clip_num.png",laya.utils.Handler.create(this,loadComplete));//加载资源
*function loadComplete(){
	*console.log("资源加载完成！");
	*clip=new laya.ui.Clip("resource/ui/clip_num.png",10,1);//创建一个 Clip 类的实例对象 clip ,传入它的皮肤skin和横向分割数量、竖向分割数量。
	*clip.autoPlay=true;//设置 clip 动画自动播放。
	*clip.interval=100;//设置 clip 动画的播放时间间隔。
	*clip.x=100;//设置 clip 对象的属性 x 的值，用于控制 clip 对象的显示位置。
	*clip.y=100;//设置 clip 对象的属性 y 的值，用于控制 clip 对象的显示位置。
	*clip.on(Event.CLICK,this,onClick);//给 clip 添加点击事件函数侦听。
	*Laya.stage.addChild(clip);//将此 clip 对象添加到显示列表。
	*}
*function onClick()
*{
	*console.log("clip 的点击事件侦听处理函数。");
	*if(clip.isPlaying==true)
	*{
		*clip.stop();
		*}else {
		*clip.play();
		*}
	*}
*@example
*import Clip=laya.ui.Clip;
*import Handler=laya.utils.Handler;
*class Clip_Example {
	*private clip:Clip;
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*this.onInit();
		*}
	*private onInit():void {
		*this.clip=new Clip("resource/ui/clip_num.png",10,1);//创建一个 Clip 类的实例对象 clip ,传入它的皮肤skin和横向分割数量、竖向分割数量。
		*this.clip.autoPlay=true;//设置 clip 动画自动播放。
		*this.clip.interval=100;//设置 clip 动画的播放时间间隔。
		*this.clip.x=100;//设置 clip 对象的属性 x 的值，用于控制 clip 对象的显示位置。
		*this.clip.y=100;//设置 clip 对象的属性 y 的值，用于控制 clip 对象的显示位置。
		*this.clip.on(laya.events.Event.CLICK,this,this.onClick);//给 clip 添加点击事件函数侦听。
		*Laya.stage.addChild(this.clip);//将此 clip 对象添加到显示列表。
		*}
	*private onClick():void {
		*console.log("clip 的点击事件侦听处理函数。clip.total="+this.clip.total);
		*if (this.clip.isPlaying==true){
			*this.clip.stop();//停止动画。
			*}else {
			*this.clip.play();//播放动画。
			*}
		*}
	*}
*
*/
//class laya.ui.Clip extends laya.ui.Component
var Clip=(function(_super){
	function Clip(url,clipX,clipY){
		/**@private */
		this._sources=null;
		/**@private */
		this._bitmap=null;
		/**@private */
		this._skin=null;
		/**@private */
		this._clipX=1;
		/**@private */
		this._clipY=1;
		/**@private */
		this._clipWidth=0;
		/**@private */
		this._clipHeight=0;
		/**@private */
		this._autoPlay=false;
		/**@private */
		this._interval=50;
		/**@private */
		this._complete=null;
		/**@private */
		this._isPlaying=false;
		/**@private */
		this._index=0;
		/**@private */
		this._clipChanged=false;
		/**@private */
		this._group=null;
		/**@private */
		this._toIndex=-1;
		Clip.__super.call(this);
		(clipX===void 0)&& (clipX=1);
		(clipY===void 0)&& (clipY=1);
		this._clipX=clipX;
		this._clipY=clipY;
		this.skin=url;
	}

	__class(Clip,'laya.ui.Clip',_super);
	var __proto=Clip.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,true);
		this._bitmap && this._bitmap.destroy();
		this._bitmap=null;
		this._sources=null;
	}

	/**
	*销毁对象并释放加载的皮肤资源。
	*/
	__proto.dispose=function(){
		this.destroy(true);
		Laya.loader.clearRes(this._skin);
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.graphics=this._bitmap=new AutoBitmap();
	}

	/**@private */
	__proto._onDisplay=function(e){
		if (this._isPlaying){
			if (this._displayedInStage)this.play();
			else this.stop();
			}else if (this._autoPlay){
			this.play();
		}
	}

	/**
	*@private
	*改变切片的资源、切片的大小。
	*/
	__proto.changeClip=function(){
		this._clipChanged=false;
		if (!this._skin)return;
		var img=Loader.getRes(this._skin);
		if (img){
			this.loadComplete(this._skin,img);
			}else {
			Laya.loader.load(this._skin,Handler.create(this,this.loadComplete,[this._skin]));
		}
	}

	/**
	*@private
	*加载切片图片资源完成函数。
	*@param url 资源地址。
	*@param img 纹理。
	*/
	__proto.loadComplete=function(url,img){
		if (url===this._skin && img){
			var w=this._clipWidth || Math.ceil(img.sourceWidth / this._clipX);
			var h=this._clipHeight || Math.ceil(img.sourceHeight / this._clipY);
			var key=this._skin+w+h;
			var clips=WeakObject.I.get(key);
			if (!Utils.isOkTextureList(clips)){
				clips=null;
			}
			if (clips)this._sources=clips;
			else {
				this._sources=[];
				for (var i=0;i < this._clipY;i++){
					for (var j=0;j < this._clipX;j++){
						this._sources.push(Texture.createFromTexture(img,w *j,h *i,w,h));
					}
				}
				WeakObject.I.set(key,this._sources);
			}
			this.index=this._index;
			this.event("loaded");
			this.onCompResize();
		}
	}

	/**
	*播放动画。
	*@param from 开始索引
	*@param to 结束索引，-1为不限制
	*/
	__proto.play=function(from,to){
		(from===void 0)&& (from=0);
		(to===void 0)&& (to=-1);
		this._isPlaying=true;
		this.index=from;
		this._toIndex=to;
		this._index++;
		Laya.timer.loop(this.interval,this,this._loop);
		this.on("display",this,this._onDisplay);
		this.on("undisplay",this,this._onDisplay);
	}

	/**
	*@private
	*/
	__proto._loop=function(){
		if (this._style.visible && this._sources){
			this._index++;
			if (this._toIndex >-1 && this._index >=this._toIndex)this.stop();
			else if (this._index >=this._sources.length)this._index=0;
			this.index=this._index;
		}
	}

	/**
	*停止动画。
	*/
	__proto.stop=function(){
		this._isPlaying=false;
		Laya.timer.clear(this,this._loop);
		this.event("complete");
	}

	/**@private */
	__proto._setClipChanged=function(){
		if (!this._clipChanged){
			this._clipChanged=true;
			this.callLater(this.changeClip);
		}
	}

	/**
	*表示动画播放间隔时间(以毫秒为单位)。
	*/
	__getset(0,__proto,'interval',function(){
		return this._interval;
		},function(value){
		if (this._interval !=value){
			this._interval=value;
			if (this._isPlaying)this.play();
		}
	});

	/**
	*@copy laya.ui.Image#skin
	*/
	__getset(0,__proto,'skin',function(){
		return this._skin;
		},function(value){
		if (this._skin !=value){
			this._skin=value;
			if (value){
				this._setClipChanged()
				}else {
				this._bitmap.source=null;
			}
		}
	});

	/**
	*源数据。
	*/
	__getset(0,__proto,'sources',function(){
		return this._sources;
		},function(value){
		this._sources=value;
		this.index=this._index;
		this.event("loaded");
	});

	/**X轴（横向）切片数量。*/
	__getset(0,__proto,'clipX',function(){
		return this._clipX;
		},function(value){
		this._clipX=value || 1;
		this._setClipChanged()
	});

	/**Y轴(竖向)切片数量。*/
	__getset(0,__proto,'clipY',function(){
		return this._clipY;
		},function(value){
		this._clipY=value || 1;
		this._setClipChanged()
	});

	/**
	*切片动画的总帧数。
	*/
	__getset(0,__proto,'total',function(){
		this.runCallLater(this.changeClip);
		return this._sources ? this._sources.length :0;
	});

	/**
	*横向分割时每个切片的宽度，与 <code>clipX</code> 同时设置时优先级高于 <code>clipX</code> 。
	*/
	__getset(0,__proto,'clipWidth',function(){
		return this._clipWidth;
		},function(value){
		this._clipWidth=value;
		this._setClipChanged()
	});

	/**
	*<p>当前实例的位图 <code>AutoImage</code> 实例的有效缩放网格数据。</p>
	*<p>数据格式："上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)"，以逗号分隔。
	*<ul><li>例如："4,4,4,4,1"</li></ul></p>
	*@see laya.ui.AutoBitmap.sizeGrid
	*/
	__getset(0,__proto,'sizeGrid',function(){
		if (this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");
		return null;
		},function(value){
		this._bitmap.sizeGrid=UIUtils.fillArray(Styles.defaultSizeGrid,value,Number);
	});

	/**
	*资源分组。
	*/
	__getset(0,__proto,'group',function(){
		return this._group;
		},function(value){
		if (value && this._skin)Loader.setGroup(this._skin,value);
		this._group=value;
	});

	/**
	*竖向分割时每个切片的高度，与 <code>clipY</code> 同时设置时优先级高于 <code>clipY</code> 。
	*/
	__getset(0,__proto,'clipHeight',function(){
		return this._clipHeight;
		},function(value){
		this._clipHeight=value;
		this._setClipChanged()
	});

	/**@inheritDoc */
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Component,this,'width',value);
		this._bitmap.width=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Component,this,'height',value);
		this._bitmap.height=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureWidth',function(){
		this.runCallLater(this.changeClip);
		return this._bitmap.width;
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureHeight',function(){
		this.runCallLater(this.changeClip);
		return this._bitmap.height;
	});

	/**
	*当前帧索引。
	*/
	__getset(0,__proto,'index',function(){
		return this._index;
		},function(value){
		this._index=value;
		this._bitmap && this._sources && (this._bitmap.source=this._sources[value]);
		this.event("change");
	});

	/**
	*表示是否自动播放动画，若自动播放值为true,否则值为false;
	*<p>可控制切片动画的播放、停止。</p>
	*/
	__getset(0,__proto,'autoPlay',function(){
		return this._autoPlay;
		},function(value){
		if (this._autoPlay !=value){
			this._autoPlay=value;
			value ? this.play():this.stop();
		}
	});

	/**
	*表示动画的当前播放状态。
	*如果动画正在播放中，则为true，否则为flash。
	*/
	__getset(0,__proto,'isPlaying',function(){
		return this._isPlaying;
		},function(value){
		this._isPlaying=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if (((typeof value=='number')&& Math.floor(value)==value)|| (typeof value=='string'))this.index=parseInt(value);
		else Laya.superSet(Component,this,'dataSource',value);
	});

	/**
	*<code>AutoBitmap</code> 位图实例。
	*/
	__getset(0,__proto,'bitmap',function(){
		return this._bitmap;
	});

	return Clip;
})(Component)


/**
*黑屏
*@author chengxu03
*/
//class game.base.display.BlackSprite extends game.base.display.StageSprite
var BlackSprite=(function(_super){
	function BlackSprite(){
		BlackSprite.__super.call(this);
	}

	__class(BlackSprite,'game.base.display.BlackSprite',_super);
	var __proto=BlackSprite.prototype;
	__proto.resize=function(){
		this.graphics.clear();
		this.graphics.drawRect(0,0,this.stage.width,this.stage.height,"#000000");
		this.alpha=0.2;
	}

	return BlackSprite;
})(StageSprite)


/**
*<code>Image</code> 类是用于表示位图图像或绘制图形的显示对象。
*Image和Clip组件是唯一支持异步加载的两个组件，比如img.skin="abc/xxx.png"，其他UI组件均不支持异步加载。
*
*@example <caption>以下示例代码，创建了一个新的 <code>Image</code> 实例，设置了它的皮肤、位置信息，并添加到舞台上。</caption>
*package
*{
	*import laya.ui.Image;
	*public class Image_Example
	*{
		*public function Image_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*onInit();
			*}
		*private function onInit():void
		*{
			*var bg:Image=new Image("resource/ui/bg.png");//创建一个 Image 类的实例对象 bg ,并传入它的皮肤。
			*bg.x=100;//设置 bg 对象的属性 x 的值，用于控制 bg 对象的显示位置。
			*bg.y=100;//设置 bg 对象的属性 y 的值，用于控制 bg 对象的显示位置。
			*bg.sizeGrid="40,10,5,10";//设置 bg 对象的网格信息。
			*bg.width=150;//设置 bg 对象的宽度。
			*bg.height=250;//设置 bg 对象的高度。
			*Laya.stage.addChild(bg);//将此 bg 对象添加到显示列表。
			*var image:Image=new Image("resource/ui/image.png");//创建一个 Image 类的实例对象 image ,并传入它的皮肤。
			*image.x=100;//设置 image 对象的属性 x 的值，用于控制 image 对象的显示位置。
			*image.y=100;//设置 image 对象的属性 y 的值，用于控制 image 对象的显示位置。
			*Laya.stage.addChild(image);//将此 image 对象添加到显示列表。
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*onInit();
*function onInit(){
	*var bg=new laya.ui.Image("resource/ui/bg.png");//创建一个 Image 类的实例对象 bg ,并传入它的皮肤。
	*bg.x=100;//设置 bg 对象的属性 x 的值，用于控制 bg 对象的显示位置。
	*bg.y=100;//设置 bg 对象的属性 y 的值，用于控制 bg 对象的显示位置。
	*bg.sizeGrid="40,10,5,10";//设置 bg 对象的网格信息。
	*bg.width=150;//设置 bg 对象的宽度。
	*bg.height=250;//设置 bg 对象的高度。
	*Laya.stage.addChild(bg);//将此 bg 对象添加到显示列表。
	*var image=new laya.ui.Image("resource/ui/image.png");//创建一个 Image 类的实例对象 image ,并传入它的皮肤。
	*image.x=100;//设置 image 对象的属性 x 的值，用于控制 image 对象的显示位置。
	*image.y=100;//设置 image 对象的属性 y 的值，用于控制 image 对象的显示位置。
	*Laya.stage.addChild(image);//将此 image 对象添加到显示列表。
	*}
*@example
*class Image_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*this.onInit();
		*}
	*private onInit():void {
		*var bg:laya.ui.Image=new laya.ui.Image("resource/ui/bg.png");//创建一个 Image 类的实例对象 bg ,并传入它的皮肤。
		*bg.x=100;//设置 bg 对象的属性 x 的值，用于控制 bg 对象的显示位置。
		*bg.y=100;//设置 bg 对象的属性 y 的值，用于控制 bg 对象的显示位置。
		*bg.sizeGrid="40,10,5,10";//设置 bg 对象的网格信息。
		*bg.width=150;//设置 bg 对象的宽度。
		*bg.height=250;//设置 bg 对象的高度。
		*Laya.stage.addChild(bg);//将此 bg 对象添加到显示列表。
		*var image:laya.ui.Image=new laya.ui.Image("resource/ui/image.png");//创建一个 Image 类的实例对象 image ,并传入它的皮肤。
		*image.x=100;//设置 image 对象的属性 x 的值，用于控制 image 对象的显示位置。
		*image.y=100;//设置 image 对象的属性 y 的值，用于控制 image 对象的显示位置。
		*Laya.stage.addChild(image);//将此 image 对象添加到显示列表。
		*}
	*}
*@see laya.ui.AutoBitmap
*/
//class laya.ui.Image extends laya.ui.Component
var Image=(function(_super){
	function Image(skin){
		/**@private */
		this._bitmap=null;
		/**@private */
		this._skin=null;
		/**@private */
		this._group=null;
		Image.__super.call(this);
		this.skin=skin;
	}

	__class(Image,'laya.ui.Image',_super);
	var __proto=Image.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,true);
		this._bitmap && this._bitmap.destroy();
		this._bitmap=null;
	}

	/**
	*销毁对象并释放加载的皮肤资源。
	*/
	__proto.dispose=function(){
		this.destroy(true);
		Laya.loader.clearRes(this._skin);
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.graphics=this._bitmap=new AutoBitmap();
		this._bitmap.autoCacheCmd=false;
	}

	/**
	*@private
	*设置皮肤资源。
	*/
	__proto.setSource=function(url,img){
		if (url===this._skin && img){
			this.source=img
			this.onCompResize();
		}
	}

	/**
	*@copy laya.ui.AutoBitmap#source
	*/
	__getset(0,__proto,'source',function(){
		return this._bitmap.source;
		},function(value){
		if (!this._bitmap)return;
		this._bitmap.source=value;
		this.event("loaded");
		this.repaint();
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if ((typeof value=='string'))this.skin=value;
		else Laya.superSet(Component,this,'dataSource',value);
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureHeight',function(){
		return this._bitmap.height;
	});

	/**
	*<p>对象的皮肤地址，以字符串表示。</p>
	*<p>如果资源未加载，则先加载资源，加载完成后应用于此对象。</p>
	*<b>注意：</b>资源加载完成后，会自动缓存至资源库中。
	*/
	__getset(0,__proto,'skin',function(){
		return this._skin;
		},function(value){
		if (this._skin !=value){
			this._skin=value;
			if (value){
				var source=Loader.getRes(value);
				if (source){
					this.source=source;
					this.onCompResize();
				}else Laya.loader.load(this._skin,Handler.create(this,this.setSource,[this._skin]),null,"image",1,true,this._group);
				}else {
				this.source=null;
			}
		}
	});

	/**
	*资源分组。
	*/
	__getset(0,__proto,'group',function(){
		return this._group;
		},function(value){
		if (value && this._skin)Loader.setGroup(this._skin,value);
		this._group=value;
	});

	/**
	*<p>当前实例的位图 <code>AutoImage</code> 实例的有效缩放网格数据。</p>
	*<p>数据格式："上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)"，以逗号分隔。
	*<ul><li>例如："4,4,4,4,1"。</li></ul></p>
	*@see laya.ui.AutoBitmap#sizeGrid
	*/
	__getset(0,__proto,'sizeGrid',function(){
		if (this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");
		return null;
		},function(value){
		this._bitmap.sizeGrid=UIUtils.fillArray(Styles.defaultSizeGrid,value,Number);
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureWidth',function(){
		return this._bitmap.width;
	});

	/**@inheritDoc */
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Component,this,'width',value);
		this._bitmap.width=value==0 ? 0.0000001 :value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Component,this,'height',value);
		this._bitmap.height=value==0 ? 0.0000001 :value;
	});

	return Image;
})(Component)


//class huamao.guide.GuideMain extends game.base.display.StageSprite
var GuideMain=(function(_super){
	function GuideMain(){
		//数据是否接受
		this.cityHeader=null;
		this.guideSession=null;
		this.ifReload=false;
		this.gameContainer=null;
		this.eventui=null;
		this.talkui=null;
		this.effectui=null;
		this.spacialui=null;
		this.rangeui=null;
		this.mainPlayerSession=null;
		this.mapCitySession=null;
		this.guideAction=null;
		this.taskSession=null;
		this.LOCK=false;
		this.initOver=false;
		this.sysGuideData=null;
		this.beforUI=null;
		this.curUI=null;
		this.ifWait=false;
		GuideMain.__super.call(this);
		App.injOne(this);
		if(!this.mainPlayerSession.checkIfInGuide()){
			return;
		}
		SysGuide.initLastStep();
		App.eventManager.on("OPEN_DIALOG_INSTANCE",this,this.openDialog);
		App.eventManager.on("CHECK_GUIDE",this,this.check);
		App.eventManager.on("ZHAOMUCOM",this,this.effectEnd);
		App.eventManager.on("ADD_FIGHT_FIRE",this,this.fightFireCB);
		App.eventManager.on("EXIT_FIGHT_SCENE",this,this.exitFightCB);
		App.eventManager.on("UPDATE_CITY_INFO",this,this.overFightCB);
		App.eventManager.on("SOCKET_CLOSE",this,this.resetGuide);
		App.eventManager.on("LOGOUT_SDK",this,this.resetGuide);
		App.eventManager.on("SOCKET_CLOSE_ACTIVE",this,this.resetGuide);
		App.eventManager.on("LOGIN_MASTER_SERVER_SUCCESS",this,this.resetGuide);
		App.eventManager.on("YUNOVER",this,this.yunOver);
		App.eventManager.on("MAINSCENEOVER",this,this.loadMainSene);
		App.eventManager.on("ROLLOVER",this,this.rollOver);
		App.eventManager.on("GUIDE_UI_OVER",this,this.check);
		App.eventManager.on("ENTERMAP",this,this.enterMap);
		App.eventManager.on("OPEN_WAIJIAO",this,this.openWaiJiao);
		App.eventManager.on("BUZHEN_ANIMI_OVER",this,this.buZhenOver);
		App.eventManager.on("GUIDE_FIGHT2GUIDE",this,this.fight2Guide);
		App.eventManager.on("ENTER_BATTLE",this,this.SaveDotStr);
		console.log("新手引导 初始化");
		this.initOver=true;
		this.ifReload=false;
	}

	__class(GuideMain,'huamao.guide.GuideMain',_super);
	var __proto=GuideMain.prototype;
	__proto.SaveDotStr=function(){
		this.guideAction.sendDotStr("1");
	}

	__proto.fight2Guide=function(jId){
		console.log("fight2Guide ----------> jId = "+jId);
		if(SysGuide.getCurstep()!=2){
			return;
		}
		if(jId==4016){
			this.setGuideToDo(2,2);
			}else if(jId==2019){
			this.setGuideToDo(2,3);
			}else if(jId==4001){
			this.setGuideToDo(2,4);
		}
	}

	__proto.yunOver=function(){
		console.log("[guide] yunOver() -------->");
		this.init();
	}

	__proto.loadMainSene=function(){
		if(this.guideSession.getVedioIsEnd()){
			console.log("[guide] loadMainSene() -------->");
			if(this.ifReload){
				this.ifReload=false;
				this.check();
				}else{
				this.init();
			}
		}
	}

	__proto.enterMap=function(){
		if(SysGuide.getCurstep()==25 && this.mainPlayerSession.mainPlayerData.job==1002){
			this.setGuideToDo(26);
		}
	}

	__proto.openWaiJiao=function(){
		var ary=this.mapCitySession.getCityPlayerList();
		if(SysGuide.getCurstep()==26 && ary.length > 1){
			this.setGuideToDo(27);
		}
	}

	__proto.buZhenOver=function(){
		console.log("布阵结束-----》");
		this.unLockGuide();
	}

	__proto.resize=function(){
		if(this.gameContainer !=null){
			this.gameContainer.size(Browser.width,Browser.height);
		}
	}

	__proto.init=function(){
		if(this.gameContainer==null){
			this.gameContainer=new Image("comp/icon/d.png");
			this.gameContainer.sizeGrid="9,9,9,9";
			this.gameContainer.alpha=0.01;
			this.gameContainer.mouseThrough=false;
			this.gameContainer.mouseEnabled=true;
			this.gameContainer.zOrder=0;
			this.gameContainer.size(Laya.stage.width,Laya.stage.height);
			this.addClickLis();
		}
		if(this.eventui==null){
			this.eventui=new EventUI(this);
		}
		if(this.rangeui==null){
			this.rangeui=new RangeUI(this);
		}
		if(this.talkui==null){
			this.talkui=new TalkUI2();
		}
		if(this.effectui==null){
			this.effectui=new EffectUI();
		}
		if(this.spacialui==null){
			this.spacialui=new SpecialUI();
		}
		this.initOver=false;
	}

	__proto.initImgRangeUI=function(){
		if(this.rangeui !=null){
			this.rangeui.initImg();
		}
	}

	__proto.addClickLis=function(){
		this.gameContainer.on("click",this,this.nextStep);
	}

	__proto.removeClickLis=function(){
		this.gameContainer.off("click",this,this.nextStep);
	}

	//是否在战斗场景里
	__proto.ifInFightScene=function(){
		var scene=App.sceneManager.getCurrentScene();
		if((scene instanceof fight.BattleFileScene )|| App.layerManager.isShowLoad()){
			return true;
		}
		return false;
	}

	__proto.setGuideToDo=function(step,smallstep){
		(smallstep===void 0)&& (smallstep=1);
		if(GuideMain.stopGuide)return;
		this.sysGuideData=SysGuide.getStepSysGuide(step,smallstep);
		this.openUI(this.sysGuideData);
	}

	__proto.updataPlayerLvCB=function(){}
	// }
	__proto.updataTaskDataCB=function(){
		if(!this.mainPlayerSession.checkIfInGuide()){
			return;
		};
		var taskData=this.taskSession.typeNewplayer;
		if(taskData.status==3){
			if(taskData.taskId==5006 && SysGuide.getCurstep()!=16){
				this.sysGuideData=SysGuide.getStepSysGuide(16);
				Dialog.manager.closeAll();
				this.openUI(this.sysGuideData);
			}
			if(taskData.taskId==5019 && SysGuide.getCurstep()!=18){
				this.sysGuideData=SysGuide.getStepSysGuide(18);
				Dialog.manager.closeAll();
				this.openUI(this.sysGuideData);
			}
			if(taskData.taskId==5023 && SysGuide.getCurstep()!=19){
				this.sysGuideData=SysGuide.getStepSysGuide(19);
				Dialog.manager.closeAll();
				this.openUI(this.sysGuideData);
			}
			if(taskData.taskId==5027 && SysGuide.getCurstep()!=20){
				this.sysGuideData=SysGuide.getStepSysGuide(20);
				Dialog.manager.closeAll();
				this.openUI(this.sysGuideData);
			}
		}
	}

	//重连失败
	__proto.resetGuide=function(){
		this.closeUI();
		huamao.guide.GuideMain.removeUILoading();
		this.sysGuideData=null;
		SysGuide.clearStep();
		this.unLockGuide();
		GuideAction.ifRead_Step=true;
		GuideAction.ifRead_Unlock=true;
		huamao.guide.GuideMain.guideUI=false;
		huamao.guide.GuideMain.guideData=false;
		this.ifReload=true;
		console.log("断线，关闭新手引导---》");
	}

	//关闭进城ui
	__proto.closeCityInner=function(){
		var scene=App.sceneManager.getCurrentScene();
		if((scene instanceof MainScene )){
			var mainscene=scene;
			if(GameState.state==4){
				var event=new Event();
				event.type="click";
				mainscene.mainui.fanhui.event("click",event);
			}
		}
	}

	__proto.closeChuZheng=function(){
		var scene=App.sceneManager.getCurrentScene();
		if((scene instanceof MainScene )){
			var mainscene=scene;
			if(GameState.state==3){
				var event=new Event();
				event.type="click";
				mainscene.mainui.fanhui3.event("click",event);
			}
		}
	}

	__proto.checkSpl=function(cityId,curstep){
		if(cityId==-1 && curstep==2){
			this.setGuideToDo(3);
			return true;
		}
		return false;
	}

	//结束战斗
	__proto.overFightCB=function(citydata,cityplayerdata){
		if(GuideMain.stopGuide)return;
		if(this.initOver)return;
		if(!this.mainPlayerSession.checkIfInGuide()){
			return;
		};
		var curstep=SysGuide.getKeyStep();
		if(this.checkSpl(citydata.cityId,curstep)){
			return;
		}
		if(citydata.playerId==this.mainPlayerSession.mainPlayerData.playerId){
			if(citydata.cityId==1001 && curstep==11){
				if(!this.ifInFightScene()){
					Dialog.manager.closeAll();
					this.closeCityInner();
					TalkPanel.getMe().closeCB();
					this.setGuideToDo(12);
				}
				}else if(citydata.cityId==2002 && curstep==19){
				if(!this.ifInFightScene()){
					Dialog.manager.closeAll();
					this.closeCityInner();
					TalkPanel.getMe().closeCB();
					this.setGuideToDo(20);
				}
				}else if(citydata.cityId==1007 && curstep==24){
				if(!this.ifInFightScene()){
					Dialog.manager.closeAll();
					this.closeCityInner();
					TalkPanel.getMe().closeCB();
					this.setGuideToDo(25);
				}
			}
		}
	}

	//退出战斗场景
	__proto.exitFightCB=function(cityid){
		if(GuideMain.stopGuide)return;
		if(this.initOver)return;
		if(!this.mainPlayerSession.checkIfInGuide()){
			return;
		};
		var curstep=SysGuide.getKeyStep();
		if(this.checkSpl(cityid,curstep)){
			return;
		}
		if(cityid==1001 && curstep==11){
			var citydata=this.mapCitySession.getCity(1001);
			if(citydata.playerId !=this.mainPlayerSession.mainPlayerData.playerId){
				return;
			}
			this.closeOtherPanelBeforOpenUI();
			this.setGuideToDo(12);
			}else if(cityid==2002 && curstep==19){
			citydata=this.mapCitySession.getCity(2002);
			if(citydata.playerId !=this.mainPlayerSession.mainPlayerData.playerId){
				return;
			}
			this.closeOtherPanelBeforOpenUI();
			this.setGuideToDo(20);
			}else if(cityid==1007 && curstep==24){
			citydata=this.mapCitySession.getCity(1007);
			if(citydata.playerId !=this.mainPlayerSession.mainPlayerData.playerId){
				return;
			}
			this.closeOtherPanelBeforOpenUI();
			this.setGuideToDo(25);
		}
	}

	__proto.closeOtherPanelBeforOpenUI=function(){
		Dialog.manager.closeAll();
		this.closeCityInner();
		TalkPanel.getMe().closeCB();
	}

	//到达战场
	__proto.fightFireCB=function(cityid){
		console.log("[guide] 到达战场 fightFireCB() --------1");
		if(GuideMain.stopGuide)return;
		if(this.initOver)return;
		if(!this.mainPlayerSession.checkIfInGuide()){
			console.log("[guide] 到达战场 fightFireCB() --------2");
			return;
		};
		var curstep=SysGuide.getCurstep();
		if(this.checkSpl(cityid,curstep)){
			console.log("[guide] 到达战场 fightFireCB() --------3");
			return;
		}
		if(cityid==1001 && curstep==5){
			console.log("[guide] 到达战场 fightFireCB() --------4");
			this.closeOtherPanelBeforOpenUI();
			this.setGuideToDo(6);
			}else if(cityid==2002 && curstep==18){
			console.log("[guide] 到达战场 fightFireCB() --------5");
			this.closeOtherPanelBeforOpenUI();
			this.setGuideToDo(19);
		}
	}

	//*/
	__proto.effectEnd=function(){
		if(GuideMain.stopGuide)return;
		if(this.initOver)return;
		if(!this.mainPlayerSession.checkIfInGuide()){
			return;
		}
		this.unLockGuide();
		this.check();
	}

	__proto.lockGuide=function(){
		this.LOCK=true;
		console.log("set Lock = true");
	}

	__proto.unLockGuide=function(){
		this.LOCK=false;
		console.log("set Lock = false");
	}

	__proto.closeUI=function(){
		if(this.gameContainer !=null){
			App.layerManager.guideLayer.removeChild(this.gameContainer);
		}
		if(this.talkui !=null){
			this.talkui.remoDragon();
			App.layerManager.guideLayer.removeChild(this.talkui);
		}
		if(this.eventui !=null){
			App.layerManager.guideLayer.removeChild(this.eventui);
		}
		if(this.effectui !=null){
			App.layerManager.guideLayer.removeChild(this.effectui);
		}
		if(this.spacialui !=null){
			App.layerManager.guideLayer.removeChild(this.spacialui);
		}
		if(this.rangeui !=null){
			App.layerManager.guideLayer.removeChild(this.rangeui);
		}
		this.curUI=null;
		this.beforUI=null;
	}

	__proto.showUI=function(type){
		App.layerManager.guideLayer.addChild(this.gameContainer);
		if(type==1){
			App.layerManager.guideLayer.addChild(this.talkui);
			return this.talkui;
			}else if(type==2){
			App.layerManager.guideLayer.addChild(this.eventui);
			return this.eventui;
			}else if(type==3){
			App.layerManager.guideLayer.addChild(this.effectui);
			this.lockGuide();
			return this.effectui;
			}else if(type==4){
			App.layerManager.guideLayer.addChild(this.spacialui);
			this.lockGuide();
			return this.spacialui;
			}else if(type==5){
			App.layerManager.guideLayer.addChild(this.rangeui);
			return this.rangeui;
		}
		return null;
	}

	__proto.checkSplStep=function(){
		if(this.sysGuideData !=null){
			if(this.sysGuideData.guideId==26 || this.sysGuideData.guideId==27){
				return true;
			}
		}
		return false;
	}

	__proto.check=function(){
		console.log("[guide] check() --------1");
		if(GuideMain.stopGuide)return;
		if(this.initOver)return;
		if(this.mainPlayerSession.checkIfInGuide()|| this.checkSplStep()){
			if(this.beforUI !=null){
				GuideMain.needWaitDialog=false;
				var guidid=this.sysGuideData.guideId;
				var guidstep=this.sysGuideData.guideStep;
				GuideMain.needWaitDialog=(this.sysGuideData.jump==1);
				if(this.beforUI.uiClickCB(this.sysGuideData)){
					return;
				}
				this.sendUnlockKey(this.sysGuideData);
				this.sendGuideStep(this.sysGuideData);
				if(guidid==27 && guidstep==2){
					if(this.talkui !=null){
						this.talkui.clearAll();
					}
					if(this.eventui !=null){
						this.eventui.clearAll();
					}
					console.log("[27-4]释放新手引导资源-----》");
				}
			}
			if(GuideMain.needWaitDialog){
				console.log("set needWaitDialog is true");
				}else{
				console.log("set needWaitDialog is false");
			}
			if(!GuideMain.needWaitDialog){
				console.log("[guide] check() --------2");
				this.checkData();
			}
		}
	}

	__proto.rollOver=function(){
		if(this.ifWait){
			this.ifWait=false;
			console.log("map roll Over2 ------------->");
			this._openUI();
		}
	}

	__proto.lvOver=function(){
		if(this.ifWait){
			console.log("武将升级解锁---》1");
			Laya.timer.once(1000,this,this.lvOverCB);
		}
	}

	__proto.lvOverCB=function(){
		this.ifWait=false;
		console.log("武将升级解锁---》2");
		Dialog.manager.lock(false);
		this._openUI();
	}

	__proto._openUI=function(){
		if(this.sysGuideData !=null){
			this.sysGuideData.printKey();
			this.closeUI();
			this.curUI=this.showUI(this.sysGuideData.uiType);
			this.curUI.setData(this.sysGuideData);
			this.beforUI=this.curUI;
			}else{
			this.closeUI();
		}
	}

	__proto.openUI=function(data){
		console.log("[guide] openUI() --------1");
		if(this.ifReload)return;
		if(data==null){
			this.closeUI();
			return;
		}
		if(data.unlockWait==1){
			console.log("[guide] openUI() --------2");
			this.closeUI();
			this.ifWait=true;
			if(data.guideId==3 && data.guideStep==9){
				var cityId=parseInt(data.button);
				App.eventManager.event("MAPROLL",[cityId]);
				}else if(data.guideId==19 && data.guideStep==9){
				Dialog.manager.setLockView(null);
				Dialog.manager.lock(true);
				console.log("武将升级加锁");
				Laya.timer.once(1000,this,this.lvOverCB);
			}
			console.log("map roll Over1 ------------->");
			}else{
			console.log("[guide] openUI() --------3");
			this._openUI();
		}
	}

	__proto.checkCity1001=function(curstep){
		var result=null;
		var citydata=this.mapCitySession.getCity(1001);
		if(curstep==4){
			if(citydata.playerId==this.mainPlayerSession.mainPlayerData.playerId){
				result=SysGuide.getStepSysGuide(6);
			}
			else if(citydata.battleFileUrl.length > 0){
				result=SysGuide.getStepSysGuide(6);
			}
			else{
				result=SysGuide.getNextStep(this.sysGuideData);
			}
			}else if(curstep==11){
			if(citydata.playerId==this.mainPlayerSession.mainPlayerData.playerId){
				this.closeOtherPanelBeforOpenUI();
				result=SysGuide.getStepSysGuide(12);
			}
			else{
				result=SysGuide.getNextStep(this.sysGuideData);
			}
		}
		return result;
	}

	__proto.checkCity2002=function(curstep){
		var result=null;
		var citydata=this.mapCitySession.getCity(2002);
		if(curstep==17){
			if(citydata.playerId==this.mainPlayerSession.mainPlayerData.playerId){
				result=SysGuide.getStepSysGuide(19);
			}
			else if(citydata.battleFileUrl.length > 0){
				result=SysGuide.getStepSysGuide(19);
				}else{
				result=SysGuide.getNextStep(this.sysGuideData);
			}
			}else if(curstep==19){
			if(citydata.playerId==this.mainPlayerSession.mainPlayerData.playerId){
				this.closeOtherPanelBeforOpenUI();
				result=SysGuide.getStepSysGuide(20);
				}else{
				result=SysGuide.getNextStep(this.sysGuideData);
			}
		}
		return result;
	}

	__proto.checkData=function(){
		if(this.ifReload)return;
		if(this.sysGuideData==null){
			var curstep=SysGuide.getCurstep();
			console.log("[guide] checkData() --------1");
			if(curstep==4){
				this.sysGuideData=this.checkCity1001(curstep);
				}else if(curstep==11){
				this.sysGuideData=this.checkCity1001(curstep);
				}else if(curstep==17){
				this.sysGuideData=this.checkCity2002(curstep);
				}else if(curstep==19){
				this.sysGuideData=this.checkCity2002(curstep);
				}else{
				this.sysGuideData=SysGuide.getNextStep(this.sysGuideData);
				if(curstep==1){
					App.eventManager.event("ADD_GUIDE_FIRE",[2002]);
				}
			}
			if(this.sysGuideData !=null){
				this.closeOtherPanelBeforOpenUI();
			}
			}else{
			console.log("[guide] checkData() --------2");
			if(this.sysGuideData.guideId==4 && this.sysGuideData.guideStep==9){
				this.sysGuideData=this.checkCity1001(4);
			}else
			if(this.sysGuideData.guideId==11 && this.sysGuideData.guideStep==4){
				this.sysGuideData=this.checkCity1001(11);
			}
			else if(this.sysGuideData.guideId==17 && this.sysGuideData.guideStep==10){
				this.sysGuideData=this.checkCity2002(17);
			}
			else if(this.sysGuideData.guideId==19 && this.sysGuideData.guideStep==9){
				this.sysGuideData=this.checkCity2002(19);
			}
			else{
				this.sysGuideData=SysGuide.getNextStep(this.sysGuideData);
			}
		}
		console.log("[guide] checkData() --------3");
		this.openUI(this.sysGuideData);
	}

	__proto.nextStep=function(){
		if(this.LOCK){
			console.log("当前锁定新手引导！");
			return;
		}
		this.check();
	}

	//保存新功能开启步骤
	__proto.sendUnlockKey=function(sysguide){
		if(sysguide !=null && sysguide.unlockStep==1){
			var key=sysguide.guideId+"_"+sysguide.guideStep;
			this.guideAction.sendUnlockKey(key);
		}
	}

	//保存关键步
	__proto.sendGuideStep=function(sysguide){
		if(sysguide!=null && sysguide.keyStep==1){
			console.log("发送保存关键步 step = "+sysguide.guideId);
			this.guideAction.sendGuideStep(sysguide.guideId);
			if(sysguide.guideId !=3)
				huamao.guide.GuideMain.addUILoading();
		}
	}

	__proto.openDialog=function(_dialog){
		if(GuideMain.stopGuide)return;
		if(this.initOver)return;
		if(!this.mainPlayerSession.checkIfInGuide()){
			return;
		}
		if(GuideMain.needWaitDialog){
			console.log("get needWaitDialog is true");
			}else{
			console.log("get needWaitDialog is false");
		}
		if(GuideMain.needWaitDialog){
			this.checkData();
		}
	}

	GuideMain.getMe=function(){
		if(null==GuideMain.me){
			GuideMain.me=new GuideMain();
		}
		return GuideMain.me;
	}

	GuideMain.MainCheck=function(){
		if(GuideMain.guideUI && GuideMain.guideData){
			huamao.guide.GuideMain.getMe().check();
		}
	}

	GuideMain.addUILoading=function(){
		console.log("添加遮罩 ----------》");
		huamao.guide.GuideMain.uiloading=new UiLoading(0,0,Laya.stage.width,Laya.stage.height);
		App.layerManager.guideLayer.addChild(huamao.guide.GuideMain.uiloading);
		huamao.guide.GuideMain.getMe().removeClickLis();
	}

	GuideMain.removeUILoading=function(){
		if(huamao.guide.GuideMain.uiloading !=null){
			console.log("移除遮罩 ----------》");
			App.layerManager.guideLayer.removeChild(huamao.guide.GuideMain.uiloading);
			huamao.guide.GuideMain.uiloading=null;
			huamao.guide.GuideMain.getMe().addClickLis();
		}
	}

	GuideMain.getHtmlStr=function(content){
		var result="";
		var contentAry=content.split("|");
		var color;
		for(var i=0;i<contentAry.length;i++){
			(i%2==1)? (color=GuideMain.splColor):(color=GuideMain.norColor);
			result+=TheGame.FONT(contentAry [i],color,GuideMain.fontSize,SysTalkData.font);
		}
		return result;
	}

	GuideMain.me=null;
	GuideMain.stopGuide=false;
	GuideMain.uiAlpha=0.0;
	GuideMain.guideUI=false;
	GuideMain.guideData=false;
	GuideMain.needWaitDialog=false;
	GuideMain.uiloading=null;
	GuideMain.norColor="#e5d3c0";
	GuideMain.splColor="#3dff00";
	GuideMain.fontSize=22;
	GuideMain.guideFontSize=24;
	return GuideMain;
})(StageSprite)


//class huamao.guide.ui.baseUI extends game.base.display.StageSprite
var baseUI=(function(_super){
	function baseUI(){
		baseUI.__super.call(this);
	}

	__class(baseUI,'huamao.guide.ui.baseUI',_super);
	var __proto=baseUI.prototype;
	__proto.setData=function(data){}
	__proto.uiClickCB=function(olddata){
		return true;
	}

	return baseUI;
})(StageSprite)


/**
*加载时的遮罩
*是黑屏 然后出现一个转圈的那个面板
*/
//class huamao.panel.LoadMask extends game.base.display.StageSprite
var LoadMask=(function(_super){
	function LoadMask(){
		this.img=null;
		LoadMask.__super.call(this);
		var blackSprite=new BlackSprite();
		this.addChild(blackSprite);
		this.img=new Image("res/load/load.png");
		this.img.anchorX=this.img.anchorY=0.5;
		this.img.centerX=this.img.centerY=0;
		this.addChild(this.img);
		this.on("display",this,this._$4_disFun);
		this.on("undisplay",this,this.unDisFun);
	}

	__class(LoadMask,'huamao.panel.LoadMask',_super);
	var __proto=LoadMask.prototype;
	__proto.unDisFun=function(){
		Laya.timer.clear(this,this.efFun);
	}

	__proto._$4_disFun=function(){
		Laya.timer.frameLoop(1,this,this.efFun);
	}

	__proto.efFun=function(){
		this.img.rotation+=5;
	}

	__proto.autoClose=function(time){
		(time===void 0)&& (time=0);
		if(time > 0){
			Laya.timer.once(time,this,this.autoCloseFun);
		}
	}

	__proto.clear=function(){
		Laya.timer.clear(this,this.autoCloseFun);
	}

	__proto.autoCloseFun=function(){
		huamao.panel.LoadMask.close();
	}

	LoadMask.getInstance=function(){
		if(LoadMask.instance==null){
			LoadMask.instance=new LoadMask();
		}
		return LoadMask.instance;
	}

	LoadMask.show=function(time){
		(time===void 0)&& (time=0);
		var loadMask=LoadMask.getInstance();
		Laya.stage.addChild(loadMask);
		MouseManager.enabled=false;
		loadMask.autoClose(time);
	}

	LoadMask.close=function(){
		LoadMask.getInstance().removeSelf();
		LoadMask.getInstance().clear();
		MouseManager.enabled=true;
	}

	LoadMask.instance=null;
	return LoadMask;
})(StageSprite)


//class MainScene extends game.base.Scene
var MainScene=(function(_super){
	function MainScene(){
		this._content=null;
		this._mapCity=null;
		this._homePage=null;
		this._cityInner=null;
		this.mapCitySession=null;
		this.mapCityAction=null;
		this.talkAction=null;
		this.mainPlayerSession=null;
		this.mainui=null;
		this._xingjunFace=null;
		this._weixianFace=null;
		this._smallMap=null;
		this.openFunctionSession=null;
		this.smallTaskView=null;
		this.guideSession=null;
		this.guideAction=null;
		this._isInit=false;
		this.mainUIStat=null;
		this.mainUi=null;
		this.drObj={};
		this.strTip="";
		this.mc=null;
		this.icon_dl=null;
		MainScene.__super.call(this);
		App.injOne(this);
		MainScene.instance=this;
		this.disFun();
		this.on("RE_DISPLAY",this,this.disFun);
		this.onAssetsLoaded();
		this.on("display",this,this.onDisFun);
		GameUtils.btnChange();
	}

	__class(MainScene,'MainScene',_super);
	var __proto=MainScene.prototype;
	__proto.onDisFun=function(){
		App.eventManager.event("MAINSCENEOVER");
	}

	__proto.disFun=function(){
		App.voiceManager.playMusic("bgm2.mp3");
	}

	__proto._$4_progressFun=function(value){
		var loadResData=new LoadResData();
		loadResData.value=value;
		loadResData.text1="正在加载...";
		loadResData.text2="";
		App.eventManager.event("LOAD_RES",loadResData);
	}

	__proto.onAssetsLoaded=function(){
		this._isInit=true;
		var ab=Laya.loader.getRes("testMap/"+10000+".map");
		var bytes=new ByteArray();
		bytes.writeArrayBuffer(ab);
		bytes.position=0;
		bytes.uncompress();
		var mapId2=bytes.readInt();
		var mapWidth=bytes.readInt();
		var mapHeight=bytes.readInt();
		GameMap.mapWidth=mapWidth;
		GameMap.mapHeight=mapHeight;
		GameMap.cellWidth=bytes.readInt();
		GameMap.cellHeight=bytes.readInt();
		var cityNum=bytes.readInt();
		for(var i=0;i < cityNum;i++){
			var cityId=bytes.readInt();
			bytes.readInt();
			bytes.readUTF();
			var cityX=bytes.readInt();
			var cityY=bytes.readInt();
			this.mapCitySession.mapPosObj[cityId]=[cityX,cityY];
		}
		this.start();
	}

	__proto.ifVisibleMainUI=function(tt){
		if(this.mainui !=null){
			this.mainui.visible=tt;
		}
	}

	__proto.start=function(){
		this._content=new Box();
		this.addChild(this._content);
		if(this._cityInner==null){
			this._cityInner=new CityInner();
		}
		this.mainui=new iconUI();
		this.mainui.box_xx.cacheAs="bitmap";
		this.mainui.yincang.visible=false;
		this.mainUIStat=new MainUIStat(this.mainui);
		App.eventManager.on("HUO_DONG_NOT_READ",this,this.huodongChangeFun);
		App.eventManager.on("HUODONGUPDATA",this,this.shouChongFun);
		this.mainUi=new MainUI(this.mainui);
		this.mainui.clip0.autoPlay=false;
		this.mainui.clip0.visible=false;
		var redZm=new RedPoint(RedPointType.ZHAOMU,this.mainui.zhaomu);
		redZm.setPos(-20,20);
		var redJc=new RedPoint(RedPointType.JICE,this.mainui.jice);
		redJc.setPos(-20,20);
		var redXx=new RedPoint(RedPointType.GRXX,this.mainui.touxiang);
		redXx.setPos(115,10);
		var redHy=new RedPoint(RedPointType.HAOYOU,this.mainui.haoyou);
		redHy.setPos(-20,20);
		this.mainui.time_kz.text="";
		this.mainui.time_kz.on("click",this,this.touchtime_kz);
		this.mainui.wenhao.on("click",this,this.touchtime_kz);
		this.mainui.mouseThrough=true;
		this.mainui.box0.mouseThrough=this.mainui.box1.mouseThrough=this.mainui.box2.mouseThrough=this.mainui.box3.mouseThrough=true;
		this.mainui.xiuxi.right=0;
		this._xingjunFace=new XingjunFace();
		this.mainui.xingjun.addChild(this._xingjunFace);
		this.mainui.xingjun.on("click",this,this.onXingjunList);
		this._weixianFace=new WeixianFace();
		this.mainui.addChild(this._weixianFace);
		this._smallMap=new SmallMap(this.mainui.box_map.width,this.mainui.box_map.height);
		this.smallTaskView=new SmallTaskView(this.mainui.renwu,this.mainui.clip0,this.mainui);
		App.eventManager.on("FLUSH_PLAYER_NAME",this,this.updatePlayerName);
		this.regClickDialog(this.mainui.zhaomu,"DIALOG_ZHAO_MU",true);
		this.regClickDialog(this.mainui.shangdian,"DIALOG_SHOP",true);
		this.regClickDialog(this.mainui.jice,"DIALOG_STRATAGEM",true);
		this.regClickDialog(this.mainui.wujiang,"WUJIANG",true);
		this.regClickDialog(this.mainui.beibao,"DIALOG_BAG",true);
		this.regClickDialog(this.mainui.waijiao,"WAIJIAO",true);
		this.regClickDialog(this.mainui.haoyou,"HAOYOU",true);
		this.regClickDialog(this.mainui.huodong,"HUODONG",true);
		this.regClickDialog(this.mainui.jia,"RECHARGEPANEL",true);
		this.regClickDialog(this.mainui.paihang,"RANKLIST",true);
		this.regClickDialog(this.mainui.shezhi,"SETTING",true);
		this.regClickDialog(this.mainui.shoushou,"SHOUCHONG",true);
		this.regClickDialog(this.mainui.xiangou,"XIANGOU",true);
		this.regClickDialog(this.mainui.huiyuan,"VIPPANEL",true);
		this.regClickDialog(this.mainui.meiri,"MEIRIPANEL",true);
		this.mainui.jin.mouseEnabled=true;
		this.mainui.xiaoyuanbao.on("click",this,this.openChongzhi);
		this.mainui.jin.on("click",this,this.openChongzhi);
		this.mainui.chengchi.on("click",this,this.requestCityList);
		this.mainui.zhanbao.on("click",this,this.showZhanbaoList);
		this.mainui.ditu.on("click",this,this.showWorldMap);
		this.mainui.qBox0.on("click",this,this.onSendChanliang);
		this.mainui.qBox1.visible=false;
		this.mainui.fanhui.on("click",this,this.onExitCity);
		this.mainui.fanhui3.on("click",this,this.clearChuzhengType);
		this.mainui.xinxi.on("click",this,this.goToMessageCB);
		App.eventManager.on("GOTO_HOMEPAGE",this,this.gotoHomePage);
		App.eventManager.on("GOTO_MAPCITY",this,this.gotoMapCity);
		App.eventManager.on("GOTO_CITY_INNER",this,this.gotoCityInner);
		App.eventManager.on("JINRUCHENGNEI",this,this.jinruCityInner);
		App.eventManager.on("SELECT_CHUZHENG_CITY",this,this.selectChuzhengCity);
		App.eventManager.on("BINGLI_YUNSHU",this,this.yunshuBingli);
		App.eventManager.on("UPDATE_XINGJUN_LIST",this,this.updateActions);
		App.eventManager.on("WEIXIAN_UPDATE",this,this.updateWeixian);
		App.eventManager.on("DELETE_XINGJUN_ITEM",this,this.deleteAction);
		App.eventManager.on("FLUSH_PLAYER_GOLD",this,this.flushGold);
		App.eventManager.on("FLUSH_PLAYER_SILVER",this,this.flushSilver);
		App.eventManager.on("CANCLE_CHUZHENG",this,this.clearChuzhengType);
		App.eventManager.on("UPDATE_QIAN_LIANG",this,this.updateQianLiang);
		App.eventManager.on("UPDATE_TIME",this,this.updateTime);
		App.eventManager.on("SHOW_CHANLIANG",this,this.showChanliang);
		App.eventManager.on("DELETE_LINE",this,this.deleteLine);
		App.eventManager.on("SET_SMALL_MAP",this,this.setSmallMap);
		App.eventManager.on("GAME_OVER",this,this.gotoGameOver);
		App.eventManager.on("FLUSH_PLAYER_LV",this,this.updataLv);
		App.eventManager.on("FLUSH_PLAYER_STYLE",this,this.updataStyle);
		App.eventManager.on("REMOVEDROPGIFT",this,this.removeDropDia);
		App.eventManager.on("VIEWDROPGIFT",this,this.openDropGift);
		this.updateWeixian();
		this.updateActions();
		this.updatePlayerName();
		console.log("来这看看");
		if(this.mapCitySession.isGoMapCity!=-1){
			if(this.mapCitySession.isGoMapCity==1){
				this.toMapCity();
				}else{
				this.gotoHomePage();
			}
		}
		if(this.mapCitySession.gameOverData !=null){
			console.log("进入主城");
			this.gotoGameOver();
		}
		this.updataLv();
		this.flushGold();
		this.flushSilver();
		this.updateTime(this.mapCitySession.getNowTime());
		this.setXingjunFace();
		this.updataStyle();
		this.openDropGift();
		this.setResizeUI(this.mainui.box0);
		this.setResizeUI(this.mainui.box1);
		this.setResizeUI(this.mainui.box2);
		this.setResizeUI(this.mainui.box3);
		this.setResizeUI(this.mainui);
		MainUIControl.getMe().setUI(this.mainui.lt,this.mainui.lt_d,this.mainui.tiaot,null);
		App.eventManager.on("ZHAN_BAO_NOT_READ",this,this.zhanBaoChangeFun);
		this.mapCitySession.checkZhanBao();
	}

	//App.dialogManager.openDialogByStr(Mypanel.TZHUANX,null,true,true);
	__proto.clickFun=function(){
		SDKManager.playVideo();
	}

	__proto.huodongChangeFun=function(boo){
		if(boo){
			this.addDragon(this.mainui.huohuo);
			}else{
			this.clearFun(this.mainui.huohuo);
		}
	}

	__proto.shouChongFun=function(){
		var activitySession=App.getSession("activitySession");
		var currData=activitySession.getTypeActivity(5);
		if(currData){
			if(currData.rewardStatus==1){
				this.addDragon(this.mainui.shouchong);
				}else{
				this.clearFun(this.mainui.shouchong);
			}
			}else{
			this.clearFun(this.mainui.shouchong);
		}
	}

	__proto.addDragon=function(btn){
		if(!this.drObj[btn.name]){
			var drMc=new DragonBonesMc(false);
			drMc.setUrl("res/load/zhanbaotexiao.sk");
			btn.addChild(drMc);
			drMc.pos(50,50);
			drMc.scale(1.5,1.5);
			this.drObj[btn.name]=drMc;
		}
	}

	__proto.clearFun=function(btn){
		var drMc=this.drObj[btn.name];
		if(drMc){
			drMc.removeSelf();
			drMc.destroy();
			drMc=null;
			delete this.drObj[btn.name];
		}
	}

	__proto.removeDropDia=function(){
		if(this.icon_dl){
			this.icon_dl.removeSelf();
			this.icon_dl=null;
			this.mapCityAction.isChuanZhiDrop=false;
		}
		console.log("掉落icon_dl："+this.icon_dl);
	}

	__proto.clickFun333=function(){
		App.eventManager.event("GUIDE_ENTER_FIGHT");
	}

	__proto.updatePlayerName=function(){
		this.mainui.txt0.text=this.mainPlayerSession.mainPlayerData.playerName;
	}

	__proto.touchtime_kz=function(){
		App.dialogManager.showMiniDialog(GameTipsView,true,true,false,false);
	}

	__proto.zhanBaoChangeFun=function(value){
		if(value==1){
			if(this.mc){
				this.mc.removeSelf();
				this.mc.destroy();
				this.mc=null;
			}
			this.mc=new DragonBonesMc(false);
			this.mc.setUrl("res/load/zhanbaotexiao.sk");
			this.mainui.zhanbao.addChild(this.mc);
			this.mc.pos(37,36);
			}else{
			if(this.mc){
				this.mc.removeSelf();
				this.mc=null;
			}
		}
	}

	/**
	*点击就打开某个面板 一般都会用到的功能
	*@param btn
	*@param panel
	*/
	__proto.regClickDialog=function(btn,panel,haveBlackMask){
		(haveBlackMask===void 0)&& (haveBlackMask=false);
		btn.clickHandler=new Handler(this,this._$4_openDialogFun,[panel,haveBlackMask]);
	}

	__proto._$4_openDialogFun=function(panel,haveBlackMask){
		(haveBlackMask===void 0)&& (haveBlackMask=false);
		App.dialogManager.openDialogByStr(panel,null,true,haveBlackMask);
	}

	__proto.openChongzhi=function(){
		App.dialogManager.openDialogByStr("RECHARGEPANEL",null,true,true);
	}

	__proto.openDropGift=function(){
		var data=this.mainPlayerSession.mainPlayerData;
		var isWeapon=false;
		if(this.mapCityAction.isChuanZhiDrop){
			if(data.job!=1001){
				if(!this.icon_dl){
					this.icon_dl=App.dialogManager.showMiniDialog(icon_dlUI);
					this.mainui.addChild(this.icon_dl);
					this.icon_dl.right=40;
					this.icon_dl.bottom=250;
					this.icon_dl.scale(0.8,0.8);
				};
				var itemImg=new Item();
				var item=(this.mapCityAction.chuanZhiDropArray[this.mapCityAction.chuanZhiDropArray.length-1]+"").split(",");
				for (var i=0;i < item.length/2;i++){
					if(item[i*2]<4000){
						itemImg.setItemId(parseInt(item[i*2]));
						isWeapon=true;
						break ;
					}
				}
				if(!isWeapon){
					itemImg.setItemId(parseInt(item[0]));
				}
				itemImg.size(this.icon_dl.box0.width,this.icon_dl.box0.height);
				this.icon_dl.box0.addChild(itemImg);
				this.icon_dl.on("click",this,this.clickDrop);
			}
		}
	}

	__proto.clickDrop=function(){
		App.dialogManager.openDialogByStr("DROPGIFT",null,true,true);
	}

	__proto.updataStyle=function(){
		var style=this.mainPlayerSession.mainPlayerData.style;
		this.mainui.touxiang.skin=GameUtils.getHeadUrl(style,true);
	}

	// mainui.touxiang.skin="comp/G/"+syslordbody.lordHeadSmall+".png";
	__proto.sheZhiFun=function(){
		if(Stat._show){
			Stat.hide();
			}else{
			Stat.show();
		}
	}

	__proto.onResize=function(){
		this.mainui.box3.width=Laya.stage.width;
	}

	__proto.gotoGameOver=function(){
		var offcial=this.mainPlayerSession.mainPlayerData.job;
		this.mainPlayerSession.jobJump=offcial;
		console.log("结算界面");
		if(GameState.state !=2){
			this.gotoMapCity();
		}
		Laya.timer.once(500,this,this.openOverFun);
	}

	__proto.openOverFun=function(){
		App.dialogManager.openDialogByStr("GAME_OVER",{data:this.mapCitySession.gameOverData},true,true);
	}

	__proto.goToMessageCB=function(){
		App.dialogManager.openDialogByStr("MYMESSAGE",null,true,true);
	}

	__proto.setSmallMap=function(){
		this._smallMap.updateCitys();
	}

	//请求城池列表
	__proto.requestCityList=function(){
		this.mapCityAction.sendCityList();
		App.dialogManager.openDialogByStr("CHENGCHI",null,true,true);
	}

	__proto.showZhanbaoList=function(){
		App.dialogManager.openDialogByStr("ZHANBAO",null,true,true);
	}

	__proto.showWorldMap=function(){
		App.dialogManager.openDialogByStr("WORLDMAP",null,true,true);
	}

	__proto.onSendChanliang=function(){
		if(this.mainui.qBox1.visible){
			return;
		}
		this.mapCityAction.onEveryHourZhanliang();
	}

	__proto.showChanliang=function(tongqian,liangcao){
		this.mainui.tong1.text=tongqian+"/小时";
		this.mainui.liang1.text=liangcao+"/小时";
		this.mainui.qBox1.visible=true;
		Laya.timer.once(5000,this,this.hideChanliang);
	}

	__proto.hideChanliang=function(){
		this.mainui.qBox1.visible=false;
	}

	__proto.updateTime=function(time){
		this.mainui.time_kz.text=time;
	}

	__proto.updateQianLiang=function(){
		this.mainui.tong.text=this.mapCitySession.getTongqian()+"";
		this.mainui.liang.text=this.mapCitySession.getLiangcao()+"";
	}

	__proto.onXingjunList=function(){
		App.dialogManager.openDialogByStr("XINGJUN_LIST",null,true,true);
	}

	//更新玩家等级
	__proto.updataLv=function(){
		var lv=this.mainPlayerSession.mainPlayerData.Lv;
		var shi=Math.floor(lv/10);
		var ge=lv%10;
		if(shi==0){
			shi=-1;
		}
		this.mainui.dengji.text=lv+"";
	}

	// this.mainui.ge.skin="comp/icon/dj_"+ge+".png";
	__proto.flushGold=function(){
		var gold=this.mainPlayerSession.mainPlayerData.gold
		this.mainui.jin.text=gold+"";
	}

	__proto.flushSilver=function(){
		var silver=this.mainPlayerSession.mainPlayerData.silver;
		this.mainui.yin.text=silver+"";
	}

	__proto.yunshuBingli=function(selectCityId){
		this.onExitCity();
		this.mainui.box0.visible=this.mainui.box1.visible=this.mainui.box2.visible=this.mainui.box3.visible=false;
		this.mainui.box3.visible=true;
		this._mapCity.setBingliYunshu(selectCityId);
		this.setGameStat(5);
	}

	__proto.selectChuzhengCity=function(selectCityId){
		this.onExitCity();
		this._mapCity.setCanChuzhengCitys(selectCityId);
		this.setGameStat(3);
	}

	__proto.onExitCity=function(){
		console.log("onExitCity ------------->");
		this.mapCityAction.onExitCityById(this.mapCitySession.innerCityId);
		this.gotoMapCity();
		this._cityInner.onHide();
		App.eventManager.event("EXIT_CITY_INNER2");
		if(SmallTaskView.isDiaoChanTip){
			App.eventManager.event("SENDDIAOCHANTIP");
		}
	}

	__proto.changeUI=function(view){
		this.mainui.xiuxi.visible=this.mainui.box0.visible=this.mainui.box1.visible=this.mainui.box2.visible=this.mainui.box3.visible=false;
		this.mainui.qian.x=350;
		if(view==this._homePage){
			this.mainui.box1.visible=true;
			this.mainui.ren.visible=true;
			this.mainui.xingjun.visible=false;
			this._weixianFace.visible=false;
			this.mainui.map.visible=false;
			this.mainui.box0.visible=true;
			this.mainui.box_xx.visible=true;
			this.mainui.waijiao.visible=false;
			this.mainui.qBox0.visible=this.mainui.qBox1.visible=false;
			if(this.mainui.parent==null){
				this.addChild(this.mainui);
			}
			this.setGameStat(1);
			if(this._weixianFace)this._weixianFace.clear();
		}
		else if(view==this._mapCity){
			this._mapCity.clearChuzhengType();
			this.mainui.box0.visible=true;
			this.mainui.qBox0.visible=true;
			this.mainui.qBox1.visible=false;
			this.mainui.box1.visible=true;
			this.mainui.ren.visible=true;
			this.mainui.xingjun.visible=true;
			this._weixianFace.visible=true;
			this.setXingjunFace();
			this.mainui.map.visible=true;
			if(this.mainPlayerSession.mainPlayerData.job!=1001){
				this.mainui.waijiao.visible=true;
				this.mainui.paihang.visible=true;
			}
			this.mainui.box_map.addChild(this._smallMap);
			this.setGameStat(2);
		}
		else if(view==this._cityInner){
			this.mainui.box0.visible=true;
			this.mainui.box_xx.visible=true;
			this.mainui.qBox0.visible=true;
			this.mainui.qBox1.visible=false;
			this.mainui.box2.visible=true;
			this.mainui.diming.text=(ConfigManager.getConfig("sys_city.txt",this.mapCitySession.innerCityId)).cityName;
			this.mainui.qian.x=524;
			this.setGameStat(4);
		}
		this.mainUi.upDataUpBtn();
		this.mainUi.upDataDownBtn();
		this.mainUi.upDateIconPosition();
	}

	__proto.gotoHomePage=function(){
		this._content.removeChildren();
		if(this._homePage==null){
			this._homePage=new HomePage();
		}
		this._homePage.x=-100;
		this._content.addChild(this._homePage);
		this._homePage.update();
		this.changeUI(this._homePage);
		Dialog.manager.closeAll();
		if(this.mainPlayerSession.jobJump==1002 && this.mainPlayerSession.mainPlayerData.Lv >=10){
			App.dialogManager.openDialogByStr("TZHUANX",null,true,true);
			console.log("Mypanel.TZHUANX-->");
		}
		console.log("回到休息室");
	}

	__proto.clearChuzhengType=function(){
		this.changeUI(this._mapCity);
		this.setGameStat(2);
	}

	__proto.gotoMapCity=function(){
		if(this.guideSession.getVedioIsEnd()){
			if(this.mainui.parent==null){
				this.addChild(this.mainui);
			}
			this._content.removeChildren();
			if(this._mapCity==null){
				this._mapCity=new MapCity();
			}
			this._content.addChild(this._mapCity);
			this.changeUI(this._mapCity);
			this.updateQianLiang();
			this._mapCity.updateCloud();
			this.setGameStat(2);
			App.eventManager.event("ENTERMAP");
		}
		else{
			this.guideSession.setVedio(1);
			this.guideAction.sendGuideVedio(1);
			App.eventManager.event("GOTO_MAPCITY");
			App.eventManager.event("OPENYUN",2002);
		}
	}

	//new VideoPanel();
	__proto.toMapCity=function(){
		if(this.guideSession.getVedioIsEnd()){
			this.gotoMapCity();
		}
		else{
			this.guideSession.setVedio(1);
			this.guideAction.sendGuideVedio(1);
			App.eventManager.event("GOTO_MAPCITY");
			App.eventManager.event("OPENYUN",2002);
		}
	}

	//new VideoPanel();
	__proto.updateActions=function(){
		this.setXingjunFace();
		if(this._xingjunFace)this._xingjunFace.updateAction();
		if(this._mapCity)this._mapCity.updateActions();
		if(this._weixianFace)this._weixianFace.update();
	}

	__proto.updateWeixian=function(){
		this._weixianFace.update();
	}

	__proto.setXingjunFace=function(){
		var dataList=this.mapCitySession.getActionList();
		this.mainui.xingjun.visible=dataList.length > 0;
	}

	__proto.deleteAction=function(actionId){
		this.setXingjunFace();
		this._xingjunFace.deleteAction(actionId);
		if(this._weixianFace)this._weixianFace.update();
	}

	__proto.deleteLine=function(actionId){
		this._mapCity.deleteAction(actionId);
	}

	__proto.jinruCityInner=function(cityId){
		this._content.removeChildren();
		this._content.addChild(this._cityInner);
		this._cityInner.addView();
		this.changeUI(this._cityInner);
	}

	__proto.gotoCityInner=function(cityId){
		this._cityInner.update();
		this.mainui.txt_0.text=this.mapCitySession.innerCityYubeiyi+"";
		this.mainui.txt_1.text=this.mapCitySession.innerYubeiyiOutput+"";
		this.mainui.txt_2.text=this.mapCitySession.innerTongqianOutput+"";
		this.mainui.txt_3.text=this.mapCitySession.innerFoodOutput+"";
		App.eventManager.event("GOTO_CITY_INNER2");
	}

	__proto.setGameStat=function(stat){
		GameState.state=stat;
		if(stat==3 || stat==4 || stat==2){
			this.mainUIStat.setStat(stat);
		}
	}

	MainScene.loadResFun=function(){
		var arr=[MyGameInit.RES("icon.atlas"),MyGameInit.RES("GG.atlas"),MyGameInit.RES("G.atlas"),MyGameInit.RES("npc.atlas"),MyGameInit.RES("town.atlas"),MyGameInit.RES("zhanbaolb.atlas")];
		var main=App.getSession("mainPlayerSession");
		if(main.checkIfInGuide()){
			arr.push(MyGameInit.RES("yun.atlas"));
		}
		arr.push({url:"testMap/"+10000+".map",type:"arraybuffer" });
		for(var i=0;i < 4;i++){
			for(var j=0;j < 3;j++){
				arr.push({url:"testMap/yasuo/"+10000+"_"+i+"_"+j+".jpg",type:"image" });
			}
		}
		return arr;
	}

	MainScene.addEffect=function(scence){
		App.layerManager.effectLayer.addChild(new scence());
	}

	MainScene.instance=null;
	return MainScene;
})(Scene)


//class huamao.utils.UnArea extends game.base.display.StageSprite
var UnArea=(function(_super){
	function UnArea(x,y,w,h){
		this.myx=0;
		this.myy=0;
		this.myw=0;
		this.myh=0;
		this.ary=[];
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		(w===void 0)&& (w=0);
		(h===void 0)&& (h=0);
		UnArea.__super.call(this);
		this.ary=[];
		for(var i=0;i<4;i++){
			var spr=new Sprite();
			spr.pos(0,0);
			this.ary[i]=spr
			this.addChild(this.ary[i]);
		}
		this.setSize(x,y,w,h);
	}

	__class(UnArea,'huamao.utils.UnArea',_super);
	var __proto=UnArea.prototype;
	__proto.setSize=function(x,y,w,h){
		this.myx=x;
		this.myy=y;
		this.myw=w;
		this.myh=h;
		this.printPoint(x,y,w,h);
		this.repain();
	}

	__proto.clearAll=function(){
		for(var i=0;i<this.ary.length;i++){
			var spr=this.ary [i];
			spr.graphics.clear();
		}
	}

	__proto.printPoint=function(x,y,w,h){
		console.log("x = "+x+"/y = "+y+"/w  = "+w+"/h = "+h);
	}

	__proto.repain=function(){
		if(this.ary !=null && this.ary.length > 0){
			this.clearAll();
			console.log("UnArea --> repain");
			var spr1=this.ary [0];
			var spr2=this.ary [1];
			var spr3=this.ary [2];
			var spr4=this.ary [3];
			var x=0;
			var y=0;
			var w=this.myx;
			var h=this.height;
			this.printPoint(x,y,w,h);
			spr1.alpha=0.6;
			spr1.graphics.drawRect(x,y,w,h,"#000000");
			x=this.myx+this.myw;
			y=0;
			w=this.width-this.myx-this.myw;
			h=this.height;
			this.printPoint(x,y,w,h);
			spr2.alpha=0.6;
			spr2.graphics.drawRect(x,y,w,h,"#000000");
			x=this.myx;
			y=0;
			w=this.myw;
			h=this.myy;
			this.printPoint(x,y,w,h);
			spr3.alpha=0.6;
			spr3.graphics.drawRect(x,y,w,h,"#000000");
			x=this.myx;
			y=this.myy+this.myh;
			w=this.myw;
			h=this.height-this.myy-this.myh;
			this.printPoint(x,y,w,h);
			spr4.alpha=0.6;
			spr4.graphics.drawRect(x,y,w,h,"#000000");
		}
	}

	__proto.resize=function(){
		this.repain();
	}

	return UnArea;
})(StageSprite)


//class scene.ProLoadScene extends laya.ui.Component
var ProLoadScene=(function(_super){
	function ProLoadScene(){
		this.image=null;
		this.la=null;
		this.num=0;
		ProLoadScene.__super.call(this);
		this.left=this.top=this.right=this.bottom=0;
		this.image=new Image("res/load/load.png");
		this.image.anchorX=this.image.anchorY=0.5;
		this.image.centerX=this.image.centerY=0;
		this.image.scale(1.4,1.4);
		this.addChild(this.image);
		this.la=new Label();
		this.la.anchorX=this.la.anchorY=0.5;
		this.la.centerX=this.la.centerY=0;
		this.addChild(this.la);
		this.la.color="#ffffff";
		this.on("display",this,this.disFun);
		this.on("undisplay",this,this.unDisFun);
		this.timerFun();
	}

	__class(ProLoadScene,'scene.ProLoadScene',_super);
	var __proto=ProLoadScene.prototype;
	__proto.unDisFun=function(){
		Laya.timer.clear(this,this.efFun);
		Laya.timer.clear(this,this.timerFun);
	}

	__proto.disFun=function(){
		Laya.timer.frameLoop(1,this,this.efFun);
		Laya.timer.loop(10000,this,this.timerFun);
	}

	__proto.timerFun=function(){
		this.la.text=(++this.num+"%");
	}

	__proto.efFun=function(){
		this.image.rotation+=5;
	}

	ProLoadScene.show=function(){
		if(ProLoadScene.proLoadScene==null){
			ProLoadScene.proLoadScene=new ProLoadScene();
		}
		Laya.stage.addChild(ProLoadScene.proLoadScene);
	}

	ProLoadScene.close=function(){
		ProLoadScene.proLoadScene.removeSelf();
	}

	ProLoadScene.proLoadScene=null;
	return ProLoadScene;
})(Component)


/**
*自动根据大小填充自己全部区域的显示对象
*@author ww
*/
//class laya.debug.tools.resizer.AutoFillRec extends laya.ui.Component
var AutoFillRec=(function(_super){
	function AutoFillRec(type){
		this.type=0;
		this.preX=NaN;
		this.preY=NaN;
		AutoFillRec.__super.call(this);
	}

	__class(AutoFillRec,'laya.debug.tools.resizer.AutoFillRec',_super);
	var __proto=AutoFillRec.prototype;
	//super(type);
	__proto.changeSize=function(){
		_super.prototype.changeSize.call(this);
		var g=this.graphics;
		g.clear();
		g.drawRect(0,0,this.width,this.height,"#33c5f5");
	}

	__proto.record=function(){
		this.preX=this.x;
		this.preY=this.y;
	}

	__proto.getDx=function(){
		return this.x-this.preX;
	}

	__proto.getDy=function(){
		return this.y-this.preY;
	}

	return AutoFillRec;
})(Component)


/**鼠标提示管理类*/
//class laya.debug.tools.TipManagerForDebug extends laya.ui.Component
var TipManagerForDebug=(function(_super){
	function TipManagerForDebug(){
		this._tipBox=null;
		this._tipText=null;
		this._defaultTipHandler=null;
		TipManagerForDebug.__super.call(this);
		this._tipBox=new Component();
		this._tipBox.addChild(this._tipText=new Text());
		this._tipText.x=this._tipText.y=5;
		this._tipText.color=TipManagerForDebug.tipTextColor;
		this._defaultTipHandler=this.showDefaultTip;
		Laya.stage.on("showtip",this,this.onStageShowTip);
		Laya.stage.on("hidetip",this,this.onStageHideTip);
	}

	__class(TipManagerForDebug,'laya.debug.tools.TipManagerForDebug',_super);
	var __proto=TipManagerForDebug.prototype;
	__proto.onStageHideTip=function(e){
		Laya.timer.clear(this,this.showTip);
		this.closeAll();
		this.removeSelf();
	}

	__proto.onStageShowTip=function(data){
		Laya.timer.once(TipManagerForDebug.tipDelay,this,this.showTip,[data],true);
	}

	__proto.showTip=function(tip){
		if ((typeof tip=='string')){
			var text=String(tip);
			if (Boolean(text)){
				this._defaultTipHandler(text);
			}
			}else if ((tip instanceof laya.utils.Handler )){
			(tip).run();
			}else if ((typeof tip=='function')){
			(tip).apply();
		}
		if (true){
			Laya.stage.on("mousemove",this,this.onStageMouseMove);
			Laya.stage.on("mousedown",this,this.onStageMouseDown);
		}
		this.onStageMouseMove(null);
	}

	__proto.onStageMouseDown=function(e){
		this.closeAll();
	}

	__proto.onStageMouseMove=function(e){
		this.showToStage(this,TipManagerForDebug.offsetX,TipManagerForDebug.offsetY);
	}

	__proto.showToStage=function(dis,offX,offY){
		(offX===void 0)&& (offX=0);
		(offY===void 0)&& (offY=0);
		var rec=dis.getBounds();
		dis.x=Laya.stage.mouseX+offX;
		dis.y=Laya.stage.mouseY+offY;
		if (dis.x+rec.width > Laya.stage.width){
			dis.x-=rec.width+offX;
		}
		if (dis.y+rec.height > Laya.stage.height){
			dis.y-=rec.height+offY;
		}
	}

	/**关闭所有鼠标提示*/
	__proto.closeAll=function(){
		Laya.timer.clear(this,this.showTip);
		Laya.stage.off("mousemove",this,this.onStageMouseMove);
		Laya.stage.off("mousedown",this,this.onStageMouseDown);
		this.removeChildren();
	}

	__proto.showDisTip=function(tip){
		this.addChild(tip);
		this.showToStage(this);
		Laya.stage.addChild(this);
	}

	__proto.showDefaultTip=function(text){
		this._tipText.text=text;
		var g=this._tipBox.graphics;
		g.clear();
		g.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,TipManagerForDebug.tipBackColor);
		this.addChild(this._tipBox);
		this.showToStage(this);
		Laya.stage.addChild(this);
	}

	/**默认鼠标提示函数*/
	__getset(0,__proto,'defaultTipHandler',function(){
		return this._defaultTipHandler;
		},function(value){
		this._defaultTipHandler=value;
	});

	TipManagerForDebug.offsetX=10;
	TipManagerForDebug.offsetY=15;
	TipManagerForDebug.tipTextColor="#ffffff";
	TipManagerForDebug.tipBackColor="#111111";
	TipManagerForDebug.tipDelay=200;
	return TipManagerForDebug;
})(Component)


/**
*<code>Button</code> 组件用来表示常用的多态按钮。 <code>Button</code> 组件可显示文本标签、图标或同时显示两者。 *
*<p>可以是单态，两态和三态，默认三态(up,over,down)。</p>
*
*@example <caption>以下示例代码，创建了一个 <code>Button</code> 实例。</caption>
*package
*{
	*import laya.ui.Button;
	*import laya.utils.Handler;
	*public class Button_Example
	*{
		*public function Button_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load("resource/ui/button.png",Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*trace("资源加载完成！");
			*var button:Button=new Button("resource/ui/button.png","label");//创建一个 Button 类的实例对象 button ,并传入它的皮肤。
			*button.x=100;//设置 button 对象的属性 x 的值，用于控制 button 对象的显示位置。
			*button.y=100;//设置 button 对象的属性 y 的值，用于控制 button 对象的显示位置。
			*button.clickHandler=new Handler(this,onClickButton,[button]);//设置 button 的点击事件处理器。
			*Laya.stage.addChild(button);//将此 button 对象添加到显示列表。
			*}
		*private function onClickButton(button:Button):void
		*{
			*trace("按钮button被点击了！");
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
*Laya.loader.load("resource/ui/button.png",laya.utils.Handler.create(this,loadComplete));//加载资源
*function loadComplete()
*{
	*console.log("资源加载完成！");
	*var button=new laya.ui.Button("resource/ui/button.png","label");//创建一个 Button 类的实例对象 button ,传入它的皮肤skin和标签label。
	*button.x=100;//设置 button 对象的属性 x 的值，用于控制 button 对象的显示位置。
	*button.y=100;//设置 button 对象的属性 y 的值，用于控制 button 对象的显示位置。
	*button.clickHandler=laya.utils.Handler.create(this,onClickButton,[button],false);//设置 button 的点击事件处理函数。
	*Laya.stage.addChild(button);//将此 button 对象添加到显示列表。
	*}
*function onClickButton(button)
*{
	*console.log("按钮被点击了。",button);
	*}
*@example
*import Button=laya.ui.Button;
*import Handler=laya.utils.Handler;
*class Button_Example{
	*constructor()
	*{
		*Laya.init(640,800);
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load("resource/ui/button.png",laya.utils.Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete()
	*{
		*var button:Button=new Button("resource/ui/button.png","label");//创建一个 Button 类的实例对象 button ,并传入它的皮肤。
		*button.x=100;//设置 button 对象的属性 x 的值，用于控制 button 对象的显示位置。
		*button.y=100;//设置 button 对象的属性 y 的值，用于控制 button 对象的显示位置。
		*button.clickHandler=new Handler(this,this.onClickButton,[button]);//设置 button 的点击事件处理器。
		*Laya.stage.addChild(button);//将此 button 对象添加到显示列表。
		*}
	*private onClickButton(button:Button):void
	*{
		*console.log("按钮button被点击了！")
		*}
	*}
*/
//class laya.ui.Button extends laya.ui.Component
var Button=(function(_super){
	function Button(skin,label){
		/**
		*指定按钮按下时是否是切换按钮的显示状态。
		*
		*@example 以下示例代码，创建了一个 <code>Button</code> 实例，并设置为切换按钮。
		*@example
		*package
		*{
			*import laya.ui.Button;
			*import laya.utils.Handler;
			*public class Button_toggle
			*{
				*public function Button_toggle()
				*{
					*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
					*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
					*Laya.loader.load("resource/ui/button.png",Handler.create(this,onLoadComplete));
					*}
				*private function onLoadComplete():void
				*{
					*trace("资源加载完成！");
					*var button:Button=new Button("resource/ui/button.png","label");//创建一个 Button 实例对象 button ,传入它的皮肤skin和标签label。
					*button.x=100;//设置 button 对象的属性 x 的值，用于控制 button 对象的显示位置。
					*button.y=100;//设置 button 对象的属性 y 的值，用于控制 button 对象的显示位置。
					*button.toggle=true;//设置 button 对象为切换按钮。
					*button.clickHandler=new Handler(this,onClickButton,[button]);//设置 button 的点击事件处理器。
					*Laya.stage.addChild(button);//将此 button 对象添加到显示列表。
					*}
				*private function onClickButton(button:Button):void
				*{
					*trace("button.selected = "+button.selected);
					*}
				*}
			*}
		*@example
		*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load("resource/ui/button.png",laya.utils.Handler.create(this,loadComplete));//加载资源
		*function loadComplete()
		*{
			*console.log("资源加载完成！");
			*var button=new laya.ui.Button("resource/ui/button.png","label");//创建一个 Button 类的实例对象 button ,传入它的皮肤skin和标签label。
			*button.x=100;//设置 button 对象的属性 x 的值，用于控制 button 对象的显示位置。
			*button.y=100;//设置 button 对象的属性 y 的值，用于控制 button 对象的显示位置。
			*button.toggle=true;//设置 button 对象为切换按钮。
			*button.clickHandler=laya.utils.Handler.create(this,onClickButton,[button],false);//设置 button 的点击事件处理器。
			*Laya.stage.addChild(button);//将此 button 对象添加到显示列表。
			*}
		*function onClickButton(button)
		*{
			*console.log("button.selected = ",button.selected);
			*}
		*@example
		*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load("button.png",null,null,null,null,null);//加载资源
		*function loadComplete(){
			*console.log("资源加载完成！");
			*var button:laya.ui.Button=new laya.ui.Button("button.png","label");//创建一个 Button 类的实例对象 button ,传入它的皮肤skin和标签label。
			*button.x=100;//设置 button 对象的属性 x 的值，用于控制 button 对象的显示位置。
			*button.y=100;//设置 button 对象的属性 y 的值，用于控制 button 对象的显示位置。
			*button.toggle=true;//设置 button 对象为切换按钮。
			*button.clickHandler=laya.utils.Handler.create(this,onClickButton,[button],false);//设置 button 的点击事件处理器。
			*Laya.stage.addChild(button);//将此 button 对象添加到显示列表。
			*}
		*function onClickButton(button){
			*console.log("button.selected = ",button.selected);
			*}
		*/
		this.toggle=false;
		/**
		*@private
		*/
		this._bitmap=null;
		/**
		*@private
		*按钮上的文本。
		*/
		this._text=null;
		/**
		*@private
		*按钮文本标签描边的颜色值。
		*/
		this._strokeColors=null;
		/**
		*@private
		*按钮的状态值。
		*/
		this._state=0;
		/**
		*@private
		*表示按钮的选中状态。
		*/
		this._selected=false;
		/**
		*@private
		*按钮的皮肤资源。
		*/
		this._skin=null;
		/**
		*@private
		*指定此显示对象是否自动计算并改变大小等属性。
		*/
		this._autoSize=true;
		/**
		*@private
		*源数据。
		*/
		this._sources=null;
		/**
		*@private
		*按钮的点击事件函数。
		*/
		this._clickHandler=null;
		/**
		*@private
		*/
		this._stateChanged=false;
		Button.__super.call(this);
		this._labelColors=Styles.buttonLabelColors;
		this._stateNum=Styles.buttonStateNum;
		(label===void 0)&& (label="");
		this.skin=skin;
		this.label=label;
	}

	__class(Button,'laya.ui.Button',_super);
	var __proto=Button.prototype;
	Laya.imps(__proto,{"laya.ui.ISelect":true})
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._bitmap && this._bitmap.destroy();
		this._text && this._text.destroy(destroyChild);
		this._bitmap=null;
		this._text=null;
		this._clickHandler=null;
		this._labelColors=this._sources=this._strokeColors=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.graphics=this._bitmap=new AutoBitmap();
	}

	/**@private */
	__proto.createText=function(){
		if (!this._text){
			this._text=new Text();
			this._text.overflow=Text.HIDDEN;
			this._text.align="center";
			this._text.valign="middle";
			this._text.width=this._width;
			this._text.height=this._height;
		}
	}

	/**@inheritDoc */
	__proto.initialize=function(){
		if (this._mouseEnableState!==1){
			this.mouseEnabled=true;
			this._setBit(0x2,true);
		}
		this._createListener("mouseover",this,this.onMouse,null,false,false);
		this._createListener("mouseout",this,this.onMouse,null,false,false);
		this._createListener("mousedown",this,this.onMouse,null,false,false);
		this._createListener("mouseup",this,this.onMouse,null,false,false);
		this._createListener("click",this,this.onMouse,null,false,false);
	}

	/**
	*对象的 <code>Event.MOUSE_OVER、Event.MOUSE_OUT、Event.MOUSE_DOWN、Event.MOUSE_UP、Event.CLICK</code> 事件侦听处理函数。
	*@param e Event 对象。
	*/
	__proto.onMouse=function(e){
		if (this.toggle===false && this._selected)return;
		if (e.type==="click"){
			this.toggle && (this.selected=!this._selected);
			this._clickHandler && this._clickHandler.run();
			return;
		}
		!this._selected && (this.state=Button.stateMap[e.type]);
	}

	/**
	*@private
	*对象的资源切片发生改变。
	*/
	__proto.changeClips=function(){
		var img=Loader.getRes(this._skin);
		if (!img){
			console.log("lose skin",this._skin);
			return;
		};
		var width=img.sourceWidth;
		var height=img.sourceHeight / this._stateNum;
		img.$_GID || (img.$_GID=Utils.getGID());
		var key=img.$_GID+"-"+this._stateNum;
		var clips=WeakObject.I.get(key);
		if (!Utils.isOkTextureList(clips)){
			clips=null;
		}
		if (clips)this._sources=clips;
		else {
			this._sources=[];
			if (this._stateNum===1){
				this._sources.push(img);
				}else {
				for (var i=0;i < this._stateNum;i++){
					this._sources.push(Texture.createFromTexture(img,0,height *i,width,height));
				}
			}
			WeakObject.I.set(key,this._sources);
		}
		if (this._autoSize){
			this._bitmap.width=this._width || width;
			this._bitmap.height=this._height || height;
			if (this._text){
				this._text.width=this._bitmap.width;
				this._text.height=this._bitmap.height;
			}
			}else {
			this._text && (this._text.x=width);
		}
	}

	/**
	*@private
	*改变对象的状态。
	*/
	__proto.changeState=function(){
		this._stateChanged=false;
		this.runCallLater(this.changeClips);
		var index=this._state < this._stateNum ? this._state :this._stateNum-1;
		this._sources && (this._bitmap.source=this._sources[index]);
		if (this.label){
			this._text.color=this._labelColors[index];
			if (this._strokeColors)this._text.strokeColor=this._strokeColors[index];
		}
	}

	/**@private */
	__proto._setStateChanged=function(){
		if (!this._stateChanged){
			this._stateChanged=true;
			this.callLater(this.changeState);
		}
	}

	/**
	*<p>描边颜色，以字符串表示。</p>
	*默认值为 "#000000"（黑色）;
	*@see laya.display.Text.strokeColor()
	*/
	__getset(0,__proto,'labelStrokeColor',function(){
		this.createText();
		return this._text.strokeColor;
		},function(value){
		this.createText();
		this._text.strokeColor=value
	});

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'measureHeight',function(){
		this.runCallLater(this.changeClips);
		return this._text ? Math.max(this._bitmap.height,this._text.height):this._bitmap.height;
	});

	/**
	*<p>对象的皮肤资源地址。</p>
	*支持单态，两态和三态，用 <code>stateNum</code> 属性设置
	*<p>对象的皮肤地址，以字符串表示。</p>
	*@see #stateNum
	*/
	__getset(0,__proto,'skin',function(){
		return this._skin;
		},function(value){
		if (this._skin !=value){
			this._skin=value;
			this.callLater(this.changeClips);
			this._setStateChanged();
		}
	});

	/**
	*对象的状态值。
	*@see #stateMap
	*/
	__getset(0,__proto,'state',function(){
		return this._state;
		},function(value){
		if (this._state !=value){
			this._state=value;
			this._setStateChanged();
		}
	});

	/**
	*按钮文本标签 <code>Text</code> 控件。
	*/
	__getset(0,__proto,'text',function(){
		this.createText();
		return this._text;
	});

	/**
	*<p>指定对象的状态值，以数字表示。</p>
	*<p>默认值为3。此值决定皮肤资源图片的切割方式。</p>
	*<p><b>取值：</b>
	*<li>1：单态。图片不做切割，按钮的皮肤状态只有一种。</li>
	*<li>2：两态。图片将以竖直方向被等比切割为2部分，从上向下，依次为
	*弹起状态皮肤、
	*按下和经过及选中状态皮肤。</li>
	*<li>3：三态。图片将以竖直方向被等比切割为3部分，从上向下，依次为
	*弹起状态皮肤、
	*经过状态皮肤、
	*按下和选中状态皮肤</li>
	*</p>
	*/
	__getset(0,__proto,'stateNum',function(){
		return this._stateNum;
		},function(value){
		if ((typeof value=='string')){
			value=parseInt(value);
		}
		if (this._stateNum !=value){
			this._stateNum=value < 1 ? 1 :value > 3 ? 3 :value;
			this.callLater(this.changeClips);
		}
	});

	/**
	*表示按钮各个状态下的描边颜色。
	*<p><b>格式:</b> "upColor,overColor,downColor,disableColor"。</p>
	*/
	__getset(0,__proto,'strokeColors',function(){
		return this._strokeColors ? this._strokeColors.join(","):"";
		},function(value){
		this._strokeColors=UIUtils.fillArray(Styles.buttonLabelColors,value,String);
		this._setStateChanged();
	});

	/**
	*表示按钮各个状态下的文本颜色。
	*<p><b>格式:</b> "upColor,overColor,downColor,disableColor"。</p>
	*/
	__getset(0,__proto,'labelColors',function(){
		return this._labelColors.join(",");
		},function(value){
		this._labelColors=UIUtils.fillArray(Styles.buttonLabelColors,value,String);
		this._setStateChanged();
	});

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'measureWidth',function(){
		this.runCallLater(this.changeClips);
		if (this._autoSize)return this._bitmap.width;
		this.runCallLater(this.changeState);
		return this._bitmap.width+(this._text ? this._text.width :0);
	});

	/**
	*按钮的文本内容。
	*/
	__getset(0,__proto,'label',function(){
		return this._text ? this._text.text :null;
		},function(value){
		if (!this._text && !value)return;
		this.createText();
		if (this._text.text !=value){
			value && !this._text.parent && this.addChild(this._text);
			this._text.text=(value+"").replace(/\\n/g,"\n");
			this._setStateChanged();
		}
	});

	/**
	*表示按钮的选中状态。
	*<p>如果值为true，表示该对象处于选中状态。否则该对象处于未选中状态。</p>
	*/
	__getset(0,__proto,'selected',function(){
		return this._selected;
		},function(value){
		if (this._selected !=value){
			this._selected=value;
			this.state=this._selected ? 2 :0;
			this.event("change");
		}
	});

	/**
	*表示按钮文本标签的边距。
	*<p><b>格式：</b>"上边距,右边距,下边距,左边距"。</p>
	*/
	__getset(0,__proto,'labelPadding',function(){
		this.createText();
		return this._text.padding.join(",");
		},function(value){
		this.createText();
		this._text.padding=UIUtils.fillArray(Styles.labelPadding,value,Number);
	});

	/**
	*表示按钮文本标签的字体大小。
	*@see laya.display.Text.fontSize()
	*/
	__getset(0,__proto,'labelSize',function(){
		this.createText();
		return this._text.fontSize;
		},function(value){
		this.createText();
		this._text.fontSize=value
	});

	/**
	*<p>描边宽度（以像素为单位）。</p>
	*默认值0，表示不描边。
	*@see laya.display.Text.stroke()
	*/
	__getset(0,__proto,'labelStroke',function(){
		this.createText();
		return this._text.stroke;
		},function(value){
		this.createText();
		this._text.stroke=value
	});

	/**
	*表示按钮文本标签是否为粗体字。
	*@see laya.display.Text.bold()
	*/
	__getset(0,__proto,'labelBold',function(){
		this.createText();
		return this._text.bold;
		},function(value){
		this.createText();
		this._text.bold=value;
	});

	/**
	*表示按钮文本标签的字体名称，以字符串形式表示。
	*@see laya.display.Text.font()
	*/
	__getset(0,__proto,'labelFont',function(){
		this.createText();
		return this._text.font;
		},function(value){
		this.createText();
		this._text.font=value;
	});

	/**标签对齐模式，默认为居中对齐。*/
	__getset(0,__proto,'labelAlign',function(){
		this.createText()
		return this._text.align;
		},function(value){
		this.createText()
		this._text.align=value;
	});

	/**
	*对象的点击事件处理器函数（无默认参数）。
	*/
	__getset(0,__proto,'clickHandler',function(){
		return this._clickHandler;
		},function(value){
		this._clickHandler=value;
	});

	/**
	*<p>当前实例的位图 <code>AutoImage</code> 实例的有效缩放网格数据。</p>
	*<p>数据格式："上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)"，以逗号分隔。
	*<ul><li>例如："4,4,4,4,1"</li></ul></p>
	*@see laya.ui.AutoBitmap.sizeGrid
	*/
	__getset(0,__proto,'sizeGrid',function(){
		if (this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");
		return null;
		},function(value){
		this._bitmap.sizeGrid=UIUtils.fillArray(Styles.defaultSizeGrid,value,Number);
	});

	/**@inheritDoc */
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Component,this,'width',value);
		if (this._autoSize){
			this._bitmap.width=value;
			this._text && (this._text.width=value);
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Component,this,'height',value);
		if (this._autoSize){
			this._bitmap.height=value;
			this._text && (this._text.height=value);
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if ((typeof value=='number')|| (typeof value=='string'))this.label=value+"";
		else Laya.superSet(Component,this,'dataSource',value);
	});

	/**图标x,y偏移，格式：100,100*/
	__getset(0,__proto,'iconOffset',function(){
		return this._bitmap._offset ? this._bitmap._offset.join(","):null;
		},function(value){
		if (value)this._bitmap._offset=UIUtils.fillArray([1,1],value,Number);
		else this._bitmap._offset=[];
	});

	__static(Button,
	['stateMap',function(){return this.stateMap={"mouseup":0,"mouseover":1,"mousedown":2,"mouseout":0};}
	]);
	return Button;
})(Component)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.UIViewBase extends laya.ui.Component
var UIViewBase=(function(_super){
	function UIViewBase(){
		this.minHandler=null;
		this.maxHandler=null;
		this.isFirstShow=true;
		this.dis=null;
		UIViewBase.__super.call(this);
		this.dis=this;
		this.minHandler=new Handler(this,this.close);
		this.maxHandler=new Handler(this,this.show);
		this.createPanel();
		if (this.dis){
			this.dis.on("mousedown",this,this.bringToTop);
			this.dis.cacheAsBitmap=true;
		}
	}

	__class(UIViewBase,'laya.debug.view.nodeInfo.views.UIViewBase',_super);
	var __proto=UIViewBase.prototype;
	__proto.show=function(){
		DebugInfoLayer.I.setTop();
		DebugInfoLayer.I.popLayer.addChild(this.dis);
		if (this.isFirstShow){
			this.firstShowFun();
			this.isFirstShow=false;
		}
	}

	__proto.firstShowFun=function(){
		this.dis.x=(Laya.stage.width-this.dis.width)*0.5;
		this.dis.y=(Laya.stage.height-this.dis.height)*0.5;
		DisControlTool.intFyDisPos(this.dis);
	}

	__proto.bringToTop=function(){
		DisControlTool.setTop(this.dis);
	}

	__proto.switchShow=function(){
		if (this.dis.parent){
			this.close();
			}else{
			this.show();
		}
	}

	__proto.close=function(){
		this.dis.removeSelf();
	}

	__proto.createPanel=function(){}
	__proto.getInput=function(){
		var input;
		input=new DInput();
		input.size(200,30);
		input.fontSize=30;
		return input;
	}

	__proto.getButton=function(){
		var btn;
		btn=new DButton();
		btn.size(40,30);
		btn.fontSize=30;
		return btn;
	}

	return UIViewBase;
})(Component)


/**
*<code>ColorPicker</code> 组件将显示包含多个颜色样本的列表，用户可以从中选择颜色。
*
*@example <caption>以下示例代码，创建了一个 <code>ColorPicker</code> 实例。</caption>
*package
*{
	*import laya.ui.ColorPicker;
	*import laya.utils.Handler;
	*public class ColorPicker_Example
	*{
		*public function ColorPicker_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load("resource/ui/color.png",Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*trace("资源加载完成！");
			*var colorPicket:ColorPicker=new ColorPicker();//创建一个 ColorPicker 类的实例对象 colorPicket 。
			*colorPicket.skin="resource/ui/color.png";//设置 colorPicket 的皮肤。
			*colorPicket.x=100;//设置 colorPicket 对象的属性 x 的值，用于控制 colorPicket 对象的显示位置。
			*colorPicket.y=100;//设置 colorPicket 对象的属性 y 的值，用于控制 colorPicket 对象的显示位置。
			*colorPicket.changeHandler=new Handler(this,onChangeColor,[colorPicket]);//设置 colorPicket 的颜色改变回调函数。
			*Laya.stage.addChild(colorPicket);//将此 colorPicket 对象添加到显示列表。
			*}
		*private function onChangeColor(colorPicket:ColorPicker):void
		*{
			*trace("当前选择的颜色： "+colorPicket.selectedColor);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*Laya.loader.load("resource/ui/color.png",laya.utils.Handler.create(this,loadComplete));//加载资源
*function loadComplete()
*{
	*console.log("资源加载完成！");
	*var colorPicket=new laya.ui.ColorPicker();//创建一个 ColorPicker 类的实例对象 colorPicket 。
	*colorPicket.skin="resource/ui/color.png";//设置 colorPicket 的皮肤。
	*colorPicket.x=100;//设置 colorPicket 对象的属性 x 的值，用于控制 colorPicket 对象的显示位置。
	*colorPicket.y=100;//设置 colorPicket 对象的属性 y 的值，用于控制 colorPicket 对象的显示位置。
	*colorPicket.changeHandler=laya.utils.Handler.create(this,onChangeColor,[colorPicket],false);//设置 colorPicket 的颜色改变回调函数。
	*Laya.stage.addChild(colorPicket);//将此 colorPicket 对象添加到显示列表。
	*}
*function onChangeColor(colorPicket)
*{
	*console.log("当前选择的颜色： "+colorPicket.selectedColor);
	*}
*@example
*import ColorPicker=laya.ui.ColorPicker;
*import Handler=laya.utils.Handler;
*class ColorPicker_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load("resource/ui/color.png",Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*console.log("资源加载完成！");
		*var colorPicket:ColorPicker=new ColorPicker();//创建一个 ColorPicker 类的实例对象 colorPicket 。
		*colorPicket.skin="resource/ui/color.png";//设置 colorPicket 的皮肤。
		*colorPicket.x=100;//设置 colorPicket 对象的属性 x 的值，用于控制 colorPicket 对象的显示位置。
		*colorPicket.y=100;//设置 colorPicket 对象的属性 y 的值，用于控制 colorPicket 对象的显示位置。
		*colorPicket.changeHandler=new Handler(this,this.onChangeColor,[colorPicket]);//设置 colorPicket 的颜色改变回调函数。
		*Laya.stage.addChild(colorPicket);//将此 colorPicket 对象添加到显示列表。
		*}
	*private onChangeColor(colorPicket:ColorPicker):void {
		*console.log("当前选择的颜色： "+colorPicket.selectedColor);
		*}
	*}
*/
//class laya.ui.ColorPicker extends laya.ui.Component
var ColorPicker=(function(_super){
	function ColorPicker(){
		/**
		*当颜色发生改变时执行的函数处理器。
		*默认返回参数color：颜色值字符串。
		*/
		this.changeHandler=null;
		/**
		*@private
		*指定每个正方形的颜色小格子的宽高（以像素为单位）。
		*/
		this._gridSize=11;
		/**
		*@private
		*表示颜色样本列表面板的背景颜色值。
		*/
		this._bgColor="#ffffff";
		/**
		*@private
		*表示颜色样本列表面板的边框颜色值。
		*/
		this._borderColor="#000000";
		/**
		*@private
		*表示颜色样本列表面板选择或输入的颜色值。
		*/
		this._inputColor="#000000";
		/**
		*@private
		*表示颜色输入框的背景颜色值。
		*/
		this._inputBgColor="#efefef";
		/**
		*@private
		*表示颜色样本列表面板。
		*/
		this._colorPanel=null;
		/**
		*@private
		*表示颜色网格。
		*/
		this._colorTiles=null;
		/**
		*@private
		*表示颜色块显示对象。
		*/
		this._colorBlock=null;
		/**
		*@private
		*表示颜色输入框控件 <code>Input</code> 。
		*/
		this._colorInput=null;
		/**
		*@private
		*表示点击后显示颜色样本列表面板的按钮控件 <code>Button</code> 。
		*/
		this._colorButton=null;
		/**
		*@private
		*表示颜色值列表。
		*/
		this._colors=[];
		/**
		*@private
		*表示选择的颜色值。
		*/
		this._selectedColor="#000000";
		/**@private */
		this._panelChanged=false;
		ColorPicker.__super.call(this);
	}

	__class(ColorPicker,'laya.ui.ColorPicker',_super);
	var __proto=ColorPicker.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._colorPanel && this._colorPanel.destroy(destroyChild);
		this._colorButton && this._colorButton.destroy(destroyChild);
		this._colorPanel=null;
		this._colorTiles=null;
		this._colorBlock=null;
		this._colorInput=null;
		this._colorButton=null;
		this._colors=null;
		this.changeHandler=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._colorButton=new Button());
		this._colorPanel=new Box();
		this._colorPanel.size(230,166);
		this._colorPanel.addChild(this._colorTiles=new Sprite());
		this._colorPanel.addChild(this._colorBlock=new Sprite());
		this._colorPanel.addChild(this._colorInput=new Input());
	}

	/**@inheritDoc */
	__proto.initialize=function(){
		this._colorButton.on("click",this,this.onColorButtonClick);
		this._colorBlock.pos(5,5);
		this._colorInput.pos(60,5);
		this._colorInput.size(60,20);
		this._colorInput.on("change",this,this.onColorInputChange);
		this._colorInput.on("keydown",this,this.onColorFieldKeyDown);
		this._colorTiles.pos(5,30);
		this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove);
		this._colorTiles.on("click",this,this.onColorTilesClick);
		this._colorTiles.size(20 *this._gridSize,12 *this._gridSize);
		this._colorPanel.on("mousedown",this,this.onPanelMouseDown);
		this.bgColor=this._bgColor;
	}

	__proto.onPanelMouseDown=function(e){
		e.stopPropagation();
	}

	/**
	*改变颜色样本列表面板。
	*/
	__proto.changePanel=function(){
		this._panelChanged=false;
		var g=this._colorPanel.graphics;
		g.clear();
		g.drawRect(0,0,230,166,this._bgColor,this._borderColor);
		this.drawBlock(this._selectedColor);
		this._colorInput.borderColor=this._borderColor;
		this._colorInput.bgColor=this._inputBgColor;
		this._colorInput.color=this._inputColor;
		g=this._colorTiles.graphics;
		g.clear();
		var mainColors=[0x000000,0x333333,0x666666,0x999999,0xCCCCCC,0xFFFFFF,0xFF0000,0x00FF00,0x0000FF,0xFFFF00,0x00FFFF,0xFF00FF];
		for (var i=0;i < 12;i++){
			for (var j=0;j < 20;j++){
				var color=0;
				if (j===0)color=mainColors[i];
				else if (j===1)color=0x000000;
				else color=(((i *3+j / 6)% 3 << 0)+((i / 6)<< 0)*3)*0x33 << 16 | j % 6 *0x33 << 8 | (i << 0)% 6 *0x33;
				var strColor=UIUtils.toColor(color);
				this._colors.push(strColor);
				var x=j *this._gridSize;
				var y=i *this._gridSize;
				g.drawRect(x,y,this._gridSize,this._gridSize,strColor,"#000000");
			}
		}
	}

	/**
	*颜色样本列表面板的显示按钮的 <code>Event.MOUSE_DOWN</code> 事件侦听处理函数。
	*/
	__proto.onColorButtonClick=function(e){
		if (this._colorPanel.parent)this.close();
		else this.open();
	}

	/**
	*打开颜色样本列表面板。
	*/
	__proto.open=function(){
		var p=this.localToGlobal(new Point());
		var px=p.x+this._colorPanel.width <=Laya.stage.width ? p.x :Laya.stage.width-this._colorPanel.width;
		var py=p.y+this._colorButton.height;
		py=py+this._colorPanel.height <=Laya.stage.height ? py :p.y-this._colorPanel.height;
		this._colorPanel.pos(px,py);
		this._colorPanel.zOrder=1001;
		Laya._currentStage.addChild(this._colorPanel);
		Laya.stage.on("mousedown",this,this.removeColorBox);
	}

	/**
	*关闭颜色样本列表面板。
	*/
	__proto.close=function(){
		Laya.stage.off("mousedown",this,this.removeColorBox);
		this._colorPanel.removeSelf();
	}

	/**
	*舞台的 <code>Event.MOUSE_DOWN</code> 事件侦听处理函数。
	*/
	__proto.removeColorBox=function(e){
		this.close();
	}

	/**
	*小格子色块的 <code>Event.KEY_DOWN</code> 事件侦听处理函数。
	*/
	__proto.onColorFieldKeyDown=function(e){
		if (e.keyCode==13){
			if (this._colorInput.text)this.selectedColor=this._colorInput.text;
			else this.selectedColor=null;
			this.close();
			e.stopPropagation();
		}
	}

	/**
	*颜色值输入框 <code>Event.CHANGE</code> 事件侦听处理函数。
	*/
	__proto.onColorInputChange=function(e){
		if (this._colorInput.text)this.drawBlock(this._colorInput.text);
		else this.drawBlock("#FFFFFF");
	}

	/**
	*小格子色块的 <code>Event.CLICK</code> 事件侦听处理函数。
	*/
	__proto.onColorTilesClick=function(e){
		this.selectedColor=this.getColorByMouse();
		this.close();
	}

	/**
	*@private
	*小格子色块的 <code>Event.MOUSE_MOVE</code> 事件侦听处理函数。
	*/
	__proto.onColorTilesMouseMove=function(e){
		this._colorInput.focus=false;
		var color=this.getColorByMouse();
		this._colorInput.text=color;
		this.drawBlock(color);
	}

	/**
	*通过鼠标位置取对应的颜色块的颜色值。
	*/
	__proto.getColorByMouse=function(){
		var point=this._colorTiles.getMousePoint();
		var x=Math.floor(point.x / this._gridSize);
		var y=Math.floor(point.y / this._gridSize);
		return this._colors[y *20+x];
	}

	/**
	*绘制颜色块。
	*@param color 需要绘制的颜色块的颜色值。
	*/
	__proto.drawBlock=function(color){
		var g=this._colorBlock.graphics;
		g.clear();
		var showColor=color ? color :"#ffffff";
		g.drawRect(0,0,50,20,showColor,this._borderColor);
		color || g.drawLine(0,0,50,20,"#ff0000");
	}

	/**
	*改变颜色。
	*/
	__proto.changeColor=function(){
		var g=this.graphics;
		g.clear();
		var showColor=this._selectedColor || "#000000";
		g.drawRect(0,0,this._colorButton.width,this._colorButton.height,showColor);
	}

	/**@private */
	__proto._setPanelChanged=function(){
		if (!this._panelChanged){
			this._panelChanged=true;
			this.callLater(this.changePanel);
		}
	}

	/**
	*表示颜色输入框的背景颜色值。
	*/
	__getset(0,__proto,'inputBgColor',function(){
		return this._inputBgColor;
		},function(value){
		this._inputBgColor=value;
		this._setPanelChanged();
	});

	/**
	*表示选择的颜色值。
	*/
	__getset(0,__proto,'selectedColor',function(){
		return this._selectedColor;
		},function(value){
		if (this._selectedColor !=value){
			this._selectedColor=this._colorInput.text=value;
			this.drawBlock(value);
			this.changeColor();
			this.changeHandler && this.changeHandler.runWith(this._selectedColor);
			this.event("change",Event.EMPTY.setTo("change",this,this));
		}
	});

	/**
	*@copy laya.ui.Button#skin
	*/
	__getset(0,__proto,'skin',function(){
		return this._colorButton.skin;
		},function(value){
		this._colorButton.skin=value;
		this.changeColor();
	});

	/**
	*表示颜色样本列表面板的背景颜色值。
	*/
	__getset(0,__proto,'bgColor',function(){
		return this._bgColor;
		},function(value){
		this._bgColor=value;
		this._setPanelChanged();
	});

	/**
	*表示颜色样本列表面板的边框颜色值。
	*/
	__getset(0,__proto,'borderColor',function(){
		return this._borderColor;
		},function(value){
		this._borderColor=value;
		this._setPanelChanged();
	});

	/**
	*表示颜色样本列表面板选择或输入的颜色值。
	*/
	__getset(0,__proto,'inputColor',function(){
		return this._inputColor;
		},function(value){
		this._inputColor=value;
		this._setPanelChanged();
	});

	return ColorPicker;
})(Component)


/**
*<code>ComboBox</code> 组件包含一个下拉列表，用户可以从该列表中选择单个值。
*
*@example <caption>以下示例代码，创建了一个 <code>ComboBox</code> 实例。</caption>
*package
*{
	*import laya.ui.ComboBox;
	*import laya.utils.Handler;
	*public class ComboBox_Example
	*{
		*public function ComboBox_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load("resource/ui/button.png",Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*trace("资源加载完成！");
			*var comboBox:ComboBox=new ComboBox("resource/ui/button.png","item0,item1,item2,item3,item4,item5");//创建一个 ComboBox 类的实例对象 comboBox ,传入它的皮肤和标签集。
			*comboBox.x=100;//设置 comboBox 对象的属性 x 的值，用于控制 comboBox 对象的显示位置。
			*comboBox.y=100;//设置 comboBox 对象的属性 x 的值，用于控制 comboBox 对象的显示位置。
			*comboBox.selectHandler=new Handler(this,onSelect);//设置 comboBox 选择项改变时执行的处理器。
			*Laya.stage.addChild(comboBox);//将此 comboBox 对象添加到显示列表。
			*}
		*private function onSelect(index:int):void
		*{
			*trace("当前选中的项对象索引： ",index);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高。
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
*Laya.loader.load("resource/ui/button.png",laya.utils.Handler.create(this,loadComplete));//加载资源
*function loadComplete(){
	*console.log("资源加载完成！");
	*var comboBox=new laya.ui.ComboBox("resource/ui/button.png","item0,item1,item2,item3,item4,item5");//创建一个 ComboBox 类的实例对象 comboBox ,传入它的皮肤和标签集。
	*comboBox.x=100;//设置 comboBox 对象的属性 x 的值，用于控制 comboBox 对象的显示位置。
	*comboBox.y=100;//设置 comboBox 对象的属性 x 的值，用于控制 comboBox 对象的显示位置。
	*comboBox.selectHandler=new laya.utils.Handler(this,onSelect);//设置 comboBox 选择项改变时执行的处理器。
	*Laya.stage.addChild(comboBox);//将此 comboBox 对象添加到显示列表。
	*}
*function onSelect(index)
*{
	*console.log("当前选中的项对象索引： ",index);
	*}
*@example
*import ComboBox=laya.ui.ComboBox;
*import Handler=laya.utils.Handler;
*class ComboBox_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load("resource/ui/button.png",Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*console.log("资源加载完成！");
		*var comboBox:ComboBox=new ComboBox("resource/ui/button.png","item0,item1,item2,item3,item4,item5");//创建一个 ComboBox 类的实例对象 comboBox ,传入它的皮肤和标签集。
		*comboBox.x=100;//设置 comboBox 对象的属性 x 的值，用于控制 comboBox 对象的显示位置。
		*comboBox.y=100;//设置 comboBox 对象的属性 x 的值，用于控制 comboBox 对象的显示位置。
		*comboBox.selectHandler=new Handler(this,this.onSelect);//设置 comboBox 选择项改变时执行的处理器。
		*Laya.stage.addChild(comboBox);//将此 comboBox 对象添加到显示列表。
		*}
	*private onSelect(index:number):void {
		*console.log("当前选中的项对象索引： ",index);
		*}
	*}
*
*/
//class laya.ui.ComboBox extends laya.ui.Component
var ComboBox=(function(_super){
	function ComboBox(skin,labels){
		/**@private */
		this._visibleNum=6;
		/**
		*@private
		*/
		this._button=null;
		/**
		*@private
		*/
		this._list=null;
		/**
		*@private
		*/
		this._isOpen=false;
		/**
		*@private
		*/
		this._itemSize=12;
		/**
		*@private
		*/
		this._labels=[];
		/**
		*@private
		*/
		this._selectedIndex=-1;
		/**
		*@private
		*/
		this._selectHandler=null;
		/**
		*@private
		*/
		this._itemHeight=NaN;
		/**
		*@private
		*/
		this._listHeight=NaN;
		/**
		*@private
		*/
		this._listChanged=false;
		/**
		*@private
		*/
		this._itemChanged=false;
		/**
		*@private
		*/
		this._scrollBarSkin=null;
		/**
		*@private
		*/
		this._isCustomList=false;
		/**
		*渲染项，用来显示下拉列表展示对象
		*/
		this.itemRender=null;
		ComboBox.__super.call(this);
		this._itemColors=Styles.comboBoxItemColors;
		this.skin=skin;
		this.labels=labels;
	}

	__class(ComboBox,'laya.ui.ComboBox',_super);
	var __proto=ComboBox.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._button && this._button.destroy(destroyChild);
		this._list && this._list.destroy(destroyChild);
		this._button=null;
		this._list=null;
		this._itemColors=null;
		this._labels=null;
		this._selectHandler=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._button=new Button());
		this._button.text.align="left";
		this._button.labelPadding="0,0,0,5";
		this._button.on("mousedown",this,this.onButtonMouseDown);
	}

	__proto._createList=function(){
		this._list=new List();
		if (this._scrollBarSkin)this._list.vScrollBarSkin=this._scrollBarSkin;
		this._setListEvent(this._list);
	}

	__proto._setListEvent=function(list){
		this._list.selectEnable=true;
		this._list.on("mousedown",this,this.onListDown);
		this._list.mouseHandler=Handler.create(this,this.onlistItemMouse,null,false);
		if (this._list.scrollBar)this._list.scrollBar.on("mousedown",this,this.onScrollBarDown);
	}

	/**
	*@private
	*/
	__proto.onListDown=function(e){
		e.stopPropagation();
	}

	__proto.onScrollBarDown=function(e){
		e.stopPropagation();
	}

	__proto.onButtonMouseDown=function(e){
		this.callLater(this.switchTo,[!this._isOpen]);
	}

	/**
	*@private
	*/
	__proto.changeList=function(){
		this._listChanged=false;
		var labelWidth=this.width-2;
		var labelColor=this._itemColors[2];
		this._itemHeight=this._itemSize+6;
		this._list.itemRender=this.itemRender || {type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:labelWidth,height:this._itemHeight,fontSize:this._itemSize,color:labelColor}}]};
		this._list.repeatY=this._visibleNum;
		this._list.refresh();
	}

	/**
	*@private
	*下拉列表的鼠标事件响应函数。
	*/
	__proto.onlistItemMouse=function(e,index){
		var type=e.type;
		if (type==="mouseover" || type==="mouseout"){
			if (this._isCustomList)return;
			var box=this._list.getCell(index);
			if (!box)return;
			var label=box.getChildByName("label");
			if (label){
				if (type==="mouseover"){
					label.bgColor=this._itemColors[0];
					label.color=this._itemColors[1];
					}else {
					label.bgColor=null;
					label.color=this._itemColors[2];
				}
			}
			}else if (type==="click"){
			this.selectedIndex=index;
			this.isOpen=false;
		}
	}

	/**
	*@private
	*/
	__proto.switchTo=function(value){
		this.isOpen=value;
	}

	/**
	*更改下拉列表的打开状态。
	*/
	__proto.changeOpen=function(){
		this.isOpen=!this._isOpen;
	}

	/**
	*更改下拉列表。
	*/
	__proto.changeItem=function(){
		this._itemChanged=false;
		this._listHeight=this._labels.length > 0 ? Math.min(this._visibleNum,this._labels.length)*this._itemHeight :this._itemHeight;
		if (!this._isCustomList){
			var g=this._list.graphics;
			g.clear();
			g.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3]);
		};
		var a=this._list.array || [];
		a.length=0;
		for (var i=0,n=this._labels.length;i < n;i++){
			a.push({label:this._labels[i]});
		}
		this._list.height=this._listHeight;
		this._list.array=a;
	}

	__proto.changeSelected=function(){
		this._button.label=this.selectedLabel;
	}

	__proto._onStageMouseWheel=function(e){
		if(!this._list||this._list.contains(e.target))return;
		this.removeList(null);
	}

	/**
	*关闭下拉列表。
	*/
	__proto.removeList=function(e){
		Laya.stage.off("mousedown",this,this.removeList);
		Laya.stage.off("mousewheel",this,this._onStageMouseWheel);
		this.isOpen=false;
	}

	/**
	*表示选择的下拉列表项的索引。
	*/
	__getset(0,__proto,'selectedIndex',function(){
		return this._selectedIndex;
		},function(value){
		if (this._selectedIndex !=value){
			this._selectedIndex=value;
			if (this._labels.length > 0)this.changeSelected();
			else this.callLater(this.changeSelected);
			this.event("change",[Event.EMPTY.setTo("change",this,this)]);
			this._selectHandler && this._selectHandler.runWith(this._selectedIndex);
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureHeight',function(){
		return this._button.height;
	});

	/**
	*@copy laya.ui.Button#skin
	*/
	__getset(0,__proto,'skin',function(){
		return this._button.skin;
		},function(value){
		if (this._button.skin !=value){
			this._button.skin=value;
			this._listChanged=true;
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureWidth',function(){
		return this._button.width;
	});

	/**@inheritDoc */
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Component,this,'width',value);
		this._button.width=this._width;
		this._itemChanged=true;
		this._listChanged=true;
	});

	/**
	*表示选择的下拉列表项的的标签。
	*/
	__getset(0,__proto,'selectedLabel',function(){
		return this._selectedIndex >-1 && this._selectedIndex < this._labels.length ? this._labels[this._selectedIndex] :null;
		},function(value){
		this.selectedIndex=this._labels.indexOf(value);
	});

	/**
	*标签集合字符串。
	*/
	__getset(0,__proto,'labels',function(){
		return this._labels.join(",");
		},function(value){
		if (this._labels.length > 0)this.selectedIndex=-1;
		if (value)this._labels=value.split(",");
		else this._labels.length=0;
		this._itemChanged=true;
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Component,this,'height',value);
		this._button.height=this._height;
	});

	/**
	*改变下拉列表的选择项时执行的处理器(默认返回参数index:int)。
	*/
	__getset(0,__proto,'selectHandler',function(){
		return this._selectHandler;
		},function(value){
		this._selectHandler=value;
	});

	/**
	*获取或设置没有滚动条的下拉列表中可显示的最大行数。
	*/
	__getset(0,__proto,'visibleNum',function(){
		return this._visibleNum;
		},function(value){
		this._visibleNum=value;
		this._listChanged=true;
	});

	/**
	*表示按钮文本标签是否为粗体字。
	*@see laya.display.Text#bold
	*/
	__getset(0,__proto,'labelBold',function(){
		return this._button.text.bold;
		},function(value){
		this._button.text.bold=value
	});

	/**
	*下拉列表项颜色。
	*<p><b>格式：</b>"悬停或被选中时背景颜色,悬停或被选中时标签颜色,标签颜色,边框颜色,背景颜色"</p>
	*/
	__getset(0,__proto,'itemColors',function(){
		return String(this._itemColors)
		},function(value){
		this._itemColors=UIUtils.fillArray(this._itemColors,value,String);
		this._listChanged=true;
	});

	/**
	*下拉列表项标签的字体大小。
	*/
	__getset(0,__proto,'itemSize',function(){
		return this._itemSize;
		},function(value){
		this._itemSize=value;
		this._listChanged=true;
	});

	/**
	*获取对 <code>ComboBox</code> 组件所包含的 <code>VScrollBar</code> 滚动条组件的引用。
	*/
	__getset(0,__proto,'scrollBar',function(){
		return this.list.scrollBar;
	});

	/**
	*表示下拉列表的打开状态。
	*/
	__getset(0,__proto,'isOpen',function(){
		return this._isOpen;
		},function(value){
		if (this._isOpen !=value){
			this._isOpen=value;
			this._button.selected=this._isOpen;
			if (this._isOpen){
				this._list || this._createList();
				this._listChanged && !this._isCustomList && this.changeList();
				this._itemChanged && this.changeItem();
				var p=this.localToGlobal(Point.TEMP.setTo(0,0));
				var py=p.y+this._button.height;
				py=py+this._listHeight <=Laya.stage.height ? py :p.y-this._listHeight;
				this._list.pos(p.x,py);
				this._list.zOrder=1001;
				Laya._currentStage.addChild(this._list);
				Laya.stage.once("mousedown",this,this.removeList);
				Laya.stage.on("mousewheel",this,this._onStageMouseWheel);
				this._list.selectedIndex=this._selectedIndex;
				}else {
				this._list && this._list.removeSelf();
			}
		}
	});

	/**
	*滚动条皮肤。
	*/
	__getset(0,__proto,'scrollBarSkin',function(){
		return this._scrollBarSkin;
		},function(value){
		this._scrollBarSkin=value;
	});

	/**
	*<p>当前实例的位图 <code>AutoImage</code> 实例的有效缩放网格数据。</p>
	*<p>数据格式："上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)"，以逗号分隔。
	*<ul><li>例如："4,4,4,4,1"</li></ul></p>
	*@see laya.ui.AutoBitmap.sizeGrid
	*/
	__getset(0,__proto,'sizeGrid',function(){
		return this._button.sizeGrid;
		},function(value){
		this._button.sizeGrid=value;
	});

	/**
	*获取对 <code>ComboBox</code> 组件所包含的 <code>Button</code> 组件的引用。
	*/
	__getset(0,__proto,'button',function(){
		return this._button;
	});

	/**
	*获取对 <code>ComboBox</code> 组件所包含的 <code>List</code> 列表组件的引用。
	*/
	__getset(0,__proto,'list',function(){
		this._list || this._createList();
		return this._list;
		},function(value){
		if (value){
			value.removeSelf();
			this._isCustomList=true;
			this._list=value;
			this._setListEvent(value);
			this._itemHeight=value.getCell(0).height+value.spaceY;
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if (((typeof value=='number')&& Math.floor(value)==value)|| (typeof value=='string'))this.selectedIndex=parseInt(value);
		else if ((value instanceof Array))this.labels=(value).join(",");
		else Laya.superSet(Component,this,'dataSource',value);
	});

	/**
	*获取或设置对 <code>ComboBox</code> 组件所包含的 <code>Button</code> 组件的文本标签颜色。
	*<p><b>格式：</b>upColor,overColor,downColor,disableColor</p>
	*/
	__getset(0,__proto,'labelColors',function(){
		return this._button.labelColors;
		},function(value){
		if (this._button.labelColors !=value){
			this._button.labelColors=value;
		}
	});

	/**
	*获取或设置对 <code>ComboBox</code> 组件所包含的 <code>Button</code> 组件的文本边距。
	*<p><b>格式：</b>上边距,右边距,下边距,左边距</p>
	*/
	__getset(0,__proto,'labelPadding',function(){
		return this._button.text.padding.join(",");
		},function(value){
		this._button.text.padding=UIUtils.fillArray(Styles.labelPadding,value,Number);
	});

	/**
	*获取或设置对 <code>ComboBox</code> 组件所包含的 <code>Button</code> 组件的标签字体大小。
	*/
	__getset(0,__proto,'labelSize',function(){
		return this._button.text.fontSize;
		},function(value){
		this._button.text.fontSize=value
	});

	/**
	*表示按钮文本标签的字体名称，以字符串形式表示。
	*@see laya.display.Text#font
	*/
	__getset(0,__proto,'labelFont',function(){
		return this._button.text.font;
		},function(value){
		this._button.text.font=value
	});

	/**
	*表示按钮的状态值。
	*@see laya.ui.Button#stateNum
	*/
	__getset(0,__proto,'stateNum',function(){
		return this._button.stateNum;
		},function(value){
		this._button.stateNum=value
	});

	return ComboBox;
})(Component)


/**
*<code>ScrollBar</code> 组件是一个滚动条组件。
*<p>当数据太多以至于显示区域无法容纳时，最终用户可以使用 <code>ScrollBar</code> 组件控制所显示的数据部分。</p>
*<p> 滚动条由四部分组成：两个箭头按钮、一个轨道和一个滑块。 </p> *
*
*@see laya.ui.VScrollBar
*@see laya.ui.HScrollBar
*/
//class laya.ui.ScrollBar extends laya.ui.Component
var ScrollBar=(function(_super){
	function ScrollBar(skin){
		/**滚动衰减系数*/
		this.rollRatio=0.95;
		/**滚动变化时回调，回传value参数。*/
		this.changeHandler=null;
		/**是否缩放滑动条，默认值为true。 */
		this.scaleBar=true;
		/**一个布尔值，指定是否自动隐藏滚动条(无需滚动时)，默认值为false。*/
		this.autoHide=false;
		/**橡皮筋效果极限距离，0为没有橡皮筋效果。*/
		this.elasticDistance=0;
		/**橡皮筋回弹时间，单位为毫秒。*/
		this.elasticBackTime=500;
		/**上按钮 */
		this.upButton=null;
		/**下按钮 */
		this.downButton=null;
		/**滑条 */
		this.slider=null;
		/**@private */
		this._scrollSize=1;
		/**@private */
		this._skin=null;
		/**@private */
		this._thumbPercent=1;
		/**@private */
		this._target=null;
		/**@private */
		this._lastPoint=null;
		/**@private */
		this._lastOffset=0;
		/**@private */
		this._checkElastic=false;
		/**@private */
		this._isElastic=false;
		/**@private */
		this._value=NaN;
		/**@private */
		this._hide=false;
		/**@private */
		this._clickOnly=true;
		/**@private */
		this._offsets=null;
		/**@private */
		this._FuzzyMove=3;
		ScrollBar.__super.call(this);
		this._showButtons=UIConfig.showButtons;
		this._touchScrollEnable=UIConfig.touchScrollEnable;
		this._mouseWheelEnable=UIConfig.mouseWheelEnable;
		this.skin=skin;
		this.max=1;
	}

	__class(ScrollBar,'laya.ui.ScrollBar',_super);
	var __proto=ScrollBar.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		this.stopScroll();
		this.target=null;
		_super.prototype.destroy.call(this,destroyChild);
		this.upButton && this.upButton.destroy(destroyChild);
		this.downButton && this.downButton.destroy(destroyChild);
		this.slider && this.slider.destroy(destroyChild);
		this.upButton=this.downButton=null;
		this.slider=null;
		this.changeHandler=null;
		this._offsets=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this.slider=new Slider());
		this.addChild(this.upButton=new Button());
		this.addChild(this.downButton=new Button());
	}

	/**@inheritDoc */
	__proto.initialize=function(){
		this.slider.showLabel=false;
		this.slider.on("change",this,this.onSliderChange);
		this.slider.setSlider(0,0,0);
		this.upButton.on("mousedown",this,this.onButtonMouseDown);
		this.downButton.on("mousedown",this,this.onButtonMouseDown);
	}

	/**
	*@private
	*滑块位置发生改变的处理函数。
	*/
	__proto.onSliderChange=function(){
		if(this._value !=this.slider.value)this.value=this.slider.value;
	}

	/**
	*@private
	*向上和向下按钮的 <code>Event.MOUSE_DOWN</code> 事件侦听处理函数。
	*/
	__proto.onButtonMouseDown=function(e){
		var isUp=e.currentTarget===this.upButton;
		this.slide(isUp);
		Laya.timer.once(Styles.scrollBarDelayTime,this,this.startLoop,[isUp]);
		Laya.stage.once("mouseup",this,this.onStageMouseUp);
	}

	/**@private */
	__proto.startLoop=function(isUp){
		Laya.timer.frameLoop(1,this,this.slide,[isUp]);
	}

	/**@private */
	__proto.slide=function(isUp){
		if (isUp)this.value-=this._scrollSize;
		else this.value+=this._scrollSize;
	}

	/**
	*@private
	*舞台的 <code>Event.MOUSE_DOWN</code> 事件侦听处理函数。
	*/
	__proto.onStageMouseUp=function(e){
		Laya.timer.clear(this,this.startLoop);
		Laya.timer.clear(this,this.slide);
	}

	/**
	*@private
	*更改对象的皮肤及位置。
	*/
	__proto.changeScrollBar=function(){
		this.upButton.visible=this._showButtons;
		this.downButton.visible=this._showButtons;
		if (this._showButtons){
			this.upButton.skin=this._skin.replace(".png","$up.png");
			this.downButton.skin=this._skin.replace(".png","$down.png");
		}
		if (this.slider.isVertical)this.slider.y=this._showButtons ? this.upButton.height :0;
		else this.slider.x=this._showButtons ? this.upButton.width :0;
		this.resetPositions();
		this.repaint();
	}

	/**@inheritDoc */
	__proto.changeSize=function(){
		_super.prototype.changeSize.call(this);
		this.repaint();
		this.resetPositions();
		this.event("change");
		this.changeHandler && this.changeHandler.runWith(this.value);
	}

	/**@private */
	__proto.resetPositions=function(){
		if (this.slider.isVertical)this.slider.height=this.height-(this._showButtons ? (this.upButton.height+this.downButton.height):0);
		else this.slider.width=this.width-(this._showButtons ? (this.upButton.width+this.downButton.width):0);
		this.resetButtonPosition();
	}

	/**@private */
	__proto.resetButtonPosition=function(){
		if (this.slider.isVertical)this.downButton.y=this.slider.y+this.slider.height;
		else this.downButton.x=this.slider.x+this.slider.width;
	}

	/**
	*设置滚动条信息。
	*@param min 滚动条最小位置值。
	*@param max 滚动条最大位置值。
	*@param value 滚动条当前位置值。
	*/
	__proto.setScroll=function(min,max,value){
		this.runCallLater(this.changeSize);
		this.slider.setSlider(min,max,value);
		this.slider.bar.visible=max > 0;
		if (!this._hide && this.autoHide)this.visible=false;
	}

	/**@private */
	__proto.onTargetMouseWheel=function(e){
		this.value-=e.delta *this._scrollSize;
		this.target=this._target;
	}

	/**@private */
	__proto.onTargetMouseDown=function(e){
		this._clickOnly=true;
		this._lastOffset=0;
		this._checkElastic=false;
		this._lastPoint || (this._lastPoint=new Point());
		this._lastPoint.setTo(Laya.stage.mouseX,Laya.stage.mouseY);
		Laya.timer.clear(this,this.tweenMove);
		Tween.clearTween(this);
		Laya.stage.once("mouseup",this,this.onStageMouseUp2);
		Laya.stage.once("mouseout",this,this.onStageMouseUp2);
		Laya.timer.frameLoop(1,this,this.loop);
	}

	/**@private */
	__proto.loop=function(){
		var mouseY=Laya.stage.mouseY;
		var mouseX=Laya.stage.mouseX;
		this._lastOffset=this.isVertical ? (mouseY-this._lastPoint.y):(mouseX-this._lastPoint.x);
		if(Math.abs(this._lastOffset)< this._FuzzyMove){this._lastOffset=0;}
			if (this._clickOnly){
			if (Math.abs(this._lastOffset *(this.isVertical ? Laya.stage._canvasTransform.getScaleY():Laya.stage._canvasTransform.getScaleX()))> 1){
				this._clickOnly=false;
				this._offsets || (this._offsets=[]);
				this._offsets.length=0;
				this._target.mouseEnabled=false;
				if (!this.hide && this.autoHide){
					this.alpha=1;
					this.visible=true;
				}
				this.event("start");
			}else return;
		}
		this._offsets.push(this._lastOffset);
		this._lastPoint.x=mouseX;
		this._lastPoint.y=mouseY;
		if (this._lastOffset===0)return;
		if (!this._checkElastic){
			if (this.elasticDistance > 0){
				if (!this._checkElastic && this._lastOffset !=0){
					if ((this._lastOffset > 0 && this._value <=this.min)|| (this._lastOffset < 0 && this._value >=this.max)){
						this._isElastic=true;
						this._checkElastic=true;
						}else {
						this._isElastic=false;
					}
				}
				}else {
				this._checkElastic=true;
			}
		}
		if (this._isElastic){
			if (this._value <=this.min){
				this.value-=this._lastOffset *Math.max(0,(1-((this.min-this._value)/ this.elasticDistance)));
				}else if (this._value >=this.max){
				this.value-=this._lastOffset *Math.max(0,(1-((this._value-this.max)/ this.elasticDistance)));
			}
			}else {
			this.value-=this._lastOffset;
		}
	}

	/**@private */
	__proto.onStageMouseUp2=function(e){
		Laya.stage.off("mouseup",this,this.onStageMouseUp2);
		Laya.stage.off("mouseout",this,this.onStageMouseUp2);
		Laya.timer.clear(this,this.loop);
		if (this._clickOnly){
			if(this._value>=this.min&&this._value<=this.max)
				return;
		}
		this._target.mouseEnabled=true;
		if (this._isElastic){
			if (this._value < this.min){
				Tween.to(this,{value:this.min},this.elasticBackTime,Ease.sineOut,Handler.create(this,this.elasticOver));
				}else if (this._value > this.max){
				Tween.to(this,{value:this.max},this.elasticBackTime,Ease.sineOut,Handler.create(this,this.elasticOver));
			}
			}else {
			if (!this._offsets)return;
			if (this._offsets.length < 1){
				this._offsets[0]=this.isVertical ? Laya.stage.mouseY-this._lastPoint.y :Laya.stage.mouseX-this._lastPoint.x;
			};
			var offset=0;
			var n=Math.min(this._offsets.length,3);
			for (var i=0;i < n;i++){
				offset+=this._offsets[this._offsets.length-1-i];
			}
			this._lastOffset=offset / n;
			offset=Math.abs(this._lastOffset);
			if (offset < 2){
				this.event("end");
				return;
			}
			if (offset > 60)this._lastOffset=this._lastOffset > 0 ? 60 :-60;
			var dis=Math.round(Math.abs(this.elasticDistance *(this._lastOffset / 240)));
			Laya.timer.frameLoop(1,this,this.tweenMove,[dis]);
		}
	}

	/**@private */
	__proto.elasticOver=function(){
		this._isElastic=false;
		if (!this.hide && this.autoHide){
			Tween.to(this,{alpha:0},500);
		}
		this.event("end");
	}

	/**@private */
	__proto.tweenMove=function(maxDistance){
		this._lastOffset *=this.rollRatio;
		var tarSpeed=NaN;
		if (maxDistance > 0){
			if (this._lastOffset > 0 && this.value <=this.min){
				this._isElastic=true;
				tarSpeed=-(this.min-maxDistance-this.value)*0.5;
				if (this._lastOffset > tarSpeed)this._lastOffset=tarSpeed;
				}else if (this._lastOffset < 0 && this.value >=this.max){
				this._isElastic=true;
				tarSpeed=-(this.max+maxDistance-this.value)*0.5;
				if (this._lastOffset < tarSpeed)this._lastOffset=tarSpeed;
			}
		}
		this.value-=this._lastOffset;
		if (Math.abs(this._lastOffset)< 1){
			Laya.timer.clear(this,this.tweenMove);
			if (this._isElastic){
				if (this._value < this.min){
					Tween.to(this,{value:this.min},this.elasticBackTime,Ease.sineOut,Handler.create(this,this.elasticOver));
					}else if (this._value > this.max){
					Tween.to(this,{value:this.max},this.elasticBackTime,Ease.sineOut,Handler.create(this,this.elasticOver));
					}else {
					this.elasticOver();
				}
				return;
			}
			this.event("end");
			if (!this.hide && this.autoHide){
				Tween.to(this,{alpha:0},500);
			}
		}
	}

	/**
	*停止滑动。
	*/
	__proto.stopScroll=function(){
		this.onStageMouseUp2(null);
		Laya.timer.clear(this,this.tweenMove);
		Tween.clearTween(this);
	}

	/**@inheritDoc */
	__getset(0,__proto,'measureHeight',function(){
		if (this.slider.isVertical)return 100;
		return this.slider.height;
	});

	/**
	*@copy laya.ui.Image#skin
	*/
	__getset(0,__proto,'skin',function(){
		return this._skin;
		},function(value){
		if (this._skin !=value){
			this._skin=value;
			this.slider.skin=this._skin;
			this.callLater(this.changeScrollBar);
		}
	});

	/**
	*获取或设置表示最高滚动位置的数字。
	*/
	__getset(0,__proto,'max',function(){
		return this.slider.max;
		},function(value){
		this.slider.max=value;
	});

	/**一个布尔值，指定是否显示向上、向下按钮，默认值为true。*/
	__getset(0,__proto,'showButtons',function(){
		return this._showButtons;
		},function(value){
		this._showButtons=value;
		this.callLater(this.changeScrollBar);
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureWidth',function(){
		if (this.slider.isVertical)return this.slider.width;
		return 100;
	});

	/**
	*获取或设置表示最低滚动位置的数字。
	*/
	__getset(0,__proto,'min',function(){
		return this.slider.min;
		},function(value){
		this.slider.min=value;
	});

	/**
	*获取或设置表示当前滚动位置的数字。
	*/
	__getset(0,__proto,'value',function(){
		return this._value;
		},function(v){
		if (v!==this._value){
			this._value=v;
			if (!this._isElastic){
				if (this.slider._value !=v){
					this.slider._value=v;
					this.slider.changeValue();
				}
				this._value=this.slider._value;
			}
			this.event("change");
			this.changeHandler && this.changeHandler.runWith(this._value);
		}
	});

	/**
	*一个布尔值，指示滚动条是否为垂直滚动。如果值为true，则为垂直滚动，否则为水平滚动。
	*<p>默认值为：true。</p>
	*/
	__getset(0,__proto,'isVertical',function(){
		return this.slider.isVertical;
		},function(value){
		this.slider.isVertical=value;
	});

	/**
	*<p>当前实例的 <code>Slider</code> 实例的有效缩放网格数据。</p>
	*<p>数据格式："上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)"，以逗号分隔。
	*<ul><li>例如："4,4,4,4,1"</li></ul></p>
	*@see laya.ui.AutoBitmap.sizeGrid
	*/
	__getset(0,__proto,'sizeGrid',function(){
		return this.slider.sizeGrid;
		},function(value){
		this.slider.sizeGrid=value;
	});

	/**获取或设置一个值，该值表示按下滚动条轨道时页面滚动的增量。 */
	__getset(0,__proto,'scrollSize',function(){
		return this._scrollSize;
		},function(value){
		this._scrollSize=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if ((typeof value=='number')|| (typeof value=='string'))this.value=Number(value);
		else Laya.superSet(Component,this,'dataSource',value);
	});

	/**获取或设置一个值，该值表示滑条长度比例，值为：（0-1）。 */
	__getset(0,__proto,'thumbPercent',function(){
		return this._thumbPercent;
		},function(value){
		this.runCallLater(this.changeScrollBar);
		this.runCallLater(this.changeSize);
		value=value >=1 ? 0.99 :value;
		this._thumbPercent=value;
		if (this.scaleBar){
			if (this.slider.isVertical)this.slider.bar.height=Math.max(this.slider.height *value,Styles.scrollBarMinNum);
			else this.slider.bar.width=Math.max(this.slider.width *value,Styles.scrollBarMinNum);
		}
	});

	/**
	*设置滚动对象。
	*@see laya.ui.TouchScroll#target
	*/
	__getset(0,__proto,'target',function(){
		return this._target;
		},function(value){
		if (this._target){
			this._target.off("mousewheel",this,this.onTargetMouseWheel);
			this._target.off("mousedown",this,this.onTargetMouseDown);
		}
		this._target=value;
		if (value){
			this._mouseWheelEnable && this._target.on("mousewheel",this,this.onTargetMouseWheel);
			this._touchScrollEnable && this._target.on("mousedown",this,this.onTargetMouseDown);
		}
	});

	/**是否隐藏滚动条，不显示滚动条，但是可以正常滚动，默认为false。*/
	__getset(0,__proto,'hide',function(){
		return this._hide;
		},function(value){
		this._hide=value;
		this.visible=!value;
	});

	/**一个布尔值，指定是否开启触摸，默认值为true。*/
	__getset(0,__proto,'touchScrollEnable',function(){
		return this._touchScrollEnable;
		},function(value){
		this._touchScrollEnable=value;
		this.target=this._target;
	});

	/**一个布尔值，指定是否滑轮滚动，默认值为true。*/
	__getset(0,__proto,'mouseWheelEnable',function(){
		return this._mouseWheelEnable;
		},function(value){
		this._mouseWheelEnable=value;
	});

	__getset(0,__proto,'FuzzyMove',function(){
		return this._FuzzyMove;
		},function(value){
		this._FuzzyMove=value
	});

	/**
	*滚动的刻度值，滑动数值为tick的整数倍。默认值为1。
	*/
	__getset(0,__proto,'tick',function(){
		return this.slider.tick;
		},function(value){
		this.slider.tick=value;
	});

	return ScrollBar;
})(Component)


/**
*使用 <code>Slider</code> 控件，用户可以通过在滑块轨道的终点之间移动滑块来选择值。
*<p>滑块的当前值由滑块端点（对应于滑块的最小值和最大值）之间滑块的相对位置确定。</p>
*<p>滑块允许最小值和最大值之间特定间隔内的值。滑块还可以使用数据提示显示其当前值。</p>
*
*@see laya.ui.HSlider
*@see laya.ui.VSlider
*/
//class laya.ui.Slider extends laya.ui.Component
var Slider=(function(_super){
	function Slider(skin){
		/**
		*数据变化处理器。
		*<p>默认回调参数为滑块位置属性 <code>value</code>属性值：Number 。</p>
		*/
		this.changeHandler=null;
		/**
		*一个布尔值，指示是否为垂直滚动。如果值为true，则为垂直方向，否则为水平方向。
		*<p>默认值为：true。</p>
		*@default true
		*/
		this.isVertical=true;
		/**
		*一个布尔值，指示是否显示标签。
		*@default true
		*/
		this.showLabel=true;
		/**@private */
		this._allowClickBack=false;
		/**@private */
		this._max=100;
		/**@private */
		this._min=0;
		/**@private */
		this._tick=1;
		/**@private */
		this._value=0;
		/**@private */
		this._skin=null;
		/**@private */
		this._bg=null;
		/**@private */
		this._progress=null;
		/**@private */
		this._bar=null;
		/**@private */
		this._tx=NaN;
		/**@private */
		this._ty=NaN;
		/**@private */
		this._maxMove=NaN;
		/**@private */
		this._globalSacle=null;
		Slider.__super.call(this);
		this.skin=skin;
	}

	__class(Slider,'laya.ui.Slider',_super);
	var __proto=Slider.prototype;
	/**
	*@inheritDoc
	*/
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._bg && this._bg.destroy(destroyChild);
		this._bar && this._bar.destroy(destroyChild);
		this._progress && this._progress.destroy(destroyChild);
		this._bg=null;
		this._bar=null;
		this._progress=null;
		this.changeHandler=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._bg=new Image());
		this.addChild(this._bar=new Button());
	}

	/**@inheritDoc */
	__proto.initialize=function(){
		this._bar.on("mousedown",this,this.onBarMouseDown);
		this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0";
		if (this._progress)this._progress.sizeGrid=this._bar.sizeGrid;
		this.allowClickBack=true;
	}

	/**
	*@private
	*滑块的的 <code>Event.MOUSE_DOWN</code> 事件侦听处理函数。
	*/
	__proto.onBarMouseDown=function(e){
		this._globalSacle || (this._globalSacle=new Point());
		this._globalSacle.setTo(this.globalScaleX || 0.01,this.globalScaleY || 0.01);
		this._maxMove=this.isVertical ? (this.height-this._bar.height):(this.width-this._bar.width);
		this._tx=Laya.stage.mouseX;
		this._ty=Laya.stage.mouseY;
		Laya.stage.on("mousemove",this,this.mouseMove);
		Laya.stage.once("mouseup",this,this.mouseUp);
		Laya.stage.once("mouseout",this,this.mouseUp);
		this.showValueText();
	}

	/**
	*@private
	*显示标签。
	*/
	__proto.showValueText=function(){
		if (this.showLabel){
			var label=laya.ui.Slider.label;
			this.addChild(label);
			label.textField.changeText(this._value+"");
			if (this.isVertical){
				label.x=this._bar.x+20;
				label.y=(this._bar.height-label.height)*0.5+this._bar.y;
				}else {
				label.y=this._bar.y-20;
				label.x=(this._bar.width-label.width)*0.5+this._bar.x;
			}
		}
	}

	/**
	*@private
	*隐藏标签。
	*/
	__proto.hideValueText=function(){
		laya.ui.Slider.label && laya.ui.Slider.label.removeSelf();
	}

	/**
	*@private
	*/
	__proto.mouseUp=function(e){
		Laya.stage.off("mousemove",this,this.mouseMove);
		Laya.stage.off("mouseup",this,this.mouseUp);
		Laya.stage.off("mouseout",this,this.mouseUp);
		this.sendChangeEvent("changed");
		this.hideValueText();
	}

	/**
	*@private
	*/
	__proto.mouseMove=function(e){
		var oldValue=this._value;
		if (this.isVertical){
			this._bar.y+=(Laya.stage.mouseY-this._ty)/ this._globalSacle.y;
			if (this._bar.y > this._maxMove)this._bar.y=this._maxMove;
			else if (this._bar.y < 0)this._bar.y=0;
			this._value=this._bar.y / this._maxMove *(this._max-this._min)+this._min;
			if(this._progress)this._progress.height=this._bar.y+0.5*this._bar.height;
			}else {
			this._bar.x+=(Laya.stage.mouseX-this._tx)/ this._globalSacle.x;
			if (this._bar.x > this._maxMove)this._bar.x=this._maxMove;
			else if (this._bar.x < 0)this._bar.x=0;
			this._value=this._bar.x / this._maxMove *(this._max-this._min)+this._min;
			if(this._progress)this._progress.width=this._bar.x+0.5*this._bar.width;
		}
		this._tx=Laya.stage.mouseX;
		this._ty=Laya.stage.mouseY;
		var pow=Math.pow(10,(this._tick+"").length-1);
		this._value=Math.round(Math.round(this._value / this._tick)*this._tick *pow)/ pow;
		if (this._value !=oldValue){
			this.sendChangeEvent();
		}
		this.showValueText();
	}

	/**
	*@private
	*/
	__proto.sendChangeEvent=function(type){
		(type===void 0)&& (type="change");
		this.event(type);
		this.changeHandler && this.changeHandler.runWith(this._value);
	}

	/**
	*@private
	*设置滑块的位置信息。
	*/
	__proto.setBarPoint=function(){
		if (this.isVertical)this._bar.x=Math.round((this._bg.width-this._bar.width)*0.5);
		else this._bar.y=Math.round((this._bg.height-this._bar.height)*0.5);
	}

	/**@inheritDoc */
	__proto.changeSize=function(){
		_super.prototype.changeSize.call(this);
		if (this.isVertical)this._bg.height=this.height;
		else this._bg.width=this.width;
		this.setBarPoint();
		this.changeValue();
	}

	/**
	*设置滑动条的信息。
	*@param min 滑块的最小值。
	*@param max 滑块的最小值。
	*@param value 滑块的当前值。
	*/
	__proto.setSlider=function(min,max,value){
		this._value=-1;
		this._min=min;
		this._max=max > min ? max :min;
		this.value=value < min ? min :value > max ? max :value;
	}

	/**
	*@private
	*改变滑块的位置值。
	*/
	__proto.changeValue=function(){
		var pow=Math.pow(10,(this._tick+"").length-1);
		this._value=Math.round(Math.round(this._value / this._tick)*this._tick *pow)/ pow;
		this._value=this._value > this._max ? this._max :this._value < this._min ? this._min :this._value;
		var num=this._max-this._min;
		if (num===0)num=1;
		if (this.isVertical){
			this._bar.y=(this._value-this._min)/ num *(this.height-this._bar.height);
			if(this._progress)this._progress.height=this._bar.y+0.5*this._bar.height;
		}
		else{
			this._bar.x=(this._value-this._min)/ num *(this.width-this._bar.width);
			if(this._progress)this._progress.width=this._bar.x+0.5*this._bar.width;
		}
	}

	/**
	*@private
	*滑动条的 <code>Event.MOUSE_DOWN</code> 事件侦听处理函数。
	*/
	__proto.onBgMouseDown=function(e){
		var point=this._bg.getMousePoint();
		if (this.isVertical)this.value=point.y / (this.height-this._bar.height)*(this._max-this._min)+this._min;
		else this.value=point.x / (this.width-this._bar.width)*(this._max-this._min)+this._min;
	}

	/**@inheritDoc */
	__getset(0,__proto,'measureHeight',function(){
		return Math.max(this._bg.height,this._bar.height);
	});

	/**
	*@copy laya.ui.Image#skin
	*/
	__getset(0,__proto,'skin',function(){
		return this._skin;
		},function(value){
		if (this._skin !=value){
			this._skin=value;
			this._bg.skin=this._skin;
			this._bar.skin=this._skin.replace(".png","$bar.png");
			var progressSkin=this._skin.replace(".png","$progress.png");
			if (Loader.getRes(progressSkin)){
				if (!this._progress){
					this.addChild(this._progress=new Image());
					this._progress.sizeGrid=this._bar.sizeGrid;
					this.setChildIndex(this._progress,1);
				}
				this._progress.skin=progressSkin;
			}
			this.setBarPoint();
			this.callLater(this.changeValue);
		}
	});

	/**
	*一个布尔值，指定是否允许通过点击滑动条改变 <code>Slider</code> 的 <code>value</code> 属性值。
	*/
	__getset(0,__proto,'allowClickBack',function(){
		return this._allowClickBack;
		},function(value){
		if (this._allowClickBack !=value){
			this._allowClickBack=value;
			if (value)this._bg.on("mousedown",this,this.onBgMouseDown);
			else this._bg.off("mousedown",this,this.onBgMouseDown);
		}
	});

	/**
	*获取或设置表示最高位置的数字。 默认值为100。
	*/
	__getset(0,__proto,'max',function(){
		return this._max;
		},function(value){
		if (this._max !=value){
			this._max=value;
			this.callLater(this.changeValue);
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureWidth',function(){
		return Math.max(this._bg.width,this._bar.width);
	});

	/**
	*滑动的刻度值，滑动数值为tick的整数倍。默认值为1。
	*/
	__getset(0,__proto,'tick',function(){
		return this._tick;
		},function(value){
		if (this._tick !=value){
			this._tick=value;
			this.callLater(this.changeValue);
		}
	});

	/**
	*<p>当前实例的背景图（ <code>Image</code> ）和滑块按钮（ <code>Button</code> ）实例的有效缩放网格数据。</p>
	*<p>数据格式："上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)"，以逗号分隔。
	*<ul><li>例如："4,4,4,4,1"</li></ul></p>
	*@see laya.ui.AutoBitmap.sizeGrid
	*/
	__getset(0,__proto,'sizeGrid',function(){
		return this._bg.sizeGrid;
		},function(value){
		this._bg.sizeGrid=value;
		this._bar.sizeGrid=value;
		if (this._progress)this._progress.sizeGrid=this._bar.sizeGrid;
	});

	/**
	*获取或设置表示最低位置的数字。 默认值为0。
	*/
	__getset(0,__proto,'min',function(){
		return this._min;
		},function(value){
		if (this._min !=value){
			this._min=value;
			this.callLater(this.changeValue);
		}
	});

	/**
	*获取或设置表示当前滑块位置的数字。
	*/
	__getset(0,__proto,'value',function(){
		return this._value;
		},function(num){
		if (this._value !=num){
			var oldValue=this._value;
			this._value=num;
			this.changeValue();
			if (this._value !=oldValue){
				this.sendChangeEvent();
			}
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if ((typeof value=='number')|| (typeof value=='string'))this.value=Number(value);
		else Laya.superSet(Component,this,'dataSource',value);
	});

	/**
	*表示滑块按钮的引用。
	*/
	__getset(0,__proto,'bar',function(){
		return this._bar;
	});

	__static(Slider,
	['label',function(){return this.label=new Label();}
	]);
	return Slider;
})(Component)


/**
*<p> <code>Label</code> 类用于创建显示对象以显示文本。</p>
*
*@example <caption>以下示例代码，创建了一个 <code>Label</code> 实例。</caption>
*package
*{
	*import laya.ui.Label;
	*public class Label_Example
	*{
		*public function Label_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*onInit();
			*}
		*private function onInit():void
		*{
			*var label:Label=new Label();//创建一个 Label 类的实例对象 label 。
			*label.font="Arial";//设置 label 的字体。
			*label.bold=true;//设置 label 显示为粗体。
			*label.leading=4;//设置 label 的行间距。
			*label.wordWrap=true;//设置 label 自动换行。
			*label.padding="10,10,10,10";//设置 label 的边距。
			*label.color="#ff00ff";//设置 label 的颜色。
			*label.text="Hello everyone,我是一个可爱的文本！";//设置 label 的文本内容。
			*label.x=100;//设置 label 对象的属性 x 的值，用于控制 label 对象的显示位置。
			*label.y=100;//设置 label 对象的属性 y 的值，用于控制 label 对象的显示位置。
			*label.width=300;//设置 label 的宽度。
			*label.height=200;//设置 label 的高度。
			*Laya.stage.addChild(label);//将 label 添加到显示列表。
			*var passwordLabel:Label=new Label("请原谅我，我不想被人看到我心里话。");//创建一个 Label 类的实例对象 passwordLabel 。
			*passwordLabel.asPassword=true;//设置 passwordLabel 的显示反式为密码显示。
			*passwordLabel.x=100;//设置 passwordLabel 对象的属性 x 的值，用于控制 passwordLabel 对象的显示位置。
			*passwordLabel.y=350;//设置 passwordLabel 对象的属性 y 的值，用于控制 passwordLabel 对象的显示位置。
			*passwordLabel.width=300;//设置 passwordLabel 的宽度。
			*passwordLabel.color="#000000";//设置 passwordLabel 的文本颜色。
			*passwordLabel.bgColor="#ccffff";//设置 passwordLabel 的背景颜色。
			*passwordLabel.fontSize=20;//设置 passwordLabel 的文本字体大小。
			*Laya.stage.addChild(passwordLabel);//将 passwordLabel 添加到显示列表。
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*onInit();
*function onInit(){
	*var label=new laya.ui.Label();//创建一个 Label 类的实例对象 label 。
	*label.font="Arial";//设置 label 的字体。
	*label.bold=true;//设置 label 显示为粗体。
	*label.leading=4;//设置 label 的行间距。
	*label.wordWrap=true;//设置 label 自动换行。
	*label.padding="10,10,10,10";//设置 label 的边距。
	*label.color="#ff00ff";//设置 label 的颜色。
	*label.text="Hello everyone,我是一个可爱的文本！";//设置 label 的文本内容。
	*label.x=100;//设置 label 对象的属性 x 的值，用于控制 label 对象的显示位置。
	*label.y=100;//设置 label 对象的属性 y 的值，用于控制 label 对象的显示位置。
	*label.width=300;//设置 label 的宽度。
	*label.height=200;//设置 label 的高度。
	*Laya.stage.addChild(label);//将 label 添加到显示列表。
	*var passwordLabel=new laya.ui.Label("请原谅我，我不想被人看到我心里话。");//创建一个 Label 类的实例对象 passwordLabel 。
	*passwordLabel.asPassword=true;//设置 passwordLabel 的显示反式为密码显示。
	*passwordLabel.x=100;//设置 passwordLabel 对象的属性 x 的值，用于控制 passwordLabel 对象的显示位置。
	*passwordLabel.y=350;//设置 passwordLabel 对象的属性 y 的值，用于控制 passwordLabel 对象的显示位置。
	*passwordLabel.width=300;//设置 passwordLabel 的宽度。
	*passwordLabel.color="#000000";//设置 passwordLabel 的文本颜色。
	*passwordLabel.bgColor="#ccffff";//设置 passwordLabel 的背景颜色。
	*passwordLabel.fontSize=20;//设置 passwordLabel 的文本字体大小。
	*Laya.stage.addChild(passwordLabel);//将 passwordLabel 添加到显示列表。
	*}
*@example
*import Label=laya.ui.Label;
*class Label_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*this.onInit();
		*}
	*private onInit():void {
		*var label:Label=new Label();//创建一个 Label 类的实例对象 label 。
		*label.font="Arial";//设置 label 的字体。
		*label.bold=true;//设置 label 显示为粗体。
		*label.leading=4;//设置 label 的行间距。
		*label.wordWrap=true;//设置 label 自动换行。
		*label.padding="10,10,10,10";//设置 label 的边距。
		*label.color="#ff00ff";//设置 label 的颜色。
		*label.text="Hello everyone,我是一个可爱的文本！";//设置 label 的文本内容。
		*label.x=100;//设置 label 对象的属性 x 的值，用于控制 label 对象的显示位置。
		*label.y=100;//设置 label 对象的属性 y 的值，用于控制 label 对象的显示位置。
		*label.width=300;//设置 label 的宽度。
		*label.height=200;//设置 label 的高度。
		*Laya.stage.addChild(label);//将 label 添加到显示列表。
		*var passwordLabel:Label=new Label("请原谅我，我不想被人看到我心里话。");//创建一个 Label 类的实例对象 passwordLabel 。
		*passwordLabel.asPassword=true;//设置 passwordLabel 的显示反式为密码显示。
		*passwordLabel.x=100;//设置 passwordLabel 对象的属性 x 的值，用于控制 passwordLabel 对象的显示位置。
		*passwordLabel.y=350;//设置 passwordLabel 对象的属性 y 的值，用于控制 passwordLabel 对象的显示位置。
		*passwordLabel.width=300;//设置 passwordLabel 的宽度。
		*passwordLabel.color="#000000";//设置 passwordLabel 的文本颜色。
		*passwordLabel.bgColor="#ccffff";//设置 passwordLabel 的背景颜色。
		*passwordLabel.fontSize=20;//设置 passwordLabel 的文本字体大小。
		*Laya.stage.addChild(passwordLabel);//将 passwordLabel 添加到显示列表。
		*}
	*}
*@see laya.display.Text
*/
//class laya.ui.Label extends laya.ui.Component
var Label=(function(_super){
	function Label(text){
		/**
		*@private
		*文本 <code>Text</code> 实例。
		*/
		this._tf=null;
		Label.__super.call(this);
		(text===void 0)&& (text="");
		Font.defaultColor=Styles.labelColor;
		this.text=text;
	}

	__class(Label,'laya.ui.Label',_super);
	var __proto=Label.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._tf=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._tf=new Text());
	}

	/**@copy laya.display.Text#changeText()
	**/
	__proto.changeText=function(text){
		this._tf.changeText(text);
	}

	/**
	*<p>边距信息</p>
	*<p>"上边距，右边距，下边距 , 左边距（边距以像素为单位）"</p>
	*@see laya.display.Text.padding
	*/
	__getset(0,__proto,'padding',function(){
		return this._tf.padding.join(",");
		},function(value){
		this._tf.padding=UIUtils.fillArray(Styles.labelPadding,value,Number);
	});

	/**
	*@copy laya.display.Text#bold
	*/
	__getset(0,__proto,'bold',function(){
		return this._tf.bold;
		},function(value){
		this._tf.bold=value;
	});

	/**
	*@copy laya.display.Text#align
	*/
	__getset(0,__proto,'align',function(){
		return this._tf.align;
		},function(value){
		this._tf.align=value;
	});

	/**
	*当前文本内容字符串。
	*@see laya.display.Text.text
	*/
	__getset(0,__proto,'text',function(){
		return this._tf.text;
		},function(value){
		if (this._tf.text !=value){
			if(value)
				value=UIUtils.adptString(value+"");
			this._tf.text=value;
			this.event("change");
			if (!this._width || !this._height)this.onCompResize();
		}
	});

	/**
	*@copy laya.display.Text#italic
	*/
	__getset(0,__proto,'italic',function(){
		return this._tf.italic;
		},function(value){
		this._tf.italic=value;
	});

	/**
	*@copy laya.display.Text#wordWrap
	*/
	/**
	*@copy laya.display.Text#wordWrap
	*/
	__getset(0,__proto,'wordWrap',function(){
		return this._tf.wordWrap;
		},function(value){
		this._tf.wordWrap=value;
	});

	/**
	*@copy laya.display.Text#font
	*/
	__getset(0,__proto,'font',function(){
		return this._tf.font;
		},function(value){
		this._tf.font=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if ((typeof value=='number')|| (typeof value=='string'))this.text=value+"";
		else Laya.superSet(Component,this,'dataSource',value);
	});

	/**
	*@copy laya.display.Text#color
	*/
	__getset(0,__proto,'color',function(){
		return this._tf.color;
		},function(value){
		this._tf.color=value;
	});

	/**
	*@copy laya.display.Text#valign
	*/
	__getset(0,__proto,'valign',function(){
		return this._tf.valign;
		},function(value){
		this._tf.valign=value;
	});

	/**
	*@copy laya.display.Text#leading
	*/
	__getset(0,__proto,'leading',function(){
		return this._tf.leading;
		},function(value){
		this._tf.leading=value;
	});

	/**
	*@copy laya.display.Text#fontSize
	*/
	__getset(0,__proto,'fontSize',function(){
		return this._tf.fontSize;
		},function(value){
		this._tf.fontSize=value;
	});

	/**
	*@copy laya.display.Text#bgColor
	*/
	__getset(0,__proto,'bgColor',function(){
		return this._tf.bgColor
		},function(value){
		this._tf.bgColor=value;
	});

	/**
	*@copy laya.display.Text#borderColor
	*/
	__getset(0,__proto,'borderColor',function(){
		return this._tf.borderColor
		},function(value){
		this._tf.borderColor=value;
	});

	/**
	*@copy laya.display.Text#stroke
	*/
	__getset(0,__proto,'stroke',function(){
		return this._tf.stroke;
		},function(value){
		this._tf.stroke=value;
	});

	/**
	*@copy laya.display.Text#strokeColor
	*/
	__getset(0,__proto,'strokeColor',function(){
		return this._tf.strokeColor;
		},function(value){
		this._tf.strokeColor=value;
	});

	/**
	*文本控件实体 <code>Text</code> 实例。
	*/
	__getset(0,__proto,'textField',function(){
		return this._tf;
	});

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'measureWidth',function(){
		return this._tf.width;
	});

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'measureHeight',function(){
		return this._tf.height;
	});

	/**
	*@inheritDoc
	*/
	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'width',function(){
		if (this._width || this._tf.text)return Laya.superGet(Component,this,'width');
		return 0;
		},function(value){
		Laya.superSet(Component,this,'width',value);
		this._tf.width=value;
	});

	/**
	*@inheritDoc
	*/
	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'height',function(){
		if (this._height || this._tf.text)return Laya.superGet(Component,this,'height');
		return 0;
		},function(value){
		Laya.superSet(Component,this,'height',value);
		this._tf.height=value;
	});

	/**
	*@copy laya.display.Text#overflow
	*/
	/**
	*@copy laya.display.Text#overflow
	*/
	__getset(0,__proto,'overflow',function(){
		return this._tf.overflow;
		},function(value){
		this._tf.overflow=value;
	});

	/**
	*@copy laya.display.Text#underline
	*/
	/**
	*@copy laya.display.Text#underline
	*/
	__getset(0,__proto,'underline',function(){
		return this._tf.underline;
		},function(value){
		this._tf.underline=value;
	});

	/**
	*@copy laya.display.Text#underlineColor
	*/
	/**
	*@copy laya.display.Text#underlineColor
	*/
	__getset(0,__proto,'underlineColor',function(){
		return this._tf.underlineColor;
		},function(value){
		this._tf.underlineColor=value;
	});

	return Label;
})(Component)


/**
*<code>ProgressBar</code> 组件显示内容的加载进度。
*@example <caption>以下示例代码，创建了一个新的 <code>ProgressBar</code> 实例，设置了它的皮肤、位置、宽高、网格等信息，并添加到舞台上。</caption>
*package
*{
	*import laya.ui.ProgressBar;
	*import laya.utils.Handler;
	*public class ProgressBar_Example
	*{
		*private var progressBar:ProgressBar;
		*public function ProgressBar_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/progress.png","resource/ui/progress$bar.png"],Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*progressBar=new ProgressBar("resource/ui/progress.png");//创建一个 ProgressBar 类的实例对象 progressBar 。
			*progressBar.x=100;//设置 progressBar 对象的属性 x 的值，用于控制 progressBar 对象的显示位置。
			*progressBar.y=100;//设置 progressBar 对象的属性 y 的值，用于控制 progressBar 对象的显示位置。
			*progressBar.value=0.3;//设置 progressBar 的进度值。
			*progressBar.width=200;//设置 progressBar 的宽度。
			*progressBar.height=50;//设置 progressBar 的高度。
			*progressBar.sizeGrid="5,10,5,10";//设置 progressBar 的网格信息。
			*progressBar.changeHandler=new Handler(this,onChange);//设置 progressBar 的value值改变时执行的处理器。
			*Laya.stage.addChild(progressBar);//将 progressBar 添加到显示列表。
			*Laya.timer.once(3000,this,changeValue);//设定 3000ms（毫秒）后，执行函数changeValue。
			*}
		*private function changeValue():void
		*{
			*trace("改变进度条的进度值。");
			*progressBar.value=0.6;
			*}
		*private function onChange(value:Number):void
		*{
			*trace("进度发生改变： value=" ,value);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*var res=["resource/ui/progress.png","resource/ui/progress$bar.png"];
*Laya.loader.load(res,laya.utils.Handler.create(this,onLoadComplete));//加载资源。
*function onLoadComplete()
*{
	*progressBar=new laya.ui.ProgressBar("resource/ui/progress.png");//创建一个 ProgressBar 类的实例对象 progressBar 。
	*progressBar.x=100;//设置 progressBar 对象的属性 x 的值，用于控制 progressBar 对象的显示位置。
	*progressBar.y=100;//设置 progressBar 对象的属性 y 的值，用于控制 progressBar 对象的显示位置。
	*progressBar.value=0.3;//设置 progressBar 的进度值。
	*progressBar.width=200;//设置 progressBar 的宽度。
	*progressBar.height=50;//设置 progressBar 的高度。
	*progressBar.sizeGrid="10,5,10,5";//设置 progressBar 的网格信息。
	*progressBar.changeHandler=new laya.utils.Handler(this,onChange);//设置 progressBar 的value值改变时执行的处理器。
	*Laya.stage.addChild(progressBar);//将 progressBar 添加到显示列表。
	*Laya.timer.once(3000,this,changeValue);//设定 3000ms（毫秒）后，执行函数changeValue。
	*}
*function changeValue()
*{
	*console.log("改变进度条的进度值。");
	*progressBar.value=0.6;
	*}
*function onChange(value)
*{
	*console.log("进度发生改变： value=" ,value);
	*}
*@example
*import ProgressBar=laya.ui.ProgressBar;
*import Handler=laya.utils.Handler;
*class ProgressBar_Example {
	*private progressBar:ProgressBar;
	*public ProgressBar_Example(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/progress.png","resource/ui/progress$bar.png"],Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*this.progressBar=new ProgressBar("resource/ui/progress.png");//创建一个 ProgressBar 类的实例对象 progressBar 。
		*this.progressBar.x=100;//设置 progressBar 对象的属性 x 的值，用于控制 progressBar 对象的显示位置。
		*this.progressBar.y=100;//设置 progressBar 对象的属性 y 的值，用于控制 progressBar 对象的显示位置。
		*this.progressBar.value=0.3;//设置 progressBar 的进度值。
		*this.progressBar.width=200;//设置 progressBar 的宽度。
		*this.progressBar.height=50;//设置 progressBar 的高度。
		*this.progressBar.sizeGrid="5,10,5,10";//设置 progressBar 的网格信息。
		*this.progressBar.changeHandler=new Handler(this,this.onChange);//设置 progressBar 的value值改变时执行的处理器。
		*Laya.stage.addChild(this.progressBar);//将 progressBar 添加到显示列表。
		*Laya.timer.once(3000,this,this.changeValue);//设定 3000ms（毫秒）后，执行函数changeValue。
		*}
	*private changeValue():void {
		*console.log("改变进度条的进度值。");
		*this.progressBar.value=0.6;
		*}
	*private onChange(value:number):void {
		*console.log("进度发生改变： value=",value);
		*}
	*}
*/
//class laya.ui.ProgressBar extends laya.ui.Component
var ProgressBar=(function(_super){
	function ProgressBar(skin){
		/**
		*当 <code>ProgressBar</code> 实例的 <code>value</code> 属性发生变化时的函数处理器。
		*<p>默认返回参数<code>value</code> 属性（进度值）。</p>
		*/
		this.changeHandler=null;
		/**@private */
		this._bg=null;
		/**@private */
		this._bar=null;
		/**@private */
		this._skin=null;
		/**@private */
		this._value=0.5;
		ProgressBar.__super.call(this);
		this.skin=skin;
	}

	__class(ProgressBar,'laya.ui.ProgressBar',_super);
	var __proto=ProgressBar.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._bg && this._bg.destroy(destroyChild);
		this._bar && this._bar.destroy(destroyChild);
		this._bg=this._bar=null;
		this.changeHandler=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._bg=new Image());
		this.addChild(this._bar=new Image());
		this._bar._bitmap.autoCacheCmd=false;
	}

	/**
	*@private
	*更改进度值的显示。
	*/
	__proto.changeValue=function(){
		if (this.sizeGrid){
			var grid=this.sizeGrid.split(",");
			var left=Number(grid[3]);
			var right=Number(grid[1]);
			var max=this.width-left-right;
			var sw=max *this._value;
			this._bar.width=left+right+sw;
			this._bar.visible=this._bar.width > left+right;
			}else {
			this._bar.width=this.width *this._value;
		}
	}

	/**@inheritDoc */
	__getset(0,__proto,'measureHeight',function(){
		return this._bg.height;
	});

	/**
	*@copy laya.ui.Image#skin
	*/
	__getset(0,__proto,'skin',function(){
		return this._skin;
		},function(value){
		if (this._skin !=value){
			this._skin=value;
			this._bg.skin=this._skin;
			this._bar.skin=this._skin.replace(".png","$bar.png");
			this.callLater(this.changeValue);
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'measureWidth',function(){
		return this._bg.width;
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Component,this,'height',value);
		this._bg.height=this._height;
		this._bar.height=this._height;
	});

	/**
	*获取进度条对象。
	*/
	__getset(0,__proto,'bar',function(){
		return this._bar;
	});

	/**
	*当前的进度量。
	*<p><b>取值：</b>介于0和1之间。</p>
	*/
	__getset(0,__proto,'value',function(){
		return this._value;
		},function(num){
		if (this._value !=num){
			num=num > 1 ? 1 :num < 0 ? 0 :num;
			this._value=num;
			this.callLater(this.changeValue);
			this.event("change");
			this.changeHandler && this.changeHandler.runWith(num);
		}
	});

	/**
	*获取背景条对象。
	*/
	__getset(0,__proto,'bg',function(){
		return this._bg;
	});

	/**
	*<p>当前 <code>ProgressBar</code> 实例的进度条背景位图（ <code>Image</code> 实例）的有效缩放网格数据。</p>
	*<p>数据格式："上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)"，以逗号分隔。
	*<ul><li>例如："4,4,4,4,1"</li></ul></p>
	*@see laya.ui.AutoBitmap.sizeGrid
	*/
	__getset(0,__proto,'sizeGrid',function(){
		return this._bg.sizeGrid;
		},function(value){
		this._bg.sizeGrid=this._bar.sizeGrid=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Component,this,'width',value);
		this._bg.width=this._width;
		this.callLater(this.changeValue);
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if ((typeof value=='number')|| (typeof value=='string'))this.value=Number(value);
		else Laya.superSet(Component,this,'dataSource',value);
	});

	return ProgressBar;
})(Component)


/**
*
*@author ww
*@version 1.0
*
*@created 2015-9-29 上午11:17:35
*/
//class laya.debug.tools.debugUI.DButton extends laya.display.Text
var DButton=(function(_super){
	function DButton(){
		DButton.__super.call(this);
		this.bgColor="#ffff00";
		this.wordWrap=false;
		this.mouseEnabled=true;
	}

	__class(DButton,'laya.debug.tools.debugUI.DButton',_super);
	return DButton;
})(Text)


/**
*<p><code>Input</code> 类用于创建显示对象以显示和输入文本。</p>
*<p>Input 类封装了原生的文本输入框，由于不同浏览器的差异，会导致此对象的默认文本的位置与用户点击输入时的文本的位置有少许的偏差。</p>
*/
//class laya.display.Input extends laya.display.Text
var Input=(function(_super){
	function Input(){
		/**@private */
		this._focus=false;
		/**@private */
		this._multiline=false;
		/**@private */
		this._editable=true;
		/**@private */
		this._restrictPattern=null;
		this._type="text";
		/**输入提示符。*/
		this._prompt='';
		/**输入提示符颜色。*/
		this._promptColor="#A9A9A9";
		this._originColor="#000000";
		this._content='';
		Input.__super.call(this);
		this._maxChars=1E5;
		this._width=100;
		this._height=20;
		this.multiline=false;
		this.overflow=Text.SCROLL;
		this.on("mousedown",this,this._onMouseDown);
		this.on("undisplay",this,this._onUnDisplay);
	}

	__class(Input,'laya.display.Input',_super);
	var __proto=Input.prototype;
	/**
	*设置光标位置和选取字符。
	*@param startIndex 光标起始位置。
	*@param endIndex 光标结束位置。
	*/
	__proto.setSelection=function(startIndex,endIndex){
		this.focus=true;
		laya.display.Input.inputElement.selectionStart=startIndex;
		laya.display.Input.inputElement.selectionEnd=endIndex;
	}

	__proto._onUnDisplay=function(e){
		this.focus=false;
	}

	__proto._onMouseDown=function(e){
		this.focus=true;
	}

	/**
	*在输入期间，如果 Input 实例的位置改变，调用_syncInputTransform同步输入框的位置。
	*/
	__proto._syncInputTransform=function(){
		var inputElement=this.nativeInput;
		var transform=Utils.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]);
		var inputWid=this._width-this.padding[1]-this.padding[3];
		var inputHei=this._height-this.padding[0]-this.padding[2];
		if (Render.isConchApp){
			inputElement.setScale(transform.scaleX,transform.scaleY);
			inputElement.setSize(inputWid,inputHei);
			inputElement.setPos(transform.x,transform.y);
			}else {
			Input.inputContainer.style.transform=Input.inputContainer.style.webkitTransform="scale("+transform.scaleX+","+transform.scaleY+") rotate("+(Laya.stage.canvasDegree)+"deg)";
			inputElement.style.width=inputWid+'px';
			inputElement.style.height=inputHei+'px';
			Input.inputContainer.style.left=transform.x+'px';
			Input.inputContainer.style.top=transform.y+'px';
		}
	}

	/**选中当前实例的所有文本。*/
	__proto.select=function(){
		this.nativeInput.select();
	}

	__proto._setInputMethod=function(){
		Input.input.parentElement && (Input.inputContainer.removeChild(Input.input));
		Input.area.parentElement && (Input.inputContainer.removeChild(Input.area));
		Input.inputElement=(this._multiline ? Input.area :Input.input);
		Input.inputContainer.appendChild(Input.inputElement);
		if (Text.RightToLeft){
			Input.inputElement.style.direction="rtl";
		}
	}

	__proto._focusIn=function(){
		laya.display.Input.isInputting=true;
		var input=this.nativeInput;
		this._focus=true;
		var cssStyle=input.style;
		cssStyle.whiteSpace=(this.wordWrap ? "pre-wrap" :"nowrap");
		this._setPromptColor();
		input.readOnly=!this._editable;
		if (Render.isConchApp){
			input.setType(this._type);
			input.setForbidEdit(!this._editable);
		}
		input.maxLength=this._maxChars;
		var padding=this.padding;
		input.type=this._type;
		input.value=this._content;
		input.placeholder=this._prompt;
		Laya.stage.off("keydown",this,this._onKeyDown);
		Laya.stage.on("keydown",this,this._onKeyDown);
		Laya.stage.focus=this;
		this.event("focus");
		if (Browser.onPC)input.focus();
		if(!Browser.onMiniGame){
			var temp=this._text;
			this._text=null;
		}
		this.typeset();
		input.setColor(this._originColor);
		input.setFontSize(this.fontSize);
		input.setFontFace(Browser.onIPhone ? (Text._fontFamilyMap[this.font] || this.font):this.font);
		if (Render.isConchApp){
			input.setMultiAble && input.setMultiAble(this._multiline);
		}
		cssStyle.lineHeight=(this.leading+this.fontSize)+"px";
		cssStyle.fontStyle=(this.italic ? "italic" :"normal");
		cssStyle.fontWeight=(this.bold ? "bold" :"normal");
		cssStyle.textAlign=this.align;
		cssStyle.padding="0 0";
		this._syncInputTransform();
		if (!Render.isConchApp && Browser.onPC)
			Laya.timer.frameLoop(1,this,this._syncInputTransform);
	}

	// 设置DOM输入框提示符颜色。
	__proto._setPromptColor=function(){
		Input.promptStyleDOM=Browser.getElementById("promptStyle");
		if (!Input.promptStyleDOM){
			Input.promptStyleDOM=Browser.createElement("style");
			Input.promptStyleDOM.setAttribute("id","promptStyle");
			Browser.document.head.appendChild(Input.promptStyleDOM);
		}
		Input.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {"+"color:"+this._promptColor+"}"+"input:-moz-placeholder, textarea:-moz-placeholder {"+"color:"+this._promptColor+"}"+"input::-moz-placeholder, textarea::-moz-placeholder {"+"color:"+this._promptColor+"}"+"input:-ms-input-placeholder, textarea:-ms-input-placeholder {"+"color:"+this._promptColor+"}";
	}

	/**@private */
	__proto._focusOut=function(){
		laya.display.Input.isInputting=false;
		this._focus=false;
		this._text=null;
		this._content=this.nativeInput.value;
		if (!this._content){
			Laya.superSet(Text,this,'text',this._prompt);
			Laya.superSet(Text,this,'color',this._promptColor);
			}else {
			Laya.superSet(Text,this,'text',this._content);
			Laya.superSet(Text,this,'color',this._originColor);
		}
		Laya.stage.off("keydown",this,this._onKeyDown);
		Laya.stage.focus=null;
		this.event("blur");
		if (Render.isConchApp)this.nativeInput.blur();
		Browser.onPC && Laya.timer.clear(this,this._syncInputTransform);
	}

	/**@private */
	__proto._onKeyDown=function(e){
		if (e.keyCode===13){
			if (Browser.onMobile && !this._multiline)
				this.focus=false;
			this.event("enter");
		}
	}

	__proto.changeText=function(text){
		this._content=text;
		if (this._focus){
			this.nativeInput.value=text || '';
			this.event("change");
		}else
		_super.prototype.changeText.call(this,text);
	}

	/**@inheritDoc */
	__getset(0,__proto,'color',_super.prototype._$get_color,function(value){
		if (this._focus)
			this.nativeInput.setColor(value);
		Laya.superSet(Text,this,'color',this._content?value:this._promptColor);
		this._originColor=value;
	});

	//[Deprecated]
	__getset(0,__proto,'inputElementYAdjuster',function(){
		console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。");
		return 0;
		},function(value){
		console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。");
	});

	/**表示是否是多行输入框。*/
	__getset(0,__proto,'multiline',function(){
		return this._multiline;
		},function(value){
		this._multiline=value;
		this.valign=value ? "top" :"middle";
	});

	/**
	*<p>字符数量限制，默认为10000。</p>
	*<p>设置字符数量限制时，小于等于0的值将会限制字符数量为10000。</p>
	*/
	__getset(0,__proto,'maxChars',function(){
		return this._maxChars;
		},function(value){
		if (value <=0)
			value=1E5;
		this._maxChars=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'text',function(){
		if (this._focus)
			return this.nativeInput.value;
		else
		return this._content || "";
		},function(value){
		Laya.superSet(Text,this,'color',this._originColor);
		value+='';
		if (this._focus){
			this.nativeInput.value=value || '';
			this.event("change");
			}else {
			if (!this._multiline)
				value=value.replace(/\r?\n/g,'');
			this._content=value;
			if (value)
				Laya.superSet(Text,this,'text',value);
			else {
				Laya.superSet(Text,this,'text',this._prompt);
				Laya.superSet(Text,this,'color',this.promptColor);
			}
		}
	});

	/**
	*获取对输入框的引用实例。
	*/
	__getset(0,__proto,'nativeInput',function(){
		return this._multiline ? Input.area :Input.input;
	});

	/**
	*设置输入提示符。
	*/
	__getset(0,__proto,'prompt',function(){
		return this._prompt;
		},function(value){
		if (!this._text && value)
			Laya.superSet(Text,this,'color',this._promptColor);
		this.promptColor=this._promptColor;
		if (this._text)
			Laya.superSet(Text,this,'text',(this._text==this._prompt)?value:this._text);
		else
		Laya.superSet(Text,this,'text',value);
		this._prompt=Text.langPacks && Text.langPacks[value] ? Text.langPacks[value] :value;
	});

	// 因此 调用focus接口是无法都在移动平台立刻弹出键盘的
	/**
	*表示焦点是否在此实例上。
	*/
	__getset(0,__proto,'focus',function(){
		return this._focus;
		},function(value){
		var input=this.nativeInput;
		if (this._focus!==value){
			if (value){
				if (input.target){
					input.target._focusOut();
					}else {
					this._setInputMethod();
				}
				input.target=this;
				this._focusIn();
				}else {
				input.target=null;
				this._focusOut();
				Browser.document.body.scrollTop=0;
				input.blur();
				if (Render.isConchApp){
					input.setPos(-10000,-10000);
				}else if (Input.inputContainer.contains(input))
				Input.inputContainer.removeChild(input);
			}
		}
	});

	/**限制输入的字符。*/
	__getset(0,__proto,'restrict',function(){
		if (this._restrictPattern){
			return this._restrictPattern.source;
		}
		return "";
		},function(pattern){
		if (pattern){
			pattern="[^"+pattern+"]";
			if (pattern.indexOf("^^")>-1)
				pattern=pattern.replace("^^","");
			this._restrictPattern=new RegExp(pattern,"g");
		}else
		this._restrictPattern=null;
	});

	/**
	*是否可编辑。
	*/
	__getset(0,__proto,'editable',function(){
		return this._editable;
		},function(value){
		this._editable=value;
		if (Render.isConchApp){
			Input.input.setForbidEdit(!value);
		}
	});

	/**
	*设置输入提示符颜色。
	*/
	__getset(0,__proto,'promptColor',function(){
		return this._promptColor;
		},function(value){
		this._promptColor=value;
		if (!this._content)Laya.superSet(Text,this,'color',value);
	});

	/**
	*<p>输入框类型为Input静态常量之一。</p>
	*<ul>
	*<li>TYPE_TEXT</li>
	*<li>TYPE_PASSWORD</li>
	*<li>TYPE_EMAIL</li>
	*<li>TYPE_URL</li>
	*<li>TYPE_NUMBER</li>
	*<li>TYPE_RANGE</li>
	*<li>TYPE_DATE</li>
	*<li>TYPE_MONTH</li>
	*<li>TYPE_WEEK</li>
	*<li>TYPE_TIME</li>
	*<li>TYPE_DATE_TIME</li>
	*<li>TYPE_DATE_TIME_LOCAL</li>
	*</ul>
	*<p>平台兼容性参见http://www.w3school.com.cn/html5/html_5_form_input_types.asp。</p>
	*/
	__getset(0,__proto,'type',function(){
		return this._type;
		},function(value){
		if (value=="password")
			this._getCSSStyle().password=true;
		else
		this._getCSSStyle().password=false;
		this._type=value;
		if (Render.isConchApp){
			this.nativeInput.setType(value);
		}
	});

	/**
	*<p>原生输入框 X 轴调整值，用来调整输入框坐标。</p>
	*<p>由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。</p>
	*@deprecated
	*/
	__getset(0,__proto,'inputElementXAdjuster',function(){
		console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。");
		return 0;
		},function(value){
		console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。");
	});

	//[Deprecated(replacement="Input.type")]
	__getset(0,__proto,'asPassword',function(){
		return this._getCSSStyle().password;
		},function(value){
		this._getCSSStyle().password=value;
		this._type="password";
		console.warn("deprecated: 使用type=\"password\"替代设置asPassword, asPassword将在下次重大更新时删去");
		this.isChanged=true;
	});

	Input.__init__=function(){
		Input._createInputElement();
		if (Browser.onMobile)
			Render.canvas.addEventListener(Input.IOS_IFRAME ?(Browser.onMiniGame ? "touchend" :"click"):"touchend",Input._popupInputMethod);
	}

	Input._popupInputMethod=function(e){
		if (!laya.display.Input.isInputting)return;
		var input=laya.display.Input.inputElement;
		input.focus();
	}

	Input._createInputElement=function(){
		Input._initInput(Input.area=Browser.createElement("textarea"));
		Input._initInput(Input.input=Browser.createElement("input"));
		Input.inputContainer=Browser.createElement("div");
		Input.inputContainer.style.position="absolute";
		Input.inputContainer.style.zIndex=1E5;
		Browser.container.appendChild(Input.inputContainer);
		Input.inputContainer.setPos=function (x,y){Input.inputContainer.style.left=x+'px';Input.inputContainer.style.top=y+'px';};
	}

	Input._initInput=function(input){
		var style=input.style;
		style.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;";
		style.resize='none';
		style.backgroundColor='transparent';
		style.border='none';
		style.outline='none';
		style.zIndex=1;
		input.addEventListener('input',Input._processInputting);
		input.addEventListener('mousemove',Input._stopEvent);
		input.addEventListener('mousedown',Input._stopEvent);
		input.addEventListener('touchmove',Input._stopEvent);
		input.setFontFace=function (fontFace){input.style.fontFamily=fontFace;};
		if(!Render.isConchApp){
			input.setColor=function (color){input.style.color=color;};
			input.setFontSize=function (fontSize){input.style.fontSize=fontSize+'px';};
		}
	}

	Input._processInputting=function(e){
		var input=laya.display.Input.inputElement.target;
		if (!input)return;
		var value=laya.display.Input.inputElement.value;
		if (input._restrictPattern){
			value=value.replace(/\u2006|\x27/g,"");
			if (input._restrictPattern.test(value)){
				value=value.replace(input._restrictPattern,"");
				laya.display.Input.inputElement.value=value;
			}
		}
		input._text=value;
		input.event("input");
	}

	Input._stopEvent=function(e){
		if (e.type=='touchmove')
			e.preventDefault();
		e.stopPropagation && e.stopPropagation();
	}

	Input.TYPE_TEXT="text";
	Input.TYPE_PASSWORD="password";
	Input.TYPE_EMAIL="email";
	Input.TYPE_URL="url";
	Input.TYPE_NUMBER="number";
	Input.TYPE_RANGE="range";
	Input.TYPE_DATE="date";
	Input.TYPE_MONTH="month";
	Input.TYPE_WEEK="week";
	Input.TYPE_TIME="time";
	Input.TYPE_DATE_TIME="datetime";
	Input.TYPE_DATE_TIME_LOCAL="datetime-local";
	Input.TYPE_SEARCH="search";
	Input.input=null;
	Input.area=null;
	Input.inputElement=null;
	Input.inputContainer=null;
	Input.confirmButton=null;
	Input.promptStyleDOM=null;
	Input.inputHeight=45;
	Input.isInputting=false;
	Input.stageMatrix=null;
	__static(Input,
	['IOS_IFRAME',function(){return this.IOS_IFRAME=(Browser.onIOS && Browser.window.top !=Browser.window.self);}
	]);
	return Input;
})(Text)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.recinfos.ReCacheRecInfo extends laya.debug.view.nodeInfo.recinfos.NodeRecInfo
var ReCacheRecInfo=(function(_super){
	function ReCacheRecInfo(){
		this.isWorking=false;
		this.count=0;
		this.mTime=0;
		ReCacheRecInfo.__super.call(this);
		this.txt.fontSize=12;
	}

	__class(ReCacheRecInfo,'laya.debug.view.nodeInfo.recinfos.ReCacheRecInfo',_super);
	var __proto=ReCacheRecInfo.prototype;
	__proto.addCount=function(time){
		(time===void 0)&& (time=0);
		this.count++;
		this.mTime+=time;
		if (!this.isWorking){
			this.working=true;
		}
	}

	__proto.updates=function(){
		if (!this._tar["displayedInStage"]){
			this.working=false;
			this.removeSelf();
		}
		this.txt.text=ClassTool.getNodeClassAndName(this._tar)+"\n"+"reCache:"+this.count+"\ntime:"+this.mTime;
		if (this.count > 0){
			this.fresh();
			Laya.timer.clear(this,this.removeSelfLater);
			}else{
			this.working=false;
			Laya.timer.once(3000,this,this.removeSelfLater);
		}
		this.count=0;
		this.mTime=0;
	}

	__proto.removeSelfLater=function(){
		this.working=false;
		this.removeSelf();
	}

	__getset(0,__proto,'working',null,function(v){
		this.isWorking=v;
		if (v){
			Laya.timer.loop(1000,this,this.updates);
			}else{
			Laya.timer.clear(this,this.updates);
		}
	});

	ReCacheRecInfo.showTime=3000;
	return ReCacheRecInfo;
})(NodeRecInfo)


/**
*<p> <code>Animation</code> 是Graphics动画类。实现了基于Graphics的动画创建、播放、控制接口。</p>
*<p>本类使用了动画模版缓存池，它以一定的内存开销来节省CPU开销，当相同的动画模版被多次使用时，相比于每次都创建新的动画模版，使用动画模版缓存池，只需创建一次，缓存之后多次复用，从而节省了动画模版创建的开销。</p>
*<p>动画模版缓存池，以key-value键值对存储，key可以自定义，也可以从指定的配置文件中读取，value为对应的动画模版，是一个Graphics对象数组，每个Graphics对象对应一个帧图像，动画的播放实质就是定时切换Graphics对象。</p>
*<p>使用set source、loadImages(...)、loadAtlas(...)、loadAnimation(...)方法可以创建动画模版。使用play(...)可以播放指定动画。</p>
*@example <caption>以下示例代码，创建了一个 <code>Text</code> 实例。</caption>
*package
*{
	*import laya.display.Animation;
	*import laya.net.Loader;
	*import laya.utils.Handler;
	*public class Animation_Example
	*{
		*public function Animation_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*init();//初始化
			*}
		*private function init():void
		*{
			*var animation:Animation=new Animation();//创建一个 Animation 类的实例对象 animation 。
			*animation.loadAtlas("resource/ani/fighter.json");//加载图集并播放
			*animation.x=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。
			*animation.y=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。
			*animation.interval=50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。
			*animation.play();//播放动画。
			*Laya.stage.addChild(animation);//将 animation 对象添加到显示列表。
			*}
		*}
	*}
*
*@example
*Animation_Example();
*function Animation_Example(){
	*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
	*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
	*init();//初始化
	*}
*function init()
*{
	*var animation=new Laya.Animation();//创建一个 Animation 类的实例对象 animation 。
	*animation.loadAtlas("resource/ani/fighter.json");//加载图集并播放
	*animation.x=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。
	*animation.y=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。
	*animation.interval=50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。
	*animation.play();//播放动画。
	*Laya.stage.addChild(animation);//将 animation 对象添加到显示列表。
	*}
*
*@example
*import Animation=laya.display.Animation;
*class Animation_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*this.init();
		*}
	*private init():void {
		*var animation:Animation=new Laya.Animation();//创建一个 Animation 类的实例对象 animation 。
		*animation.loadAtlas("resource/ani/fighter.json");//加载图集并播放
		*animation.x=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。
		*animation.y=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。
		*animation.interval=50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。
		*animation.play();//播放动画。
		*Laya.stage.addChild(animation);//将 animation 对象添加到显示列表。
		*}
	*}
*new Animation_Example();
*/
//class laya.display.Animation extends laya.display.AnimationPlayerBase
var Animation=(function(_super){
	function Animation(){
		/**@private */
		this._frames=null;
		/**@private */
		this._url=null;
		Animation.__super.call(this);
		this._setControlNode(this);
	}

	__class(Animation,'laya.display.Animation',_super);
	var __proto=Animation.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		this.stop();
		laya.display.Sprite.prototype.destroy.call(this,destroyChild);
		this._frames=null;
		this._labels=null;
	}

	/**
	*<p>开始播放动画。会在动画模版缓存池中查找key值为name的动画模版，存在则用此动画模版初始化当前序列帧， 如果不存在，则使用当前序列帧。</p>
	*<p>play(...)方法被设计为在创建实例后的任何时候都可以被调用，调用后就处于播放状态，当相应的资源加载完毕、调用动画帧填充方法(set frames)或者将实例显示在舞台上时，会判断是否处于播放状态，如果是，则开始播放。</p>
	*<p>配合wrapMode属性，可设置动画播放顺序类型。</p>
	*@param start （可选）指定动画播放开始的索引(int)或帧标签(String)。帧标签可以通过addLabel(...)和removeLabel(...)进行添加和删除。
	*@param loop （可选）是否循环播放。
	*@param name （可选）动画模板在动画模版缓存池中的key，也可认为是动画名称。如果name为空，则播放当前动画序列帧；如果不为空，则在动画模版缓存池中寻找key值为name的动画模版，如果存在则用此动画模版初始化当前序列帧并播放，如果不存在，则仍然播放当前动画序列帧；如果没有当前动画的帧数据，则不播放，但该实例仍然处于播放状态。
	*@param showWarn（可选）是否动画不存在时打印警告
	*/
	__proto.play=function(start,loop,name,showWarn){
		(start===void 0)&& (start=0);
		(loop===void 0)&& (loop=true);
		(name===void 0)&& (name="");
		(showWarn===void 0)&& (showWarn=true);
		if (name)this._setFramesFromCache(name,showWarn);
		this._isPlaying=true;
		this.index=((typeof start=='string'))? this._getFrameByLabel(start):start;
		this.loop=loop;
		this._actionName=name;
		this._isReverse=this.wrapMode==1;
		if (this._frames && this.interval > 0){
			this.timerLoop(this.interval,this,this._frameLoop,null,true,true);
		}
	}

	/**@private */
	__proto._setFramesFromCache=function(name,showWarn){
		(showWarn===void 0)&& (showWarn=false);
		if (this._url)name=this._url+"#"+name;
		if (name && Animation.framesMap[name]){
			var tAniO;
			tAniO=Animation.framesMap[name];
			if ((tAniO instanceof Array)){
				this._frames=Animation.framesMap[name];
				this._count=this._frames.length;
				}else {
				if (tAniO.nodeRoot){
					Animation.framesMap[name]=this._parseGraphicAnimationByData(tAniO);
					tAniO=Animation.framesMap[name];
				}
				this._frames=tAniO.frames;
				this._count=this._frames.length;
				if (!this._frameRateChanged)this._interval=tAniO.interval;
				this._labels=this._copyLabels(tAniO.labels);
			}
			return true;
			}else {
			if (showWarn)console.log("ani not found:",name);
		}
		return false;
	}

	/**@private */
	__proto._copyLabels=function(labels){
		if (!labels)return null;
		var rst;
		rst={};
		var key;
		for (key in labels){
			rst[key]=Utils.copyArray([],labels[key]);
		}
		return rst;
	}

	/**@private */
	__proto._frameLoop=function(){
		if (this._style.visible && this._style.alpha > 0.01){
			_super.prototype._frameLoop.call(this);
		}
	}

	/**@private */
	__proto._displayToIndex=function(value){
		if (this._frames)this.graphics=this._frames[value];
	}

	/**
	*停止动画播放，并清理对象属性。之后可存入对象池，方便对象复用。
	*/
	__proto.clear=function(){
		this.stop();
		this.graphics=null;
		this._frames=null;
		this._labels=null;
	}

	/**
	*<p>根据指定的动画模版初始化当前动画序列帧。选择动画模版的过程如下：1. 动画模版缓存池中key为cacheName的动画模版；2. 如果不存在，则加载指定的图片集合并创建动画模版。注意：只有指定不为空的cacheName，才能将创建好的动画模版以此为key缓存到动画模版缓存池，否则不进行缓存。</p>
	*<p>动画模版缓存池是以一定的内存开销来节省CPU开销，当相同的动画模版被多次使用时，相比于每次都创建新的动画模版，使用动画模版缓存池，只需创建一次，缓存之后多次复用，从而节省了动画模版创建的开销。</p>
	*<p>因为返回值为Animation对象本身，所以可以使用如下语法：ani.loadImages(...).loadImages(...).play(...);。</p>
	*@param urls 图片路径集合。需要创建动画模版时，会以此为数据源。参数形如：[url1,url2,url3,...]。
	*@param cacheName （可选）动画模板在动画模版缓存池中的key。如果此参数不为空，表示使用动画模版缓存池。如果动画模版缓存池中存在key为cacheName的动画模版，则使用此模版。否则，创建新的动画模版，如果cacheName不为空，则以cacheName为key缓存到动画模版缓存池中，如果cacheName为空，不进行缓存。
	*@return 返回Animation对象本身。
	*/
	__proto.loadImages=function(urls,cacheName){
		(cacheName===void 0)&& (cacheName="");
		this._url="";
		if (!this._setFramesFromCache(cacheName)){
			this.frames=Animation.framesMap[cacheName] ? Animation.framesMap[cacheName] :Animation.createFrames(urls,cacheName);
		}
		return this;
	}

	/**
	*<p>根据指定的动画模版初始化当前动画序列帧。选择动画模版的过程如下：1. 动画模版缓存池中key为cacheName的动画模版；2. 如果不存在，则加载指定的图集并创建动画模版。</p>
	*<p>注意：只有指定不为空的cacheName，才能将创建好的动画模版以此为key缓存到动画模版缓存池，否则不进行缓存。</p>
	*<p>动画模版缓存池是以一定的内存开销来节省CPU开销，当相同的动画模版被多次使用时，相比于每次都创建新的动画模版，使用动画模版缓存池，只需创建一次，缓存之后多次复用，从而节省了动画模版创建的开销。</p>
	*<p>因为返回值为Animation对象本身，所以可以使用如下语法：ani.loadAtlas(...).loadAtlas(...).play(...);。</p>
	*@param url 图集路径。需要创建动画模版时，会以此为数据源。
	*@param loaded （可选）使用指定图集初始化动画完毕的回调。
	*@param cacheName （可选）动画模板在动画模版缓存池中的key。如果此参数不为空，表示使用动画模版缓存池。如果动画模版缓存池中存在key为cacheName的动画模版，则使用此模版。否则，创建新的动画模版，如果cacheName不为空，则以cacheName为key缓存到动画模版缓存池中，如果cacheName为空，不进行缓存。
	*@return 返回动画本身。
	*/
	__proto.loadAtlas=function(url,loaded,cacheName){
		(cacheName===void 0)&& (cacheName="");
		this._url="";
		var _this_=this;
		function onLoaded (loadUrl){
			if (url===loadUrl){
				_this_.frames=Animation.framesMap[cacheName] ? Animation.framesMap[cacheName] :Animation.createFrames(url,cacheName);
				if (loaded)loaded.run();
			}
		}
		if (!_this_._setFramesFromCache(cacheName)){
			if (Loader.getAtlas(url))onLoaded(url);
			else Laya.loader.load(url,Handler.create(null,onLoaded,[url]),null,"atlas");
		}
		return this;
	}

	/**
	*<p>加载并解析由LayaAir IDE制作的动画文件，此文件中可能包含多个动画。默认帧率为在IDE中设计的帧率，如果调用过set interval，则使用此帧间隔对应的帧率。加载后创建动画模版，并缓存到动画模版缓存池，key "url#动画名称" 对应相应动画名称的动画模板，key "url#" 对应动画模版集合的默认动画模版。</p>
	*<p>注意：如果调用本方法前，还没有预加载动画使用的图集，请将atlas参数指定为对应的图集路径，否则会导致动画创建失败。</p>
	*<p>动画模版缓存池是以一定的内存开销来节省CPU开销，当相同的动画模版被多次使用时，相比于每次都创建新的动画模版，使用动画模版缓存池，只需创建一次，缓存之后多次复用，从而节省了动画模版创建的开销。</p>
	*<p>因为返回值为Animation对象本身，所以可以使用如下语法：ani.loadAnimation(...).loadAnimation(...).play(...);。</p>
	*@param url 动画文件路径。可由LayaAir IDE创建并发布。
	*@param loaded （可选）使用指定动画资源初始化动画完毕的回调。
	*@param atlas （可选）动画用到的图集地址（可选）。
	*@return 返回动画本身。
	*/
	__proto.loadAnimation=function(url,loaded,atlas){
		this._url=url;
		var _this_=this;
		if (!this._actionName)this._actionName="";
		if (!_this_._setFramesFromCache("")){
			if (!atlas || Loader.getAtlas(atlas)){
				this._loadAnimationData(url,loaded,atlas);
				}else {
				Laya.loader.load(atlas,Handler.create(this,this._loadAnimationData,[url,loaded,atlas]),null,"atlas")
			}
			}else {
			_this_._setFramesFromCache(this._actionName,true);
			this.index=0;
			if (loaded)loaded.run();
		}
		return this;
	}

	/**@private */
	__proto._loadAnimationData=function(url,loaded,atlas){
		var _$this=this;
		if (atlas && !Loader.getAtlas(atlas)){
			console.warn("atlas load fail:"+atlas);
			return;
		};
		var _this_=this;
		function onLoaded (loadUrl){
			if (!Loader.getRes(loadUrl))return;
			if (url===loadUrl){
				var tAniO;
				if (!Animation.framesMap[url+"#"]){
					var aniData=_this_._parseGraphicAnimation(Loader.getRes(url));
					if (!aniData)return;
					var aniList=aniData.animationList;
					var i=0,len=aniList.length;
					var defaultO;
					for (i=0;i < len;i++){
						tAniO=aniList[i];
						Animation.framesMap[url+"#"+tAniO.name]=tAniO;
						if (!defaultO)defaultO=tAniO;
					}
					if (defaultO){
						Animation.framesMap[url+"#"]=defaultO;
						_this_._setFramesFromCache(_$this._actionName,true);
						_$this.index=0;
					}
					_$this._checkResumePlaying();
					}else {
					_this_._setFramesFromCache(_$this._actionName,true);
					_$this.index=0;
					_$this._checkResumePlaying();
				}
				if (loaded)loaded.run();
			}
		}
		if (Loader.getRes(url))onLoaded(url);
		else Laya.loader.load(url,Handler.create(null,onLoaded,[url]),null,"json");
		Loader.clearRes(url);
	}

	/**@private */
	__proto._parseGraphicAnimation=function(animationData){
		return GraphicAnimation.parseAnimationData(animationData);
	}

	/**@private */
	__proto._parseGraphicAnimationByData=function(animationObject){
		return GraphicAnimation.parseAnimationByData(animationObject);
	}

	/**
	*当前动画的帧图像数组。本类中，每个帧图像是一个Graphics对象，而动画播放就是定时切换Graphics对象的过程。
	*/
	__getset(0,__proto,'frames',function(){
		return this._frames;
		},function(value){
		this._frames=value;
		if (value){
			this._count=value.length;
			if (this._isPlaying)this.play(this._index,this.loop,this._actionName);
			else this.index=this._index;
		}
	});

	/**
	*是否自动播放，默认为false。如果设置为true，则动画被创建并添加到舞台后自动播放。
	*/
	__getset(0,__proto,'autoPlay',null,function(value){
		if (value)this.play();
		else this.stop();
	});

	/**
	*<p>动画数据源。</p>
	*<p>类型如下：<br/>
	*1. LayaAir IDE动画文件路径：使用此类型需要预加载所需的图集资源，否则会创建失败，如果不想预加载或者需要创建完毕的回调，请使用loadAnimation(...)方法；<br/>
	*2. 图集路径：使用此类型创建的动画模版不会被缓存到动画模版缓存池中，如果需要缓存或者创建完毕的回调，请使用loadAtlas(...)方法；<br/>
	*3. 图片路径集合：使用此类型创建的动画模版不会被缓存到动画模版缓存池中，如果需要缓存，请使用loadImages(...)方法。</p>
	*@param value 数据源。比如：图集："xx/a1.atlas"；图片集合："a1.png,a2.png,a3.png"；LayaAir IDE动画"xx/a1.ani"。
	*/
	__getset(0,__proto,'source',null,function(value){
		if (value.indexOf(".ani")>-1)this.loadAnimation(value);
		else if (value.indexOf(".json")>-1 || value.indexOf("als")>-1 || value.indexOf("atlas")>-1)this.loadAtlas(value);
		else this.loadImages(value.split(","));
	});

	/**
	*设置自动播放的动画名称，在LayaAir IDE中可以创建的多个动画组成的动画集合，选择其中一个动画名称进行播放。
	*/
	__getset(0,__proto,'autoAnimation',null,function(value){
		this.play(0,true,value,false);
	});

	Animation.createFrames=function(url,name){
		var arr,i=0,n=0,g;
		if ((typeof url=='string')){
			var atlas=Loader.getAtlas(url);
			if (atlas && atlas.length){
				arr=[];
				for (i=0,n=atlas.length;i < n;i++){
					g=new RunDriver.createGraphics();
					g.drawTexture(Loader.getRes(atlas[i]),0,0);
					arr.push(g);
				}
			}
			}else if ((url instanceof Array)){
			arr=[];
			for (i=0,n=url.length;i < n;i++){
				g=new RunDriver.createGraphics();
				g.loadImage(url[i],0,0);
				arr.push(g);
			}
		}
		if (name)Animation.framesMap[name]=arr;
		return arr;
	}

	Animation.clearCache=function(key){
		var cache=Animation.framesMap;
		var val;
		var key2=key+"#";
		for (val in cache){
			if (val===key || val.indexOf(key2)==0){
				delete Animation.framesMap[val];
			}
		}
	}

	Animation.framesMap={};
	return Animation;
})(AnimationPlayerBase)


/**
*关键帧动画播放类。
*/
//class laya.display.FrameAnimation extends laya.display.AnimationPlayerBase
var FrameAnimation=(function(_super){
	function FrameAnimation(){
		/**
		*@private
		*id对象表
		*/
		this._targetDic=null;
		/**
		*@private
		*动画数据
		*/
		this._animationData=null;
		/**@private */
		this._animationNewFrames=null;
		FrameAnimation.__super.call(this);
		if (FrameAnimation._sortIndexFun==null){
			FrameAnimation._sortIndexFun=MathUtil.sortByKey("index",false,true);
		}
	}

	__class(FrameAnimation,'laya.display.FrameAnimation',_super);
	var __proto=FrameAnimation.prototype;
	/**
	*@private
	*初始化动画数据
	*@param targetDic 对象表
	*@param animationData 动画数据
	*
	*/
	__proto._setUp=function(targetDic,animationData){
		this._labels=null;
		this._animationNewFrames=null;
		this._targetDic=targetDic;
		this._animationData=animationData;
		this.interval=1000 / animationData.frameRate;
		if (animationData.parsed){
			this._count=animationData.count;
			this._labels=animationData.labels;
			this._animationNewFrames=animationData.animationNewFrames;
			}else {
			this._animationNewFrames=[];
			this._calculateDatas();
		}
		animationData.parsed=true;
		animationData.labels=this._labels;
		animationData.count=this._count;
		animationData.animationNewFrames=this._animationNewFrames;
	}

	/**@inheritDoc */
	__proto.clear=function(){
		_super.prototype.clear.call(this);
		this._targetDic=null;
		this._animationData=null;
	}

	/**@inheritDoc */
	__proto._displayToIndex=function(value){
		if (!this._animationData)return;
		if (value < 0)value=0;
		if (value > this._count)value=this._count;
		var nodes=this._animationData.nodes,i=0,len=nodes.length;
		for (i=0;i < len;i++){
			this._displayNodeToFrame(nodes[i],value);
		}
	}

	/**
	*@private
	*将节点设置到某一帧的状态
	*@param node 节点ID
	*@param frame
	*@param targetDic 节点表
	*
	*/
	__proto._displayNodeToFrame=function(node,frame,targetDic){
		if (!targetDic)targetDic=this._targetDic;
		var target=targetDic[node.target];
		if (!target){
			return;
		};
		var frames=node.frames,key,propFrames,value;
		var keys=node.keys,i=0,len=keys.length;
		for (i=0;i < len;i++){
			key=keys[i];
			propFrames=frames[key];
			if (propFrames.length > frame){
				value=propFrames[frame];
				}else {
				value=propFrames[propFrames.length-1];
			}
			target[key]=value;
		}
	}

	/**
	*@private
	*计算帧数据
	*
	*/
	__proto._calculateDatas=function(){
		if (!this._animationData)return;
		var nodes=this._animationData.nodes,i=0,len=nodes.length,tNode;
		this._count=0;
		for (i=0;i < len;i++){
			tNode=nodes[i];
			this._calculateNodeKeyFrames(tNode);
		}
		this._count+=1;
	}

	/**
	*@private
	*计算某个节点的帧数据
	*@param node
	*
	*/
	__proto._calculateNodeKeyFrames=function(node){
		var keyFrames=node.keyframes,key,tKeyFrames,target=node.target;
		if (!node.frames){
			node.frames={};
		}
		if (!node.keys){
			node.keys=[];
			}else {
			node.keys.length=0;
		}
		if (!node.initValues){
			node.initValues={};
		}
		for (key in keyFrames){
			tKeyFrames=keyFrames[key];
			if (!node.frames[key]){
				node.frames[key]=[];
			}
			if (this._targetDic && this._targetDic[target]){
				node.initValues[key]=this._targetDic[target][key];
			}
			tKeyFrames.sort(FrameAnimation._sortIndexFun);
			node.keys.push(key);
			this._calculateNodePropFrames(tKeyFrames,node.frames[key],key,target);
		}
	}

	/**
	*将动画控制对象还原到动画控制之前的状态
	*/
	__proto.resetToInitState=function(){
		if (!this._targetDic)return;
		if (!this._animationData)return;
		var nodes=this._animationData.nodes,i=0,len=nodes.length;
		var tNode;
		var initValues;
		for (i=0;i < len;i++){
			tNode=nodes[i];
			initValues=tNode.initValues;
			if (!initValues)continue ;
			var target=this._targetDic[tNode.target];
			if (!target)continue ;
			var key;
			for (key in initValues){
				target[key]=initValues[key];
			}
		}
	}

	/**
	*@private
	*计算节点某个属性的帧数据
	*@param keyframes
	*@param frames
	*@param key
	*@param target
	*
	*/
	__proto._calculateNodePropFrames=function(keyframes,frames,key,target){
		var i=0,len=keyframes.length-1;
		frames.length=keyframes[len].index+1;
		for (i=0;i < len;i++){
			this._dealKeyFrame(keyframes[i]);
			this._calculateFrameValues(keyframes[i],keyframes[i+1],frames);
		}
		if (len==0){
			frames[0]=keyframes[0].value;
			if (this._animationNewFrames)
				this._animationNewFrames[keyframes[0].index]=true;
		}
		this._dealKeyFrame(keyframes[i]);
	}

	/**
	*@private
	*
	*/
	__proto._dealKeyFrame=function(keyFrame){
		if (keyFrame.label && keyFrame.label !="")this.addLabel(keyFrame.label,keyFrame.index);
	}

	/**
	*@private
	*计算两个关键帧直接的帧数据
	*@param startFrame
	*@param endFrame
	*@param result
	*
	*/
	__proto._calculateFrameValues=function(startFrame,endFrame,result){
		var i=0,easeFun;
		var start=startFrame.index,end=endFrame.index;
		var startValue=startFrame.value;
		var dValue=endFrame.value-startFrame.value;
		var dLen=end-start;
		if (end > this._count)this._count=end;
		if (startFrame.tween){
			easeFun=Ease[startFrame.tweenMethod];
			if (easeFun==null){
				easeFun=Ease.linearNone;
			}
			for (i=start;i < end;i++){
				result[i]=easeFun(i-start,startValue,dValue,dLen);
				if (this._animationNewFrames){
					this._animationNewFrames[i]=true;
				}
			}
			}else {
			for (i=start;i < end;i++){
				result[i]=startValue;
			}
		}
		if (this._animationNewFrames){
			this._animationNewFrames[startFrame.index]=true;
			this._animationNewFrames[endFrame.index]=true;
		}
		result[endFrame.index]=endFrame.value;
	}

	FrameAnimation._sortIndexFun=null;
	return FrameAnimation;
})(AnimationPlayerBase)


/**
*@private
*/
//class laya.html.dom.HTMLBrElement extends laya.html.dom.HTMLElement
var HTMLBrElement=(function(_super){
	function HTMLBrElement(){
		HTMLBrElement.__super.call(this);
		this.style.lineElement=true;
		this.style.block=true;
	}

	__class(HTMLBrElement,'laya.html.dom.HTMLBrElement',_super);
	return HTMLBrElement;
})(HTMLElement)


/**
*DIV标签
*/
//class laya.html.dom.HTMLDivElement extends laya.html.dom.HTMLElement
var HTMLDivElement=(function(_super){
	function HTMLDivElement(){
		/**实际内容的高 */
		this.contextHeight=NaN;
		/**实际内容的宽 */
		this.contextWidth=NaN;
		HTMLDivElement.__super.call(this);
		this.style.block=true;
		this.style.lineElement=true;
		this.style.width=200;
		this.style.height=200;
		HTMLStyleElement;
	}

	__class(HTMLDivElement,'laya.html.dom.HTMLDivElement',_super);
	var __proto=HTMLDivElement.prototype;
	/**
	*追加内容，解析并对显示对象排版
	*@param text
	*/
	__proto.appendHTML=function(text){
		HTMLParse.parse(this,text,this.URI);
		this.layout();
	}

	/**
	*@private
	*@param out
	*@return
	*/
	__proto._addChildsToLayout=function(out){
		var words=this._getWords();
		if (words==null && this._childs.length==0)return false;
		words && words.forEach(function(o){
			out.push(o);
		});
		var tFirstKey=true;
		for (var i=0,len=this._childs.length;i < len;i++){
			var o=this._childs[i];
			if (tFirstKey){
				tFirstKey=false;
				}else {
				out.push(null);
			}
			o._addToLayout(out)
		}
		return true;
	}

	/**
	*@private
	*@param out
	*/
	__proto._addToLayout=function(out){
		this.layout();
	}

	/**
	*@private
	*对显示内容进行排版
	*/
	__proto.layout=function(){
		if (!this.style)return;
		this.style._type |=0x200;
		var tArray=Layout.layout(this);
		if (tArray){
			if (!this._$P.mHtmlBounds)this._set$P("mHtmlBounds",new Rectangle());
			var tRectangle=this._$P.mHtmlBounds;
			tRectangle.x=tRectangle.y=0;
			tRectangle.width=this.contextWidth=tArray[0];
			tRectangle.height=this.contextHeight=tArray[1];
			this.setBounds(tRectangle);
		}
	}

	/**
	*获取对象的高
	*/
	__getset(0,__proto,'height',function(){
		if (this._height)return this._height;
		return this.contextHeight;
	},_super.prototype._$set_height);

	/**
	*设置标签内容
	*/
	__getset(0,__proto,'innerHTML',null,function(text){
		this.destroyChildren();
		this.appendHTML(text);
	});

	/**
	*获取对象的宽
	*/
	__getset(0,__proto,'width',function(){
		if (this._width)return this._width;
		return this.contextWidth;
		},function(value){
		var changed=false;
		if (value===0){
			changed=value !=this._width;
			}else{
			changed=value !=this.width;
		}
		Laya.superSet(HTMLElement,this,'width',value);
		if(changed)
			this.layout();
	});

	return HTMLDivElement;
})(HTMLElement)


/**
*@private
*/
//class laya.html.dom.HTMLDocument extends laya.html.dom.HTMLElement
var HTMLDocument=(function(_super){
	function HTMLDocument(){
		this.all=new Array;
		this.styleSheets=CSSStyle.styleSheets;
		HTMLDocument.__super.call(this);
	}

	__class(HTMLDocument,'laya.html.dom.HTMLDocument',_super);
	var __proto=HTMLDocument.prototype;
	__proto.getElementById=function(id){
		return this.all[id];
	}

	__proto.setElementById=function(id,e){
		this.all[id]=e;
	}

	__static(HTMLDocument,
	['document',function(){return this.document=new HTMLDocument();}
	]);
	return HTMLDocument;
})(HTMLElement)


/**
*@private
*/
//class laya.html.dom.HTMLImageElement extends laya.html.dom.HTMLElement
var HTMLImageElement=(function(_super){
	function HTMLImageElement(){
		this._tex=null;
		this._url=null;
		this._renderArgs=[];
		HTMLImageElement.__super.call(this);
		this.style.block=true;
	}

	__class(HTMLImageElement,'laya.html.dom.HTMLImageElement',_super);
	var __proto=HTMLImageElement.prototype;
	__proto._addToLayout=function(out){
		!this._style.absolute && out.push(this);
	}

	__proto.render=function(context,x,y){
		if (!this._tex || !this._tex.loaded || !this._tex.loaded || this._width < 1 || this._height < 1)return;
		Stat.spriteCount++;
		this._renderArgs[0]=this._tex;
		this._renderArgs[1]=this.x;
		this._renderArgs[2]=this.y;
		this._renderArgs[3]=this.width || this._tex.width;
		this._renderArgs[4]=this.height || this._tex.height;
		context.ctx.drawTexture2(x,y,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs);
	}

	/**
	*@private
	*/
	__proto.layaoutCallNative=function(){
		var n=0;
		if (this._childs &&(n=this._childs.length)> 0){
			for (var i=0;i < n;i++){
				this._childs[i].layaoutCallNative && this._childs[i].layaoutCallNative();
			}
		}
	}

	__getset(0,__proto,'src',null,function(url){
		var _$this=this;
		url=this.formatURL(url);
		if (this._url==url)return;
		this._url=url;
		var tex=this._tex=Loader.getRes(url);
		if (!tex){
			this._tex=tex=new Texture();
			tex.load(url);
			Loader.cacheRes(url,tex);
		}
		function onloaded (){
			var style=_$this._style;
			var w=style.widthed(_$this)?-1:_$this._tex.width;
			var h=style.heighted(_$this)?-1:_$this._tex.height;
			if (!style.widthed(_$this)&& _$this._width !=_$this._tex.width){
				_$this.width=_$this._tex.width;
				_$this.parent && (_$this.parent)._layoutLater();
			}
			if (!style.heighted(_$this)&& _$this._height !=_$this._tex.height){
				_$this.height=_$this._tex.height;
				_$this.parent && (_$this.parent)._layoutLater();
			}
			if (Render.isConchApp){
				_$this._renderArgs[0]=_$this._tex;
				_$this._renderArgs[1]=_$this.x;
				_$this._renderArgs[2]=_$this.y;
				_$this._renderArgs[3]=_$this.width || _$this._tex.width;
				_$this._renderArgs[4]=_$this.height || _$this._tex.height;
				_$this.graphics.drawTexture(_$this._tex,0,0,_$this._renderArgs[3],_$this._renderArgs[4]);
			}
			_$this.repaint();
			_$this.parentRepaint();
		}
		tex.loaded?onloaded():tex.on("loaded",null,onloaded);
	});

	return HTMLImageElement;
})(HTMLElement)


/**
*@private
*/
//class laya.html.dom.HTMLStyleElement extends laya.html.dom.HTMLElement
var HTMLStyleElement=(function(_super){
	function HTMLStyleElement(){
		HTMLStyleElement.__super.call(this);
		this.visible=false;
	}

	__class(HTMLStyleElement,'laya.html.dom.HTMLStyleElement',_super);
	var __proto=HTMLStyleElement.prototype;
	/**
	*解析样式
	*/
	__getset(0,__proto,'text',_super.prototype._$get_text,function(value){
		CSSStyle.parseCSS(value,null);
	});

	return HTMLStyleElement;
})(HTMLElement)


/**
*@private
*/
//class laya.particle.shader.ParticleShader extends laya.webgl.shader.Shader
var ParticleShader=(function(_super){
	function ParticleShader(){
		ParticleShader.__super.call(this,ParticleShader.vs,ParticleShader.ps,"ParticleShader");
	}

	__class(ParticleShader,'laya.particle.shader.ParticleShader',_super);
	__static(ParticleShader,
	['vs',function(){return this.vs="attribute vec4 a_CornerTextureCoordinate;\nattribute vec3 a_Position;\nattribute vec3 a_Velocity;\nattribute vec4 a_StartColor;\nattribute vec4 a_EndColor;\nattribute vec3 a_SizeRotation;\nattribute vec2 a_Radius;\nattribute vec4 a_Radian;\nattribute float a_AgeAddScale;\nattribute float a_Time;\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\n\nuniform float u_CurrentTime;\nuniform float u_Duration;\nuniform float u_EndVelocity;\nuniform vec3 u_Gravity;\n\n#ifdef PARTICLE3D\n uniform mat4 u_WorldMat;\n uniform mat4 u_View;\n uniform mat4 u_Projection;\n uniform vec2 u_ViewportScale;\n#else\n uniform vec2 size;\n uniform mat4 mmat;\n uniform mat4 u_mmat;\n#endif\n\nvec4 ComputeParticlePosition(in vec3 position, in vec3 velocity,in float age,in float normalizedAge)\n{\n\n   float startVelocity = length(velocity);//起始标量速度\n   float endVelocity = startVelocity * u_EndVelocity;//结束标量速度\n\n   float velocityIntegral = startVelocity * normalizedAge +(endVelocity - startVelocity) * normalizedAge *normalizedAge/2.0;//计算当前速度的标量（单位空间），vt=v0*t+(1/2)*a*(t^2)\n   \n   vec3 addPosition = normalize(velocity) * velocityIntegral * u_Duration;//计算受自身速度影响的位置，转换标量到矢量    \n   addPosition += u_Gravity * age * normalizedAge;//计算受重力影响的位置\n   \n   float radius=mix(a_Radius.x, a_Radius.y, normalizedAge); //计算粒子受半径和角度影响（无需计算角度和半径时，可用宏定义优化屏蔽此计算）\n   float radianHorizontal =mix(a_Radian.x,a_Radian.z,normalizedAge);\n   float radianVertical =mix(a_Radian.y,a_Radian.w,normalizedAge);\n   \n   float r =cos(radianVertical)* radius;\n   addPosition.y += sin(radianVertical) * radius;\n	\n   addPosition.x += cos(radianHorizontal) *r;\n   addPosition.z += sin(radianHorizontal) *r;\n  \n   #ifdef PARTICLE3D\n   position+=addPosition;\n    return  u_Projection*u_View*u_WorldMat*(vec4(position, 1.0));\n   #else\n   addPosition.y=-addPosition.y;//2D粒子位置更新需要取负，2D粒子坐标系Y轴正向朝上\n   position+=addPosition;\n    return  vec4(position,1.0);\n   #endif\n}\n\nfloat ComputeParticleSize(in float startSize,in float endSize, in float normalizedAge)\n{    \n    float size = mix(startSize, endSize, normalizedAge);\n    \n	#ifdef PARTICLE3D\n    //Project the size into screen coordinates.\n     return size * u_Projection[1][1];\n	#else\n	 return size;\n	#endif\n}\n\nmat2 ComputeParticleRotation(in float rot,in float age)\n{    \n    float rotation =rot * age;\n    //计算2x2旋转矩阵.\n    float c = cos(rotation);\n    float s = sin(rotation);\n    return mat2(c, -s, s, c);\n}\n\nvec4 ComputeParticleColor(in vec4 startColor,in vec4 endColor,in float normalizedAge)\n{\n	vec4 color=mix(startColor,endColor,normalizedAge);\n    //硬编码设置，使粒子淡入很快，淡出很慢,6.7的缩放因子把置归一在0到1之间，可以谷歌x*(1-x)*(1-x)*6.7的制图表\n    color.a *= normalizedAge * (1.0-normalizedAge) * (1.0-normalizedAge) * 6.7;\n   \n    return color;\n}\n\nvoid main()\n{\n   float age = u_CurrentTime - a_Time;\n   age *= 1.0 + a_AgeAddScale;\n   float normalizedAge = clamp(age / u_Duration,0.0,1.0);\n   gl_Position = ComputeParticlePosition(a_Position, a_Velocity, age, normalizedAge);//计算粒子位置\n   float pSize = ComputeParticleSize(a_SizeRotation.x,a_SizeRotation.y, normalizedAge);\n   mat2 rotation = ComputeParticleRotation(a_SizeRotation.z, age);\n	\n   #ifdef PARTICLE3D\n	gl_Position.xy += (rotation*a_CornerTextureCoordinate.xy) * pSize * u_ViewportScale;\n   #else\n    mat4 mat=u_mmat*mmat;\n    gl_Position=vec4((mat*gl_Position).xy,0.0,1.0);\n	gl_Position.xy += (rotation*a_CornerTextureCoordinate.xy) * pSize*vec2(mat[0][0],mat[1][1]);\n    gl_Position=vec4((gl_Position.x/size.x-0.5)*2.0,(0.5-gl_Position.y/size.y)*2.0,0.0,1.0);\n   #endif\n   \n   v_Color = ComputeParticleColor(a_StartColor,a_EndColor, normalizedAge);\n   v_TextureCoordinate =a_CornerTextureCoordinate.zw;\n}\n\n";},'ps',function(){return this.ps="#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\nuniform sampler2D u_texture;\n\nvoid main()\n{	\n	gl_FragColor=texture2D(u_texture,v_TextureCoordinate)*v_Color;\n	gl_FragColor.xyz *= v_Color.w;\n}";}
	]);
	return ParticleShader;
})(Shader)


//class laya.webgl.shader.d2.Shader2X extends laya.webgl.shader.Shader
var Shader2X=(function(_super){
	function Shader2X(vs,ps,saveName,nameMap){
		this._params2dQuick1=null;
		this._params2dQuick2=null;
		this._shaderValueWidth=NaN;
		this._shaderValueHeight=NaN;
		Shader2X.__super.call(this,vs,ps,saveName,nameMap);
	}

	__class(Shader2X,'laya.webgl.shader.d2.Shader2X',_super);
	var __proto=Shader2X.prototype;
	__proto.upload2dQuick1=function(shaderValue){
		this.upload(shaderValue,this._params2dQuick1 || this._make2dQuick1());
	}

	__proto._make2dQuick1=function(){
		if (!this._params2dQuick1){
			this.activeResource();
			this._params2dQuick1=[];
			var params=this._params,one;
			for (var i=0,n=params.length;i < n;i++){
				one=params[i];
				if (!Render.isFlash && (one.name==="size" || one.name==="position" || one.name==="texcoord"))continue ;
				this._params2dQuick1.push(one);
			}
		}
		return this._params2dQuick1;
	}

	__proto.disposeResource=function(){
		_super.prototype.disposeResource.call(this);
		this._params2dQuick1=null;
		this._params2dQuick2=null;
	}

	__proto.upload2dQuick2=function(shaderValue){
		this.upload(shaderValue,this._params2dQuick2 || this._make2dQuick2());
	}

	__proto._make2dQuick2=function(){
		if (!this._params2dQuick2){
			this.activeResource();
			this._params2dQuick2=[];
			var params=this._params,one;
			for (var i=0,n=params.length;i < n;i++){
				one=params[i];
				if (!Render.isFlash && (one.name==="size"))continue ;
				this._params2dQuick2.push(one);
			}
		}
		return this._params2dQuick2;
	}

	Shader2X.create=function(vs,ps,saveName,nameMap){
		return new Shader2X(vs,ps,saveName,nameMap);
	}

	return Shader2X;
})(Shader)


/**
*@private
*<p> <code>HTMLImage</code> 用于创建 HTML Image 元素。</p>
*<p>请使用 <code>HTMLImage.create()<code>获取新实例，不要直接使用 <code>new HTMLImage<code> 。</p>
*/
//class laya.resource.HTMLImage extends laya.resource.FileBitmap
var HTMLImage=(function(_super){
	function HTMLImage(src,def){
		/**异步加载锁*/
		this._recreateLock=false;
		/**异步加载完成后是否需要释放（有可能在恢复过程中,再次被释放，用此变量做标记）*/
		this._needReleaseAgain=false;
		this._enableMerageInAtlas=true;
		HTMLImage.__super.call(this);
		this._init_(src,def);
	}

	__class(HTMLImage,'laya.resource.HTMLImage',_super);
	var __proto=HTMLImage.prototype;
	__proto._init_=function(src,def){
		this._src=src;
		this._source=new Browser.window.Image();
		if (def){
			def.onload && (this.onload=def.onload);
			def.onerror && (this.onerror=def.onerror);
			def.onCreate && def.onCreate(this);
		}
		if (src.indexOf("data:image")!=0)this._source.crossOrigin="";
		(src)&& (this._source.src=src);
	}

	/**
	*@inheritDoc
	*/
	__proto.recreateResource=function(){
		var _$this=this;
		if (this._src==="")
			throw new Error("src no null！");
		this._needReleaseAgain=false;
		if (!this._source){
			this._recreateLock=true;
			var _this=this;
			this._source=new Browser.window.Image();
			this._source.crossOrigin="";
			this._source.onload=function (){
				if (_this._needReleaseAgain){
					_this._needReleaseAgain=false;
					_this._source.onload=null;
					_this._source=null;
					return;
				}
				_this._source.onload=null;
				_this.memorySize=_$this._w *_$this._h *4;
				_this._recreateLock=false;
				_this.completeCreate();
			};
			this._source.src=this._src;
			}else {
			if (this._recreateLock)
				return;
			this.memorySize=this._w *this._h *4;
			this._recreateLock=false;
			this.completeCreate();
		}
	}

	/**
	*@inheritDoc
	*/
	__proto.disposeResource=function(){
		if (this._recreateLock)
			this._needReleaseAgain=true;
		(this._source)&& (this._source=null,this.memorySize=0);
	}

	/***调整尺寸。*/
	__proto.onresize=function(){
		this._w=this._source.width;
		this._h=this._source.height;
	}

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'onload',null,function(value){
		var _$this=this;
		this._onload=value;
		this._source && (this._source.onload=this._onload !=null ? (function(){
			_$this.onresize();
			_$this._onload();
		}):null);
	});

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'onerror',null,function(value){
		var _$this=this;
		this._onerror=value;
		this._source && (this._source.onerror=this._onerror !=null ? (function(){
			_$this._onerror()
		}):null);
	});

	__getset(0,__proto,'enableMerageInAtlas',function(){
		return this._enableMerageInAtlas;
		},function(value){
		this._enableMerageInAtlas=value;
		if (Render.isConchApp){
			if (this._source)this._source.enableMerageInAtlas=value;
		}
	});

	HTMLImage.create=function(src,def){
		return new HTMLImage(src,def);
	}

	return HTMLImage;
})(FileBitmap)


//class laya.webgl.utils.IndexBuffer2D extends laya.webgl.utils.Buffer2D
var IndexBuffer2D=(function(_super){
	function IndexBuffer2D(bufferUsage){
		this._uint8Array=null;
		this._uint16Array=null;
		(bufferUsage===void 0)&& (bufferUsage=0x88E4);
		IndexBuffer2D.__super.call(this);
		this._bufferUsage=bufferUsage;
		this._bufferType=0x8893;
		Render.isFlash || (this._buffer=new ArrayBuffer(8));
	}

	__class(IndexBuffer2D,'laya.webgl.utils.IndexBuffer2D',_super);
	var __proto=IndexBuffer2D.prototype;
	__proto._checkArrayUse=function(){
		this._uint8Array && (this._uint8Array=new Uint8Array(this._buffer));
		this._uint16Array && (this._uint16Array=new Uint16Array(this._buffer));
	}

	__proto.getUint8Array=function(){
		return this._uint8Array || (this._uint8Array=new Uint8Array(this._buffer));
	}

	__proto.getUint16Array=function(){
		return this._uint16Array || (this._uint16Array=new Uint16Array(this._buffer));
	}

	__proto.destory=function(){
		this._uint16Array=null;
		this._uint8Array=null;
		this._buffer=null;
	}

	IndexBuffer2D.QuadrangleIB=null;
	IndexBuffer2D.create=function(bufferUsage){
		(bufferUsage===void 0)&& (bufferUsage=0x88E4);
		return new IndexBuffer2D(bufferUsage);
	}

	return IndexBuffer2D;
})(Buffer2D)


//class laya.webgl.utils.VertexBuffer2D extends laya.webgl.utils.Buffer2D
var VertexBuffer2D=(function(_super){
	function VertexBuffer2D(vertexStride,bufferUsage){
		this._floatArray32=null;
		this._vertexStride=0;
		VertexBuffer2D.__super.call(this);
		this._vertexStride=vertexStride;
		this._bufferUsage=bufferUsage;
		this._bufferType=0x8892;
		Render.isFlash || (this._buffer=new ArrayBuffer(8));
		this.getFloat32Array();
	}

	__class(VertexBuffer2D,'laya.webgl.utils.VertexBuffer2D',_super);
	var __proto=VertexBuffer2D.prototype;
	__proto.getFloat32Array=function(){
		return this._floatArray32 || (this._floatArray32=new Float32Array(this._buffer));
	}

	__proto.bind=function(ibBuffer){
		(ibBuffer)&& (ibBuffer._bind());
		this._bind();
	}

	__proto.insertData=function(data,pos){
		var vbdata=this.getFloat32Array();
		vbdata.set(data,pos);
		this._upload=true;
	}

	__proto.bind_upload=function(ibBuffer){
		(ibBuffer._bind_upload())|| (ibBuffer._bind());
		(this._bind_upload())|| (this._bind());
	}

	__proto._checkArrayUse=function(){
		this._floatArray32 && (this._floatArray32=new Float32Array(this._buffer));
	}

	__proto.disposeResource=function(){
		_super.prototype.disposeResource.call(this);
		var enableAtributes=Buffer._enableAtributes;
		if (!Render.isConchWebGL){
			for (var i=0;i < 10;i++){
				WebGL.mainContext.disableVertexAttribArray(i);
				enableAtributes[i]=null;
			}
		}
	}

	//}
	__proto.destory=function(){
		this._byteLength=0;
		this._upload=true;
		this._buffer=null;
		this._floatArray32=null;
	}

	__getset(0,__proto,'vertexStride',function(){
		return this._vertexStride;
	});

	VertexBuffer2D.create=function(vertexStride,bufferUsage){
		(bufferUsage===void 0)&& (bufferUsage=0x88E8);
		return new VertexBuffer2D(vertexStride,bufferUsage);
	}

	return VertexBuffer2D;
})(Buffer2D)


/**
*<code>View</code> 是一个视图类。
*@internal <p><code>View</code></p>
*/
//class laya.ui.View extends laya.ui.Box
var View=(function(_super){
	var DataWatcher;
	function View(){
		/**@private */
		this._idMap=null;
		/**@private */
		this._aniList=null;
		/**@private */
		this._watchMap={};
		View.__super.call(this);
	}

	__class(View,'laya.ui.View',_super);
	var __proto=View.prototype;
	/**
	*@private
	*通过视图数据创建视图。
	*@param uiView 视图数据信息。
	*/
	__proto.createView=function(uiView){
		if (uiView.animations && !this._idMap)this._idMap={};
		View.createComp(uiView,this,this);
		if (uiView.animations){
			var anilist=[];
			var animations=uiView.animations;
			var i=0,len=animations.length;
			var tAni;
			var tAniO;
			for (i=0;i < len;i++){
				tAni=new FrameAnimation();
				tAniO=animations[i];
				tAni._setUp(this._idMap,tAniO);
				this[tAniO.name]=tAni;
				tAni._setControlNode(this);
				switch (tAniO.action){
					case 1:
						tAni.play(0,false);
						break ;
					case 2:
						tAni.play(0,true);
						break ;
					}
				anilist.push(tAni);
			}
			this._aniList=anilist;
		}
		if (this._width > 0 && uiView.props.hitTestPrior==null && !this.mouseThrough)this.hitTestPrior=true;
	}

	__proto.onEvent=function(type,event){}
	/**
	*@private
	*装载UI视图。用于加载模式。
	*@param path UI资源地址。
	*/
	__proto.loadUI=function(path){
		var uiView=View.uiMap[path];
		uiView && this.createView(uiView);
	}

	/**
	*<p>销毁此对象。</p>
	*@param destroyChild 是否同时销毁子节点，若值为true,则销毁子节点，否则不销毁子节点。
	*/
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		if (this._aniList)this._aniList.length=0;
		this._idMap=null;
		this._aniList=null;
		this._watchMap=null;
		laya.ui.Component.prototype.destroy.call(this,destroyChild);
	}

	/**@private */
	__proto.changeData=function(key){
		var arr=this._watchMap[key];
		if (!arr)return;
		console.log("change",key);
		for (var i=0,n=arr.length;i < n;i++){
			var watcher=arr[i];
			watcher.exe(this);
		}
	}

	View._regs=function(){
		for (var key in View.uiClassMap){
			ClassUtils.regClass(key,View.uiClassMap[key]);
		}
	}

	View.createComp=function(uiView,comp,view,dataMap){
		comp=comp || View.getCompInstance(uiView);
		if (!comp){
			console.warn("can not create:"+uiView.type);
			return null;
		};
		var child=uiView.child;
		if (child){
			var isList=(comp instanceof laya.ui.List );
			for (var i=0,n=child.length;i < n;i++){
				var node=child[i];
				if (comp.hasOwnProperty("itemRender")&& (node.props.name=="render" || node.props.renderType==="render")){
					(comp).itemRender=node;
					}else if (node.type=="Graphic"){
					ClassUtils.addGraphicsToSprite(node,comp);
					}else if (ClassUtils.isDrawType(node.type)){
					ClassUtils.addGraphicToSprite(node,comp,true);
					}else {
					if (isList){
						var arr=[];
						var tChild=View.createComp(node,null,view,arr);
						if (arr.length)tChild["_$bindData"]=arr;
						}else {
						tChild=View.createComp(node,null,view,dataMap);
					}
					if (node.type=="Script"){
						if ("owner" in tChild){
							tChild["owner"]=comp;
							}else if ("target" in tChild){
							tChild["target"]=comp;
						}
						}else if (node.props.renderType=="mask" || node.props.name=="mask"){
						comp.mask=tChild;
						}else {(
						tChild instanceof laya.display.Sprite )&& comp.addChild(tChild);
					}
				}
			}
		};
		var props=uiView.props;
		for (var prop in props){
			var value=props[prop];
			if (View.eventDic[prop]){
				if (value&&view){
					(comp).on(prop,view,view.onEvent,[value]);
				}
			}else
			View.setCompValue(comp,prop,value,view,dataMap);
		}
		if (Laya.__typeof(comp,'laya.ui.IItem'))(comp).initItems();
		if (uiView.compId && view && view._idMap){
			view._idMap[uiView.compId]=comp;
		}
		return comp;
	}

	View.setCompValue=function(comp,prop,value,view,dataMap){
		if ((typeof value=='string')&& value.indexOf("${")>-1){
			View._sheet || (View._sheet=ClassUtils.getClass("laya.data.Table"));
			if (!View._sheet){
				console.warn("Can not find class Sheet");
				return;
			}
			if (dataMap){
				dataMap.push(comp,prop,value);
				}else if (view){
				if (value.indexOf("].")==-1){
					value=value.replace(".","[0].");
				};
				var watcher=new DataWatcher(comp,prop,value);
				watcher.exe(view);
				var one,temp;
				var str=value.replace(/\[.*?\]\./g,".");
				while ((one=View._parseWatchData.exec(str))!=null){
					var key1=one[1];
					while ((temp=View._parseKeyWord.exec(key1))!=null){
						var key2=temp[0];
						var arr=(view._watchMap[key2] || (view._watchMap[key2]=[]));
						arr.push(watcher);
						View._sheet.I.notifer.on(key2,view,view.changeData,[key2]);
					}
					arr=(view._watchMap[key1] || (view._watchMap[key1]=[]));
					arr.push(watcher);
					View._sheet.I.notifer.on(key1,view,view.changeData,[key1]);
				}
			}
			return;
		}
		if (prop==="var" && view){
			view[value]=comp;
			}else if (prop=="onClick"){
			var fun=Laya._runScript("(function(){"+value+"})");
			comp.on("click",view,fun);
			}else {
			comp[prop]=(value==="true" ? true :(value==="false" ? false :value));
		}
	}

	View.getCompInstance=function(json){
		var runtime=json.props ? json.props.runtime :null;
		var compClass;
		compClass=runtime ? (View.viewClassMap[runtime] || View.uiClassMap[runtime]|| Laya["__classmap"][runtime]):View.uiClassMap[json.type];
		if (json.props && json.props.hasOwnProperty("renderType")&& json.props["renderType"]=="instance")return compClass["instance"];
		return compClass ? new compClass():null;
	}

	View.regComponent=function(key,compClass){
		View.uiClassMap[key]=compClass;
		ClassUtils.regClass(key,compClass);
	}

	View.regViewRuntime=function(key,compClass){
		View.viewClassMap[key]=compClass;
	}

	View.uiMap={};
	View.viewClassMap={};
	View._sheet=null;
	__static(View,
	['uiClassMap',function(){return this.uiClassMap={"ViewStack":ViewStack,"LinkButton":Button,"TextArea":TextArea,"ColorPicker":ColorPicker,"Box":Box,"Button":Button,"CheckBox":CheckBox,"Clip":Clip,"ComboBox":ComboBox,"Component":Component,"HScrollBar":HScrollBar,"HSlider":HSlider,"Image":Image,"Label":Label,"List":List,"Panel":Panel,"ProgressBar":ProgressBar,"Radio":Radio,"RadioGroup":RadioGroup,"ScrollBar":ScrollBar,"Slider":Slider,"Tab":Tab,"TextInput":TextInput,"View":View,"VScrollBar":VScrollBar,"VSlider":VSlider,"Tree":Tree,"HBox":HBox,"VBox":VBox,"Sprite":Sprite,"Animation":Animation,"Text":Text,"FontClip":FontClip};},'eventDic',function(){return this.eventDic={"mousedown":true,"mouseup":true,"mousemove":true,"mouseover":true,"mouseout":true,"click":true,"doubleclick":true,"rightmousedown":true,"rightmouseup":true,"rightclick":true };},'_parseWatchData',function(){return this._parseWatchData=/\${(.*?)}/g;},'_parseKeyWord',function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;}
	]);
	View.__init$=function(){
		View._regs()
		//class DataWatcher
		DataWatcher=(function(){
			function DataWatcher(comp,prop,value){
				this.comp=null;
				this.prop=null;
				this.value=null;
				this.comp=comp;
				this.prop=prop;
				this.value=value;
			}
			__class(DataWatcher,'');
			var __proto=DataWatcher.prototype;
			__proto.exe=function(view){
				var fun=UIUtils.getBindFun(this.value);
				this.comp[this.prop]=fun.call(this,view);
			}
			return DataWatcher;
		})()
	}

	return View;
})(Box)


//class game.base.display.ClipMc extends laya.ui.Clip
var ClipMc=(function(_super){
	function ClipMc(){
		this.loadOverPlay=false;
		this.comHandler=null;
		this.playTime=0;
		this.nowTimes=0;
		this.isClear=false;
		ClipMc.__super.call(this);
		this.po=new Point();
		this.anchorX=this.anchorY=0.5;
		this.on("removed",this,this.removeFun);
	}

	__class(ClipMc,'game.base.display.ClipMc',_super);
	var __proto=ClipMc.prototype;
	__proto.removeFun=function(){
		this.clear(false);
	}

	__proto.setClipName=function(clipName,resType){
		(resType===void 0)&& (resType="CLIP");
		var url=App.loaderManager.getUrl(resType ,clipName+".png");
		this.skin=url;
		if(clipName.indexOf("_")!=-1){
			var split=clipName.split("_");
			this.clipX=parseInt(split[split.length-2]);
			this.clipY=parseInt(split[split.length-1]);
		}
	}

	//}
	__proto.addLoadEvent=function(){
		this.on("loaded",this,this.loadOverFun);
	}

	__proto.loadOverFun=function(){
		this.playByTimes(this.playTime);
	}

	__proto.playByTimes=function(times,overPlay){
		(overPlay===void 0)&& (overPlay=false);
		this.nowTimes=0;
		this.playTime=times;
		this.index=0;
		if(this.sources==null && overPlay){
			this.addLoadEvent();
			return;
		}
		this.play();
		if(times==0){
			return;
		}
		this.on("change",this,this.changeFun);
	}

	__proto.playByEndTime=function(endTime){}
	//Laya.timer.once(endTime-TheGame.GetServerTime(),this,timeFun );
	__proto.timeFun=function(){
		this.clear(true);
	}

	__proto.changeFun=function(){
		if(this.index >=(this.total-1)){
			this.nowTimes++;
		}
		if(this.nowTimes >=this.playTime){
			this.clear(true);
		}
	}

	__proto.clear=function(remove){
		(remove===void 0)&& (remove=true);
		this.isClear=true;
		this.stop();
		this.off("change",this,this.changeFun);
		Laya.timer.clear(this,this.timeFun);
		if(remove){
			this.removeSelf();
		}
	}

	// }
	__proto.clearRes=function(){
		var img=Laya.loader.getRes(this.skin);
		if(img){
			var w=Math.ceil(img.sourceWidth / this._clipX);
			var h=Math.ceil(img.sourceHeight / this._clipY);
			var key=this._skin+w+h;
			WeakObject.I.set(key,null);
			Laya.loader.clearRes(this.skin,true);
		}
	}

	__proto.setPos=function(container,target,xx,yy){
		(xx===void 0)&& (xx=0);
		(yy===void 0)&& (yy=0);
		this.po.setTo(0,0);
		target.localToGlobal(this.po);
		container.addChild(this);
		this.pos(this.po.x+xx,this.po.y+yy);
	}

	return ClipMc;
})(Clip)


//class fight.StoneSmoke extends laya.ui.Clip
var StoneSmoke=(function(_super){
	function StoneSmoke(){
		StoneSmoke.__super.call(this);
		this.skin="comp/zhandou/clip_dan.png";
		this.clipX=6;
		this.clipY=2;
		this.interval=1000/12;
		this.play();
		this.anchorX=this.anchorY=0.5;
		this.on("change",this,this.changeFun);
	}

	__class(StoneSmoke,'fight.StoneSmoke',_super);
	var __proto=StoneSmoke.prototype;
	__proto.changeFun=function(){
		if(this.index==(this.total-1)){
			this.stop();
			this.removeSelf();
			this.off("change",this,this.changeFun);
			return;
		}
	}

	return StoneSmoke;
})(Clip)


//class huamao.face.WeixianFace extends laya.ui.Box
var WeixianFace=(function(_super){
	function WeixianFace(){
		this._itemList=[];
		this.mapCitySession=null;
		WeixianFace.__super.call(this);
		App.injOne(this);
		this.width=208;
		this.right=1;
		this.y=250;
		for(var i=0;i < 2;i++){
			var item=new WeixianItem();
			item.pos(0,47 *i);
			this.addChild(item);
			item.visible=false;
			this._itemList[i]=item;
		}
		this.update();
	}

	__class(WeixianFace,'huamao.face.WeixianFace',_super);
	var __proto=WeixianFace.prototype;
	__proto.clear=function(){
		for(var i=0;i < 2;i++){
			var item=this._itemList[i];
			item.visible=false;
		}
	}

	__proto.update=function(){
		var arr=this.mapCitySession.getWeixianList();
		for(var i=0;i < 2;i++){
			var item=this._itemList[i];
			item.visible=false;
			if(i < arr.length){
				var data=arr[i];
				if(data.remainingTime>0){
					item.visible=true;
					item.update(arr[i]);
				}
			}
		}
	}

	return WeixianFace;
})(Box)


//class huamao.face.XingjunFace extends laya.ui.Box
var XingjunFace=(function(_super){
	function XingjunFace(){
		this._itemList=[];
		this.mapCitySession=null;
		this.numlist=4;
		this.isopen=false;
		this.numCount=0;
		this.numChan=0;
		this.numFirstChan=0;
		XingjunFace.__super.call(this);
		App.injOne(this);
		for(var i=0;i < 4;i++){
			var item=new XingjunjiasuItem();
			item.y=i *26;
			item.x+=46;
			this.addChild(item);
			item.visible=false;
			this._itemList.push(item);
		}
		this.updateAction();
	}

	__class(XingjunFace,'huamao.face.XingjunFace',_super);
	var __proto=XingjunFace.prototype;
	__proto.updateAction=function(){
		var dataList=this.mapCitySession.getActionList();
		if(!this.isopen && dataList.length!=0){
			Laya.timer.loop(3000,this,this.onChangeText);
		};
		var _itemBattleList=[];
		var _itemXJList=[];
		this.updateList(dataList,_itemBattleList,_itemXJList);
		this.numCount=0;
		for(var i=0;i < this.numlist;i++){
			var item=this._itemList[i];
			item.visible=false;
			if(i < dataList.length){
				item.visible=true;
				if(i<_itemBattleList.length){
					item.update(_itemBattleList[i]);
					}else{
					item.update(_itemXJList[this.numCount]);
					this.numCount++;
				}
				item.onFirstChangeText(this.numFirstChan);
				this.isopen=true;
			}
		}
		if(dataList.length==0){
			this.isopen=false;
			Laya.timer.clear(this,this.onChangeText);
		}
	}

	__proto.updateList=function(dataList,_itemBattleList,_itemXJList){
		for (var j=0;j < dataList.length;j++){
			if(dataList[j].battleId>0){
				_itemBattleList.push(dataList[j]);
				}else{
				_itemXJList.push(dataList[j]);
			}
		}
	}

	__proto.onChangeText=function(){
		var dataList=this.mapCitySession.getActionList();
		for(var i=0;i < this.numlist;i++){
			if(i < dataList.length){
				var item=this._itemList[i];
				item.onChangeText(this.numChan);
			}
		}
		this.numChan++;
		this.numFirstChan++;
	}

	__proto.deleteAction=function(actionId){
		this.updateAction();
	}

	return XingjunFace;
})(Box)


//class huamao.dpo.Item extends laya.ui.Image
var Item=(function(_super){
	function Item(){
		this.isItem=true;
		this.itemId=0;
		this.label=null;
		this.label2=null;
		this._isTips=false;
		this.labelName=null;
		//显示兵器佩戴武将名字
		this.imgBG=null;
		this.labelNum=null;
		Item.__super.call(this,null);
		this.width=this.height=75;
		this.on("click",this,this.heroImgTips);
	}

	__class(Item,'huamao.dpo.Item',_super);
	var __proto=Item.prototype;
	__proto.clear=function(){
		this.skin=null;
		this.setLv(0);
	}

	__proto.setItemId=function(itemId,_isItem){
		(_isItem===void 0)&& (_isItem=true);
		this.isItem=_isItem;
		this.itemId=itemId;
		if(_isItem){
			this.skin=GameUtils.getItemIconPath(itemId);
		}
		else{
			var syshero=ConfigManager.getConfig("sys_hero.txt",itemId);
			console.log("setItemId"+syshero.heroResId);
			this.skin="res/item/"+syshero.heroResId+"001.png";
		}
	}

	__proto.setLv=function(lv){
		if(this.label==null){
			this.label=new Label();
			this.label.bold=true;
			this.label.fontSize=16;
			this.label.color="#00ff00";
			this.addChild(this.label);
		}
		if(lv > 0){
			this.label.text="+"+lv;
			}else {
			this.label.text="";
		}
		this.label.y=5;
		this.label.x=this.width-this.label.width-5;
	}

	/**
	*白色 没有加号的
	*/
	__proto.setLv2=function(lv){
		if(this.label2==null){
			this.label2=new Label();
			this.label2.bold=true;
			this.label2.fontSize=15;
			this.label2.color="#ffffff";
			this.addChild(this.label2);
		}
		this.label2.text=((lv>0)?(lv+""):"");
		this.label2.y=2;
		this.label2.x=this.width-this.label2.width-3;
	}

	__proto.isViewTips=function(boo){
		this._isTips=boo;
	}

	__proto.heroImgTips=function(){
		if(this._isTips){
			var sysName="";
			if(this.isItem){
				var sysitem=ConfigManager.getConfig("sys_item.txt",this.itemId);
				sysName=sysitem.itemName;
				}else{
				var syshero=ConfigManager.getConfig("sys_hero.txt",this.itemId);
				sysName=syshero.heroName;
			}
			FlyLittleUpTips.setTips(sysName);
		}
	}

	__proto.setHeroId=function(heroId){
		if(this.labelName==null){
			this.imgBG=new Image();
			this.imgBG.skin="comp/G/k_zdd.png";
			this.addChild(this.imgBG);
			this.labelName=new Label();
			this.labelName.bold=true;
			this.labelName.fontSize=16;
			this.labelName.color="#00ff00";
			this.imgBG.addChild(this.labelName);
		}
		if(heroId > 0){
			this.imgBG.visible=true;
			var syshero=ConfigManager.getConfig("sys_hero.txt",heroId);
			var name=syshero.heroName;
			this.labelName.text=name;
			console.log("heroId-->"+heroId);
			this.imgBG.width=this.width;
			this.imgBG.y=this.height-this.imgBG.height-8;
			this.imgBG.x=(this.width-this.imgBG.width)/2;
			this.labelName.y=this.imgBG.height-this.labelName.height-2;
			this.labelName.x=(this.imgBG.width-this.labelName.width)/2;
			}else{
			this.imgBG.visible=false;
			this.labelName.text="";
		}
	}

	__proto.setNum=function(num){
		if(this.labelNum==null){
			this.labelNum=new Label();
			this.labelNum.stroke=2;
			this.labelNum.strokeColor="#000000";
			this.labelNum.fontSize=16;
			this.labelNum.color="#ffffff";
			this.addChild(this.labelNum);
		}
		if(num > 0){
			this.labelNum.text=""+num;
			}else {
			this.labelNum.text="";
		}
		this.labelNum.y=this.height-this.labelNum.height;
		this.labelNum.x=this.width-this.labelNum.width;
	}

	return Item;
})(Image)


/**
*<code>List</code> 控件可显示项目列表。默认为垂直方向列表。可通过UI编辑器自定义列表。
*
*@example <caption>以下示例代码，创建了一个 <code>List</code> 实例。</caption>
*package
*{
	*import laya.ui.List;
	*import laya.utils.Handler;
	*public class List_Example
	*{
		*public function List_Example()
		*{
			*Laya.init(640,800,"false");//设置游戏画布宽高、渲染模式。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png"],Handler.create(this,onLoadComplete));
			*}
		*private function onLoadComplete():void
		*{
			*var arr:Array=[];//创建一个数组，用于存贮列表的数据信息。
			*for (var i:int=0;i &lt;20;i++)
			*{
				*arr.push({label:"item"+i});
				*}
			*var list:List=new List();//创建一个 List 类的实例对象 list 。
			*list.itemRender=Item;//设置 list 的单元格渲染器。
			*list.repeatX=1;//设置 list 的水平方向单元格数量。
			*list.repeatY=10;//设置 list 的垂直方向单元格数量。
			*list.vScrollBarSkin="resource/ui/vscroll.png";//设置 list 的垂直方向滚动条皮肤。
			*list.array=arr;//设置 list 的列表数据源。
			*list.pos(100,100);//设置 list 的位置。
			*list.selectEnable=true;//设置 list 可选。
			*list.selectHandler=new Handler(this,onSelect);//设置 list 改变选择项执行的处理器。
			*Laya.stage.addChild(list);//将 list 添加到显示列表。
			*}
		*private function onSelect(index:int):void
		*{
			*trace("当前选择的项目索引： index= ",index);
			*}
		*}
	*}
*import laya.ui.Box;
*import laya.ui.Label;
*class Item extends Box
*{
	*public function Item()
	*{
		*graphics.drawRect(0,0,100,20,null,"#ff0000");
		*var label:Label=new Label();
		*label.text="100000";
		*label.name="label";//设置 label 的name属性值。
		*label.size(100,20);
		*addChild(label);
		*}
	*}
*@example
*(function (_super){
	*function Item(){
		*Item.__super.call(this);//初始化父类
		*this.graphics.drawRect(0,0,100,20,"#ff0000");
		*var label=new laya.ui.Label();//创建一个 Label 类的实例对象 label 。
		*label.text="100000";//设置 label 的文本内容。
		*label.name="label";//设置 label 的name属性值。
		*label.size(100,20);//设置 label 的宽度、高度。
		*this.addChild(label);//将 label 添加到显示列表。
		*};
	*Laya.class(Item,"mypackage.listExample.Item",_super);//注册类 Item 。
	*})(laya.ui.Box);
*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
*var res=["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png"];
*Laya.loader.load(res,new laya.utils.Handler(this,onLoadComplete));//加载资源。
*function onLoadComplete(){
	*var arr=[];//创建一个数组，用于存贮列表的数据信息。
	*for (var i=0;i &lt;20;i++){
		*arr.push({label:"item"+i});
		*}
	*var list=new laya.ui.List();//创建一个 List 类的实例对象 list 。
	*list.itemRender=mypackage.listExample.Item;//设置 list 的单元格渲染器。
	*list.repeatX=1;//设置 list 的水平方向单元格数量。
	*list.repeatY=10;//设置 list 的垂直方向单元格数量。
	*list.vScrollBarSkin="resource/ui/vscroll.png";//设置 list 的垂直方向滚动条皮肤。
	*list.array=arr;//设置 list 的列表数据源。
	*list.pos(100,100);//设置 list 的位置。
	*list.selectEnable=true;//设置 list 可选。
	*list.selectHandler=new laya.utils.Handler(this,onSelect);//设置 list 改变选择项执行的处理器。
	*Laya.stage.addChild(list);//将 list 添加到显示列表。
	*}
*function onSelect(index)
*{
	*console.log("当前选择的项目索引： index= ",index);
	*}
*
*@example
*import List=laya.ui.List;
*import Handler=laya.utils.Handler;
*public class List_Example {
	*public List_Example(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png"],Handler.create(this,this.onLoadComplete));
		*}
	*private onLoadComplete():void {
		*var arr=[];//创建一个数组，用于存贮列表的数据信息。
		*for (var i:number=0;i &lt;20;i++)
		*{
			*arr.push({label:"item"+i });
			*}
		*var list:List=new List();//创建一个 List 类的实例对象 list 。
		*list.itemRender=Item;//设置 list 的单元格渲染器。
		*list.repeatX=1;//设置 list 的水平方向单元格数量。
		*list.repeatY=10;//设置 list 的垂直方向单元格数量。
		*list.vScrollBarSkin="resource/ui/vscroll.png";//设置 list 的垂直方向滚动条皮肤。
		*list.array=arr;//设置 list 的列表数据源。
		*list.pos(100,100);//设置 list 的位置。
		*list.selectEnable=true;//设置 list 可选。
		*list.selectHandler=new Handler(this,this.onSelect);//设置 list 改变选择项执行的处理器。
		*Laya.stage.addChild(list);//将 list 添加到显示列表。
		*}
	*private onSelect(index:number):void {
		*console.log("当前选择的项目索引： index= ",index);
		*}
	*}
*import Box=laya.ui.Box;
*import Label=laya.ui.Label;
*class Item extends Box {
	*constructor(){
		*this.graphics.drawRect(0,0,100,20,null,"#ff0000");
		*var label:Label=new Label();
		*label.text="100000";
		*label.name="label";//设置 label 的name属性值。
		*label.size(100,20);
		*this.addChild(label);
		*}
	*}
*/
//class laya.ui.List extends laya.ui.Box
var List=(function(_super){
	function List(){
		/**改变 <code>List</code> 的选择项时执行的处理器，(默认返回参数： 项索引（index:int）)。*/
		this.selectHandler=null;
		/**单元格渲染处理器(默认返回参数cell:Box,index:int)。*/
		this.renderHandler=null;
		/**单元格鼠标事件处理器(默认返回参数e:Event,index:int)。*/
		this.mouseHandler=null;
		/**指定是否可以选择，若值为true则可以选择，否则不可以选择。 @default false*/
		this.selectEnable=false;
		/**最大分页数。*/
		this.totalPage=0;
		/**@private */
		this._content=null;
		/**@private */
		this._scrollBar=null;
		/**@private */
		this._itemRender=null;
		/**@private */
		this._repeatX=0;
		/**@private */
		this._repeatY=0;
		/**@private */
		this._repeatX2=0;
		/**@private */
		this._repeatY2=0;
		/**@private */
		this._spaceX=0;
		/**@private */
		this._spaceY=0;
		/**@private */
		this._array=null;
		/**@private */
		this._startIndex=0;
		/**@private */
		this._selectedIndex=-1;
		/**@private */
		this._page=0;
		/**@private */
		this._isVertical=true;
		/**@private */
		this._cellSize=20;
		/**@private */
		this._cellOffset=0;
		/**@private */
		this._isMoved=false;
		/**是否缓存内容，如果数据源较少，并且list内无动画，设置此属性为true能大大提高性能 */
		this.cacheContent=false;
		/**@private */
		this._createdLine=0;
		/**@private */
		this._cellChanged=false;
		List.__super.call(this);
		this._cells=[];
		this._offset=new Point();
	}

	__class(List,'laya.ui.List',_super);
	var __proto=List.prototype;
	Laya.imps(__proto,{"laya.ui.IRender":true,"laya.ui.IItem":true})
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		this._content && this._content.destroy(destroyChild);
		this._scrollBar && this._scrollBar.destroy(destroyChild);
		laya.ui.Component.prototype.destroy.call(this,destroyChild);
		this._content=null;
		this._scrollBar=null;
		this._itemRender=null;
		this._cells=null;
		this._array=null;
		this.selectHandler=this.renderHandler=this.mouseHandler=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._content=new Box());
	}

	__proto.onScrollStart=function(){
		this._$P.cacheAs || (this._$P.cacheAs=Laya.superGet(Box,this,'cacheAs'));
		Laya.superSet(Box,this,'cacheAs',"none");
		this._scrollBar.once("end",this,this.onScrollEnd);
	}

	__proto.onScrollEnd=function(){
		Laya.superSet(Box,this,'cacheAs',this._$P.cacheAs);
	}

	__proto._removePreScrollBar=function(){
		var preNode=this.removeChildByName("scrollBar");
		if (preNode)preNode.destroy(true);
	}

	/**
	*@private
	*更改单元格的信息。
	*@internal 在此销毁、创建单元格，并设置单元格的位置等属性。相当于此列表内容发送改变时调用此函数。
	*/
	__proto.changeCells=function(){
		this._cellChanged=false;
		if (this._itemRender){
			this.scrollBar=this.getChildByName("scrollBar");
			var cell=this._getOneCell();
			var cellWidth=(cell.width+this._spaceX)|| 1;
			var cellHeight=(cell.height+this._spaceY)|| 1;
			if (this._width > 0)this._repeatX2=this._isVertical ? Math.round(this._width / cellWidth):Math.ceil(this._width / cellWidth);
			if (this._height > 0)this._repeatY2=this._isVertical ? Math.ceil(this._height / cellHeight):Math.round(this._height / cellHeight);
			var listWidth=this._width ? this._width :(cellWidth *this.repeatX-this._spaceX);
			var listHeight=this._height ? this._height :(cellHeight *this.repeatY-this._spaceY);
			this._cellSize=this._isVertical ? cellHeight :cellWidth;
			this._cellOffset=this._isVertical ? (cellHeight *Math.max(this._repeatY2,this._repeatY)-listHeight-this._spaceY):(cellWidth *Math.max(this._repeatX2,this._repeatX)-listWidth-this._spaceX);
			if (this._isVertical && this._scrollBar)this._scrollBar.height=listHeight;
			else if (!this._isVertical && this._scrollBar)this._scrollBar.width=listWidth;
			this.setContentSize(listWidth,listHeight);
			var numX=this._isVertical ? this.repeatX :this.repeatY;
			var numY=(this._isVertical ? this.repeatY :this.repeatX)+(this._scrollBar ? 1 :0);
			this._createItems(0,numX,numY);
			this._createdLine=numY;
			if (this._array){
				this.array=this._array;
				this.runCallLater(this.renderItems);
			}
		}
	}

	__proto._getOneCell=function(){
		if (this._cells.length===0){
			var item=this.createItem();
			this._offset.setTo(item.x,item.y);
			if (this.cacheContent)return item;
			this._cells.push(item);
		}
		return this._cells[0];
	}

	__proto._createItems=function(startY,numX,numY){
		var box=this._content;
		var cell=this._getOneCell();
		var cellWidth=cell.width+this._spaceX;
		var cellHeight=cell.height+this._spaceY;
		if (this.cacheContent){
			var cacheBox=new Box();
			cacheBox.cacheAsBitmap=true;
			cacheBox.pos((this._isVertical ? 0 :startY)*cellWidth,(this._isVertical ? startY :0)*cellHeight);
			this._content.addChild(cacheBox);
			this._content.optimizeScrollRect=true;
			box=cacheBox;
			}else {
			var arr=[];
			for (var i=this._cells.length-1;i >-1;i--){
				var item=this._cells[i];
				item.removeSelf();
				arr.push(item);
			}
			this._cells.length=0;
		}
		for (var k=startY;k < numY;k++){
			for (var l=0;l < numX;l++){
				if (arr && arr.length){
					cell=arr.pop();
					}else {
					cell=this.createItem();
				}
				cell.x=(this._isVertical ? l :k)*cellWidth-box.x;
				cell.y=(this._isVertical ? k :l)*cellHeight-box.y;
				cell.name="item"+(k *numX+l);
				box.addChild(cell);
				this.addCell(cell);
			}
		}
	}

	__proto.createItem=function(){
		var arr=[];
		if ((typeof this._itemRender=='function')){
			var box=new this._itemRender();
			}else {
			box=View.createComp(this._itemRender,null,null,arr)
		}
		if (arr.length==0 && box._watchMap){
			var watchMap=box._watchMap;
			for (var name in watchMap){
				var a=watchMap[name];
				for (var i=0;i < a.length;i++){
					var watcher=a[i];
					arr.push(watcher.comp,watcher.prop,watcher.value)
				}
			}
		}
		if (arr.length)box["_$bindData"]=arr;
		return box;
	}

	/**
	*@private
	*添加单元格。
	*@param cell 需要添加的单元格对象。
	*/
	__proto.addCell=function(cell){
		cell.on("click",this,this.onCellMouse);
		cell.on("rightclick",this,this.onCellMouse);
		cell.on("mouseover",this,this.onCellMouse);
		cell.on("mouseout",this,this.onCellMouse);
		cell.on("mousedown",this,this.onCellMouse);
		cell.on("mouseup",this,this.onCellMouse);
		this._cells.push(cell);
	}

	/**
	*初始化单元格信息。
	*/
	__proto.initItems=function(){
		if (!this._itemRender && this.getChildByName("item0")!=null){
			this.repeatX=1;
			var count=0;
			count=0;
			for (var i=0;i < 10000;i++){
				var cell=this.getChildByName("item"+i);
				if (cell){
					this.addCell(cell);
					count++;
					continue ;
				}
				break ;
			}
			this.repeatY=count;
		}
	}

	/**
	*设置可视区域大小。
	*<p>以（0，0，width参数，height参数）组成的矩形区域为可视区域。</p>
	*@param width 可视区域宽度。
	*@param height 可视区域高度。
	*/
	__proto.setContentSize=function(width,height){
		this._content.width=width;
		this._content.height=height;
		if (this._scrollBar || this._offset.x !=0 || this._offset.y !=0){
			this._content.scrollRect || (this._content.scrollRect=new Rectangle());
			this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,width,height);
			this._content.scrollRect=this._content.scrollRect;
		}
		this.event("resize");
	}

	/**
	*@private
	*单元格的鼠标事件侦听处理函数。
	*/
	__proto.onCellMouse=function(e){
		if (e.type==="mousedown")this._isMoved=false;
		var cell=e.currentTarget;
		var index=this._startIndex+this._cells.indexOf(cell);
		if (index < 0)return;
		if (e.type==="click" || e.type==="rightclick"){
			if (this.selectEnable && !this._isMoved)this.selectedIndex=index;
			else this.changeCellState(cell,true,0);
			}else if ((e.type==="mouseover" || e.type==="mouseout")&& this._selectedIndex!==index){
			this.changeCellState(cell,e.type==="mouseover",0);
		}
		this.mouseHandler && this.mouseHandler.runWith([e,index]);
	}

	/**
	*@private
	*改变单元格的可视状态。
	*@param cell 单元格对象。
	*@param visable 是否显示。
	*@param index 单元格的属性 <code>index</code> 值。
	*/
	__proto.changeCellState=function(cell,visable,index){
		var selectBox=cell.getChildByName("selectBox");
		if (selectBox){
			this.selectEnable=true;
			selectBox.visible=visable;
			selectBox.index=index;
		}
	}

	/**@inheritDoc */
	__proto.changeSize=function(){
		laya.ui.Component.prototype.changeSize.call(this);
		this.setContentSize(this.width,this.height);
		if (this._scrollBar)this.callLater(this.onScrollBarChange);
	}

	/**
	*@private
	*滚动条的 <code>Event.CHANGE</code> 事件侦听处理函数。
	*/
	__proto.onScrollBarChange=function(e){
		this.runCallLater(this.changeCells);
		var scrollValue=this._scrollBar.value;
		var lineX=(this._isVertical ? this.repeatX :this.repeatY);
		var lineY=(this._isVertical ? this.repeatY :this.repeatX);
		var scrollLine=Math.floor(scrollValue / this._cellSize);
		if (!this.cacheContent){
			var index=scrollLine *lineX;
			var num=0;
			if (index > this._startIndex){
				num=index-this._startIndex;
				var down=true;
				var toIndex=this._startIndex+lineX *(lineY+1);
				this._isMoved=true;
				}else if (index < this._startIndex){
				num=this._startIndex-index;
				down=false;
				toIndex=this._startIndex-1;
				this._isMoved=true;
			}
			for (var i=0;i < num;i++){
				if (down){
					var cell=this._cells.shift();
					this._cells[this._cells.length]=cell;
					var cellIndex=toIndex+i;
					}else {
					cell=this._cells.pop();
					this._cells.unshift(cell);
					cellIndex=toIndex-i;
				};
				var pos=Math.floor(cellIndex / lineX)*this._cellSize;
				this._isVertical ? cell.y=pos :cell.x=pos;
				this.renderItem(cell,cellIndex);
			}
			this._startIndex=index;
			this.changeSelectStatus();
			}else {
			num=(lineY+1);
			if (this._createdLine-scrollLine < num){
				this._createItems(this._createdLine,lineX,this._createdLine+num);
				this.renderItems(this._createdLine *lineX,0);
				this._createdLine+=num;
			}
		};
		var r=this._content.scrollRect;
		if (this._isVertical){
			r.y=scrollValue-this._offset.y;
			r.x=-this._offset.x;
			}else {
			r.y=-this._offset.y;
			r.x=scrollValue-this._offset.x;
		}
		this._content.scrollRect=r;
	}

	__proto.posCell=function(cell,cellIndex){
		if (!this._scrollBar)return;
		var lineX=(this._isVertical ? this.repeatX :this.repeatY);
		var lineY=(this._isVertical ? this.repeatY :this.repeatX);
		var pos=Math.floor(cellIndex / lineX)*this._cellSize;
		this._isVertical ? cell.y=pos :cell.x=pos;
	}

	/**
	*@private
	*改变单元格的选择状态。
	*/
	__proto.changeSelectStatus=function(){
		for (var i=0,n=this._cells.length;i < n;i++){
			this.changeCellState(this._cells[i],this._selectedIndex===this._startIndex+i,1);
		}
	}

	/**
	*@private
	*渲染单元格列表。
	*/
	__proto.renderItems=function(from,to){
		(from===void 0)&& (from=0);
		(to===void 0)&& (to=0);
		for (var i=from,n=to || this._cells.length;i < n;i++){
			this.renderItem(this._cells[i],this._startIndex+i);
		}
		this.changeSelectStatus();
	}

	/**
	*渲染一个单元格。
	*@param cell 需要渲染的单元格对象。
	*@param index 单元格索引。
	*/
	__proto.renderItem=function(cell,index){
		if (this._array && index >=0 && index < this._array.length){
			cell.visible=true;
			if (cell._$bindData){
				cell._dataSource=this._array[index];
				this._bindData(cell,this._array[index]);
			}else cell.dataSource=this._array[index];
			if (!this.cacheContent){
				this.posCell(cell,index);
			}
			if (this.hasListener("render"))this.event("render",[cell,index]);
			if (this.renderHandler)this.renderHandler.runWith([cell,index]);
			}else {
			cell.visible=false;
			cell.dataSource=null;
		}
	}

	__proto._bindData=function(cell,data){
		var arr=cell._$bindData;
		for (var i=0,n=arr.length;i < n;i++){
			var ele=arr[i++];
			var prop=arr[i++];
			var value=arr[i];
			var fun=UIUtils.getBindFun(value);
			ele[prop]=fun.call(this,data);
		}
	}

	/**
	*刷新列表数据源。
	*/
	__proto.refresh=function(){
		this.array=this._array;
	}

	/**
	*获取单元格数据源。
	*@param index 单元格索引。
	*/
	__proto.getItem=function(index){
		if (index >-1 && index < this._array.length){
			return this._array[index];
		}
		return null;
	}

	/**
	*修改单元格数据源。
	*@param index 单元格索引。
	*@param source 单元格数据源。
	*/
	__proto.changeItem=function(index,source){
		if (index >-1 && index < this._array.length){
			this._array[index]=source;
			if (index >=this._startIndex && index < this._startIndex+this._cells.length){
				this.renderItem(this.getCell(index),index);
			}
		}
	}

	/**
	*设置单元格数据源。
	*@param index 单元格索引。
	*@param source 单元格数据源。
	*/
	__proto.setItem=function(index,source){
		this.changeItem(index,source);
	}

	/**
	*添加单元格数据源。
	*@param souce 数据源。
	*/
	__proto.addItem=function(souce){
		this._array.push(souce);
		this.array=this._array;
	}

	/**
	*添加单元格数据源到对应的数据索引处。
	*@param souce 单元格数据源。
	*@param index 索引。
	*/
	__proto.addItemAt=function(souce,index){
		this._array.splice(index,0,souce);
		this.array=this._array;
	}

	/**
	*通过数据源索引删除单元格数据源。
	*@param index 需要删除的数据源索引值。
	*/
	__proto.deleteItem=function(index){
		this._array.splice(index,1);
		this.array=this._array;
	}

	/**
	*通过可视单元格索引，获取单元格。
	*@param index 可视单元格索引。
	*@return 单元格对象。
	*/
	__proto.getCell=function(index){
		this.runCallLater(this.changeCells);
		if (index >-1 && this._cells){
			return this._cells[(index-this._startIndex)% this._cells.length];
		}
		return null;
	}

	/**
	*<p>滚动列表，以设定的数据索引对应的单元格为当前可视列表的第一项。</p>
	*@param index 单元格在数据列表中的索引。
	*/
	__proto.scrollTo=function(index){
		if (this._scrollBar){
			var numX=this._isVertical ? this.repeatX :this.repeatY;
			this._scrollBar.value=Math.floor(index / numX)*this._cellSize;
			}else {
			this.startIndex=index;
		}
	}

	/**
	*<p>缓动滚动列表，以设定的数据索引对应的单元格为当前可视列表的第一项。</p>
	*@param index 单元格在数据列表中的索引。
	*@param time 缓动时间。
	*@param complete 缓动结束回掉
	*/
	__proto.tweenTo=function(index,time,complete){
		(time===void 0)&& (time=200);
		if (this._scrollBar){
			var numX=this._isVertical ? this.repeatX :this.repeatY;
			Tween.to(this._scrollBar,{value:Math.floor(index / numX)*this._cellSize},time,null,complete,0,true);
			}else {
			this.startIndex=index;
			if (complete)complete.run();
		}
	}

	/**@private */
	__proto._setCellChanged=function(){
		if (!this._cellChanged){
			this._cellChanged=true;
			this.callLater(this.changeCells);
		}
	}

	__proto.commitMeasure=function(){
		this.runCallLater(this.changeCells);
	}

	/**@inheritDoc */
	__getset(0,__proto,'cacheAs',_super.prototype._$get_cacheAs,function(value){
		Laya.superSet(Box,this,'cacheAs',value);
		if (this._scrollBar){
			this._$P.cacheAs=null;
			if (value!=="none")this._scrollBar.on("start",this,this.onScrollStart);
			else this._scrollBar.off("start",this,this.onScrollStart);
		}
	});

	/**
	*获取对 <code>List</code> 组件所包含的内容容器 <code>Box</code> 组件的引用。
	*/
	__getset(0,__proto,'content',function(){
		return this._content;
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		if (value !=this._height){
			Laya.superSet(Box,this,'height',value);
			this._setCellChanged();
		}
	});

	/**
	*单元格渲染器。
	*<p><b>取值：</b>
	*<ol>
	*<li>单元格类对象。</li>
	*<li> UI 的 JSON 描述。</li>
	*</ol></p>
	*/
	__getset(0,__proto,'itemRender',function(){
		return this._itemRender;
		},function(value){
		if (this._itemRender !=value){
			this._itemRender=value;
			for (var i=this._cells.length-1;i >-1;i--){
				this._cells[i].destroy();
			}
			this._cells.length=0;
			this._setCellChanged();
		}
	});

	/**
	*垂直方向滚动条皮肤。
	*/
	__getset(0,__proto,'vScrollBarSkin',function(){
		return this._scrollBar ? this._scrollBar.skin :null;
		},function(value){
		this._removePreScrollBar();
		var scrollBar=new VScrollBar();
		scrollBar.name="scrollBar";
		scrollBar.right=0;
		if (value && value !=" ")
			scrollBar.skin=value;
		this.scrollBar=scrollBar;
		this.addChild(scrollBar);
		this._setCellChanged();
	});

	/**
	*列表的当前页码。
	*/
	__getset(0,__proto,'page',function(){
		return this._page;
		},function(value){
		this._page=value
		if (this._array){
			this._page=value > 0 ? value :0;
			this._page=this._page < this.totalPage ? this._page :this.totalPage-1;
			this.startIndex=this._page *this.repeatX *this.repeatY;
		}
	});

	/**
	*水平方向滚动条皮肤。
	*/
	__getset(0,__proto,'hScrollBarSkin',function(){
		return this._scrollBar ? this._scrollBar.skin :null;
		},function(value){
		this._removePreScrollBar();
		var scrollBar=new HScrollBar();
		scrollBar.name="scrollBar";
		scrollBar.bottom=0;
		if (value && value !=" ")
			scrollBar.skin=value;
		this.scrollBar=scrollBar;
		this.addChild(scrollBar);
		this._setCellChanged();
	});

	/**
	*水平方向显示的单元格数量。
	*/
	__getset(0,__proto,'repeatX',function(){
		return this._repeatX > 0 ? this._repeatX :this._repeatX2 > 0 ? this._repeatX2 :1;
		},function(value){
		this._repeatX=value;
		this._setCellChanged();
	});

	/**
	*获取对 <code>List</code> 组件所包含的滚动条 <code>ScrollBar</code> 组件的引用。
	*/
	__getset(0,__proto,'scrollBar',function(){
		return this._scrollBar;
		},function(value){
		if (this._scrollBar !=value){
			this._scrollBar=value;
			if (value){
				this._isVertical=this._scrollBar.isVertical;
				this.addChild(this._scrollBar);
				this._scrollBar.on("change",this,this.onScrollBarChange);
			}
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		if (value !=this._width){
			Laya.superSet(Box,this,'width',value);
			this._setCellChanged();
		}
	});

	/**
	*垂直方向显示的单元格数量。
	*/
	__getset(0,__proto,'repeatY',function(){
		return this._repeatY > 0 ? this._repeatY :this._repeatY2 > 0 ? this._repeatY2 :1;
		},function(value){
		this._repeatY=value;
		this._setCellChanged();
	});

	/**
	*水平方向显示的单元格之间的间距（以像素为单位）。
	*/
	__getset(0,__proto,'spaceX',function(){
		return this._spaceX;
		},function(value){
		this._spaceX=value;
		this._setCellChanged();
	});

	/**
	*垂直方向显示的单元格之间的间距（以像素为单位）。
	*/
	__getset(0,__proto,'spaceY',function(){
		return this._spaceY;
		},function(value){
		this._spaceY=value;
		this._setCellChanged();
	});

	/**
	*表示当前选择的项索引。selectedIndex值更改会引起list重新渲染
	*/
	__getset(0,__proto,'selectedIndex',function(){
		return this._selectedIndex;
		},function(value){
		if (this._selectedIndex !=value){
			this._selectedIndex=value;
			this.changeSelectStatus();
			this.event("change");
			this.selectHandler && this.selectHandler.runWith(value);
			this.startIndex=this._startIndex;
		}
	});

	/**
	*当前选中的单元格数据源。
	*/
	__getset(0,__proto,'selectedItem',function(){
		return this._selectedIndex !=-1 ? this._array[this._selectedIndex] :null;
		},function(value){
		this.selectedIndex=this._array.indexOf(value);
	});

	/**
	*列表的数据总个数。
	*/
	__getset(0,__proto,'length',function(){
		return this._array ? this._array.length :0;
	});

	/**
	*获取或设置当前选择的单元格对象。
	*/
	__getset(0,__proto,'selection',function(){
		return this.getCell(this._selectedIndex);
		},function(value){
		this.selectedIndex=this._startIndex+this._cells.indexOf(value);
	});

	/**
	*当前显示的单元格列表的开始索引。
	*/
	__getset(0,__proto,'startIndex',function(){
		return this._startIndex;
		},function(value){
		this._startIndex=value > 0 ? value :0;
		this.callLater(this.renderItems);
	});

	/**
	*列表数据源。
	*/
	__getset(0,__proto,'array',function(){
		return this._array;
		},function(value){
		this.runCallLater(this.changeCells);
		this._array=value || [];
		var length=this._array.length;
		this.totalPage=Math.ceil(length / (this.repeatX *this.repeatY));
		this._selectedIndex=this._selectedIndex < length ? this._selectedIndex :length-1;
		this.startIndex=this._startIndex;
		if (this._scrollBar){
			this._scrollBar.stopScroll();
			var numX=this._isVertical ? this.repeatX :this.repeatY;
			var numY=this._isVertical ? this.repeatY :this.repeatX;
			var lineCount=Math.ceil(length / numX);
			var total=this._cellOffset > 0 ? this.totalPage+1 :this.totalPage;
			if (total > 1){
				this._scrollBar.scrollSize=this._cellSize;
				this._scrollBar.thumbPercent=numY / lineCount;
				this._scrollBar.setScroll(0,(lineCount-numY)*this._cellSize+this._cellOffset,this._scrollBar.value);
				this._scrollBar.target=this._content;
				}else {
				this._scrollBar.setScroll(0,0,0);
				this._scrollBar.target=this._content;
			}
		}
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if (((typeof value=='number')&& Math.floor(value)==value)|| (typeof value=='string'))this.selectedIndex=parseInt(value);
		else if ((value instanceof Array))this.array=value
		else Laya.superSet(Box,this,'dataSource',value);
	});

	/**
	*单元格集合。
	*/
	__getset(0,__proto,'cells',function(){
		this.runCallLater(this.changeCells);
		return this._cells;
	});

	return List;
})(Box)


//class huamao.guide.ui.EffectUI extends huamao.guide.ui.baseUI
var EffectUI=(function(_super){
	function EffectUI(){
		this.maskArea=null;
		EffectUI.__super.call(this);
		this.init();
	}

	__class(EffectUI,'huamao.guide.ui.EffectUI',_super);
	var __proto=EffectUI.prototype;
	__proto.init=function(){
		this.maskArea=new Sprite();
		this.maskArea.alpha=0.6;
		this.maskArea.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,"#000000");
		this.addChild(this.maskArea);
		this.cacheAs="bitmap";
		this.scrollRect=new Rectangle(0,0,Laya.stage.width,Laya.stage.height);
	}

	__proto.resize=function(){
		if(this.maskArea !=null && this.maskArea.graphics !=null){
			this.maskArea.graphics.clear();
			this.maskArea.graphics.drawRect(0,0,Browser.width,Browser.height,"#000000");
		}
	}

	__proto.setData=function(data){
		console.log("this is EffectUI");
	}

	__proto.uiClickCB=function(olddata){
		return false;
	}

	return EffectUI;
})(baseUI)


//class huamao.guide.ui.EventUI extends huamao.guide.ui.baseUI
var EventUI=(function(_super){
	function EventUI(_guidemain){
		// private var anim:Animation;
		this.anim=null;
		this.interactionArea=null;
		this.mapCitySession=null;
		this.mapCityAction=null;
		this.maskArea=null;
		this.paoBG=null;
		// private var paoLbl:Label;
		this.paoLbl=null;
		this.remX=0;
		this.remY=0;
		this.remW=0;
		this.remH=0;
		this.guidemain=null;
		this.curSysGuide=null;
		EventUI.__super.call(this);
		App.injOne(this);
		this.guidemain=_guidemain;
		this.init();
	}

	__class(EventUI,'huamao.guide.ui.EventUI',_super);
	var __proto=EventUI.prototype;
	__proto.init=function(){
		this.on("mousedown",this,this.mouseDownCB);
		this.anim=new DragonBonesMc(false,false);
		this.anim.setUrl("res/load/shouzhitou.sk");
		this.anim.scale(0.5,0.5);
		this.addChild(this.anim);
		this.paoBG=new Image("comp/G/lt_b_1.png");
		this.paoBG.sizeGrid="18,18,5,9";
		this.paoBG.anchorX=0.5;
		this.paoBG.anchorY=0.5;
		this.paoBG.group=TalkUI2.GuideRes;
		this.addChild(this.paoBG);
		this.paoLbl=new HTMLDivElement();
		this.addChild(this.paoLbl);
		this.setPos(500,350,200,100,50,1,1,1,"测试蚊子|敌对度|");
	}

	// Laya.stage.addChild(tipContainer);
	__proto.mouseDownCB=function(e){
		if(e.type=="mousedown"){
			var stagex=e.stageX;
			var stagey=e.stageY;
			if(stagex > this.remX && stagex < this.remX+this.remW && stagey > this.remY && stagey < this.remY+this.remH){
				this.guidemain.nextStep();
			}
		}
	}

	__proto.resize=function(){
		if(this.maskArea !=null){
			if(this.maskArea.graphics !=null){
				this.maskArea.graphics.clear();
				this.maskArea.graphics.drawRect(0,0,Browser.width,Browser.height,"#000000");
			}
			if(this.hitArea.hit !=null){
				this.hitArea.hit.clear();
				this.hitArea.hit.drawRect(0,0,Browser.width,Browser.height,"#000000");
			}
		}
	}

	__proto.animationOver=function(){}
	// anim.play();
	__proto.setRemPos=function(x,y,w,h){
		this.remX=x;
		this.remY=y;
		this.remW=w;
		this.remH=h;
	}

	//arrowtalk:文字方向，1上， 2下
	__proto.setPos=function(x,y,w,h,r,type,arrow,tlkdir,str){
		(w===void 0)&& (w=0);
		(h===void 0)&& (h=0);
		(r===void 0)&& (r=1);
		(type===void 0)&& (type=0);
		(arrow===void 0)&& (arrow=0);
		(tlkdir===void 0)&& (tlkdir=1);
		(str===void 0)&& (str="");
		this.setRemPos(x,y,w,h);
		if(type==0){
			if(this.anim !=null){
				if(arrow==0){
					this.anim.visible=false;
					}else{
					this.anim.visible=true;
					if(1==arrow){
						this.anim.rotation=0;
						}else if(2==arrow){
						this.anim.rotation=180;
						}else if(3==arrow){
						this.anim.rotation=270;
						}else if(4==arrow){
						this.anim.rotation=90;
					}
					this.anim.pos(x+r/2,y+r/2);
				}
			}
			}else if(type==1){
			if(this.anim !=null){
				if(arrow==0){
					this.anim.visible=false;
					}else{
					this.anim.visible=true;
					if(1==arrow){
						this.anim.rotation=0;
						}else if(2==arrow){
						this.anim.rotation=180;
						}else if(3==arrow){
						this.anim.rotation=270;
						}else if(4==arrow){
						this.anim.rotation=90;
					}
					this.anim.pos(x+w/2,y+h/2);
				}
			}
		}
		if(str!=null && str.length > 0){
			this.paoBG.visible=true;
			this.paoLbl.visible=true;
			this.paoLbl.innerHTML=GuideMain.getHtmlStr(str);
			var _www=this.paoLbl.contextWidth;
			var _hhh=this.paoLbl.contextHeight+24;
			var _ddd=20;
			var dis=-2;
			if(tlkdir==1){
				this.paoLbl.pos(x+w/2-_www,y-_hhh-_ddd+3);
				this.paoBG.pos(x+w/2-_www/2,y-_hhh/2-_ddd);
				this.paoBG.rotation=90;
				this.paoBG.size(_hhh,_www+20);
				this.paoBG.scaleX=1;
				}else if(tlkdir==4){
				this.paoLbl.pos(x+w/2 ,y+h+_ddd+11);
				this.paoBG.pos(x+w/2+_www/2,y+h+_hhh/2+_ddd);
				this.paoBG.rotation=270;
				this.paoBG.size(_hhh,_www+20);
				this.paoBG.scaleX=1;
				}else if(tlkdir==2){
				this.paoLbl.pos(x+w/2,y-_hhh-_ddd+3);
				this.paoBG.pos(x+w/2+_www/2,y-_hhh/2-_ddd);
				this.paoBG.rotation=270;
				this.paoBG.size(_hhh,_www+20);
				this.paoBG.scaleX=-1;
				}else if(tlkdir==3){
				this.paoLbl.pos(x+w/2-_www ,y+h+_ddd+11);
				this.paoBG.pos(x+w/2-_www/2,y+h+_hhh/2+_ddd);
				this.paoBG.rotation=90;
				this.paoBG.size(_hhh,_www+20);
				this.paoBG.scaleX=-1;
			}
			}else{
			this.paoBG.visible=false;
			this.paoLbl.visible=false;
		}
	}

	//给按钮发送事件
	__proto.btnSendClick=function(dialog,btn,data){
		var event=new Event();
		event.type="click";
		if(dialog !=null && btn.name=="close"){
			event.target=btn;
			dialog.event("click",event);
			}else if(data !=null){
			btn.event("click",data);
			}else{
			btn.event("click",event);
		}
	}

	//设置世界坐标 type:0圆形 1矩形 arrow:箭头位置 0:不显示 1234:上下左右
	__proto.setGlobalPos=function(spr,arrow,arrowtalk,str,type,r){
		(arrow===void 0)&& (arrow=0);
		(arrowtalk===void 0)&& (arrowtalk=1);
		(str===void 0)&& (str="");
		(type===void 0)&& (type=0);
		(r===void 0)&& (r=50);
		type=1;
		var point=spr.localToGlobal(new Point(0,0));
		var x=point.x;
		var y=point.y;
		var w=spr.width;
		var h=spr.height;
		if(type==0){
			x=x+w/2;
			y=y+h/2;
		}
		this.setPos(x,y,w,h,r,type,arrow,arrowtalk,str);
	}

	__proto.setData=function(data){
		this.setRemPos(0,0,0,0);
		console.log("this is EventUI");
		this.curSysGuide=data;
		var panelName=data.panel;
		var btnName=data.button;
		var talk=data.bubbleContent;
		var talkdir=data.bubble;
		var cellIndex=-1;
		var btnary=btnName.split(":");
		if(btnary.length > 1){
			cellIndex=parseInt(btnary[0]);
			btnName=btnary[1];
		}
		if(panelName=="1"){
			var cityId=parseInt(btnName);
			var citycell=this.mapCitySession.cityCellObj[cityId];
			App.eventManager.event("SET_POSITION",[cityId,0,0]);
			this.setGlobalPos(citycell._ui,data.arrow,talkdir,talk);
			}else if(panelName=="map_0a"){
			var btn=GuideMain.getMe().cityHeader.jinbu[btnName];
			this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}else if(panelName=="CITY_BUDUI"){
			var dialog=App.dialogManager.getDialogBystr("CITY_BUDUI");
			if(dialog!=null && (dialog instanceof huamao.panel.cityBudui.CityBudui )){
				var citybudui=dialog;
				btn=citybudui[btnName];
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
			}else if(panelName=="CHUZHENG"){
			dialog=App.dialogManager.getDialogBystr("CHUZHENG");
			if(dialog!=null && (dialog instanceof huamao.panel.chuzheng.ChuZheng )){
				var chuzheng=dialog;
				btn=chuzheng[btnName];
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
			}else if(panelName=="MainScene"){
			var scene=App.sceneManager.getCurrentScene();
			if((scene instanceof MainScene )){
				var mainscene=scene;
				this.setGlobalPos(mainscene.mainui[btnName],data.arrow,talkdir,talk);
			}
			}else if(panelName=="UseJice"){
			this.setGlobalPos(UseJice.ins[btnName],data.arrow,talkdir,talk);
			}else if(panelName=="XINGJUN_LIST"){
			dialog=App.dialogManager.getDialogBystr("XINGJUN_LIST");
			var xingjunlist=dialog;
			if(cellIndex !=-1){
				var cell=xingjunlist.list.getCell(cellIndex);
				if((cell instanceof huamao.panel.xingjunList.XingjunListItem )){
					var item=cell;
					btn=item[btnName];
					this.setGlobalPos(btn,data.arrow,talkdir,talk);
				}
				}else{
				this.setGlobalPos(xingjunlist[btnName],data.arrow,talkdir,talk);
			}
			}else if(panelName=="CityInner"){
			scene=App.sceneManager.getCurrentScene();
			if((scene instanceof MainScene )){
				mainscene=scene;
				if(mainscene._cityInner !=null && GameState.state==4){
					var cityinner=mainscene._cityInner;
					var spr=(cityinner [btnName]);
					this.setGlobalPos(spr,data.arrow,talkdir,talk);
				}
			}
			}else if(panelName=="CITY_BUILD_CREATE"){
			dialog=App.dialogManager.getDialogBystr("CITY_BUILD_CREATE");
			var cityBuildCreate=dialog;
			if(cityBuildCreate !=null){
				var createBuildItem=(cityBuildCreate.itemDic[cellIndex]);
				this.setGlobalPos(createBuildItem[btnName],data.arrow,talkdir,talk);
			}
			}else if(panelName=="CITY_BUILD_LVUP"){
			dialog=App.dialogManager.getDialogBystr("CITY_BUILD_LVUP");
			var cityBuildLvup=dialog;
			if(cityBuildLvup !=null){
				btn=cityBuildLvup[btnName];
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
			}else if(panelName=="DIALOG_STRATAGEM"){
			dialog=App.dialogManager.getDialogBystr("DIALOG_STRATAGEM");
			var stratagempanel=dialog;
			if(stratagempanel !=null){
				if(cellIndex !=-1){
					var vv=stratagempanel [btnary[2]];
					if(vv !=null){
						btn=vv[btnName];
						this.setGlobalPos(btn,data.arrow,talkdir,talk);
					}
					}else{
					btn=stratagempanel[btnName]
					this.setGlobalPos(btn,data.arrow,talkdir,talk);
				}
			}
			}else if(panelName=="TASK"){
			dialog=App.dialogManager.getDialogBystr("TASK");
			var taskdialog=dialog;
			if(taskdialog !=null){
				btn=taskdialog[btnName]
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
			}else if(panelName=="DIALOG_ZHAO_MU"){
			dialog=App.dialogManager.getDialogBystr("DIALOG_ZHAO_MU");
			var zhaomupanel=dialog;
			if(zhaomupanel !=null){
				btn=zhaomupanel[btnName]
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
			}else if(panelName=="WUJIANG"){
			dialog=App.dialogManager.getDialogBystr("WUJIANG");
			var wujaingpanel=dialog;
			if(wujaingpanel !=null){
				if(this.curSysGuide.guideId==21 && this.curSysGuide.guideStep==3){
					cellIndex=wujaingpanel.getJeneralCellIndex(1032);
				}
				if(cellIndex !=-1){
					cell=wujaingpanel.list0.getCell(cellIndex);
					if(cell !=null && (cell instanceof huamao.panel.hero.HeroBox )){
						var herobox=cell;
						this.setGlobalPos(herobox,data.arrow,talkdir,talk);
					}
					}else{
					btn=wujaingpanel[btnName];
					this.setGlobalPos(btn,data.arrow,talkdir,talk);
				}
			}
			}else if(panelName=="WUJIANGSHUOMING"){
			dialog=App.dialogManager.getDialogBystr("WUJIANGSHUOMING");
			var heroinfotab=dialog;
			if(heroinfotab !=null){
				if(cellIndex !=-1){
					var heroinfo=heroinfotab.tabBind.getTabCell(cellIndex);
					if(heroinfo!=null){
						btn=heroinfo[btnary[2]]
						this.setGlobalPos(btn,data.arrow,talkdir,talk);
						}else{
						Laya.timer.callLater(this,this.laterDo,[data]);
					}
					}else{
					btn=heroinfotab[btnName];
					this.setGlobalPos(btn,data.arrow,talkdir,talk);
				}
			}
			}else if(panelName=="DIALOG_SHOP"){
			dialog=App.dialogManager.getDialogBystr("DIALOG_SHOP");
			var shoppanel=dialog;
			if(shoppanel !=null){
				btnary=btnName.split("_");
				if(btnary.length > 1){
					var vt=shoppanel [btnary[0]];
					if(vt !=null){
						btn=vt[btnary[1]];
						this.setGlobalPos(btn,data.arrow,talkdir,talk);
					}
					}else{
					btn=shoppanel[btnName];
					this.setGlobalPos(btn,data.arrow,talkdir,talk);
				}
			}
			}else if(panelName=="EquipItemDialog"){
			dialog=App.dialogManager.getDialogBystr("EquipItemDialog");
			var equipdialog=dialog;
			if(equipdialog !=null){
				cell=equipdialog.list0.getCell(cellIndex);
				if(cell !=null && (cell instanceof huamao.dpo.Item )){
					var item1=(cell);
					this.setGlobalPos(item1,data.arrow,talkdir,talk);
				}
				}else{
				Laya.timer.callLater(this,this.laterDo,[data]);
			}
			}else if(panelName=="BINGLIJJ"){
			dialog=App.dialogManager.getDialogBystr("BINGLIJJ");
			var binglijijie=dialog;
			if(binglijijie !=null){
				btn=binglijijie[btnName];
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
			}else if(panelName=="SoulLvUpDialog"){
			dialog=App.dialogManager.getDialogBystr("SoulLvUpDialog");
			var soullvup=dialog;
			if(soullvup !=null){
				btn=soullvup[btnName];
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
				}else{
				Laya.timer.callLater(this,this.laterDo,[data]);
			}
			}else if(panelName=="tips_ysbl"){
			dialog=App.dialogManager.getDialogBystr("YUNSHU_BINGLI");
			var yunshu=dialog;
			if(yunshu !=null){
				btn=yunshu[btnName];
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
		}
	}

	__proto.laterDo=function(data){
		var panelName=data.panel;
		var btnname=data.button;
		var talkdir=data.bubble;
		var talk=data.bubbleContent;
		if(panelName=="WUJIANGSHUOMING"){
			var ary=btnname.split(":");
			var index=parseInt(ary[0]);
			var name=ary[2];
			var dialog=App.dialogManager.getDialogBystr("WUJIANGSHUOMING");
			var heroinfotab=dialog;
			var heroinfo=heroinfotab.tabBind.getTabCell(index);
			if(heroinfo!=null){
				var btn=heroinfo[name];
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
			}else if(panelName=="EquipItemDialog"){
			ary=btnname.split(":");
			index=parseInt(ary[0]);
			dialog=App.dialogManager.getDialogBystr("EquipItemDialog");
			var equipdialog=dialog;
			if(equipdialog !=null){
				var cell=equipdialog.list0.getCell(index);
				if(cell !=null && (cell instanceof huamao.dpo.Item )){
					var item1=(cell);
					this.setGlobalPos(item1,data.arrow,talkdir,talk);
				}
			}
			}else if(panelName=="SoulLvUpDialog"){
			dialog=App.dialogManager.getDialogBystr("SoulLvUpDialog");
			var soullvup=dialog;
			if(soullvup !=null){
				btn=soullvup[btnname];
				this.setGlobalPos(btn,data.arrow,talkdir,talk);
			}
		}
	}

	__proto.uiClickCB=function(olddata){
		if(olddata==null)return true;
		var panelName=olddata.panel;
		var btnName=olddata.button;
		var cellIndex=-1;
		var btnary=btnName.split(":");
		if(btnary.length > 1){
			cellIndex=parseInt(btnary[0]);
			btnName=btnary[1];
		};
		var btn;
		if(olddata.guideId==2 && olddata.guideStep==1){
			App.eventManager.event("REMOVE_GUIDE_FIRE",[2002]);
			App.eventManager.event("GUIDE_ENTER_FIGHT");
			return false;
		}
		if(panelName=="1"){
			var cityId=parseInt(btnName);
			var citycell=this.mapCitySession.cityCellObj[cityId];
			console.log("uiClickCB ---> "+citycell.cityData.battleFileUrl);
			if(citycell.cityData && citycell.cityData.battleFileUrl.length > 0){
				App.eventManager.event("BATTLE",citycell.cityData.battleFileUrl+"");
				return false;
			}
			if(GameState.state==2){
				App.eventManager.event("SHOW_HEADER",citycell);
			}
			else if(GameState.state==3){
				this.mapCitySession.chuzhengParam.setData(citycell.chuzhengType,citycell._fromId,cityId,citycell._juli);
				App.dialogManager.openDialogByStr("CHUZHENG",null,true,true);
			}
			else if(GameState.state==5){
				console.log("----->运输");
				this.mapCitySession.chuzhengParam.setData(-1,citycell._fromId,cityId,citycell._juli);
				App.dialogManager.openDialogByStr("YUNSHU_BINGLI",null,true,true);
			}
			}else if(panelName=="map_0a"){
			if(btnName=="buBtn"){
				App.dialogManager.openDialogByStr("CITY_BUDUI",{cityId:cellIndex,isShowBtn:true},true,true);
				GuideMain.getMe().cityHeader.removeSelf();
				}else if(btnName=="jinBtn"){
				this.mapCityAction.onEnterCityById(cellIndex);
				GuideMain.getMe().cityHeader.removeSelf();
			}
			}else if(panelName=="CITY_BUDUI"){
			var dialog=App.dialogManager.getDialogBystr("CITY_BUDUI");
			if(dialog!=null && (dialog instanceof huamao.panel.cityBudui.CityBudui )){
				var citybudui=dialog;
				btn=citybudui[btnName];
				if(btnName=="chuzheng" && citybudui.ifBingLiEmpty()){
					return true;
				}
				this.btnSendClick(citybudui,btn);
			}
			}else if(panelName=="CHUZHENG"){
			dialog=App.dialogManager.getDialogBystr("CHUZHENG");
			if(dialog!=null && (dialog instanceof huamao.panel.chuzheng.ChuZheng )){
				var chuzheng=dialog;
				btn=chuzheng[btnName];
				this.btnSendClick(chuzheng,btn);
				if(btnName=="buzhen"){
					GuideMain.getMe().lockGuide();
				}
			}
			}else if(panelName=="MainScene"){
			var scene=App.sceneManager.getCurrentScene();
			if((scene instanceof MainScene )){
				var mainscene=scene;
				this.btnSendClick(null,mainscene.mainui[btnName]);
			}
			}else if(panelName=="XINGJUN_LIST"){
			dialog=App.dialogManager.getDialogBystr("XINGJUN_LIST");
			if(dialog!=null && (dialog instanceof huamao.panel.xingjunList.XingjunList )){
				var xingjunlist=dialog;
				if(cellIndex !=-1){
					var cell=xingjunlist.list.getCell(cellIndex);
					if((cell instanceof huamao.panel.xingjunList.XingjunListItem )){
						var item=cell;
						btn=item[btnName];
						this.btnSendClick(xingjunlist,btn);
					}
					}else{
					this.btnSendClick(xingjunlist,xingjunlist[btnName]);
				}
			}
			}else if(panelName=="UseJice"){
			this.btnSendClick(UseJice.ins,UseJice.ins[btnName]);
			}else if(panelName=="CityInner"){
			scene=App.sceneManager.getCurrentScene();
			if((scene instanceof MainScene )){
				mainscene=scene;
				if(mainscene._cityInner !=null){
					var cityinner=mainscene._cityInner;
					this.btnSendClick(null,cityinner[btnName],[cellIndex]);
				}
			}
			}else if(panelName=="CITY_BUILD_CREATE"){
			dialog=App.dialogManager.getDialogBystr("CITY_BUILD_CREATE");
			var cityBuildCreate=dialog;
			if(cityBuildCreate !=null){
				var createBuildItem=(cityBuildCreate.itemDic[cellIndex]);
				this.btnSendClick(cityBuildCreate,createBuildItem[btnName]);
			}
			}else if(panelName=="CITY_BUILD_LVUP"){
			dialog=App.dialogManager.getDialogBystr("CITY_BUILD_LVUP");
			var cityBuildLvup=dialog;
			if(cityBuildLvup !=null){
				btn=cityBuildLvup[btnName];
				this.btnSendClick(cityBuildLvup,btn);
			}
			}else if(panelName=="DIALOG_STRATAGEM"){
			dialog=App.dialogManager.getDialogBystr("DIALOG_STRATAGEM");
			var stratagempanel=dialog;
			if(stratagempanel !=null){
				if(cellIndex !=-1){
					var vv=stratagempanel [btnary[2]];
					if(vv !=null){
						btn=vv[btnName];
						this.btnSendClick(null,btn,[cellIndex]);
					}
					}else{
					btn=stratagempanel[btnName]
					this.btnSendClick(stratagempanel,btn);
				}
			}
			}else if(panelName=="TASK"){
			dialog=App.dialogManager.getDialogBystr("TASK");
			var taskdialog=dialog;
			if(taskdialog !=null){
				btn=taskdialog[btnName]
				if(btnName=="cha"){
					this.btnSendClick(taskdialog,btn);
					}else{
					this.btnSendClick(null,btn);
				}
			}
			}else if(panelName=="DIALOG_ZHAO_MU"){
			dialog=App.dialogManager.getDialogBystr("DIALOG_ZHAO_MU");
			var zhaomupanel=dialog;
			if(zhaomupanel !=null){
				btn=zhaomupanel[btnName]
				if(btnName=="cha"){
					this.btnSendClick(zhaomupanel,btn);
					}else{
					this.btnSendClick(null,btn);
				}
			}
			}else if(panelName=="WUJIANG"){
			dialog=App.dialogManager.getDialogBystr("WUJIANG");
			var wujaingpanel=dialog;
			if(wujaingpanel !=null){
				if(this.curSysGuide.guideId==21 && this.curSysGuide.guideStep==3){
					cellIndex=wujaingpanel.getJeneralCellIndex(1032);
				}
				if(cellIndex !=-1){
					cell=wujaingpanel.list0.getCell(cellIndex);
					if(cell !=null && (cell instanceof huamao.panel.hero.HeroBox )){
						var herobox=cell;
						var heroData=wujaingpanel.list0.getItem(cellIndex);
						this.btnSendClick(null,herobox,[heroData]);
					}
					}else{
					btn=wujaingpanel[btnName];
					this.btnSendClick(wujaingpanel,btn);
				}
			}
			}else if(panelName=="WUJIANGSHUOMING"){
			dialog=App.dialogManager.getDialogBystr("WUJIANGSHUOMING");
			var heroinfotab=dialog;
			if(heroinfotab !=null){
				if(cellIndex !=-1){
					var heroinfo=heroinfotab.tabBind.getTabCell(cellIndex);
					if(btnName=="tab0"){
						var name=btnary[2];
						btn=heroinfo[name];
						if(name=="box1"){
							this.btnSendClick(null,btn,[1,btn]);
							}else if(name=="box2"){
							this.btnSendClick(null,btn,[2,btn]);
							}else if(name=="box3"){
							this.btnSendClick(null,btn,[3,btn]);
							}else{
							this.btnSendClick(null,btn);
						}
					}
					}else if(btnName=="cha"){
					btn=heroinfotab[btnName];
					this.btnSendClick(heroinfotab,btn);
				}
			}
			}else if(panelName=="DIALOG_SHOP"){
			dialog=App.dialogManager.getDialogBystr("DIALOG_SHOP");
			var shoppanel=dialog;
			if(shoppanel !=null){
				btnary=btnName.split("_");
				if(btnary.length > 1){
					var vt=shoppanel [btnary[0]];
					if(vt !=null){
						btn=vt[btnary[1]];
						this.btnSendClick(null,btn);
					}
					}else if(btnName=="cha"){
					btn=shoppanel[btnName];
					this.btnSendClick(shoppanel,btn);
				}
			}
			}else if(panelName=="EquipItemDialog"){
			dialog=App.dialogManager.getDialogBystr("EquipItemDialog");
			var equipdialog=dialog;
			if(equipdialog !=null){
				equipdialog.list0.selectedIndex=0;
			}
			}else if(panelName=="BINGLIJJ"){
			dialog=App.dialogManager.getDialogBystr("BINGLIJJ");
			var binglijijie=dialog;
			if(binglijijie !=null){
				btn=binglijijie[btnName];
				this.btnSendClick(null,btn);
			}
			}else if(panelName=="SoulLvUpDialog"){
			dialog=App.dialogManager.getDialogBystr("SoulLvUpDialog");
			var soullvup=dialog;
			if(soullvup !=null){
				btn=soullvup[btnName];
				if(btnName !="cha"){
					this.btnSendClick(null,btn);
					}else{
					this.btnSendClick(soullvup,btn);
				}
			}
			}else if(panelName=="tips_ysbl"){
			dialog=App.dialogManager.getDialogBystr("YUNSHU_BINGLI");
			var yunshu=dialog;
			if(yunshu !=null){
				btn=yunshu[btnName];
				this.btnSendClick(null,btn);
			}
		}
		return false;
	}

	__proto.clearAll=function(){
		if(this.anim !=null){
			this.anim.dispose();
		}
	}

	return EventUI;
})(baseUI)


//class huamao.guide.ui.RangeUI extends huamao.guide.ui.baseUI
var RangeUI=(function(_super){
	function RangeUI(_guidemain){
		this.remX=0;
		this.remY=0;
		this.remW=0;
		this.remH=0;
		this.guidemain=null;
		this.maskArea=null;
		this.range=null;
		this.paoBG=null;
		// public var paoLbl:Label=null;
		this.paoLbl=null;
		this.anim=null;
		this.unarea=null;
		this.minNum=2;
		this.maxNum=10;
		this.alphS=true;
		this.alphaNum=this.minNum;
		RangeUI.__super.call(this);
		App.injOne(this);
		this.guidemain=_guidemain;
		this.init();
	}

	__class(RangeUI,'huamao.guide.ui.RangeUI',_super);
	var __proto=RangeUI.prototype;
	__proto.init=function(){
		this.on("mousedown",this,this.mouseDownCB);
		this.unarea=new UnArea();
		this.unarea.zOrder=0;
		this.addChild(this.unarea);
		this.range=new Image();
		this.range.sizeGrid="33,43,37,55";
		this.range.zOrder=1;
		this.addChild(this.range);
		this.paoBG=new Image("comp/G/lt_b_1.png");
		this.paoBG.sizeGrid="18,18,5,9";
		this.paoBG.anchorX=0.5;
		this.paoBG.anchorY=0.5;
		this.paoBG.zOrder=2;
		this.addChild(this.paoBG);
		this.paoLbl=new HTMLDivElement();
		this.paoLbl.zOrder=3;
		this.addChild(this.paoLbl);
		this.anim=new DragonBonesMc(false,false);
		this.anim.setUrl("res/load/shouzhitou.sk");
		this.anim.scale(0.5,0.5);
		this.anim.zOrder=4;
		this.addChild(this.anim);
		this.setpos(500,100,400,200,1,"测试蚊子|敌对度|老实交代放暑假了");
	}

	__proto.mouseDownCB=function(e){
		if(e.type=="mousedown"){
			var stagex=e.stageX;
			var stagey=e.stageY;
			if(stagex > this.remX && stagex < this.remX+this.remW && stagey > this.remY && stagey < this.remY+this.remH){
				this.guidemain.nextStep();
			}
		}
	}

	__proto.setRemPos=function(x,y,w,h){
		this.remX=x;
		this.remY=y;
		this.remW=w;
		this.remH=h;
	}

	__proto.resize=function(){
		if(this.maskArea !=null && this.maskArea.graphics !=null){
			this.maskArea.graphics.clear();
			this.maskArea.graphics.drawRect(0,0,Browser.width,Browser.height,"#000000");
		}
	}

	__proto.setpos=function(x,y,w,h,tlkdir,talkstr){
		this.setRemPos(x,y,w,h);
		this.unarea.setSize(x,y,w,h);
		this.range.pos(x-17,y-17);
		this.range.size(w+17*2,h+20*2);
		this.anim.pos(x+w/2,y+h/2);
		if(talkstr!=null && talkstr.length > 0){
			this.paoBG.visible=true;
			this.paoLbl.visible=true;
			this.paoLbl.innerHTML=GuideMain.getHtmlStr(talkstr);
			var _www=this.paoLbl.contextWidth;
			var _hhh=this.paoLbl.contextHeight+20;
			var _ddd=20;
			if(tlkdir==1){
				this.paoLbl.pos(x+w/2-_www,y-_hhh-_ddd+2);
				this.paoBG.pos(x+w/2-_www/2,y-_hhh/2-_ddd);
				this.paoBG.rotation=90;
				this.paoBG.size(_hhh,_www+20);
				this.paoBG.scaleX=1;
				}else if(tlkdir==4){
				this.paoLbl.pos(x+w/2 ,y+h+_ddd+13);
				this.paoBG.pos(x+w/2+_www/2,y+h+_hhh/2+_ddd);
				this.paoBG.rotation=270;
				this.paoBG.size(_hhh,_www+20);
				this.paoBG.scaleX=1;
				}else if(tlkdir==2){
				this.paoLbl.pos(x+w/2,y-_hhh-_ddd+2);
				this.paoBG.pos(x+w/2+_www/2,y-_hhh/2-_ddd);
				this.paoBG.rotation=270;
				this.paoBG.size(_hhh,_www+20);
				this.paoBG.scaleX=-1;
				}else if(tlkdir==3){
				this.paoLbl.pos(x+w/2-_www ,y+h+_ddd+13);
				this.paoBG.pos(x+w/2-_www/2,y+h+_hhh/2+_ddd);
				this.paoBG.rotation=90;
				this.paoBG.size(_hhh,_www+20);
				this.paoBG.scaleX=-1;
			}
			}else{
			this.paoBG.visible=false;
			this.paoLbl.visible=false;
		}
	}

	__proto.setGlobalPos=function(spr,talkdir,talkstr){
		var point=spr.localToGlobal(new Point(0,0));
		var x=point.x;
		var y=point.y;
		this.setpos(x,y,spr.width,spr.height,talkdir,talkstr);
	}

	__proto.setData=function(data){
		this.setRemPos(0,0,0,0);
		var panelName=data.panel;
		var btnName=data.button;
		var talk=data.bubbleContent;
		var talkdir=data.bubble;
		var cellIndex=-1;
		var btnary=btnName.split(":");
		if(btnary.length > 1){
			cellIndex=parseInt(btnary[0]);
			btnName=btnary[1];
		}
		if(panelName=="CHUZHENG"){
			var dialog=App.dialogManager.getDialogBystr("CHUZHENG");
			if(dialog!=null && (dialog instanceof huamao.panel.chuzheng.ChuZheng )){
				var chuzheng=dialog;
				var btn=chuzheng[btnName];
				this.setGlobalPos(btn,talkdir,talk);
			}
			}else if(panelName=="WUJIANGSHUOMING"){
			dialog=App.dialogManager.getDialogBystr("WUJIANGSHUOMING");
			var heroinfotab=dialog;
			if(heroinfotab !=null){
				if(cellIndex !=-1){
					var heroinfo=heroinfotab.tabBind.getTabCell(cellIndex);
					if(heroinfo!=null){
						btn=heroinfo[btnary[2]]
						this.setGlobalPos(btn,talkdir,talk);
					}
				}
			}
		}
		this.rangeImgAnimi(true);
	}

	__proto.rangeImgAnimi=function(open){
		if(open){
			this.alphaNum=this.minNum;
			this.alphS=true;
			Laya.timer.loop(200,this,this.rangeImgCB);
			}else{
			Laya.timer.clear(this,this.rangeImgCB);
		}
	}

	__proto.rangeImgCB=function(){
		if(this.alphS){
			this.alphaNum++;
			if(this.alphaNum==this.maxNum){
				this.alphS=false;
			}
			}else{
			this.alphaNum--;
			if(this.alphaNum==this.minNum){
				this.alphS=true;
			}
		}
		this.range.alpha=this.alphaNum/this.maxNum;
	}

	__proto.uiClickCB=function(olddata){
		this.rangeImgAnimi(false);
		return false;
	}

	__proto.initImg=function(){
		this.range.skin="comp/newhand/kuangkuang.png";
	}

	return RangeUI;
})(baseUI)


//class huamao.guide.ui.SpecialUI extends huamao.guide.ui.baseUI
var SpecialUI=(function(_super){
	function SpecialUI(){
		//陈留 2010
		this.maskArea=null;
		SpecialUI.__super.call(this);
		this.init();
	}

	__class(SpecialUI,'huamao.guide.ui.SpecialUI',_super);
	var __proto=SpecialUI.prototype;
	__proto.init=function(){
		this.size(Laya.stage.width,Laya.stage.height);
		this.mouseThrough=false;
		this.maskArea=new Sprite();
		this.maskArea.alpha=0.6;
		this.maskArea.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,"#000000");
		this.maskArea.mouseThrough=false
		this.addChild(this.maskArea);
		this.cacheAs="bitmap";
		this.scrollRect=new Rectangle(0,0,Laya.stage.width,Laya.stage.height);
	}

	__proto.resize=function(){
		if(this.maskArea !=null && this.maskArea.graphics !=null){
			this.maskArea.graphics.clear();
			this.maskArea.graphics.drawRect(0,0,Browser.width,Browser.height,"#000000");
		}
	}

	__proto.beginCB=function(){
		App.eventManager.event("ADD_GUIDE_LINE",[2002,2010]);
		Laya.timer.once(1500,this,this.fireCity);
	}

	__proto.fireCity=function(){
		App.eventManager.event("REMOVE_GUIDE_LINE");
		App.eventManager.event("ADD_GUIDE_FIRE",[2010]);
		Laya.timer.once(3000,this,this.waterCity);
	}

	__proto.waterCity=function(){
		App.eventManager.event("REMOVE_GUIDE_FIRE",[2010]);
		App.eventManager.event("RESET_GUIDE_CITY",[2010]);
		GuideMain.getMe().unLockGuide();
		App.eventManager.event("CHECK_GUIDE");
	}

	__proto.setData=function(data){
		console.log("this is specialui");
		this.beginCB();
	}

	__proto.uiClickCB=function(olddata){
		return false;
	}

	return SpecialUI;
})(baseUI)


//class huamao.guide.ui.TalkUI2 extends huamao.guide.ui.baseUI
var TalkUI2=(function(_super){
	function TalkUI2(){
		this.mainPlayerSession=null;
		this.mapCityAction=null;
		this.talkUI=null;
		this.content=null;
		this.contentAry=null;
		this.contentLen=0;
		this.count=0;
		this.next=false;
		// private var fontSize:int=24;
		this.autoresize=null;
		this._$5_scale=0.8;
		this.maskArea=null;
		this.skipDragon=null;
		this.pubDragon=null;
		this.box=null;
		this.boxW=700;
		this.objMap=new Object;
		TalkUI2.__super.call(this);
		App.injOne(this);
		this.maskArea=new Sprite();
		this.maskArea.alpha=0.6;
		this.maskArea.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,"#000000");
		this.addChild(this.maskArea);
		App.loaderManager.load("ATLAS","newhand.atlas",new Handler(this,this.loadOver),null,null,1,true,TalkUI2.GuideRes);
	}

	__class(TalkUI2,'huamao.guide.ui.TalkUI2',_super);
	var __proto=TalkUI2.prototype;
	__proto.loadOver=function(){
		this.init();
		GuideMain.getMe().initImgRangeUI();
		App.eventManager.event("GUIDE_UI_OVER");
		console.log("[guide] loadOver() -------->");
	}

	__proto.init=function(){
		this.size(Laya.stage.width,Laya.stage.height);
		this.mouseThrough=false;
		this.talkUI=new xinshouUI();
		this.addChild(this.talkUI);
		this.autoresize=new AutoResize(this.talkUI);
		this.talkUI.bottom=0;
		this.talkUI.centerX=0;
		this.talkUI.zuo.left=0;
		this.talkUI.zuo.bottom=0;
		this.talkUI.you.left=0;
		this.talkUI.you.bottom=0;
		this.talkUI.zuoren.visible=false;
		this.talkUI.youren.visible=false;
		this.talkUI.zuo.zOrder=1;
		this.talkUI.you.zOrder=2;
		this.skipDragon=new DragonBonesMc(false);
		this.skipDragon.setUrl("res/load/liuguang1.sk");
		this.skipDragon.pos(this.talkUI.width/2,this.talkUI.height-35);
		this.skipDragon.zOrder=10;
		this.talkUI.addChild(this.skipDragon);
		this.skipDragon.visible=false;
		this.box=new Sprite();
		this.box.size(this.boxW,this.boxW);
		this.box.scrollRect=new Rectangle(0,0,this.boxW,this.boxW);
		this.talkUI.addChild(this.box);
	}

	__proto.resize=function(){
		if(this.maskArea !=null && this.maskArea.graphics !=null){
			this.maskArea.graphics.clear();
			this.maskArea.graphics.drawRect(0,0,Browser.width,Browser.height,"#000000");
			console.log("width1 = "+Browser.width);
		}
		this.size(Browser.width,Browser.height);
		console.log("width2 = "+Browser.width);
	}

	__proto.getDragonBonesMc=function(dir,pathicon,face){
		var key=pathicon+dir;
		if(this.objMap[key]==null){
			var drag=new DragonBonesMc(true,false);
			drag.zOrder=0;
			drag.setUrl(pathicon);
			this.objMap[key]=drag;
			}else{
			drag=this.objMap [key];
			drag.play();
		}
		if(face==2){
			drag.scale(-this._$5_scale,this._$5_scale);
			}else{
			drag.scale(this._$5_scale,this._$5_scale);
		}
		drag.pos(this.boxW/2,this.boxW);
		if(dir==1){
			this.box.pos(this.talkUI.zuo.width/2-333-this.boxW/2,417-this.boxW);
			}else{
			this.box.pos(this.talkUI.zuo.width/2+333-this.boxW/2,417-this.boxW);
		}
		this.box.addChild(drag);
		return drag;
	}

	__proto.clearAll=function(){
		var i;
		for(var $each_i in this.objMap){
			i=this.objMap[$each_i];
			i.dispose();
		}
		Loader.clearResByGroup(TalkUI2.GuideRes);
		Loader.clearRes("res/atlas/comp/yun.atlas");
	}

	__proto.hideByDir=function(dir,pathicon,name,content){
		if(dir==1){
			this.talkUI.zuo.visible=true;
			this.talkUI.you.visible=false;
			this.talkUI.zuoname.text=name;
			}else if(dir==2){
			this.talkUI.zuo.visible=false;
			this.talkUI.you.visible=true;
			this.talkUI.youname.text=name;
		}
	}

	__proto.mainSceneVisible=function(tt){
		var scene=App.sceneManager.getCurrentScene();
		console.log("mainSceneVisible --------> ");
		if((scene instanceof MainScene )){
			var mainscene=scene;
			mainscene.ifVisibleMainUI(tt);
		}
	}

	__proto.setData=function(data){
		if(this.talkUI==null)return;
		this.mainSceneVisible(false);
		var direction=data.direction;
		var iconId=data.character;
		var name=data.characterName;
		this.content=data.content;
		var iconpath;
		if(iconId=="1"){
			var style=this.mainPlayerSession.mainPlayerData.style;
			var syslordbody=ConfigManager.getConfig("sys_lordbody.txt",style+1);
			iconpath=this.getDragonPath(style);
			}else{
			iconpath="res/load/"+iconId+".sk";
		}
		this.hideByDir(direction,iconpath,name,"");
		this.pubDragon=this.getDragonBonesMc(direction,iconpath,data.faceDirection);
		this.initConten();
		Laya.timer.loop(100,this,this.timeCB,[direction]);
		if(data.guideId==1 && data.guideStep==1){
			App.eventManager.event("ADD_GUIDE_FIRE",[2002]);
		}
	}

	__proto.getDragonPath=function(type){
		var path="";
		switch(type){
			case 0:
				path="res/load/zhujueyi.sk";
				break ;
			case 1:
				path="res/load/zhujueer.sk";
				break ;
			case 2:
				path="res/load/zhujuesan.sk";
				break ;
			case 3:
				path="res/load/juesesi.sk";
				break ;
			}
		return path;
	}

	__proto.initConten=function(){
		this.next=false;
		this.count=1;
		this.contentLen=0;
		this.contentAry=this.content.split("|");
		for(var i=0;i<this.contentAry.length;i++){
			this.contentLen+=(this.contentAry [i]).length;
		}
	}

	__proto.timeCB=function(dir){
		if(this.count <=this.contentLen){
			if(dir==1){
				this.talkUI.zuowenzi.innerHTML=this.getSubStr(this.count++);
				}else{
				this.talkUI.youwenzi.innerHTML=this.getSubStr(this.count++);
			}
			}else{
			this.next=true;
			Laya.timer.clear(this,this.timeCB);
			this.ifaddOrRemSkip(true)
		}
	}

	__proto.getSubStr=function(_count){
		var result="";
		var color="";
		if(_count==this.contentLen){
			for(var i=0;i<this.contentAry.length;i++){
				(i%2==1)? (color=GuideMain.splColor):(color=GuideMain.norColor);
				result+=TheGame.FONT(this.contentAry [i],color,GuideMain.guideFontSize,SysTalkData.font);
			}
			return result;
			}else{
			for(i=0;i<this.contentAry.length;i++){
				(i%2==1)? (color=GuideMain.splColor):(color=GuideMain.norColor);
				var curstr=this.contentAry [i];
				var len=curstr.length;
				if(_count > 0){
					if(_count > len){
						result+=TheGame.FONT(curstr,color,GuideMain.guideFontSize,SysTalkData.font);
						_count-=len;
						}else{
						result+=TheGame.FONT(curstr.substr(0,_count),color,GuideMain.guideFontSize,SysTalkData.font);
						_count-=len;
					}
					}else{
					break ;
				}
			}
			return result;
		}
	}

	__proto.ifaddOrRemSkip=function(ifadd){
		if(this.skipDragon==null)return;
		if(ifadd){
			this.skipDragon.visible=ifadd;
			}else{
			this.skipDragon.visible=ifadd;
		}
	}

	// talkUI.removeChild(skipDragon);
	__proto.uiClickCB=function(olddata){
		if(!this.next){
			this.next=true;
			Laya.timer.clear(this,this.timeCB);
			this.ifaddOrRemSkip(true);
			if(olddata.direction==1){
				this.talkUI.zuowenzi.innerHTML=this.getSubStr(this.contentLen);
				}else{
				this.talkUI.youwenzi.innerHTML=this.getSubStr(this.contentLen);
			}
			return true;
		}
		this.remoDragon();
		if(olddata.guideId==2){
			App.eventManager.event("GUIDE_GUIDE2FIGHT");
			return false;
		};
		var guideId=olddata.guideId;
		var guideStep=olddata.guideStep;
		if(guideId==3 && guideStep==9){
			console.log("新手引导 申请获取武将");
			this.mapCityAction.sendGuideWuJiang(1);
			GuideMain.addUILoading();
			}else if(guideId==5 && guideStep==1){
			console.log("新手引导 申请获取加速计策");
			this.mapCityAction.sendGuideWuJiang(2);
			GuideMain.addUILoading();
			}else if(guideId==12 && guideStep==3){
			this.mapCityAction.sendGuideWuJiang(3);
			GuideMain.addUILoading();
			}else if(guideId==18 && guideStep==1){
			this.mapCityAction.sendGuideWuJiang(4);
			GuideMain.addUILoading();
			}else if(guideId==22 && guideStep==1){
			this.mapCityAction.sendGuideWuJiang(5);
			GuideMain.addUILoading();
		}
		this.mainSceneVisible(true);
		console.log("------------->kkkkkkkkkk");
		return false;
	}

	__proto.remoDragon=function(){
		if(this.box==null)return;
		this.ifaddOrRemSkip(false);
		this.box.removeChild(this.pubDragon);
		this.talkUI.zuowenzi.innerHTML="";
		this.talkUI.youwenzi.innerHTML="";
	}

	TalkUI2.GuideRes="GuideRes";
	return TalkUI2;
})(baseUI)


//class huamao.panel.hero.HeroImage extends laya.ui.Image
var HeroImage=(function(_super){
	function HeroImage(){
		HeroImage.__super.call(this);
	}

	__class(HeroImage,'huamao.panel.hero.HeroImage',_super);
	var __proto=HeroImage.prototype;
	__proto.setHeroId=function(heroId){
		this.skin=null;
		this.skin=GameUtils.getHeroSkin(heroId);
	}

	/**等比缩放 */
	__proto.setScaleSize=function(wid,hei){
		if(this.source){
			this.loadFun(wid,hei);
			return;
		}
		this.on("loaded",this,this.loadFun,[wid,hei]);
	}

	__proto.loadFun=function(wid,hei){
		this.scaleY=this.scaleX=((wid!=0)?(wid/this.width):(hei/this.height));
	}

	return HeroImage;
})(Image)


//class huamao.panel.worldMap.SmallMap extends laya.ui.Box
var SmallMap=(function(_super){
	function SmallMap(ww,hh){
		this.mapCitySession=null;
		this.mainPlayerSession=null;
		this._border=null;
		this._ww=NaN;
		this._hh=NaN;
		this.mapScaleX=NaN;
		this.mapScaleY=NaN;
		this._content=null;
		this._cityDic=new Object();
		SmallMap.__super.call(this);
		this._ww=ww;
		this._hh=hh;
		this.mapScaleX=GameMap.scaleWidth / this._ww;
		this.mapScaleY=GameMap.scaleHeight / this._hh;
		App.injOne(this);
		this._content=new Sprite();
		this._content.cacheAs="bitmap";
		this.addChild(this._content);
		this._content.cacheAs="bitmap";
		this._border=new Border(ww,hh);
		this.addChild(this._border);
		App.eventManager.on("ADD_CITY_PLAYER",this,this.onUpdate);
		App.eventManager.on("UPDATE_CITY_INFO",this,this.onUpdateOne);
		App.eventManager.on("UPDATE_PLAYER_LIST",this,this.updateCitys);
		App.eventManager.on("RESIZE_MAP",this,this.setBorder);
	}

	__class(SmallMap,'huamao.panel.worldMap.SmallMap',_super);
	var __proto=SmallMap.prototype;
	/**
	*
	*@param xx
	*@param yy
	*
	*/
	__proto.setBorder=function(){
		this.mapScaleX=GameMap.scaleWidth / this._ww;
		this.mapScaleY=GameMap.scaleHeight / this._hh;
		this._border.resize();
		this._border.pos(GameMap.tempX / this.mapScaleX,GameMap.tempY / this.mapScaleY);
	}

	__proto.onUpdate=function(data){
		this.updateCitys();
	}

	__proto.onUpdateOne=function(cityData,playerData){
		this.updateCitys();
	}

	__proto.updateCitys=function(){
		this.mapScaleX=GameMap.mapWidth / this._ww;
		this.mapScaleY=GameMap.mapHeight / this._hh;
		var cityData;
		for(var $each_cityData in this.mapCitySession.getAllCitys()){
			cityData=this.mapCitySession.getAllCitys()[$each_cityData];
			var cell;
			if(this._cityDic[cityData.cityId] !=null){
				cell=this._cityDic[cityData.cityId];
			}
			else{
				cell=new SmallMapCell();
				this._cityDic[cityData.cityId]=cell;
			};
			var playerData=this.mapCitySession.getCityPlayer(cityData.playerId);
			if(playerData && playerData.playerId !=0){
				cell.change(playerData.cityFlag);
			}
			else{
				cell.change("ffffff");
			};
			var pos=this.mapCitySession.mapPosObj[cityData.cityId];
			cell.x=pos[0] / this.mapScaleX;
			cell.y=pos[1] / this.mapScaleY;
			if(this.mainPlayerSession.checkIfInGuide()){
				if(cityData.sysCity.cityGuide !=0){
					if(cell.parent==null){
						this._content.addChild(cell);
					}
				}
			}
			else{
				if(cell.parent==null){
					this._content.addChild(cell);
				}
			}
		}
	}

	return SmallMap;
})(Box)


//class huamao.panel.worldMap.Border extends laya.ui.Image
var Border=(function(_super){
	function Border(ww,hh){
		this._ww=NaN;
		this._hh=NaN;
		this.ww2=NaN;
		this.hh2=NaN;
		Border.__super.call(this);
		this.skin="comp/G/lk.png";
		this.sizeGrid="2,2,2,2";
		this._ww=ww;
		this._hh=hh;
		this.ww2=ww / GameMap.windowScaleX;
		this.hh2=hh / GameMap.windowScaleY;
		this.size(this.ww2,this.hh2);
		this.anchorX=this.anchorY=0.5;
		this.mouseEnabled=false;
	}

	__class(Border,'huamao.panel.worldMap.Border',_super);
	var __proto=Border.prototype;
	__proto.resize=function(){
		this.ww2=this._ww / GameMap.windowScaleX;
		this.hh2=this._hh / GameMap.windowScaleY;
		this.size(this.ww2,this.hh2);
	}

	return Border;
})(Image)


//class huamao.panel.worldMap.MengyouBorder extends laya.ui.Image
var MengyouBorder=(function(_super){
	function MengyouBorder(){
		MengyouBorder.__super.call(this,"comp/G/kuang_m.png");
		this.sizeGrid="10,10,10,10";
		this.size(245,83);
		this.mouseEnabled=false;
	}

	__class(MengyouBorder,'huamao.panel.worldMap.MengyouBorder',_super);
	return MengyouBorder;
})(Image)


//class huamao.panel.worldMap.SmallMapCell extends laya.ui.Image
var SmallMapCell=(function(_super){
	function SmallMapCell(){
		this.color=null;
		SmallMapCell.__super.call(this);
		this.change("ffffff");
	}

	__class(SmallMapCell,'huamao.panel.worldMap.SmallMapCell',_super);
	var __proto=SmallMapCell.prototype;
	__proto.change=function(color_){
		if(color_==this.color){
			return;
		}
		this.color=color_;
		this.skin="comp/icon/"+color_+".png";
		this.pos(-2,-2);
		this.size(4,4);
	}

	return SmallMapCell;
})(Image)


/**
*<code>Group</code> 是一个可以自动布局的项集合控件。
*<p> <code>Group</code> 的默认项对象为 <code>Button</code> 类实例。
*<code>Group</code> 是 <code>Tab</code> 和 <code>RadioGroup</code> 的基类。</p>
*/
//class laya.ui.UIGroup extends laya.ui.Box
var UIGroup=(function(_super){
	function UIGroup(labels,skin){
		/**
		*改变 <code>Group</code> 的选择项时执行的处理器，(默认返回参数： 项索引（index:int）)。
		*/
		this.selectHandler=null;
		/**@private */
		this._items=null;
		/**@private */
		this._selectedIndex=-1;
		/**@private */
		this._skin=null;
		/**@private */
		this._direction="horizontal";
		/**@private */
		this._space=0;
		/**@private */
		this._labels=null;
		/**@private */
		this._labelColors=null;
		/**@private */
		this._labelFont=null;
		/**@private */
		this._labelStrokeColor=null;
		/**@private */
		this._strokeColors=null;
		/**@private */
		this._labelStroke=NaN;
		/**@private */
		this._labelSize=0;
		/**@private */
		this._labelBold=false;
		/**@private */
		this._labelPadding=null;
		/**@private */
		this._labelAlign=null;
		/**@private */
		this._stateNum=0;
		/**@private */
		this._labelChanged=false;
		UIGroup.__super.call(this);
		this.skin=skin;
		this.labels=labels;
	}

	__class(UIGroup,'laya.ui.UIGroup',_super);
	var __proto=UIGroup.prototype;
	Laya.imps(__proto,{"laya.ui.IItem":true})
	/**@inheritDoc */
	__proto.preinitialize=function(){
		this.mouseEnabled=true;
	}

	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		laya.ui.Component.prototype.destroy.call(this,destroyChild);
		this._items && (this._items.length=0);
		this._items=null;
		this.selectHandler=null;
	}

	/**
	*添加一个项对象，返回此项对象的索引id。
	*
	*@param item 需要添加的项对象。
	*@param autoLayOut 是否自动布局，如果为true，会根据 <code>direction</code> 和 <code>space</code> 属性计算item的位置。
	*@return
	*/
	__proto.addItem=function(item,autoLayOut){
		(autoLayOut===void 0)&& (autoLayOut=true);
		var display=item;
		var index=this._items.length;
		display.name="item"+index;
		this.addChild(display);
		this.initItems();
		if (autoLayOut && index > 0){
			var preItem=this._items [index-1];
			if (this._direction=="horizontal"){
				display.x=preItem.x+preItem.width+this._space;
				}else {
				display.y=preItem.y+preItem.height+this._space;
			}
			}else {
			if (autoLayOut){
				display.x=0;
				display.y=0;
			}
		}
		return index;
	}

	/**
	*删除一个项对象。
	*@param item 需要删除的项对象。
	*@param autoLayOut 是否自动布局，如果为true，会根据 <code>direction</code> 和 <code>space</code> 属性计算item的位置。
	*/
	__proto.delItem=function(item,autoLayOut){
		(autoLayOut===void 0)&& (autoLayOut=true);
		var index=this._items.indexOf(item);
		if (index !=-1){
			var display=item;
			this.removeChild(display);
			for (var i=index+1,n=this._items.length;i < n;i++){
				var child=this._items [i];
				child.name="item"+(i-1);
				if (autoLayOut){
					if (this._direction=="horizontal"){
						child.x-=display.width+this._space;
						}else {
						child.y-=display.height+this._space;
					}
				}
			}
			this.initItems();
			if (this._selectedIndex >-1){
				var newIndex=0;
				newIndex=this._selectedIndex < this._items.length ? this._selectedIndex :(this._selectedIndex-1);
				this._selectedIndex=-1;
				this.selectedIndex=newIndex;
			}
		}
	}

	/**
	*初始化项对象们。
	*/
	__proto.initItems=function(){
		this._items || (this._items=[]);
		this._items.length=0;
		for (var i=0;i < 10000;i++){
			var item=this.getChildByName("item"+i);
			if (item==null)break ;
			this._items.push(item);
			item.selected=(i===this._selectedIndex);
			item.clickHandler=Handler.create(this,this.itemClick,[i],false);
		}
	}

	/**
	*@private
	*项对象的点击事件侦听处理函数。
	*@param index 项索引。
	*/
	__proto.itemClick=function(index){
		this.selectedIndex=index;
	}

	/**
	*@private
	*通过对象的索引设置项对象的 <code>selected</code> 属性值。
	*@param index 需要设置的项对象的索引。
	*@param selected 表示项对象的选中状态。
	*/
	__proto.setSelect=function(index,selected){
		if (this._items && index >-1 && index < this._items.length)this._items[index].selected=selected;
	}

	/**
	*@private
	*创建一个项显示对象。
	*@param skin 项对象的皮肤。
	*@param label 项对象标签。
	*/
	__proto.createItem=function(skin,label){
		return null;
	}

	/**
	*@private
	*更改项对象的属性值。
	*/
	__proto.changeLabels=function(){
		this._labelChanged=false;
		if (this._items){
			var left=0
			for (var i=0,n=this._items.length;i < n;i++){
				var btn=this._items [i];
				this._skin && (btn.skin=this._skin);
				this._labelColors && (btn.labelColors=this._labelColors);
				this._labelSize && (btn.labelSize=this._labelSize);
				this._labelStroke && (btn.labelStroke=this._labelStroke);
				this._labelStrokeColor && (btn.labelStrokeColor=this._labelStrokeColor);
				this._strokeColors && (btn.strokeColors=this._strokeColors);
				this._labelBold && (btn.labelBold=this._labelBold);
				this._labelPadding && (btn.labelPadding=this._labelPadding);
				this._labelAlign && (btn.labelAlign=this._labelAlign);
				this._stateNum && (btn.stateNum=this._stateNum);
				this._labelFont && (btn.labelFont=this._labelFont);
				if (this._direction==="horizontal"){
					btn.y=0;
					btn.x=left;
					left+=btn.width+this._space;
					}else {
					btn.x=0;
					btn.y=left;
					left+=btn.height+this._space;
				}
			}
		}
		this.changeSize();
	}

	/**@inheritDoc */
	__proto.commitMeasure=function(){
		this.runCallLater(this.changeLabels);
	}

	/**@private */
	__proto._setLabelChanged=function(){
		if (!this._labelChanged){
			this._labelChanged=true;
			this.callLater(this.changeLabels);
		}
	}

	/**
	*<p>描边颜色，以字符串表示。</p>
	*默认值为 "#000000"（黑色）;
	*@see laya.display.Text.strokeColor()
	*/
	__getset(0,__proto,'labelStrokeColor',function(){
		return this._labelStrokeColor;
		},function(value){
		if (this._labelStrokeColor !=value){
			this._labelStrokeColor=value;
			this._setLabelChanged();
		}
	});

	/**
	*@copy laya.ui.Image#skin
	*/
	__getset(0,__proto,'skin',function(){
		return this._skin;
		},function(value){
		if (this._skin !=value){
			this._skin=value;
			this._setLabelChanged();
		}
	});

	/**
	*表示当前选择的项索引。默认值为-1。
	*/
	__getset(0,__proto,'selectedIndex',function(){
		return this._selectedIndex;
		},function(value){
		if (this._selectedIndex !=value){
			this.setSelect(this._selectedIndex,false);
			this._selectedIndex=value;
			this.setSelect(value,true);
			this.event("change");
			this.selectHandler && this.selectHandler.runWith(this._selectedIndex);
		}
	});

	/**
	*标签集合字符串。以逗号做分割，如"item0,item1,item2,item3,item4,item5"。
	*/
	__getset(0,__proto,'labels',function(){
		return this._labels;
		},function(value){
		if (this._labels !=value){
			this._labels=value;
			this.removeChildren();
			this._setLabelChanged();
			if (this._labels){
				var a=this._labels.split(",");
				for (var i=0,n=a.length;i < n;i++){
					var item=this.createItem(this._skin,a[i]);
					item.name="item"+i;
					this.addChild(item);
				}
			}
			this.initItems();
		}
	});

	/**
	*<p>表示各个状态下的描边颜色。</p>
	*@see laya.display.Text.strokeColor()
	*/
	__getset(0,__proto,'strokeColors',function(){
		return this._strokeColors;
		},function(value){
		if (this._strokeColors !=value){
			this._strokeColors=value;
			this._setLabelChanged();
		}
	});

	/**
	*@copy laya.ui.Button#labelColors()
	*/
	__getset(0,__proto,'labelColors',function(){
		return this._labelColors;
		},function(value){
		if (this._labelColors !=value){
			this._labelColors=value;
			this._setLabelChanged();
		}
	});

	/**
	*<p>描边宽度（以像素为单位）。</p>
	*默认值0，表示不描边。
	*@see laya.display.Text.stroke()
	*/
	__getset(0,__proto,'labelStroke',function(){
		return this._labelStroke;
		},function(value){
		if (this._labelStroke !=value){
			this._labelStroke=value;
			this._setLabelChanged();
		}
	});

	/**
	*表示按钮文本标签的字体大小。
	*/
	__getset(0,__proto,'labelSize',function(){
		return this._labelSize;
		},function(value){
		if (this._labelSize !=value){
			this._labelSize=value;
			this._setLabelChanged();
		}
	});

	/**
	*表示按钮的状态值，以数字表示，默认为3态。
	*@see laya.ui.Button#stateNum
	*/
	__getset(0,__proto,'stateNum',function(){
		return this._stateNum;
		},function(value){
		if (this._stateNum !=value){
			this._stateNum=value;
			this._setLabelChanged();
		}
	});

	/**
	*表示按钮文本标签是否为粗体字。
	*/
	__getset(0,__proto,'labelBold',function(){
		return this._labelBold;
		},function(value){
		if (this._labelBold !=value){
			this._labelBold=value;
			this._setLabelChanged();
		}
	});

	/**
	*表示按钮文本标签的字体名称，以字符串形式表示。
	*@see laya.display.Text.font()
	*/
	__getset(0,__proto,'labelFont',function(){
		return this._labelFont;
		},function(value){
		if (this._labelFont !=value){
			this._labelFont=value;
			this._setLabelChanged();
		}
	});

	/**
	*表示按钮文本标签的边距。
	*<p><b>格式：</b>"上边距,右边距,下边距,左边距"。</p>
	*/
	__getset(0,__proto,'labelPadding',function(){
		return this._labelPadding;
		},function(value){
		if (this._labelPadding !=value){
			this._labelPadding=value;
			this._setLabelChanged();
		}
	});

	/**
	*布局方向。
	*<p>默认值为"horizontal"。</p>
	*<p><b>取值：</b>
	*<li>"horizontal"：表示水平布局。</li>
	*<li>"vertical"：表示垂直布局。</li>
	*</p>
	*/
	__getset(0,__proto,'direction',function(){
		return this._direction;
		},function(value){
		this._direction=value;
		this._setLabelChanged();
	});

	/**
	*项对象们之间的间隔（以像素为单位）。
	*/
	__getset(0,__proto,'space',function(){
		return this._space;
		},function(value){
		this._space=value;
		this._setLabelChanged();
	});

	/**
	*项对象们的存放数组。
	*/
	__getset(0,__proto,'items',function(){
		return this._items;
	});

	/**
	*获取或设置当前选择的项对象。
	*/
	__getset(0,__proto,'selection',function(){
		return this._selectedIndex >-1 && this._selectedIndex < this._items.length ? this._items[this._selectedIndex] :null;
		},function(value){
		this.selectedIndex=this._items.indexOf(value);
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if (((typeof value=='number')&& Math.floor(value)==value)|| (typeof value=='string'))this.selectedIndex=parseInt(value);
		else if ((value instanceof Array))this.labels=(value).join(",");
		else Laya.superSet(Box,this,'dataSource',value);
	});

	return UIGroup;
})(Box)


//class huamao.utils.ImageNumber extends laya.ui.Box
var ImageNumber=(function(_super){
	function ImageNumber(_url){
		this.url=null;
		this.imgWidth=0;
		ImageNumber.__super.call(this);
		this.url=_url;
		this.autoSize=true;
	}

	__class(ImageNumber,'huamao.utils.ImageNumber',_super);
	var __proto=ImageNumber.prototype;
	/**
	*@param value
	*@param ww 间距 默认是图片的间距
	*
	*/
	__proto.setValue=function(value,ww){
		(ww===void 0)&& (ww=0);
		this.removeChildren();
		var str=value+"";
		for (var i=0;i < str.length;i++){
			var img=new Image();
			img.skin=this.url+"/"+str.charAt(i)+".png";
			img.x=ww+(img.width+ww)*i;
			this.addChild(img);
		}
	}

	return ImageNumber;
})(Box)


//class map.MovingBox extends laya.ui.Box
var MovingBox=(function(_super){
	function MovingBox(fromX,fromY,toX,toY){
		this.fromx=0;
		this.fromy=0;
		this.tox=0;
		this.toy=0;
		this.effectCount=0;
		this.maxSize=0;
		this.array=new Object();
		MovingBox.__super.call(this);
		this.effectCount=0;
		this.maxSize=0;
		this.fromx=fromX;
		this.fromy=fromY;
		this.tox=toX;
		this.toy=toY;
	}

	__class(MovingBox,'map.MovingBox',_super);
	var __proto=MovingBox.prototype;
	__proto.putCell=function(cell){
		this.addChild(cell);
		this.array[this.effectCount++]=cell;
		this.maxSize=this.effectCount;
	}

	__proto.effectStart=function(){
		this.effectCount=0;
	}

	//Laya.timer.loop(100,this,effectCB);
	__proto.effectEnd=function(){
		Laya.timer.clear(this,this.effectCB);
	}

	__proto.effectCB=function(){
		for(var i=0;i<this.maxSize;i++){
			var cell=this.array [i];
			if(i==this.effectCount){
				cell.setLightSkin();
				}else{
				cell.setNorSkin();
			}
		}
		if(this.effectCount++>=this.maxSize){
			this.effectCount=0;
		}
	}

	__proto.removeSelf=function(){
		this.effectEnd();
		return laya.display.Node.prototype.removeSelf.call(this);
	}

	return MovingBox;
})(Box)


//class map.ArrowCell extends laya.ui.Image
var ArrowCell=(function(_super){
	function ArrowCell(type){
		this.mytype=0;
		ArrowCell.__super.call(this);
		if(type < 3){
			type=1;
		}
		if(type==3){
			type=2;
		}
		this.mytype=type;
		this.setNorSkin();
		this.anchorX=0.5;
		this.anchorY=0.5;
	}

	__class(ArrowCell,'map.ArrowCell',_super);
	var __proto=ArrowCell.prototype;
	__proto.setNorSkin=function(){
		this.skin="comp/G/jian"+this.mytype+".png";
	}

	__proto.setLightSkin=function(){
		this.skin="comp/G/jian"+this.mytype+"_0.png";
	}

	ArrowCell.getOne=function(type){
		return new ArrowCell(type);
	}

	ArrowCell.cellWidth=15;
	ArrowCell.cellHeight=20;
	return ArrowCell;
})(Image)


/**
*
*@author ww
*@version 1.0
*
*@created 2015-10-24 下午2:58:37
*/
//class laya.debug.uicomps.ContextMenu extends laya.ui.Box
var ContextMenu=(function(_super){
	function ContextMenu(){
		this._tY=0;
		ContextMenu.__super.call(this);
		StyleConsts.setViewScale(this);
	}

	__class(ContextMenu,'laya.debug.uicomps.ContextMenu',_super);
	var __proto=ContextMenu.prototype;
	__proto.addItem=function(item){
		this.addChild(item);
		item.y=this._tY;
		this._tY+=item.height;
		item.on("mousedown",this,this.onClick);
	}

	__proto.onClick=function(e){
		this.event("select",e);
		this.removeSelf();
	}

	__proto.show=function(posX,posY){
		(posX===void 0)&& (posX=-999);
		(posY===void 0)&& (posY=-999);
		Laya.timer.once(100,this,ContextMenu.showMenu,[this,posX,posY]);
	}

	ContextMenu.init=function(){
		Laya.stage.on("click",null,ContextMenu.cleanMenu);
	}

	ContextMenu.cleanMenu=function(e){
		var i=0;
		var len=0;
		len=ContextMenu._menuList.length;
		for(i=0;i<len;i++){
			if(ContextMenu._menuList[i]){
				ContextMenu._menuList[i].removeSelf();
			}
		}
		ContextMenu._menuList.length=0;
	}

	ContextMenu.showMenu=function(menu,posX,posY){
		(posX===void 0)&& (posX=-999);
		(posY===void 0)&& (posY=-999);
		ContextMenu.cleanMenu();
		ContextMenu.adptMenu(menu);
		Laya.stage.addChild(menu);
		DisControlTool.showToStage(menu);
		if (posX !=-999 && posY !=-999){
			menu.pos(posX,posY);
		}
		ContextMenu._menuList.push(menu);
	}

	ContextMenu.createMenu=function(__args){
		var args=arguments;
		return ContextMenu.createMenuByArray(args);
	}

	ContextMenu.createMenuByArray=function(args){
		var menu=new ContextMenu();
		var separatorBefore=false;
		var item;
		for (var i=0,n=args.length;i < n;i++){
			var obj=args[i];
			var info={};
			if ((typeof obj=='string')){
				info.label=obj;
				}else {
				info=obj;
			}
			if (info.label !=""){
				item=new ContextMenuItem(info.label,separatorBefore);
				item.data=obj;
				menu.addItem(item);
				separatorBefore=false;
				}else {
				item=new ContextMenuItem("",separatorBefore);
				item.data=obj;
				menu.addItem(item);
				separatorBefore=true;
			}
		}
		menu.zOrder=9999;
		return menu;
	}

	ContextMenu.adptMenu=function(menu){
		var tWidth=80;
		var maxWidth=80;
		var i=0,len=menu.numChildren;
		for (i=0;i < len;i++){
			tWidth=(menu.getChildAt(i)).width;
			if (maxWidth < tWidth){
				maxWidth=tWidth;
			}
		}
		for (i=0;i < len;i++){
			(menu.getChildAt(i)).width=maxWidth;
		}
	}

	ContextMenu._menuList=[];
	return ContextMenu;
})(Box)


/**
*<code>Tree</code> 控件使用户可以查看排列为可扩展树的层次结构数据。
*
*@example
*package
*{
	*import laya.ui.Tree;
	*import laya.utils.Browser;
	*import laya.utils.Handler;
	*public class Tree_Example
	*{
		*public function Tree_Example()
		*{
			*Laya.init(640,800);
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png","resource/ui/clip_selectBox.png","resource/ui/clip_tree_folder.png","resource/ui/clip_tree_arrow.png"],Handler.create(this,onLoadComplete));
			*}
		*private function onLoadComplete():void
		*{
			*var xmlString:String;//创建一个xml字符串，用于存储树结构数据。
			*xmlString="&lt;root&gt;&lt;item label='box1'&gt;&lt;abc label='child1'/&gt;&lt;abc label='child2'/&gt;&lt;abc label='child3'/&gt;&lt;abc label='child4'/&gt;&lt;abc label='child5'/&gt;&lt;/item&gt;&lt;item label='box2'&gt;&lt;abc label='child1'/&gt;&lt;abc label='child2'/&gt;&lt;abc label='child3'/&gt;&lt;abc label='child4'/&gt;&lt;/item&gt;&lt;/root&gt;";
			*var domParser:*=new Browser.window.DOMParser();//创建一个DOMParser实例domParser。
			*var xml:*=domParser.parseFromString(xmlString,"text/xml");//解析xml字符。
			*var tree:Tree=new Tree();//创建一个 Tree 类的实例对象 tree 。
			*tree.scrollBarSkin="resource/ui/vscroll.png";//设置 tree 的皮肤。
			*tree.itemRender=Item;//设置 tree 的项渲染器。
			*tree.xml=xml;//设置 tree 的树结构数据。
			*tree.x=100;//设置 tree 对象的属性 x 的值，用于控制 tree 对象的显示位置。
			*tree.y=100;//设置 tree 对象的属性 y 的值，用于控制 tree 对象的显示位置。
			*tree.width=200;//设置 tree 的宽度。
			*tree.height=100;//设置 tree 的高度。
			*Laya.stage.addChild(tree);//将 tree 添加到显示列表。
			*}
		*}
	*}
*import laya.ui.Box;
*import laya.ui.Clip;
*import laya.ui.Label;
*class Item extends Box
*{
	*public function Item()
	*{
		*this.name="render";
		*this.right=0;
		*this.left=0;
		*var selectBox:Clip=new Clip("resource/ui/clip_selectBox.png",1,2);
		*selectBox.name="selectBox";
		*selectBox.height=24;
		*selectBox.x=13;
		*selectBox.y=0;
		*selectBox.left=12;
		*addChild(selectBox);
		*var folder:Clip=new Clip("resource/ui/clip_tree_folder.png",1,3);
		*folder.name="folder";
		*folder.x=14;
		*folder.y=4;
		*addChild(folder);
		*var label:Label=new Label("treeItem");
		*label.name="label";
		*label.color="#ffff00";
		*label.width=150;
		*label.height=22;
		*label.x=33;
		*label.y=1;
		*label.left=33;
		*label.right=0;
		*addChild(label);
		*var arrow:Clip=new Clip("resource/ui/clip_tree_arrow.png",1,2);
		*arrow.name="arrow";
		*arrow.x=0;
		*arrow.y=5;
		*addChild(arrow);
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高、渲染模式
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*var res=["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png","resource/ui/clip_selectBox.png","resource/ui/clip_tree_folder.png","resource/ui/clip_tree_arrow.png"];
*Laya.loader.load(res,new laya.utils.Handler(this,onLoadComplete));
*function onLoadComplete(){
	*var xmlString;//创建一个xml字符串，用于存储树结构数据。
	*xmlString="&lt;root&gt;&lt;item label='box1'&gt;&lt;abc label='child1'/&gt;&lt;abc label='child2'/&gt;&lt;abc label='child3'/&gt;&lt;abc label='child4'/&gt;&lt;abc label='child5'/&gt;&lt;/item&gt;&lt;item label='box2'&gt;&lt;abc label='child1'/&gt;&lt;abc label='child2'/&gt;&lt;abc label='child3'/&gt;&lt;abc label='child4'/&gt;&lt;/item&gt;&lt;/root&gt;";
	*var domParser=new laya.utils.Browser.window.DOMParser();//创建一个DOMParser实例domParser。
	*var xml=domParser.parseFromString(xmlString,"text/xml");//解析xml字符。
	*var tree=new laya.ui.Tree();//创建一个 Tree 类的实例对象 tree 。
	*tree.scrollBarSkin="resource/ui/vscroll.png";//设置 tree 的皮肤。
	*tree.itemRender=mypackage.treeExample.Item;//设置 tree 的项渲染器。
	*tree.xml=xml;//设置 tree 的树结构数据。
	*tree.x=100;//设置 tree 对象的属性 x 的值，用于控制 tree 对象的显示位置。
	*tree.y=100;//设置 tree 对象的属性 y 的值，用于控制 tree 对象的显示位置。
	*tree.width=200;//设置 tree 的宽度。
	*tree.height=100;//设置 tree 的高度。
	*Laya.stage.addChild(tree);//将 tree 添加到显示列表。
	*}
*(function (_super){
	*function Item(){
		*Item.__super.call(this);//初始化父类。
		*this.right=0;
		*this.left=0;
		*var selectBox=new laya.ui.Clip("resource/ui/clip_selectBox.png",1,2);
		*selectBox.name="selectBox";//设置 selectBox 的name 为“selectBox”时，将被识别为树结构的项的背景。2帧：悬停时背景、选中时背景。
		*selectBox.height=24;
		*selectBox.x=13;
		*selectBox.y=0;
		*selectBox.left=12;
		*this.addChild(selectBox);//需要使用this.访问父类的属性或方法。
		*var folder=new laya.ui.Clip("resource/ui/clip_tree_folder.png",1,3);
		*folder.name="folder";//设置 folder 的name 为“folder”时，将被识别为树结构的文件夹开启状态图表。2帧：折叠状态、打开状态。
		*folder.x=14;
		*folder.y=4;
		*this.addChild(folder);
		*var label=new laya.ui.Label("treeItem");
		*label.name="label";//设置 label 的name 为“label”时，此值将用于树结构数据赋值。
		*label.color="#ffff00";
		*label.width=150;
		*label.height=22;
		*label.x=33;
		*label.y=1;
		*label.left=33;
		*label.right=0;
		*this.addChild(label);
		*var arrow=new laya.ui.Clip("resource/ui/clip_tree_arrow.png",1,2);
		*arrow.name="arrow";//设置 arrow 的name 为“arrow”时，将被识别为树结构的文件夹开启状态图表。2帧：折叠状态、打开状态。
		*arrow.x=0;
		*arrow.y=5;
		*this.addChild(arrow);
		*};
	*Laya.class(Item,"mypackage.treeExample.Item",_super);//注册类 Item 。
	*})(laya.ui.Box);
*@example
*import Tree=laya.ui.Tree;
*import Browser=laya.utils.Browser;
*import Handler=laya.utils.Handler;
*class Tree_Example {
	*constructor(){
		*Laya.init(640,800);
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png","resource/ui/vscroll$up.png","resource/ui/clip_selectBox.png","resource/ui/clip_tree_folder * . * png","resource/ui/clip_tree_arrow.png"],Handler.create(this,this.onLoadComplete));
		*}
	*private onLoadComplete():void {
		*var xmlString:String;//创建一个xml字符串，用于存储树结构数据。
		*xmlString="&lt;root&gt;&lt;item label='box1'&gt;&lt;abc label='child1'/&gt;&lt;abc label='child2'/&gt;&lt;abc label='child3'/&gt;&lt;abc label='child4'/&gt;&lt;abc label='child5'/&gt;&lt;/item&gt;&lt;item label='box2'&gt;&lt;abc  * label='child1'/&gt;&lt;abc label='child2'/&gt;&lt;abc label='child3'/&gt;&lt;abc label='child4'/&gt;&lt;/item&gt;&lt;/root&gt;";
		*var domParser:any=new Browser.window.DOMParser();//创建一个DOMParser实例domParser。
		*var xml:any=domParser.parseFromString(xmlString,"text/xml");//解析xml字符。
		*var tree:Tree=new Tree();//创建一个 Tree 类的实例对象 tree 。
		*tree.scrollBarSkin="resource/ui/vscroll.png";//设置 tree 的皮肤。
		*tree.itemRender=Item;//设置 tree 的项渲染器。
		*tree.xml=xml;//设置 tree 的树结构数据。
		*tree.x=100;//设置 tree 对象的属性 x 的值，用于控制 tree 对象的显示位置。
		*tree.y=100;//设置 tree 对象的属性 y 的值，用于控制 tree 对象的显示位置。
		*tree.width=200;//设置 tree 的宽度。
		*tree.height=100;//设置 tree 的高度。
		*Laya.stage.addChild(tree);//将 tree 添加到显示列表。
		*}
	*}
*import Box=laya.ui.Box;
*import Clip=laya.ui.Clip;
*import Label=laya.ui.Label;
*class Item extends Box {
	*constructor(){
		*super();
		*this.name="render";
		*this.right=0;
		*this.left=0;
		*var selectBox:Clip=new Clip("resource/ui/clip_selectBox.png",1,2);
		*selectBox.name="selectBox";
		*selectBox.height=24;
		*selectBox.x=13;
		*selectBox.y=0;
		*selectBox.left=12;
		*this.addChild(selectBox);
		*var folder:Clip=new Clip("resource/ui/clip_tree_folder.png",1,3);
		*folder.name="folder";
		*folder.x=14;
		*folder.y=4;
		*this.addChild(folder);
		*var label:Label=new Label("treeItem");
		*label.name="label";
		*label.color="#ffff00";
		*label.width=150;
		*label.height=22;
		*label.x=33;
		*label.y=1;
		*label.left=33;
		*label.right=0;
		*this.addChild(label);
		*var arrow:Clip=new Clip("resource/ui/clip_tree_arrow.png",1,2);
		*arrow.name="arrow";
		*arrow.x=0;
		*arrow.y=5;
		*this.addChild(arrow);
		*}
	*}
*/
//class laya.ui.Tree extends laya.ui.Box
var Tree=(function(_super){
	function Tree(){
		/**@private */
		this._list=null;
		/**@private */
		this._source=null;
		/**@private */
		this._renderHandler=null;
		/**@private */
		this._spaceLeft=10;
		/**@private */
		this._spaceBottom=0;
		/**@private */
		this._keepStatus=true;
		Tree.__super.call(this);
		this.width=this.height=200;
	}

	__class(Tree,'laya.ui.Tree',_super);
	var __proto=Tree.prototype;
	Laya.imps(__proto,{"laya.ui.IRender":true})
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		laya.ui.Component.prototype.destroy.call(this,destroyChild);
		this._list && this._list.destroy(destroyChild);
		this._list=null;
		this._source=null;
		this._renderHandler=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._list=new List());
		this._list.renderHandler=Handler.create(this,this.renderItem,null,false);
		this._list.repeatX=1;
		this._list.on("change",this,this.onListChange);
	}

	/**
	*@private
	*此对象包含的<code>List</code>实例的<code>Event.CHANGE</code>事件侦听处理函数。
	*/
	__proto.onListChange=function(e){
		this.event("change");
	}

	/**
	*@private
	*获取数据源集合。
	*/
	__proto.getArray=function(){
		var arr=[];
		var item;
		for(var $each_item in this._source){
			item=this._source[$each_item];
			if (this.getParentOpenStatus(item)){
				item.x=this._spaceLeft *this.getDepth(item);
				arr.push(item);
			}
		}
		return arr;
	}

	/**
	*@private
	*获取项对象的深度。
	*/
	__proto.getDepth=function(item,num){
		(num===void 0)&& (num=0);
		if (item.nodeParent==null)return num;
		else return this.getDepth(item.nodeParent,num+1);
	}

	/**
	*@private
	*获取项对象的上一级的打开状态。
	*/
	__proto.getParentOpenStatus=function(item){
		var parent=item.nodeParent;
		if (parent==null){
			return true;
			}else {
			if (parent.isOpen){
				if (parent.nodeParent !=null)return this.getParentOpenStatus(parent);
				else return true;
				}else {
				return false;
			}
		}
	}

	/**
	*@private
	*渲染一个项对象。
	*@param cell 一个项对象。
	*@param index 项的索引。
	*/
	__proto.renderItem=function(cell,index){
		var item=cell.dataSource;
		if (item){
			cell.left=item.x;
			var arrow=cell.getChildByName("arrow");
			if (arrow){
				if (item.hasChild){
					arrow.visible=true;
					arrow.index=item.isOpen ? 1 :0;
					arrow.tag=index;
					arrow.off("click",this,this.onArrowClick);
					arrow.on("click",this,this.onArrowClick);
					}else {
					arrow.visible=false;
				}
			};
			var folder=cell.getChildByName("folder");
			if (folder){
				if (folder.clipY==2){
					folder.index=item.isDirectory ? 0 :1;
					}else {
					folder.index=item.isDirectory ? item.isOpen ? 1 :0 :2;
				}
			}
			this._renderHandler && this._renderHandler.runWith([cell,index]);
		}
	}

	/**
	*@private
	*/
	__proto.onArrowClick=function(e){
		var arrow=e.currentTarget;
		var index=arrow.tag;
		this._list.array[index].isOpen=!this._list.array[index].isOpen;
		this.event("open");
		this._list.array=this.getArray();
	}

	/**
	*设置指定项索引的项对象的打开状态。
	*@param index 项索引。
	*@param isOpen 是否处于打开状态。
	*/
	__proto.setItemState=function(index,isOpen){
		if (!this._list.array[index])return;
		this._list.array[index].isOpen=isOpen;
		this._list.array=this.getArray();
	}

	/**
	*刷新项列表。
	*/
	__proto.fresh=function(){
		this._list.array=this.getArray();
		this.repaint();
	}

	/**
	*@private
	*解析并处理XML类型的数据源。
	*/
	__proto.parseXml=function(xml,source,nodeParent,isRoot){
		var obj;
		var list=xml.childNodes;
		var childCount=list.length;
		if (!isRoot){
			obj={};
			var list2=xml.attributes;
			var attrs;
			for(var $each_attrs in list2){
				attrs=list2[$each_attrs];
				var prop=attrs.nodeName;
				var value=attrs.nodeValue;
				obj[prop]=value=="true" ? true :value=="false" ? false :value;
			}
			obj.nodeParent=nodeParent;
			if (childCount > 0)obj.isDirectory=true;
			obj.hasChild=childCount > 0;
			source.push(obj);
		}
		for (var i=0;i < childCount;i++){
			var node=list[i];
			this.parseXml(node,source,obj,false);
		}
	}

	/**
	*@private
	*处理数据项的打开状态。
	*/
	__proto.parseOpenStatus=function(oldSource,newSource){
		for (var i=0,n=newSource.length;i < n;i++){
			var newItem=newSource[i];
			if (newItem.isDirectory){
				for (var j=0,m=oldSource.length;j < m;j++){
					var oldItem=oldSource[j];
					if (oldItem.isDirectory && this.isSameParent(oldItem,newItem)&& newItem.label==oldItem.label){
						newItem.isOpen=oldItem.isOpen;
						break ;
					}
				}
			}
		}
	}

	/**
	*@private
	*判断两个项对象在树结构中的父节点是否相同。
	*@param item1 项对象。
	*@param item2 项对象。
	*@return 如果父节点相同值为true，否则值为false。
	*/
	__proto.isSameParent=function(item1,item2){
		if (item1.nodeParent==null && item2.nodeParent==null)return true;
		else if (item1.nodeParent==null || item2.nodeParent==null)return false
		else {
			if (item1.nodeParent.label==item2.nodeParent.label)return this.isSameParent(item1.nodeParent,item2.nodeParent);
			else return false;
		}
	}

	/**
	*更新项列表，显示指定键名的数据项。
	*@param key 键名。
	*/
	__proto.filter=function(key){
		if (Boolean(key)){
			var result=[];
			this.getFilterSource(this._source,result,key);
			this._list.array=result;
			}else {
			this._list.array=this.getArray();
		}
	}

	/**
	*@private
	*获取数据源中指定键名的值。
	*/
	__proto.getFilterSource=function(array,result,key){
		key=key.toLocaleLowerCase();
		var item;
		for(var $each_item in array){
			item=array[$each_item];
			if (!item.isDirectory && String(item.label).toLowerCase().indexOf(key)>-1){
				item.x=0;
				result.push(item);
			}
			if (item.child && item.child.length > 0){
				this.getFilterSource(item.child,result,key);
			}
		}
	}

	/**
	*每一项之间的间隔距离（以像素为单位）。
	*/
	__getset(0,__proto,'spaceBottom',function(){
		return this._list.spaceY;
		},function(value){
		this._list.spaceY=value;
	});

	/**
	*数据源发生变化后，是否保持之前打开状态，默认为true。
	*<p><b>取值：</b>
	*<li>true：保持之前打开状态。</li>
	*<li>false：不保持之前打开状态。</li>
	*</p>
	*/
	__getset(0,__proto,'keepStatus',function(){
		return this._keepStatus;
		},function(value){
		this._keepStatus=value;
	});

	/**
	*此对象包含的<code>List</code>实例的单元格渲染器。
	*<p><b>取值：</b>
	*<ol>
	*<li>单元格类对象。</li>
	*<li> UI 的 JSON 描述。</li>
	*</ol></p>
	*/
	__getset(0,__proto,'itemRender',function(){
		return this._list.itemRender;
		},function(value){
		this._list.itemRender=value;
	});

	/**
	*列表数据源，只包含当前可视节点数据。
	*/
	__getset(0,__proto,'array',function(){
		return this._list.array;
		},function(value){
		if (this._keepStatus && this._list.array && value){
			this.parseOpenStatus(this._list.array,value);
		}
		this._source=value;
		this._list.array=this.getArray();
	});

	/**
	*单元格鼠标事件处理器。
	*<p>默认返回参数（e:Event,index:int）。</p>
	*/
	__getset(0,__proto,'mouseHandler',function(){
		return this._list.mouseHandler;
		},function(value){
		this._list.mouseHandler=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		Laya.superSet(Box,this,'dataSource',value);
	});

	/**
	*数据源，全部节点数据。
	*/
	__getset(0,__proto,'source',function(){
		return this._source;
	});

	/**滚动条*/
	__getset(0,__proto,'scrollBar',function(){
		return this._list.scrollBar;
	});

	/**
	*此对象包含的<code>List</code>实例对象。
	*/
	__getset(0,__proto,'list',function(){
		return this._list;
	});

	/**
	*滚动条皮肤。
	*/
	__getset(0,__proto,'scrollBarSkin',function(){
		return this._list.vScrollBarSkin;
		},function(value){
		this._list.vScrollBarSkin=value;
	});

	/**
	*<code>Tree</code> 实例的渲染处理器。
	*/
	__getset(0,__proto,'renderHandler',function(){
		return this._renderHandler;
		},function(value){
		this._renderHandler=value;
	});

	/**
	*表示当前选择的项索引。
	*/
	__getset(0,__proto,'selectedIndex',function(){
		return this._list.selectedIndex;
		},function(value){
		this._list.selectedIndex=value;
	});

	/**
	*左侧缩进距离（以像素为单位）。
	*/
	__getset(0,__proto,'spaceLeft',function(){
		return this._spaceLeft;
		},function(value){
		this._spaceLeft=value;
	});

	/**
	*当前选中的项对象的数据源。
	*/
	__getset(0,__proto,'selectedItem',function(){
		return this._list.selectedItem;
		},function(value){
		this._list.selectedItem=value;
	});

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Box,this,'width',value);
		this._list.width=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Box,this,'height',value);
		this._list.height=value;
	});

	/**
	*xml结构的数据源。
	*/
	__getset(0,__proto,'xml',null,function(value){
		var arr=[];
		this.parseXml(value.childNodes[0],arr,null,true);
		this.array=arr;
	});

	/**
	*表示选择的树节点项的<code>path</code>属性值。
	*/
	__getset(0,__proto,'selectedPath',function(){
		if (this._list.selectedItem){
			return this._list.selectedItem.path;
		}
		return null;
	});

	return Tree;
})(Box)


/**
*<code>LayoutBox</code> 是一个布局容器类。
*/
//class laya.ui.LayoutBox extends laya.ui.Box
var LayoutBox=(function(_super){
	function LayoutBox(){
		/**@private */
		this._space=0;
		/**@private */
		this._align="none";
		/**@private */
		this._itemChanged=false;
		LayoutBox.__super.call(this);
	}

	__class(LayoutBox,'laya.ui.LayoutBox',_super);
	var __proto=LayoutBox.prototype;
	/**@inheritDoc */
	__proto.addChild=function(child){
		child.on("resize",this,this.onResize);
		this._setItemChanged();
		return laya.display.Node.prototype.addChild.call(this,child);
	}

	__proto.onResize=function(e){
		this._setItemChanged();
	}

	/**@inheritDoc */
	__proto.addChildAt=function(child,index){
		child.on("resize",this,this.onResize);
		this._setItemChanged();
		return laya.display.Node.prototype.addChildAt.call(this,child,index);
	}

	/**@inheritDoc */
	__proto.removeChild=function(child){
		child.off("resize",this,this.onResize);
		this._setItemChanged();
		return laya.display.Node.prototype.removeChild.call(this,child);
	}

	/**@inheritDoc */
	__proto.removeChildAt=function(index){
		this.getChildAt(index).off("resize",this,this.onResize);
		this._setItemChanged();
		return laya.display.Node.prototype.removeChildAt.call(this,index);
	}

	/**刷新。*/
	__proto.refresh=function(){
		this._setItemChanged();
	}

	/**
	*改变子对象的布局。
	*/
	__proto.changeItems=function(){
		this._itemChanged=false;
	}

	/**
	*排序项目列表。可通过重写改变默认排序规则。
	*@param items 项目列表。
	*/
	__proto.sortItem=function(items){
		if (items)items.sort(function(a,b){return a.y-b.y;});
	}

	__proto._setItemChanged=function(){
		if (!this._itemChanged){
			this._itemChanged=true;
			this.callLater(this.changeItems);
		}
	}

	/**子对象的间隔。*/
	__getset(0,__proto,'space',function(){
		return this._space;
		},function(value){
		this._space=value;
		this._setItemChanged();
	});

	/**子对象对齐方式。*/
	__getset(0,__proto,'align',function(){
		return this._align;
		},function(value){
		this._align=value;
		this._setItemChanged();
	});

	return LayoutBox;
})(Box)


/**
*<code>Panel</code> 是一个面板容器类。
*/
//class laya.ui.Panel extends laya.ui.Box
var Panel=(function(_super){
	function Panel(){
		/**@private */
		this._content=null;
		/**@private */
		this._vScrollBar=null;
		/**@private */
		this._hScrollBar=null;
		/**@private */
		this._scrollChanged=false;
		Panel.__super.call(this);
		this.width=this.height=100;
	}

	__class(Panel,'laya.ui.Panel',_super);
	var __proto=Panel.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		laya.ui.Component.prototype.destroy.call(this,destroyChild);
		this._content && this._content.destroy(destroyChild);
		this._vScrollBar && this._vScrollBar.destroy(destroyChild);
		this._hScrollBar && this._hScrollBar.destroy(destroyChild);
		this._vScrollBar=null;
		this._hScrollBar=null;
		this._content=null;
	}

	/**@inheritDoc */
	__proto.destroyChildren=function(){
		this._content.destroyChildren();
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		laya.display.Node.prototype.addChild.call(this,this._content=new Box());
	}

	/**@inheritDoc */
	__proto.addChild=function(child){
		child.on("resize",this,this.onResize);
		this._setScrollChanged();
		return this._content.addChild(child);
	}

	/**
	*@private
	*子对象的 <code>Event.RESIZE</code> 事件侦听处理函数。
	*/
	__proto.onResize=function(){
		this._setScrollChanged();
	}

	/**@inheritDoc */
	__proto.addChildAt=function(child,index){
		child.on("resize",this,this.onResize);
		this._setScrollChanged();
		return this._content.addChildAt(child,index);
	}

	/**@inheritDoc */
	__proto.removeChild=function(child){
		child.off("resize",this,this.onResize);
		this._setScrollChanged();
		return this._content.removeChild(child);
	}

	/**@inheritDoc */
	__proto.removeChildAt=function(index){
		this.getChildAt(index).off("resize",this,this.onResize);
		this._setScrollChanged();
		return this._content.removeChildAt(index);
	}

	/**@inheritDoc */
	__proto.removeChildren=function(beginIndex,endIndex){
		(beginIndex===void 0)&& (beginIndex=0);
		(endIndex===void 0)&& (endIndex=0x7fffffff);
		for (var i=this._content.numChildren-1;i >-1;i--){
			this._content.removeChildAt(i);
		}
		this._setScrollChanged();
		return this;
	}

	/**@inheritDoc */
	__proto.getChildAt=function(index){
		return this._content.getChildAt(index);
	}

	/**@inheritDoc */
	__proto.getChildByName=function(name){
		return this._content.getChildByName(name);
	}

	/**@inheritDoc */
	__proto.getChildIndex=function(child){
		return this._content.getChildIndex(child);
	}

	/**@private */
	__proto.changeScroll=function(){
		this._scrollChanged=false;
		var contentW=this.contentWidth || 1;
		var contentH=this.contentHeight || 1;
		var vscroll=this._vScrollBar;
		var hscroll=this._hScrollBar;
		var vShow=vscroll && contentH > this._height;
		var hShow=hscroll && contentW > this._width;
		var showWidth=vShow ? this._width-vscroll.width :this._width;
		var showHeight=hShow ? this._height-hscroll.height :this._height;
		if (vscroll){
			vscroll.x=this._width-vscroll.width;
			vscroll.y=0;
			vscroll.height=this._height-(hShow ? hscroll.height :0);
			vscroll.scrollSize=Math.max(this._height *0.033,1);
			vscroll.thumbPercent=showHeight / contentH;
			vscroll.setScroll(0,contentH-showHeight,vscroll.value);
		}
		if (hscroll){
			hscroll.x=0;
			hscroll.y=this._height-hscroll.height;
			hscroll.width=this._width-(vShow ? vscroll.width :0);
			hscroll.scrollSize=Math.max(this._width *0.033,1);
			hscroll.thumbPercent=showWidth / contentW;
			hscroll.setScroll(0,contentW-showWidth,hscroll.value);
		}
	}

	/**@inheritDoc */
	__proto.changeSize=function(){
		laya.ui.Component.prototype.changeSize.call(this);
		this.setContentSize(this._width,this._height);
	}

	/**
	*@private
	*设置内容的宽度、高度（以像素为单位）。
	*@param width 宽度。
	*@param height 高度。
	*/
	__proto.setContentSize=function(width,height){
		var content=this._content;
		content.width=width;
		content.height=height;
		content.scrollRect || (content.scrollRect=new Rectangle());
		content.scrollRect.setTo(0,0,width,height);
		content.scrollRect=content.scrollRect;
	}

	/**
	*@private
	*滚动条的<code><code>Event.MOUSE_DOWN</code>事件侦听处理函数。</code>事件侦听处理函数。
	*@param scrollBar 滚动条对象。
	*@param e Event 对象。
	*/
	__proto.onScrollBarChange=function(scrollBar){
		var rect=this._content.scrollRect;
		if (rect){
			var start=Math.round(scrollBar.value);
			scrollBar.isVertical ? rect.y=start :rect.x=start;
			this._content.scrollRect=rect;
		}
	}

	/**
	*<p>滚动内容容器至设定的垂直、水平方向滚动条位置。</p>
	*@param x 水平方向滚动条属性value值。滚动条位置数字。
	*@param y 垂直方向滚动条属性value值。滚动条位置数字。
	*/
	__proto.scrollTo=function(x,y){
		(x===void 0)&& (x=0);
		(y===void 0)&& (y=0);
		if (this.vScrollBar)this.vScrollBar.value=y;
		if (this.hScrollBar)this.hScrollBar.value=x;
	}

	/**
	*刷新滚动内容。
	*/
	__proto.refresh=function(){
		this.changeScroll();
	}

	__proto.onScrollStart=function(){
		this._$P.cacheAs || (this._$P.cacheAs=Laya.superGet(Box,this,'cacheAs'));
		Laya.superSet(Box,this,'cacheAs',"none");
		this._hScrollBar && this._hScrollBar.once("end",this,this.onScrollEnd);
		this._vScrollBar && this._vScrollBar.once("end",this,this.onScrollEnd);
	}

	__proto.onScrollEnd=function(){
		Laya.superSet(Box,this,'cacheAs',this._$P.cacheAs);
	}

	/**@private */
	__proto._setScrollChanged=function(){
		if (!this._scrollChanged){
			this._scrollChanged=true;
			this.callLater(this.changeScroll);
		}
	}

	/**@inheritDoc */
	__getset(0,__proto,'numChildren',function(){
		return this._content.numChildren;
	});

	/**
	*水平方向滚动条皮肤。
	*/
	__getset(0,__proto,'hScrollBarSkin',function(){
		return this._hScrollBar ? this._hScrollBar.skin :null;
		},function(value){
		if (this._hScrollBar==null){
			laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new HScrollBar());
			this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]);
			this._hScrollBar.target=this._content;
			this._setScrollChanged();
		}
		this._hScrollBar.skin=value;
	});

	/**
	*@private
	*获取内容宽度（以像素为单位）。
	*/
	__getset(0,__proto,'contentWidth',function(){
		var max=0;
		for (var i=this._content.numChildren-1;i >-1;i--){
			var comp=this._content.getChildAt(i);
			max=Math.max(comp.x+comp.width *comp.scaleX,max);
		}
		return max;
	});

	/**
	*@private
	*获取内容高度（以像素为单位）。
	*/
	__getset(0,__proto,'contentHeight',function(){
		var max=0;
		for (var i=this._content.numChildren-1;i >-1;i--){
			var comp=this._content.getChildAt(i);
			max=Math.max(comp.y+comp.height *comp.scaleY,max);
		}
		return max;
	});

	/**
	*@inheritDoc
	*/
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Box,this,'width',value);
		this._setScrollChanged();
	});

	/**
	*水平方向滚动条对象。
	*/
	__getset(0,__proto,'hScrollBar',function(){
		return this._hScrollBar;
	});

	/**
	*获取内容容器对象。
	*/
	__getset(0,__proto,'content',function(){
		return this._content;
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Box,this,'height',value);
		this._setScrollChanged();
	});

	/**
	*垂直方向滚动条皮肤。
	*/
	__getset(0,__proto,'vScrollBarSkin',function(){
		return this._vScrollBar ? this._vScrollBar.skin :null;
		},function(value){
		if (this._vScrollBar==null){
			laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new VScrollBar());
			this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]);
			this._vScrollBar.target=this._content;
			this._setScrollChanged();
		}
		this._vScrollBar.skin=value;
	});

	/**
	*垂直方向滚动条对象。
	*/
	__getset(0,__proto,'vScrollBar',function(){
		return this._vScrollBar;
	});

	/**@inheritDoc */
	__getset(0,__proto,'cacheAs',_super.prototype._$get_cacheAs,function(value){
		Laya.superSet(Box,this,'cacheAs',value);
		this._$P.cacheAs=null;
		if (value!=="none"){
			this._hScrollBar && this._hScrollBar.on("start",this,this.onScrollStart);
			this._vScrollBar && this._vScrollBar.on("start",this,this.onScrollStart);
			}else {
			this._hScrollBar && this._hScrollBar.off("start",this,this.onScrollStart);
			this._vScrollBar && this._vScrollBar.off("start",this,this.onScrollStart);
		}
	});

	return Panel;
})(Box)


/**
*<code>ViewStack</code> 类用于视图堆栈类，用于视图的显示等设置处理。
*/
//class laya.ui.ViewStack extends laya.ui.Box
var ViewStack=(function(_super){
	function ViewStack(){
		/**@private */
		this._items=null;
		/**@private */
		this._selectedIndex=0;
		ViewStack.__super.call(this);
		this._setIndexHandler=Handler.create(this,this.setIndex,null,false);
	}

	__class(ViewStack,'laya.ui.ViewStack',_super);
	var __proto=ViewStack.prototype;
	Laya.imps(__proto,{"laya.ui.IItem":true})
	/**
	*批量设置视图对象。
	*@param views 视图对象数组。
	*/
	__proto.setItems=function(views){
		this.removeChildren();
		var index=0;
		for (var i=0,n=views.length;i < n;i++){
			var item=views[i];
			if (item){
				item.name="item"+index;
				this.addChild(item);
				index++;
			}
		}
		this.initItems();
	}

	/**
	*添加视图。
	*@internal 添加视图对象，并设置此视图对象的<code>name</code> 属性。
	*@param view 需要添加的视图对象。
	*/
	__proto.addItem=function(view){
		view.name="item"+this._items.length;
		this.addChild(view);
		this.initItems();
	}

	/**
	*初始化视图对象集合。
	*/
	__proto.initItems=function(){
		this._items=[];
		for (var i=0;i < 10000;i++){
			var item=this.getChildByName("item"+i);
			if (item==null){
				break ;
			}
			this._items.push(item);
			item.visible=(i==this._selectedIndex);
		}
	}

	/**
	*@private
	*通过对象的索引设置项对象的 <code>selected</code> 属性值。
	*@param index 需要设置的对象的索引。
	*@param selected 表示对象的选中状态。
	*/
	__proto.setSelect=function(index,selected){
		if (this._items && index >-1 && index < this._items.length){
			this._items[index].visible=selected;
		}
	}

	/**
	*@private
	*设置属性<code>selectedIndex</code>的值。
	*@param index 选中项索引值。
	*/
	__proto.setIndex=function(index){
		this.selectedIndex=index;
	}

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if (((typeof value=='number')&& Math.floor(value)==value)|| (typeof value=='string')){
			this.selectedIndex=parseInt(value);
			}else {
			for (var prop in this._dataSource){
				if (this.hasOwnProperty(prop)){
					this[prop]=this._dataSource[prop];
				}
			}
		}
	});

	/**
	*表示当前视图索引。
	*/
	__getset(0,__proto,'selectedIndex',function(){
		return this._selectedIndex;
		},function(value){
		if (this._selectedIndex !=value){
			this.setSelect(this._selectedIndex,false);
			this._selectedIndex=value;
			this.setSelect(this._selectedIndex,true);
		}
	});

	/**
	*获取或设置当前选择的项对象。
	*/
	__getset(0,__proto,'selection',function(){
		return this._selectedIndex >-1 && this._selectedIndex < this._items.length ? this._items[this._selectedIndex] :null;
		},function(value){
		this.selectedIndex=this._items.indexOf(value);
	});

	/**
	*视图集合数组。
	*/
	__getset(0,__proto,'items',function(){
		return this._items;
	});

	/**
	*索引设置处理器。
	*<p>默认回调参数：index:int</p>
	*/
	__getset(0,__proto,'setIndexHandler',function(){
		return this._setIndexHandler;
		},function(value){
		this._setIndexHandler=value;
	});

	return ViewStack;
})(Box)


/**
*字体切片，简化版的位图字体，只需设置一个切片图片和文字内容即可使用，效果同位图字体
*使用方式：设置位图字体皮肤skin，设置皮肤对应的字体内容sheet（如果多行，可以使用空格换行），示例：
*fontClip.skin="font1.png";//设置皮肤
*fontClip.sheet="abc123 456";//设置皮肤对应的内容，空格换行。此皮肤为2行5列（显示时skin会被等分为2行5列），第一行对应的文字为"abc123"，第二行为"456"
*fontClip.value="a1326";//显示"a1326"文字
*/
//class laya.ui.FontClip extends laya.ui.Clip
var FontClip=(function(_super){
	function FontClip(skin,sheet){
		/**数值*/
		this._valueArr=null;
		/**文字内容数组**/
		this._indexMap=null;
		/**位图字体内容**/
		this._sheet=null;
		/**@private */
		this._direction="horizontal";
		/**X方向间隙*/
		this._spaceX=0;
		/**Y方向间隙*/
		this._spaceY=0;
		/**@private 水平对齐方式*/
		this._align="left";
		/**@private 显示文字宽*/
		this._wordsW=0;
		/**@private 显示文字高*/
		this._wordsH=0;
		FontClip.__super.call(this);
		if (skin)this.skin=skin;
		if (sheet)this.sheet=sheet;
	}

	__class(FontClip,'laya.ui.FontClip',_super);
	var __proto=FontClip.prototype;
	__proto.createChildren=function(){
		this._bitmap=new AutoBitmap();
		this.on("loaded",this,this._onClipLoaded);
	}

	/**
	*资源加载完毕
	*/
	__proto._onClipLoaded=function(){
		this.callLater(this.changeValue);
	}

	/**渲染数值*/
	__proto.changeValue=function(){
		if (!this._sources)return;
		if (!this._valueArr)return;
		this.graphics.clear(true);
		var texture;
		texture=this._sources[0];
		if (!texture)return;
		var isHorizontal=(this._direction==="horizontal");
		if (isHorizontal){
			this._wordsW=this._valueArr.length *(texture.sourceWidth+this.spaceX);
			this._wordsH=texture.sourceHeight;
			}else{
			this._wordsW=texture.sourceWidth;
			this._wordsH=(texture.sourceHeight+this.spaceY)*this._valueArr.length;
		};
		var dX=0;
		if (this._width){
			switch(this._align){
				case "center":
					dX=0.5 *(this._width-this._wordsW);
					break ;
				case "right":
					dX=this._width-this._wordsW;
					break ;
				default :
					dX=0;
				}
		}
		for (var i=0,sz=this._valueArr.length;i < sz;i++){
			var index=this._indexMap[this._valueArr.charAt(i)];
			if (!this.sources[index])continue ;
			texture=this.sources[index];
			if (isHorizontal)this.graphics.drawTexture(texture,dX+i *(texture.sourceWidth+this.spaceX),0,texture.sourceWidth,texture.sourceHeight);
			else this.graphics.drawTexture(texture,0+dX,i *(texture.sourceHeight+this.spaceY),texture.sourceWidth,texture.sourceHeight);
		}
		if (!this._width){
			this.resetLayoutX();
			this.callLater(this.changeSize);
		}
		if (!this._height){
			this.resetLayoutY();
			this.callLater(this.changeSize);
		}
	}

	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		this._valueArr=null;
		this._indexMap=null;
		this.graphics.clear(true);
		this.removeSelf();
		this.off("loaded",this,this._onClipLoaded);
		_super.prototype.destroy.call(this,destroyChild);
	}

	/**
	*设置位图字体内容，空格代表换行。比如"abc123 456"，代表第一行对应的文字为"abc123"，第二行为"456"
	*/
	__getset(0,__proto,'sheet',function(){
		return this._sheet;
		},function(value){
		value+="";
		this._sheet=value;
		var arr=value.split(" ");
		this._clipX=String(arr[0]).length;
		this.clipY=arr.length;
		this._indexMap={};
		for (var i=0;i < this._clipY;i++){
			var line=arr[i].split("");
			for (var j=0,n=line.length;j < n;j++){
				this._indexMap[line[j]]=i *this._clipX+j;
			}
		}
	});

	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Clip,this,'height',value);
		this.callLater(this.changeValue);
	});

	/**
	*布局方向。
	*<p>默认值为"horizontal"。</p>
	*<p><b>取值：</b>
	*<li>"horizontal"：表示水平布局。</li>
	*<li>"vertical"：表示垂直布局。</li>
	*</p>
	*/
	__getset(0,__proto,'direction',function(){
		return this._direction;
		},function(value){
		this._direction=value;
		this.callLater(this.changeValue);
	});

	/**
	*设置位图字体的显示内容
	*/
	__getset(0,__proto,'value',function(){
		if (!this._valueArr)return "";
		return this._valueArr;
		},function(value){
		value+="";
		this._valueArr=value;
		this.callLater(this.changeValue);
	});

	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Clip,this,'width',value);
		this.callLater(this.changeValue);
	});

	/**X方向文字间隙*/
	__getset(0,__proto,'spaceX',function(){
		return this._spaceX;
		},function(value){
		this._spaceX=value;
		if (this._direction==="horizontal")this.callLater(this.changeValue);
	});

	/**Y方向文字间隙*/
	__getset(0,__proto,'spaceY',function(){
		return this._spaceY;
		},function(value){
		this._spaceY=value;
		if (!(this._direction==="horizontal"))this.callLater(this.changeValue);
	});

	/**水平对齐方式*/
	__getset(0,__proto,'align',function(){
		return this._align;
		},function(v){
		this._align=v;
		this.callLater(this.changeValue);
	});

	__getset(0,__proto,'measureWidth',function(){
		return this._wordsW;
	});

	__getset(0,__proto,'measureHeight',function(){
		return this._wordsH;
	});

	return FontClip;
})(Clip)


/**
*...
*@author ww
*/
//class laya.debug.uicomps.ContextMenuItem extends laya.ui.Button
var ContextMenuItem=(function(_super){
	function ContextMenuItem(txt,isSeparator){
		this.data=null;
		this.img=null;
		ContextMenuItem.__super.call(this);
		if(!this.img)this.img=new Image();
		if(txt!=""){
			this.label=txt;
			this.name=txt;
			}else{
			this.label="------";
			this.height=5;
			this.mouseEnabled=false;
			this.img.skin=Base64AtlasManager.base64.getAdptUrl("comp/line2.png");
			this.img.sizeGrid="0,2,0,2";
			this.addChild(this.img);
		}
		this.labelColors="#000000,#000000,#000000,#000000";
		this._text.x=10;
		this._text.padding=[-2,0,0,0];
		this._text.align="left";
		this._text.wordWrap=false;
		this._text.typeset();
		this.width=this._text.width+25;
		this.sizeGrid="3,3,3,3";
		this.skin=Base64AtlasManager.base64.getAdptUrl("comp/button1.png");
	}

	__class(ContextMenuItem,'laya.debug.uicomps.ContextMenuItem',_super);
	var __proto=ContextMenuItem.prototype;
	__getset(0,__proto,'width',_super.prototype._$get_width,function(v){
		Laya.superSet(Button,this,'width',v);
		this.img.width=this.width;
		this.img.x=0;
	});

	return ContextMenuItem;
})(Button)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.CacheRankView extends laya.debug.view.nodeInfo.views.UIViewBase
var CacheRankView=(function(_super){
	function CacheRankView(){
		this.view=null;
		CacheRankView.__super.call(this);
	}

	__class(CacheRankView,'laya.debug.view.nodeInfo.views.CacheRankView',_super);
	var __proto=CacheRankView.prototype;
	__proto.createPanel=function(){
		this.view=new Rank();
		this.view.top=this.view.bottom=this.view.left=this.view.right=0;
		this.addChild(this.view);
		NodeMenu.I.setNodeListAction(this.view.itemList);
		this.view.closeBtn.on("click",this,this.close);
		this.view.freshBtn.on("click",this,this.fresh);
		this.view.itemList.scrollBar.hide=true;
		this.view.autoUpdate.on("change",this,this.onAutoUpdateChange);
		this.dis=this;
		this.view.itemList.array=[];
		this.onAutoUpdateChange();
		this.fresh();
	}

	__proto.onRightClick=function(){
		var list;
		list=this.view.itemList;
		if (list.selectedItem){
			var tarNode;
			tarNode=list.selectedItem.path;
			NodeMenu.I.objRightClick(tarNode);
		}
	}

	__proto.onAutoUpdateChange=function(){
		this.autoUpdate=this.view.autoUpdate.selected;
	}

	__proto.fresh=function(){
		CacheAnalyser.counter.updates();
		this.view.title.text="ReCache排行";
		if (!DebugTool.enableCacheAnalyse){
			this.view.title.text="ReCache排行(未开启)";
			this.view.title.toolTip="DebugTool.init(true)可开启该功能";
		};
		var nodeDic;
		nodeDic=CacheAnalyser.counter.resultNodeDic;
		var key;
		var tNode;
		var tData;
		var dataList;
		dataList=[];
		for (key in nodeDic){
			tNode=nodeDic[key];
			if (CacheRankView.filterDebugNodes && DisControlTool.isInTree(DebugInfoLayer.I,tNode))continue ;
			if (CacheAnalyser.counter.getCount(tNode)<=0)continue ;
			tData={};
			tData.time=CacheAnalyser.counter.getCount(tNode);
			tData.path=tNode;
			tData.label=ClassTool.getNodeClassAndName(tNode)+":"+tData.time;
			dataList.push(tData);
		}
		dataList.sort(MathTools.sortByKey("time",true,true));
		this.view.itemList.array=dataList;
	}

	__getset(0,__proto,'autoUpdate',null,function(v){
		Laya.timer.clear(this,this.fresh);
		if (v){
			this.fresh();
			Laya.timer.loop(NodeConsts.RenderCostMaxTime,this,this.fresh);
		}
	});

	__getset(1,CacheRankView,'I',function(){
		if (!CacheRankView._I)
			CacheRankView._I=new CacheRankView();
		return CacheRankView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	CacheRankView._I=null;
	CacheRankView.filterDebugNodes=true;
	return CacheRankView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.DebugPanelView extends laya.debug.view.nodeInfo.views.UIViewBase
var DebugPanelView=(function(_super){
	function DebugPanelView(){
		this.view=null;
		this.dragIcon=null;
		this.tSelectTar=null;
		this._selectTip=new Sprite();
		DebugPanelView.__super.call(this);
		this._selectTip.setBounds(new Rectangle(0,0,0,0));
	}

	__class(DebugPanelView,'laya.debug.view.nodeInfo.views.DebugPanelView',_super);
	var __proto=DebugPanelView.prototype;
	__proto.createPanel=function(){
		this.view=new DebugPage();
		this.dis=this.view;
		this.view.minBtn.minHandler=this.minHandler;
		this.view.minBtn.maxHandler=this.maxHandler;
		this.view.minBtn.tar=this.view;
		DisControlTool.setDragingItem(this.view.bg,this.view);
		DisControlTool.setDragingItem(this.view.tab,this.view);
		DisControlTool.setDragingItem(this.view.clearBtn,this.view);
		this.clickSelectChange();
		this.view.selectWhenClick.on("change",this,this.clickSelectChange);
		Notice.listen("ItemClicked",this,this.itemClicked);
		StyleConsts.setViewScale(this.view);
		this.dragIcon=this.view.dragIcon;
		this.dragIcon.removeSelf();
		this.view.mouseAnalyseBtn.on("mousedown",this,this.mouseAnalyserMouseDown);
		this.dragIcon.on("dragend",this,this.mouseAnalyserDragEnd);
		this.view.clearBtn.on("mousedown",this,this.clearBtnClick);
	}

	__proto.clearBtnClick=function(){
		DebugTool.clearDebugLayer();
	}

	__proto.mouseAnalyserMouseDown=function(){
		var gPos=DebugPanelView.tempPos;
		gPos.setTo(0,0);
		gPos=this.view.mouseAnalyseBtn.localToGlobal(gPos);
		this.dragIcon.pos(gPos.x,gPos.y);
		this.dragIcon.mouseEnabled=false;
		Laya.stage.addChild(this.dragIcon);
		this.dragIcon.startDrag();
	}

	__proto.mouseAnalyserDragEnd=function(){
		this.dragIcon.removeSelf();
		this.selectTarget(DisplayHook.instance.getDisUnderMouse());
		NodeToolView.I.showByNode(DisplayHook.instance.getDisUnderMouse(),false);
	}

	//}
	__proto.switchToTree=function(){
		this.view.tab.selectedIndex=0;
	}

	__proto.swichToSelect=function(){
		this.view.tab.selectedIndex=1;
	}

	__proto.itemClicked=function(tar){
		if (!DebugPanelView.isClickSelectState)return;
		if (DebugPanelView.ignoreDebugTool){
			if (DebugInfoLayer.I.isDebugItem(tar))return;
		}
		if ((tar instanceof laya.debug.uicomps.ContextMenuItem )|| (tar.parent instanceof laya.debug.uicomps.ContextMenuItem )){
			return;
		}
		ToolPanel.I.showSelectInStage(tar);
		NodeToolView.I.showByNode(tar,false);
		this.view.selectWhenClick.selected=false;
		DebugTool.showDisBound(tar);
		this.clickSelectChange();
	}

	__proto.selectTarget=function(tar){
		if (!tar)return;
		ToolPanel.I.showSelectInStage(tar);
		DebugTool.showDisBound(tar);
	}

	__proto.clickSelectChange=function(){
		DebugPanelView.isClickSelectState=this.view.selectWhenClick.selected;
		if (!Browser.onPC)return;
		this.tSelectTar=null;
		this.clearSelectTip();
		if (DebugPanelView.isClickSelectState){
			Laya.timer.loop(200,this,this.updateSelectTar,null,true);
			}else{
			Laya.timer.clear(this,this.updateSelectTar);
		}
	}

	__proto.clearSelectTip=function(){
		this._selectTip.removeSelf();
	}

	__proto.updateSelectTar=function(){
		this.clearSelectTip();
		this.tSelectTar=DisplayHook.instance.getDisUnderMouse();
		if (!this.tSelectTar){
			return;
		}
		if (DebugInfoLayer.I.isDebugItem(this.tSelectTar))return;
		var g;
		g=this._selectTip.graphics;
		g.clear();
		var rec;
		rec=NodeUtils.getGRec(this.tSelectTar);
		DebugInfoLayer.I.popLayer.addChild(this._selectTip);
		g.drawRect(0,0,rec.width,rec.height,null,"#00ffff",2);
		this._selectTip.pos(rec.x,rec.y);
	}

	__getset(1,DebugPanelView,'I',function(){
		if (!DebugPanelView._I)DebugPanelView._I=new DebugPanelView();
		return DebugPanelView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	DebugPanelView._I=null;
	DebugPanelView.ignoreDebugTool=true;
	DebugPanelView.isClickSelectState=false;
	__static(DebugPanelView,
	['tempPos',function(){return this.tempPos=new Point();}
	]);
	return DebugPanelView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.FilterView extends laya.debug.view.nodeInfo.views.UIViewBase
var FilterView=(function(_super){
	function FilterView(){
		this.input=null;
		FilterView.__super.call(this);
	}

	__class(FilterView,'laya.debug.view.nodeInfo.views.FilterView',_super);
	var __proto=FilterView.prototype;
	__proto.createPanel=function(){
		this.input=new Input();
		this.input.size(400,500);
		this.input.multiline=true;
		this.input.bgColor="#ff00ff";
		this.input.fontSize=24;
		this.addChild(this.input);
	}

	__proto.show=function(){
		this.input.text=NodeInfosItem.showValues.join("\n");
		_super.prototype.show.call(this);
	}

	__proto.close=function(){
		_super.prototype.close.call(this);
		NodeInfosItem.showValues=this.input.text.split("\n");
	}

	return FilterView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.FindSmallView extends laya.debug.view.nodeInfo.views.UIViewBase
var FindSmallView=(function(_super){
	function FindSmallView(){
		this.view=null;
		FindSmallView.__super.call(this);
	}

	__class(FindSmallView,'laya.debug.view.nodeInfo.views.FindSmallView',_super);
	var __proto=FindSmallView.prototype;
	__proto.createPanel=function(){
		this.view=new FindNodeSmall();
		StyleConsts.setViewScale(this.view);
		DisControlTool.setDragingItem(this.view.bg,this.view);
		this.view.typeSelect.selectedIndex=1;
		this.view.closeBtn.on("click",this,this.close);
		this.view.findBtn.on("click",this,this.onFind);
		this.dis=this.view;
	}

	__proto.onFind=function(){
		var key;
		key=this.view.findTxt.text;
		key=StringTool.trimSide(key);
		var nodeList;
		if (this.view.typeSelect.selectedIndex==0){
			nodeList=DebugTool.findNameHas(key,false);
			}else{
			nodeList=DebugTool.findClassHas(Laya.stage,key);
		}
		ToolPanel.I.showSelectItems(nodeList);
		this.close();
	}

	__getset(1,FindSmallView,'I',function(){
		if (!FindSmallView._I)FindSmallView._I=new FindSmallView();
		return FindSmallView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	FindSmallView._I=null;
	return FindSmallView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.FindView extends laya.debug.view.nodeInfo.views.UIViewBase
var FindView=(function(_super){
	function FindView(){
		this.view=null;
		FindView.__super.call(this);
	}

	__class(FindView,'laya.debug.view.nodeInfo.views.FindView',_super);
	var __proto=FindView.prototype;
	__proto.createPanel=function(){
		this.view=new FindNode();
		DisControlTool.setDragingItem(this.view.bg,this.view);
		this.view.result.scrollBar.hide=true;
		this.view.result.array=[];
		this.view.typeSelect.selectedIndex=1;
		this.view.closeBtn.on("click",this,this.close);
		this.view.findBtn.on("click",this,this.onFind);
		NodeMenu.I.setNodeListAction(this.view.result);
		this.dis=this.view;
	}

	__proto.onRightClick=function(){
		var list;
		list=this.view.result;
		if (list.selectedItem){
			var tarNode;
			tarNode=list.selectedItem.path;
			NodeMenu.I.objRightClick(tarNode);
		}
	}

	//}
	__proto.onFind=function(){
		var key;
		key=this.view.findTxt.text;
		key=StringTool.trimSide(key);
		var nodeList;
		if (this.view.typeSelect.selectedIndex==0){
			nodeList=DebugTool.findNameHas(key,false);
			}else{
			nodeList=DebugTool.findClassHas(Laya.stage,key);
		}
		this.showFindResult(nodeList);
	}

	__proto.showFindResult=function(nodeList){
		if (!nodeList)return;
		var i=0,len=0;
		len=nodeList.length;
		var showList;
		showList=[];
		var tData;
		var tSprite;
		for (i=0;i < len;i++){
			tSprite=nodeList[i];
			tData={};
			tData.label=ClassTool.getNodeClassAndName(tSprite);
			tData.path=tSprite;
			showList.push(tData);
		}
		this.view.result.array=showList;
	}

	__getset(1,FindView,'I',function(){
		if (!FindView._I)FindView._I=new FindView();
		return FindView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	FindView._I=null;
	return FindView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.NodeListPanelView extends laya.debug.view.nodeInfo.views.UIViewBase
var NodeListPanelView=(function(_super){
	function NodeListPanelView(){
		this.view=null;
		NodeListPanelView.__super.call(this);
	}

	__class(NodeListPanelView,'laya.debug.view.nodeInfo.views.NodeListPanelView',_super);
	var __proto=NodeListPanelView.prototype;
	__proto.createPanel=function(){
		this.view=new NodeListPanel();
		this.addChild(this.view);
		DisControlTool.setDragingItem(this.view.bg,this.view);
		NodeMenu.I.setNodeListAction(this.view.itemList);
		this.view.closeBtn.on("click",this,this.close);
		this.view.itemList.scrollBar.hide=true;
		this.dis=this;
		this.view.itemList.array=[];
	}

	//fresh();
	__proto.showList=function(list){
		this.view.itemList.array=list;
		this.show();
	}

	__getset(1,NodeListPanelView,'I',function(){
		if (!NodeListPanelView._I)
			NodeListPanelView._I=new NodeListPanelView();
		return NodeListPanelView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	NodeListPanelView._I=null;
	NodeListPanelView.filterDebugNodes=true;
	return NodeListPanelView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.NodeToolView extends laya.debug.view.nodeInfo.views.UIViewBase
var NodeToolView=(function(_super){
	function NodeToolView(){
		this.view=null;
		this.dragIcon=null;
		this._tar=null;
		NodeToolView.__super.call(this);
	}

	__class(NodeToolView,'laya.debug.view.nodeInfo.views.NodeToolView',_super);
	var __proto=NodeToolView.prototype;
	__proto.show=function(){
		this.showByNode();
	}

	__proto.createPanel=function(){
		this.view=new NodeTool();
		this.addChild(this.view);
		this.view.on("click",this,this.onBtnClick);
		this.view.closeBtn.on("click",this,this.onCloseBtn);
		DisControlTool.setDragingItem(this.view.bg,this.view);
		this.dis=this.view;
		this.view.freshBtn.on("click",this,this.onFreshBtn);
		this.dragIcon=this.view.dragIcon;
		this.dragIcon.removeSelf();
		this.dragIcon.on("dragend",this,this.mouseAnalyserDragEnd);
		this.view.mouseAnalyseBtn.on("mousedown",this,this.mouseAnalyserMouseDown);
	}

	__proto.mouseAnalyserMouseDown=function(){
		var gPos=NodeToolView.tempPos;
		gPos.setTo(0,0);
		gPos=this.view.mouseAnalyseBtn.localToGlobal(gPos);
		this.dragIcon.pos(gPos.x,gPos.y);
		this.dragIcon.mouseEnabled=false;
		Laya.stage.addChild(this.dragIcon);
		this.dragIcon.startDrag();
	}

	__proto.mouseAnalyserDragEnd=function(){
		this.dragIcon.removeSelf();
		if (laya.debug.view.nodeInfo.views.NodeToolView.I.target){
			MouseEventAnalyser.analyseNode(laya.debug.view.nodeInfo.views.NodeToolView.I.target);
		}
	}

	__proto.onFreshBtn=function(){
		if (!this._tar)return;
		this._tar.reCache();
		this._tar.repaint();
	}

	__proto.onCloseBtn=function(){
		this.close();
	}

	__proto.onBtnClick=function(e){
		if (!this._tar)return;
		var tar;
		tar=e.target;
		console.log("onBtnClick:",tar);
		var txt;
		txt=(tar).label;
		switch(txt){
			case "父链":
				DebugTool.showParentChain(this._tar);
				SelectInfosView.I.setSelectList(DebugTool.selectedNodes);
				break ;
			case "子":
				DebugTool.showAllChild(this._tar);
				SelectInfosView.I.setSelectList(DebugTool.selectedNodes);
				break ;
			case "兄弟":
				DebugTool.showAllBrother(this._tar);
				SelectInfosView.I.setSelectList(DebugTool.selectedNodes);
				break ;
			case "Enable链":
				OutPutView.I.dTrace(DebugTool.traceDisMouseEnable(this._tar));
				SelectInfosView.I.setSelectList(DebugTool.selectedNodes);
				break ;
			case "Size链":
				OutPutView.I.dTrace(DebugTool.traceDisSizeChain(this._tar));
				SelectInfosView.I.setSelectList(DebugTool.selectedNodes);
				break ;
			case "隐藏旁支":
				NodeInfoPanel.I.recoverNodes();
				NodeInfoPanel.I.hideOtherChain(this._tar);
				break ;
			case "隐藏兄弟":
				NodeInfoPanel.I.recoverNodes();
				NodeInfoPanel.I.hideBrothers(this._tar);
				break ;
			case "隐藏子":
				NodeInfoPanel.I.recoverNodes();
				NodeInfoPanel.I.hideChilds(this._tar);
				break ;
			case "恢复":
				NodeInfoPanel.I.recoverNodes();
				break ;
			case "节点树定位":
				ToolPanel.I.showSelectInStage(this._tar);
				break ;
			case "显示边框":
				DebugTool.showDisBound(this._tar);
				break ;
			case "输出到控制台":
				console.log(this._tar);
				break ;
			case "显示切换":
				this._tar.visible=!this._tar.visible;
				break ;
			}
	}

	__proto.showByNode=function(node,ifShow){
		(ifShow===void 0)&& (ifShow=true);
		if (!node)node=Laya.stage;
		if(ifShow)
			_super.prototype.show.call(this);
		this._tar=node;
		this.fresh();
	}

	__proto.fresh=function(){
		if (!this._tar)return;
		this.view.tarTxt.text=ClassTool.getNodeClassAndName(this._tar);
	}

	__getset(0,__proto,'target',function(){
		return this._tar;
	});

	__getset(1,NodeToolView,'I',function(){
		if (!NodeToolView._I)NodeToolView._I=new NodeToolView();
		return NodeToolView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	NodeToolView._I=null;
	__static(NodeToolView,
	['tempPos',function(){return this.tempPos=new Point();}
	]);
	return NodeToolView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.NodeTreeSettingView extends laya.debug.view.nodeInfo.views.UIViewBase
var NodeTreeSettingView=(function(_super){
	function NodeTreeSettingView(){
		this.view=null;
		this._handler=null;
		NodeTreeSettingView.__super.call(this);
	}

	__class(NodeTreeSettingView,'laya.debug.view.nodeInfo.views.NodeTreeSettingView',_super);
	var __proto=NodeTreeSettingView.prototype;
	__proto.createPanel=function(){
		_super.prototype.createPanel.call(this);
		this.view=new NodeTreeSetting();
		StyleConsts.setViewScale(this.view);
		this.addChild(this.view);
		this.inits();
		this.dis=this.view;
	}

	__proto.show=function(){
		_super.prototype.show.call(this);
	}

	__proto.showSetting=function(filters,callBack,tar){
		if ((tar instanceof laya.display.Node )){
			this.view.showTxt.text=NodeConsts.defaultFitlerStr.split(",").join("\n");
			}else{
			this.view.showTxt.text=filters.join("\n");
		}
		this._handler=callBack;
		this.show();
	}

	__proto.inits=function(){
		this.view.okBtn.on("click",this,this.onOkBtn);
		this.view.closeBtn.on("click",this,this.onCloseBtn);
		DisControlTool.setDragingItem(this.view.bg,this.view);
		this.dis=this.view;
	}

	__proto.onCloseBtn=function(){
		this.close();
	}

	__proto.onOkBtn=function(){
		this.close();
		var showArr;
		showArr=this.view.showTxt.text.split("\n");
		if (this._handler){
			this._handler.runWith([showArr]);
			this._handler=null
		}
	}

	__getset(1,NodeTreeSettingView,'I',function(){
		if (!NodeTreeSettingView._I)NodeTreeSettingView._I=new NodeTreeSettingView();
		return NodeTreeSettingView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	NodeTreeSettingView._I=null;
	return NodeTreeSettingView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.NodeTreeView extends laya.debug.view.nodeInfo.views.UIViewBase
var NodeTreeView=(function(_super){
	function NodeTreeView(){
		this.nodeTree=null;
		NodeTreeView.__super.call(this);
	}

	__class(NodeTreeView,'laya.debug.view.nodeInfo.views.NodeTreeView',_super);
	var __proto=NodeTreeView.prototype;
	__proto.show=function(){
		this.showByNode();
	}

	__proto.showByNode=function(node){
		if (!node)node=Laya.stage;
		this.nodeTree.setDis(node);
	}

	//super.show();
	__proto.createPanel=function(){
		_super.prototype.createPanel.call(this);
		if (!this.nodeTree)this.nodeTree=new NodeTree();
		this.dis=null;
		var view;
		view=this.nodeTree;
		view.top=view.bottom=view.left=view.right=0;
		this.addChild(view);
		this.showByNode(Laya.stage);
	}

	__proto.showSelectInStage=function(node){
		this.showByNode(Laya.stage);
		this.nodeTree.selectByNode(node);
	}

	return NodeTreeView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.ObjectCreateView extends laya.debug.view.nodeInfo.views.UIViewBase
var ObjectCreateView=(function(_super){
	function ObjectCreateView(){
		this.view=null;
		this._menu=null;
		this._menuItems=["统计详情","增量详情"];
		this._tSelectKey=null;
		this.preInfo={};
		ObjectCreateView.__super.call(this);
		ObjectCreateView._I=this;
	}

	__class(ObjectCreateView,'laya.debug.view.nodeInfo.views.ObjectCreateView',_super);
	var __proto=ObjectCreateView.prototype;
	__proto.createPanel=function(){
		this.view=new ObjectCreate();
		this.view.top=this.view.bottom=this.view.left=this.view.right=0;
		this.addChild(this.view);
		this.view.itemList.on(DebugTool.getMenuShowEvent(),this,this.onRightClick);
		this.view.closeBtn.on("click",this,this.close);
		this.view.freshBtn.on("click",this,this.fresh);
		this.view.itemList.scrollBar.hide=true;
		this._menu=ContextMenu.createMenuByArray(this._menuItems);
		this._menu.on("select",this,this.onEmunSelect);
		this.fresh();
	}

	__proto.onEmunSelect=function(e){
		if (!this._tSelectKey)return;
		var data=(e.target).data;
		if ((typeof data=='string')){
			var key;
			key=data;
			var count;
			switch (key){
				case "统计详情":
					count=RunProfile.getRunInfo(this._tSelectKey);
					if (count){
						OutPutView.I.showTxt(this._tSelectKey+" createInfo:\n"+count.traceSelfR());
					}
					break ;
				case "增量详情":
					count=RunProfile.getRunInfo(this._tSelectKey);
					if (count){
						OutPutView.I.showTxt(this._tSelectKey+" createInfo:\n"+count.traceSelfR(count.changeO));
					}
					break ;
				}
		}
	}

	__proto.onRightClick=function(){
		var list;
		list=this.view.itemList;
		if (list.selectedItem){
			var tarNode;
			tarNode=list.selectedItem.path;
			this._tSelectKey=tarNode;
			if (this._tSelectKey){
				this._menu.show();
			}
		}
	}

	__proto.show=function(){
		this.fresh();
	}

	__proto.fresh=function(){
		var dataO;
		dataO=ClassCreateHook.I.createInfo;
		var key;
		var dataList;
		dataList=[];
		var tData;
		var count;
		for (key in dataO){
			if (!this.preInfo[key])
				this.preInfo[key]=0;
			tData={};
			tData.path=key;
			tData.count=dataO[key];
			tData.add=dataO[key]-this.preInfo[key];
			if (tData.add > 0){
				tData.label=key+":"+dataO[key]+" +"+tData.add;
			}
			else{
				tData.label=key+":"+dataO[key];
			}
			count=RunProfile.getRunInfo(key);
			if (count){
				count.record();
			}
			tData.rank=tData.add *1000+tData.count;
			this.preInfo[key]=dataO[key];
			dataList.push(tData);
		}
		dataList.sort(MathTools.sortByKey("rank",true,true));
		this.view.itemList.array=dataList;
	}

	__getset(1,ObjectCreateView,'I',function(){
		if (!ObjectCreateView._I)
			ObjectCreateView._I=new ObjectCreateView();
		return ObjectCreateView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	ObjectCreateView._I=null;
	return ObjectCreateView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.ObjectInfoView extends laya.debug.view.nodeInfo.views.UIViewBase
var ObjectInfoView=(function(_super){
	function ObjectInfoView(){
		this.view=null;
		this.showKeys=["x","y","width","height","renderCost"];
		this._closeSettingHandler=null;
		this._tar=null;
		ObjectInfoView.__super.call(this);
	}

	__class(ObjectInfoView,'laya.debug.view.nodeInfo.views.ObjectInfoView',_super);
	var __proto=ObjectInfoView.prototype;
	__proto.createPanel=function(){
		_super.prototype.createPanel.call(this);
		this.view=new ObjectInfo();
		StyleConsts.setViewScale(this.view);
		this.addChild(this.view);
		this.inits();
	}

	__proto.inits=function(){
		this.view.closeBtn.on("click",this,this.close);
		this.view.settingBtn.on("click",this,this.onSettingBtn);
		this.view.autoUpdate.on("change",this,this.onAutoUpdateChange);
		DisControlTool.setDragingItem(this.view.bg,this.view);
		DisControlTool.setResizeAbleEx(this.view);
		this._closeSettingHandler=new Handler(this,this.closeSetting);
		this.dis=this.view;
	}

	__proto.onAutoUpdateChange=function(){
		this.autoUpdate=this.view.autoUpdate.selected;
	}

	__proto.onSettingBtn=function(){
		NodeTreeSettingView.I.showSetting(this.showKeys,this._closeSettingHandler,this._tar);
	}

	__proto.reset=function(){
		this.showKeys=["x","y","width","height","renderCost"];
	}

	__proto.closeSetting=function(newKeys){
		this.showKeys=newKeys;
		this.fresh();
	}

	__proto.showObjectInfo=function(obj){
		this._tar=obj;
		this.fresh();
		this.show();
		this.onAutoUpdateChange();
	}

	__proto.fresh=function(){
		if (!this._tar){
			this.view.showTxt.text="";
			this.view.title.text="未选中对象";
		}
		else{
			this.view.title.text=ClassTool.getNodeClassAndName(this._tar);
			this.view.showTxt.text=ObjectInfoView.getObjValueStr(this._tar,this.showKeys,false);
		}
	}

	__proto.freshKeyInfos=function(){
		this.fresh();
	}

	__proto.close=function(){
		_super.prototype.close.call(this);
		this.autoUpdate=false;
		Pool.recover("ObjectInfoView",this);
	}

	__proto.show=function(){
		_super.prototype.show.call(this);
	}

	__getset(0,__proto,'autoUpdate',null,function(v){
		Laya.timer.clear(this,this.freshKeyInfos);
		if (v){
			Laya.timer.loop(2000,this,this.freshKeyInfos);
		}
	});

	ObjectInfoView.getObjValueStr=function(obj,keys,withTitle){
		(withTitle===void 0)&& (withTitle=true);
		var i=0,len=0;
		var tKey;
		ObjectInfoView._txts.length=0;
		len=keys.length;
		if (withTitle){
			if (obj.name){
				ObjectInfoView._txts.push(ClassTool.getClassName(obj)+"("+obj.name+")");
			}
			else{
				ObjectInfoView._txts.push(ClassTool.getClassName(obj));
			}
		}
		for (i=0;i < len;i++){
			tKey=keys[i];
			ObjectInfoView._txts.push(tKey+":"+ObjectInfoView.getNodeValue(obj,tKey));
		}
		return ObjectInfoView._txts.join("\n");
	}

	ObjectInfoView.getNodeValue=function(node,key){
		var rst;
		if ((node instanceof laya.display.Sprite )){
			var tNode;
			tNode=node;
			switch (key){
				case "gRec":
					rst=NodeUtils.getGRec(tNode).toString();
					break ;
				case "gAlpha":
					rst=NodeUtils.getGAlpha(tNode)+"";
					break ;
				case "cmdCount":
					rst=NodeUtils.getNodeCmdCount(tNode)+"";
					break ;
				case "cmdAll":
					rst=NodeUtils.getNodeCmdTotalCount(tNode)+"";
					break ;
				case "nodeAll":
					rst=""+NodeUtils.getNodeCount(tNode);
					break ;
				case "nodeVisible":
					rst=""+NodeUtils.getNodeCount(tNode,true);
					break ;
				case "nodeRender":
					rst=""+NodeUtils.getRenderNodeCount(tNode);
					break ;
				case "nodeReCache":
					rst=""+NodeUtils.getReFreshRenderNodeCount(tNode);
					break ;
				case "renderCost":
					rst=""+RenderAnalyser.I.getTime(tNode);
					break ;
				case "renderCount":
					rst=""+RenderAnalyser.I.getCount(tNode);
					break ;
				default :
					rst=node[key]+"";
				}
		}
		else{
			rst=node[key]+"";
		}
		return rst;
	}

	ObjectInfoView.showObject=function(obj){
		var infoView;
		infoView=Pool.getItemByClass("ObjectInfoView",ObjectInfoView);
		infoView.reset();
		infoView.showObjectInfo(obj);
	}

	ObjectInfoView._txts=[];
	return ObjectInfoView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.OutPutView extends laya.debug.view.nodeInfo.views.UIViewBase
var OutPutView=(function(_super){
	function OutPutView(){
		this.view=null;
		OutPutView.__super.call(this);
		DebugTool._logFun=OutPutView.log;
	}

	__class(OutPutView,'laya.debug.view.nodeInfo.views.OutPutView',_super);
	var __proto=OutPutView.prototype;
	__proto.createPanel=function(){
		this.view=new OutPut();
		DisControlTool.setDragingItem(this.view.txt,this.view);
		DisControlTool.setDragingItem(this.view.bg,this.view);
		StyleConsts.setViewScale(this.view);
		this.view.txt.textField.overflow=Text.SCROLL;
		this.view.txt.textField.wordWrap=true;
		this.view.on("mousewheel",this,this.mouseWheel);
		this.view.txt.text="";
		DisControlTool.setResizeAbleEx(this.view);
		this.view.closeBtn.on("click",this,this.close);
		this.view.clearBtn.on("click",this,this.onClearBtn);
		this.dis=this.view;
	}

	__proto.onClearBtn=function(){
		this.clearText();
	}

	__proto.mouseWheel=function(e){
		this.view.txt.textField.scrollY-=e.delta*10;
	}

	__proto.showTxt=function(str){
		this.view.txt.text=str;
		this.show();
		this.view.txt.textField.scrollY=this.view.txt.textField.maxScrollY;
	}

	__proto.clearText=function(){
		this.view.txt.text="";
	}

	__proto.dTrace=function(__arg){
		var arg=arguments;
		if (this.view.txt.textField.scrollY > 1000){
			this.view.txt.text="";
		};
		var str;
		var i=0,len=0;
		len=arg.length;
		str=arg[0];
		for (i=1;i < len;i++){
			str+=" "+arg[i];
		}
		this.addStr(str);
	}

	__proto.addStr=function(str){
		this.view.txt.text+="\n"+str;
		this.show();
		this.view.txt.textField.scrollY=this.view.txt.textField.maxScrollY;
	}

	__getset(1,OutPutView,'I',function(){
		if (!OutPutView._I)OutPutView._I=new OutPutView();
		return OutPutView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	OutPutView.log=function(str){
		OutPutView.I.addStr(str);
	}

	OutPutView._I=null;
	return OutPutView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.RenderCostRankView extends laya.debug.view.nodeInfo.views.UIViewBase
var RenderCostRankView=(function(_super){
	function RenderCostRankView(){
		this.view=null;
		RenderCostRankView.__super.call(this);
	}

	__class(RenderCostRankView,'laya.debug.view.nodeInfo.views.RenderCostRankView',_super);
	var __proto=RenderCostRankView.prototype;
	__proto.createPanel=function(){
		this.view=new Rank();
		this.view.top=this.view.bottom=this.view.left=this.view.right=0;
		this.addChild(this.view);
		NodeMenu.I.setNodeListAction(this.view.itemList);
		this.view.closeBtn.on("click",this,this.close);
		this.view.freshBtn.on("click",this,this.fresh);
		this.view.itemList.scrollBar.hide=true;
		this.view.autoUpdate.on("change",this,this.onAutoUpdateChange);
		this.dis=this;
		this.view.itemList.array=[];
		this.onAutoUpdateChange();
		this.fresh();
		Laya.timer.once(5000,this,this.fresh);
	}

	__proto.onRightClick=function(){
		var list;
		list=this.view.itemList;
		if (list.selectedItem){
			var tarNode;
			tarNode=list.selectedItem.path;
			NodeMenu.I.objRightClick(tarNode);
		}
	}

	__proto.onAutoUpdateChange=function(){
		this.autoUpdate=this.view.autoUpdate.selected;
	}

	__proto.fresh=function(){
		this.view.title.text="渲染用时排行("+NodeConsts.RenderCostMaxTime+"ms)";
		var nodeDic;
		nodeDic=RenderAnalyser.I.nodeDic;
		var key;
		var tNode;
		var tData;
		var dataList;
		dataList=[];
		for (key in nodeDic){
			tNode=nodeDic[key];
			if (RenderCostRankView.filterDebugNodes && DisControlTool.isInTree(DebugInfoLayer.I,tNode))continue ;
			if (RenderAnalyser.I.getTime(tNode)<=0)continue ;
			tData={};
			tData.time=RenderAnalyser.I.getTime(tNode);
			if (RenderCostRankView.filterDebugNodes && tNode==Laya.stage){
				tData.time-=RenderAnalyser.I.getTime(DebugInfoLayer.I);
			}
			tData.path=tNode;
			tData.label=ClassTool.getNodeClassAndName(tNode)+":"+tData.time;
			dataList.push(tData);
		}
		dataList.sort(MathTools.sortByKey("time",true,true));
		this.view.itemList.array=dataList;
	}

	__getset(0,__proto,'autoUpdate',null,function(v){
		Laya.timer.clear(this,this.fresh);
		if (v){
			this.fresh();
			Laya.timer.loop(NodeConsts.RenderCostMaxTime,this,this.fresh);
		}
	});

	__getset(1,RenderCostRankView,'I',function(){
		if (!RenderCostRankView._I)
			RenderCostRankView._I=new RenderCostRankView();
		return RenderCostRankView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	RenderCostRankView._I=null;
	RenderCostRankView.filterDebugNodes=true;
	return RenderCostRankView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.ResRankView extends laya.debug.view.nodeInfo.views.UIViewBase
var ResRankView=(function(_super){
	function ResRankView(){
		this.view=null;
		ResRankView.__super.call(this);
	}

	__class(ResRankView,'laya.debug.view.nodeInfo.views.ResRankView',_super);
	var __proto=ResRankView.prototype;
	__proto.createPanel=function(){
		this.view=new Rank();
		this.view.top=this.view.bottom=this.view.left=this.view.right=0;
		this.addChild(this.view);
		this.view.closeBtn.on("click",this,this.close);
		this.view.freshBtn.on("click",this,this.fresh);
		this.view.itemList.scrollBar.hide=true;
		this.view.autoUpdate.on("change",this,this.onAutoUpdateChange);
		this.dis=this;
		this.view.itemList.array=[];
		this.view.itemList.on("rightclick",this,this.onRightClick);
		this.onAutoUpdateChange();
		this.fresh();
	}

	__proto.onRightClick=function(){
		var list;
		list=this.view.itemList;
		if (list.selectedItem){
			console.log(list.selectedItem["url"]);
		}
	}

	__proto.onAutoUpdateChange=function(){
		this.autoUpdate=this.view.autoUpdate.selected;
	}

	__proto.fresh=function(){
		this.view.title.text="图片缓存列表";
		var resList;
		resList=ResTools.getCachedResList();
		var key;
		var tNode;
		var tData;
		var dataList;
		dataList=[];
		var i=0,len=0;
		len=resList.length;
		for (i=0;i < len;i++){
			tData={};
			var tUrl;
			tUrl=resList[i];
			tUrl=tUrl.replace(URL.rootPath,"")
			tData.label=tUrl;
			tData.url=tUrl;
			dataList.push(tData);
		}
		this.view.itemList.array=dataList;
	}

	__getset(0,__proto,'autoUpdate',null,function(v){
		Laya.timer.clear(this,this.fresh);
		if (v){
			this.fresh();
			Laya.timer.loop(NodeConsts.RenderCostMaxTime,this,this.fresh);
		}
	});

	__getset(1,ResRankView,'I',function(){
		if (!ResRankView._I)
			ResRankView._I=new ResRankView();
		return ResRankView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	ResRankView._I=null;
	ResRankView.filterDebugNodes=true;
	return ResRankView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.SelectInfosView extends laya.debug.view.nodeInfo.views.UIViewBase
var SelectInfosView=(function(_super){
	function SelectInfosView(){
		this.showKeys=[];
		this.view=null;
		this.fliterTxt=null;
		this.itemList=null;
		SelectInfosView.__super.call(this);
		SelectInfosView._I=this;
		this.setSelectList(null);
	}

	__class(SelectInfosView,'laya.debug.view.nodeInfo.views.SelectInfosView',_super);
	var __proto=SelectInfosView.prototype;
	__proto.createPanel=function(){
		this.view=new SelectInfos();
		this.addChild(this.view);
		this.view.top=this.view.bottom=this.view.left=this.view.right=0;
		NodeMenu.I.setNodeListAction(this.view.selectList);
		this.view.closeBtn.on("click",this,this.close);
		this.view.selectList.scrollBar.hide=true;
		this.dis=null;
		this.view.findBtn.on("click",this,this.onFindBtn);
		this.fliterTxt=this.view.fliterTxt;
		this.view.fliterTxt.on("enter",this,this.onFliterTxtChange);
		this.view.fliterTxt.on("blur",this,this.onFliterTxtChange);
	}

	__proto.onFliterTxtChange=function(e){
		var key;
		key=this.fliterTxt.text;
		if (key==""){
			if (this.showKeys.length !=0){
				this.showKeys.length=0;
				this.fresh();
			}
		}else
		if (key !=this.showKeys.join(",")){
			this.showKeys=key.split(",");
			this.fresh();
		}
	}

	__proto.onFindBtn=function(){
		FindSmallView.I.show();
	}

	__proto.onRightClick=function(){
		var list;
		list=this.view.selectList;
		if (list.selectedItem){
			var tarNode;
			tarNode=list.selectedItem.path;
			NodeMenu.I.objRightClick(tarNode);
		}
	}

	//}
	__proto.setSelectTarget=function(node){
		if (!node)return;
		this.setSelectList([node]);
	}

	__proto.setSelectList=function(list){
		this.itemList=list;
		this.fresh();
	}

	//show();
	__proto.fresh=function(){
		var list;
		list=this.itemList;
		if (!list || list.length < 1){
			this.view.selectList.array=[];
			return;
		};
		var i=0,len=0;
		var tDis;
		var tData;
		len=list.length;
		var disList;
		disList=[];
		for (i=0;i < len;i++){
			tDis=list[i];
			tData={};
			tData.label=this.getLabelTxt(tDis);
			tData.path=tDis;
			disList.push(tData);
		}
		this.view.selectList.array=disList;
	}

	__proto.getLabelTxt=function(item){
		var rst;
		rst=ClassTool.getNodeClassAndName(item);
		var i=0,len=0;
		len=this.showKeys.length;
		for (i=0;i < len;i++){
			rst+=","+ObjectInfoView.getNodeValue(item,this.showKeys[i]);
		}
		return rst;
	}

	__getset(1,SelectInfosView,'I',function(){
		if (!SelectInfosView._I)SelectInfosView._I=new SelectInfosView();
		return SelectInfosView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	SelectInfosView._I=null;
	return SelectInfosView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.ToolBarView extends laya.debug.view.nodeInfo.views.UIViewBase
var ToolBarView=(function(_super){
	function ToolBarView(){
		this.view=null;
		ToolBarView.__super.call(this);
	}

	__class(ToolBarView,'laya.debug.view.nodeInfo.views.ToolBarView',_super);
	var __proto=ToolBarView.prototype;
	__proto.createPanel=function(){
		this.view=new ToolBar();
		this.addChild(this.view);
		DisControlTool.setDragingItem(this.view.bg,this.view);
		this.view.on("click",this,this.onBtnClick);
		this.view.minBtn.minHandler=this.minHandler;
		this.view.minBtn.maxHandler=this.maxHandler;
		this.view.minBtn.tar=this.view;
		this.clickSelectChange();
		this.view.selectWhenClick.on("change",this,this.clickSelectChange);
		Notice.listen("ItemClicked",this,this.itemClicked);
		this.dis=this.view;
	}

	__proto.itemClicked=function(tar){
		if (!ToolBarView.isClickSelectState)return;
		if (DisControlTool.isInTree(this.view.selectWhenClick,tar))return;
		if (ToolBarView.ignoreDebugTool){
			if (DebugInfoLayer.I.isDebugItem(tar))return;
		}
	}

	__proto.clickSelectChange=function(){
		ToolBarView.isClickSelectState=this.view.selectWhenClick.selected;
	}

	__proto.firstShowFun=function(){
		this.dis.x=Laya.stage.width-this.dis.width-20;
		this.dis.y=5;
	}

	__proto.onBtnClick=function(e){
		switch(e.target){
			case this.view.treeBtn:
				ToolPanel.I.switchShow("Tree");
				break ;
			case this.view.findBtn:
				ToolPanel.I.switchShow("Find");
				break ;
			case this.view.clearBtn:
				DebugTool.clearDebugLayer();
				break ;
			case this.view.rankBtn:
				RenderCostRankView.I.show();
				break ;
			case this.view.nodeRankBtn:
				ObjectCreateView.I.show();
				break ;
			case this.view.cacheBtn:
				NodeUtils.showCachedSpriteRecs();
				break ;
			}
	}

	__getset(1,ToolBarView,'I',function(){
		if (!ToolBarView._I)ToolBarView._I=new ToolBarView();
		return ToolBarView._I;
	},laya.debug.view.nodeInfo.views.UIViewBase._$SET_I);

	ToolBarView._I=null;
	ToolBarView.ignoreDebugTool=true;
	ToolBarView.isClickSelectState=false;
	return ToolBarView;
})(UIViewBase)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.views.TxtInfoView extends laya.debug.view.nodeInfo.views.UIViewBase
var TxtInfoView=(function(_super){
	function TxtInfoView(){
		this.input=null;
		this.btn=null;
		TxtInfoView.__super.call(this);
	}

	__class(TxtInfoView,'laya.debug.view.nodeInfo.views.TxtInfoView',_super);
	var __proto=TxtInfoView.prototype;
	__proto.createPanel=function(){
		this.input=new Input();
		this.input.size(200,400);
		this.input.multiline=true;
		this.input.bgColor="#ff00ff";
		this.input.fontSize=12;
		this.input.wordWrap=true;
		this.addChild(this.input);
		this.btn=this.getButton();
		this.btn.text="关闭";
		this.btn.size(50,20);
		this.btn.align="center";
		this.btn.on("mousedown",this,this.onCloseBtn);
		this.btn.pos(5,this.input.height+5);
		this.addChild(this.btn);
	}

	__proto.showInfo=function(txt){
		this.input.text=txt;
		this.show();
	}

	__proto.show=function(){
		DebugInfoLayer.I.setTop();
		DebugInfoLayer.I.popLayer.addChild(this);
		this.x=(Laya.stage.width-this.width);
		this.y=0;
	}

	__proto.onCloseBtn=function(){
		this.close();
	}

	return TxtInfoView;
})(UIViewBase)


/**
*<code>CheckBox</code> 组件显示一个小方框，该方框内可以有选中标记。
*<code>CheckBox</code> 组件还可以显示可选的文本标签，默认该标签位于 CheckBox 右侧。
*<p><code>CheckBox</code> 使用 <code>dataSource</code>赋值时的的默认属性是：<code>selected</code>。</p>
*
*@example <caption>以下示例代码，创建了一个 <code>CheckBox</code> 实例。</caption>
*package
*{
	*import laya.ui.CheckBox;
	*import laya.utils.Handler;
	*public class CheckBox_Example
	*{
		*public function CheckBox_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load("resource/ui/check.png",Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*trace("资源加载完成！");
			*var checkBox:CheckBox=new CheckBox("resource/ui/check.png","这个是一个CheckBox组件。");//创建一个 CheckBox 类的实例对象 checkBox ,传入它的皮肤skin和标签label。
			*checkBox.x=100;//设置 checkBox 对象的属性 x 的值，用于控制 checkBox 对象的显示位置。
			*checkBox.y=100;//设置 checkBox 对象的属性 y 的值，用于控制 checkBox 对象的显示位置。
			*checkBox.clickHandler=new Handler(this,onClick,[checkBox]);//设置 checkBox 的点击事件处理器。
			*Laya.stage.addChild(checkBox);//将此 checkBox 对象添加到显示列表。
			*}
		*private function onClick(checkBox:CheckBox):void
		*{
			*trace("输出选中状态: checkBox.selected = "+checkBox.selected);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*Laya.loader.load("resource/ui/check.png",laya.utils.Handler.create(this,loadComplete));//加载资源
*function loadComplete()
*{
	*console.log("资源加载完成！");
	*var checkBox:laya.ui.CheckBox=new laya.ui.CheckBox("resource/ui/check.png","这个是一个CheckBox组件。");//创建一个 CheckBox 类的类的实例对象 checkBox ,传入它的皮肤skin和标签label。
	*checkBox.x=100;//设置 checkBox 对象的属性 x 的值，用于控制 checkBox 对象的显示位置。
	*checkBox.y=100;//设置 checkBox 对象的属性 y 的值，用于控制 checkBox 对象的显示位置。
	*checkBox.clickHandler=new laya.utils.Handler(this,this.onClick,[checkBox],false);//设置 checkBox 的点击事件处理器。
	*Laya.stage.addChild(checkBox);//将此 checkBox 对象添加到显示列表。
	*}
*function onClick(checkBox)
*{
	*console.log("checkBox.selected = ",checkBox.selected);
	*}
*@example
*import CheckBox=laya.ui.CheckBox;
*import Handler=laya.utils.Handler;
*class CheckBox_Example{
	*constructor()
	*{
		*Laya.init(640,800);
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load("resource/ui/check.png",Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete()
	*{
		*var checkBox:CheckBox=new CheckBox("resource/ui/check.png","这个是一个CheckBox组件。");//创建一个 CheckBox 类的实例对象 checkBox ,传入它的皮肤skin和标签label。
		*checkBox.x=100;//设置 checkBox 对象的属性 x 的值，用于控制 checkBox 对象的显示位置。
		*checkBox.y=100;//设置 checkBox 对象的属性 y 的值，用于控制 checkBox 对象的显示位置。
		*checkBox.clickHandler=new Handler(this,this.onClick,[checkBox]);//设置 checkBox 的点击事件处理器。
		*Laya.stage.addChild(checkBox);//将此 checkBox 对象添加到显示列表。
		*}
	*private onClick(checkBox:CheckBox):void
	*{
		*console.log("输出选中状态: checkBox.selected = "+checkBox.selected);
		*}
	*}
*/
//class laya.ui.CheckBox extends laya.ui.Button
var CheckBox=(function(_super){
	/**
	*创建一个新的 <code>CheckBox</code> 组件实例。
	*@param skin 皮肤资源地址。
	*@param label 文本标签的内容。
	*/
	function CheckBox(skin,label){
		(label===void 0)&& (label="");
		CheckBox.__super.call(this,skin,label);
	}

	__class(CheckBox,'laya.ui.CheckBox',_super);
	var __proto=CheckBox.prototype;
	/**@inheritDoc */
	__proto.preinitialize=function(){
		laya.ui.Component.prototype.preinitialize.call(this);
		this.toggle=true;
		this._autoSize=false;
	}

	/**@inheritDoc */
	__proto.initialize=function(){
		_super.prototype.initialize.call(this);
		this.createText();
		this._text.align="left";
		this._text.valign="top";
		this._text.width=0;
	}

	/**@inheritDoc */
	__getset(0,__proto,'dataSource',_super.prototype._$get_dataSource,function(value){
		this._dataSource=value;
		if ((typeof value=='boolean'))this.selected=value;
		else if ((typeof value=='string'))this.selected=value==="true";
		else Laya.superSet(Button,this,'dataSource',value);
	});

	return CheckBox;
})(Button)


/**
*<code>Radio</code> 控件使用户可在一组互相排斥的选择中做出一种选择。
*用户一次只能选择 <code>Radio</code> 组中的一个成员。选择未选中的组成员将取消选择该组中当前所选的 <code>Radio</code> 控件。
*@see laya.ui.RadioGroup
*/
//class laya.ui.Radio extends laya.ui.Button
var Radio=(function(_super){
	function Radio(skin,label){
		/**@private */
		this._value=null;
		(label===void 0)&& (label="");
		Radio.__super.call(this,skin,label);
	}

	__class(Radio,'laya.ui.Radio',_super);
	var __proto=Radio.prototype;
	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._value=null;
	}

	/**@inheritDoc */
	__proto.preinitialize=function(){
		laya.ui.Component.prototype.preinitialize.call(this);
		this.toggle=false;
		this._autoSize=false;
	}

	/**@inheritDoc */
	__proto.initialize=function(){
		_super.prototype.initialize.call(this);
		this.createText();
		this._text.align="left";
		this._text.valign="top";
		this._text.width=0;
		this.on("click",this,this.onClick);
	}

	/**
	*@private
	*对象的<code>Event.CLICK</code>事件侦听处理函数。
	*/
	__proto.onClick=function(e){
		this.selected=true;
	}

	/**
	*获取或设置 <code>Radio</code> 关联的可选用户定义值。
	*/
	__getset(0,__proto,'value',function(){
		return this._value !=null ? this._value :this.label;
		},function(obj){
		this._value=obj;
	});

	return Radio;
})(Button)


/**
*使用 <code>HScrollBar</code> （水平 <code>ScrollBar</code> ）控件，可以在因数据太多而不能在显示区域完全显示时控制显示的数据部分。
*@example <caption>以下示例代码，创建了一个 <code>HScrollBar</code> 实例。</caption>
*package
*{
	*import laya.ui.HScrollBar;
	*import laya.utils.Handler;
	*public class HScrollBar_Example
	*{
		*private var hScrollBar:HScrollBar;
		*public function HScrollBar_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/hscroll.png","resource/ui/hscroll$bar.png","resource/ui/hscroll$down.png","resource/ui/hscroll$up.png"],Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*hScrollBar=new HScrollBar();//创建一个 HScrollBar 类的实例对象 hScrollBar 。
			*hScrollBar.skin="resource/ui/hscroll.png";//设置 hScrollBar 的皮肤。
			*hScrollBar.x=100;//设置 hScrollBar 对象的属性 x 的值，用于控制 hScrollBar 对象的显示位置。
			*hScrollBar.y=100;//设置 hScrollBar 对象的属性 y 的值，用于控制 hScrollBar 对象的显示位置。
			*hScrollBar.changeHandler=new Handler(this,onChange);//设置 hScrollBar 的滚动变化处理器。
			*Laya.stage.addChild(hScrollBar);//将此 hScrollBar 对象添加到显示列表。
			*}
		*private function onChange(value:Number):void
		*{
			*trace("滚动条的位置： value="+value);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*var hScrollBar;
*var res=["resource/ui/hscroll.png","resource/ui/hscroll$bar.png","resource/ui/hscroll$down.png","resource/ui/hscroll$up.png"];
*Laya.loader.load(res,laya.utils.Handler.create(this,onLoadComplete));//加载资源。
*function onLoadComplete(){
	*console.log("资源加载完成！");
	*hScrollBar=new laya.ui.HScrollBar();//创建一个 HScrollBar 类的实例对象 hScrollBar 。
	*hScrollBar.skin="resource/ui/hscroll.png";//设置 hScrollBar 的皮肤。
	*hScrollBar.x=100;//设置 hScrollBar 对象的属性 x 的值，用于控制 hScrollBar 对象的显示位置。
	*hScrollBar.y=100;//设置 hScrollBar 对象的属性 y 的值，用于控制 hScrollBar 对象的显示位置。
	*hScrollBar.changeHandler=new laya.utils.Handler(this,onChange);//设置 hScrollBar 的滚动变化处理器。
	*Laya.stage.addChild(hScrollBar);//将此 hScrollBar 对象添加到显示列表。
	*}
*function onChange(value)
*{
	*console.log("滚动条的位置： value="+value);
	*}
*@example
*import HScrollBar=laya.ui.HScrollBar;
*import Handler=laya.utils.Handler;
*class HScrollBar_Example {
	*private hScrollBar:HScrollBar;
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/hscroll.png","resource/ui/hscroll$bar.png","resource/ui/hscroll$down.png","resource/ui/hscroll$up.png"],Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*this.hScrollBar=new HScrollBar();//创建一个 HScrollBar 类的实例对象 hScrollBar 。
		*this.hScrollBar.skin="resource/ui/hscroll.png";//设置 hScrollBar 的皮肤。
		*this.hScrollBar.x=100;//设置 hScrollBar 对象的属性 x 的值，用于控制 hScrollBar 对象的显示位置。
		*this.hScrollBar.y=100;//设置 hScrollBar 对象的属性 y 的值，用于控制 hScrollBar 对象的显示位置。
		*this.hScrollBar.changeHandler=new Handler(this,this.onChange);//设置 hScrollBar 的滚动变化处理器。
		*Laya.stage.addChild(this.hScrollBar);//将此 hScrollBar 对象添加到显示列表。
		*}
	*private onChange(value:number):void {
		*console.log("滚动条的位置： value="+value);
		*}
	*}
*/
//class laya.ui.HScrollBar extends laya.ui.ScrollBar
var HScrollBar=(function(_super){
	function HScrollBar(){
		HScrollBar.__super.call(this);;
	}

	__class(HScrollBar,'laya.ui.HScrollBar',_super);
	var __proto=HScrollBar.prototype;
	/**@inheritDoc */
	__proto.initialize=function(){
		_super.prototype.initialize.call(this);
		this.slider.isVertical=false;
	}

	return HScrollBar;
})(ScrollBar)


/**
*使用 <code>HSlider</code> 控件，用户可以通过在滑块轨道的终点之间移动滑块来选择值。
*<p> <code>HSlider</code> 控件采用水平方向。滑块轨道从左向右扩展，而标签位于轨道的顶部或底部。</p>
*
*@example <caption>以下示例代码，创建了一个 <code>HSlider</code> 实例。</caption>
*package
*{
	*import laya.ui.HSlider;
	*import laya.utils.Handler;
	*public class HSlider_Example
	*{
		*private var hSlider:HSlider;
		*public function HSlider_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/hslider.png","resource/ui/hslider$bar.png"],Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*hSlider=new HSlider();//创建一个 HSlider 类的实例对象 hSlider 。
			*hSlider.skin="resource/ui/hslider.png";//设置 hSlider 的皮肤。
			*hSlider.min=0;//设置 hSlider 最低位置值。
			*hSlider.max=10;//设置 hSlider 最高位置值。
			*hSlider.value=2;//设置 hSlider 当前位置值。
			*hSlider.tick=1;//设置 hSlider 刻度值。
			*hSlider.x=100;//设置 hSlider 对象的属性 x 的值，用于控制 hSlider 对象的显示位置。
			*hSlider.y=100;//设置 hSlider 对象的属性 y 的值，用于控制 hSlider 对象的显示位置。
			*hSlider.changeHandler=new Handler(this,onChange);//设置 hSlider 位置变化处理器。
			*Laya.stage.addChild(hSlider);//把 hSlider 添加到显示列表。
			*}
		*private function onChange(value:Number):void
		*{
			*trace("滑块的位置： value="+value);
			*}
		*}
	*}
*@example
*Laya.init(640,800,"canvas");//设置游戏画布宽高、渲染模式
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*var hSlider;
*var res=["resource/ui/hslider.png","resource/ui/hslider$bar.png"];
*Laya.loader.load(res,laya.utils.Handler.create(this,onLoadComplete));
*function onLoadComplete(){
	*console.log("资源加载完成！");
	*hSlider=new laya.ui.HSlider();//创建一个 HSlider 类的实例对象 hSlider 。
	*hSlider.skin="resource/ui/hslider.png";//设置 hSlider 的皮肤。
	*hSlider.min=0;//设置 hSlider 最低位置值。
	*hSlider.max=10;//设置 hSlider 最高位置值。
	*hSlider.value=2;//设置 hSlider 当前位置值。
	*hSlider.tick=1;//设置 hSlider 刻度值。
	*hSlider.x=100;//设置 hSlider 对象的属性 x 的值，用于控制 hSlider 对象的显示位置。
	*hSlider.y=100;//设置 hSlider 对象的属性 y 的值，用于控制 hSlider 对象的显示位置。
	*hSlider.changeHandler=new laya.utils.Handler(this,onChange);//设置 hSlider 位置变化处理器。
	*Laya.stage.addChild(hSlider);//把 hSlider 添加到显示列表。
	*}
*function onChange(value)
*{
	*console.log("滑块的位置： value="+value);
	*}
*@example
*import Handler=laya.utils.Handler;
*import HSlider=laya.ui.HSlider;
*class HSlider_Example {
	*private hSlider:HSlider;
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/hslider.png","resource/ui/hslider$bar.png"],Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*this.hSlider=new HSlider();//创建一个 HSlider 类的实例对象 hSlider 。
		*this.hSlider.skin="resource/ui/hslider.png";//设置 hSlider 的皮肤。
		*this.hSlider.min=0;//设置 hSlider 最低位置值。
		*this.hSlider.max=10;//设置 hSlider 最高位置值。
		*this.hSlider.value=2;//设置 hSlider 当前位置值。
		*this.hSlider.tick=1;//设置 hSlider 刻度值。
		*this.hSlider.x=100;//设置 hSlider 对象的属性 x 的值，用于控制 hSlider 对象的显示位置。
		*this.hSlider.y=100;//设置 hSlider 对象的属性 y 的值，用于控制 hSlider 对象的显示位置。
		*this.hSlider.changeHandler=new Handler(this,this.onChange);//设置 hSlider 位置变化处理器。
		*Laya.stage.addChild(this.hSlider);//把 hSlider 添加到显示列表。
		*}
	*private onChange(value:number):void {
		*console.log("滑块的位置： value="+value);
		*}
	*}
*
*@see laya.ui.Slider
*/
//class laya.ui.HSlider extends laya.ui.Slider
var HSlider=(function(_super){
	/**
	*创建一个 <code>HSlider</code> 类实例。
	*@param skin 皮肤。
	*/
	function HSlider(skin){
		HSlider.__super.call(this,skin);
		this.isVertical=false;
	}

	__class(HSlider,'laya.ui.HSlider',_super);
	return HSlider;
})(Slider)


/**
*
*使用 <code>VScrollBar</code> （垂直 <code>ScrollBar</code> ）控件，可以在因数据太多而不能在显示区域完全显示时控制显示的数据部分。
*
*@example <caption>以下示例代码，创建了一个 <code>VScrollBar</code> 实例。</caption>
*package
*{
	*import laya.ui.vScrollBar;
	*import laya.ui.VScrollBar;
	*import laya.utils.Handler;
	*public class VScrollBar_Example
	*{
		*private var vScrollBar:VScrollBar;
		*public function VScrollBar_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png"],Handler.create(this,onLoadComplete));
			*}
		*private function onLoadComplete():void
		*{
			*vScrollBar=new VScrollBar();//创建一个 vScrollBar 类的实例对象 hScrollBar 。
			*vScrollBar.skin="resource/ui/vscroll.png";//设置 vScrollBar 的皮肤。
			*vScrollBar.x=100;//设置 vScrollBar 对象的属性 x 的值，用于控制 vScrollBar 对象的显示位置。
			*vScrollBar.y=100;//设置 vScrollBar 对象的属性 y 的值，用于控制 vScrollBar 对象的显示位置。
			*vScrollBar.changeHandler=new Handler(this,onChange);//设置 vScrollBar 的滚动变化处理器。
			*Laya.stage.addChild(vScrollBar);//将此 vScrollBar 对象添加到显示列表。
			*}
		*private function onChange(value:Number):void
		*{
			*trace("滚动条的位置： value="+value);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*var vScrollBar;
*var res=["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png"];
*Laya.loader.load(res,laya.utils.Handler.create(this,onLoadComplete));//加载资源。
*function onLoadComplete(){
	*vScrollBar=new laya.ui.VScrollBar();//创建一个 vScrollBar 类的实例对象 hScrollBar 。
	*vScrollBar.skin="resource/ui/vscroll.png";//设置 vScrollBar 的皮肤。
	*vScrollBar.x=100;//设置 vScrollBar 对象的属性 x 的值，用于控制 vScrollBar 对象的显示位置。
	*vScrollBar.y=100;//设置 vScrollBar 对象的属性 y 的值，用于控制 vScrollBar 对象的显示位置。
	*vScrollBar.changeHandler=new laya.utils.Handler(this,onChange);//设置 vScrollBar 的滚动变化处理器。
	*Laya.stage.addChild(vScrollBar);//将此 vScrollBar 对象添加到显示列表。
	*}
*function onChange(value){
	*console.log("滚动条的位置： value="+value);
	*}
*@example
*import VScrollBar=laya.ui.VScrollBar;
*import Handler=laya.utils.Handler;
*class VScrollBar_Example {
	*private vScrollBar:VScrollBar;
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/vscroll.png","resource/ui/vscroll$bar.png","resource/ui/vscroll$down.png","resource/ui/vscroll$up.png"],Handler.create(this,this.onLoadComplete));
		*}
	*private onLoadComplete():void {
		*this.vScrollBar=new VScrollBar();//创建一个 vScrollBar 类的实例对象 hScrollBar 。
		*this.vScrollBar.skin="resource/ui/vscroll.png";//设置 vScrollBar 的皮肤。
		*this.vScrollBar.x=100;//设置 vScrollBar 对象的属性 x 的值，用于控制 vScrollBar 对象的显示位置。
		*this.vScrollBar.y=100;//设置 vScrollBar 对象的属性 y 的值，用于控制 vScrollBar 对象的显示位置。
		*this.vScrollBar.changeHandler=new Handler(this,this.onChange);//设置 vScrollBar 的滚动变化处理器。
		*Laya.stage.addChild(this.vScrollBar);//将此 vScrollBar 对象添加到显示列表。
		*}
	*private onChange(value:number):void {
		*console.log("滚动条的位置： value="+value);
		*}
	*}
*/
//class laya.ui.VScrollBar extends laya.ui.ScrollBar
var VScrollBar=(function(_super){
	function VScrollBar(){
		VScrollBar.__super.call(this);;
	}

	__class(VScrollBar,'laya.ui.VScrollBar',_super);
	return VScrollBar;
})(ScrollBar)


/**
*<code>TextInput</code> 类用于创建显示对象以显示和输入文本。
*
*@example <caption>以下示例代码，创建了一个 <code>TextInput</code> 实例。</caption>
*package
*{
	*import laya.display.Stage;
	*import laya.ui.TextInput;
	*import laya.utils.Handler;
	*public class TextInput_Example
	*{
		*public function TextInput_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/input.png"],Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*var textInput:TextInput=new TextInput("这是一个TextInput实例。");//创建一个 TextInput 类的实例对象 textInput 。
			*textInput.skin="resource/ui/input.png";//设置 textInput 的皮肤。
			*textInput.sizeGrid="4,4,4,4";//设置 textInput 的网格信息。
			*textInput.color="#008fff";//设置 textInput 的文本颜色。
			*textInput.font="Arial";//设置 textInput 的文本字体。
			*textInput.bold=true;//设置 textInput 的文本显示为粗体。
			*textInput.fontSize=30;//设置 textInput 的字体大小。
			*textInput.wordWrap=true;//设置 textInput 的文本自动换行。
			*textInput.x=100;//设置 textInput 对象的属性 x 的值，用于控制 textInput 对象的显示位置。
			*textInput.y=100;//设置 textInput 对象的属性 y 的值，用于控制 textInput 对象的显示位置。
			*textInput.width=300;//设置 textInput 的宽度。
			*textInput.height=200;//设置 textInput 的高度。
			*Laya.stage.addChild(textInput);//将 textInput 添加到显示列表。
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*Laya.loader.load(["resource/ui/input.png"],laya.utils.Handler.create(this,onLoadComplete));//加载资源。
*function onLoadComplete(){
	*var textInput=new laya.ui.TextInput("这是一个TextInput实例。");//创建一个 TextInput 类的实例对象 textInput 。
	*textInput.skin="resource/ui/input.png";//设置 textInput 的皮肤。
	*textInput.sizeGrid="4,4,4,4";//设置 textInput 的网格信息。
	*textInput.color="#008fff";//设置 textInput 的文本颜色。
	*textInput.font="Arial";//设置 textInput 的文本字体。
	*textInput.bold=true;//设置 textInput 的文本显示为粗体。
	*textInput.fontSize=30;//设置 textInput 的字体大小。
	*textInput.wordWrap=true;//设置 textInput 的文本自动换行。
	*textInput.x=100;//设置 textInput 对象的属性 x 的值，用于控制 textInput 对象的显示位置。
	*textInput.y=100;//设置 textInput 对象的属性 y 的值，用于控制 textInput 对象的显示位置。
	*textInput.width=300;//设置 textInput 的宽度。
	*textInput.height=200;//设置 textInput 的高度。
	*Laya.stage.addChild(textInput);//将 textInput 添加到显示列表。
	*}
*@example
*import Stage=laya.display.Stage;
*import TextInput=laya.ui.TextInput;
*import Handler=laya.utils.Handler;
*class TextInput_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/input.png"],Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*var textInput:TextInput=new TextInput("这是一个TextInput实例。");//创建一个 TextInput 类的实例对象 textInput 。
		*textInput.skin="resource/ui/input.png";//设置 textInput 的皮肤。
		*textInput.sizeGrid="4,4,4,4";//设置 textInput 的网格信息。
		*textInput.color="#008fff";//设置 textInput 的文本颜色。
		*textInput.font="Arial";//设置 textInput 的文本字体。
		*textInput.bold=true;//设置 textInput 的文本显示为粗体。
		*textInput.fontSize=30;//设置 textInput 的字体大小。
		*textInput.wordWrap=true;//设置 textInput 的文本自动换行。
		*textInput.x=100;//设置 textInput 对象的属性 x 的值，用于控制 textInput 对象的显示位置。
		*textInput.y=100;//设置 textInput 对象的属性 y 的值，用于控制 textInput 对象的显示位置。
		*textInput.width=300;//设置 textInput 的宽度。
		*textInput.height=200;//设置 textInput 的高度。
		*Laya.stage.addChild(textInput);//将 textInput 添加到显示列表。
		*}
	*}
*/
//class laya.ui.TextInput extends laya.ui.Label
var TextInput=(function(_super){
	function TextInput(text){
		/**@private */
		this._bg=null;
		/**@private */
		this._skin=null;
		TextInput.__super.call(this);
		(text===void 0)&& (text="");
		this.text=text;
		this.skin=this.skin;
	}

	__class(TextInput,'laya.ui.TextInput',_super);
	var __proto=TextInput.prototype;
	/**@inheritDoc */
	__proto.preinitialize=function(){
		this.mouseEnabled=true;
	}

	/**@inheritDoc */
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._bg && this._bg.destroy();
		this._bg=null;
	}

	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._tf=new Input());
		this._tf.padding=Styles.inputLabelPadding;
		this._tf.on("input",this,this._onInput);
		this._tf.on("enter",this,this._onEnter);
		this._tf.on("blur",this,this._onBlur);
		this._tf.on("focus",this,this._onFocus);
	}

	/**
	*@private
	*/
	__proto._onFocus=function(){
		this.event("focus",this);
	}

	/**
	*@private
	*/
	__proto._onBlur=function(){
		this.event("blur",this);
	}

	/**
	*@private
	*/
	__proto._onInput=function(){
		this.event("input",this);
	}

	/**
	*@private
	*/
	__proto._onEnter=function(){
		this.event("enter",this);
	}

	/**@inheritDoc */
	__proto.initialize=function(){
		this.width=128;
		this.height=22;
	}

	/**选中输入框内的文本。*/
	__proto.select=function(){
		(this._tf).select();
	}

	__proto.setSelection=function(startIndex,endIndex){
		(this._tf).setSelection(startIndex,endIndex);
	}

	/**
	*当前文本内容字符串。
	*@see laya.display.Text.text
	*/
	__getset(0,__proto,'text',_super.prototype._$get_text,function(value){
		if (this._tf.text !=value){
			value=value+"";
			this._tf.text=value;
			this.event("change");
		}
	});

	/**
	*表示此对象包含的文本背景 <code>AutoBitmap</code> 组件实例。
	*/
	__getset(0,__proto,'bg',function(){
		return this._bg;
		},function(value){
		this.graphics=this._bg=value;
	});

	/**
	*设置原生input输入框的y坐标偏移。
	*/
	__getset(0,__proto,'inputElementYAdjuster',function(){
		return (this._tf).inputElementYAdjuster;
		},function(value){
		(this._tf).inputElementYAdjuster=value;
	});

	/**
	*<p>指示当前是否是文本域。</p>
	*值为true表示当前是文本域，否则不是文本域。
	*/
	__getset(0,__proto,'multiline',function(){
		return (this._tf).multiline;
		},function(value){
		(this._tf).multiline=value;
	});

	/**
	*@copy laya.ui.Image#skin
	*/
	__getset(0,__proto,'skin',function(){
		return this._skin;
		},function(value){
		if (this._skin !=value){
			this._skin=value;
			this._bg || (this.graphics=this._bg=new AutoBitmap());
			this._bg.source=Loader.getRes(this._skin);
			this._width && (this._bg.width=this._width);
			this._height && (this._bg.height=this._height);
		}
	});

	/**
	*<p>当前实例的背景图（ <code>AutoBitmap</code> ）实例的有效缩放网格数据。</p>
	*<p>数据格式："上边距,右边距,下边距,左边距,是否重复填充(值为0：不重复填充，1：重复填充)"，以逗号分隔。
	*<ul><li>例如："4,4,4,4,1"</li></ul></p>
	*@see laya.ui.AutoBitmap.sizeGrid
	*/
	__getset(0,__proto,'sizeGrid',function(){
		return this._bg && this._bg.sizeGrid ? this._bg.sizeGrid.join(","):null;
		},function(value){
		this._bg || (this.graphics=this._bg=new AutoBitmap());
		this._bg.sizeGrid=UIUtils.fillArray(Styles.defaultSizeGrid,value,Number);
	});

	/**
	*设置原生input输入框的x坐标偏移。
	*/
	__getset(0,__proto,'inputElementXAdjuster',function(){
		return (this._tf).inputElementXAdjuster;
		},function(value){
		(this._tf).inputElementXAdjuster=value;
	});

	/**@inheritDoc */
	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(Label,this,'width',value);
		this._bg && (this._bg.width=value);
	});

	/**@inheritDoc */
	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(Label,this,'height',value);
		this._bg && (this._bg.height=value);
	});

	/**
	*设置可编辑状态。
	*/
	__getset(0,__proto,'editable',function(){
		return (this._tf).editable;
		},function(value){
		(this._tf).editable=value;
	});

	/**限制输入的字符。*/
	__getset(0,__proto,'restrict',function(){
		return (this._tf).restrict;
		},function(pattern){
		(this._tf).restrict=pattern;
	});

	/**
	*@copy laya.display.Input#prompt
	*/
	__getset(0,__proto,'prompt',function(){
		return (this._tf).prompt;
		},function(value){
		(this._tf).prompt=value;
	});

	/**
	*@copy laya.display.Input#promptColor
	*/
	__getset(0,__proto,'promptColor',function(){
		return (this._tf).promptColor;
		},function(value){
		(this._tf).promptColor=value;
	});

	/**
	*@copy laya.display.Input#maxChars
	*/
	__getset(0,__proto,'maxChars',function(){
		return (this._tf).maxChars;
		},function(value){
		(this._tf).maxChars=value;
	});

	/**
	*@copy laya.display.Input#focus
	*/
	__getset(0,__proto,'focus',function(){
		return (this._tf).focus;
		},function(value){
		(this._tf).focus=value;
	});

	/**
	*@copy laya.display.Input#type
	*/
	__getset(0,__proto,'type',function(){
		return (this._tf).type;
		},function(value){
		(this._tf).type=value;
	});

	/**
	*@copy laya.display.Input#asPassword
	*/
	__getset(0,__proto,'asPassword',function(){
		return (this._tf).asPassword;
		},function(value){
		(this._tf).asPassword=value;
	});

	return TextInput;
})(Label)


/**
*使用 <code>VSlider</code> 控件，用户可以通过在滑块轨道的终点之间移动滑块来选择值。
*<p> <code>VSlider</code> 控件采用垂直方向。滑块轨道从下往上扩展，而标签位于轨道的左右两侧。</p>
*
*@example <caption>以下示例代码，创建了一个 <code>VSlider</code> 实例。</caption>
*package
*{
	*import laya.ui.HSlider;
	*import laya.ui.VSlider;
	*import laya.utils.Handler;
	*public class VSlider_Example
	*{
		*private var vSlider:VSlider;
		*public function VSlider_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/vslider.png","resource/ui/vslider$bar.png"],Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*vSlider=new VSlider();//创建一个 VSlider 类的实例对象 vSlider 。
			*vSlider.skin="resource/ui/vslider.png";//设置 vSlider 的皮肤。
			*vSlider.min=0;//设置 vSlider 最低位置值。
			*vSlider.max=10;//设置 vSlider 最高位置值。
			*vSlider.value=2;//设置 vSlider 当前位置值。
			*vSlider.tick=1;//设置 vSlider 刻度值。
			*vSlider.x=100;//设置 vSlider 对象的属性 x 的值，用于控制 vSlider 对象的显示位置。
			*vSlider.y=100;//设置 vSlider 对象的属性 y 的值，用于控制 vSlider 对象的显示位置。
			*vSlider.changeHandler=new Handler(this,onChange);//设置 vSlider 位置变化处理器。
			*Laya.stage.addChild(vSlider);//把 vSlider 添加到显示列表。
			*}
		*private function onChange(value:Number):void
		*{
			*trace("滑块的位置： value="+value);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*var vSlider;
*Laya.loader.load(["resource/ui/vslider.png","resource/ui/vslider$bar.png"],laya.utils.Handler.create(this,onLoadComplete));//加载资源。
*function onLoadComplete(){
	*vSlider=new laya.ui.VSlider();//创建一个 VSlider 类的实例对象 vSlider 。
	*vSlider.skin="resource/ui/vslider.png";//设置 vSlider 的皮肤。
	*vSlider.min=0;//设置 vSlider 最低位置值。
	*vSlider.max=10;//设置 vSlider 最高位置值。
	*vSlider.value=2;//设置 vSlider 当前位置值。
	*vSlider.tick=1;//设置 vSlider 刻度值。
	*vSlider.x=100;//设置 vSlider 对象的属性 x 的值，用于控制 vSlider 对象的显示位置。
	*vSlider.y=100;//设置 vSlider 对象的属性 y 的值，用于控制 vSlider 对象的显示位置。
	*vSlider.changeHandler=new laya.utils.Handler(this,onChange);//设置 vSlider 位置变化处理器。
	*Laya.stage.addChild(vSlider);//把 vSlider 添加到显示列表。
	*}
*function onChange(value){
	*console.log("滑块的位置： value="+value);
	*}
*@example
*import HSlider=laya.ui.HSlider;
*import VSlider=laya.ui.VSlider;
*import Handler=laya.utils.Handler;
*class VSlider_Example {
	*private vSlider:VSlider;
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/vslider.png","resource/ui/vslider$bar.png"],Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*this.vSlider=new VSlider();//创建一个 VSlider 类的实例对象 vSlider 。
		*this.vSlider.skin="resource/ui/vslider.png";//设置 vSlider 的皮肤。
		*this.vSlider.min=0;//设置 vSlider 最低位置值。
		*this.vSlider.max=10;//设置 vSlider 最高位置值。
		*this.vSlider.value=2;//设置 vSlider 当前位置值。
		*this.vSlider.tick=1;//设置 vSlider 刻度值。
		*this.vSlider.x=100;//设置 vSlider 对象的属性 x 的值，用于控制 vSlider 对象的显示位置。
		*this.vSlider.y=100;//设置 vSlider 对象的属性 y 的值，用于控制 vSlider 对象的显示位置。
		*this.vSlider.changeHandler=new Handler(this,this.onChange);//设置 vSlider 位置变化处理器。
		*Laya.stage.addChild(this.vSlider);//把 vSlider 添加到显示列表。
		*}
	*private onChange(value:number):void {
		*console.log("滑块的位置： value="+value);
		*}
	*}
*@see laya.ui.Slider
*/
//class laya.ui.VSlider extends laya.ui.Slider
var VSlider=(function(_super){
	function VSlider(){
		VSlider.__super.call(this);;
	}

	__class(VSlider,'laya.ui.VSlider',_super);
	return VSlider;
})(Slider)


/**
*...
*@author ww
*/
//class laya.debug.tools.debugUI.DInput extends laya.display.Input
var DInput=(function(_super){
	function DInput(){
		DInput.__super.call(this);
		this.bgColor="#11ff00";
	}

	__class(DInput,'laya.debug.tools.debugUI.DInput',_super);
	return DInput;
})(Input)


/**
*@private
*/
//class laya.utils.GraphicAnimation extends laya.display.FrameAnimation
var GraphicAnimation=(function(_super){
	var GraphicNode;
	function GraphicAnimation(){
		/**
		*@private
		*/
		this.animationList=null;
		/**
		*@private
		*/
		this.animationDic=null;
		/**
		*@private
		*/
		this._nodeList=null;
		/**
		*@private
		*/
		this._nodeDefaultProps=null;
		/**
		*@private
		*/
		this._gList=null;
		/**
		*@private
		*/
		this._nodeIDAniDic={};
		this._rootNode=null;
		this._nodeGDic=null;
		GraphicAnimation.__super.call(this);
	}

	__class(GraphicAnimation,'laya.utils.GraphicAnimation',_super);
	var __proto=GraphicAnimation.prototype;
	/**
	*@private
	*/
	__proto._parseNodeList=function(uiView){
		if (!this._nodeList){
			this._nodeList=[];
		}
		this._nodeDefaultProps[uiView.compId]=uiView.props;
		if (uiView.compId)
			this._nodeList.push(uiView.compId);
		var childs=uiView.child;
		if (childs){
			var i=0,len=childs.length;
			for (i=0;i < len;i++){
				this._parseNodeList(childs[i]);
			}
		}
	}

	/**
	*@private
	*/
	__proto._calGraphicData=function(aniData){
		this._setUp(null,aniData);
		this._createGraphicData();
		if (this._nodeIDAniDic){
			var key;
			for (key in this._nodeIDAniDic){
				this._nodeIDAniDic[key]=null;
			}
		}
	}

	/**
	*@private
	*/
	__proto._createGraphicData=function(){
		var gList=[];
		var i=0,len=this.count;
		var animationDataNew=this._animationNewFrames;
		if (!animationDataNew)animationDataNew=[];
		var preGraphic;
		for (i=0;i < len;i++){
			if (animationDataNew[i] || !preGraphic){
				preGraphic=this._createFrameGraphic(i);
			}
			gList.push(preGraphic);
		}
		this._gList=gList;
	}

	/**
	*@private
	*/
	__proto._createFrameGraphic=function(frame){
		var g=RunDriver.createGraphics();
		if (!GraphicAnimation._rootMatrix)
			GraphicAnimation._rootMatrix=new Matrix();
		this._updateNodeGraphic(this._rootNode,frame,GraphicAnimation._rootMatrix,g);
		return g;
	}

	__proto._updateNodeGraphic=function(node,frame,parentTransfrom,g,alpha){
		(alpha===void 0)&& (alpha=1);
		var tNodeG;
		tNodeG=this._nodeGDic[node.compId]=this._getNodeGraphicData(node.compId,frame,this._nodeGDic[node.compId]);
		var tGraphicAlpha=tNodeG.alpha *alpha;
		if (tGraphicAlpha < 0.01)return;
		if (!tNodeG.resultTransform){
			tNodeG.resultTransform=Matrix.create();
		};
		var tResultTransform;
		tResultTransform=tNodeG.resultTransform;
		Matrix.mul(tNodeG.transform,parentTransfrom,tResultTransform);
		var tTex;
		if (tNodeG.skin){
			tTex=this._getTextureByUrl(tNodeG.skin);
			if (tTex){
				if (tResultTransform._checkTransform()){
					g.drawTexture(tTex,0,0,tNodeG.width,tNodeG.height,tResultTransform,tGraphicAlpha);
					tNodeG.resultTransform=null;
					}else {
					g.drawTexture(tTex,tResultTransform.tx,tResultTransform.ty,tNodeG.width,tNodeG.height,null,tGraphicAlpha);
				}
			}
		};
		var childs;
		childs=node.child;
		if (!childs)
			return;
		var i=0,len=0;
		len=childs.length;
		for (i=0;i < len;i++){
			this._updateNodeGraphic(childs[i],frame,tResultTransform,g,tGraphicAlpha);
		}
	}

	__proto._updateNoChilds=function(tNodeG,g){
		if (!tNodeG.skin)
			return;
		var tTex=this._getTextureByUrl(tNodeG.skin);
		if (!tTex)
			return;
		var tTransform=tNodeG.transform;
		tTransform._checkTransform();
		var onlyTranslate=false;
		onlyTranslate=!tTransform.bTransform;
		if (!onlyTranslate){
			g.drawTexture(tTex,0,0,tNodeG.width,tNodeG.height,tTransform.clone(),tNodeG.alpha);
			}else {
			g.drawTexture(tTex,tTransform.tx,tTransform.ty,tNodeG.width,tNodeG.height,null,tNodeG.alpha);
		}
	}

	__proto._updateNodeGraphic2=function(node,frame,g){
		var tNodeG;
		tNodeG=this._nodeGDic[node.compId]=this._getNodeGraphicData(node.compId,frame,this._nodeGDic[node.compId]);
		if (!node.child){
			this._updateNoChilds(tNodeG,g);
			return;
		};
		var tTransform=tNodeG.transform;
		tTransform._checkTransform();
		var onlyTranslate=false;
		onlyTranslate=!tTransform.bTransform;
		var hasTrans=false;
		hasTrans=onlyTranslate && (tTransform.tx !=0 || tTransform.ty !=0);
		var ifSave=false;
		ifSave=(tTransform.bTransform)|| tNodeG.alpha !=1;
		if (ifSave){
			g.save();
		}
		if (tNodeG.alpha !=1){
			g.alpha(tNodeG.alpha);
		}
		if (!onlyTranslate){
			g.transform(tTransform.clone());
			}else if (hasTrans){
			g.translate(tTransform.tx,tTransform.ty);
		};
		var childs;
		childs=node.child;
		var tTex;
		if (tNodeG.skin){
			tTex=this._getTextureByUrl(tNodeG.skin);
			if (tTex){
				g.drawTexture(tTex,0,0,tNodeG.width,tNodeG.height);
			}
		}
		if (childs){
			var i=0,len=0;
			len=childs.length;
			for (i=0;i < len;i++){
				this._updateNodeGraphic2(childs[i],frame,g);
			}
		}
		if (ifSave){
			g.restore();
			}else {
			if (!onlyTranslate){
				g.transform(tTransform.clone().invert());
				}else if (hasTrans){
				g.translate(-tTransform.tx,-tTransform.ty);
			}
		}
	}

	/**
	*@private
	*/
	__proto._calculateNodeKeyFrames=function(node){
		_super.prototype._calculateNodeKeyFrames.call(this,node);
		this._nodeIDAniDic[node.target]=node;
	}

	/**
	*@private
	*/
	__proto.getNodeDataByID=function(nodeID){
		return this._nodeIDAniDic[nodeID];
	}

	/**
	*@private
	*/
	__proto._getParams=function(obj,params,frame,obj2){
		var rst=GraphicAnimation._temParam;
		rst.length=params.length;
		var i=0,len=params.length;
		for (i=0;i < len;i++){
			rst[i]=this._getObjVar(obj,params[i][0],frame,params[i][1],obj2);
		}
		return rst;
	}

	/**
	*@private
	*/
	__proto._getObjVar=function(obj,key,frame,noValue,obj2){
		if (obj.hasOwnProperty(key)){
			var vArr=obj[key];
			if (frame >=vArr.length)
				frame=vArr.length-1;
			return obj[key][frame];
		}
		if (obj2.hasOwnProperty(key)){
			return obj2[key];
		}
		return noValue;
	}

	__proto._getNodeGraphicData=function(nodeID,frame,rst){
		if (!rst)
			rst=GraphicNode.create();
		if (!rst.transform){
			rst.transform=Matrix.create();
			}else{
			rst.transform.identity();
		};
		var node=this.getNodeDataByID(nodeID);
		if (!node)
			return rst;
		var frameData=node.frames;
		var params=this._getParams(frameData,GraphicAnimation._drawTextureCmd,frame,this._nodeDefaultProps[nodeID]);
		var url=params[0];
		var width=NaN,height=NaN;
		var px=params[5],py=params[6];
		var aX=params[13],aY=params[14];
		var sx=params[7],sy=params[8];
		var rotate=params[9];
		var skewX=params[11],skewY=params[12]
		width=params[3];
		height=params[4];
		if (width==0 || height==0)url=null;
		if (width==-1)width=0;
		if (height==-1)height=0;
		var tex;
		rst.skin=url;
		rst.width=width;
		rst.height=height;
		if (url){
			tex=this._getTextureByUrl(url);
			if (tex){
				if (!width)
					width=tex.sourceWidth;
				if (!height)
					height=tex.sourceHeight;
				}else {
				console.warn("lost skin:",url,",you may load pics first");
			}
		}
		rst.alpha=params[10];
		var m;
		m=rst.transform;
		if (aX !=0){
			px=aX *width;
		}
		if (aY !=0){
			py=aY *height;
		}
		if (px !=0 || py !=0){
			m.translate(-px,-py);
		};
		var tm=null;
		if (rotate || sx!==1 || sy!==1 || skewX || skewY){
			tm=GraphicAnimation._tempMt;
			tm.identity();
			tm.bTransform=true;
			var skx=(rotate-skewX)*0.0174532922222222;
			var sky=(rotate+skewY)*0.0174532922222222;
			var cx=Math.cos(sky);
			var ssx=Math.sin(sky);
			var cy=Math.sin(skx);
			var ssy=Math.cos(skx);
			tm.a=sx *cx;
			tm.b=sx *ssx;
			tm.c=-sy *cy;
			tm.d=sy *ssy;
			tm.tx=tm.ty=0;
		}
		if (tm){
			m=Matrix.mul(m,tm,m);
		}
		m.translate(params[1],params[2]);
		return rst;
	}

	/**
	*@private
	*/
	__proto._getTextureByUrl=function(url){
		return Loader.getRes(url);
	}

	/**
	*@private
	*/
	__proto.setAniData=function(uiView,aniName){
		if (uiView.animations){
			this._nodeDefaultProps={};
			this._nodeGDic={};
			if (this._nodeList)
				this._nodeList.length=0;
			this._rootNode=uiView;
			this._parseNodeList(uiView);
			var aniDic={};
			var anilist=[];
			var animations=uiView.animations;
			var i=0,len=animations.length;
			var tAniO;
			for (i=0;i < len;i++){
				tAniO=animations[i];
				this._labels=null;
				if (aniName && aniName !=tAniO.name){
					continue ;
				}
				if (!tAniO)
					continue ;
				try {
					this._calGraphicData(tAniO);
					}catch (e){
					console.warn("parse animation fail:"+tAniO.name+",empty animation created");
					this._gList=[];
				};
				var frameO={};
				frameO.interval=1000 / tAniO["frameRate"];
				frameO.frames=this._gList;
				frameO.labels=this._labels;
				frameO.name=tAniO.name;
				anilist.push(frameO);
				aniDic[tAniO.name]=frameO;
			}
			this.animationList=anilist;
			this.animationDic=aniDic;
		}
		GraphicAnimation._temParam.length=0;
	}

	__proto.parseByData=function(aniData){
		var rootNode,aniO;
		rootNode=aniData.nodeRoot;
		aniO=aniData.aniO;
		delete aniData.nodeRoot;
		delete aniData.aniO;
		this._nodeDefaultProps={};
		this._nodeGDic={};
		if (this._nodeList)
			this._nodeList.length=0;
		this._rootNode=rootNode;
		this._parseNodeList(rootNode);
		this._labels=null;
		try {
			this._calGraphicData(aniO);
			}catch (e){
			console.warn("parse animation fail:"+aniO.name+",empty animation created");
			this._gList=[];
		};
		var frameO=aniData;
		frameO.interval=1000 / aniO["frameRate"];
		frameO.frames=this._gList;
		frameO.labels=this._labels;
		frameO.name=aniO.name;
		return frameO;
	}

	/**
	*@private
	*/
	__proto.setUpAniData=function(uiView){
		if (uiView.animations){
			var aniDic={};
			var anilist=[];
			var animations=uiView.animations;
			var i=0,len=animations.length;
			var tAniO;
			for (i=0;i < len;i++){
				tAniO=animations[i];
				if (!tAniO)
					continue ;
				var frameO={};
				frameO.name=tAniO.name;
				frameO.aniO=tAniO;
				frameO.nodeRoot=uiView;
				anilist.push(frameO);
				aniDic[tAniO.name]=frameO;
			}
			this.animationList=anilist;
			this.animationDic=aniDic;
		}
	}

	/**
	*@private
	*/
	__proto._clear=function(){
		this.animationList=null;
		this.animationDic=null;
		this._gList=null;
		if (this._nodeGDic){
			var key;
			var tGNode;
			for (key in this._nodeGDic){
				tGNode=this._nodeGDic[key];
				if (tGNode)tGNode.recover();
			}
		}
		this._nodeGDic=null;
	}

	GraphicAnimation.parseAnimationByData=function(animationObject){
		if (!GraphicAnimation._I)
			GraphicAnimation._I=new GraphicAnimation();
		var rst;
		rst=GraphicAnimation._I.parseByData(animationObject);
		GraphicAnimation._I._clear();
		return rst;
	}

	GraphicAnimation.parseAnimationData=function(aniData){
		if (!GraphicAnimation._I)
			GraphicAnimation._I=new GraphicAnimation();
		GraphicAnimation._I.setUpAniData(aniData);
		var rst;
		rst={};
		rst.animationList=GraphicAnimation._I.animationList;
		rst.animationDic=GraphicAnimation._I.animationDic;
		GraphicAnimation._I._clear();
		return rst;
	}

	GraphicAnimation._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]];
	GraphicAnimation._temParam=[];
	GraphicAnimation._I=null;
	GraphicAnimation._rootMatrix=null;
	__static(GraphicAnimation,
	['_tempMt',function(){return this._tempMt=new Matrix();}
	]);
	GraphicAnimation.__init$=function(){
		//class GraphicNode
		GraphicNode=(function(){
			function GraphicNode(){
				this.skin=null;
				this.transform=null;
				this.resultTransform=null;
				this.width=NaN;
				this.height=NaN;
				this.alpha=1;
			}
			__class(GraphicNode,'');
			var __proto=GraphicNode.prototype;
			__proto.recover=function(){
				this.skin=null;
				this.width=0;
				this.height=0;
				this.alpha=1;
				if (this.transform){
					this.transform.destroy();
					this.transform=null;
				}
				if (this.resultTransform){
					this.resultTransform.destroy();
					this.resultTransform=null;
				}
				Pool.recover("GraphicNode",this);
			}
			GraphicNode.create=function(){
				return Pool.getItemByClass("GraphicNode",GraphicNode);
			}
			return GraphicNode;
		})()
	}

	return GraphicAnimation;
})(FrameAnimation)


//class laya.webgl.resource.WebGLImage extends laya.resource.HTMLImage
var WebGLImage=(function(_super){
	function WebGLImage(data,def,format,mipmap){
		/**@private */
		this._format=0;
		/**@private */
		this._mipmap=false;
		/***是否创建私有Source,值为false时不根据src创建私有WebGLTexture,同时销毁时也只清空source=null,不调用WebGL.mainContext.deleteTexture类似函数，调用资源激活前有效*/
		this._allowMerageInAtlas=false;
		/**是否允许加入大图合集*/
		this._enableMerageInAtlas=false;
		/**是否使用重复模式纹理寻址*/
		this.repeat=false;
		/**@private */
		this._image=null;
		/**缩小过滤器*/
		this.minFifter=0;
		/**放大过滤器*/
		this.magFifter=0;
		(format===void 0)&& (format=0x1908);
		(mipmap===void 0)&& (mipmap=true);
		WebGLImage.__super.call(this,data,def);
		this._format=format;
		this._mipmap=mipmap;
		this.repeat=false;
		this.minFifter=-1;
		this.magFifter=-1;
		if ((typeof data=='string')){
			this._url=data;
			this._src=data;
			this._image=new Browser.window.Image();
			if (def){
				def.onload && (this.onload=def.onload);
				def.onerror && (this.onerror=def.onerror);
				def.onCreate && def.onCreate(this);
			}
			this._image.crossOrigin=(data && (data.indexOf("data:")==0))? null :"";
			(data)&& (this._image.src=data);
			}else if ((data instanceof ArrayBuffer)){
			this._src=def;
			this._url=this._src;
			var readData=new Byte(data);
			var magicNumber=readData.readUTFBytes(4);
			var version=readData.readUTFBytes(2);
			var dataType=readData.getInt16();
			readData.endian="bigEndian";
			this._w=readData.getInt16();
			this._h=readData.getInt16();
			var originalWidth=readData.getInt16();
			var originalHeight=readData.getInt16();
			this._image=new Uint8Array(data,readData.pos);
			this._format=WebGL.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL;
			(AtlasResourceManager.enabled)&& (this._w < AtlasResourceManager.atlasLimitWidth && this._h < AtlasResourceManager.atlasLimitHeight)? this._allowMerageInAtlas=true :this._allowMerageInAtlas=false;
			}else {
			this._src=def;
			this._url=this._src;
			this._image=data["source"] || data;
			this.onresize();
		}
		this._$5__enableMerageInAtlas=true;
	}

	__class(WebGLImage,'laya.webgl.resource.WebGLImage',_super);
	var __proto=WebGLImage.prototype;
	Laya.imps(__proto,{"laya.webgl.resource.IMergeAtlasBitmap":true})
	__proto._init_=function(src,def){}
	__proto._createWebGlTexture=function(){
		if (!this._image){
			throw "create GLTextur err:no data:"+this._image;
		};
		var gl=WebGL.mainContext;
		var glTex=this._source=gl.createTexture();
		var preTarget=WebGLContext.curBindTexTarget;
		var preTexture=WebGLContext.curBindTexValue;
		WebGLContext.bindTexture(gl,0x0DE1,glTex);
		if (Render.isConchWebGL){
			switch (this._format){
				case 0x1908:
					gl.texImage2DEx(true,0x0DE1,0,this._format,0x1908,0x1401,this._image);
					break ;
				case WebGL.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:
					gl.compressedTexImage2D(0x0DE1,0,this._format,this._w,this._h,0,this._image);
					break ;
				}
		}
		else {
			gl.pixelStorei(0x9241,true);
			switch (this._format){
				case 0x1908:
					gl.texImage2D(0x0DE1,0,this._format,0x1908,0x1401,this._image);
					break ;
				case WebGL.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:
					gl.compressedTexImage2D(0x0DE1,0,this._format,this._w,this._h,0,this._image);
					break ;
				}
			gl.pixelStorei(0x9241,false);
		};
		var minFifter=this.minFifter;
		var magFifter=this.magFifter;
		var repeat=this.repeat ? 0x2901 :0x812F;
		var isPot=Arith.isPOT(this._w,this._h);
		if (isPot){
			if (this.mipmap)
				(minFifter!==-1)|| (minFifter=0x2703);
			else
			(minFifter!==-1)|| (minFifter=0x2601);
			(magFifter!==-1)|| (magFifter=0x2601);
			gl.texParameteri(0x0DE1,0x2801,minFifter);
			gl.texParameteri(0x0DE1,0x2800,magFifter);
			gl.texParameteri(0x0DE1,0x2802,repeat);
			gl.texParameteri(0x0DE1,0x2803,repeat);
			this.mipmap && gl.generateMipmap(0x0DE1);
			}else {
			(minFifter!==-1)|| (minFifter=0x2601);
			(magFifter!==-1)|| (magFifter=0x2601);
			gl.texParameteri(0x0DE1,0x2801,minFifter);
			gl.texParameteri(0x0DE1,0x2800,magFifter);
			gl.texParameteri(0x0DE1,0x2802,0x812F);
			gl.texParameteri(0x0DE1,0x2803,0x812F);
		}
		(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));
		this._image.onload=null;
		this._image=null;
		if (isPot && this.mipmap)
			this.memorySize=this._w *this._h *4 *(1+1 / 3);
		else
		this.memorySize=this._w *this._h *4;
		this._recreateLock=false;
	}

	/***重新创建资源，如果异步创建中被强制释放再创建，则需等待释放完成后再重新加载创建。*/
	__proto.recreateResource=function(){
		var _$this=this;
		if (this._src==null || this._src==="")
			return;
		this._needReleaseAgain=false;
		if (!this._image){
			this._recreateLock=true;
			var _this=this;
			this._image=new Browser.window.Image();
			this._image.crossOrigin=this._src.indexOf("data:")==0 ? null :"";
			this._image.onload=function (){
				if (_this._needReleaseAgain){
					_this._needReleaseAgain=false;
					_this._image.onload=null;
					_this._image=null;
					return;
				}
				(!(_this._allowMerageInAtlas && _this._enableMerageInAtlas))? (_this._createWebGlTexture()):(_$this.memorySize=0,_$this._recreateLock=false);
				_this.completeCreate();
			};
			this._image.src=this._src;
			}else {
			if (this._recreateLock){
				return;
			}
			(!(this._allowMerageInAtlas && this._$5__enableMerageInAtlas))? (this._createWebGlTexture()):(this.memorySize=0,this._recreateLock=false);
			this.completeCreate();
		}
	}

	/***销毁资源*/
	__proto.disposeResource=function(){
		if (this._recreateLock){
			this._needReleaseAgain=true;
		}
		if (this._source){
			WebGL.mainContext.deleteTexture(this._source);
			this._source=null;
			this._image=null;
			this.memorySize=0;
		}
	}

	/***调整尺寸*/
	__proto.onresize=function(){
		this._w=this._image.width;
		this._h=this._image.height;
		(AtlasResourceManager.enabled)&& (this._w < AtlasResourceManager.atlasLimitWidth && this._h < AtlasResourceManager.atlasLimitHeight)? this._allowMerageInAtlas=true :this._allowMerageInAtlas=false;
	}

	__proto.clearAtlasSource=function(){
		this._image=null;
	}

	/**
	*获取纹理格式。
	*/
	__getset(0,__proto,'format',function(){
		return this._format;
	});

	/**
	*是否创建私有Source,通常禁止修改
	*@param value 是否创建
	*/
	/**
	*是否创建私有Source
	*@return 是否创建
	*/
	__getset(0,__proto,'enableMerageInAtlas',function(){
		return this._$5__enableMerageInAtlas;
		},function(value){
		this._$5__enableMerageInAtlas=value;
	});

	/**
	*获取是否具有mipmap。
	*/
	__getset(0,__proto,'mipmap',function(){
		return this._mipmap;
	});

	/**
	*是否创建私有Source
	*@return 是否创建
	*/
	__getset(0,__proto,'allowMerageInAtlas',function(){
		return this._allowMerageInAtlas;
	});

	__getset(0,__proto,'atlasSource',function(){
		return this._image;
	});

	/***
	*设置onload函数
	*@param value onload函数
	*/
	__getset(0,__proto,'onload',null,function(value){
		var _$this=this;
		this._onload=value;
		this._image && (this._image.onload=this._onload !=null ? (function(){
			_$this.onresize();
			_$this._onload();
		}):null);
	});

	/***
	*设置onerror函数
	*@param value onerror函数
	*/
	__getset(0,__proto,'onerror',null,function(value){
		var _$this=this;
		this._onerror=value;
		this._image && (this._image.onerror=this._onerror !=null ? (function(){
			_$this._onerror()
		}):null);
	});

	return WebGLImage;
})(HTMLImage)


//class ui.SLGGAME.zhandouUI extends laya.ui.View
var zhandouUI=(function(_super){
	function zhandouUI(){
		this.ani1=null;
		this.shakeLayer=null;
		this.zhandou=null;
		this.cheng=null;
		this.herolayer=null;
		this.effectlayer=null;
		this.walldoor=null;
		this.wall0=null;
		this.wall2=null;
		this.box3=null;
		this.box0=null;
		this.box4=null;
		this.box1=null;
		this.box5=null;
		this.box2=null;
		this.box6=null;
		this.box9=null;
		this.box7=null;
		this.box10=null;
		this.box8=null;
		this.box11=null;
		this.wall1=null;
		this.uilayer=null;
		this.btn1_zh=null;
		this.bar1=null;
		this.txt1=null;
		this.btn1_zy=null;
		this.p1=null;
		this.btn2_zh=null;
		this.bar2=null;
		this.txt2=null;
		this.btn2_zy=null;
		this.p2=null;
		this.tuichu=null;
		this.tips0=null;
		this.btn0=null;
		this.sudu=null;
		this.shu=null;
		this.jiantou=null;
		this.zhj1=null;
		this.zhj2=null;
		this.linshi=null;
		this.huo1=null;
		this.huo2=null;
		this.jianjian=null;
		zhandouUI.__super.call(this);
	}

	__class(zhandouUI,'ui.SLGGAME.zhandouUI',_super);
	var __proto=zhandouUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.zhandou_tipsUI",zhandou_tipsUI);
		View.regComponent("Particle2D",Particle2D);
		View.regComponent("ui.jieshujianUI",jieshujianUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhandou");
	}

	return zhandouUI;
})(View)


/**
*<code>Dialog</code> 组件是一个弹出对话框，实现对话框弹出，拖动，模式窗口功能。
*可以通过UIConfig设置弹出框背景透明度，模式窗口点击边缘是否关闭等
*通过设置zOrder属性，可以更改弹出的层次
*通过设置popupEffect和closeEffect可以设置弹出效果和关闭效果，如果不想有任何弹出关闭效果，可以设置前述属性为空
*
*@example <caption>以下示例代码，创建了一个 <code>Dialog</code> 实例。</caption>
*package
*{
	*import laya.ui.Dialog;
	*import laya.utils.Handler;
	*public class Dialog_Example
	*{
		*private var dialog:Dialog_Instance;
		*public function Dialog_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load("resource/ui/btn_close.png",Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*dialog=new Dialog_Instance();//创建一个 Dialog_Instance 类的实例对象 dialog。
			*dialog.dragArea="0,0,150,50";//设置 dialog 的拖拽区域。
			*dialog.show();//显示 dialog。
			*dialog.closeHandler=new Handler(this,onClose);//设置 dialog 的关闭函数处理器。
			*}
		*private function onClose(name:String):void
		*{
			*if (name==Dialog.CLOSE)
			*{
				*trace("通过点击 name 为"+name+"的组件，关闭了dialog。");
				*}
			*}
		*}
	*}
*import laya.ui.Button;
*import laya.ui.Dialog;
*import laya.ui.Image;
*class Dialog_Instance extends Dialog
*{
	*function Dialog_Instance():void
	*{
		*var bg:Image=new Image("resource/ui/bg.png");
		*bg.sizeGrid="40,10,5,10";
		*bg.width=150;
		*bg.height=250;
		*addChild(bg);
		*var image:Image=new Image("resource/ui/image.png");
		*addChild(image);
		*var button:Button=new Button("resource/ui/btn_close.png");
		*button.name=Dialog.CLOSE;//设置button的name属性值。
		*button.x=0;
		*button.y=0;
		*addChild(button);
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高、渲染模式
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*var dialog;
*Laya.loader.load("resource/ui/btn_close.png",laya.utils.Handler.create(this,loadComplete));//加载资源
*(function (_super){//新建一个类Dialog_Instance继承自laya.ui.Dialog。
	*function Dialog_Instance(){
		*Dialog_Instance.__super.call(this);//初始化父类
		*var bg=new laya.ui.Image("resource/ui/bg.png");//新建一个 Image 类的实例 bg 。
		*bg.sizeGrid="10,40,10,5";//设置 bg 的网格信息。
		*bg.width=150;//设置 bg 的宽度。
		*bg.height=250;//设置 bg 的高度。
		*this.addChild(bg);//将 bg 添加到显示列表。
		*var image=new laya.ui.Image("resource/ui/image.png");//新建一个 Image 类的实例 image 。
		*this.addChild(image);//将 image 添加到显示列表。
		*var button=new laya.ui.Button("resource/ui/btn_close.png");//新建一个 Button 类的实例 bg 。
		*button.name=laya.ui.Dialog.CLOSE;//设置 button 的 name 属性值。
		*button.x=0;//设置 button 对象的属性 x 的值，用于控制 button 对象的显示位置。
		*button.y=0;//设置 button 对象的属性 y 的值，用于控制 button 对象的显示位置。
		*this.addChild(button);//将 button 添加到显示列表。
		*};
	*Laya.class(Dialog_Instance,"mypackage.dialogExample.Dialog_Instance",_super);//注册类Dialog_Instance。
	*})(laya.ui.Dialog);
*function loadComplete(){
	*console.log("资源加载完成！");
	*dialog=new mypackage.dialogExample.Dialog_Instance();//创建一个 Dialog_Instance 类的实例对象 dialog。
	*dialog.dragArea="0,0,150,50";//设置 dialog 的拖拽区域。
	*dialog.show();//显示 dialog。
	*dialog.closeHandler=new laya.utils.Handler(this,onClose);//设置 dialog 的关闭函数处理器。
	*}
*function onClose(name){
	*if (name==laya.ui.Dialog.CLOSE){
		*console.log("通过点击 name 为"+name+"的组件，关闭了dialog。");
		*}
	*}
*@example
*import Dialog=laya.ui.Dialog;
*import Handler=laya.utils.Handler;
*class Dialog_Example {
	*private dialog:Dialog_Instance;
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load("resource/ui/btn_close.png",Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*this.dialog=new Dialog_Instance();//创建一个 Dialog_Instance 类的实例对象 dialog。
		*this.dialog.dragArea="0,0,150,50";//设置 dialog 的拖拽区域。
		*this.dialog.show();//显示 dialog。
		*this.dialog.closeHandler=new Handler(this,this.onClose);//设置 dialog 的关闭函数处理器。
		*}
	*private onClose(name:string):void {
		*if (name==Dialog.CLOSE){
			*console.log("通过点击 name 为"+name+"的组件，关闭了dialog。");
			*}
		*}
	*}
*import Button=laya.ui.Button;
*class Dialog_Instance extends Dialog {
	*Dialog_Instance():void {
		*var bg:laya.ui.Image=new laya.ui.Image("resource/ui/bg.png");
		*bg.sizeGrid="40,10,5,10";
		*bg.width=150;
		*bg.height=250;
		*this.addChild(bg);
		*var image:laya.ui.Image=new laya.ui.Image("resource/ui/image.png");
		*this.addChild(image);
		*var button:Button=new Button("resource/ui/btn_close.png");
		*button.name=Dialog.CLOSE;//设置button的name属性值。
		*button.x=0;
		*button.y=0;
		*this.addChild(button);
		*}
	*}
*/
//class laya.ui.Dialog extends laya.ui.View
var Dialog=(function(_super){
	function Dialog(){
		/**
		*一个布尔值，指定对话框是否居中弹。
		*<p>如果值为true，则居中弹出，否则，则根据对象坐标显示，默认为true。</p>
		*/
		this.popupCenter=true;
		/**
		*对话框被关闭时会触发的回调函数处理器。
		*<p>回调函数参数为用户点击的按钮名字name:String。</p>
		*/
		this.closeHandler=null;
		/**
		*弹出对话框效果，可以设置一个效果代替默认的弹出效果，如果不想有任何效果，可以赋值为null
		*全局默认弹出效果可以通过manager.popupEffect修改
		*/
		this.popupEffect=null;
		/**
		*关闭对话框效果，可以设置一个效果代替默认的关闭效果，如果不想有任何效果，可以赋值为null
		*全局默认关闭效果可以通过manager.closeEffect修改
		*/
		this.closeEffect=null;
		/**组名称*/
		this.group=null;
		/**是否是模式窗口*/
		this.isModal=false;
		/**@private */
		this._dragArea=null;
		Dialog.__super.call(this);
	}

	__class(Dialog,'laya.ui.Dialog',_super);
	var __proto=Dialog.prototype;
	/**@inheritDoc */
	__proto.initialize=function(){
		this.popupEffect=Dialog.manager.popupEffectHandler;
		this.closeEffect=Dialog.manager.closeEffectHandler;
		this._dealDragArea();
		this.on("click",this,this._onClick);
	}

	/**@private */
	__proto._dealDragArea=function(){
		var dragTarget=this.getChildByName("drag");
		if (dragTarget){
			this.dragArea=dragTarget.x+","+dragTarget.y+","+dragTarget.width+","+dragTarget.height;
			dragTarget.removeSelf();
		}
	}

	/**
	*@private (protected)
	*对象的 <code>Event.CLICK</code> 点击事件侦听处理函数。
	*/
	__proto._onClick=function(e){
		var btn=e.target;
		if (btn){
			switch (btn.name){
				case "close":
				case "cancel":
				case "sure":
				case "no":
				case "ok":
				case "yes":
					this.close(btn.name);
					break ;
				}
		}
	}

	/**
	*显示对话框（以非模式窗口方式显示）。
	*@param closeOther 是否关闭其它的对话框。若值为true则关闭其它对话框。
	*@param showEffect 是否显示弹出效果
	*/
	__proto.show=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		this._open(false,closeOther,showEffect);
	}

	/**
	*显示对话框（以模式窗口方式显示）。
	*@param closeOther 是否关闭其它的对话框。若值为true则关闭其它对话框。
	*@param showEffect 是否显示弹出效果
	*/
	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		this._open(true,closeOther,showEffect);
	}

	/**@private */
	__proto._open=function(modal,closeOther,showEffect){
		Dialog.manager.lock(false);
		this.isModal=modal;
		Dialog.manager.open(this,closeOther,showEffect);
	}

	/**打开完成后，调用此方法（如果有弹出动画，则在动画完成后执行）*/
	__proto.onOpened=function(){}
	/**
	*关闭对话框。
	*@param type 如果是点击默认关闭按钮触发，则传入关闭按钮的名字(name)，否则为null。
	*@param showEffect 是否显示关闭效果
	*/
	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		Dialog.manager.close(this,type,showEffect);
	}

	/**关闭完成后，调用此方法（如果有关闭动画，则在动画完成后执行）
	*@param type 如果是点击默认关闭按钮触发，则传入关闭按钮的名字(name)，否则为null。
	*/
	__proto.onClosed=function(type){}
	/**@private */
	__proto._onMouseDown=function(e){
		var point=this.getMousePoint();
		if (this._dragArea.contains(point.x,point.y))this.startDrag();
		else this.stopDrag();
	}

	/**
	*用来指定对话框的拖拽区域。默认值为"0,0,0,0"。
	*<p><b>格式：</b>构成一个矩形所需的 x,y,width,heith 值，用逗号连接为字符串。
	*例如："0,0,100,200"。
	*</p>
	*
	*@see #includeExamplesSummary 请参考示例
	*/
	__getset(0,__proto,'dragArea',function(){
		if (this._dragArea)return this._dragArea.toString();
		return null;
		},function(value){
		if (value){
			var a=UIUtils.fillArray([0,0,0,0],value,Number);
			this._dragArea=new Rectangle(a[0],a[1],a[2],a[3]);
			this.on("mousedown",this,this._onMouseDown);
			}else {
			this._dragArea=null;
			this.off("mousedown",this,this._onMouseDown);
		}
	});

	/**
	*弹出框的显示状态；如果弹框处于显示中，则为true，否则为false;
	*/
	__getset(0,__proto,'isPopup',function(){
		return this.parent !=null;
	});

	__getset(0,__proto,'zOrder',_super.prototype._$get_zOrder,function(value){
		Laya.superSet(View,this,'zOrder',value);
		Dialog.manager._checkMask();
	});

	/**对话框管理容器，所有的对话框都在该容器内，并且受管理器管，可以自定义自己的管理器，来更改窗口管理的流程。
	*任意对话框打开和关闭，都会触发管理类的open和close事件*/
	__getset(1,Dialog,'manager',function(){
		return Dialog._manager=Dialog._manager|| new DialogManager();
		},function(value){
		Dialog._manager=value;
	});

	Dialog.setLockView=function(view){
		Dialog.manager.setLockView(view);
	}

	Dialog.lock=function(value){
		Dialog.manager.lock(value);
	}

	Dialog.closeAll=function(){
		Dialog.manager.closeAll();
	}

	Dialog.getDialogsByGroup=function(group){
		return Dialog.manager.getDialogsByGroup(group);
	}

	Dialog.closeByGroup=function(group){
		return Dialog.manager.closeByGroup(group);
	}

	Dialog.CLOSE="close";
	Dialog.CANCEL="cancel";
	Dialog.SURE="sure";
	Dialog.NO="no";
	Dialog.OK="ok";
	Dialog.YES="yes";
	Dialog._manager=null;
	return Dialog;
})(View)


//class ui.GG04UI extends laya.ui.View
var GG04UI=(function(_super){
	function GG04UI(){
		this.ani1=null;
		this.s0=null;
		this.s1=null;
		this.s2=null;
		this.s3=null;
		this.s4=null;
		this.jian=null;
		GG04UI.__super.call(this);
	}

	__class(GG04UI,'ui.GG04UI',_super);
	var __proto=GG04UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("GG04");
	}

	return GG04UI;
})(View)


//class fight.SkillEffect extends game.base.display.ClipMc
var SkillEffect=(function(_super){
	function SkillEffect(){
		SkillEffect.__super.call(this);
	}

	__class(SkillEffect,'fight.SkillEffect',_super);
	var __proto=SkillEffect.prototype;
	__proto.setEffectId=function(effectId,container,target,offX,offY){
		var sys=ConfigManager.getConfig("sys_skill_effect.txt",effectId);
		this.setClipName(sys.effectId+"","SKILL_EFFECT");
		this.playByTimes(1,true);
		this.setPos(container,target);
		this.x+=offX;
		this.y+=offY;
		this.scale(1.25,1.25);
	}

	SkillEffect.disSkill=function(target,skillId,delay,offX,offY){
		(delay===void 0)&& (delay=0);
		(offX===void 0)&& (offX=0);
		(offY===void 0)&& (offY=0);
		var sysSkill=ConfigManager.getConfig("sys_skill.txt",skillId);
		SkillEffect.disEffect(target,sysSkill.skillEffect,delay,sysSkill.shake,offX,offY);
	}

	SkillEffect.disEffect=function(target,effectId,delay,shake,offX,offY){
		(delay===void 0)&& (delay=0);
		(shake===void 0)&& (shake=0);
		(offX===void 0)&& (offX=0);
		(offY===void 0)&& (offY=0);
		if(delay > 0){
			Laya.timer.once(delay,SkillEffect,fight.SkillEffect.disEffect,[target,effectId,0,shake,offX,offY],false);
			return;
		};
		var skillEffect=new SkillEffect();
		skillEffect.setEffectId(effectId ,SkillEffect.effectLayer,target,offX,offY);
		if(shake==1){
			Shake.execute(SkillEffect.shakeLayer,200,3);
		}
	}

	SkillEffect.effectLayer=null;
	SkillEffect.shakeLayer=null;
	return SkillEffect;
})(ClipMc)


//class ui.zhandou_tanhaoUI extends laya.ui.View
var zhandou_tanhaoUI=(function(_super){
	function zhandou_tanhaoUI(){
		this.chengshiming=null;
		this.dong=null;
		zhandou_tanhaoUI.__super.call(this);
	}

	__class(zhandou_tanhaoUI,'ui.zhandou_tanhaoUI',_super);
	var __proto=zhandou_tanhaoUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("zhandou_tanhao");
	}

	return zhandou_tanhaoUI;
})(View)


//class ui.SLGGAME.map_taskUI extends laya.ui.View
var map_taskUI=(function(_super){
	function map_taskUI(){
		this.ming0=null;
		this.time0=null;
		this.xingjun=null;
		this.img0=null;
		map_taskUI.__super.call(this);
	}

	__class(map_taskUI,'ui.SLGGAME.map_taskUI',_super);
	var __proto=map_taskUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map_task");
	}

	return map_taskUI;
})(View)


//class ui.SLGGAME.beibao_11UI extends laya.ui.View
var beibao_11UI=(function(_super){
	function beibao_11UI(){
		this.wenhao=null;
		this.yongyouwenben1=null;
		this.wupinjindu=null;
		this.sp1=null;
		this.baoxiangkuang1=null;
		this.baoxiangkuangdi1=null;
		this.baoxiangshuzi1=null;
		this.baoxiangxuanzhong1=null;
		this.sp2=null;
		this.baoxiangkuang2=null;
		this.baoxiangkuangdi2=null;
		this.baoxiangxuanzhong2=null;
		this.baoxiangshuzi2=null;
		this.sp4=null;
		this.baoxiangkuang4=null;
		this.baoxiangkuangdi4=null;
		this.baoxiangxuanzhong4=null;
		this.baoxiangshuzi4=null;
		this.sp5=null;
		this.baoxiangkuang5=null;
		this.baoxiangkuangdi5=null;
		this.baoxiangxuanzhong5=null;
		this.baoxiangshuzi5=null;
		this.sp3=null;
		this.baoxiangkuang3=null;
		this.baoxiangkuangdi3=null;
		this.baoxiangxuanzhong3=null;
		this.baoxiangshuzi3=null;
		this.sp6=null;
		this.baoxiangkuang6=null;
		this.baoxiangkuangdi6=null;
		this.baoxiangxuanzhong6=null;
		this.baoxianghsuzi6=null;
		this.kaixiang=null;
		this.sheqi=null;
		this.xuanzhongmingcheng=null;
		this.wupinshuoming=null;
		this.xuanzhongwupin=null;
		this.wupinshuoming2=null;
		beibao_11UI.__super.call(this);
	}

	__class(beibao_11UI,'ui.SLGGAME.beibao_11UI',_super);
	var __proto=beibao_11UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/beibao_11");
	}

	return beibao_11UI;
})(View)


//class ui.SLGGAME.beibao_0UI extends laya.ui.View
var beibao_0UI=(function(_super){
	function beibao_0UI(){
		this.shiyong2=null;
		this.chushou=null;
		this.xuanzhongmingcheng=null;
		this.qianhua=null;
		this.yongyou=null;
		this.wupinshuoming=null;
		this.xuanzhongshuliang=null;
		this.xuanzhongwupin=null;
		this.box_s=null;
		this.list0=null;
		this.shoujia=null;
		this.txt0=null;
		this.img0=null;
		this.btn0=null;
		this.fenjie=null;
		beibao_0UI.__super.call(this);
	}

	__class(beibao_0UI,'ui.SLGGAME.beibao_0UI',_super);
	var __proto=beibao_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/beibao_0");
	}

	return beibao_0UI;
})(View)


//class ui.SLGGAME.chuzheng_1UI extends laya.ui.View
var chuzheng_1UI=(function(_super){
	function chuzheng_1UI(){
		this.wenzi1=null;
		this.jia=null;
		chuzheng_1UI.__super.call(this);
	}

	__class(chuzheng_1UI,'ui.SLGGAME.chuzheng_1UI',_super);
	var __proto=chuzheng_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chuzheng_1");
	}

	return chuzheng_1UI;
})(View)


//class ui.SLGGAME.chuzhengkaUI extends laya.ui.View
var chuzhengkaUI=(function(_super){
	function chuzhengkaUI(){
		this.di=null;
		this.box=null;
		this.kaung=null;
		this.hei=null;
		this.wk=null;
		this.guojia=null;
		this.tiao=null;
		this.dengji=null;
		this.name0=null;
		this.xue=null;
		this.binglitiao=null;
		this.txt0=null;
		this.xing=null;
		this.xing1=null;
		this.xing2=null;
		this.xing3=null;
		this.xing4=null;
		this.xing5=null;
		this.yuancha=null;
		this.hun=null;
		this.shuH=null;
		this.yiyongyou=null;
		this.box_jt=null;
		this.txt1=null;
		this.clip0=null;
		chuzhengkaUI.__super.call(this);
	}

	__class(chuzhengkaUI,'ui.SLGGAME.chuzhengkaUI',_super);
	var __proto=chuzhengkaUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.wujiangka_daUI",wujiangka_daUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chuzhengka");
	}

	return chuzhengkaUI;
})(View)


//class ui.SLGGAME.ka0UI extends laya.ui.View
var ka0UI=(function(_super){
	function ka0UI(){
		this.di=null;
		this.box=null;
		this.img0=null;
		this.tiao=null;
		this.wk=null;
		this.wk2=null;
		this.hei=null;
		this.dengji=null;
		this.name0=null;
		this.box_x=null;
		this.bar0=null;
		this.txt0=null;
		this.box_xing=null;
		this.xing1=null;
		this.xing2=null;
		this.xing3=null;
		this.xing4=null;
		this.xing5=null;
		ka0UI.__super.call(this);
	}

	__class(ka0UI,'ui.SLGGAME.ka0UI',_super);
	var __proto=ka0UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.wujiangka_daUI",wujiangka_daUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/ka0");
	}

	return ka0UI;
})(View)


//class huamao.panel.city.BuildView extends laya.ui.View
var BuildView=(function(_super){
	function BuildView(){
		this.list=null;
		this.dataAry=null;
		this.txt2=null;
		this.mapCitySession=null;
		BuildView.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(BuildView,'huamao.panel.city.BuildView',_super);
	var __proto=BuildView.prototype;
	__proto.init=function(){
		var title=new chengchi_1UI();
		title.pos(10+15,7);
		this.addChild(title);
		this.list=new List();
		this.list.pos(15+10,60);
		this.list.size(850,50*7+10);
		this.list.vScrollBarSkin="";
		this.list.repeatX=1;
		this.list.repeatY=11;
		this.list.spaceX=0;
		this.list.spaceY=0;
		this.list.itemRender=ItemB;
		this.list.selectHandler=new Handler(this,this.onSelect);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.flushData();
		this.addChild(this.list);
		var txt1=new Label();
		this.txt2=new Label();
		var posY=450;
		txt1.pos(510,posY);
		txt1.size(252,27);
		txt1.text="拥有城池数：";
		txt1.color="#d29a62";
		txt1.bold=true;
		txt1.font="隶书";
		txt1.fontSize=22;
		txt1.align="right";
		this.addChild(txt1);
		this.txt2.pos(765,posY);
		this.txt2.size(120,27);
		this.txt2.text=this.mapCitySession.getCityNum()+"";
		this.txt2.color="#f1e9cf";
		this.txt2.bold=false;
		this.txt2.font="隶书";
		this.txt2.fontSize=22;
		this.txt2.align="left";
		this.addChild(this.txt2);
	}

	__proto.sortFun=function(dataA,dataB){
		var a_pjLv=dataA.pjLv;
		var a_Lv=dataA.cityLv;
		var a_kong=10-dataA.mjNum-dataA.ntNum-dataA.sjNum;
		var a_time=dataA.time;
		var b_pjLv=dataB.pjLv;
		var b_Lv=dataB.cityLv;
		var b_kong=10-dataB.mjNum-dataB.ntNum-dataB.sjNum;
		var b_time=dataB.time;
		if(a_pjLv !=b_pjLv){
			return a_pjLv-b_pjLv;
			}else if(a_Lv !=b_Lv){
			return a_Lv-b_Lv;
			}else if(a_kong !=b_kong){
			return b_kong-a_kong;
			}else{
			return a_time-b_time;
		}
	}

	//4. 初始按照获得先后进行排序。
	__proto.flushData=function(){
		this.dataAry=this.mapCitySession.getCityListAry();
		this.dataAry.sort(this.sortFun);
		this.list.array=this.dataAry;
		if(this.txt2 !=null){
			this.txt2.text=this.mapCitySession.getCityNum()+"";
		}
	}

	__proto.onSelect=function(index){}
	// remSelectIndex=index;
	__proto.updateItem=function(cell,index){
		var datasource=cell.dataSource;
		cell.flush(datasource,index);
	}

	return BuildView;
})(View)


//class ui.SLGGAME.chengchi_1_0UI extends laya.ui.View
var chengchi_1_0UI=(function(_super){
	function chengchi_1_0UI(){
		this.di=null;
		this.cheng=null;
		this.kong=null;
		this.min=null;
		this.shi=null;
		this.tian=null;
		this.fu=null;
		this.dengji=null;
		this.chui1=null;
		this.chui2=null;
		chengchi_1_0UI.__super.call(this);
	}

	__class(chengchi_1_0UI,'ui.SLGGAME.chengchi_1_0UI',_super);
	var __proto=chengchi_1_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chengchi_1_0");
	}

	return chengchi_1_0UI;
})(View)


//class huamao.panel.city.MilitaryView extends laya.ui.View
var MilitaryView=(function(_super){
	var ItemM;
	function MilitaryView(){
		this.list=null;
		this.dataAry=null;
		this.txt2=null;
		this.mapCitySession=null;
		MilitaryView.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(MilitaryView,'huamao.panel.city.MilitaryView',_super);
	var __proto=MilitaryView.prototype;
	__proto.init=function(){
		var title=new chengchi_2UI();
		title.pos(10+15,7);
		this.addChild(title);
		this.list=new List();
		this.list.pos(15+10,60);
		this.list.size(850,50*7+10);
		this.list.vScrollBarSkin="";
		this.list.repeatX=1;
		this.list.repeatY=11;
		this.list.spaceX=0;
		this.list.spaceY=0;
		this.list.itemRender=ItemM;
		this.list.selectHandler=new Handler(this,this.onSelect);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.flushData();
		this.addChild(this.list);
		var txt1=new Label();
		this.txt2=new Label();
		var posY=450;
		txt1.pos(510,posY);
		txt1.size(252,27);
		txt1.text="总兵力：";
		txt1.color="#d29a62";
		txt1.bold=true;
		txt1.font="隶书";
		txt1.fontSize=22;
		txt1.align="right";
		this.addChild(txt1);
		this.txt2.pos(765,posY);
		this.txt2.size(120,27);
		this.txt2.text=this.mapCitySession.getAllSoldier()+"";
		this.txt2.color="#f1e9cf";
		this.txt2.bold=false;
		this.txt2.font="隶书";
		this.txt2.fontSize=22;
		this.txt2.align="left";
		this.addChild(this.txt2);
	}

	//军事列表按照，驻守武将数->预备役->带兵数量->预备役产量，进行从大到小排序
	__proto.sortFun=function(dataA,dataB){
		var a_wjNum=dataA.heroNum;
		var a_soldier=dataA.soldier;
		var a_heroSoldier=dataA.heroSoldier;
		var a_solderOutPut=dataA.soldierOutPut;
		var b_wjNum=dataB.heroNum;
		var b_soldier=dataB.soldier;
		var b_heroSoldier=dataB.heroSoldier;
		var b_solderOutPut=dataB.soldierOutPut;
		if(a_wjNum !=b_wjNum){
			return b_wjNum-a_wjNum;
			}else if(a_soldier !=b_soldier){
			return b_soldier-a_soldier;
			}else if(a_heroSoldier !=b_heroSoldier){
			return b_heroSoldier-a_heroSoldier;
			}else{
			return b_solderOutPut-a_solderOutPut;
		}
	}

	__proto.flushData=function(){
		this.dataAry=this.mapCitySession.getCityListAry();
		this.dataAry.sort(this.sortFun);
		this.list.array=this.dataAry;
		if(this.txt2 !=null){
			this.txt2.text=this.mapCitySession.getAllSoldier()+"";
		}
	}

	__proto.onSelect=function(index){}
	// remSelectIndex=index;
	__proto.updateItem=function(cell,index){
		var datasource=cell.dataSource;
		cell.flush(datasource,index);
	}

	MilitaryView.__init$=function(){
		//class ItemM extends ui.SLGGAME.chengchi_2_0UI
		ItemM=(function(_super){
			function ItemM(){
				this.mapCityAction=null;
				this.mapCitySession=null;
				this.cityId=0;
				ItemM.__super.call(this);
				App.injOne(this);
				this.init();
			}
			__class(ItemM,'',_super);
			var __proto=ItemM.prototype;
			__proto.init=function(){
				this.on("click",this,this.cityNameCB);
			}
			__proto.cityNameCB=function(){
				App.dialogManager.openDialogByStr("CITY_BUDUI",{cityId:this.cityId,isShowBtn:false},true,true);
			}
			__proto.flush=function(data,index){
				this.cityId=data.cityId;
				if(index%2==0){
					this.di.visible=false;
					}else{
					this.di.visible=true;
				};
				var sysCity=ConfigManager.getConfig("sys_city.txt",this.cityId);
				if(sysCity.cityType==1){
					this.cheng.color="#ffce0a";
					}else{
					this.cheng.color="#e5d3c0";
				}
				this.cheng.text=sysCity.cityName;
				this.yubei.text=data.soldier+"";
				this.jiang.text=data.heroNum+"";
				this.bing.text=data.heroSoldier+"";
				this.liang.text=data.soldierOutPut+"";
				if(this.mapCitySession.checkWeiXian(this.cityId)){
					this.zhantan.visible=true;
					this.zhantan.play(0,true);
					}else{
					this.zhantan.visible=false;
					this.zhantan.stop();
				}
			}
			return ItemM;
		})(chengchi_2_0UI)
	}

	return MilitaryView;
})(View)


//class ui.SLGGAME.chengchi_2_0UI extends laya.ui.View
var chengchi_2_0UI=(function(_super){
	function chengchi_2_0UI(){
		this.di=null;
		this.cheng=null;
		this.yubei=null;
		this.jiang=null;
		this.bing=null;
		this.liang=null;
		this.zhantan=null;
		chengchi_2_0UI.__super.call(this);
	}

	__class(chengchi_2_0UI,'ui.SLGGAME.chengchi_2_0UI',_super);
	var __proto=chengchi_2_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chengchi_2_0");
	}

	return chengchi_2_0UI;
})(View)


//class ui.SLGGAME.budui_bljj_0UI extends laya.ui.View
var budui_bljj_0UI=(function(_super){
	function budui_bljj_0UI(){
		this.d0=null;
		this.cheng=null;
		this.t1=null;
		this.t2=null;
		this.t3=null;
		this.t4=null;
		this.check0=null;
		budui_bljj_0UI.__super.call(this);
	}

	__class(budui_bljj_0UI,'ui.SLGGAME.budui_bljj_0UI',_super);
	var __proto=budui_bljj_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/budui_bljj_0");
	}

	return budui_bljj_0UI;
})(View)


//class ui.SLGGAME.kaUI extends laya.ui.View
var kaUI=(function(_super){
	function kaUI(){
		this.di=null;
		this.box=null;
		this.wk=null;
		this.kuang0=null;
		this.hei=null;
		this.img0=null;
		this.tiao=null;
		this.dengji=null;
		this.name0=null;
		this.zhuangtai=null;
		this.box_c=null;
		this.txt0=null;
		this.box_jt=null;
		this.txt1=null;
		this.box_x=null;
		this.bingli=null;
		this.binglishu=null;
		this.box_xing=null;
		this.xing1=null;
		this.xing2=null;
		this.xing3=null;
		this.xing4=null;
		this.xing5=null;
		this.box_tb=null;
		this.box1=null;
		this.box2=null;
		this.box3=null;
		kaUI.__super.call(this);
	}

	__class(kaUI,'ui.SLGGAME.kaUI',_super);
	var __proto=kaUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.wujiangka_daUI",wujiangka_daUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/ka");
	}

	return kaUI;
})(View)


//class ui.SLGGAME.icon_cheng_js0UI extends laya.ui.View
var icon_cheng_js0UI=(function(_super){
	function icon_cheng_js0UI(){
		this.jianzao=null;
		this.piliang=null;
		this.txt0=null;
		this.ka=null;
		this.name0=null;
		this.jinbi=null;
		this.time0=null;
		icon_cheng_js0UI.__super.call(this);
	}

	__class(icon_cheng_js0UI,'ui.SLGGAME.icon_cheng_js0UI',_super);
	var __proto=icon_cheng_js0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_cheng_js0");
	}

	return icon_cheng_js0UI;
})(View)


//class ui.SLGGAME.icon_dl_tips1UI extends laya.ui.View
var icon_dl_tips1UI=(function(_super){
	function icon_dl_tips1UI(){
		this.txt0=null;
		this.b1=null;
		this.b2=null;
		this.b3=null;
		this.t1=null;
		this.t2=null;
		this.t3=null;
		this.n0=null;
		this.b4=null;
		this.t4=null;
		this.b5=null;
		this.t5=null;
		icon_dl_tips1UI.__super.call(this);
	}

	__class(icon_dl_tips1UI,'ui.SLGGAME.icon_dl_tips1UI',_super);
	var __proto=icon_dl_tips1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_dl_tips1");
	}

	return icon_dl_tips1UI;
})(View)


//class ui.huodong_duobaoUI extends laya.ui.View
var huodong_duobaoUI=(function(_super){
	function huodong_duobaoUI(){
		this.guize=null;
		this.yimaizhi=null;
		this.riqi=null;
		this.xiangzi5=null;
		this.xiangzi4=null;
		this.xiangzi3=null;
		this.xiangzi2=null;
		this.xiangzi1=null;
		this.duo5=null;
		this.duo1=null;
		this.ci1=null;
		this.ci5=null;
		this.jilu=null;
		this.ewai=null;
		this.xiang1=null;
		this.xiang2=null;
		this.xiang3=null;
		this.xiang4=null;
		this.xiang5=null;
		this.wu1=null;
		this.zhuandong=null;
		this.c3=null;
		this.c2=null;
		this.c1=null;
		this.c5=null;
		this.c6=null;
		this.c7=null;
		this.c8=null;
		this.c9=null;
		this.c10=null;
		this.c11=null;
		this.c12=null;
		this.c4=null;
		this.l1=null;
		this.zhen=null;
		this.wu7=null;
		this.wu8=null;
		this.wu6=null;
		this.wu9=null;
		this.wu5=null;
		this.wu10=null;
		this.wu4=null;
		this.wu11=null;
		this.wu3=null;
		this.wu12=null;
		this.wu2=null;
		this.yiling1=null;
		this.yiling2=null;
		this.yiling3=null;
		this.yiling4=null;
		this.yiling5=null;
		this.duoduo=null;
		huodong_duobaoUI.__super.call(this);
	}

	__class(huodong_duobaoUI,'ui.huodong_duobaoUI',_super);
	var __proto=huodong_duobaoUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.huodong_duobao_1UI",huodong_duobao_1UI);
		View.regComponent("ui.huodong_duobao_2UI",huodong_duobao_2UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("huodong_duobao");
	}

	return huodong_duobaoUI;
})(View)


//class ui.SLGGAME.jiesuan_1_0UI extends laya.ui.View
var jiesuan_1_0UI=(function(_super){
	function jiesuan_1_0UI(){
		this.btn0=null;
		this.img0=null;
		this.txt0=null;
		this.dianzan=null;
		this.zan=null;
		this.xin=null;
		jiesuan_1_0UI.__super.call(this);
	}

	__class(jiesuan_1_0UI,'ui.SLGGAME.jiesuan_1_0UI',_super);
	var __proto=jiesuan_1_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/jiesuan_1_0");
	}

	return jiesuan_1_0UI;
})(View)


//class ui.SLGGAME.tips_tjhy0UI extends laya.ui.View
var tips_tjhy0UI=(function(_super){
	function tips_tjhy0UI(){
		this.di=null;
		this.name0=null;
		this.txt0=null;
		this.box0=null;
		this.jia=null;
		this.liaotian=null;
		tips_tjhy0UI.__super.call(this);
	}

	__class(tips_tjhy0UI,'ui.SLGGAME.tips_tjhy0UI',_super);
	var __proto=tips_tjhy0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_tjhy0");
	}

	return tips_tjhy0UI;
})(View)


//class ui.SLGGAME.haoyou_qipaoUI extends laya.ui.View
var haoyou_qipaoUI=(function(_super){
	function haoyou_qipaoUI(){
		this.qipao1=null;
		this.qipao0=null;
		haoyou_qipaoUI.__super.call(this);
	}

	__class(haoyou_qipaoUI,'ui.SLGGAME.haoyou_qipaoUI',_super);
	var __proto=haoyou_qipaoUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.haoyou_qp0UI",haoyou_qp0UI);
		View.regComponent("ui.SLGGAME.haoyou_qp1UI",haoyou_qp1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou_qipao");
	}

	return haoyou_qipaoUI;
})(View)


//class ui.SLGGAME.haoyou_0UI extends laya.ui.View
var haoyou_0UI=(function(_super){
	function haoyou_0UI(){
		this.btn0=null;
		this.nameBg=null;
		this.tiaozhanzhong=null;
		this.namr0=null;
		this.txto=null;
		this.jiantou=null;
		this.box0=null;
		haoyou_0UI.__super.call(this);
	}

	__class(haoyou_0UI,'ui.SLGGAME.haoyou_0UI',_super);
	var __proto=haoyou_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou_0");
	}

	return haoyou_0UI;
})(View)


//class ui.SLGGAME.tips_hyUI extends laya.ui.View
var tips_hyUI=(function(_super){
	function tips_hyUI(){
		this.di=null;
		tips_hyUI.__super.call(this);
	}

	__class(tips_hyUI,'ui.SLGGAME.tips_hyUI',_super);
	var __proto=tips_hyUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_hy");
	}

	return tips_hyUI;
})(View)


//class ui.SLGGAME.tips_hy0UI extends laya.ui.View
var tips_hy0UI=(function(_super){
	function tips_hy0UI(){
		this.btn0=null;
		tips_hy0UI.__super.call(this);
	}

	__class(tips_hy0UI,'ui.SLGGAME.tips_hy0UI',_super);
	var __proto=tips_hy0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_hy0");
	}

	return tips_hy0UI;
})(View)


//class ui.SLGGAME.map0UI extends laya.ui.View
var map0UI=(function(_super){
	function map0UI(){
		this.xuan=null;
		this.name0=null;
		this.box0=null;
		map0UI.__super.call(this);
	}

	__class(map0UI,'ui.SLGGAME.map0UI',_super);
	var __proto=map0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map0");
	}

	return map0UI;
})(View)


//class ui.SLGGAME.zhanbao_0UI extends laya.ui.View
var zhanbao_0UI=(function(_super){
	function zhanbao_0UI(){
		this.di=null;
		this.jieguo=null;
		this.zhuangtai=null;
		this.time0=null;
		this.where0=null;
		this.who0=null;
		this.yidu=null;
		zhanbao_0UI.__super.call(this);
	}

	__class(zhanbao_0UI,'ui.SLGGAME.zhanbao_0UI',_super);
	var __proto=zhanbao_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhanbao_0");
	}

	return zhanbao_0UI;
})(View)


//class ui.SLGGAME.haoyoutiaozhan1UI extends laya.ui.View
var haoyoutiaozhan1UI=(function(_super){
	function haoyoutiaozhan1UI(){
		this.di=null;
		this.shanchu=null;
		this.tz0=null;
		this.time0=null;
		this.img0=null;
		this.name0=null;
		this.txt0=null;
		this.txt1=null;
		haoyoutiaozhan1UI.__super.call(this);
	}

	__class(haoyoutiaozhan1UI,'ui.SLGGAME.haoyoutiaozhan1UI',_super);
	var __proto=haoyoutiaozhan1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyoutiaozhan1");
	}

	return haoyoutiaozhan1UI;
})(View)


//class ui.SLGGAME.wujiang_ka0UI extends laya.ui.View
var wujiang_ka0UI=(function(_super){
	function wujiang_ka0UI(){
		this.kapinzhi=null;
		this.ka0=null;
		this.tiao=null;
		this.name0=null;
		this.img0=null;
		this.dengji=null;
		this.bingli=null;
		this.xiangxi=null;
		wujiang_ka0UI.__super.call(this);
	}

	__class(wujiang_ka0UI,'ui.SLGGAME.wujiang_ka0UI',_super);
	var __proto=wujiang_ka0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_ka0");
	}

	return wujiang_ka0UI;
})(View)


//class ui.SLGGAME.huodong_huoyue2UI extends laya.ui.View
var huodong_huoyue2UI=(function(_super){
	function huodong_huoyue2UI(){
		this.di0=null;
		this.chou1=null;
		this.bbo2=null;
		this.di1=null;
		this.zizi1=null;
		this.ming=null;
		this.zi1=null;
		this.shuzi2=null;
		this.weida1=null;
		this.zhuan=null;
		this.clo1=null;
		huodong_huoyue2UI.__super.call(this);
	}

	__class(huodong_huoyue2UI,'ui.SLGGAME.huodong_huoyue2UI',_super);
	var __proto=huodong_huoyue2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_huoyue2");
	}

	return huodong_huoyue2UI;
})(View)


//class ui.SLGGAME.huodong_huoyueUI extends laya.ui.View
var huodong_huoyueUI=(function(_super){
	function huodong_huoyueUI(){
		this.bar0=null;
		this.hyd=null;
		this.shu0=null;
		this.box2=null;
		this.box1=null;
		this.box0=null;
		this.s0=null;
		this.s1=null;
		this.s2=null;
		this.shu1=null;
		this.shu2=null;
		this.tips0=null;
		this.btn0=null;
		this.gou1=null;
		this.te1=null;
		this.gou2=null;
		this.te2=null;
		this.gou3=null;
		this.te3=null;
		this.list0=null;
		huodong_huoyueUI.__super.call(this);
	}

	__class(huodong_huoyueUI,'ui.SLGGAME.huodong_huoyueUI',_super);
	var __proto=huodong_huoyueUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_huoyue");
	}

	return huodong_huoyueUI;
})(View)


//class ui.SLGGAME.huodong_jijin_0UI extends laya.ui.View
var huodong_jijin_0UI=(function(_super){
	function huodong_jijin_0UI(){
		this.btn0=null;
		this.txt0=null;
		this.lq=null;
		this.box0=null;
		this.shu0=null;
		this.zhuan=null;
		huodong_jijin_0UI.__super.call(this);
	}

	__class(huodong_jijin_0UI,'ui.SLGGAME.huodong_jijin_0UI',_super);
	var __proto=huodong_jijin_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_jijin_0");
	}

	return huodong_jijin_0UI;
})(View)


//class ui.SLGGAME.huodong_jijinUI extends laya.ui.View
var huodong_jijinUI=(function(_super){
	function huodong_jijinUI(){
		this.time0=null;
		this.txt0=null;
		this.chaozhi=null;
		this.yuanbao=null;
		this.list0=null;
		this.ygm=null;
		this.guang=null;
		huodong_jijinUI.__super.call(this);
	}

	__class(huodong_jijinUI,'ui.SLGGAME.huodong_jijinUI',_super);
	var __proto=huodong_jijinUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_jijin");
	}

	return huodong_jijinUI;
})(View)


//class ui.SLGGAME.huodong_kabao_1UI extends laya.ui.View
var huodong_kabao_1UI=(function(_super){
	function huodong_kabao_1UI(){
		this.b1=null;
		this.b2=null;
		this.b3=null;
		this.b4=null;
		this.b5=null;
		this.btn0=null;
		this.yigou=null;
		this.lan=null;
		this.b6=null;
		this.yuanyuan=null;
		this.shuzi=null;
		huodong_kabao_1UI.__super.call(this);
	}

	__class(huodong_kabao_1UI,'ui.SLGGAME.huodong_kabao_1UI',_super);
	var __proto=huodong_kabao_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_kabao_1");
	}

	return huodong_kabao_1UI;
})(View)


//class ui.SLGGAME.huodong_kabaoUI extends laya.ui.View
var huodong_kabaoUI=(function(_super){
	function huodong_kabaoUI(){
		this.shijian=null;
		this.list0=null;
		huodong_kabaoUI.__super.call(this);
	}

	__class(huodong_kabaoUI,'ui.SLGGAME.huodong_kabaoUI',_super);
	var __proto=huodong_kabaoUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_kabao");
	}

	return huodong_kabaoUI;
})(View)


//class ui.SLGGAME.huodong_leiji_0UI extends laya.ui.View
var huodong_leiji_0UI=(function(_super){
	function huodong_leiji_0UI(){
		this.di1=null;
		this.btn0=null;
		this.zhuan=null;
		this.shu0=null;
		this.qian=null;
		this.di2=null;
		this.di3=null;
		this.lq=null;
		this.di4=null;
		this.di5=null;
		this.yuan=null;
		this.di6=null;
		huodong_leiji_0UI.__super.call(this);
	}

	__class(huodong_leiji_0UI,'ui.SLGGAME.huodong_leiji_0UI',_super);
	var __proto=huodong_leiji_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_leiji_0");
	}

	return huodong_leiji_0UI;
})(View)


//class ui.SLGGAME.huodong_leijiUI extends laya.ui.View
var huodong_leijiUI=(function(_super){
	function huodong_leijiUI(){
		this.txt0=null;
		this.shu0=null;
		this.list0=null;
		huodong_leijiUI.__super.call(this);
	}

	__class(huodong_leijiUI,'ui.SLGGAME.huodong_leijiUI',_super);
	var __proto=huodong_leijiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_leiji");
	}

	return huodong_leijiUI;
})(View)


//class ui.SLGGAME.huodong_qiandao_0UI extends laya.ui.View
var huodong_qiandao_0UI=(function(_super){
	function huodong_qiandao_0UI(){
		this.di=null;
		this.box_0=null;
		this.qian=null;
		this.clip0=null;
		huodong_qiandao_0UI.__super.call(this);
	}

	__class(huodong_qiandao_0UI,'ui.SLGGAME.huodong_qiandao_0UI',_super);
	var __proto=huodong_qiandao_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_qiandao_0");
	}

	return huodong_qiandao_0UI;
})(View)


//class ui.SLGGAME.huodong_qiandaoUI extends laya.ui.View
var huodong_qiandaoUI=(function(_super){
	function huodong_qiandaoUI(){
		this.txt0=null;
		huodong_qiandaoUI.__super.call(this);
	}

	__class(huodong_qiandaoUI,'ui.SLGGAME.huodong_qiandaoUI',_super);
	var __proto=huodong_qiandaoUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_qiandao");
	}

	return huodong_qiandaoUI;
})(View)


//class ui.SLGGAME.huodong_7renwuUI extends laya.ui.View
var huodong_7renwuUI=(function(_super){
	function huodong_7renwuUI(){
		this.list0=null;
		this.war=null;
		this.btn0=null;
		this.zhuan=null;
		this.day0=null;
		this.txt0=null;
		this.box1=null;
		this.shu1=null;
		this.ylq=null;
		this.tips0=null;
		huodong_7renwuUI.__super.call(this);
	}

	__class(huodong_7renwuUI,'ui.SLGGAME.huodong_7renwuUI',_super);
	var __proto=huodong_7renwuUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_7renwu");
	}

	return huodong_7renwuUI;
})(View)


//class huamao.panel.talk.ColeageT extends laya.ui.View
var ColeageT=(function(_super){
	function ColeageT(){
		this.panel=null;
		this.remY=0;
		this.count=0;
		this.talkSession=null;
		this.remary=null;
		this.ifinit=true;
		this.framloop=null;
		this.remCell=[];
		ColeageT.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(ColeageT,'huamao.panel.talk.ColeageT',_super);
	var __proto=ColeageT.prototype;
	Laya.imps(__proto,{"huamao.panel.talk.PanelInterface":true})
	__proto.init=function(){
		this.panel=new Panel();
		this.addChild(this.panel);
		this.panel.pos(3,3);
		this.panel.size(TalkPanel.PANEL_W,TalkPanel.PANEL_H);
		this.panel.vScrollBarSkin="";
		this.initAllData()
	}

	__proto.resetAllContent=function(){
		this.initAllData()
	}

	__proto.clearAllContent=function(){
		this.panel.removeChildren();
		this.remCell.length=0;
		this.remY=0;
		this.remary=[];
		this.ifinit=true;
		this.framloop.stop();
		this.framloop=null;
	}

	__proto.addData=function(data){
		var cell=new OtherCell(data);
		var curY=0;
		if(this.remCell.length >=TalkSession.MAXSIZE){
			var fistCell=this.remCell.shift();
			var fistH=fistCell.height;
			fistCell.removeSelf();
			for(var i=0;i<this.remCell.length;i++){
				var cellt=this.remCell [i];
				cellt.y-=fistH;
			}
		}
		if(this.remCell.length > 0){
			var lastCell=(this.remCell [this.remCell.length-1]);
			curY=lastCell.y+lastCell.height;
		}
		cell.pos(0,curY);
		this.remCell.push(cell);
		this.panel.addChild(cell);
		this.panel.vScrollBar.setScroll(0,this.panel.contentHeight,this.panel.contentHeight);
	}

	__proto.initAllData=function(){
		this.remary=this.talkSession.aryColeage.concat();
		this.framloop=new FramLoad(3,this.remary,new Handler(this,this.doCB),new Handler(this,this.overCB));
	}

	__proto.doCB=function(_data){
		var data=_data;
		this.addData(data);
	}

	__proto.overCB=function(){
		this.ifinit=false;
	}

	__proto.flushPanel=function(){
		var len=this.talkSession.aryColeage.length;
		if(this.ifinit){
			this.remary.push(this.talkSession.aryColeage[len-1]);
			}else{
			this.addData(this.talkSession.aryColeage[len-1]);
		}
	}

	return ColeageT;
})(View)


//class huamao.panel.talk.CurrentT extends laya.ui.View
var CurrentT=(function(_super){
	function CurrentT(){
		this.panel=null;
		this.remY=0;
		this.count=0;
		this.talkSession=null;
		this.mainPlayerSession=null;
		this.remary=null;
		this.ifinit=true;
		this.framloop=null;
		this.remCell=[];
		CurrentT.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(CurrentT,'huamao.panel.talk.CurrentT',_super);
	var __proto=CurrentT.prototype;
	Laya.imps(__proto,{"huamao.panel.talk.PanelInterface":true})
	__proto.init=function(){
		this.panel=new Panel();
		this.addChild(this.panel);
		this.panel.pos(3,3);
		this.panel.size(TalkPanel.PANEL_W,TalkPanel.PANEL_H);
		this.panel.vScrollBarSkin="";
		this.initAllData();
	}

	__proto.addsentence=function(){
		this.addData(null);
	}

	__proto.addData=function(data){
		var cell=new OtherCell(data);;
		var curY=0;
		if(this.remCell.length >=TalkSession.MAXSIZE){
			var fistCell=this.remCell.shift();
			var fistH=fistCell.height;
			fistCell.removeSelf();
			for(var i=0;i<this.remCell.length;i++){
				var cellt=this.remCell [i];
				cellt.y-=fistH;
			}
		}
		if(this.remCell.length > 0){
			var lastCell=(this.remCell [this.remCell.length-1]);
			curY=lastCell.y+lastCell.height;
		}
		cell.pos(0,curY);
		this.remCell.push(cell);
		this.panel.addChild(cell);
		this.panel.vScrollBar.setScroll(0,this.panel.contentHeight,this.panel.contentHeight);
	}

	__proto.resetAllContent=function(){
		this.initAllData()
	}

	__proto.clearAllContent=function(){
		this.panel.removeChildren();
		this.remCell.length=0;
		this.remY=0;
		this.remary=[];
		this.ifinit=true;
		this.framloop.stop();
		this.framloop=null;
	}

	__proto.initAllData=function(){
		this.remary=this.talkSession.aryCurrent.concat();
		this.framloop=new FramLoad(3,this.remary,new Handler(this,this.doCB),new Handler(this,this.overCB));
	}

	__proto.doCB=function(_data){
		var data=_data;
		this.addData(data);
	}

	__proto.overCB=function(){
		this.ifinit=false;
	}

	__proto.flushPanel=function(){
		var len=this.talkSession.aryCurrent.length;
		if(this.ifinit){
			this.remary.push(this.talkSession.aryCurrent[len-1]);
			}else{
			this.addData(this.talkSession.aryCurrent[len-1]);
		}
	}

	return CurrentT;
})(View)


//class huamao.panel.talk.OtherCell extends laya.ui.View
var OtherCell=(function(_super){
	function OtherCell(data){
		this.img_iconDi=null;
		this.img_icon=null;
		this.img_qiPao=null;
		this.html_name=null;
		this.html_content=null;
		this.mainPlayerSession=null;
		this.playerInfoAction=null;
		this.curData=null;
		OtherCell.__super.call(this);
		App.injOne(this);
		this.init();
		this.flushData(data);
	}

	__class(OtherCell,'huamao.panel.talk.OtherCell',_super);
	var __proto=OtherCell.prototype;
	__proto.flushData=function(data){
		if(data==null){
			this.curData==null;
			return;
		}
		this.curData=data;
		this.html_content.innerHTML=data.getContentHtml(data.paoBg);
		this.img_qiPao.height=(this.html_content.contextHeight+10 < 45)? 45 :(this.html_content.contextHeight+10);
		this.html_name.innerHTML=data.getNameHtml();
		this.html_name.width=500;
		this.img_icon.skin=GameUtils.getHeadUrl(data.playerstyle);
		this.height=29+this.img_qiPao.height;
		if(data.playerid !=this.mainPlayerSession.mainPlayerData.playerId){
			this.img_iconDi.pos(0,6);
			this.html_name.pos(74,3);
			this.img_qiPao.pos(61,29);
			this.img_qiPao.sizeGrid=this.getPaoPaoSizeGride(data.paoBg,true);
			this.img_qiPao.skin=this.getPaoPaoImge(data.paoBg,true);
			this.html_content.pos(75,30);
			}else{
			this.img_iconDi.pos(300+45,6);
			this.html_name.pos(290+35-this.html_name.contextWidth,3);
			this.img_qiPao.sizeGrid=this.getPaoPaoSizeGride(data.paoBg,false);
			this.img_qiPao.skin=this.getPaoPaoImge(data.paoBg,false);
			this.img_qiPao.pos(294+45-this.img_qiPao.source.width,29);
			this.html_content.pos(20,30);
		}
	}

	__proto.init=function(){
		this.size(TalkPanel.PANEL_W,0);
		this.img_iconDi=new Image();
		this.img_iconDi.skin="comp/G/g.png";
		this.img_iconDi.size(54,54);
		this.img_icon=new Image();
		this.img_icon.size(50,50);
		this.img_icon.pos(1,1);
		this.img_iconDi.addChild(this.img_icon);
		this.img_iconDi.zOrder=99;
		this.addChild(this.img_iconDi);
		this.html_name=new HTMLDivElement();
		this.html_name.pos(290-this.html_name.contextWidth,3);
		this.addChild(this.html_name);
		this.img_qiPao=new Image();
		this.img_qiPao.sizeGrid="21,29,6,18";
		this.html_content=new HTMLDivElement();
		this.html_content.pos(20,30);
		this.html_content.size(260+45,43);
		this.addChild(this.img_qiPao);
		this.addChild(this.html_content);
		this.html_content.on("link",this,this.clickCB);
		this.img_icon.on("click",this,this.checkMes);
	}

	__proto.checkMes=function(){
		if(this.curData !=null){
			if(this.curData.playerid !=this.mainPlayerSession.mainPlayerData.playerId){
				this.playerInfoAction.sendViewPlayerMes(this.curData.playerid);
				}else{
				FlyUpTips.setTips("这是你自己哟！");
			}
		}
	}

	__proto.clickCB=function(data){
		console.log(data);
		var str=data;
		var beginindex=str.indexOf(":");
		var battleId=str.substr(beginindex+1);
		App.eventManager.event("BATTLE",battleId);
	}

	//type:true:left false:right
	__proto.getPaoPaoImge=function(paotype,type){
		var result="";
		if(paotype==0){
			type? (result="comp/G/ltt_a_0.png"):(result="comp/G/ltt_a_1.png");
			}else if(paotype==1){
			type? (result="comp/G/ltt_b_0.png"):(result="comp/G/ltt_b_1.png");
			}else if(paotype==2){
			type? (result="comp/G/lt_a_0.png"):(result="comp/G/lt_a_1.png");
		}
		console.log("getPaoPaoImge = "+result);
		return result;
	}

	__proto.getPaoPaoSizeGride=function(paotype,type){
		var result="";
		if(paotype==0){
			type? (result="21,20,13,25"):(result="21,29,6,18");
			}else if(paotype==1){
			type? (result="11,42,28,42"):(result="11,42,28,42");
		}
		return result;
	}

	return OtherCell;
})(View)


//class huamao.panel.talk.SystemT extends laya.ui.View
var SystemT=(function(_super){
	function SystemT(){
		this.panel=null;
		this.remY=0;
		this.disY=0;
		this.count=0;
		this.talkSession=null;
		this.mainPlayerSession=null;
		this.remary=null;
		this.ifinit=true;
		this.framloop=null;
		this.remCell=[];
		SystemT.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(SystemT,'huamao.panel.talk.SystemT',_super);
	var __proto=SystemT.prototype;
	Laya.imps(__proto,{"huamao.panel.talk.PanelInterface":true})
	__proto.init=function(){
		this.panel=new Panel();
		this.addChild(this.panel);
		this.panel.pos(3,3);
		this.panel.size(TalkPanel.PANEL_W,TalkPanel.PANEL_H);
		this.panel.vScrollBarSkin="";
		this.initAllData();
	}

	__proto.addsentence=function(){
		this.addData(null);
	}

	__proto.resetAllContent=function(){
		this.initAllData();
	}

	__proto.clearAllContent=function(){
		this.panel.removeChildren();
		this.remCell.length=0;
		this.remY=0;
		this.remary=[];
		this.ifinit=true;
		this.framloop.stop();
		this.framloop=null;
	}

	__proto.addData=function(str){
		var cell=new SysCell(str,1);
		var curY=0;
		if(this.remCell.length >=TalkSession.MAXSIZE){
			var fistCell=this.remCell.shift();
			var fistH=fistCell.height;
			fistCell.removeSelf();
			for(var i=0;i<this.remCell.length;i++){
				var cellt=this.remCell [i];
				cellt.y-=fistH;
			}
		}
		if(this.remCell.length > 0){
			var lastCell=(this.remCell [this.remCell.length-1]);
			curY=lastCell.y+lastCell.height;
		}
		cell.pos(0,curY);
		this.remCell.push(cell);
		this.panel.addChild(cell);
		this.panel.vScrollBar.setScroll(0,this.panel.contentHeight,this.panel.contentHeight);
	}

	__proto.initAllData=function(){
		this.remary=this.talkSession.arySys.concat();
		this.framloop=new FramLoad(3,this.remary,new Handler(this,this.doCB),new Handler(this,this.overCB));
	}

	__proto.doCB=function(_data){
		var data=_data;
		this.addData(data.getSysHtml());
	}

	__proto.overCB=function(){
		this.ifinit=false;
	}

	__proto.flushPanel=function(){
		if(this.ifinit){
			var len=this.talkSession.arySys.length;
			var data=this.talkSession.arySys [len-1];
			this.remary.push(data);
			}else{
			len=this.talkSession.arySys.length;
			data=this.talkSession.arySys [len-1]
			this.addData(data.getSysHtml());
		}
	}

	return SystemT;
})(View)


//class ui.SLGGAME.liaotianUI extends laya.ui.View
var liaotianUI=(function(_super){
	function liaotianUI(){
		this.di=null;
		this.img0=null;
		this.fasong=null;
		this.shezhi=null;
		this.tab0=null;
		this.txt0=null;
		liaotianUI.__super.call(this);
	}

	__class(liaotianUI,'ui.SLGGAME.liaotianUI',_super);
	var __proto=liaotianUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/liaotian");
	}

	return liaotianUI;
})(View)


//class huamao.panel.talk.TeamT extends laya.ui.View
var TeamT=(function(_super){
	function TeamT(){
		this.panel=null;
		this.remY=0;
		this.count=0;
		this.talkSession=null;
		this.remary=null;
		this.ifinit=true;
		this.framloop=null;
		this.remCell=[];
		TeamT.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TeamT,'huamao.panel.talk.TeamT',_super);
	var __proto=TeamT.prototype;
	Laya.imps(__proto,{"huamao.panel.talk.PanelInterface":true})
	__proto.init=function(){
		this.panel=new Panel();
		this.addChild(this.panel);
		this.panel.pos(3,3);
		this.panel.size(TalkPanel.PANEL_W,TalkPanel.PANEL_H);
		this.panel.vScrollBarSkin="";
		this.initAllData()
	}

	__proto.resetAllContent=function(){
		this.initAllData()
	}

	__proto.clearAllContent=function(){
		this.panel.removeChildren();
		this.remCell.length=0;
		this.remY=0;
		this.remary=[];
		this.ifinit=true;
		this.framloop.stop();
		this.framloop=null;
	}

	__proto.addData=function(data){
		var cell=new OtherCell(data);
		var curY=0;
		if(this.remCell.length >=TalkSession.MAXSIZE){
			var fistCell=this.remCell.shift();
			var fistH=fistCell.height;
			fistCell.removeSelf();
			for(var i=0;i<this.remCell.length;i++){
				var cellt=this.remCell [i];
				cellt.y-=fistH;
			}
		}
		if(this.remCell.length > 0){
			var lastCell=(this.remCell [this.remCell.length-1]);
			curY=lastCell.y+lastCell.height;
		}
		cell.pos(0,curY);
		this.remCell.push(cell);
		this.panel.addChild(cell);
		this.panel.vScrollBar.setScroll(0,this.panel.contentHeight,this.panel.contentHeight);
	}

	__proto.initAllData=function(){
		this.remary=this.talkSession.aryTeam.concat();
		this.framloop=new FramLoad(3,this.remary,new Handler(this,this.doCB),new Handler(this,this.overCB));
	}

	__proto.doCB=function(_data){
		var data=_data;
		this.addData(data);
	}

	__proto.overCB=function(){
		this.ifinit=false;
	}

	__proto.flushPanel=function(){
		var len=this.talkSession.aryTeam.length;
		if(this.ifinit){
			this.remary.push(this.talkSession.aryTeam[len-1]);
			}else{
			this.addData(this.talkSession.aryTeam[len-1]);
		}
	}

	return TeamT;
})(View)


//class huamao.panel.talk.WordT extends laya.ui.View
var WordT=(function(_super){
	function WordT(){
		this.panel=null;
		this.remY=0;
		this.count=0;
		this.talkSession=null;
		this.mainPlayerSession=null;
		this.remary=null;
		this.ifinit=true;
		this.framloop=null;
		this.remCell=[];
		WordT.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(WordT,'huamao.panel.talk.WordT',_super);
	var __proto=WordT.prototype;
	Laya.imps(__proto,{"huamao.panel.talk.PanelInterface":true})
	__proto.init=function(){
		this.panel=new Panel();
		this.addChild(this.panel);
		this.panel.pos(3,3);
		this.panel.size(TalkPanel.PANEL_W,TalkPanel.PANEL_H);
		this.panel.vScrollBarSkin="";
		this.initAllData()
	}

	__proto.resetAllContent=function(){
		this.initAllData()
	}

	__proto.clearAllContent=function(){
		this.panel.removeChildren();
		this.remCell.length=0;
		this.remY=0;
		this.remary=[];
		this.ifinit=true;
		this.framloop.stop();
		this.framloop=null;
	}

	__proto.addData=function(data){
		var cell=new OtherCell(data);
		var curY=0;
		if(this.remCell.length >=TalkSession.MAXSIZE){
			var fistCell=this.remCell.shift();
			var fistH=fistCell.height;
			fistCell.removeSelf();
			for(var i=0;i<this.remCell.length;i++){
				var cellt=this.remCell [i];
				cellt.y-=fistH;
			}
		}
		if(this.remCell.length > 0){
			var lastCell=(this.remCell [this.remCell.length-1]);
			curY=lastCell.y+lastCell.height;
		}
		cell.pos(0,curY);
		this.remCell.push(cell);
		this.panel.addChild(cell);
		this.panel.vScrollBar.setScroll(0,this.panel.contentHeight,this.panel.contentHeight);
	}

	__proto.initAllData=function(){
		this.remary=this.talkSession.aryWord.concat();
		this.framloop=new FramLoad(3,this.remary,new Handler(this,this.doCB),new Handler(this,this.overCB));
	}

	__proto.doCB=function(_data){
		var data=_data;
		this.addData(data);
	}

	__proto.overCB=function(){
		this.ifinit=false;
	}

	__proto.flushPanel=function(){
		var len=this.talkSession.aryWord.length;
		if(this.ifinit){
			this.remary.push(this.talkSession.aryWord[len-1]);
			}else{
			this.addData(this.talkSession.aryWord[len-1]);
		}
	}

	return WordT;
})(View)


//class ui.SLGGAME.renwu_0UI extends laya.ui.View
var renwu_0UI=(function(_super){
	function renwu_0UI(){
		this.di=null;
		this.img0=null;
		renwu_0UI.__super.call(this);
	}

	__class(renwu_0UI,'ui.SLGGAME.renwu_0UI',_super);
	var __proto=renwu_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/renwu_0");
	}

	return renwu_0UI;
})(View)


//class ui.SLGGAME.lianmeng_lb_12UI extends laya.ui.View
var lianmeng_lb_12UI=(function(_super){
	function lianmeng_lb_12UI(){
		this.chuangjian=null;
		this.mingcheng=null;
		this.jin=null;
		this.xuanqi=null;
		lianmeng_lb_12UI.__super.call(this);
	}

	__class(lianmeng_lb_12UI,'ui.SLGGAME.lianmeng_lb_12UI',_super);
	var __proto=lianmeng_lb_12UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/lianmeng_lb_12");
	}

	return lianmeng_lb_12UI;
})(View)


//class ui.lianmeng_dongtai_1UI extends laya.ui.View
var lianmeng_dongtai_1UI=(function(_super){
	function lianmeng_dongtai_1UI(){
		this.qiming=null;
		lianmeng_dongtai_1UI.__super.call(this);
	}

	__class(lianmeng_dongtai_1UI,'ui.lianmeng_dongtai_1UI',_super);
	var __proto=lianmeng_dongtai_1UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("HTMLDivElement",HTMLDivElement);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_dongtai_1");
	}

	return lianmeng_dongtai_1UI;
})(View)


//class ui.lianmeng_1_1UI extends laya.ui.View
var lianmeng_1_1UI=(function(_super){
	function lianmeng_1_1UI(){
		this.btn0=null;
		this.yin1=null;
		this.jianti=null;
		this.box0=null;
		this.box1=null;
		this.shu=null;
		this.wu1=null;
		this.wu2=null;
		this.di=null;
		lianmeng_1_1UI.__super.call(this);
	}

	__class(lianmeng_1_1UI,'ui.lianmeng_1_1UI',_super);
	var __proto=lianmeng_1_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_1_1");
	}

	return lianmeng_1_1UI;
})(View)


//class ui.lianmeng_lb_1UI extends laya.ui.View
var lianmeng_lb_1UI=(function(_super){
	function lianmeng_lb_1UI(){
		this.di0=null;
		this.dengji0=null;
		this.name0=null;
		this.weizhi0=null;
		this.shu0=null;
		this.box0=null;
		this.qiB=null;
		lianmeng_lb_1UI.__super.call(this);
	}

	__class(lianmeng_lb_1UI,'ui.lianmeng_lb_1UI',_super);
	var __proto=lianmeng_lb_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_lb_1");
	}

	return lianmeng_lb_1UI;
})(View)


//class ui.SLGGAME.lianmeng_lixianUI extends laya.ui.View
var lianmeng_lixianUI=(function(_super){
	function lianmeng_lixianUI(){
		this.ming=null;
		this.deng=null;
		this.zhi=null;
		this.dang=null;
		this.li=null;
		this.btn0=null;
		this.zhu=null;
		lianmeng_lixianUI.__super.call(this);
	}

	__class(lianmeng_lixianUI,'ui.SLGGAME.lianmeng_lixianUI',_super);
	var __proto=lianmeng_lixianUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/lianmeng_lixian");
	}

	return lianmeng_lixianUI;
})(View)


//class ui.lianmeng_qizhi_1UI extends laya.ui.View
var lianmeng_qizhi_1UI=(function(_super){
	function lianmeng_qizhi_1UI(){
		this.xuan=null;
		this.dang=null;
		lianmeng_qizhi_1UI.__super.call(this);
	}

	__class(lianmeng_qizhi_1UI,'ui.lianmeng_qizhi_1UI',_super);
	var __proto=lianmeng_qizhi_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_qizhi_1");
	}

	return lianmeng_qizhi_1UI;
})(View)


//class ui.lianmeng_sq_1UI extends laya.ui.View
var lianmeng_sq_1UI=(function(_super){
	function lianmeng_sq_1UI(){
		this.dengji=null;
		this.name0=null;
		this.guan=null;
		this.time0=null;
		this.no0=null;
		this.yes0=null;
		lianmeng_sq_1UI.__super.call(this);
	}

	__class(lianmeng_sq_1UI,'ui.lianmeng_sq_1UI',_super);
	var __proto=lianmeng_sq_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_sq_1");
	}

	return lianmeng_sq_1UI;
})(View)


//class ui.lianmeng_sd_1UI extends laya.ui.View
var lianmeng_sd_1UI=(function(_super){
	function lianmeng_sd_1UI(){
		this.di=null;
		this.btn0=null;
		this.box_0=null;
		this.sheng=null;
		this.name0=null;
		this.shi=null;
		lianmeng_sd_1UI.__super.call(this);
	}

	__class(lianmeng_sd_1UI,'ui.lianmeng_sd_1UI',_super);
	var __proto=lianmeng_sd_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_sd_1");
	}

	return lianmeng_sd_1UI;
})(View)


//class ui.lianmeng_shuoming_1UI extends laya.ui.View
var lianmeng_shuoming_1UI=(function(_super){
	function lianmeng_shuoming_1UI(){
		this.dengji=null;
		this.xujing=null;
		this.fumeng=null;
		this.renshu=null;
		lianmeng_shuoming_1UI.__super.call(this);
	}

	__class(lianmeng_shuoming_1UI,'ui.lianmeng_shuoming_1UI',_super);
	var __proto=lianmeng_shuoming_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_shuoming_1");
	}

	return lianmeng_shuoming_1UI;
})(View)


//class ui.huiyuanfuwo_1UI extends laya.ui.View
var huiyuanfuwo_1UI=(function(_super){
	function huiyuanfuwo_1UI(){
		this.zi=null;
		this.kuang=null;
		this.qian=null;
		this.kuang1=null;
		this.kuang2=null;
		huiyuanfuwo_1UI.__super.call(this);
	}

	__class(huiyuanfuwo_1UI,'ui.huiyuanfuwo_1UI',_super);
	var __proto=huiyuanfuwo_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("huiyuanfuwo_1");
	}

	return huiyuanfuwo_1UI;
})(View)


//class ui.SLGGAME.waijiao_0UI extends laya.ui.View
var waijiao_0UI=(function(_super){
	function waijiao_0UI(){
		this.name0=null;
		this.txt0=null;
		this.txt_name=null;
		this.img1=null;
		this.box0=null;
		this.touxiang=null;
		this.guanzhi0=null;
		this.cheng0=null;
		this.didui0=null;
		this.guanzhi=null;
		this.cheng=null;
		this.didui=null;
		this.dengji=null;
		this.shenqing=null;
		this.tongmeng=null;
		this.choudi=null;
		this.baijing=null;
		waijiao_0UI.__super.call(this);
	}

	__class(waijiao_0UI,'ui.SLGGAME.waijiao_0UI',_super);
	var __proto=waijiao_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/waijiao_0");
	}

	return waijiao_0UI;
})(View)


//class ui.SLGGAME.wujiang0_3_1UI extends laya.ui.View
var wujiang0_3_1UI=(function(_super){
	function wujiang0_3_1UI(){
		this.daquan=null;
		this.huadong=null;
		this.ii=null;
		this.ll=null;
		wujiang0_3_1UI.__super.call(this);
	}

	__class(wujiang0_3_1UI,'ui.SLGGAME.wujiang0_3_1UI',_super);
	var __proto=wujiang0_3_1UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.wujiang0_3UI",wujiang0_3UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_3_1");
	}

	return wujiang0_3_1UI;
})(View)


//class ui.SLGGAME.wujiang0_1UI extends laya.ui.View
var wujiang0_1UI=(function(_super){
	function wujiang0_1UI(){
		this.tu=null;
		this.bar0=null;
		this.txt_bar0=null;
		this.shengji=null;
		this.tip1=null;
		this.txt1=null;
		this.chengzhanga=null;
		this.jinjie=null;
		this.xing=null;
		this.wei0=null;
		this.yu0=null;
		this.yong0=null;
		this.zhi0=null;
		this.txt3=null;
		this.box3=null;
		this.box2=null;
		this.box1=null;
		this.reset=null;
		wujiang0_1UI.__super.call(this);
	}

	__class(wujiang0_1UI,'ui.SLGGAME.wujiang0_1UI',_super);
	var __proto=wujiang0_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_1");
	}

	return wujiang0_1UI;
})(View)


//class ui.SLGGAME.wujiang0_4UI extends laya.ui.View
var wujiang0_4UI=(function(_super){
	function wujiang0_4UI(){
		this.box1=null;
		this.txt0=null;
		this.meika1=null;
		this.wenhao=null;
		this.zhujiang=null;
		this.meika0=null;
		this.box0=null;
		this.txt_b=null;
		this.chakan=null;
		this.tuijian=null;
		wujiang0_4UI.__super.call(this);
	}

	__class(wujiang0_4UI,'ui.SLGGAME.wujiang0_4UI',_super);
	var __proto=wujiang0_4UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.chuzheng_1UI",chuzheng_1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_4");
	}

	return wujiang0_4UI;
})(View)


//class ui.SLGGAME.wujiang0_2UI extends laya.ui.View
var wujiang0_2UI=(function(_super){
	function wujiang0_2UI(){
		this.txt0=null;
		this.txt_bt=null;
		this.huo=null;
		this.html0=null;
		wujiang0_2UI.__super.call(this);
	}

	__class(wujiang0_2UI,'ui.SLGGAME.wujiang0_2UI',_super);
	var __proto=wujiang0_2UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("HTMLDivElement",HTMLDivElement);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_2");
	}

	return wujiang0_2UI;
})(View)


//class huamao.panel.cityBudui.BuduiList extends laya.ui.List
var BuduiList=(function(_super){
	function BuduiList(){
		this.isDrag=false;
		this.mapCityAction=null;
		this.mapCitySession=null;
		this._cityData=null;
		this._isLongDown=false;
		this._count=0;
		this._fromItemCopy=null;
		this._toItemCopy=null;
		this._fromItem=null;
		this._toItem=null;
		this._tempX=NaN;
		this._tempY=NaN;
		this._tmpRect=null;
		BuduiList.__super.call(this);
		App.injOne(this);
		this.itemRender=CityBuduiItem;
		this.repeatX=6;
		this.repeatY=2;
		this.spaceX=4;
		this.spaceY=5;
		this.pos(25,121);
		this.renderHandler=new Handler(this,this.updateItem);
		this.vScrollBarSkin="";
		this._fromItemCopy=new CityBuduiItem();
		this._toItemCopy=new CityBuduiItem();
		this.on("mousedown",this,this.onMouseDown);
		this.on("mouseup",this,this.onMouseUp);
		this.on("mouseout",this,this._$6_onMouseOut);
	}

	__class(BuduiList,'huamao.panel.cityBudui.BuduiList',_super);
	var __proto=BuduiList.prototype;
	__proto.onMouseDown=function(e){
		if(!this.isDrag){
			return;
		}
		if((e.target instanceof huamao.panel.cityBudui.CityBuduiItem )){
			this._tempX=Laya.stage.mouseX;
			this._tempY=Laya.stage.mouseY;
			Laya.timer.clear(this,this.onKa);
			Laya.timer.once(1000,this,this.onKa,[e.target]);
		}
	}

	__proto.onKa=function(item){
		if(!this.isDrag){
			return;
		}
		if(this._tempX==Laya.stage.mouseX && this._tempY==Laya.stage.mouseY){
			this._fromItem=this._toItem=null;
			this._fromItem=item;
			this._isLongDown=true;
			this._fromItem.visible=false;
			this._fromItemCopy.update(this._fromItem.heroData,this._fromItem.cityBuildData);
			this._fromItemCopy.scale(1.2,1.2);
			this._fromItemCopy.pos(this._fromItem.x-0.1 *this._fromItem.width,this._fromItem.y-0.1 *this._fromItem.height);
			this.content.addChild(this._fromItemCopy);
			this._fromItemCopy.startDrag();
		}
	}

	__proto._$6_onMouseOut=function(){
		if(!this.isDrag){
			return;
		}
		if(this._isLongDown){
			this.onUp();
		}
	}

	__proto.onMouseUp=function(e){
		if(!this.isDrag){
			if((e.target instanceof huamao.panel.cityBudui.CityBuduiItem )){
				var item=e.target;
				item && item.openPanel(this.array);
			}
			return;
		}
		if(this._isLongDown){
			this.onUp();
		}
		else{
			Laya.timer.clear(this,this.onKa);
			if((e.target instanceof huamao.panel.cityBudui.CityBuduiItem )){
				item=e.target;
				item && item.openPanel(this.array);
			}
		}
	}

	__proto.onScrollBarChange=function(e){
		if(this._isLongDown){
			return;
		}
		_super.prototype.onScrollBarChange.call(this,e);
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource,this._cityData);
	}

	__proto.swap=function(hero1,hero2){
		this.changeItem(hero1.index,hero1);
		this.changeItem(hero2.index,hero2);
		console.log("武将互换位置===========",hero1.index,hero2.index);
	}

	__proto.updateList=function(arr,cityData){
		if(this._isLongDown){
			return;
		}
		this._cityData=cityData;
		this.array=arr;
		console.log("刷新部队列表");
	}

	__proto.onUp=function(){
		if(!this.isDrag){
			return;
		}
		console.log("鼠标抬起");
		var p=this.content.getMousePoint();
		var item;
		for(var $each_item in this.cells){
			item=this.cells[$each_item];
			this._tmpRect=new Rectangle(item.x,item.y,item.width,item.height);
			if(this._tmpRect.contains(p.x,p.y)){
				this._toItem=item;
				break ;
			}
		}
		this._fromItemCopy.scale(1,1);
		this._fromItemCopy.stopDrag();
		if(this._toItem==null){
			Tween.to(this._fromItemCopy,{x:this._fromItem.x,y:this._fromItem.y},100,null,new Handler(this,this.onHuiqu));
			return;
		}
		if(this._fromItemCopy.heroData.heroId==this._toItem.heroData.heroId){
			Tween.to(this._fromItemCopy,{x:this._fromItem.x,y:this._fromItem.y},this.getDelay(),null,new Handler(this,this.onHuiqu));
			return;
		}
		if(this._fromItem.heroData.soldier==0 || this._toItem.heroData.soldier==0){
			FlyUpTips.setTips("请与已经配过兵的武将交换");
			Tween.to(this._fromItemCopy,{x:this._fromItem.x,y:this._fromItem.y},this.getDelay(),null,new Handler(this,this.onHuiqu));
			return;
		}
		this._fromItemCopy.pos(this._toItem.x,this._toItem.y);
		this._toItemCopy.update(this._toItem.heroData,this._toItem.cityBuildData);
		this._toItemCopy.pos(this._toItem.x,this._toItem.y);
		this.content.addChild(this._toItemCopy);
		var fromIndex=this._fromItemCopy.heroData.index;
		var toIndex=this._toItemCopy.heroData.index;
		this._fromItemCopy.heroData.index=toIndex;
		this._toItemCopy.heroData.index=fromIndex;
		this.array[fromIndex]=this._toItemCopy.heroData;
		this.array[toIndex]=this._fromItemCopy.heroData;
		this.renderItem(this._fromItem,fromIndex);
		this.renderItem(this._toItem,toIndex);
		this._fromItem.visible=this._toItem.visible=false;
		console.log("互换的信息",this._fromItem.heroData.sysHero.heroName,this._toItem.heroData.sysHero.heroName);
		Tween.to(this._toItemCopy,{x:this._fromItem.x,y:this._fromItem.y},this.getDelay(),null,new Handler(this,this.onsend));
	}

	__proto.onHuiqu=function(){
		this._fromItemCopy.removeSelf();
		this._fromItem.visible=true;
		Laya.timer.once(300,this,this.resetState);
	}

	__proto.getDelay=function(){
		var deltaX=this._toItem.x-this._fromItem.x;
		var deltaY=this._toItem.y-this._fromItem.y;
		var distance=Math.sqrt(deltaX *deltaX+deltaY *deltaY);
		var delay=parseInt(distance+"")*0.5;
		return delay;
	}

	__proto.onsend=function(){
		this._fromItemCopy.removeSelf();
		this._toItemCopy.removeSelf();
		this._fromItem.visible=this._toItem.visible=true;
		this.mapCityAction.onSwapHero(this._cityData.cityId,this._fromItem.heroData.index,this._toItem.heroData.index);
		Laya.timer.once(300,this,this.resetState);
	}

	__proto.resetState=function(){
		this._isLongDown=false;
	}

	return BuduiList;
})(List)


//class ui.SLGGAME.wujiang_ka1UI extends laya.ui.View
var wujiang_ka1UI=(function(_super){
	function wujiang_ka1UI(){
		this.wujiangming=null;
		wujiang_ka1UI.__super.call(this);
	}

	__class(wujiang_ka1UI,'ui.SLGGAME.wujiang_ka1UI',_super);
	var __proto=wujiang_ka1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_ka1");
	}

	return wujiang_ka1UI;
})(View)


//class ui.SLGGAME.map_xjlb0UI extends laya.ui.View
var map_xjlb0UI=(function(_super){
	function map_xjlb0UI(){
		this.c1=null;
		this.c2=null;
		this.img0=null;
		this.jiantou=null;
		this.btn0=null;
		this.time0=null;
		map_xjlb0UI.__super.call(this);
	}

	__class(map_xjlb0UI,'ui.SLGGAME.map_xjlb0UI',_super);
	var __proto=map_xjlb0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map_xjlb0");
	}

	return map_xjlb0UI;
})(View)


//class ui.SLGGAME.map_xjlb0_1UI extends laya.ui.View
var map_xjlb0_1UI=(function(_super){
	function map_xjlb0_1UI(){
		this.txt0=null;
		this.txt1=null;
		map_xjlb0_1UI.__super.call(this);
	}

	__class(map_xjlb0_1UI,'ui.SLGGAME.map_xjlb0_1UI',_super);
	var __proto=map_xjlb0_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map_xjlb0_1");
	}

	return map_xjlb0_1UI;
})(View)


//class ui.tips_fenxiang_0UI extends laya.ui.View
var tips_fenxiang_0UI=(function(_super){
	function tips_fenxiang_0UI(){
		this.wanjia=null;
		this.wanjiajia=null;
		tips_fenxiang_0UI.__super.call(this);
	}

	__class(tips_fenxiang_0UI,'ui.tips_fenxiang_0UI',_super);
	var __proto=tips_fenxiang_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("tips_fenxiang_0");
	}

	return tips_fenxiang_0UI;
})(View)


//class ui.zhanbao_shoucang01UI extends laya.ui.View
var zhanbao_shoucang01UI=(function(_super){
	function zhanbao_shoucang01UI(){
		this.shengbai=null;
		this.jin=null;
		this.shijian=null;
		this.wanjia=null;
		this.difang=null;
		this.zhanbao=null;
		zhanbao_shoucang01UI.__super.call(this);
	}

	__class(zhanbao_shoucang01UI,'ui.zhanbao_shoucang01UI',_super);
	var __proto=zhanbao_shoucang01UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("zhanbao_shoucang01");
	}

	return zhanbao_shoucang01UI;
})(View)


//class ui.SLGGAME.zhanbao_zdtj0UI extends laya.ui.View
var zhanbao_zdtj0UI=(function(_super){
	function zhanbao_zdtj0UI(){
		this.ka=null;
		this.img0=null;
		this.txt0=null;
		this.txt2=null;
		this.txt1=null;
		this.bar0=null;
		this.shu0=null;
		this.bar1=null;
		this.shu1=null;
		this.bar2=null;
		this.shu2=null;
		zhanbao_zdtj0UI.__super.call(this);
	}

	__class(zhanbao_zdtj0UI,'ui.SLGGAME.zhanbao_zdtj0UI',_super);
	var __proto=zhanbao_zdtj0UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.chuzhengkaUI",chuzhengkaUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhanbao_zdtj0");
	}

	return zhanbao_zdtj0UI;
})(View)


//class ui.SLGGAME.zhaomu_jl0UI extends laya.ui.View
var zhaomu_jl0UI=(function(_super){
	function zhaomu_jl0UI(){
		this.txt0=null;
		this.txt1=null;
		this.list0=null;
		this.v0=null;
		zhaomu_jl0UI.__super.call(this);
	}

	__class(zhaomu_jl0UI,'ui.SLGGAME.zhaomu_jl0UI',_super);
	var __proto=zhaomu_jl0UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.chuzhengkaUI",chuzhengkaUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhaomu_jl0");
	}

	return zhaomu_jl0UI;
})(View)


//class huamao.panel.haoyou.youjian.BattleList extends laya.ui.List
var BattleList=(function(_super){
	function BattleList(){
		this._curItem=null;
		this.selfFilter=new GlowFilter("#00ff00",4,0,0);
		BattleList.__super.call(this);
		this.itemRender=BattleItem;
		this.repeatX=1;
		this.repeatY=12;
		this.spaceX=12;
		this.spaceY=10;
		this.pos(68,10);
		this.renderHandler=new Handler(this,this.updateItem);
		this.vScrollBarSkin="";
	}

	__class(BattleList,'huamao.panel.haoyou.youjian.BattleList',_super);
	var __proto=BattleList.prototype;
	__proto.clearSelectItem=function(){
		if(this._curItem){
			this._curItem.isSelect=false;
		}
	}

	__proto.selectItem=function(item){
		if(this._curItem){
			this._curItem.isSelect=false;
		}
		this._curItem=item;
		this._curItem.isSelect=true;
	}

	__proto.getItemById=function(pId){
		var item;
		for(var $each_item in this.cells){
			item=this.cells[$each_item];
			if(item.playerId==pId){
				return item;
			}
		}
		return null;
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	__proto.update=function(arr){
		this.array=arr;
	}

	return BattleList;
})(List)


//class ui.SLGGAME.zhaomukaUI extends laya.ui.View
var zhaomukaUI=(function(_super){
	function zhaomukaUI(){
		this.di=null;
		this.renwu=null;
		this.tiao=null;
		this.dengji=null;
		this.wujiangming=null;
		this.zy=null;
		this.yong=null;
		this.yu=null;
		this.zhi=null;
		this.wei=null;
		this.wk=null;
		zhaomukaUI.__super.call(this);
	}

	__class(zhaomukaUI,'ui.SLGGAME.zhaomukaUI',_super);
	var __proto=zhaomukaUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.wujiangka_daUI",wujiangka_daUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhaomuka");
	}

	return zhaomukaUI;
})(View)


//class ui.SLGGAME.npc_yqhy0UI extends laya.ui.View
var npc_yqhy0UI=(function(_super){
	function npc_yqhy0UI(){
		this.btn0=null;
		this.namr0=null;
		this.txto=null;
		this.box0=null;
		this.yaoqing=null;
		this.yqh=null;
		npc_yqhy0UI.__super.call(this);
	}

	__class(npc_yqhy0UI,'ui.SLGGAME.npc_yqhy0UI',_super);
	var __proto=npc_yqhy0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/npc_yqhy0");
	}

	return npc_yqhy0UI;
})(View)


//class ui.SLGGAME.loadingUI extends laya.ui.View
var loadingUI=(function(_super){
	function loadingUI(){
		this.txt1=null;
		this.bar0=null;
		this.suibian=null;
		loadingUI.__super.call(this);
	}

	__class(loadingUI,'ui.SLGGAME.loadingUI',_super);
	var __proto=loadingUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/loading");
	}

	return loadingUI;
})(View)


//class ui.SLGGAME.icon_cheng0_tipsUI extends laya.ui.View
var icon_cheng0_tipsUI=(function(_super){
	function icon_cheng0_tipsUI(){
		this.b1=null;
		this.b2=null;
		this.b3=null;
		icon_cheng0_tipsUI.__super.call(this);
	}

	__class(icon_cheng0_tipsUI,'ui.SLGGAME.icon_cheng0_tipsUI',_super);
	var __proto=icon_cheng0_tipsUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_cheng0_tips");
	}

	return icon_cheng0_tipsUI;
})(View)


//class ui.SLGGAME.cityInfoUI extends laya.ui.View
var cityInfoUI=(function(_super){
	function cityInfoUI(){
		this.jinbu=null;
		this.zhenqing=null;
		this.info=null;
		this.txt0=null;
		cityInfoUI.__super.call(this);
	}

	__class(cityInfoUI,'ui.SLGGAME.cityInfoUI',_super);
	var __proto=cityInfoUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.map_0aUI",map_0aUI);
		View.regComponent("ui.SLGGAME.map_0bUI",map_0bUI);
		View.regComponent("ui.SLGGAME.map_0dUI",map_0dUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/cityInfo");
	}

	return cityInfoUI;
})(View)


//class ui.SLGGAME.icon_cheng0UI extends laya.ui.View
var icon_cheng0UI=(function(_super){
	function icon_cheng0UI(){
		this.bb0=null;
		this.bb1=null;
		this.bb2=null;
		this.b0=null;
		this.bb3=null;
		this.bb4=null;
		this.box_task=null;
		this.check1=null;
		this.check2=null;
		this.box_check2=null;
		this.Txtcheck2=null;
		this.bb5=null;
		this.name0=null;
		this.b8=null;
		this.b9=null;
		this.b5=null;
		this.b6=null;
		this.b3=null;
		this.b4=null;
		this.b1=null;
		this.b2=null;
		this.b10=null;
		this.b7=null;
		this.buildName1=null;
		this.buildName5=null;
		this.buildName6=null;
		this.buildName2=null;
		this.buildName7=null;
		this.buildName3=null;
		this.buildName4=null;
		this.buildName8=null;
		this.buildName9=null;
		this.buildName10=null;
		this.time1=null;
		this.b1bei=null;
		this.shijian1=null;
		this.time2=null;
		this.b2bei=null;
		this.shijian2=null;
		this.time3=null;
		this.shijian3=null;
		this.time4=null;
		this.shijian4=null;
		this.time5=null;
		this.shijian5=null;
		this.time6=null;
		this.shijian6=null;
		this.time7=null;
		this.shijian7=null;
		this.time8=null;
		this.shijian8=null;
		this.time9=null;
		this.shijian9=null;
		this.time10=null;
		this.shijian10=null;
		this.time0=null;
		this.shijian0=null;
		this.chuizi0=null;
		this.chuizi1=null;
		this.chuizi2=null;
		this.chuizi3=null;
		this.chuizi4=null;
		this.chuizi5=null;
		this.chuizi6=null;
		this.chuizi7=null;
		this.chuizi8=null;
		this.chuizi9=null;
		this.chuizi10=null;
		icon_cheng0UI.__super.call(this);
	}

	__class(icon_cheng0UI,'ui.SLGGAME.icon_cheng0UI',_super);
	var __proto=icon_cheng0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_cheng0");
	}

	return icon_cheng0UI;
})(View)


//class ui.SLGGAME.npcUI extends laya.ui.View
var npcUI=(function(_super){
	function npcUI(){
		this.img0=null;
		this.meinv=null;
		npcUI.__super.call(this);
	}

	__class(npcUI,'ui.SLGGAME.npcUI',_super);
	var __proto=npcUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/npc");
	}

	return npcUI;
})(View)


//class ui.SLGGAME.npc_0UI extends laya.ui.View
var npc_0UI=(function(_super){
	function npc_0UI(){
		this.dituae=null;
		this.shu0=null;
		this.rightBtn=null;
		this.leftBtn=null;
		this.zudui=null;
		this.kaishi=null;
		this.fanhui=null;
		this.tips0=null;
		this.guanzhia=null;
		this.zhiyou=null;
		npc_0UI.__super.call(this);
	}

	__class(npc_0UI,'ui.SLGGAME.npc_0UI',_super);
	var __proto=npc_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/npc_0");
	}

	return npc_0UI;
})(View)


//class ui.SLGGAME.LoginUI extends laya.ui.View
var LoginUI=(function(_super){
	function LoginUI(){
		this.ani1=null;
		this.haoBtn=null;
		this.goBtn=null;
		this.gaoBtn=null;
		this.zhanghao=null;
		this.xuanfu=null;
		this.fu=null;
		this.sao=null;
		LoginUI.__super.call(this);
	}

	__class(LoginUI,'ui.SLGGAME.LoginUI',_super);
	var __proto=LoginUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/Login");
	}

	return LoginUI;
})(View)


//class ui.ANI.skillAni.buff.buffDischargeUI extends laya.ui.View
var buffDischargeUI=(function(_super){
	function buffDischargeUI(){
		buffDischargeUI.__super.call(this);;
	}

	__class(buffDischargeUI,'ui.ANI.skillAni.buff.buffDischargeUI',_super);
	var __proto=buffDischargeUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffDischarge");
	}

	return buffDischargeUI;
})(View)


//class ui.ANI.skillAni.buff.buffDischarge_1UI extends laya.ui.View
var buffDischarge_1UI=(function(_super){
	function buffDischarge_1UI(){
		buffDischarge_1UI.__super.call(this);;
	}

	__class(buffDischarge_1UI,'ui.ANI.skillAni.buff.buffDischarge_1UI',_super);
	var __proto=buffDischarge_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffDischarge_1");
	}

	return buffDischarge_1UI;
})(View)


//class ui.ANI.skillAni.buff.buffHurt1UI extends laya.ui.View
var buffHurt1UI=(function(_super){
	function buffHurt1UI(){
		buffHurt1UI.__super.call(this);;
	}

	__class(buffHurt1UI,'ui.ANI.skillAni.buff.buffHurt1UI',_super);
	var __proto=buffHurt1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffHurt1");
	}

	return buffHurt1UI;
})(View)


//class ui.ANI.skillAni.buff.buffhurt2UI extends laya.ui.View
var buffhurt2UI=(function(_super){
	function buffhurt2UI(){
		buffhurt2UI.__super.call(this);;
	}

	__class(buffhurt2UI,'ui.ANI.skillAni.buff.buffhurt2UI',_super);
	var __proto=buffhurt2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffhurt2");
	}

	return buffhurt2UI;
})(View)


//class ui.ANI.skillAni.buff.buffhurt3UI extends laya.ui.View
var buffhurt3UI=(function(_super){
	function buffhurt3UI(){
		buffhurt3UI.__super.call(this);;
	}

	__class(buffhurt3UI,'ui.ANI.skillAni.buff.buffhurt3UI',_super);
	var __proto=buffhurt3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffhurt3");
	}

	return buffhurt3UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat10UI extends laya.ui.View
var buffSeat10UI=(function(_super){
	function buffSeat10UI(){
		buffSeat10UI.__super.call(this);;
	}

	__class(buffSeat10UI,'ui.ANI.skillAni.buff.buffSeat10UI',_super);
	var __proto=buffSeat10UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat10");
	}

	return buffSeat10UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat11UI extends laya.ui.View
var buffSeat11UI=(function(_super){
	function buffSeat11UI(){
		buffSeat11UI.__super.call(this);;
	}

	__class(buffSeat11UI,'ui.ANI.skillAni.buff.buffSeat11UI',_super);
	var __proto=buffSeat11UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat11");
	}

	return buffSeat11UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat12UI extends laya.ui.View
var buffSeat12UI=(function(_super){
	function buffSeat12UI(){
		buffSeat12UI.__super.call(this);;
	}

	__class(buffSeat12UI,'ui.ANI.skillAni.buff.buffSeat12UI',_super);
	var __proto=buffSeat12UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat12");
	}

	return buffSeat12UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat13UI extends laya.ui.View
var buffSeat13UI=(function(_super){
	function buffSeat13UI(){
		buffSeat13UI.__super.call(this);;
	}

	__class(buffSeat13UI,'ui.ANI.skillAni.buff.buffSeat13UI',_super);
	var __proto=buffSeat13UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat13");
	}

	return buffSeat13UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat14UI extends laya.ui.View
var buffSeat14UI=(function(_super){
	function buffSeat14UI(){
		buffSeat14UI.__super.call(this);;
	}

	__class(buffSeat14UI,'ui.ANI.skillAni.buff.buffSeat14UI',_super);
	var __proto=buffSeat14UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat14");
	}

	return buffSeat14UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat15UI extends laya.ui.View
var buffSeat15UI=(function(_super){
	function buffSeat15UI(){
		buffSeat15UI.__super.call(this);;
	}

	__class(buffSeat15UI,'ui.ANI.skillAni.buff.buffSeat15UI',_super);
	var __proto=buffSeat15UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat15");
	}

	return buffSeat15UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat16UI extends laya.ui.View
var buffSeat16UI=(function(_super){
	function buffSeat16UI(){
		buffSeat16UI.__super.call(this);;
	}

	__class(buffSeat16UI,'ui.ANI.skillAni.buff.buffSeat16UI',_super);
	var __proto=buffSeat16UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat16");
	}

	return buffSeat16UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat17UI extends laya.ui.View
var buffSeat17UI=(function(_super){
	function buffSeat17UI(){
		buffSeat17UI.__super.call(this);;
	}

	__class(buffSeat17UI,'ui.ANI.skillAni.buff.buffSeat17UI',_super);
	var __proto=buffSeat17UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat17");
	}

	return buffSeat17UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat18UI extends laya.ui.View
var buffSeat18UI=(function(_super){
	function buffSeat18UI(){
		buffSeat18UI.__super.call(this);;
	}

	__class(buffSeat18UI,'ui.ANI.skillAni.buff.buffSeat18UI',_super);
	var __proto=buffSeat18UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat18");
	}

	return buffSeat18UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat19UI extends laya.ui.View
var buffSeat19UI=(function(_super){
	function buffSeat19UI(){
		buffSeat19UI.__super.call(this);;
	}

	__class(buffSeat19UI,'ui.ANI.skillAni.buff.buffSeat19UI',_super);
	var __proto=buffSeat19UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat19");
	}

	return buffSeat19UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat1UI extends laya.ui.View
var buffSeat1UI=(function(_super){
	function buffSeat1UI(){
		buffSeat1UI.__super.call(this);;
	}

	__class(buffSeat1UI,'ui.ANI.skillAni.buff.buffSeat1UI',_super);
	var __proto=buffSeat1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat1");
	}

	return buffSeat1UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat20UI extends laya.ui.View
var buffSeat20UI=(function(_super){
	function buffSeat20UI(){
		buffSeat20UI.__super.call(this);;
	}

	__class(buffSeat20UI,'ui.ANI.skillAni.buff.buffSeat20UI',_super);
	var __proto=buffSeat20UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat20");
	}

	return buffSeat20UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat21UI extends laya.ui.View
var buffSeat21UI=(function(_super){
	function buffSeat21UI(){
		buffSeat21UI.__super.call(this);;
	}

	__class(buffSeat21UI,'ui.ANI.skillAni.buff.buffSeat21UI',_super);
	var __proto=buffSeat21UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat21");
	}

	return buffSeat21UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat2UI extends laya.ui.View
var buffSeat2UI=(function(_super){
	function buffSeat2UI(){
		buffSeat2UI.__super.call(this);;
	}

	__class(buffSeat2UI,'ui.ANI.skillAni.buff.buffSeat2UI',_super);
	var __proto=buffSeat2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat2");
	}

	return buffSeat2UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat3UI extends laya.ui.View
var buffSeat3UI=(function(_super){
	function buffSeat3UI(){
		buffSeat3UI.__super.call(this);;
	}

	__class(buffSeat3UI,'ui.ANI.skillAni.buff.buffSeat3UI',_super);
	var __proto=buffSeat3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat3");
	}

	return buffSeat3UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat4UI extends laya.ui.View
var buffSeat4UI=(function(_super){
	function buffSeat4UI(){
		buffSeat4UI.__super.call(this);;
	}

	__class(buffSeat4UI,'ui.ANI.skillAni.buff.buffSeat4UI',_super);
	var __proto=buffSeat4UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat4");
	}

	return buffSeat4UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat5UI extends laya.ui.View
var buffSeat5UI=(function(_super){
	function buffSeat5UI(){
		buffSeat5UI.__super.call(this);;
	}

	__class(buffSeat5UI,'ui.ANI.skillAni.buff.buffSeat5UI',_super);
	var __proto=buffSeat5UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat5");
	}

	return buffSeat5UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat6UI extends laya.ui.View
var buffSeat6UI=(function(_super){
	function buffSeat6UI(){
		buffSeat6UI.__super.call(this);;
	}

	__class(buffSeat6UI,'ui.ANI.skillAni.buff.buffSeat6UI',_super);
	var __proto=buffSeat6UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat6");
	}

	return buffSeat6UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat7UI extends laya.ui.View
var buffSeat7UI=(function(_super){
	function buffSeat7UI(){
		buffSeat7UI.__super.call(this);;
	}

	__class(buffSeat7UI,'ui.ANI.skillAni.buff.buffSeat7UI',_super);
	var __proto=buffSeat7UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat7");
	}

	return buffSeat7UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat8UI extends laya.ui.View
var buffSeat8UI=(function(_super){
	function buffSeat8UI(){
		buffSeat8UI.__super.call(this);;
	}

	__class(buffSeat8UI,'ui.ANI.skillAni.buff.buffSeat8UI',_super);
	var __proto=buffSeat8UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat8");
	}

	return buffSeat8UI;
})(View)


//class ui.ANI.skillAni.buff.buffSeat9UI extends laya.ui.View
var buffSeat9UI=(function(_super){
	function buffSeat9UI(){
		buffSeat9UI.__super.call(this);;
	}

	__class(buffSeat9UI,'ui.ANI.skillAni.buff.buffSeat9UI',_super);
	var __proto=buffSeat9UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/buffSeat9");
	}

	return buffSeat9UI;
})(View)


//class huamao.panel.worldMap.PlayerList extends laya.ui.List
var PlayerList=(function(_super){
	function PlayerList(){
		this._curItem=null;
		this.selfFilter=new GlowFilter("#00ff00",4,0,0);
		PlayerList.__super.call(this);
		this.itemRender=PlayerItem;
		this.repeatX=1;
		this.repeatY=12;
		this.spaceX=12;
		this.spaceY=10;
		this.pos(54,40);
		this.renderHandler=new Handler(this,this.updateItem);
		this.vScrollBarSkin="";
	}

	__class(PlayerList,'huamao.panel.worldMap.PlayerList',_super);
	var __proto=PlayerList.prototype;
	__proto.selectItem=function(item){
		if(this._curItem){
			this._curItem.isSelect=false;
		}
		this._curItem=item;
		this._curItem.isSelect=true;
	}

	__proto.getItemById=function(pId){
		var item;
		for(var $each_item in this.cells){
			item=this.cells[$each_item];
			if(item.playerId==pId){
				return item;
			}
		}
		return null;
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	__proto.update=function(arr){
		this.array=arr;
	}

	return PlayerList;
})(List)


//class ui.ANI.skillAni.buff.SbuffSeat10UI extends laya.ui.View
var SbuffSeat10UI=(function(_super){
	function SbuffSeat10UI(){
		SbuffSeat10UI.__super.call(this);;
	}

	__class(SbuffSeat10UI,'ui.ANI.skillAni.buff.SbuffSeat10UI',_super);
	var __proto=SbuffSeat10UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat10");
	}

	return SbuffSeat10UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat11UI extends laya.ui.View
var SbuffSeat11UI=(function(_super){
	function SbuffSeat11UI(){
		SbuffSeat11UI.__super.call(this);;
	}

	__class(SbuffSeat11UI,'ui.ANI.skillAni.buff.SbuffSeat11UI',_super);
	var __proto=SbuffSeat11UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat11");
	}

	return SbuffSeat11UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat12UI extends laya.ui.View
var SbuffSeat12UI=(function(_super){
	function SbuffSeat12UI(){
		SbuffSeat12UI.__super.call(this);;
	}

	__class(SbuffSeat12UI,'ui.ANI.skillAni.buff.SbuffSeat12UI',_super);
	var __proto=SbuffSeat12UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat12");
	}

	return SbuffSeat12UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat13UI extends laya.ui.View
var SbuffSeat13UI=(function(_super){
	function SbuffSeat13UI(){
		SbuffSeat13UI.__super.call(this);;
	}

	__class(SbuffSeat13UI,'ui.ANI.skillAni.buff.SbuffSeat13UI',_super);
	var __proto=SbuffSeat13UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat13");
	}

	return SbuffSeat13UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat14UI extends laya.ui.View
var SbuffSeat14UI=(function(_super){
	function SbuffSeat14UI(){
		SbuffSeat14UI.__super.call(this);;
	}

	__class(SbuffSeat14UI,'ui.ANI.skillAni.buff.SbuffSeat14UI',_super);
	var __proto=SbuffSeat14UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat14");
	}

	return SbuffSeat14UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat15UI extends laya.ui.View
var SbuffSeat15UI=(function(_super){
	function SbuffSeat15UI(){
		SbuffSeat15UI.__super.call(this);;
	}

	__class(SbuffSeat15UI,'ui.ANI.skillAni.buff.SbuffSeat15UI',_super);
	var __proto=SbuffSeat15UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat15");
	}

	return SbuffSeat15UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat1UI extends laya.ui.View
var SbuffSeat1UI=(function(_super){
	function SbuffSeat1UI(){
		SbuffSeat1UI.__super.call(this);;
	}

	__class(SbuffSeat1UI,'ui.ANI.skillAni.buff.SbuffSeat1UI',_super);
	var __proto=SbuffSeat1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat1");
	}

	return SbuffSeat1UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat2UI extends laya.ui.View
var SbuffSeat2UI=(function(_super){
	function SbuffSeat2UI(){
		SbuffSeat2UI.__super.call(this);;
	}

	__class(SbuffSeat2UI,'ui.ANI.skillAni.buff.SbuffSeat2UI',_super);
	var __proto=SbuffSeat2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat2");
	}

	return SbuffSeat2UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat3UI extends laya.ui.View
var SbuffSeat3UI=(function(_super){
	function SbuffSeat3UI(){
		SbuffSeat3UI.__super.call(this);;
	}

	__class(SbuffSeat3UI,'ui.ANI.skillAni.buff.SbuffSeat3UI',_super);
	var __proto=SbuffSeat3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat3");
	}

	return SbuffSeat3UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat4UI extends laya.ui.View
var SbuffSeat4UI=(function(_super){
	function SbuffSeat4UI(){
		SbuffSeat4UI.__super.call(this);;
	}

	__class(SbuffSeat4UI,'ui.ANI.skillAni.buff.SbuffSeat4UI',_super);
	var __proto=SbuffSeat4UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat4");
	}

	return SbuffSeat4UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat5UI extends laya.ui.View
var SbuffSeat5UI=(function(_super){
	function SbuffSeat5UI(){
		SbuffSeat5UI.__super.call(this);;
	}

	__class(SbuffSeat5UI,'ui.ANI.skillAni.buff.SbuffSeat5UI',_super);
	var __proto=SbuffSeat5UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat5");
	}

	return SbuffSeat5UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat6UI extends laya.ui.View
var SbuffSeat6UI=(function(_super){
	function SbuffSeat6UI(){
		SbuffSeat6UI.__super.call(this);;
	}

	__class(SbuffSeat6UI,'ui.ANI.skillAni.buff.SbuffSeat6UI',_super);
	var __proto=SbuffSeat6UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat6");
	}

	return SbuffSeat6UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat7UI extends laya.ui.View
var SbuffSeat7UI=(function(_super){
	function SbuffSeat7UI(){
		SbuffSeat7UI.__super.call(this);;
	}

	__class(SbuffSeat7UI,'ui.ANI.skillAni.buff.SbuffSeat7UI',_super);
	var __proto=SbuffSeat7UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat7");
	}

	return SbuffSeat7UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat8UI extends laya.ui.View
var SbuffSeat8UI=(function(_super){
	function SbuffSeat8UI(){
		SbuffSeat8UI.__super.call(this);;
	}

	__class(SbuffSeat8UI,'ui.ANI.skillAni.buff.SbuffSeat8UI',_super);
	var __proto=SbuffSeat8UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat8");
	}

	return SbuffSeat8UI;
})(View)


//class ui.ANI.skillAni.buff.SbuffSeat9UI extends laya.ui.View
var SbuffSeat9UI=(function(_super){
	function SbuffSeat9UI(){
		SbuffSeat9UI.__super.call(this);;
	}

	__class(SbuffSeat9UI,'ui.ANI.skillAni.buff.SbuffSeat9UI',_super);
	var __proto=SbuffSeat9UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/buff/SbuffSeat9");
	}

	return SbuffSeat9UI;
})(View)


//class ui.ANI.skillAni.skill.skill1001UI extends laya.ui.View
var skill1001UI=(function(_super){
	function skill1001UI(){
		skill1001UI.__super.call(this);;
	}

	__class(skill1001UI,'ui.ANI.skillAni.skill.skill1001UI',_super);
	var __proto=skill1001UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1001");
	}

	return skill1001UI;
})(View)


//class ui.ANI.skillAni.skill.skill1002UI extends laya.ui.View
var skill1002UI=(function(_super){
	function skill1002UI(){
		skill1002UI.__super.call(this);;
	}

	__class(skill1002UI,'ui.ANI.skillAni.skill.skill1002UI',_super);
	var __proto=skill1002UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1002");
	}

	return skill1002UI;
})(View)


//class ui.ANI.skillAni.skill.skill1003UI extends laya.ui.View
var skill1003UI=(function(_super){
	function skill1003UI(){
		skill1003UI.__super.call(this);;
	}

	__class(skill1003UI,'ui.ANI.skillAni.skill.skill1003UI',_super);
	var __proto=skill1003UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1003");
	}

	return skill1003UI;
})(View)


//class ui.ANI.skillAni.skill.skill1004UI extends laya.ui.View
var skill1004UI=(function(_super){
	function skill1004UI(){
		skill1004UI.__super.call(this);;
	}

	__class(skill1004UI,'ui.ANI.skillAni.skill.skill1004UI',_super);
	var __proto=skill1004UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1004");
	}

	return skill1004UI;
})(View)


//class ui.ANI.skillAni.skill.skill1005UI extends laya.ui.View
var skill1005UI=(function(_super){
	function skill1005UI(){
		skill1005UI.__super.call(this);;
	}

	__class(skill1005UI,'ui.ANI.skillAni.skill.skill1005UI',_super);
	var __proto=skill1005UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1005");
	}

	return skill1005UI;
})(View)


//class ui.ANI.skillAni.skill.skill1006UI extends laya.ui.View
var skill1006UI=(function(_super){
	function skill1006UI(){
		skill1006UI.__super.call(this);;
	}

	__class(skill1006UI,'ui.ANI.skillAni.skill.skill1006UI',_super);
	var __proto=skill1006UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1006");
	}

	return skill1006UI;
})(View)


//class ui.ANI.skillAni.skill.skill1007UI extends laya.ui.View
var skill1007UI=(function(_super){
	function skill1007UI(){
		skill1007UI.__super.call(this);;
	}

	__class(skill1007UI,'ui.ANI.skillAni.skill.skill1007UI',_super);
	var __proto=skill1007UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1007");
	}

	return skill1007UI;
})(View)


//class ui.ANI.skillAni.skill.skill1009UI extends laya.ui.View
var skill1009UI=(function(_super){
	function skill1009UI(){
		skill1009UI.__super.call(this);;
	}

	__class(skill1009UI,'ui.ANI.skillAni.skill.skill1009UI',_super);
	var __proto=skill1009UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1009");
	}

	return skill1009UI;
})(View)


//class ui.ANI.skillAni.skill.skill1010UI extends laya.ui.View
var skill1010UI=(function(_super){
	function skill1010UI(){
		skill1010UI.__super.call(this);;
	}

	__class(skill1010UI,'ui.ANI.skillAni.skill.skill1010UI',_super);
	var __proto=skill1010UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1010");
	}

	return skill1010UI;
})(View)


//class ui.ANI.skillAni.skill.skill1011UI extends laya.ui.View
var skill1011UI=(function(_super){
	function skill1011UI(){
		skill1011UI.__super.call(this);;
	}

	__class(skill1011UI,'ui.ANI.skillAni.skill.skill1011UI',_super);
	var __proto=skill1011UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1011");
	}

	return skill1011UI;
})(View)


//class ui.ANI.skillAni.skill.skill1012UI extends laya.ui.View
var skill1012UI=(function(_super){
	function skill1012UI(){
		skill1012UI.__super.call(this);;
	}

	__class(skill1012UI,'ui.ANI.skillAni.skill.skill1012UI',_super);
	var __proto=skill1012UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1012");
	}

	return skill1012UI;
})(View)


//class ui.ANI.skillAni.skill.skill1013UI extends laya.ui.View
var skill1013UI=(function(_super){
	function skill1013UI(){
		skill1013UI.__super.call(this);;
	}

	__class(skill1013UI,'ui.ANI.skillAni.skill.skill1013UI',_super);
	var __proto=skill1013UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1013");
	}

	return skill1013UI;
})(View)


//class ui.ANI.skillAni.skill.skill1014UI extends laya.ui.View
var skill1014UI=(function(_super){
	function skill1014UI(){
		skill1014UI.__super.call(this);;
	}

	__class(skill1014UI,'ui.ANI.skillAni.skill.skill1014UI',_super);
	var __proto=skill1014UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1014");
	}

	return skill1014UI;
})(View)


//class ui.ANI.skillAni.skill.skill1017UI extends laya.ui.View
var skill1017UI=(function(_super){
	function skill1017UI(){
		skill1017UI.__super.call(this);;
	}

	__class(skill1017UI,'ui.ANI.skillAni.skill.skill1017UI',_super);
	var __proto=skill1017UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1017");
	}

	return skill1017UI;
})(View)


//class ui.ANI.skillAni.skill.skill1020UI extends laya.ui.View
var skill1020UI=(function(_super){
	function skill1020UI(){
		skill1020UI.__super.call(this);;
	}

	__class(skill1020UI,'ui.ANI.skillAni.skill.skill1020UI',_super);
	var __proto=skill1020UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1020");
	}

	return skill1020UI;
})(View)


//class ui.ANI.skillAni.skill.skill1021UI extends laya.ui.View
var skill1021UI=(function(_super){
	function skill1021UI(){
		skill1021UI.__super.call(this);;
	}

	__class(skill1021UI,'ui.ANI.skillAni.skill.skill1021UI',_super);
	var __proto=skill1021UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1021");
	}

	return skill1021UI;
})(View)


//class ui.ANI.skillAni.skill.skill1022UI extends laya.ui.View
var skill1022UI=(function(_super){
	function skill1022UI(){
		skill1022UI.__super.call(this);;
	}

	__class(skill1022UI,'ui.ANI.skillAni.skill.skill1022UI',_super);
	var __proto=skill1022UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1022");
	}

	return skill1022UI;
})(View)


//class ui.ANI.skillAni.skill.skill1023UI extends laya.ui.View
var skill1023UI=(function(_super){
	function skill1023UI(){
		skill1023UI.__super.call(this);;
	}

	__class(skill1023UI,'ui.ANI.skillAni.skill.skill1023UI',_super);
	var __proto=skill1023UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1023");
	}

	return skill1023UI;
})(View)


//class ui.ANI.skillAni.skill.skill1024UI extends laya.ui.View
var skill1024UI=(function(_super){
	function skill1024UI(){
		skill1024UI.__super.call(this);;
	}

	__class(skill1024UI,'ui.ANI.skillAni.skill.skill1024UI',_super);
	var __proto=skill1024UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1024");
	}

	return skill1024UI;
})(View)


//class ui.ANI.skillAni.skill.skill1025UI extends laya.ui.View
var skill1025UI=(function(_super){
	function skill1025UI(){
		skill1025UI.__super.call(this);;
	}

	__class(skill1025UI,'ui.ANI.skillAni.skill.skill1025UI',_super);
	var __proto=skill1025UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1025");
	}

	return skill1025UI;
})(View)


//class ui.ANI.skillAni.skill.skill1026UI extends laya.ui.View
var skill1026UI=(function(_super){
	function skill1026UI(){
		skill1026UI.__super.call(this);;
	}

	__class(skill1026UI,'ui.ANI.skillAni.skill.skill1026UI',_super);
	var __proto=skill1026UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1026");
	}

	return skill1026UI;
})(View)


//class ui.ANI.skillAni.skill.skill1028UI extends laya.ui.View
var skill1028UI=(function(_super){
	function skill1028UI(){
		skill1028UI.__super.call(this);;
	}

	__class(skill1028UI,'ui.ANI.skillAni.skill.skill1028UI',_super);
	var __proto=skill1028UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1028");
	}

	return skill1028UI;
})(View)


//class ui.ANI.skillAni.skill.skill1029UI extends laya.ui.View
var skill1029UI=(function(_super){
	function skill1029UI(){
		skill1029UI.__super.call(this);;
	}

	__class(skill1029UI,'ui.ANI.skillAni.skill.skill1029UI',_super);
	var __proto=skill1029UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1029");
	}

	return skill1029UI;
})(View)


//class ui.ANI.skillAni.skill.skill1030UI extends laya.ui.View
var skill1030UI=(function(_super){
	function skill1030UI(){
		skill1030UI.__super.call(this);;
	}

	__class(skill1030UI,'ui.ANI.skillAni.skill.skill1030UI',_super);
	var __proto=skill1030UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1030");
	}

	return skill1030UI;
})(View)


//class ui.ANI.skillAni.skill.skill1031UI extends laya.ui.View
var skill1031UI=(function(_super){
	function skill1031UI(){
		skill1031UI.__super.call(this);;
	}

	__class(skill1031UI,'ui.ANI.skillAni.skill.skill1031UI',_super);
	var __proto=skill1031UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1031");
	}

	return skill1031UI;
})(View)


//class ui.ANI.skillAni.skill.skill1032UI extends laya.ui.View
var skill1032UI=(function(_super){
	function skill1032UI(){
		skill1032UI.__super.call(this);;
	}

	__class(skill1032UI,'ui.ANI.skillAni.skill.skill1032UI',_super);
	var __proto=skill1032UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1032");
	}

	return skill1032UI;
})(View)


//class ui.ANI.skillAni.skill.skill1033UI extends laya.ui.View
var skill1033UI=(function(_super){
	function skill1033UI(){
		skill1033UI.__super.call(this);;
	}

	__class(skill1033UI,'ui.ANI.skillAni.skill.skill1033UI',_super);
	var __proto=skill1033UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill1033");
	}

	return skill1033UI;
})(View)


//class ui.ANI.skillAni.skill.skill2002UI extends laya.ui.View
var skill2002UI=(function(_super){
	function skill2002UI(){
		skill2002UI.__super.call(this);;
	}

	__class(skill2002UI,'ui.ANI.skillAni.skill.skill2002UI',_super);
	var __proto=skill2002UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2002");
	}

	return skill2002UI;
})(View)


//class ui.ANI.skillAni.skill.skill2003UI extends laya.ui.View
var skill2003UI=(function(_super){
	function skill2003UI(){
		skill2003UI.__super.call(this);;
	}

	__class(skill2003UI,'ui.ANI.skillAni.skill.skill2003UI',_super);
	var __proto=skill2003UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2003");
	}

	return skill2003UI;
})(View)


//class ui.ANI.skillAni.skill.skill2007UI extends laya.ui.View
var skill2007UI=(function(_super){
	function skill2007UI(){
		skill2007UI.__super.call(this);;
	}

	__class(skill2007UI,'ui.ANI.skillAni.skill.skill2007UI',_super);
	var __proto=skill2007UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2007");
	}

	return skill2007UI;
})(View)


//class ui.ANI.skillAni.skill.skill2008UI extends laya.ui.View
var skill2008UI=(function(_super){
	function skill2008UI(){
		skill2008UI.__super.call(this);;
	}

	__class(skill2008UI,'ui.ANI.skillAni.skill.skill2008UI',_super);
	var __proto=skill2008UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2008");
	}

	return skill2008UI;
})(View)


//class ui.ANI.skillAni.skill.skill2009UI extends laya.ui.View
var skill2009UI=(function(_super){
	function skill2009UI(){
		skill2009UI.__super.call(this);;
	}

	__class(skill2009UI,'ui.ANI.skillAni.skill.skill2009UI',_super);
	var __proto=skill2009UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2009");
	}

	return skill2009UI;
})(View)


//class ui.ANI.skillAni.skill.skill2010UI extends laya.ui.View
var skill2010UI=(function(_super){
	function skill2010UI(){
		skill2010UI.__super.call(this);;
	}

	__class(skill2010UI,'ui.ANI.skillAni.skill.skill2010UI',_super);
	var __proto=skill2010UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2010");
	}

	return skill2010UI;
})(View)


//class ui.ANI.skillAni.skill.skill2011UI extends laya.ui.View
var skill2011UI=(function(_super){
	function skill2011UI(){
		skill2011UI.__super.call(this);;
	}

	__class(skill2011UI,'ui.ANI.skillAni.skill.skill2011UI',_super);
	var __proto=skill2011UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2011");
	}

	return skill2011UI;
})(View)


//class ui.ANI.skillAni.skill.skill2012UI extends laya.ui.View
var skill2012UI=(function(_super){
	function skill2012UI(){
		skill2012UI.__super.call(this);;
	}

	__class(skill2012UI,'ui.ANI.skillAni.skill.skill2012UI',_super);
	var __proto=skill2012UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2012");
	}

	return skill2012UI;
})(View)


//class ui.ANI.skillAni.skill.skill2013UI extends laya.ui.View
var skill2013UI=(function(_super){
	function skill2013UI(){
		skill2013UI.__super.call(this);;
	}

	__class(skill2013UI,'ui.ANI.skillAni.skill.skill2013UI',_super);
	var __proto=skill2013UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill2013");
	}

	return skill2013UI;
})(View)


//class ui.ANI.skillAni.skill.skill3005UI extends laya.ui.View
var skill3005UI=(function(_super){
	function skill3005UI(){
		skill3005UI.__super.call(this);;
	}

	__class(skill3005UI,'ui.ANI.skillAni.skill.skill3005UI',_super);
	var __proto=skill3005UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill3005");
	}

	return skill3005UI;
})(View)


//class ui.ANI.skillAni.skill.skill3006UI extends laya.ui.View
var skill3006UI=(function(_super){
	function skill3006UI(){
		skill3006UI.__super.call(this);;
	}

	__class(skill3006UI,'ui.ANI.skillAni.skill.skill3006UI',_super);
	var __proto=skill3006UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill3006");
	}

	return skill3006UI;
})(View)


//class ui.ANI.skillAni.skill.skill3007UI extends laya.ui.View
var skill3007UI=(function(_super){
	function skill3007UI(){
		skill3007UI.__super.call(this);;
	}

	__class(skill3007UI,'ui.ANI.skillAni.skill.skill3007UI',_super);
	var __proto=skill3007UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/skillAni/skill/skill3007");
	}

	return skill3007UI;
})(View)


//class ui.ANI.soldiersAni.bloodSeatUI extends laya.ui.View
var bloodSeatUI=(function(_super){
	function bloodSeatUI(){
		this.blood=null;
		this.h1=null;
		this.h2=null;
		this.h3=null;
		this.h4=null;
		this.h5=null;
		bloodSeatUI.__super.call(this);
	}

	__class(bloodSeatUI,'ui.ANI.soldiersAni.bloodSeatUI',_super);
	var __proto=bloodSeatUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.zhandou_0UI",zhandou_0UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni/bloodSeat");
	}

	return bloodSeatUI;
})(View)


//class ui.ANI.soldiersAni.cityDeff00UI extends laya.ui.View
var cityDeff00UI=(function(_super){
	function cityDeff00UI(){
		cityDeff00UI.__super.call(this);;
	}

	__class(cityDeff00UI,'ui.ANI.soldiersAni.cityDeff00UI',_super);
	var __proto=cityDeff00UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni/cityDeff00");
	}

	return cityDeff00UI;
})(View)


//class ui.ANI.soldiersAni2.a10001_2UI extends laya.ui.View
var a10001_2UI=(function(_super){
	function a10001_2UI(){
		a10001_2UI.__super.call(this);;
	}

	__class(a10001_2UI,'ui.ANI.soldiersAni2.a10001_2UI',_super);
	var __proto=a10001_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10001_2");
	}

	return a10001_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10001_3UI extends laya.ui.View
var a10001_3UI=(function(_super){
	function a10001_3UI(){
		a10001_3UI.__super.call(this);;
	}

	__class(a10001_3UI,'ui.ANI.soldiersAni2.a10001_3UI',_super);
	var __proto=a10001_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10001_3");
	}

	return a10001_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10002_2UI extends laya.ui.View
var a10002_2UI=(function(_super){
	function a10002_2UI(){
		a10002_2UI.__super.call(this);;
	}

	__class(a10002_2UI,'ui.ANI.soldiersAni2.a10002_2UI',_super);
	var __proto=a10002_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10002_2");
	}

	return a10002_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10002_3UI extends laya.ui.View
var a10002_3UI=(function(_super){
	function a10002_3UI(){
		a10002_3UI.__super.call(this);;
	}

	__class(a10002_3UI,'ui.ANI.soldiersAni2.a10002_3UI',_super);
	var __proto=a10002_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10002_3");
	}

	return a10002_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10003_2UI extends laya.ui.View
var a10003_2UI=(function(_super){
	function a10003_2UI(){
		a10003_2UI.__super.call(this);;
	}

	__class(a10003_2UI,'ui.ANI.soldiersAni2.a10003_2UI',_super);
	var __proto=a10003_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10003_2");
	}

	return a10003_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10003_3UI extends laya.ui.View
var a10003_3UI=(function(_super){
	function a10003_3UI(){
		a10003_3UI.__super.call(this);;
	}

	__class(a10003_3UI,'ui.ANI.soldiersAni2.a10003_3UI',_super);
	var __proto=a10003_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10003_3");
	}

	return a10003_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10004_2UI extends laya.ui.View
var a10004_2UI=(function(_super){
	function a10004_2UI(){
		a10004_2UI.__super.call(this);;
	}

	__class(a10004_2UI,'ui.ANI.soldiersAni2.a10004_2UI',_super);
	var __proto=a10004_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10004_2");
	}

	return a10004_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10004_3UI extends laya.ui.View
var a10004_3UI=(function(_super){
	function a10004_3UI(){
		a10004_3UI.__super.call(this);;
	}

	__class(a10004_3UI,'ui.ANI.soldiersAni2.a10004_3UI',_super);
	var __proto=a10004_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10004_3");
	}

	return a10004_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10005_2UI extends laya.ui.View
var a10005_2UI=(function(_super){
	function a10005_2UI(){
		a10005_2UI.__super.call(this);;
	}

	__class(a10005_2UI,'ui.ANI.soldiersAni2.a10005_2UI',_super);
	var __proto=a10005_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10005_2");
	}

	return a10005_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10005_3UI extends laya.ui.View
var a10005_3UI=(function(_super){
	function a10005_3UI(){
		a10005_3UI.__super.call(this);;
	}

	__class(a10005_3UI,'ui.ANI.soldiersAni2.a10005_3UI',_super);
	var __proto=a10005_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10005_3");
	}

	return a10005_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10006_2UI extends laya.ui.View
var a10006_2UI=(function(_super){
	function a10006_2UI(){
		a10006_2UI.__super.call(this);;
	}

	__class(a10006_2UI,'ui.ANI.soldiersAni2.a10006_2UI',_super);
	var __proto=a10006_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10006_2");
	}

	return a10006_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10006_3UI extends laya.ui.View
var a10006_3UI=(function(_super){
	function a10006_3UI(){
		a10006_3UI.__super.call(this);;
	}

	__class(a10006_3UI,'ui.ANI.soldiersAni2.a10006_3UI',_super);
	var __proto=a10006_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10006_3");
	}

	return a10006_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10007_2UI extends laya.ui.View
var a10007_2UI=(function(_super){
	function a10007_2UI(){
		a10007_2UI.__super.call(this);;
	}

	__class(a10007_2UI,'ui.ANI.soldiersAni2.a10007_2UI',_super);
	var __proto=a10007_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10007_2");
	}

	return a10007_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10007_3UI extends laya.ui.View
var a10007_3UI=(function(_super){
	function a10007_3UI(){
		a10007_3UI.__super.call(this);;
	}

	__class(a10007_3UI,'ui.ANI.soldiersAni2.a10007_3UI',_super);
	var __proto=a10007_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10007_3");
	}

	return a10007_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10008_2UI extends laya.ui.View
var a10008_2UI=(function(_super){
	function a10008_2UI(){
		a10008_2UI.__super.call(this);;
	}

	__class(a10008_2UI,'ui.ANI.soldiersAni2.a10008_2UI',_super);
	var __proto=a10008_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10008_2");
	}

	return a10008_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10008_3UI extends laya.ui.View
var a10008_3UI=(function(_super){
	function a10008_3UI(){
		a10008_3UI.__super.call(this);;
	}

	__class(a10008_3UI,'ui.ANI.soldiersAni2.a10008_3UI',_super);
	var __proto=a10008_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10008_3");
	}

	return a10008_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10009_2UI extends laya.ui.View
var a10009_2UI=(function(_super){
	function a10009_2UI(){
		a10009_2UI.__super.call(this);;
	}

	__class(a10009_2UI,'ui.ANI.soldiersAni2.a10009_2UI',_super);
	var __proto=a10009_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10009_2");
	}

	return a10009_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10009_3UI extends laya.ui.View
var a10009_3UI=(function(_super){
	function a10009_3UI(){
		a10009_3UI.__super.call(this);;
	}

	__class(a10009_3UI,'ui.ANI.soldiersAni2.a10009_3UI',_super);
	var __proto=a10009_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10009_3");
	}

	return a10009_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10010_2UI extends laya.ui.View
var a10010_2UI=(function(_super){
	function a10010_2UI(){
		a10010_2UI.__super.call(this);;
	}

	__class(a10010_2UI,'ui.ANI.soldiersAni2.a10010_2UI',_super);
	var __proto=a10010_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10010_2");
	}

	return a10010_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10010_3UI extends laya.ui.View
var a10010_3UI=(function(_super){
	function a10010_3UI(){
		a10010_3UI.__super.call(this);;
	}

	__class(a10010_3UI,'ui.ANI.soldiersAni2.a10010_3UI',_super);
	var __proto=a10010_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10010_3");
	}

	return a10010_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10011_2UI extends laya.ui.View
var a10011_2UI=(function(_super){
	function a10011_2UI(){
		a10011_2UI.__super.call(this);;
	}

	__class(a10011_2UI,'ui.ANI.soldiersAni2.a10011_2UI',_super);
	var __proto=a10011_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10011_2");
	}

	return a10011_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10011_3UI extends laya.ui.View
var a10011_3UI=(function(_super){
	function a10011_3UI(){
		a10011_3UI.__super.call(this);;
	}

	__class(a10011_3UI,'ui.ANI.soldiersAni2.a10011_3UI',_super);
	var __proto=a10011_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10011_3");
	}

	return a10011_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10012_2UI extends laya.ui.View
var a10012_2UI=(function(_super){
	function a10012_2UI(){
		a10012_2UI.__super.call(this);;
	}

	__class(a10012_2UI,'ui.ANI.soldiersAni2.a10012_2UI',_super);
	var __proto=a10012_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10012_2");
	}

	return a10012_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10012_3UI extends laya.ui.View
var a10012_3UI=(function(_super){
	function a10012_3UI(){
		a10012_3UI.__super.call(this);;
	}

	__class(a10012_3UI,'ui.ANI.soldiersAni2.a10012_3UI',_super);
	var __proto=a10012_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10012_3");
	}

	return a10012_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10013_2UI extends laya.ui.View
var a10013_2UI=(function(_super){
	function a10013_2UI(){
		a10013_2UI.__super.call(this);;
	}

	__class(a10013_2UI,'ui.ANI.soldiersAni2.a10013_2UI',_super);
	var __proto=a10013_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10013_2");
	}

	return a10013_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10013_3UI extends laya.ui.View
var a10013_3UI=(function(_super){
	function a10013_3UI(){
		a10013_3UI.__super.call(this);;
	}

	__class(a10013_3UI,'ui.ANI.soldiersAni2.a10013_3UI',_super);
	var __proto=a10013_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10013_3");
	}

	return a10013_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10014_2UI extends laya.ui.View
var a10014_2UI=(function(_super){
	function a10014_2UI(){
		a10014_2UI.__super.call(this);;
	}

	__class(a10014_2UI,'ui.ANI.soldiersAni2.a10014_2UI',_super);
	var __proto=a10014_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10014_2");
	}

	return a10014_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10014_3UI extends laya.ui.View
var a10014_3UI=(function(_super){
	function a10014_3UI(){
		a10014_3UI.__super.call(this);;
	}

	__class(a10014_3UI,'ui.ANI.soldiersAni2.a10014_3UI',_super);
	var __proto=a10014_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10014_3");
	}

	return a10014_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10015_2UI extends laya.ui.View
var a10015_2UI=(function(_super){
	function a10015_2UI(){
		a10015_2UI.__super.call(this);;
	}

	__class(a10015_2UI,'ui.ANI.soldiersAni2.a10015_2UI',_super);
	var __proto=a10015_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10015_2");
	}

	return a10015_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10015_3UI extends laya.ui.View
var a10015_3UI=(function(_super){
	function a10015_3UI(){
		a10015_3UI.__super.call(this);;
	}

	__class(a10015_3UI,'ui.ANI.soldiersAni2.a10015_3UI',_super);
	var __proto=a10015_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10015_3");
	}

	return a10015_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10016_2UI extends laya.ui.View
var a10016_2UI=(function(_super){
	function a10016_2UI(){
		a10016_2UI.__super.call(this);;
	}

	__class(a10016_2UI,'ui.ANI.soldiersAni2.a10016_2UI',_super);
	var __proto=a10016_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10016_2");
	}

	return a10016_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10016_3UI extends laya.ui.View
var a10016_3UI=(function(_super){
	function a10016_3UI(){
		a10016_3UI.__super.call(this);;
	}

	__class(a10016_3UI,'ui.ANI.soldiersAni2.a10016_3UI',_super);
	var __proto=a10016_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10016_3");
	}

	return a10016_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10017_2UI extends laya.ui.View
var a10017_2UI=(function(_super){
	function a10017_2UI(){
		a10017_2UI.__super.call(this);;
	}

	__class(a10017_2UI,'ui.ANI.soldiersAni2.a10017_2UI',_super);
	var __proto=a10017_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10017_2");
	}

	return a10017_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10017_3UI extends laya.ui.View
var a10017_3UI=(function(_super){
	function a10017_3UI(){
		a10017_3UI.__super.call(this);;
	}

	__class(a10017_3UI,'ui.ANI.soldiersAni2.a10017_3UI',_super);
	var __proto=a10017_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10017_3");
	}

	return a10017_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10018_2UI extends laya.ui.View
var a10018_2UI=(function(_super){
	function a10018_2UI(){
		a10018_2UI.__super.call(this);;
	}

	__class(a10018_2UI,'ui.ANI.soldiersAni2.a10018_2UI',_super);
	var __proto=a10018_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10018_2");
	}

	return a10018_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10018_3UI extends laya.ui.View
var a10018_3UI=(function(_super){
	function a10018_3UI(){
		a10018_3UI.__super.call(this);;
	}

	__class(a10018_3UI,'ui.ANI.soldiersAni2.a10018_3UI',_super);
	var __proto=a10018_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10018_3");
	}

	return a10018_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10019_2UI extends laya.ui.View
var a10019_2UI=(function(_super){
	function a10019_2UI(){
		a10019_2UI.__super.call(this);;
	}

	__class(a10019_2UI,'ui.ANI.soldiersAni2.a10019_2UI',_super);
	var __proto=a10019_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10019_2");
	}

	return a10019_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10019_3UI extends laya.ui.View
var a10019_3UI=(function(_super){
	function a10019_3UI(){
		a10019_3UI.__super.call(this);;
	}

	__class(a10019_3UI,'ui.ANI.soldiersAni2.a10019_3UI',_super);
	var __proto=a10019_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10019_3");
	}

	return a10019_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10020_2UI extends laya.ui.View
var a10020_2UI=(function(_super){
	function a10020_2UI(){
		a10020_2UI.__super.call(this);;
	}

	__class(a10020_2UI,'ui.ANI.soldiersAni2.a10020_2UI',_super);
	var __proto=a10020_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10020_2");
	}

	return a10020_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10020_3UI extends laya.ui.View
var a10020_3UI=(function(_super){
	function a10020_3UI(){
		a10020_3UI.__super.call(this);;
	}

	__class(a10020_3UI,'ui.ANI.soldiersAni2.a10020_3UI',_super);
	var __proto=a10020_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10020_3");
	}

	return a10020_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10021_2UI extends laya.ui.View
var a10021_2UI=(function(_super){
	function a10021_2UI(){
		a10021_2UI.__super.call(this);;
	}

	__class(a10021_2UI,'ui.ANI.soldiersAni2.a10021_2UI',_super);
	var __proto=a10021_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10021_2");
	}

	return a10021_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10021_3UI extends laya.ui.View
var a10021_3UI=(function(_super){
	function a10021_3UI(){
		a10021_3UI.__super.call(this);;
	}

	__class(a10021_3UI,'ui.ANI.soldiersAni2.a10021_3UI',_super);
	var __proto=a10021_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10021_3");
	}

	return a10021_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10022_2UI extends laya.ui.View
var a10022_2UI=(function(_super){
	function a10022_2UI(){
		a10022_2UI.__super.call(this);;
	}

	__class(a10022_2UI,'ui.ANI.soldiersAni2.a10022_2UI',_super);
	var __proto=a10022_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10022_2");
	}

	return a10022_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10022_3UI extends laya.ui.View
var a10022_3UI=(function(_super){
	function a10022_3UI(){
		a10022_3UI.__super.call(this);;
	}

	__class(a10022_3UI,'ui.ANI.soldiersAni2.a10022_3UI',_super);
	var __proto=a10022_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10022_3");
	}

	return a10022_3UI;
})(View)


//class ui.ANI.soldiersAni2.a10023_2UI extends laya.ui.View
var a10023_2UI=(function(_super){
	function a10023_2UI(){
		a10023_2UI.__super.call(this);;
	}

	__class(a10023_2UI,'ui.ANI.soldiersAni2.a10023_2UI',_super);
	var __proto=a10023_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10023_2");
	}

	return a10023_2UI;
})(View)


//class ui.ANI.soldiersAni2.a10023_3UI extends laya.ui.View
var a10023_3UI=(function(_super){
	function a10023_3UI(){
		a10023_3UI.__super.call(this);;
	}

	__class(a10023_3UI,'ui.ANI.soldiersAni2.a10023_3UI',_super);
	var __proto=a10023_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("ANI/soldiersAni2/a10023_3");
	}

	return a10023_3UI;
})(View)


//class ui.huodong_duobao_2UI extends laya.ui.View
var huodong_duobao_2UI=(function(_super){
	function huodong_duobao_2UI(){
		this.ani1=null;
		this.duo1=null;
		this.duo2=null;
		huodong_duobao_2UI.__super.call(this);
	}

	__class(huodong_duobao_2UI,'ui.huodong_duobao_2UI',_super);
	var __proto=huodong_duobao_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("huodong_duobao_2");
	}

	return huodong_duobao_2UI;
})(View)


//class ui.jian0UI extends laya.ui.View
var jian0UI=(function(_super){
	function jian0UI(){
		jian0UI.__super.call(this);;
	}

	__class(jian0UI,'ui.jian0UI',_super);
	var __proto=jian0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian0");
	}

	return jian0UI;
})(View)


//class ui.jian10UI extends laya.ui.View
var jian10UI=(function(_super){
	function jian10UI(){
		jian10UI.__super.call(this);;
	}

	__class(jian10UI,'ui.jian10UI',_super);
	var __proto=jian10UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian10");
	}

	return jian10UI;
})(View)


//class ui.jian2UI extends laya.ui.View
var jian2UI=(function(_super){
	function jian2UI(){
		jian2UI.__super.call(this);;
	}

	__class(jian2UI,'ui.jian2UI',_super);
	var __proto=jian2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian2");
	}

	return jian2UI;
})(View)


//class ui.jian4UI extends laya.ui.View
var jian4UI=(function(_super){
	function jian4UI(){
		jian4UI.__super.call(this);;
	}

	__class(jian4UI,'ui.jian4UI',_super);
	var __proto=jian4UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian4");
	}

	return jian4UI;
})(View)


//class ui.jian5UI extends laya.ui.View
var jian5UI=(function(_super){
	function jian5UI(){
		jian5UI.__super.call(this);;
	}

	__class(jian5UI,'ui.jian5UI',_super);
	var __proto=jian5UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian5");
	}

	return jian5UI;
})(View)


//class ui.jian6UI extends laya.ui.View
var jian6UI=(function(_super){
	function jian6UI(){
		jian6UI.__super.call(this);;
	}

	__class(jian6UI,'ui.jian6UI',_super);
	var __proto=jian6UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian6");
	}

	return jian6UI;
})(View)


//class ui.jian7UI extends laya.ui.View
var jian7UI=(function(_super){
	function jian7UI(){
		jian7UI.__super.call(this);;
	}

	__class(jian7UI,'ui.jian7UI',_super);
	var __proto=jian7UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian7");
	}

	return jian7UI;
})(View)


//class ui.jian8UI extends laya.ui.View
var jian8UI=(function(_super){
	function jian8UI(){
		jian8UI.__super.call(this);;
	}

	__class(jian8UI,'ui.jian8UI',_super);
	var __proto=jian8UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian8");
	}

	return jian8UI;
})(View)


//class ui.jian9UI extends laya.ui.View
var jian9UI=(function(_super){
	function jian9UI(){
		jian9UI.__super.call(this);;
	}

	__class(jian9UI,'ui.jian9UI',_super);
	var __proto=jian9UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jian9");
	}

	return jian9UI;
})(View)


//class ui.jieshujianUI extends laya.ui.View
var jieshujianUI=(function(_super){
	function jieshujianUI(){
		this.ani1=null;
		this.jian=null;
		jieshujianUI.__super.call(this);
	}

	__class(jieshujianUI,'ui.jieshujianUI',_super);
	var __proto=jieshujianUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("jieshujian");
	}

	return jieshujianUI;
})(View)


//class ui.loding_dongUI extends laya.ui.View
var loding_dongUI=(function(_super){
	function loding_dongUI(){
		this.ani1=null;
		this.bai=null;
		this.logo=null;
		this.yu3=null;
		this.gewai=null;
		this.gewai1=null;
		loding_dongUI.__super.call(this);
	}

	__class(loding_dongUI,'ui.loding_dongUI',_super);
	var __proto=loding_dongUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("loding_dong");
	}

	return loding_dongUI;
})(View)


//class ui.map_1_0UI extends laya.ui.View
var map_1_0UI=(function(_super){
	function map_1_0UI(){
		this.wujiangxinxi=null;
		this.wujiangshu=null;
		this.shibingshu=null;
		this.jindutiaoa=null;
		this.di=null;
		this.xue=null;
		this.txt0=null;
		map_1_0UI.__super.call(this);
	}

	__class(map_1_0UI,'ui.map_1_0UI',_super);
	var __proto=map_1_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("map_1_0");
	}

	return map_1_0UI;
})(View)


//class ui.SLGGAME.beibao_viUI extends laya.ui.View
var beibao_viUI=(function(_super){
	function beibao_viUI(){
		beibao_viUI.__super.call(this);;
	}

	__class(beibao_viUI,'ui.SLGGAME.beibao_viUI',_super);
	var __proto=beibao_viUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/beibao_vi");
	}

	return beibao_viUI;
})(View)


//class ui.SLGGAME.chengchi_1UI extends laya.ui.View
var chengchi_1UI=(function(_super){
	function chengchi_1UI(){
		chengchi_1UI.__super.call(this);;
	}

	__class(chengchi_1UI,'ui.SLGGAME.chengchi_1UI',_super);
	var __proto=chengchi_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chengchi_1");
	}

	return chengchi_1UI;
})(View)


//class ui.SLGGAME.chengchi_2UI extends laya.ui.View
var chengchi_2UI=(function(_super){
	function chengchi_2UI(){
		chengchi_2UI.__super.call(this);;
	}

	__class(chengchi_2UI,'ui.SLGGAME.chengchi_2UI',_super);
	var __proto=chengchi_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chengchi_2");
	}

	return chengchi_2UI;
})(View)


//class ui.SLGGAME.CreateRoleUI extends laya.ui.View
var CreateRoleUI=(function(_super){
	function CreateRoleUI(){
		this.huo2=null;
		this.goBtn=null;
		this.txt0=null;
		this.btn0=null;
		this.role3=null;
		this.role4=null;
		this.role2=null;
		this.role1=null;
		this.fanhui=null;
		this.xian=null;
		CreateRoleUI.__super.call(this);
	}

	__class(CreateRoleUI,'ui.SLGGAME.CreateRoleUI',_super);
	var __proto=CreateRoleUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("Particle2D",Particle2D);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/CreateRole");
	}

	return CreateRoleUI;
})(View)


//class ui.SLGGAME.haoyou_qp0UI extends laya.ui.View
var haoyou_qp0UI=(function(_super){
	function haoyou_qp0UI(){
		this.img0=null;
		this.txt0=null;
		this.box0=null;
		haoyou_qp0UI.__super.call(this);
	}

	__class(haoyou_qp0UI,'ui.SLGGAME.haoyou_qp0UI',_super);
	var __proto=haoyou_qp0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou_qp0");
	}

	return haoyou_qp0UI;
})(View)


//class ui.SLGGAME.haoyou_qp1UI extends laya.ui.View
var haoyou_qp1UI=(function(_super){
	function haoyou_qp1UI(){
		this.img0=null;
		this.tox0=null;
		this.box0=null;
		haoyou_qp1UI.__super.call(this);
	}

	__class(haoyou_qp1UI,'ui.SLGGAME.haoyou_qp1UI',_super);
	var __proto=haoyou_qp1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou_qp1");
	}

	return haoyou_qp1UI;
})(View)


//class ui.SLGGAME.huodong_duobao_1UI extends laya.ui.View
var huodong_duobao_1UI=(function(_super){
	function huodong_duobao_1UI(){
		this.liang=null;
		huodong_duobao_1UI.__super.call(this);
	}

	__class(huodong_duobao_1UI,'ui.SLGGAME.huodong_duobao_1UI',_super);
	var __proto=huodong_duobao_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_duobao_1");
	}

	return huodong_duobao_1UI;
})(View)


//class ui.SLGGAME.iconUI extends laya.ui.View
var iconUI=(function(_super){
	function iconUI(){
		this.guang=null;
		this.box0=null;
		this.d=null;
		this.qian=null;
		this.box_xx=null;
		this.jin=null;
		this.xiaoyuanbao=null;
		this.yin=null;
		this.jia=null;
		this.qBox0=null;
		this.tong=null;
		this.liang=null;
		this.qBox1=null;
		this.tong1=null;
		this.liang1=null;
		this.xiuxi=null;
		this.gonggao=null;
		this.bangzhu=null;
		this.zhushou=null;
		this.box1=null;
		this.map=null;
		this.ditu=null;
		this.chengchi=null;
		this.zhanbao=null;
		this.shezhi=null;
		this.box_map=null;
		this.time_kz=null;
		this.wenhao=null;
		this.ren=null;
		this.huiyuan=null;
		this.txt0=null;
		this.txt1=null;
		this.touxiang=null;
		this.xinxi=null;
		this.dengji=null;
		this.xingjun=null;
		this.renwu=null;
		this.clip0=null;
		this.box2=null;
		this.fanhui=null;
		this.txt_0=null;
		this.txt_1=null;
		this.txt_2=null;
		this.txt_3=null;
		this.zhuyou=null;
		this.zhuchengyou=null;
		this.diming=null;
		this.shang=null;
		this.wen=null;
		this.box3=null;
		this.fanhui3=null;
		this.lt=null;
		this.lt_d=null;
		this.tiaot=null;
		this.beibao=null;
		this.haoyou=null;
		this.jice=null;
		this.shangdian=null;
		this.wujiang=null;
		this.zhaomu=null;
		this.waijiao=null;
		this.paihang=null;
		this.huohuo=null;
		this.huodong=null;
		this.xianxian=null;
		this.xiangou=null;
		this.xiangouT=null;
		this.shouchong=null;
		this.shoushou=null;
		this.yincang=null;
		this.B1=null;
		this.qipaopao=null;
		this.zizu=null;
		this.html=null;
		this.tishi=null;
		this.congming=null;
		this.dianwo=null;
		this.lianmeng=null;
		this.meiren=null;
		this.meiri=null;
		this.qilu=null;
		this.qiri=null;
		iconUI.__super.call(this);
	}

	__class(iconUI,'ui.SLGGAME.iconUI',_super);
	var __proto=iconUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("HTMLDivElement",HTMLDivElement);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon");
	}

	return iconUI;
})(View)


//class ui.SLGGAME.jice_1UI extends laya.ui.View
var jice_1UI=(function(_super){
	function jice_1UI(){
		this.didi=null;
		this.dikuang=null;
		this.yanjiu=null;
		this.xiaohao=null;
		this.caiyuan=null;
		this.shijian2=null;
		jice_1UI.__super.call(this);
	}

	__class(jice_1UI,'ui.SLGGAME.jice_1UI',_super);
	var __proto=jice_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/jice_1");
	}

	return jice_1UI;
})(View)


//class ui.SLGGAME.ka1UI extends laya.ui.View
var ka1UI=(function(_super){
	function ka1UI(){
		this.di=null;
		this.box=null;
		this.img0=null;
		this.tiao=null;
		this.dengji=null;
		this.name0=null;
		this.weiyongyou=null;
		this.yong=null;
		this.yu=null;
		this.zhi=null;
		this.wei=null;
		this.chengzhang=null;
		this.chengzhangzhi=null;
		this.chengzhangshu=null;
		this.yiyongyou=null;
		this.yiyongyoul=null;
		this.huodeshijian=null;
		this.wuhun=null;
		this.hun1=null;
		this.wk=null;
		ka1UI.__super.call(this);
	}

	__class(ka1UI,'ui.SLGGAME.ka1UI',_super);
	var __proto=ka1UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.wujiangka_daUI",wujiangka_daUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/ka1");
	}

	return ka1UI;
})(View)


//class ui.SLGGAME.map_0aUI extends laya.ui.View
var map_0aUI=(function(_super){
	function map_0aUI(){
		this.buBtn=null;
		this.jinBtn=null;
		map_0aUI.__super.call(this);
	}

	__class(map_0aUI,'ui.SLGGAME.map_0aUI',_super);
	var __proto=map_0aUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map_0a");
	}

	return map_0aUI;
})(View)


//class ui.SLGGAME.map_0bUI extends laya.ui.View
var map_0bUI=(function(_super){
	function map_0bUI(){
		this.chaBtn=null;
		this.qingbaoBtn=null;
		map_0bUI.__super.call(this);
	}

	__class(map_0bUI,'ui.SLGGAME.map_0bUI',_super);
	var __proto=map_0bUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map_0b");
	}

	return map_0bUI;
})(View)


//class ui.SLGGAME.map_0dUI extends laya.ui.View
var map_0dUI=(function(_super){
	function map_0dUI(){
		this.wujiangmingzi1=null;
		this.wujiangmingzi2=null;
		this.wujiangmingzi3=null;
		this.wujiangmingzi4=null;
		this.bingli1=null;
		this.bingli2=null;
		this.bingli3=null;
		this.bingli4=null;
		this.wujiangmingzi5=null;
		this.bingli5=null;
		this.wujiangmingzi6=null;
		this.bingli6=null;
		map_0dUI.__super.call(this);
	}

	__class(map_0dUI,'ui.SLGGAME.map_0dUI',_super);
	var __proto=map_0dUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map_0d");
	}

	return map_0dUI;
})(View)


//class ui.SLGGAME.map_1UI extends laya.ui.View
var map_1UI=(function(_super){
	function map_1UI(){
		this.city1=null;
		this.fang=null;
		this.baohu=null;
		this.wanjiaming=null;
		this.chengshiming=null;
		this.zhenying=null;
		this.xing=null;
		map_1UI.__super.call(this);
	}

	__class(map_1UI,'ui.SLGGAME.map_1UI',_super);
	var __proto=map_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map_1");
	}

	return map_1UI;
})(View)


//class ui.SLGGAME.shangdian_1UI extends laya.ui.View
var shangdian_1UI=(function(_super){
	function shangdian_1UI(){
		this.WUQI1=null;
		this.WUQIMING=null;
		this.JINE=null;
		this.img0=null;
		this.GOUMAI2=null;
		this.ygm=null;
		shangdian_1UI.__super.call(this);
	}

	__class(shangdian_1UI,'ui.SLGGAME.shangdian_1UI',_super);
	var __proto=shangdian_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/shangdian_1");
	}

	return shangdian_1UI;
})(View)


//class ui.SLGGAME.skill_ziUI extends laya.ui.View
var skill_ziUI=(function(_super){
	function skill_ziUI(){
		this.ani1=null;
		this.dadi=null;
		this.ren=null;
		this.di=null;
		this.jinengming=null;
		skill_ziUI.__super.call(this);
	}

	__class(skill_ziUI,'ui.SLGGAME.skill_ziUI',_super);
	var __proto=skill_ziUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/skill_zi");
	}

	return skill_ziUI;
})(View)


//class ui.SLGGAME.tips_bz0UI extends laya.ui.View
var tips_bz0UI=(function(_super){
	function tips_bz0UI(){
		this.name0=null;
		this.img0=null;
		this.txt2=null;
		this.txt1=null;
		this.txt0=null;
		this.img1=null;
		this.xian=null;
		tips_bz0UI.__super.call(this);
	}

	__class(tips_bz0UI,'ui.SLGGAME.tips_bz0UI',_super);
	var __proto=tips_bz0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_bz0");
	}

	return tips_bz0UI;
})(View)


//class ui.SLGGAME.tips_gxbx1UI extends laya.ui.View
var tips_gxbx1UI=(function(_super){
	function tips_gxbx1UI(){
		this.btn1=null;
		this.img1=null;
		this.txt1=null;
		tips_gxbx1UI.__super.call(this);
	}

	__class(tips_gxbx1UI,'ui.SLGGAME.tips_gxbx1UI',_super);
	var __proto=tips_gxbx1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_gxbx1");
	}

	return tips_gxbx1UI;
})(View)


//class ui.SLGGAME.wujiang0_3UI extends laya.ui.View
var wujiang0_3UI=(function(_super){
	function wujiang0_3UI(){
		this.bing=null;
		this.img0=null;
		this.shu=null;
		this.chubei=null;
		this.txt0=null;
		this.qian=null;
		this.gou=null;
		this.suo=null;
		wujiang0_3UI.__super.call(this);
	}

	__class(wujiang0_3UI,'ui.SLGGAME.wujiang0_3UI',_super);
	var __proto=wujiang0_3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_3");
	}

	return wujiang0_3UI;
})(View)


//class ui.SLGGAME.wujiang0_3_bzdq0UI extends laya.ui.View
var wujiang0_3_bzdq0UI=(function(_super){
	function wujiang0_3_bzdq0UI(){
		this.kongzhi=null;
		this.name0=null;
		this.img0=null;
		this.shu=null;
		this.txt0=null;
		this.qian=null;
		wujiang0_3_bzdq0UI.__super.call(this);
	}

	__class(wujiang0_3_bzdq0UI,'ui.SLGGAME.wujiang0_3_bzdq0UI',_super);
	var __proto=wujiang0_3_bzdq0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_3_bzdq0");
	}

	return wujiang0_3_bzdq0UI;
})(View)


//class ui.SLGGAME.wujiang0_3_zz0UI extends laya.ui.View
var wujiang0_3_zz0UI=(function(_super){
	function wujiang0_3_zz0UI(){
		this.name0=null;
		this.txt0=null;
		this.btn0=null;
		this.txt_0=null;
		this.img_0=null;
		this.img0=null;
		this.shu0=null;
		this.img_s=null;
		wujiang0_3_zz0UI.__super.call(this);
	}

	__class(wujiang0_3_zz0UI,'ui.SLGGAME.wujiang0_3_zz0UI',_super);
	var __proto=wujiang0_3_zz0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_3_zz0");
	}

	return wujiang0_3_zz0UI;
})(View)


//class ui.SLGGAME.wujiang_dlzUI extends laya.ui.View
var wujiang_dlzUI=(function(_super){
	function wujiang_dlzUI(){
		this.img0=null;
		this.txt0=null;
		wujiang_dlzUI.__super.call(this);
	}

	__class(wujiang_dlzUI,'ui.SLGGAME.wujiang_dlzUI',_super);
	var __proto=wujiang_dlzUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_dlz");
	}

	return wujiang_dlzUI;
})(View)


//class ui.SLGGAME.wujiang_ka1_0UI extends laya.ui.View
var wujiang_ka1_0UI=(function(_super){
	function wujiang_ka1_0UI(){
		this.img0=null;
		this.z0=null;
		wujiang_ka1_0UI.__super.call(this);
	}

	__class(wujiang_ka1_0UI,'ui.SLGGAME.wujiang_ka1_0UI',_super);
	var __proto=wujiang_ka1_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_ka1_0");
	}

	return wujiang_ka1_0UI;
})(View)


//class ui.SLGGAME.zhandou_0UI extends laya.ui.View
var zhandou_0UI=(function(_super){
	function zhandou_0UI(){
		this.heitiao=null;
		this.hongtiao=null;
		this.name0=null;
		this.txt0=null;
		zhandou_0UI.__super.call(this);
	}

	__class(zhandou_0UI,'ui.SLGGAME.zhandou_0UI',_super);
	var __proto=zhandou_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhandou_0");
	}

	return zhandou_0UI;
})(View)


//class ui.SLGGAME.zhandou_tipsUI extends laya.ui.View
var zhandou_tipsUI=(function(_super){
	function zhandou_tipsUI(){
		this.di1=null;
		this.di0=null;
		this.html0=null;
		zhandou_tipsUI.__super.call(this);
	}

	__class(zhandou_tipsUI,'ui.SLGGAME.zhandou_tipsUI',_super);
	var __proto=zhandou_tipsUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("HTMLDivElement",HTMLDivElement);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhandou_tips");
	}

	return zhandou_tipsUI;
})(View)


//class ui.wujiangka_daUI extends laya.ui.View
var wujiangka_daUI=(function(_super){
	function wujiangka_daUI(){
		this.you=null;
		this.zuo=null;
		this.xia=null;
		this.shang=null;
		this.jiao=null;
		this.jiao1=null;
		wujiangka_daUI.__super.call(this);
	}

	__class(wujiangka_daUI,'ui.wujiangka_daUI',_super);
	var __proto=wujiangka_daUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("wujiangka_da");
	}

	return wujiangka_daUI;
})(View)


//class ui.xinshouUI extends laya.ui.View
var xinshouUI=(function(_super){
	function xinshouUI(){
		this.zuo=null;
		this.zuoren=null;
		this.zuoname=null;
		this.zuowenzi=null;
		this.you=null;
		this.youren=null;
		this.didi=null;
		this.youname=null;
		this.youwenzi=null;
		xinshouUI.__super.call(this);
	}

	__class(xinshouUI,'ui.xinshouUI',_super);
	var __proto=xinshouUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("HTMLDivElement",HTMLDivElement);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("xinshou");
	}

	return xinshouUI;
})(View)


//class ui.yuncengdongUI extends laya.ui.View
var yuncengdongUI=(function(_super){
	function yuncengdongUI(){
		yuncengdongUI.__super.call(this);;
	}

	__class(yuncengdongUI,'ui.yuncengdongUI',_super);
	var __proto=yuncengdongUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("yuncengdong");
	}

	return yuncengdongUI;
})(View)


//class ui.yuncengUI extends laya.ui.View
var yuncengUI=(function(_super){
	function yuncengUI(){
		this.yuna=null;
		yuncengUI.__super.call(this);
	}

	__class(yuncengUI,'ui.yuncengUI',_super);
	var __proto=yuncengUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("yunceng");
	}

	return yuncengUI;
})(View)


//class ui.yun_zhanUI extends laya.ui.View
var yun_zhanUI=(function(_super){
	function yun_zhanUI(){
		this.ani1=null;
		this.zuoshang=null;
		this.zuoyun1=null;
		this.zuoyun2=null;
		this.zuoyun3=null;
		this.zuoyun4=null;
		this.zuoyun5=null;
		this.zuoyun6=null;
		this.youshang=null;
		this.youyun1=null;
		this.youyun2=null;
		this.youyun3=null;
		this.youyun4=null;
		this.youyun5=null;
		this.youyun6=null;
		this.zuoxia=null;
		this.youxia=null;
		yun_zhanUI.__super.call(this);
	}

	__class(yun_zhanUI,'ui.yun_zhanUI',_super);
	var __proto=yun_zhanUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("yun_zhan");
	}

	return yun_zhanUI;
})(View)


//class ui.zhandou_zhendongUI extends laya.ui.View
var zhandou_zhendongUI=(function(_super){
	function zhandou_zhendongUI(){
		this.ani1=null;
		this.zhen=null;
		zhandou_zhendongUI.__super.call(this);
	}

	__class(zhandou_zhendongUI,'ui.zhandou_zhendongUI',_super);
	var __proto=zhandou_zhendongUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("zhandou_zhendong");
	}

	return zhandou_zhendongUI;
})(View)


//class laya.debug.ui.debugui.comps.ListItemUI extends laya.ui.View
var ListItemUI=(function(_super){
	function ListItemUI(){
		ListItemUI.__super.call(this);
	}

	__class(ListItemUI,'laya.debug.ui.debugui.comps.ListItemUI',_super);
	var __proto=ListItemUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(ListItemUI.uiView);
	}

	__proto.viewMapRegists=function(){}
	__static(ListItemUI,
	['uiView',function(){return this.uiView={"type":"View","props":{"base64pic":true,"width":244,"height":19},"child":[{"type":"Clip","props":{"y":-1,"skin":"comp/clip_selectBox.png","clipY":2,"height":19,"name":"selectBox","left":2,"right":2,"x":0}},{"type":"Label","props":{"x":25,"text":"render","color":"#dcea36","width":77,"height":17,"name":"label","y":2,"fontSize":12}},{"type":"Clip","props":{"skin":"comp/clip_tree_arrow.png","clipY":2,"name":"arrow","x":8,"y":4,"mouseEnabled":false}}]};}
	]);
	return ListItemUI;
})(View)


//class laya.debug.ui.debugui.comps.RankListItemUI extends laya.ui.View
var RankListItemUI=(function(_super){
	function RankListItemUI(){
		RankListItemUI.__super.call(this);
	}

	__class(RankListItemUI,'laya.debug.ui.debugui.comps.RankListItemUI',_super);
	var __proto=RankListItemUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(RankListItemUI.uiView);
	}

	__proto.viewMapRegists=function(){}
	__static(RankListItemUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"y":-1,"skin":"comp/clip_selectBox.png","clipY":2,"height":19,"name":"selectBox","left":0,"right":0,"x":0},"type":"Clip"},{"props":{"text":"render","color":"#a0a0a0","height":15,"name":"label","y":2,"left":11,"right":5,"fontSize":12,"x":11,"width":163},"type":"Label"}],"props":{"width":179,"height":19}};}
	]);
	return RankListItemUI;
})(View)


//class laya.debug.ui.debugui.DebugPanelUI extends laya.ui.View
var DebugPanelUI=(function(_super){
	function DebugPanelUI(){
		this.bg=null;
		this.minBtn=null;
		this.treePanel=null;
		this.selectWhenClick=null;
		this.profilePanel=null;
		this.resizeBtn=null;
		this.mouseAnalyseBtn=null;
		this.dragIcon=null;
		this.clearBtn=null;
		this.selectPanel=null;
		this.tab=null;
		DebugPanelUI.__super.call(this);
	}

	__class(DebugPanelUI,'laya.debug.ui.debugui.DebugPanelUI',_super);
	var __proto=DebugPanelUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(DebugPanelUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.view.nodeInfo.nodetree.MinBtnComp",MinBtnComp);
		View.regComponent("laya.debug.view.nodeInfo.views.NodeTreeView",NodeTreeView);
		View.regComponent("laya.debug.view.nodeInfo.nodetree.Profile",Profile);
		View.regComponent("laya.debug.view.nodeInfo.views.SelectInfosView",SelectInfosView);
	}

	__static(DebugPanelUI,
	['uiView',function(){return this.uiView={"type":"View","props":{"base64pic":true,"width":260,"height":400},"child":[{"type":"Image","props":{"x":205,"y":254,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"}},{"type":"Image","props":{"y":0,"skin":"view/bg_top.png","left":0,"right":0}},{"type":"MinBtnComp","props":{"y":-3,"var":"minBtn","runtime":"laya.debug.view.nodeInfo.nodetree.MinBtnComp","right":-3,"x":207}},{"type":"NodeTree","props":{"left":0,"right":0,"top":32,"bottom":0,"name":"节点树","var":"treePanel","runtime":"laya.debug.view.nodeInfo.views.NodeTreeView"}},{"type":"CheckBox","props":{"x":8,"y":9,"skin":"view/clickselect.png","toolTip":"点击选取","var":"selectWhenClick","mouseEnabled":true,"width":14,"height":14}},{"type":"Profile","props":{"name":"性能","top":32,"right":0,"left":0,"bottom":0,"var":"profilePanel","runtime":"laya.debug.view.nodeInfo.nodetree.Profile"}},{"type":"Button","props":{"x":169,"y":247,"skin":"view/resize.png","right":2,"bottom":2,"name":"resizeBtn","var":"resizeBtn","stateNum":3}},{"type":"Clip","props":{"y":9,"skin":"view/clickanalyse.png","var":"mouseAnalyseBtn","toolTip":"拖动选取","left":33,"x":33,"clipY":3}},{"type":"Clip","props":{"y":0,"skin":"view/clickanalyse.png","var":"dragIcon","x":33,"clipY":3}},{"type":"Button","props":{"y":7,"skin":"view/res.png","stateNum":2,"toolTip":"清除边框","var":"clearBtn","right":34,"x":184}},{"type":"SelectInfos","props":{"top":32,"left":0,"right":0,"bottom":0,"name":"选中","var":"selectPanel","runtime":"laya.debug.view.nodeInfo.views.SelectInfosView"}},{"type":"Tab","props":{"x":59,"y":0,"name":"tab","var":"tab","selectedIndex":0},"child":[{"type":"Button","props":{"skin":"view/tab_panel.png","label":"节点","width":42,"height":32,"name":"item0","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":42,"skin":"view/tab_panel.png","label":"查询","width":42,"height":32,"name":"item1","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":84,"skin":"view/tab_panel.png","label":"性能","width":42,"height":32,"name":"item2","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}}]}]};}
	]);
	return DebugPanelUI;
})(View)


//class laya.debug.ui.debugui.FindNodeSmallUI extends laya.ui.View
var FindNodeSmallUI=(function(_super){
	function FindNodeSmallUI(){
		this.bg=null;
		this.closeBtn=null;
		this.title=null;
		this.typeSelect=null;
		this.findTxt=null;
		this.findBtn=null;
		FindNodeSmallUI.__super.call(this);
	}

	__class(FindNodeSmallUI,'laya.debug.ui.debugui.FindNodeSmallUI',_super);
	var __proto=FindNodeSmallUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(FindNodeSmallUI.uiView);
	}

	__proto.viewMapRegists=function(){}
	__static(FindNodeSmallUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":185,"y":234,"skin":"view/bg_tool.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg"},"type":"Image"},{"props":{"x":185,"y":15,"skin":"view/btn_close.png","var":"closeBtn","top":2,"right":2},"type":"Button"},{"props":{"x":6,"y":4,"text":"查找对象","width":67,"height":20,"color":"#288edf","var":"title"},"type":"Label"},{"props":{"x":60,"y":81,"skin":"comp/combobox.png","labels":"name,class","width":63,"height":21,"var":"typeSelect","sizeGrid":"5,35,5,5","labelColors":"#a0a0a0,#fffff,#ffffff#fffff"},"type":"ComboBox"},{"props":{"x":27,"y":83,"text":"类型","width":27,"height":20,"color":"#288edf","align":"right"},"type":"Label"},{"props":{"x":7,"y":40,"text":"包含内容","width":47,"height":20,"color":"#288edf","align":"right"},"type":"Label"},{"props":{"x":60,"y":37,"skin":"comp/textinput.png","text":"Sprite","width":164,"height":22,"var":"findTxt","sizeGrid":"5,5,5,5","color":"#a0a0a0"},"type":"TextInput"},{"props":{"x":158,"y":79,"skin":"comp/button.png","label":"查找","width":65,"height":23,"var":"findBtn","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"},"type":"Button"}],"props":{"base64pic":true,"width":233,"height":120}};}
	]);
	return FindNodeSmallUI;
})(View)


//class laya.debug.ui.debugui.FindNodeUI extends laya.ui.View
var FindNodeUI=(function(_super){
	function FindNodeUI(){
		this.bg=null;
		this.closeBtn=null;
		this.title=null;
		this.typeSelect=null;
		this.findTxt=null;
		this.result=null;
		this.findBtn=null;
		FindNodeUI.__super.call(this);
	}

	__class(FindNodeUI,'laya.debug.ui.debugui.FindNodeUI',_super);
	var __proto=FindNodeUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(FindNodeUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.uicomps.RankListItem",RankListItem);
	}

	__static(FindNodeUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":185,"y":234,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"},"type":"Image"},{"props":{"x":185,"y":15,"skin":"view/btn_close.png","var":"closeBtn","top":2,"right":2},"type":"Button"},{"props":{"x":6,"y":4,"text":"查找对象","width":67,"height":20,"color":"#88ef19","var":"title"},"type":"Label"},{"props":{"x":52,"y":75,"skin":"comp/combobox.png","labels":"name,class","width":63,"height":21,"var":"typeSelect","sizeGrid":"5,35,5,5","labelColors":"#a0a0a0,#fffff,#ffffff#fffff"},"type":"ComboBox"},{"props":{"x":10,"y":77,"text":"类型","width":27,"height":20,"color":"#88ef19","align":"right"},"type":"Label"},{"props":{"x":7,"y":34,"text":"包含内容","width":47,"height":20,"color":"#88ef19","align":"right"},"type":"Label"},{"props":{"x":59,"y":31,"skin":"comp/textinput.png","text":"Sprite","width":131,"height":22,"var":"findTxt","sizeGrid":"5,5,5,5","color":"#a0a0a0"},"type":"TextInput"},{"type":"List","child":[{"type":"RankListItem","props":{"y":30,"left":5,"right":5,"name":"render","x":30,"runtime":"laya.debug.uicomps.RankListItem"}}],"props":{"x":6,"y":106,"width":188,"height":180,"vScrollBarSkin":"comp/vscroll.png","var":"result"}},{"props":{"x":125,"y":73,"skin":"comp/button.png","label":"查找","width":65,"height":23,"var":"findBtn","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"},"type":"Button"}],"props":{"width":200,"height":300,"base64pic":true}};}
	]);
	return FindNodeUI;
})(View)


//class laya.debug.ui.debugui.MinBtnCompUI extends laya.ui.View
var MinBtnCompUI=(function(_super){
	function MinBtnCompUI(){
		this.minBtn=null;
		this.maxUI=null;
		this.bg=null;
		this.maxBtn=null;
		MinBtnCompUI.__super.call(this);
	}

	__class(MinBtnCompUI,'laya.debug.ui.debugui.MinBtnCompUI',_super);
	var __proto=MinBtnCompUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(MinBtnCompUI.uiView);
	}

	__proto.viewMapRegists=function(){}
	__static(MinBtnCompUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":7,"y":8,"skin":"comp/minBtn.png","stateNum":"3","var":"minBtn","width":22,"height":20,"toolTip":"最小化"},"type":"Button"},{"type":"Box","child":[{"props":{"x":0,"y":0,"skin":"view/bg_panel.png","var":"bg","width":36,"height":36,"sizeGrid":"5,5,5,5"},"type":"Image"},{"props":{"x":6,"y":8,"skin":"view/zoom_out.png","stateNum":"2","var":"maxBtn"},"type":"Button"}],"props":{"var":"maxUI"}}],"props":{"width":36,"height":36,"base64pic":true}};}
	]);
	return MinBtnCompUI;
})(View)


//class laya.debug.ui.debugui.NodeListPanelUI extends laya.ui.View
var NodeListPanelUI=(function(_super){
	function NodeListPanelUI(){
		this.bg=null;
		this.closeBtn=null;
		this.title=null;
		this.itemList=null;
		NodeListPanelUI.__super.call(this);
	}

	__class(NodeListPanelUI,'laya.debug.ui.debugui.NodeListPanelUI',_super);
	var __proto=NodeListPanelUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(NodeListPanelUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.uicomps.RankListItem",RankListItem);
	}

	__static(NodeListPanelUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":235,"y":284,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"},"type":"Image"},{"props":{"x":204,"y":32,"skin":"view/btn_close.png","var":"closeBtn","top":2,"right":2,"visible":true},"type":"Button"},{"props":{"x":10,"y":6,"text":"节点信息","width":147,"height":16,"color":"#288edf","var":"title"},"type":"Label"},{"type":"List","child":[{"type":"RankListItem","props":{"left":5,"right":5,"name":"render","runtime":"laya.debug.uicomps.RankListItem"}}],"props":{"vScrollBarSkin":"comp/vscroll.png","var":"itemList","left":2,"right":2,"top":26,"bottom":0,"repeatX":1,"x":20}}],"props":{"width":200,"height":300}};}
	]);
	return NodeListPanelUI;
})(View)


//class laya.debug.ui.debugui.NodeToolUI extends laya.ui.View
var NodeToolUI=(function(_super){
	function NodeToolUI(){
		this.bg=null;
		this.closeBtn=null;
		this.tarTxt=null;
		this.freshBtn=null;
		this.mouseAnalyseBtn=null;
		this.dragIcon=null;
		NodeToolUI.__super.call(this);
	}

	__class(NodeToolUI,'laya.debug.ui.debugui.NodeToolUI',_super);
	var __proto=NodeToolUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(NodeToolUI.uiView);
	}

	__proto.viewMapRegists=function(){}
	__static(NodeToolUI,
	['uiView',function(){return this.uiView={"type":"View","props":{"base64pic":true,"width":200,"height":341},"child":[{"type":"Image","props":{"x":195,"y":244,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"}},{"type":"Label","props":{"x":9,"y":5,"text":"当前选中对象","width":67,"height":16,"color":"#a0a0a0"}},{"type":"Button","props":{"x":195,"y":25,"skin":"view/btn_close.png","var":"closeBtn","top":2,"right":2}},{"type":"Label","props":{"x":10,"y":25,"text":"当前对象","width":67,"height":16,"color":"#a0a0a0","var":"tarTxt"}},{"type":"Button","props":{"x":15,"y":65,"skin":"comp/button.png","label":"父链","width":39,"height":23,"mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":66,"y":65,"skin":"comp/button.png","label":"子","width":35,"height":23,"mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":112,"y":65,"skin":"comp/button.png","label":"兄弟","width":49,"height":23,"mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":13,"y":117,"skin":"comp/button.png","label":"Enable链","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":100,"y":117,"skin":"comp/button.png","label":"Size链","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Label","props":{"x":14,"y":97,"text":"节点链信息","width":67,"height":16,"color":"#a0a0a0"}},{"type":"Label","props":{"x":15,"y":45,"text":"对象选取","width":67,"height":16,"color":"#a0a0a0"}},{"type":"Label","props":{"x":16,"y":145,"text":"节点显示","width":67,"height":16,"color":"#a0a0a0"}},{"type":"Button","props":{"x":13,"y":164,"skin":"comp/button.png","label":"隐藏旁支","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":100,"y":164,"skin":"comp/button.png","label":"隐藏兄弟","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":13,"y":197,"skin":"comp/button.png","label":"隐藏子","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":99,"y":197,"skin":"comp/button.png","label":"恢复","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Label","props":{"x":15,"y":228,"text":"其他","width":67,"height":16,"color":"#a0a0a0"}},{"type":"Button","props":{"x":12,"y":247,"skin":"comp/button.png","label":"节点树定位","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":99,"y":247,"skin":"comp/button.png","label":"显示边框","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Label","props":{"x":12,"y":315,"text":"Alt+A分析鼠标能否够点中对象","width":173,"height":16,"color":"#a0a0a0"}},{"type":"Button","props":{"x":156,"y":1,"skin":"view/refresh2.png","var":"freshBtn","left":156,"toolTip":"recache节点"}},{"type":"Button","props":{"x":12,"y":279,"skin":"comp/button.png","label":"输出到控制台","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Button","props":{"x":99,"y":279,"skin":"comp/button.png","label":"显示切换","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"}},{"type":"Clip","props":{"y":44,"skin":"view/clickanalyse.png","var":"mouseAnalyseBtn","toolTip":"拖动到对象上方判断是否能够点中","left":84,"x":84,"clipY":3}},{"type":"Clip","props":{"y":35,"skin":"view/clickanalyse.png","var":"dragIcon","x":94,"clipY":3}}]};}
	]);
	return NodeToolUI;
})(View)


//class laya.debug.ui.debugui.NodeTreeSettingUI extends laya.ui.View
var NodeTreeSettingUI=(function(_super){
	function NodeTreeSettingUI(){
		this.bg=null;
		this.showTxt=null;
		this.okBtn=null;
		this.closeBtn=null;
		NodeTreeSettingUI.__super.call(this);
	}

	__class(NodeTreeSettingUI,'laya.debug.ui.debugui.NodeTreeSettingUI',_super);
	var __proto=NodeTreeSettingUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(NodeTreeSettingUI.uiView);
	}

	__proto.viewMapRegists=function(){}
	__static(NodeTreeSettingUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":0,"y":0,"skin":"view/bg_panel.png","left":0,"top":0,"bottom":0,"right":0,"var":"bg","width":200,"height":300,"sizeGrid":"5,5,5,5"},"type":"Image"},{"props":{"x":9,"y":7,"text":"要显示的属性","width":76,"height":16,"color":"#ffffff","align":"left"},"type":"Label"},{"props":{"x":6,"y":29,"skin":"comp/textinput.png","text":"x\\ny\\nwidth\\nheight","width":188,"height":230,"multiline":true,"var":"showTxt","color":"#a0a0a0","sizeGrid":"5,5,5,5"},"type":"TextInput"},{"props":{"x":57,"y":269,"skin":"comp/button.png","label":"确定","var":"okBtn","mouseEnabled":"true","labelColors":"#ffffff,#ffffff,#ffffff,#ffffff"},"type":"Button"},{"props":{"x":175,"y":5,"skin":"view/btn_close.png","var":"closeBtn"},"type":"Button"}],"props":{"base64pic":true,"width":200,"height":300}};}
	]);
	return NodeTreeSettingUI;
})(View)


//class laya.debug.ui.debugui.NodeTreeUI extends laya.ui.View
var NodeTreeUI=(function(_super){
	function NodeTreeUI(){
		this.nodeTree=null;
		this.controlBar=null;
		this.settingBtn=null;
		this.freshBtn=null;
		this.fliterTxt=null;
		this.closeBtn=null;
		this.ifShowProps=null;
		NodeTreeUI.__super.call(this);
	}

	__class(NodeTreeUI,'laya.debug.ui.debugui.NodeTreeUI',_super);
	var __proto=NodeTreeUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(NodeTreeUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.uicomps.TreeListItem",TreeListItem);
	}

	__static(NodeTreeUI,
	['uiView',function(){return this.uiView={"type":"View","props":{"width":200,"height":260,"base64pic":true},"child":[{"type":"Image","props":{"x":-22,"y":-47,"skin":"view/bg_panel.png","width":211,"height":206,"left":0,"right":0,"top":0,"bottom":0,"sizeGrid":"5,5,5,5"}},{"props":{"y":0,"skin":"view/bg_tool.png","left":0,"right":0},"type":"Image"},{"type":"Tree","props":{"x":0,"scrollBarSkin":"comp/vscroll.png","width":195,"height":229,"var":"nodeTree","left":0,"right":0,"top":38,"bottom":20},"child":[{"type":"ListItem","props":{"y":0,"name":"render","left":0,"right":0,"runtime":"laya.debug.uicomps.TreeListItem"}}]},{"type":"Box","props":{"x":3,"y":5,"var":"controlBar","left":3,"right":3,"top":5,"height":23},"child":[{"type":"Button","props":{"x":6,"skin":"view/setting.png","stateNum":3,"var":"settingBtn","toolTip":"设置显示的属性","y":6}},{"type":"Button","props":{"y":6,"skin":"view/refresh.png","var":"freshBtn","left":30,"toolTip":"刷新数据"}},{"type":"TextInput","props":{"y":0,"skin":"view/bg_top.png","height":22,"var":"fliterTxt","left":53,"right":0,"color":"#a0a0a0"}},{"type":"Button","props":{"x":172,"y":2,"skin":"view/btn_close.png","var":"closeBtn","right":1,"visible":false}}]},{"props":{"y":243,"skin":"comp/checkbox.png","label":"显示属性","var":"ifShowProps","bottom":3,"selected":true,"visible":true,"x":2,"width":70,"height":14,"labelColors":"#a0a0a0,#fffff,#ffffff,#fffff"},"type":"CheckBox"}]};}
	]);
	return NodeTreeUI;
})(View)


//class laya.debug.ui.debugui.ObjectCreateUI extends laya.ui.View
var ObjectCreateUI=(function(_super){
	function ObjectCreateUI(){
		this.bg=null;
		this.closeBtn=null;
		this.itemList=null;
		this.freshBtn=null;
		ObjectCreateUI.__super.call(this);
	}

	__class(ObjectCreateUI,'laya.debug.ui.debugui.ObjectCreateUI',_super);
	var __proto=ObjectCreateUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(ObjectCreateUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.uicomps.RankListItem",RankListItem);
	}

	__static(ObjectCreateUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":215,"y":264,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"},"type":"Image"},{"props":{"x":184,"y":12,"skin":"view/btn_close.png","var":"closeBtn","top":2,"right":2,"visible":false},"type":"Button"},{"props":{"x":11,"y":5,"text":"对象创建统计","width":83,"height":16,"color":"#288edf"},"type":"Label"},{"type":"List","child":[{"type":"RankListItem","props":{"y":0,"left":5,"right":5,"name":"render","runtime":"laya.debug.uicomps.RankListItem"}}],"props":{"vScrollBarSkin":"comp/vscroll.png","var":"itemList","top":26,"bottom":5,"left":5,"right":5,"repeatX":1}},{"props":{"y":1,"skin":"view/refresh2.png","var":"freshBtn","toolTip":"刷新数据","right":1,"x":178},"type":"Button"}],"props":{"width":200,"height":300,"base64pic":true}};}
	]);
	return ObjectCreateUI;
})(View)


//class laya.debug.ui.debugui.ObjectInfoUI extends laya.ui.View
var ObjectInfoUI=(function(_super){
	function ObjectInfoUI(){
		this.bg=null;
		this.title=null;
		this.showTxt=null;
		this.closeBtn=null;
		this.autoUpdate=null;
		this.settingBtn=null;
		ObjectInfoUI.__super.call(this);
	}

	__class(ObjectInfoUI,'laya.debug.ui.debugui.ObjectInfoUI',_super);
	var __proto=ObjectInfoUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(ObjectInfoUI.uiView);
	}

	__proto.viewMapRegists=function(){}
	__static(ObjectInfoUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":-1,"y":0,"skin":"view/bg_panel.png","left":-1,"right":1,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"},"type":"Image"},{"props":{"x":7,"y":5,"text":"对象类型","width":67,"height":20,"color":"#ffffff","var":"title","left":7,"right":6},"type":"Label"},{"props":{"x":2,"skin":"comp/textinput.png","text":"属性内容","width":196,"height":228,"left":2,"right":2,"var":"showTxt","top":25,"bottom":20,"editable":false,"multiline":true,"sizeGrid":"5,5,5,5","color":"#a0a0a0"},"type":"TextArea"},{"props":{"x":178,"y":4,"skin":"view/btn_close.png","var":"closeBtn","top":4,"right":2},"type":"Button"},{"props":{"skin":"comp/checkbox.png","label":"自动刷新属性","var":"autoUpdate","bottom":2,"x":3,"labelColors":"#a0a0a0,#fffff,#ffffff,#fffff"},"type":"CheckBox"},{"props":{"x":164,"skin":"view/setting.png","stateNum":"3","var":"settingBtn","y":6,"top":6,"right":24,"toolTip":"设置显示属性"},"type":"Button"},{"props":{"x":179,"y":257,"skin":"view/resize.png","right":2,"bottom":2,"name":"resizeBtn","stateNum":3},"type":"Button"}],"props":{"base64pic":true,"width":200,"height":200}};}
	]);
	return ObjectInfoUI;
})(View)


//class laya.debug.ui.debugui.OutPutUI extends laya.ui.View
var OutPutUI=(function(_super){
	function OutPutUI(){
		this.bg=null;
		this.txt=null;
		this.closeBtn=null;
		this.clearBtn=null;
		OutPutUI.__super.call(this);
	}

	__class(OutPutUI,'laya.debug.ui.debugui.OutPutUI',_super);
	var __proto=OutPutUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(OutPutUI.uiView);
	}

	__proto.viewMapRegists=function(){}
	__static(OutPutUI,
	['uiView',function(){return this.uiView={"type":"View","props":{"width":300,"height":200,"base64pic":true},"child":[{"type":"Image","props":{"x":205,"y":254,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"}},{"type":"Label","props":{"skin":"comp/textarea.png","text":"TextArea","color":"#a0a0a0","var":"txt","left":5,"right":5,"top":22,"bottom":5,"mouseEnabled":true,"sizeGrid":"3,3,3,3"}},{"type":"Button","props":{"x":185,"y":15,"skin":"view/btn_close.png","var":"closeBtn","top":2,"right":2}},{"props":{"x":253,"y":1,"skin":"view/re.png","stateNum":"2","var":"clearBtn","right":25},"type":"Button"},{"props":{"x":169,"y":247,"skin":"view/resize.png","right":2,"bottom":2,"name":"resizeBtn","stateNum":3},"type":"Button"}]};}
	]);
	return OutPutUI;
})(View)


//class laya.debug.ui.debugui.ProfileUI extends laya.ui.View
var ProfileUI=(function(_super){
	function ProfileUI(){
		this.renderPanel=null;
		this.createPanel=null;
		this.cachePanel=null;
		this.tab=null;
		this.resPanel=null;
		ProfileUI.__super.call(this);
	}

	__class(ProfileUI,'laya.debug.ui.debugui.ProfileUI',_super);
	var __proto=ProfileUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(ProfileUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.view.nodeInfo.views.RenderCostRankView",RenderCostRankView);
		View.regComponent("laya.debug.view.nodeInfo.views.ObjectCreateView",ObjectCreateView);
		View.regComponent("laya.debug.view.nodeInfo.views.CacheRankView",CacheRankView);
		View.regComponent("laya.debug.view.nodeInfo.views.ResRankView",ResRankView);
	}

	__static(ProfileUI,
	['uiView',function(){return this.uiView={"type":"View","props":{"width":260,"height":329,"base64pic":true},"child":[{"type":"Image","props":{"y":0,"skin":"view/bg_tool.png","right":0,"left":0}},{"type":"Rank","props":{"var":"renderPanel","top":29,"runtime":"laya.debug.view.nodeInfo.views.RenderCostRankView","right":0,"name":"渲染用时","left":0,"bottom":0}},{"type":"ObjectCreate","props":{"var":"createPanel","top":29,"runtime":"laya.debug.view.nodeInfo.views.ObjectCreateView","right":0,"name":"对象创建统计","left":0,"bottom":0}},{"type":"Rank","props":{"x":10,"var":"cachePanel","top":29,"runtime":"laya.debug.view.nodeInfo.views.CacheRankView","right":0,"name":"cache用时","left":0,"bottom":0}},{"type":"Tab","props":{"y":9,"x":7,"width":191,"var":"tab","selectedIndex":0,"height":19},"child":[{"type":"CheckBox","props":{"y":0,"x":0,"width":50,"skin":"view/create.png","name":"item0","labelColors":"#a0a0a0,#ffffff,#ffffff,#ffffff","label":"  对象","height":17}},{"type":"CheckBox","props":{"y":0,"x":55,"width":50,"skin":"view/rendertime.png","name":"item1","labelColors":"#a0a0a0,#ffffff,#ffffff,#ffffff","label":" 渲染","height":19}},{"type":"CheckBox","props":{"y":0,"x":110,"width":50,"skin":"view/cache.png","name":"item2","labelColors":"#a0a0a0,#ffffff,#ffffff,#ffffff","label":" 重绘","height":16}},{"type":"CheckBox","props":{"y":0,"x":165,"width":50,"skin":"view/cache.png","name":"item3","labelColors":"#a0a0a0,#ffffff,#ffffff,#ffffff","label":" 资源","height":16}}]},{"type":"Rank","props":{"y":40,"x":50,"var":"resPanel","top":29,"runtime":"laya.debug.view.nodeInfo.views.ResRankView","right":0,"name":"资源缓存","left":0,"bottom":0}}]};}
	]);
	return ProfileUI;
})(View)


//class laya.debug.ui.debugui.RankUI extends laya.ui.View
var RankUI=(function(_super){
	function RankUI(){
		this.bg=null;
		this.closeBtn=null;
		this.title=null;
		this.itemList=null;
		this.autoUpdate=null;
		this.freshBtn=null;
		RankUI.__super.call(this);
	}

	__class(RankUI,'laya.debug.ui.debugui.RankUI',_super);
	var __proto=RankUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(RankUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.uicomps.RankListItem",RankListItem);
	}

	__static(RankUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":225,"y":274,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"},"type":"Image"},{"props":{"x":194,"y":22,"skin":"view/btn_close.png","var":"closeBtn","top":2,"right":2,"visible":false},"type":"Button"},{"props":{"x":8,"y":5,"text":"渲染用时表(3000ms)","width":109,"height":16,"color":"#288edf","var":"title"},"type":"Label"},{"type":"List","child":[{"type":"RankListItem","props":{"left":5,"right":5,"name":"render","runtime":"laya.debug.uicomps.RankListItem"}}],"props":{"vScrollBarSkin":"comp/vscroll.png","var":"itemList","left":2,"right":2,"top":26,"bottom":25,"repeatX":1,"x":10,"y":10}},{"props":{"skin":"comp/checkbox.png","label":"自动刷新属性","var":"autoUpdate","bottom":3,"selected":false,"visible":true,"left":2,"labelColors":"#a0a0a0,#fffff,#ffffff,#fffff"},"type":"CheckBox"},{"props":{"y":1,"skin":"view/refresh2.png","var":"freshBtn","toolTip":"刷新数据","right":1},"type":"Button"}],"props":{"width":200,"height":300}};}
	]);
	return RankUI;
})(View)


//class laya.debug.ui.debugui.SelectInfosUI extends laya.ui.View
var SelectInfosUI=(function(_super){
	function SelectInfosUI(){
		this.bg=null;
		this.closeBtn=null;
		this.selectList=null;
		this.findBtn=null;
		this.fliterTxt=null;
		SelectInfosUI.__super.call(this);
	}

	__class(SelectInfosUI,'laya.debug.ui.debugui.SelectInfosUI',_super);
	var __proto=SelectInfosUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(SelectInfosUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.uicomps.RankListItem",RankListItem);
	}

	__static(SelectInfosUI,
	['uiView',function(){return this.uiView={"type":"View","child":[{"props":{"x":205,"y":254,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"},"type":"Image"},{"props":{"skin":"view/btn_close.png","var":"closeBtn","top":32,"visible":false,"right":2},"type":"Button"},{"props":{"x":7,"y":36,"text":"当前选中列表","width":83,"height":16,"color":"#288edf"},"type":"Label"},{"type":"List","child":[{"type":"RankListItem","props":{"left":5,"right":5,"name":"render","runtime":"laya.debug.uicomps.RankListItem"}}],"props":{"vScrollBarSkin":"comp/vscroll.png","var":"selectList","left":5,"right":5,"top":56,"bottom":25,"repeatX":1,"x":20}},{"props":{"x":6,"text":"Alt+V选取鼠标下的对象","width":189,"height":16,"color":"#a0a0a0","bottom":3},"type":"Label"},{"type":"Image","props":{"y":0,"skin":"view/bg_tool.png","left":0,"right":0}},{"type":"Clip","props":{"y":6,"skin":"view/search.png","clipY":2,"var":"findBtn","right":5,"toolTip":"查找","x":174}},{"type":"TextInput","props":{"y":6,"skin":"view/bg_top.png","height":22,"var":"fliterTxt","left":8,"right":45,"color":"#a0a0a0","x":8,"width":147}}],"props":{"width":200,"height":300,"base64pic":true}};}
	]);
	return SelectInfosUI;
})(View)


//class laya.debug.ui.debugui.ToolBarUI extends laya.ui.View
var ToolBarUI=(function(_super){
	function ToolBarUI(){
		this.bg=null;
		this.treeBtn=null;
		this.findBtn=null;
		this.minBtn=null;
		this.selectWhenClick=null;
		this.clearBtn=null;
		this.rankBtn=null;
		this.nodeRankBtn=null;
		this.cacheBtn=null;
		ToolBarUI.__super.call(this);
	}

	__class(ToolBarUI,'laya.debug.ui.debugui.ToolBarUI',_super);
	var __proto=ToolBarUI.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
		laya.ui.Component.prototype.createChildren.call(this);
		this.createView(ToolBarUI.uiView);
	}

	__proto.viewMapRegists=function(){
		View.regComponent("laya.debug.view.nodeInfo.nodetree.MinBtnComp",MinBtnComp);
	}

	__static(ToolBarUI,
	['uiView',function(){return this.uiView={"type":"View","props":{"base64pic":true,"width":250,"height":30},"child":[{"type":"Image","props":{"x":195,"y":244,"skin":"view/bg_panel.png","left":0,"right":0,"top":0,"bottom":0,"var":"bg","sizeGrid":"5,5,5,5"}},{"type":"Button","props":{"x":2,"y":6,"skin":"view/save.png","stateNum":2,"var":"treeBtn","toolTip":"节点树"}},{"type":"Button","props":{"x":25,"y":6,"skin":"view/save.png","stateNum":2,"var":"findBtn","toolTip":"查找面板"}},{"type":"MinBtnComp","props":{"x":218,"y":-3,"var":"minBtn","runtime":"laya.debug.view.nodeInfo.nodetree.MinBtnComp"}},{"type":"CheckBox","props":{"x":124,"y":8,"skin":"comp/checkbox.png","label":"点击选取","var":"selectWhenClick","labelColors":"#a0a0a0,#fffff,#ffffff,#fffff"}},{"type":"Button","props":{"x":193,"y":5,"skin":"view/res.png","stateNum":2,"toolTip":"清除边框","var":"clearBtn"}},{"type":"Button","props":{"x":49,"y":6,"skin":"view/save.png","stateNum":2,"var":"rankBtn","toolTip":"渲染用时排行"}},{"type":"Button","props":{"x":72,"y":6,"skin":"view/save.png","stateNum":2,"var":"nodeRankBtn","toolTip":"创建对象排行"}},{"type":"Button","props":{"x":94,"y":6,"skin":"view/save.png","stateNum":2,"var":"cacheBtn","toolTip":"cache对象"}}]};}
	]);
	return ToolBarUI;
})(View)


/**
*<code>Tab</code> 组件用来定义选项卡按钮组。 *
*@internal <p>属性：<code>selectedIndex</code> 的默认值为-1。</p>
*
*@example <caption>以下示例代码，创建了一个 <code>Tab</code> 实例。</caption>
*package
*{
	*import laya.ui.Tab;
	*import laya.utils.Handler;
	*public class Tab_Example
	*{
		*public function Tab_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/tab.png"],Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*var tab:Tab=new Tab();//创建一个 Tab 类的实例对象 tab 。
			*tab.skin="resource/ui/tab.png";//设置 tab 的皮肤。
			*tab.labels="item0,item1,item2";//设置 tab 的标签集。
			*tab.x=100;//设置 tab 对象的属性 x 的值，用于控制 tab 对象的显示位置。
			*tab.y=100;//设置 tab 对象的属性 y 的值，用于控制 tab 对象的显示位置。
			*tab.selectHandler=new Handler(this,onSelect);//设置 tab 的选择项发生改变时执行的处理器。
			*Laya.stage.addChild(tab);//将 tab 添到显示列表。
			*}
		*private function onSelect(index:int):void
		*{
			*trace("当前选择的表情页索引: index= ",index);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*Laya.loader.load(["resource/ui/tab.png"],laya.utils.Handler.create(this,onLoadComplete));
*function onLoadComplete(){
	*var tab=new laya.ui.Tab();//创建一个 Tab 类的实例对象 tab 。
	*tab.skin="resource/ui/tab.png";//设置 tab 的皮肤。
	*tab.labels="item0,item1,item2";//设置 tab 的标签集。
	*tab.x=100;//设置 tab 对象的属性 x 的值，用于控制 tab 对象的显示位置。
	*tab.y=100;//设置 tab 对象的属性 y 的值，用于控制 tab 对象的显示位置。
	*tab.selectHandler=new laya.utils.Handler(this,onSelect);//设置 tab 的选择项发生改变时执行的处理器。
	*Laya.stage.addChild(tab);//将 tab 添到显示列表。
	*}
*function onSelect(index){
	*console.log("当前选择的标签页索引: index= ",index);
	*}
*@example
*import Tab=laya.ui.Tab;
*import Handler=laya.utils.Handler;
*class Tab_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/tab.png"],Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*var tab:Tab=new Tab();//创建一个 Tab 类的实例对象 tab 。
		*tab.skin="resource/ui/tab.png";//设置 tab 的皮肤。
		*tab.labels="item0,item1,item2";//设置 tab 的标签集。
		*tab.x=100;//设置 tab 对象的属性 x 的值，用于控制 tab 对象的显示位置。
		*tab.y=100;//设置 tab 对象的属性 y 的值，用于控制 tab 对象的显示位置。
		*tab.selectHandler=new Handler(this,this.onSelect);//设置 tab 的选择项发生改变时执行的处理器。
		*Laya.stage.addChild(tab);//将 tab 添到显示列表。
		*}
	*private onSelect(index:number):void {
		*console.log("当前选择的表情页索引: index= ",index);
		*}
	*}
*/
//class laya.ui.Tab extends laya.ui.UIGroup
var Tab=(function(_super){
	function Tab(){
		Tab.__super.call(this);;
	}

	__class(Tab,'laya.ui.Tab',_super);
	var __proto=Tab.prototype;
	/**
	*@private
	*@inheritDoc
	*/
	__proto.createItem=function(skin,label){
		return new Button(skin,label);
	}

	return Tab;
})(UIGroup)


/**
*
*@author ww
*@version 1.0
*
*@created 2016-7-6 上午9:42:46
*/
//class laya.debug.uicomps.ListBase extends laya.ui.List
var ListBase=(function(_super){
	function ListBase(){
		ListBase.__super.call(this);
	}

	__class(ListBase,'laya.debug.uicomps.ListBase',_super);
	var __proto=ListBase.prototype;
	__getset(0,__proto,'selectedIndex',_super.prototype._$get_selectedIndex,function(value){
		if (this._selectedIndex !=value){
			this._selectedIndex=value;
			this.changeSelectStatus();
			this.event("change");
			this.selectHandler && this.selectHandler.runWith(value);
		}
		if (this.selectEnable && this._scrollBar){
			var numX=this._isVertical ? this.repeatX :this.repeatY;
			if (value < this._startIndex || (value+numX > this._startIndex+this.repeatX *this.repeatY)){
				this.scrollTo(value);
			}
		}
	});

	return ListBase;
})(List)


/**
*<code>RadioGroup</code> 控件定义一组 <code>Radio</code> 控件，这些控件相互排斥；
*因此，用户每次只能选择一个 <code>Radio</code> 控件。
*
*@example <caption>以下示例代码，创建了一个 <code>RadioGroup</code> 实例。</caption>
*package
*{
	*import laya.ui.Radio;
	*import laya.ui.RadioGroup;
	*import laya.utils.Handler;
	*public class RadioGroup_Example
	*{
		*public function RadioGroup_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/radio.png"],Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*var radioGroup:RadioGroup=new RadioGroup();//创建一个 RadioGroup 类的实例对象 radioGroup 。
			*radioGroup.pos(100,100);//设置 radioGroup 的位置信息。
			*radioGroup.labels="item0,item1,item2";//设置 radioGroup 的标签集。
			*radioGroup.skin="resource/ui/radio.png";//设置 radioGroup 的皮肤。
			*radioGroup.space=10;//设置 radioGroup 的项间隔距离。
			*radioGroup.selectHandler=new Handler(this,onSelect);//设置 radioGroup 的选择项发生改变时执行的处理器。
			*Laya.stage.addChild(radioGroup);//将 radioGroup 添加到显示列表。
			*}
		*private function onSelect(index:int):void
		*{
			*trace("当前选择的单选按钮索引: index= ",index);
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高、渲染模式
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*Laya.loader.load(["resource/ui/radio.png"],laya.utils.Handler.create(this,onLoadComplete));
*function onLoadComplete(){
	*var radioGroup=new laya.ui.RadioGroup();//创建一个 RadioGroup 类的实例对象 radioGroup 。
	*radioGroup.pos(100,100);//设置 radioGroup 的位置信息。
	*radioGroup.labels="item0,item1,item2";//设置 radioGroup 的标签集。
	*radioGroup.skin="resource/ui/radio.png";//设置 radioGroup 的皮肤。
	*radioGroup.space=10;//设置 radioGroup 的项间隔距离。
	*radioGroup.selectHandler=new laya.utils.Handler(this,onSelect);//设置 radioGroup 的选择项发生改变时执行的处理器。
	*Laya.stage.addChild(radioGroup);//将 radioGroup 添加到显示列表。
	*}
*function onSelect(index){
	*console.log("当前选择的单选按钮索引: index= ",index);
	*}
*@example
*import Radio=laya.ui.Radio;
*import RadioGroup=laya.ui.RadioGroup;
*import Handler=laya.utils.Handler;
*class RadioGroup_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/radio.png"],Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*var radioGroup:RadioGroup=new RadioGroup();//创建一个 RadioGroup 类的实例对象 radioGroup 。
		*radioGroup.pos(100,100);//设置 radioGroup 的位置信息。
		*radioGroup.labels="item0,item1,item2";//设置 radioGroup 的标签集。
		*radioGroup.skin="resource/ui/radio.png";//设置 radioGroup 的皮肤。
		*radioGroup.space=10;//设置 radioGroup 的项间隔距离。
		*radioGroup.selectHandler=new Handler(this,this.onSelect);//设置 radioGroup 的选择项发生改变时执行的处理器。
		*Laya.stage.addChild(radioGroup);//将 radioGroup 添加到显示列表。
		*}
	*private onSelect(index:number):void {
		*console.log("当前选择的单选按钮索引: index= ",index);
		*}
	*}
*/
//class laya.ui.RadioGroup extends laya.ui.UIGroup
var RadioGroup=(function(_super){
	function RadioGroup(){
		RadioGroup.__super.call(this);;
	}

	__class(RadioGroup,'laya.ui.RadioGroup',_super);
	var __proto=RadioGroup.prototype;
	/**@inheritDoc */
	__proto.createItem=function(skin,label){
		return new Radio(skin,label);
	}

	return RadioGroup;
})(UIGroup)


/**
*
*@author ww
*@version 1.0
*
*@created 2016-7-6 上午9:49:47
*/
//class laya.debug.uicomps.TreeBase extends laya.ui.Tree
var TreeBase=(function(_super){
	function TreeBase(){
		TreeBase.__super.call(this);
	}

	__class(TreeBase,'laya.debug.uicomps.TreeBase',_super);
	var __proto=TreeBase.prototype;
	/**@inheritDoc */
	__proto.createChildren=function(){
		this.addChild(this._list=new ListBase());
		this._list.renderHandler=Handler.create(this,this.renderItem,null,false);
		this._list.repeatX=1;
		this._list.on("change",this,this.onListChange);
	}

	return TreeBase;
})(Tree)


/**
*<code>HBox</code> 是一个水平布局容器类。
*/
//class laya.ui.HBox extends laya.ui.LayoutBox
var HBox=(function(_super){
	function HBox(){
		HBox.__super.call(this);;
	}

	__class(HBox,'laya.ui.HBox',_super);
	var __proto=HBox.prototype;
	/**@inheritDoc */
	__proto.sortItem=function(items){
		if (items)items.sort(function(a,b){return a.x-b.x;});
	}

	/**@inheritDoc */
	__proto.changeItems=function(){
		this._itemChanged=false;
		var items=[];
		var maxHeight=0;
		for (var i=0,n=this.numChildren;i < n;i++){
			var item=this.getChildAt(i);
			if (item&&item.layoutEnabled){
				items.push(item);
				maxHeight=this._height?this._height:Math.max(maxHeight,item.height *item.scaleY);
			}
		}
		this.sortItem(items);
		var left=0;
		for (i=0,n=items.length;i < n;i++){
			item=items[i];
			item.x=left;
			left+=item.width *item.scaleX+this._space;
			if (this._align=="top"){
				item.y=0;
				}else if (this._align=="middle"){
				item.y=(maxHeight-item.height *item.scaleY)*0.5;
				}else if (this._align=="bottom"){
				item.y=maxHeight-item.height *item.scaleY;
			}
		}
		this.changeSize();
	}

	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		if (this._height !=value){
			Laya.superSet(LayoutBox,this,'height',value);
			this.callLater(this.changeItems);
		}
	});

	HBox.NONE="none";
	HBox.TOP="top";
	HBox.MIDDLE="middle";
	HBox.BOTTOM="bottom";
	return HBox;
})(LayoutBox)


/**
*<code>VBox</code> 是一个垂直布局容器类。
*/
//class laya.ui.VBox extends laya.ui.LayoutBox
var VBox=(function(_super){
	function VBox(){
		VBox.__super.call(this);;
	}

	__class(VBox,'laya.ui.VBox',_super);
	var __proto=VBox.prototype;
	/**@inheritDoc */
	__proto.changeItems=function(){
		this._itemChanged=false;
		var items=[];
		var maxWidth=0;
		for (var i=0,n=this.numChildren;i < n;i++){
			var item=this.getChildAt(i);
			if (item&&item.layoutEnabled){
				items.push(item);
				maxWidth=this._width?this._width:Math.max(maxWidth,item.width *item.scaleX);
			}
		}
		this.sortItem(items);
		var top=0;
		for (i=0,n=items.length;i < n;i++){
			item=items[i];
			item.y=top;
			top+=item.height *item.scaleY+this._space;
			if (this._align=="left"){
				item.x=0;
				}else if (this._align=="center"){
				item.x=(maxWidth-item.width *item.scaleX)*0.5;
				}else if (this._align=="right"){
				item.x=maxWidth-item.width *item.scaleX;
			}
		}
		this.changeSize();
	}

	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		if (this._width !=value){
			Laya.superSet(LayoutBox,this,'width',value);
			this.callLater(this.changeItems);
		}
	});

	VBox.NONE="none";
	VBox.LEFT="left";
	VBox.CENTER="center";
	VBox.RIGHT="right";
	return VBox;
})(LayoutBox)


/**
*<code>TextArea</code> 类用于创建显示对象以显示和输入文本。
*@example <caption>以下示例代码，创建了一个 <code>TextArea</code> 实例。</caption>
*package
*{
	*import laya.ui.TextArea;
	*import laya.utils.Handler;
	*public class TextArea_Example
	*{
		*public function TextArea_Example()
		*{
			*Laya.init(640,800);//设置游戏画布宽高。
			*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
			*Laya.loader.load(["resource/ui/input.png"],Handler.create(this,onLoadComplete));//加载资源。
			*}
		*private function onLoadComplete():void
		*{
			*var textArea:TextArea=new TextArea("这个一个TextArea实例。");//创建一个 TextArea 类的实例对象 textArea 。
			*textArea.skin="resource/ui/input.png";//设置 textArea 的皮肤。
			*textArea.sizeGrid="4,4,4,4";//设置 textArea 的网格信息。
			*textArea.color="#008fff";//设置 textArea 的文本颜色。
			*textArea.font="Arial";//设置 textArea 的字体。
			*textArea.bold=true;//设置 textArea 的文本显示为粗体。
			*textArea.fontSize=20;//设置 textArea 的文本字体大小。
			*textArea.wordWrap=true;//设置 textArea 的文本自动换行。
			*textArea.x=100;//设置 textArea 对象的属性 x 的值，用于控制 textArea 对象的显示位置。
			*textArea.y=100;//设置 textArea 对象的属性 y 的值，用于控制 textArea 对象的显示位置。
			*textArea.width=300;//设置 textArea 的宽度。
			*textArea.height=200;//设置 textArea 的高度。
			*Laya.stage.addChild(textArea);//将 textArea 添加到显示列表。
			*}
		*}
	*}
*@example
*Laya.init(640,800);//设置游戏画布宽高、渲染模式
*Laya.stage.bgColor="#efefef";//设置画布的背景颜色
*Laya.loader.load(["resource/ui/input.png"],laya.utils.Handler.create(this,onLoadComplete));//加载资源。
*function onLoadComplete(){
	*var textArea=new laya.ui.TextArea("这个一个TextArea实例。");//创建一个 TextArea 类的实例对象 textArea 。
	*textArea.skin="resource/ui/input.png";//设置 textArea 的皮肤。
	*textArea.sizeGrid="4,4,4,4";//设置 textArea 的网格信息。
	*textArea.color="#008fff";//设置 textArea 的文本颜色。
	*textArea.font="Arial";//设置 textArea 的字体。
	*textArea.bold=true;//设置 textArea 的文本显示为粗体。
	*textArea.fontSize=20;//设置 textArea 的文本字体大小。
	*textArea.wordWrap=true;//设置 textArea 的文本自动换行。
	*textArea.x=100;//设置 textArea 对象的属性 x 的值，用于控制 textArea 对象的显示位置。
	*textArea.y=100;//设置 textArea 对象的属性 y 的值，用于控制 textArea 对象的显示位置。
	*textArea.width=300;//设置 textArea 的宽度。
	*textArea.height=200;//设置 textArea 的高度。
	*Laya.stage.addChild(textArea);//将 textArea 添加到显示列表。
	*}
*@example
*import TextArea=laya.ui.TextArea;
*import Handler=laya.utils.Handler;
*class TextArea_Example {
	*constructor(){
		*Laya.init(640,800);//设置游戏画布宽高、渲染模式。
		*Laya.stage.bgColor="#efefef";//设置画布的背景颜色。
		*Laya.loader.load(["resource/ui/input.png"],Handler.create(this,this.onLoadComplete));//加载资源。
		*}
	*private onLoadComplete():void {
		*var textArea:TextArea=new TextArea("这个一个TextArea实例。");//创建一个 TextArea 类的实例对象 textArea 。
		*textArea.skin="resource/ui/input.png";//设置 textArea 的皮肤。
		*textArea.sizeGrid="4,4,4,4";//设置 textArea 的网格信息。
		*textArea.color="#008fff";//设置 textArea 的文本颜色。
		*textArea.font="Arial";//设置 textArea 的字体。
		*textArea.bold=true;//设置 textArea 的文本显示为粗体。
		*textArea.fontSize=20;//设置 textArea 的文本字体大小。
		*textArea.wordWrap=true;//设置 textArea 的文本自动换行。
		*textArea.x=100;//设置 textArea 对象的属性 x 的值，用于控制 textArea 对象的显示位置。
		*textArea.y=100;//设置 textArea 对象的属性 y 的值，用于控制 textArea 对象的显示位置。
		*textArea.width=300;//设置 textArea 的宽度。
		*textArea.height=200;//设置 textArea 的高度。
		*Laya.stage.addChild(textArea);//将 textArea 添加到显示列表。
		*}
	*}
*/
//class laya.ui.TextArea extends laya.ui.TextInput
var TextArea=(function(_super){
	function TextArea(text){
		/**@private */
		this._vScrollBar=null;
		/**@private */
		this._hScrollBar=null;
		(text===void 0)&& (text="");
		TextArea.__super.call(this,text);
	}

	__class(TextArea,'laya.ui.TextArea',_super);
	var __proto=TextArea.prototype;
	__proto.destroy=function(destroyChild){
		(destroyChild===void 0)&& (destroyChild=true);
		_super.prototype.destroy.call(this,destroyChild);
		this._vScrollBar && this._vScrollBar.destroy();
		this._hScrollBar && this._hScrollBar.destroy();
		this._vScrollBar=null;
		this._hScrollBar=null;
	}

	__proto.initialize=function(){
		this.width=180;
		this.height=150;
		this._tf.wordWrap=true;
		this.multiline=true;
	}

	__proto.onVBarChanged=function(e){
		if (this._tf.scrollY !=this._vScrollBar.value){
			this._tf.scrollY=this._vScrollBar.value;
		}
	}

	__proto.onHBarChanged=function(e){
		if (this._tf.scrollX !=this._hScrollBar.value){
			this._tf.scrollX=this._hScrollBar.value;
		}
	}

	__proto.changeScroll=function(){
		var vShow=this._vScrollBar && this._tf.maxScrollY > 0;
		var hShow=this._hScrollBar && this._tf.maxScrollX > 0;
		var showWidth=vShow ? this._width-this._vScrollBar.width :this._width;
		var showHeight=hShow ? this._height-this._hScrollBar.height :this._height;
		var padding=this._tf.padding || Styles.labelPadding;
		this._tf.width=showWidth;
		this._tf.height=showHeight;
		if (this._vScrollBar){
			this._vScrollBar.x=this._width-this._vScrollBar.width-padding[2];
			this._vScrollBar.y=padding[1];
			this._vScrollBar.height=this._height-(hShow ? this._hScrollBar.height :0)-padding[1]-padding[3];
			this._vScrollBar.scrollSize=1;
			this._vScrollBar.thumbPercent=showHeight / Math.max(this._tf.textHeight,showHeight);
			this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY);
			this._vScrollBar.visible=vShow;
		}
		if (this._hScrollBar){
			this._hScrollBar.x=padding[0];
			this._hScrollBar.y=this._height-this._hScrollBar.height-padding[3];
			this._hScrollBar.width=this._width-(vShow ? this._vScrollBar.width :0)-padding[0]-padding[2];
			this._hScrollBar.scrollSize=Math.max(showWidth *0.033,1);
			this._hScrollBar.thumbPercent=showWidth / Math.max(this._tf.textWidth,showWidth);
			this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX);
			this._hScrollBar.visible=hShow;
		}
	}

	/**滚动到某个位置*/
	__proto.scrollTo=function(y){
		this.commitMeasure();
		this._tf.scrollY=y;
	}

	/**垂直滚动值*/
	__getset(0,__proto,'scrollY',function(){
		return this._tf.scrollY;
	});

	__getset(0,__proto,'width',_super.prototype._$get_width,function(value){
		Laya.superSet(TextInput,this,'width',value);
		this.callLater(this.changeScroll);
	});

	/**水平滚动条实体*/
	__getset(0,__proto,'hScrollBar',function(){
		return this._hScrollBar;
	});

	__getset(0,__proto,'height',_super.prototype._$get_height,function(value){
		Laya.superSet(TextInput,this,'height',value);
		this.callLater(this.changeScroll);
	});

	/**水平滚动最大值*/
	__getset(0,__proto,'maxScrollX',function(){
		return this._tf.maxScrollX;
	});

	/**垂直滚动条皮肤*/
	__getset(0,__proto,'vScrollBarSkin',function(){
		return this._vScrollBar ? this._vScrollBar.skin :null;
		},function(value){
		if (this._vScrollBar==null){
			this.addChild(this._vScrollBar=new VScrollBar());
			this._vScrollBar.on("change",this,this.onVBarChanged);
			this._vScrollBar.target=this._tf;
			this.callLater(this.changeScroll);
		}
		this._vScrollBar.skin=value;
	});

	/**水平滚动条皮肤*/
	__getset(0,__proto,'hScrollBarSkin',function(){
		return this._hScrollBar ? this._hScrollBar.skin :null;
		},function(value){
		if (this._hScrollBar==null){
			this.addChild(this._hScrollBar=new HScrollBar());
			this._hScrollBar.on("change",this,this.onHBarChanged);
			this._hScrollBar.mouseWheelEnable=false;
			this._hScrollBar.target=this._tf;
			this.callLater(this.changeScroll);
		}
		this._hScrollBar.skin=value;
	});

	/**垂直滚动条实体*/
	__getset(0,__proto,'vScrollBar',function(){
		return this._vScrollBar;
	});

	/**垂直滚动最大值*/
	__getset(0,__proto,'maxScrollY',function(){
		return this._tf.maxScrollY;
	});

	/**水平滚动值*/
	__getset(0,__proto,'scrollX',function(){
		return this._tf.scrollX;
	});

	return TextArea;
})(TextInput)


//class fight.BattleFileScene extends ui.SLGGAME.zhandouUI
var BattleFileScene=(function(_super){
	function BattleFileScene(){
		this.speedArr=[1,2,4];
		this.turnSp=null;
		this.headEffect=null;
		this.autoResize=null;
		/**射箭 */
		this.shoot=null;
		/**技能 */
		this.skill=null;
		/**普攻 */
		this.normal=null;
		/**起手就攻击 策士 */
		this.remote=null;
		this.explainDialog=null;
		this.wallHeroArr=[];
		this.heroArr=[];
		this.fontArr=[];
		this.stopFuHuo=false;
		//停止复活
		this.fuhuoData=null;
		////////////////////
		this.battleData=null;
		this.zorderArr=[3,4,5,0,1,2,26,27,28,29,30,31];
		BattleFileScene.__super.call(this);
		this.scaleManager=new ScaleManager();
		this.leftGroupSkill=new GroupSkill();
		this.rightGroupSkill=new GroupSkill();
		this.cheng.visible=false;
		var zhen=new zhandou_zhendongUI();
		Shake.setShakeUI(zhen.ani1,zhen.zhen);
		BattleFileScene.instance=this;
		this.shoot=new Shoot();
		this.skill=new Skill();
		this.normal=new NormalAttack();
		this.remote=new RemoteAttack();
		Skill.layer=this.effectlayer;
		this.skill.setAll(this.heroArr);
		this.turnSp=new FontSprite();
		this.turnSp.offset=24;
		this.turnSp.y=-6;
		this.shu.addChild(this.turnSp);
		this.headEffect=new skill_ziUI();
		this.headEffect.ani1.on("complete",this,this.headEffectCompleteFun);
		this.autoResize=new AutoResize(this);
		this.autoResize.push(this.uilayer);
		this.normal.on("HIT",this,this.exeAction);
		this.skill.on("HIT",this,this.exeAction);
		this.shoot.on("HIT",this,this.exeAction);
		this.remote.on("HIT",this,this.exeAction);
		this.tips0.clickHandler=new Handler(this,this.tipsFun);
		this.leftGroupSkill.setAll(this.zhj1,this.btn1_zh,this.heroArr,6,11);
		this.rightGroupSkill.setAll(this.zhj2,this.btn2_zh,this.heroArr,0,5);
		this.btn1_zy.visible=false;
		this.btn2_zy.visible=false;
		if(fight.BattleFileScene.TEST){
			Laya.stage.on("keypress",this,this.keyFun);
			}else{
			this.linshi.visible=false;
		}
	}

	__class(BattleFileScene,'fight.BattleFileScene',_super);
	var __proto=BattleFileScene.prototype;
	__proto.clear=function(){
		var cityid=this.battleData.nowCell.citiId;
		if(this.battleData.isGuide){
			cityid=-1;
		}
		this.scaleManager.clearAllTimer();
		this.scaleManager.clearAllTween();
		this.effectlayer.removeChildren();
		this.clearHero();
		this.wallHeroArr.length=0;
		this.battleData.resetData();
		this.battleData=null;
		this.setSpeed(0);
		this.scaleManager.setNowSpeedScale(1);
		App.sceneManager.removeCurrentScene();
		App.eventManager.event("EXIT_FIGHT_SCENE",[cityid]);
	}

	__proto.clearHero=function(){
		this.herolayer.removeChildren();
		this.heroArr.length=0;
	}

	__proto.keyFun=function(e){
		if(e.keyCode !=13){
			return;
		};
		var text=this.linshi.text;
		var atkData=new AtkData();
		atkData.skillId=parseInt(text);
		atkData.heroIndex=1;
		atkData.defArr=[8];
		this.skill.playSkill(atkData);
	}

	__proto.tipsFun=function(){
		if(this.explainDialog !=null){
			this.explainDialog.removeSelf();
			this.explainDialog=null;
			return;
		}
		this.explainDialog=new ExplainDialog();
		this.addChild(this.explainDialog);
		this.explainDialog.centerX=0;
		this.explainDialog.centerY=0;
		Laya.timer.callLater(this,this.nextFun);
	}

	__proto.nextFun=function(){
		Laya.stage.on("click",this,this.clickFunExplainFun);
	}

	__proto.clickFunExplainFun=function(e){
		if(this.explainDialog==null){
			Laya.stage.off("click",this,this.clickFunExplainFun);
			return;
		}
		if(this.explainDialog.contains(e.target)){
			return;
		}
		if(this.explainDialog !=null){
			this.explainDialog.removeSelf();
			this.explainDialog=null;
			Laya.stage.off("click",this,this.clickFunExplainFun);
			return;
		}
	}

	__proto.headEffectCompleteFun=function(){
		this.headEffect.removeSelf();
	}

	__proto.setSpeed=function(speedIndex){
		this.sudu.skin="comp/zhandou/z_"+this.speedArr[speedIndex]+"bei.png";
	}

	__proto.setTurn=function(value){
		this.turnSp.setValue(-1,value+1,8);
		if(value >=10){
			this.turnSp.x=-5;
			}else{
			this.turnSp.x=9;
		}
	}

	//turnSp.x=(shu.width-TheGame.getWidth(turnSp.fontSp))/2;
	__proto.setTeamBlood=function(atk0def1,now,max){
		var bar=(atk0def1==0)?this.bar1:this.bar2;
		var label=(atk0def1==0)?this.txt1:this.txt2;
		bar.value=now / max;
		label.text=now+"/"+max;
	}

	__proto.showJianTouFun=function(){
		this.jiantou.visible=true;
		this.ani1.play();
	}

	/**显示结束动画 */
	__proto.showEnd=function(){
		this.jianjian.visible=true;
		this.jianjian.ani1.play(0,false);
		Laya.timer.once(200,this,this.showJianTouFun);
	}

	/**关闭结束动画 */
	__proto.closeEnd=function(){
		this.jiantou.visible=false;
		this.jianjian.visible=false;
		this.jianjian.ani1.stop();
		this.ani1.stop();
	}

	/**
	*释放技能时 播放头像的动画
	*@param left0right1
	*@param heroId
	*/
	__proto.skillHeadEffect=function(left1right_1,heroId,skillId){
		this.headEffect.ren.skin=null;
		this.headEffect.ren.skin=GameUtils.getHeroSkin(heroId);
		this.headEffect.ani1.index=0;
		this.headEffect.ani1.play(0,false);
		this.headEffect.bottom=0;
		this.headEffect.scaleX=this.headEffect.jinengming.scaleX=left1right_1;
		if(left1right_1==1){
			this.headEffect.x=0;
			}else{
			this.headEffect.x=this.uilayer.width;
		};
		var sysHero=ConfigManager.getConfig("sys_hero.txt",heroId);
		this.headEffect.dadi.skin=null;
		this.headEffect.dadi.skin=BattleFileScene.getHeadEffect(sysHero.heroColor);
		this.headEffect.jinengming.skin=null;
		var sysSkill=ConfigManager.getConfig("sys_skill.txt",skillId);
		this.headEffect.jinengming.skin=null;
		this.headEffect.jinengming.skin="skillname/"+sysSkill.skillNamePic+".png";
		this.uilayer.addChild(this.headEffect);
	}

	/**
	*显示城墙上的弓箭手
	*/
	__proto.showWall=function(){
		for (var i=0;i < 3;i++){
			var battleHeroDpo=new BattleHeroDpo();
			battleHeroDpo.setAll("10003_2","cityDeff00UI",0,false,false);
			battleHeroDpo.stand();
			this.wallHeroArr.push(battleHeroDpo);
			var box=this["wall"+i];
			this.herolayer.addChild(battleHeroDpo);
			battleHeroDpo.pos(box.x,box.y);
		}
	}

	__proto.setAtkName=function(atkName){
		this.p1.text=atkName;
	}

	__proto.setDefName=function(defName){
		this.p2.text=defName;
	}

	__proto.disFont=function(value,target,color){
		(color===void 0)&& (color="r");
		if(value==0){
			return;
		};
		var font=FightFont.getNew();
		this.effectlayer.addChild(font);
		if((target instanceof fight.BattleHeroDpo )){
			font.x=target.x+80;
			font.y=target.y-10;
			var battleHeroDpo=target;
			if(this.fontArr.indexOf(battleHeroDpo.data.heroId)>-1){
				font.y+=35;
				}else{
				this.fontArr.push(battleHeroDpo.data.heroId);
			}
			}else{
			font.x=target.x;
			font.y=target.y-10;
		}
		font.play(value,color);
		Laya.timer.callLater(this,this.callLaterFun);
	}

	__proto.callLaterFun=function(){
		this.fontArr.length=0;
	}

	/**
	*设置角色 如果是复活 一开始他会隐藏 一定时间后再显示
	*@param data
	*/
	__proto.setHero=function(data,isFuHuo){
		(isFuHuo===void 0)&& (isFuHuo=false);
		if(data.index==-1){
			var wall=new Wall(this.walldoor,this.cheng);
			this.heroArr[-1]=wall;
			return;
		};
		var heroSp=new BattleHeroDpo();
		heroSp.setBattleInitData(data);
		this.heroArr[data.index]=heroSp;
		this.addDpo(heroSp,this["box"+data.index],data.index);
		if(isFuHuo){
			heroSp.visible=false;
			this.scaleManager.addTimer(1500,this,this.delayFuHuoVisible,[heroSp]);
		}
	}

	__proto.delayFuHuoVisible=function(heroSp){
		heroSp.visible=true;
	}

	/**城墙攻击 */
	__proto.wallAttack=function(arr,arr2){
		for (var i=0;i < arr.length;i++){
			var atk=this.wallHeroArr[i];
			var def=this.heroArr[arr[i]];
			var shoot=new Shoot();
			if(i==0){
				shoot.once("HIT",this,this.exeAction,[0,arr2]);
			}
			shoot.start(atk,def,1000,0,this.effectlayer,2);
		}
	}

	/**普攻 */
	__proto.normalAttack=function(atkData,arr){
		for (var i=0;i < atkData.defArr.length;i++){
			var atkDpo=this.heroArr[atkData.heroIndex];
			var defDpo=this.heroArr[atkData.defArr[i]];
			var sys=ConfigManager.getConfig("sys_force.txt",atkDpo.data.type);
			if(sys.forceAtkmode==1){
				var na=new NormalAttack();
				na.start(atkDpo,defDpo,1);
				na.once("HIT",this,this.exeAction,[0,arr]);
				}else if(sys.forceAtkmode==2 || sys.forceAtkmode==7 || sys.forceAtkmode==8 || sys.forceAtkmode==6){
				var shoot=new Shoot();
				shoot.once("HIT",this,this.exeAction,[0,arr]);
				shoot.start(atkDpo,defDpo,1000,2,this.effectlayer,2);
				}else if(sys.forceAtkmode==3){
				var remote=new RemoteAttack();
				remote.once("HIT",this,this.exeAction,[0,arr]);
				remote.start(atkDpo,defDpo,300,3);
				}else if(sys.forceAtkmode==4){
				var shoot1=new Shoot();
				shoot1.once("HIT",this,this.exeAction,[0,arr]);
				shoot1.start(atkDpo,defDpo,1000,4,this.effectlayer,4);
				}else if(sys.forceAtkmode==5 || sys.forceAtkmode==9){
				var shoot11=new Shoot();
				shoot11.once("HIT",this,this.exeAction,[0,arr]);
				shoot11.start(atkDpo,defDpo,500,2,this.effectlayer,sys.forceAtkmode);
			}
			else if(sys.forceAtkmode==10){
			}
		}
	}

	// }
	__proto.setArr=function(arr){
		var atkData=arr[0];
		if(atkData.dataType==1){
			if(atkData.heroIndex==-1){
				this.wallAttack(atkData.defArr,arr);
				}else{
				if(atkData.skillId > 10){
					this.skill=new Skill();
					this.skill.once("HIT",this,this.exeAction,[0,arr]);
					this.skill.setAll(this.heroArr);
					this.skill.playSkill(atkData);
					var heroDpo=this.heroArr[atkData.heroIndex];
					this.scaleManager.addTimer(500,this,this.skillHeadEffect,[atkData.isLeft()?1:-1,heroDpo.data.heroId,atkData.skillId]);
					}else{
					this.normalAttack(atkData,arr);
				}
			}
			}else if(atkData.dataType==0){
			for (var k=0;k < arr.length;k++){
				var atkData1=arr[k];
				if(atkData1.disType==9){
					this.fuHuoHero(atkData1.data);
					}else {
					var dpo=this.heroArr[atkData1.heroIndex];
					dpo.hitEffectSkillId(atkData1.skillId);
				}
			}
			this.exeAction(1,arr);
		}
	}

	/**显示 加血 减血 怒气改变等 */
	__proto.exeAction=function(type,actionArr){
		(type===void 0)&& (type=0);
		if(fight.BattleFileScene.TEST){
			return;
		};
		var startIndex=1;
		if(type==1){
			startIndex=0;
		}
		for (var i=startIndex;i < actionArr.length;i++){
			var data=actionArr[i];
			var hero=this.heroArr[data.heroIndex];
			if(data.disType==5){
				hero.setAnger(data.value);
				}else if(data.disType==2 || data.disType==11){
				if(data.heroIndex==-1){
					this.disFont(data.value,hero.getDpo());
					}else{
					hero.setHp(data.nowHp);
					if(data.nowHp==0){
						this.sendDeadEvent(hero.data.heroId);
					}
					this.disFont(data.value,hero);
				}
				if(data.isBaoJi==1){
					hero.addEffectByAni("buffSeat16");
				}
				if(data.disType==11){
					hero.addEffectByAni("buffSeat20");
				}
				}else if(data.disType==1){
				hero.setHp(data.nowHp);
				this.disFont(data.value,hero,"g");
				}else if(data.disType==6){
				hero.addEffectByAni("buffSeat17");
				}else if(data.disType==7){
				hero.addEffectByAni("buffSeat18");
				}else if(data.disType==8){
				hero.addEffectByAni("buffSeat11");
				}else if(data.disType==9){
				this.fuHuoHero(data.data);
				}else if(data.disType==3 || data.disType==12){
				hero.addBuffer(data.value,(data.disType==12));
				}else if(data.disType==4){
				hero.removeBuffer(data.value);
				}else if(data.disType==13){
				hero.addEffectByAni("buffSeat21");
			}
		}
		this.setAllBlood();
		this.resetGroupSkill();
	}

	__proto.sendDeadEvent=function(heroId){
		if(this.battleData.isGuide){
			if (heroId==4016 || heroId==2019 || heroId==4001){
				this.event("HERO_DEAD",heroId);
				this.stopFuHuo=true;
			}
		}
	}

	__proto.continueFuHuo=function(){
		this.setHero(this.fuhuoData);
	}

	__proto.fuHuoHero=function(data){
		if(this.stopFuHuo){
			this.fuhuoData=data;
			this.stopFuHuo=false;
			return;
		}
		this.setHero(data,true);
	}

	__proto.setBattleData=function(battleData){
		this.battleData=battleData;
	}

	__proto.resetGroupSkill=function(){
		this.leftGroupSkill.reset();
		this.rightGroupSkill.reset();
	}

	__proto.setAllBlood=function(){
		if(this.battleData.nowActionData==null){
			this.setTeamBlood(0,this.battleData.nowCell.atkMaxHp,this.battleData.nowCell.atkMaxHp);
			this.setTeamBlood(1,this.battleData.nowCell.defMaxHp,this.battleData.nowCell.defMaxHp);
			}else{
			this.setTeamBlood(0,this.battleData.nowActionData.atkHp,this.battleData.nowCell.atkMaxHp);
			this.setTeamBlood(1,this.battleData.nowActionData.defHp,this.battleData.nowCell.defMaxHp);
			if(this.battleData.nowActionData.defHp==0){
				if(this.wallHeroArr.length > 0){
					for (var i=0;i < this.wallHeroArr.length;i++){
						var dpo=this.wallHeroArr [i];
						dpo.die();
					}
				}
			}
		}
	}

	__proto.addDpo=function(dpo,box,index){
		this.herolayer.addChild(dpo);
		dpo.x=box.x;
		dpo.y=box.y;
		dpo.zOrder=this.zorderArr[index];
	}

	BattleFileScene.getHeadEffect=function(value){
		return "comp/skill/"+BattleFileScene.HEAD_ARR[value]+".png";
	}

	BattleFileScene.playSound=function(skillId){
		var sysEffect=SysSkill.getSysEffect(skillId);
		App.voiceManager.playSound(sysEffect.effectSound+".wav");
	}

	BattleFileScene.HIT="HIT";
	BattleFileScene.instance=null;
	BattleFileScene.SKILL_ID_BatteringRam=4;
	BattleFileScene.SKILL_ID_Counsellor=3;
	BattleFileScene.SKILL_ID_Arrow=2;
	BattleFileScene.SKILL_ID_Normal=1;
	BattleFileScene.SKILL_ID_Wall=0;
	BattleFileScene.TEST=false;
	BattleFileScene.HERO_DEAD="HERO_DEAD";
	__static(BattleFileScene,
	['HEAD_ARR',function(){return this.HEAD_ARR=["","","clip_sudulan","clip_sudu","clip_suduhuang"];}
	]);
	return BattleFileScene;
})(zhandouUI)


//class ui.SLGGAME.tips_zc0UI extends laya.ui.Dialog
var tips_zc0UI=(function(_super){
	function tips_zc0UI(){
		this.list0=null;
		this.di=null;
		this.b1=null;
		this.b2=null;
		this.b3=null;
		this.b4=null;
		this.b5=null;
		this.b6=null;
		this.b7=null;
		this.b8=null;
		this.b9=null;
		this.b10=null;
		this.b11=null;
		this.b12=null;
		this.b13=null;
		this.b14=null;
		this.b15=null;
		tips_zc0UI.__super.call(this);
	}

	__class(tips_zc0UI,'ui.SLGGAME.tips_zc0UI',_super);
	var __proto=tips_zc0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_zc0");
	}

	return tips_zc0UI;
})(Dialog)


//class fight.FightFont extends ui.GG04UI
var FightFont=(function(_super){
	function FightFont(){
		this.value=0;
		this.color=null;
		this.interval=0;
		FightFont.__super.call(this);
		this.po=new Point();
		this.interval=this.ani1.interval;
	}

	__class(FightFont,'fight.FightFont',_super);
	var __proto=FightFont.prototype;
	__proto.play=function(value,color,delay){
		(delay===void 0)&& (delay=0);
		this.color=color;
		this.value=value;
		if(delay==0){
			this.start();
			}else{
			Laya.timer.once(delay,this,this.start);
			this.visible=false;
		}
	}

	__proto.start=function(){
		this.visible=true;
		this.ani1.index=0;
		this.ani1.play(0,false);
		this.ani1.interval=this.interval/ScaleManager.nowSpeedScale;
		this.ani1.on("complete",this,this.completeFun);
		Laya.timer.frameLoop(1,this,this.loopFun);
		this.loopFun();
	}

	__proto.loopFun=function(){
		var str=this.value+"";
		for (var i=0;i < 5;i++){
			var img=this["s"+i];
			if(i >=str.length){
				img.visible=false;
				}else{
				img.visible=true;
				img.skin="comp/zhandou/"+this.color+str.charAt(i)+".png";
			}
		}
		if(this.color=="r"){
			this.jian.skin="comp/zhandou/r_.png";
			}else{
			this.jian.skin="comp/zhandou/gplus.png";
		}
	}

	__proto.completeFun=function(){
		this.removeSelf();
		Pool.recover("FightFont",this);
		Laya.timer.clear(this,this.loopFun);
	}

	__proto.setPos=function(container,target,xx,yy){
		(xx===void 0)&& (xx=0);
		(yy===void 0)&& (yy=0);
		this.po.setTo(0,0);
		target.localToGlobal(this.po);
		container.addChild(this);
		this.pos(this.po.x+xx,this.po.y+yy);
	}

	FightFont.getNew=function(){
		return Pool.getItemByClass("FightFont",FightFont);
	}

	FightFont.SIGN="FightFont";
	return FightFont;
})(GG04UI)


//class ui.SLGGAME.beibaoUI extends laya.ui.Dialog
var beibaoUI=(function(_super){
	function beibaoUI(){
		this.cha=null;
		this.tab0=null;
		this.ti=null;
		beibaoUI.__super.call(this);
	}

	__class(beibaoUI,'ui.SLGGAME.beibaoUI',_super);
	var __proto=beibaoUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/beibao");
	}

	return beibaoUI;
})(Dialog)


//class ui.SLGGAME.tips_fjUI extends laya.ui.Dialog
var tips_fjUI=(function(_super){
	function tips_fjUI(){
		this.cha=null;
		this.box0=null;
		this.txt_box=null;
		this.s2=null;
		this.txt2=null;
		this.box2=null;
		this.s1=null;
		this.txt1=null;
		this.box1=null;
		this.xuyao=null;
		this.txt_xy=null;
		this.fenjie=null;
		tips_fjUI.__super.call(this);
	}

	__class(tips_fjUI,'ui.SLGGAME.tips_fjUI',_super);
	var __proto=tips_fjUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_fj");
	}

	return tips_fjUI;
})(Dialog)


//class ui.SLGGAME.tips_gxbxUI extends laya.ui.Dialog
var tips_gxbxUI=(function(_super){
	function tips_gxbxUI(){
		this.img0=null;
		this.queding=null;
		tips_gxbxUI.__super.call(this);
	}

	__class(tips_gxbxUI,'ui.SLGGAME.tips_gxbxUI',_super);
	var __proto=tips_gxbxUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_gxbx");
	}

	return tips_gxbxUI;
})(Dialog)


//class ui.SLGGAME.tips_tsUI extends laya.ui.Dialog
var tips_tsUI=(function(_super){
	function tips_tsUI(){
		this.ti=null;
		this.txt1=null;
		this.box0=null;
		this.shu0=null;
		this.img0=null;
		this.check1=null;
		this.checktext=null;
		this.btn1=null;
		this.btn0=null;
		tips_tsUI.__super.call(this);
	}

	__class(tips_tsUI,'ui.SLGGAME.tips_tsUI',_super);
	var __proto=tips_tsUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_ts");
	}

	return tips_tsUI;
})(Dialog)


//class ui.SLGGAME.tips_qhUI extends laya.ui.Dialog
var tips_qhUI=(function(_super){
	function tips_qhUI(){
		this.qianghuahou=null;
		this.wei1=null;
		this.time1=null;
		this.txt1chendi=null;
		this.txt1=null;
		this.xuyao=null;
		this.txt_box=null;
		this.txt2=null;
		this.wei2=null;
		this.time2=null;
		this.txt0=null;
		this.txt_xy=null;
		this.wei3=null;
		this.wei5=null;
		this.wei4=null;
		this.wei6=null;
		this.time3=null;
		this.time5=null;
		this.time4=null;
		this.time6=null;
		this.tishi=null;
		this.box0=null;
		this.qianghua=null;
		tips_qhUI.__super.call(this);
	}

	__class(tips_qhUI,'ui.SLGGAME.tips_qhUI',_super);
	var __proto=tips_qhUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_qh");
	}

	return tips_qhUI;
})(Dialog)


//class ui.SLGGAME.tips_sydjUI extends laya.ui.Dialog
var tips_sydjUI=(function(_super){
	function tips_sydjUI(){
		this.cha=null;
		this.name0=null;
		this.rightBtn=null;
		this.leftBtn=null;
		this.bingli=null;
		this.txt0=null;
		this.max=null;
		this.shu=null;
		this.box0=null;
		this.quxiao=null;
		this.queding=null;
		tips_sydjUI.__super.call(this);
	}

	__class(tips_sydjUI,'ui.SLGGAME.tips_sydjUI',_super);
	var __proto=tips_sydjUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_sydj");
	}

	return tips_sydjUI;
})(Dialog)


//class ui.SLGGAME.chuzhengUI extends laya.ui.Dialog
var chuzhengUI=(function(_super){
	function chuzhengUI(){
		this.tusan=null;
		this.tuer=null;
		this.time0=null;
		this.tu=null;
		this.liangcao=null;
		this.bingli=null;
		this.shili=null;
		this.mudi=null;
		this.cha=null;
		this.chuzheng=null;
		this.buzhen=null;
		this.zuhe=null;
		this.wenhao=null;
		this.ti=null;
		chuzhengUI.__super.call(this);
	}

	__class(chuzhengUI,'ui.SLGGAME.chuzhengUI',_super);
	var __proto=chuzhengUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chuzheng");
	}

	return chuzhengUI;
})(Dialog)


//class ui.SLGGAME.chuzheng_0UI extends laya.ui.Dialog
var chuzheng_0UI=(function(_super){
	function chuzheng_0UI(){
		this.ti=null;
		this.cha=null;
		chuzheng_0UI.__super.call(this);
	}

	__class(chuzheng_0UI,'ui.SLGGAME.chuzheng_0UI',_super);
	var __proto=chuzheng_0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chuzheng_0");
	}

	return chuzheng_0UI;
})(Dialog)


//class ui.SLGGAME.chengchiUI extends laya.ui.Dialog
var chengchiUI=(function(_super){
	function chengchiUI(){
		this.tab0=null;
		this.btn0=null;
		this.txt0=null;
		this.txt1=null;
		chengchiUI.__super.call(this);
	}

	__class(chengchiUI,'ui.SLGGAME.chengchiUI',_super);
	var __proto=chengchiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chengchi");
	}

	return chengchiUI;
})(Dialog)


//class ui.SLGGAME.budui_bljjUI extends laya.ui.Dialog
var budui_bljjUI=(function(_super){
	function budui_bljjUI(){
		this.queding=null;
		this.quxiao=null;
		this.bing=null;
		this.liang=null;
		this.check0=null;
		budui_bljjUI.__super.call(this);
	}

	__class(budui_bljjUI,'ui.SLGGAME.budui_bljjUI',_super);
	var __proto=budui_bljjUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/budui_bljj");
	}

	return budui_bljjUI;
})(Dialog)


//class ui.SLGGAME.buduiUI extends laya.ui.Dialog
var buduiUI=(function(_super){
	function buduiUI(){
		this.cha=null;
		this.zhao=null;
		this.txt0=null;
		this.zizi=null;
		this.bubing=null;
		this.jiesan=null;
		this.chuzheng=null;
		this.yunshu=null;
		this.jijie=null;
		this.comb0=null;
		this.ti=null;
		buduiUI.__super.call(this);
	}

	__class(buduiUI,'ui.SLGGAME.buduiUI',_super);
	var __proto=buduiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/budui");
	}

	return buduiUI;
})(Dialog)


//class ui.SLGGAME.budui_dcblUI extends laya.ui.Dialog
var budui_dcblUI=(function(_super){
	function budui_dcblUI(){
		this.ti=null;
		this.txt1=null;
		this.rightBtn=null;
		this.leftBtn=null;
		this.hs0=null;
		this.txt2=null;
		this.txt3=null;
		this.txt4=null;
		this.xiaohao=null;
		this.di0=null;
		this.box0=null;
		this.img0=null;
		this.tiao=null;
		this.dengji=null;
		this.name0=null;
		this.txt0=null;
		this.quxiao=null;
		this.queding=null;
		this.wk=null;
		this.chakan=null;
		budui_dcblUI.__super.call(this);
	}

	__class(budui_dcblUI,'ui.SLGGAME.budui_dcblUI',_super);
	var __proto=budui_dcblUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.wujiangka_daUI",wujiangka_daUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/budui_dcbl");
	}

	return budui_dcblUI;
})(Dialog)


//class ui.SLGGAME.tips_ysblUI extends laya.ui.Dialog
var tips_ysblUI=(function(_super){
	function tips_ysblUI(){
		this.cha=null;
		this.ti=null;
		this.yubeiyi=null;
		this.der0=null;
		this.mubiao=null;
		this.bingli=null;
		this.liangcao=null;
		this.time0=null;
		this.quxiao=null;
		this.queding=null;
		this.der2=null;
		this.leftBtn=null;
		this.rightBtn=null;
		this.zuo=null;
		this.you=null;
		tips_ysblUI.__super.call(this);
	}

	__class(tips_ysblUI,'ui.SLGGAME.tips_ysblUI',_super);
	var __proto=tips_ysblUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_ysbl");
	}

	return tips_ysblUI;
})(Dialog)


//class ui.SLGGAME.icon_cheng_jsUI extends laya.ui.Dialog
var icon_cheng_jsUI=(function(_super){
	function icon_cheng_jsUI(){
		this.cha=null;
		this.ti=null;
		icon_cheng_jsUI.__super.call(this);
	}

	__class(icon_cheng_jsUI,'ui.SLGGAME.icon_cheng_jsUI',_super);
	var __proto=icon_cheng_jsUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_cheng_js");
	}

	return icon_cheng_jsUI;
})(Dialog)


//class ui.SLGGAME.icon_cheng_tipsUI extends laya.ui.Dialog
var icon_cheng_tipsUI=(function(_super){
	function icon_cheng_tipsUI(){
		this.cha=null;
		this.ti=null;
		this.name0=null;
		this.txt0=null;
		this.img0=null;
		this.box0=null;
		this.shengji=null;
		this.piliang=null;
		this.chaichu=null;
		this.shengji0=null;
		this.pipi=null;
		this.laopi=null;
		this.tong0=null;
		this.time0=null;
		icon_cheng_tipsUI.__super.call(this);
	}

	__class(icon_cheng_tipsUI,'ui.SLGGAME.icon_cheng_tipsUI',_super);
	var __proto=icon_cheng_tipsUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_cheng_tips");
	}

	return icon_cheng_tipsUI;
})(Dialog)


//class huamao.face.WeixianItem extends ui.zhandou_tanhaoUI
var WeixianItem=(function(_super){
	function WeixianItem(){
		this._cityId=0;
		this._action=null;
		WeixianItem.__super.call(this);
		this.chengshiming.text="";
		this.on("click",this,this.onClick);
		this.dong.play();
	}

	__class(WeixianItem,'huamao.face.WeixianItem',_super);
	var __proto=WeixianItem.prototype;
	__proto.onClick=function(){
		if(this._cityId <=0){
			return;
		}
		App.eventManager.event("SET_POSITION",[this._cityId,0,0]);
	}

	__proto.update=function(data){
		this._action=data;
		var sysCity=ConfigManager.getConfig("sys_city.txt",data.toId);
		this.chengshiming.text=sysCity.cityName;
		this._cityId=sysCity.cityId;
	}

	return WeixianItem;
})(zhandou_tanhaoUI)


//class ui.SLGGAME.tips_tishiUI extends laya.ui.Dialog
var tips_tishiUI=(function(_super){
	function tips_tishiUI(){
		this.cha=null;
		this.txt0=null;
		this.btn0=null;
		this.btn1=null;
		this.btn2=null;
		tips_tishiUI.__super.call(this);
	}

	__class(tips_tishiUI,'ui.SLGGAME.tips_tishiUI',_super);
	var __proto=tips_tishiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_tishi");
	}

	return tips_tishiUI;
})(Dialog)


//class huamao.face.XingjunjiasuItem extends ui.SLGGAME.map_taskUI
var XingjunjiasuItem=(function(_super){
	function XingjunjiasuItem(){
		this.curData=null;
		this.actionId=NaN;
		this.isFight=false;
		this.isFirstFight=false;
		XingjunjiasuItem.__super.call(this);
	}

	__class(XingjunjiasuItem,'huamao.face.XingjunjiasuItem',_super);
	var __proto=XingjunjiasuItem.prototype;
	__proto.update=function(data){
		this.curData=data;
		this.actionId=data.actionId;
		this.img0.skin="comp/GG/jc_0"+data.actionType+".png";
		var sysCity=ConfigManager.getConfig("sys_city.txt",data.toId);
		this.ming0.text=sysCity.cityName;
		this.time0.text=GameUtils.time(this.curData.endTime-GameUtils.GetServerTime())+"行军中";
		this.onUpdate();
		Laya.timer.loop(500,this,this.onUpdate);
	}

	//Laya.timer.loop(5000,this,onChangeText);
	__proto.onUpdate=function(){
		var remainTime=this.curData.endTime-GameUtils.GetServerTime();
		if(remainTime > 0){
			this.time0.text=GameUtils.time(remainTime);
			this.time0.color="#cfa451";
			if(this.curData.battleId > 0)
			{this.isFight=true;
				this.isFirstFight=true;
				this.time0.visible=true;
				this.xingjun.visible=false;
				this.time0.text="战斗中";
				this.time0.color="#ff0000";
			}
			else{
				this.isFight=false;
				this.isFirstFight=false;
			}
		}
		else{
			if(this.curData.actionType==CityPlayerType.SELF || this.curData.actionType==0){
				Laya.timer.clear(this,this.onUpdate);
				Laya.timer.clear(this,this.onChangeText);
				this.visible=false;
			}
			else if(this.curData.actionType==CityPlayerType.FRIEND){
				Laya.timer.clear(this,this.onUpdate);
				Laya.timer.clear(this,this.onChangeText);
				this.time0.text="协防中";
				this.time0.color="#00ff00";
			}
			else if(this.curData.actionType==CityPlayerType.ENEMY){
				Laya.timer.clear(this,this.onUpdate);
				Laya.timer.clear(this,this.onChangeText);
				this.visible=false;
			}
		}
	}

	__proto.onChangeText=function(numChan){
		if(!this.isFight){
			if(numChan%2==0){
				this.xingjun.visible=true;
				this.time0.visible=false;
				}else{
				this.xingjun.visible=false;
				this.time0.visible=true;
			}
		}
	}

	__proto.onFirstChangeText=function(numChan){
		if(!this.isFight){
			if(numChan%2==0){
				this.xingjun.visible=false;
				this.time0.visible=true;
				}else{
				this.xingjun.visible=true;
				this.time0.visible=false;
			}
		}
	}

	return XingjunjiasuItem;
})(map_taskUI)


//class ui.SLGGAME.icon_dl_tips0UI extends laya.ui.Dialog
var icon_dl_tips0UI=(function(_super){
	function icon_dl_tips0UI(){
		this.chushou=null;
		this.shouqu=null;
		this.list0=null;
		icon_dl_tips0UI.__super.call(this);
	}

	__class(icon_dl_tips0UI,'ui.SLGGAME.icon_dl_tips0UI',_super);
	var __proto=icon_dl_tips0UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.icon_dl_tips1UI",icon_dl_tips1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_dl_tips0");
	}

	return icon_dl_tips0UI;
})(Dialog)


//class ui.SLGGAME.jiesuan_1UI extends laya.ui.Dialog
var jiesuan_1UI=(function(_super){
	function jiesuan_1UI(){
		this.cha=null;
		this.ti=null;
		this.xiaobiaoti=null;
		this.erjiback=null;
		this.name0=null;
		this.sousuo=null;
		this.ming=null;
		jiesuan_1UI.__super.call(this);
	}

	__class(jiesuan_1UI,'ui.SLGGAME.jiesuan_1UI',_super);
	var __proto=jiesuan_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/jiesuan_1");
	}

	return jiesuan_1UI;
})(Dialog)


//class ui.SLGGAME.jiesuan_2UI extends laya.ui.Dialog
var jiesuan_2UI=(function(_super){
	function jiesuan_2UI(){
		this.check0=null;
		this.d0=null;
		this.d2=null;
		this.d4=null;
		this.d1=null;
		this.d3=null;
		this.d5=null;
		jiesuan_2UI.__super.call(this);
	}

	__class(jiesuan_2UI,'ui.SLGGAME.jiesuan_2UI',_super);
	var __proto=jiesuan_2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/jiesuan_2");
	}

	return jiesuan_2UI;
})(Dialog)


//class ui.SLGGAME.jiesuanUI extends laya.ui.Dialog
var jiesuanUI=(function(_super){
	function jiesuanUI(){
		this.fen=null;
		this.fen0=null;
		this.img0=null;
		this.goBtn=null;
		this.btn0=null;
		this.wenben=null;
		this.xiaobiaoti=null;
		this.shijianjiangli=null;
		this.shijian=null;
		this.shu=null;
		this.tongyi=null;
		this.duli=null;
		this.junzhu=null;
		this.tianxia=null;
		this.renwu=null;
		this.shili=null;
		this.img1=null;
		this.jianjian=null;
		jiesuanUI.__super.call(this);
	}

	__class(jiesuanUI,'ui.SLGGAME.jiesuanUI',_super);
	var __proto=jiesuanUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/jiesuan");
	}

	return jiesuanUI;
})(Dialog)


//class ui.SLGGAME.tips_tjhyUI extends laya.ui.Dialog
var tips_tjhyUI=(function(_super){
	function tips_tjhyUI(){
		this.cha=null;
		this.suosuo=null;
		this.name0=null;
		tips_tjhyUI.__super.call(this);
	}

	__class(tips_tjhyUI,'ui.SLGGAME.tips_tjhyUI',_super);
	var __proto=tips_tjhyUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_tjhy");
	}

	return tips_tjhyUI;
})(Dialog)


//class ui.SLGGAME.tips_gmUI extends laya.ui.Dialog
var tips_gmUI=(function(_super){
	function tips_gmUI(){
		this.cha=null;
		this.txt0=null;
		this.name0=null;
		this.yuanbao=null;
		this.qian0=null;
		this.img0=null;
		this.quxiao=null;
		this.queding=null;
		tips_gmUI.__super.call(this);
	}

	__class(tips_gmUI,'ui.SLGGAME.tips_gmUI',_super);
	var __proto=tips_gmUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_gm");
	}

	return tips_gmUI;
})(Dialog)


//class ui.SLGGAME.haoyouUI extends laya.ui.Dialog
var haoyouUI=(function(_super){
	function haoyouUI(){
		this.cha=null;
		this.boxb=null;
		this.shanchu=null;
		this.tianjia=null;
		this.liaotian=null;
		this.box0=null;
		this.jujue=null;
		this.tongyi=null;
		this.txt0=null;
		this.tab0=null;
		this.txt_yj=null;
		this.huigu=null;
		this.box1=null;
		this.fasong=null;
		this.qingchu=null;
		this.txt1=null;
		this.shanyj=null;
		this.shan=null;
		this.heimingdan=null;
		this.lingqu=null;
		this.wanjiaming=null;
		haoyouUI.__super.call(this);
	}

	__class(haoyouUI,'ui.SLGGAME.haoyouUI',_super);
	var __proto=haoyouUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou");
	}

	return haoyouUI;
})(Dialog)


//class ui.SLGGAME.haoyou_jiesuanUI extends laya.ui.Dialog
var haoyou_jiesuanUI=(function(_super){
	function haoyou_jiesuanUI(){
		this.img_d=null;
		this.shoucang=null;
		this.fenxiang=null;
		this.tongji=null;
		this.huifang=null;
		this.haoyou=null;
		this.jg_0=null;
		this.jg_2=null;
		this.fs_0=null;
		this.fs_2=null;
		this.jg_1=null;
		this.fs_1=null;
		this.jg_txt=null;
		this.fs_txt=null;
		this.duizhen=null;
		this.shengli=null;
		haoyou_jiesuanUI.__super.call(this);
	}

	__class(haoyou_jiesuanUI,'ui.SLGGAME.haoyou_jiesuanUI',_super);
	var __proto=haoyou_jiesuanUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou_jiesuan");
	}

	return haoyou_jiesuanUI;
})(Dialog)


//class ui.SLGGAME.haoyou_zkhgUI extends laya.ui.Dialog
var haoyou_zkhgUI=(function(_super){
	function haoyou_zkhgUI(){
		this.box=null;
		this.btn1=null;
		this.btn0=null;
		this.btn2=null;
		this.box0=null;
		this.dd=null;
		this.zhanbao=null;
		this.jdt=null;
		this.j0=null;
		this.j1=null;
		this.d=null;
		this.cha=null;
		this.zanting=null;
		this.ti=null;
		haoyou_zkhgUI.__super.call(this);
	}

	__class(haoyou_zkhgUI,'ui.SLGGAME.haoyou_zkhgUI',_super);
	var __proto=haoyou_zkhgUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou_zkhg");
	}

	return haoyou_zkhgUI;
})(Dialog)


//class ui.SLGGAME.haoyou_tzUI extends laya.ui.Dialog
var haoyou_tzUI=(function(_super){
	function haoyou_tzUI(){
		this.cha=null;
		this.yidu=null;
		this.qingkong=null;
		this.ti=null;
		haoyou_tzUI.__super.call(this);
	}

	__class(haoyou_tzUI,'ui.SLGGAME.haoyou_tzUI',_super);
	var __proto=haoyou_tzUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou_tz");
	}

	return haoyou_tzUI;
})(Dialog)


//class ui.SLGGAME.zhanbao_jiesuanUI extends laya.ui.Dialog
var zhanbao_jiesuanUI=(function(_super){
	function zhanbao_jiesuanUI(){
		this.img_d=null;
		this.img_0=null;
		this.img_vs=null;
		this.jg_0=null;
		this.jg_2=null;
		this.fs_0=null;
		this.fs_2=null;
		this.jg_1=null;
		this.fs_1=null;
		this.shoucang=null;
		this.fenxiang=null;
		this.tongji=null;
		this.huifang=null;
		this.jg_txt=null;
		this.fs_txt=null;
		this.jl_0=null;
		this.jl_2=null;
		this.jl_1=null;
		this.jiangli=null;
		this.wenhao=null;
		this.shangbing=null;
		zhanbao_jiesuanUI.__super.call(this);
	}

	__class(zhanbao_jiesuanUI,'ui.SLGGAME.zhanbao_jiesuanUI',_super);
	var __proto=zhanbao_jiesuanUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhanbao_jiesuan");
	}

	return zhanbao_jiesuanUI;
})(Dialog)


//class ui.SLGGAME.zhanbaoUI extends laya.ui.Dialog
var zhanbaoUI=(function(_super){
	function zhanbaoUI(){
		this.cha=null;
		this.btn0=null;
		this.btn1=null;
		this.ti=null;
		zhanbaoUI.__super.call(this);
	}

	__class(zhanbaoUI,'ui.SLGGAME.zhanbaoUI',_super);
	var __proto=zhanbaoUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhanbao");
	}

	return zhanbaoUI;
})(Dialog)


//class ui.SLGGAME.haoyou_zrxzUI extends laya.ui.Dialog
var haoyou_zrxzUI=(function(_super){
	function haoyou_zrxzUI(){
		this.time0=null;
		this.cha=null;
		this.chuzhan=null;
		this.zhenr=null;
		this.txt0=null;
		this.tishi=null;
		this.box0=null;
		this.ti=null;
		haoyou_zrxzUI.__super.call(this);
	}

	__class(haoyou_zrxzUI,'ui.SLGGAME.haoyou_zrxzUI',_super);
	var __proto=haoyou_zrxzUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/haoyou_zrxz");
	}

	return haoyou_zrxzUI;
})(Dialog)


//class ui.SLGGAME.wujiangUI extends laya.ui.Dialog
var wujiangUI=(function(_super){
	function wujiangUI(){
		this.cha=null;
		this.tab0=null;
		this.btn0=null;
		this.txt0=null;
		this.txt1=null;
		this.check0=null;
		this.check1=null;
		this.list0=null;
		this.xue=null;
		wujiangUI.__super.call(this);
	}

	__class(wujiangUI,'ui.SLGGAME.wujiangUI',_super);
	var __proto=wujiangUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang");
	}

	return wujiangUI;
})(Dialog)


//class ui.SLGGAME.huodongUI extends laya.ui.Dialog
var huodongUI=(function(_super){
	function huodongUI(){
		this.cha=null;
		this.tab0=null;
		this.ti=null;
		huodongUI.__super.call(this);
	}

	__class(huodongUI,'ui.SLGGAME.huodongUI',_super);
	var __proto=huodongUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong");
	}

	return huodongUI;
})(Dialog)


//class ui.SLGGAME.meiriUI extends laya.ui.Dialog
var meiriUI=(function(_super){
	function meiriUI(){
		this.te3=null;
		this.dui3=null;
		this.te2=null;
		this.dui2=null;
		this.te1=null;
		this.dui1=null;
		this.tips0=null;
		this.shu2=null;
		this.shu1=null;
		this.box0=null;
		this.box1=null;
		this.box2=null;
		this.s0=null;
		this.s1=null;
		this.s2=null;
		this.shu0=null;
		this.bar0=null;
		this.listD=null;
		this.txt1=null;
		this.txt0=null;
		this.shu01=null;
		this.btn0=null;
		this.zhuan=null;
		this.hyd=null;
		meiriUI.__super.call(this);
	}

	__class(meiriUI,'ui.SLGGAME.meiriUI',_super);
	var __proto=meiriUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/meiri");
	}

	return meiriUI;
})(Dialog)


//class ui.SLGGAME.gerenxinxiUI extends laya.ui.Dialog
var gerenxinxiUI=(function(_super){
	function gerenxinxiUI(){
		this.cha=null;
		this.wupindi=null;
		this.ren=null;
		this.wanshangshu=null;
		this.zhanshenshu=null;
		this.zhizheshu=null;
		this.xibaishu=null;
		this.wanjiaming=null;
		this.wanjiadengji=null;
		this.jingyana=null;
		this.jingyantiao=null;
		this.huanmingzi=null;
		this.DI=null;
		this.ID0=null;
		this.dianzan=null;
		this.guojiaa=null;
		this.guojia=null;
		this.toudi=null;
		this.canyu=null;
		this.canyujushu=null;
		this.toudi2=null;
		this.tongyi=null;
		this.tongyishu=null;
		this.guanzhi=null;
		this.jifenshu=null;
		this.guojiayilan=null;
		this.jifena=null;
		this.jicebao=null;
		this.di1=null;
		this.dianling=null;
		this.fenglu=null;
		this.guanzhi11=null;
		this.wpd_1=null;
		this.wpd_2=null;
		this.liangtianhou=null;
		this.junzhuxingxiang=null;
		this.touxiangkuang=null;
		this.chengchipifu=null;
		this.wpd_3=null;
		this.wpd_4=null;
		this.wp0=null;
		this.wp1=null;
		this.wp2=null;
		this.wp3=null;
		this.wp4=null;
		this.shu1=null;
		this.lingqu=null;
		this.z1=null;
		this.z3=null;
		this.z2=null;
		this.z4=null;
		this.dianzanshu=null;
		this.jifen=null;
		this.guanzhi1=null;
		this.guanzhi4=null;
		this.di2=null;
		this.wp5=null;
		this.shu5=null;
		this.xianling=null;
		this.tips0=null;
		this.ti=null;
		this.txt_jy=null;
		this.ming=null;
		this.guanzhijindu=null;
		this.shu0=null;
		this.guanzhi2=null;
		this.guanzhi3=null;
		this.titi=null;
		this.wk=null;
		gerenxinxiUI.__super.call(this);
	}

	__class(gerenxinxiUI,'ui.SLGGAME.gerenxinxiUI',_super);
	var __proto=gerenxinxiUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.wujiangka_daUI",wujiangka_daUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/gerenxinxi");
	}

	return gerenxinxiUI;
})(Dialog)


//class ui.SLGGAME.gerenxinxi_gzUI extends laya.ui.Dialog
var gerenxinxi_gzUI=(function(_super){
	function gerenxinxi_gzUI(){
		this.cha=null;
		this.xianling=null;
		this.txt1=null;
		this.txt3=null;
		this.txt2=null;
		this.txt4=null;
		this.tequan=null;
		this.rightBtn=null;
		this.leftBtn=null;
		this.jc_1=null;
		this.jc_3=null;
		this.jc_2=null;
		this.jc_4=null;
		this.h1=null;
		this.b1=null;
		this.s1=null;
		this.h2=null;
		this.b2=null;
		this.s2=null;
		this.h3=null;
		this.b3=null;
		this.s3=null;
		this.h4=null;
		this.b4=null;
		this.s4=null;
		this.tubiao=null;
		this.ti=null;
		gerenxinxi_gzUI.__super.call(this);
	}

	__class(gerenxinxi_gzUI,'ui.SLGGAME.gerenxinxi_gzUI',_super);
	var __proto=gerenxinxi_gzUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("HTMLDivElement",HTMLDivElement);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/gerenxinxi_gz");
	}

	return gerenxinxi_gzUI;
})(Dialog)


//class ui.SLGGAME.tips_jfjlUI extends laya.ui.Dialog
var tips_jfjlUI=(function(_super){
	function tips_jfjlUI(){
		this.cha=null;
		this.list0=null;
		this.jieshao=null;
		tips_jfjlUI.__super.call(this);
	}

	__class(tips_jfjlUI,'ui.SLGGAME.tips_jfjlUI',_super);
	var __proto=tips_jfjlUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_jfjl");
	}

	return tips_jfjlUI;
})(Dialog)


//class ui.SLGGAME.wanjiaxxUI extends laya.ui.Dialog
var wanjiaxxUI=(function(_super){
	function wanjiaxxUI(){
		this.cha=null;
		this.bw=null;
		this.zs=null;
		this.zz=null;
		this.xb=null;
		this.jia=null;
		this.hmd=null;
		this.chakan=null;
		this.txt1=null;
		this.txt2=null;
		this.txt3=null;
		this.txt4=null;
		this.txt5=null;
		this.txt6=null;
		this.ka=null;
		this.xin=null;
		this.shu0=null;
		this.dengji=null;
		this.name0=null;
		this.txt0=null;
		this.ti=null;
		wanjiaxxUI.__super.call(this);
	}

	__class(wanjiaxxUI,'ui.SLGGAME.wanjiaxxUI',_super);
	var __proto=wanjiaxxUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wanjiaxx");
	}

	return wanjiaxxUI;
})(Dialog)


//class ui.SLGGAME.tips0UI extends laya.ui.Dialog
var tips0UI=(function(_super){
	function tips0UI(){
		this.img0=null;
		this.list0=null;
		this.txt0=null;
		this.lab0=null;
		tips0UI.__super.call(this);
	}

	__class(tips0UI,'ui.SLGGAME.tips0UI',_super);
	var __proto=tips0UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips0");
	}

	return tips0UI;
})(Dialog)


//class ui.SLGGAME.zhifu_1UI extends laya.ui.Dialog
var zhifu_1UI=(function(_super){
	function zhifu_1UI(){
		this.cha=null;
		this.te1=null;
		this.te2=null;
		zhifu_1UI.__super.call(this);
	}

	__class(zhifu_1UI,'ui.SLGGAME.zhifu_1UI',_super);
	var __proto=zhifu_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhifu_1");
	}

	return zhifu_1UI;
})(Dialog)


//class ui.SLGGAME.tips_zcUI extends laya.ui.Dialog
var tips_zcUI=(function(_super){
	function tips_zcUI(){
		this.cha=null;
		this.time=null;
		this.shangbing=null;
		this.bingshu=null;
		this.yushu=null;
		this.chengshu=null;
		tips_zcUI.__super.call(this);
	}

	__class(tips_zcUI,'ui.SLGGAME.tips_zcUI',_super);
	var __proto=tips_zcUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_zc");
	}

	return tips_zcUI;
})(Dialog)


//class ui.SLGGAME.paihangbang2UI extends laya.ui.Dialog
var paihangbang2UI=(function(_super){
	function paihangbang2UI(){
		this.di0=null;
		this.shu0=null;
		this.name0=null;
		this.guan0=null;
		this.ji0=null;
		this.fen0=null;
		this.img0=null;
		paihangbang2UI.__super.call(this);
	}

	__class(paihangbang2UI,'ui.SLGGAME.paihangbang2UI',_super);
	var __proto=paihangbang2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/paihangbang2");
	}

	return paihangbang2UI;
})(Dialog)


//class ui.SLGGAME.paihangbang4UI extends laya.ui.Dialog
var paihangbang4UI=(function(_super){
	function paihangbang4UI(){
		this.di0=null;
		this.shu0=null;
		this.name0=null;
		this.guan0=null;
		this.fen0=null;
		this.img0=null;
		paihangbang4UI.__super.call(this);
	}

	__class(paihangbang4UI,'ui.SLGGAME.paihangbang4UI',_super);
	var __proto=paihangbang4UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/paihangbang4");
	}

	return paihangbang4UI;
})(Dialog)


//class ui.SLGGAME.paihangbangUI extends laya.ui.Dialog
var paihangbangUI=(function(_super){
	function paihangbangUI(){
		this.ditu=null;
		this.cha=null;
		this.txt0=null;
		this.box0=null;
		this.t1=null;
		this.t2=null;
		this.box1=null;
		this.wen=null;
		this.ti=null;
		paihangbangUI.__super.call(this);
	}

	__class(paihangbangUI,'ui.SLGGAME.paihangbangUI',_super);
	var __proto=paihangbangUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.paihangbang3UI",paihangbang3UI);
		View.regComponent("ui.SLGGAME.paihangbang1UI",paihangbang1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/paihangbang");
	}

	return paihangbangUI;
})(Dialog)


//class ui.SLGGAME.chongzhiUI extends laya.ui.Dialog
var chongzhiUI=(function(_super){
	function chongzhiUI(){
		this.hei=null;
		this.didi1=null;
		this.y1=null;
		this.cn1=null;
		this.zi1=null;
		this.y4=null;
		this.cn4=null;
		this.y2=null;
		this.cn2=null;
		this.zi2=null;
		this.y5=null;
		this.cn5=null;
		this.y3=null;
		this.cn3=null;
		this.y6=null;
		this.cn6=null;
		this.d1=null;
		this.d2=null;
		this.d3=null;
		this.d6=null;
		this.d5=null;
		this.d4=null;
		this.zi3=null;
		this.zi4=null;
		this.zi5=null;
		this.zi6=null;
		this.ti=null;
		this.b1=null;
		this.b2=null;
		this.b3=null;
		this.b4=null;
		this.b5=null;
		this.b6=null;
		this.n2=null;
		this.s2=null;
		this.n1=null;
		this.s1=null;
		this.n3=null;
		this.s3=null;
		this.n5=null;
		this.s5=null;
		this.n6=null;
		this.s6=null;
		this.n4=null;
		this.s4=null;
		chongzhiUI.__super.call(this);
	}

	__class(chongzhiUI,'ui.SLGGAME.chongzhiUI',_super);
	var __proto=chongzhiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/chongzhi");
	}

	return chongzhiUI;
})(Dialog)


//class ui.SLGGAME.tips_cdKeyUI extends laya.ui.Dialog
var tips_cdKeyUI=(function(_super){
	function tips_cdKeyUI(){
		this.txt0=null;
		this.quxiao=null;
		this.zhantie=null;
		this.duihuan=null;
		tips_cdKeyUI.__super.call(this);
	}

	__class(tips_cdKeyUI,'ui.SLGGAME.tips_cdKeyUI',_super);
	var __proto=tips_cdKeyUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_cdKey");
	}

	return tips_cdKeyUI;
})(Dialog)


//class ui.SLGGAME.shezhiUI extends laya.ui.Dialog
var shezhiUI=(function(_super){
	function shezhiUI(){
		this.cha=null;
		this.r0=null;
		this.r1=null;
		this.r2=null;
		this.r3=null;
		this.r4=null;
		this.zhuxiao=null;
		this.duihuan=null;
		this.ti=null;
		shezhiUI.__super.call(this);
	}

	__class(shezhiUI,'ui.SLGGAME.shezhiUI',_super);
	var __proto=shezhiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/shezhi");
	}

	return shezhiUI;
})(Dialog)


//class ui.SLGGAME.shangdianUI extends laya.ui.Dialog
var shangdianUI=(function(_super){
	function shangdianUI(){
		this.cha=null;
		this.shuzi1=null;
		this.shuzi2=null;
		this.jiahao=null;
		this.wenhao1=null;
		this.v1=null;
		this.v2=null;
		this.v3=null;
		this.txt0=null;
		this.shijian1=null;
		this.xiaochulengque1=null;
		this.img1=null;
		this.img2=null;
		this.txt1=null;
		this.txt2=null;
		this.cishu=null;
		this.jiahao1=null;
		this.ti=null;
		shangdianUI.__super.call(this);
	}

	__class(shangdianUI,'ui.SLGGAME.shangdianUI',_super);
	var __proto=shangdianUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.shangdian_1UI",shangdian_1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/shangdian");
	}

	return shangdianUI;
})(Dialog)


//class ui.SLGGAME.shangdian_tips1UI extends laya.ui.Dialog
var shangdian_tips1UI=(function(_super){
	function shangdian_tips1UI(){
		this.v2=null;
		this.v1=null;
		this.v3=null;
		this.ti=null;
		this.cha=null;
		shangdian_tips1UI.__super.call(this);
	}

	__class(shangdian_tips1UI,'ui.SLGGAME.shangdian_tips1UI',_super);
	var __proto=shangdian_tips1UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.shangdian_1UI",shangdian_1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/shangdian_tips1");
	}

	return shangdian_tips1UI;
})(Dialog)


//class ui.SLGGAME.shouchongUI extends laya.ui.Dialog
var shouchongUI=(function(_super){
	function shouchongUI(){
		this.diban=null;
		this.dianguang=null;
		this.zxfg=null;
		this.ziguang=null;
		this.chongzhi=null;
		this.peitao=null;
		this.landi=null;
		this.renyi=null;
		this.shang=null;
		this.xia=null;
		this.z0=null;
		this.z1=null;
		this.z2=null;
		this.k0=null;
		this.k1=null;
		this.k2=null;
		this.k3=null;
		this.zongjia=null;
		this.yuan=null;
		this.daxia=null;
		this.zb1=null;
		this.ts1=null;
		this.zb2=null;
		this.ts2=null;
		this.zb3=null;
		this.ts3=null;
		this.zb4=null;
		this.ts4=null;
		this.zb5=null;
		this.ts5=null;
		this.zb6=null;
		this.ts6=null;
		this.zb7=null;
		this.ts7=null;
		this.zb8=null;
		this.ts8=null;
		this.zb9=null;
		this.b1=null;
		this.b2=null;
		this.b3=null;
		this.b4=null;
		this.b5=null;
		this.b6=null;
		this.b7=null;
		this.lingqu=null;
		this.jia=null;
		this.heiehi=null;
		this.diao=null;
		shouchongUI.__super.call(this);
	}

	__class(shouchongUI,'ui.SLGGAME.shouchongUI',_super);
	var __proto=shouchongUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/shouchong");
	}

	return shouchongUI;
})(Dialog)


//class ui.SLGGAME.jiceUI extends laya.ui.Dialog
var jiceUI=(function(_super){
	function jiceUI(){
		this.shijian=null;
		this.wenhao=null;
		this.v1=null;
		this.v2=null;
		this.v3=null;
		this.v4=null;
		this.v5=null;
		this.v6=null;
		this.v7=null;
		this.shu0=null;
		this.jia=null;
		this.cha=null;
		this.ti=null;
		this.v8=null;
		jiceUI.__super.call(this);
	}

	__class(jiceUI,'ui.SLGGAME.jiceUI',_super);
	var __proto=jiceUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.jice_1UI",jice_1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/jice");
	}

	return jiceUI;
})(Dialog)


//class ui.SLGGAME.tips_ltshezhiUI extends laya.ui.Dialog
var tips_ltshezhiUI=(function(_super){
	function tips_ltshezhiUI(){
		this.txt0=null;
		this.cha=null;
		this.txt1=null;
		this.txt2=null;
		this.shijie=null;
		this.dangqian=null;
		this.duiwu=null;
		this.xitong=null;
		this.guojia=null;
		this.lianmeng0=null;
		this.qipao0=null;
		this.xuankuang=null;
		this.gz=null;
		this.gj=null;
		this.lm=null;
		this.quxiao=null;
		this.queding=null;
		this.qipao1=null;
		tips_ltshezhiUI.__super.call(this);
	}

	__class(tips_ltshezhiUI,'ui.SLGGAME.tips_ltshezhiUI',_super);
	var __proto=tips_ltshezhiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_ltshezhi");
	}

	return tips_ltshezhiUI;
})(Dialog)


//class ui.SLGGAME.renwuUI extends laya.ui.Dialog
var renwuUI=(function(_super){
	function renwuUI(){
		this.tab0=null;
		this.lingqu=null;
		this.cha=null;
		this.txt0=null;
		this.txt1=null;
		this.ti=null;
		renwuUI.__super.call(this);
	}

	__class(renwuUI,'ui.SLGGAME.renwuUI',_super);
	var __proto=renwuUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/renwu");
	}

	return renwuUI;
})(Dialog)


//class ui.tips_npcUI extends laya.ui.Dialog
var tips_npcUI=(function(_super){
	function tips_npcUI(){
		this.ti=null;
		this.queren=null;
		this.zi=null;
		this.lis=null;
		tips_npcUI.__super.call(this);
	}

	__class(tips_npcUI,'ui.tips_npcUI',_super);
	var __proto=tips_npcUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("tips_npc");
	}

	return tips_npcUI;
})(Dialog)


//class ui.SLGGAME.lianmeng_cjUI extends laya.ui.Dialog
var lianmeng_cjUI=(function(_super){
	function lianmeng_cjUI(){
		this.cha=null;
		this.ti=null;
		this.ti1=null;
		lianmeng_cjUI.__super.call(this);
	}

	__class(lianmeng_cjUI,'ui.SLGGAME.lianmeng_cjUI',_super);
	var __proto=lianmeng_cjUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/lianmeng_cj");
	}

	return lianmeng_cjUI;
})(Dialog)


//class ui.SLGGAME.lianmeng_sqUI extends laya.ui.Dialog
var lianmeng_sqUI=(function(_super){
	function lianmeng_sqUI(){
		this.cha=null;
		this.jujue=null;
		this.tongguo=null;
		this.list0=null;
		this.xuanzhong=null;
		lianmeng_sqUI.__super.call(this);
	}

	__class(lianmeng_sqUI,'ui.SLGGAME.lianmeng_sqUI',_super);
	var __proto=lianmeng_sqUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/lianmeng_sq");
	}

	return lianmeng_sqUI;
})(Dialog)


//class ui.lianmeng_tipsUI extends laya.ui.Dialog
var lianmeng_tipsUI=(function(_super){
	function lianmeng_tipsUI(){
		this.cha=null;
		this.ti=null;
		this.wenben=null;
		this.quxiao=null;
		this.chongzhi=null;
		lianmeng_tipsUI.__super.call(this);
	}

	__class(lianmeng_tipsUI,'ui.lianmeng_tipsUI',_super);
	var __proto=lianmeng_tipsUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_tips");
	}

	return lianmeng_tipsUI;
})(Dialog)


//class huamao.panel.bag.BagBox extends ui.SLGGAME.beibao_11UI
var BagBox=(function(_super){
	function BagBox(){
		this.itemArr=[];
		this.currItem=null;
		this.itemTime=null;
		this.currData=null;
		this.currTime=0;
		this.boxArr=null;
		BagBox.__super.call(this);
		this.init();
	}

	__class(BagBox,'huamao.panel.bag.BagBox',_super);
	var __proto=BagBox.prototype;
	__proto.init=function(){
		this.mouseThrough=true;
		this.currItem=new Item();
		this.xuanzhongwupin.addChild(this.currItem);
		this.currItem.size(this.xuanzhongwupin.width,this.xuanzhongwupin.height);
		for(var i=1;i<7;i++){
			var item=new Item();
			this["sp"+i].addChild(item);
			item.x=10;
			item.y=10;
			item.size(120,120);
			this.itemArr.push(item);
			item.on("click",this,this.clickBox,[i-1]);
		}
		this.kaixiang.label="领取";
		this.wupinshuoming.wordWrap=true;
		this.itemTime=new beibao_viUI();
		this.itemTime.pos(18,90);
		var sysTips=ConfigManager.getConfig("sys_tips.txt",3006);
		FlyLittleUpTips.regByString(this.wenhao,sysTips.tipsDescribe);
	}

	__proto.clickBox=function(index){
		this.clear();
		this.currData=this.boxArr[index];
		this.currItem.setItemId(this.currData.itemId);
		this.currItem.visible=true;
		this.sheqi.visible=true;
		this.kaixiang.visible=true;
		var sysitem=ConfigManager.getConfig("sys_item.txt",this.currData.itemId);
		this.wupinshuoming.text=sysitem.itemDescription;
		if(this.currData.endTime>0){
			this.wupinjindu.visible=true;
			var serverTime=GameUtils.GetServerTime();
			this.currTime=this.currData.endTime-serverTime;
			Laya.timer.loop(1000,this,this.loopFun);
			this.loopFun();
		}
	}

	__proto.loopFun=function(){
		if(this.currTime<=0){
			this.kaixiang.disabled=false;
			Laya.timer.clear(this,this.loopFun);
			this.wupinjindu.value=1;
			this.wupinshuoming2.text="领取奖励";
			return;
		};
		var serverTime=this.currData.endTime-this.currData.startTime;
		var currtime=(serverTime-this.currTime);
		this.wupinjindu.value=currtime/serverTime;
		this.wupinshuoming2.text=GameUtils.time(this.currTime);
		this.currTime--;
	}

	//boxid,itemid,openTime,endTime
	__proto.upData=function(arr){
		this.itemTime.removeSelf();
		this.boxArr=arr;
		var i=0;
		for(i=0;i<this.boxArr.length;i++){
			data=this.boxArr[i];
			if(i!=0 && data.endTime>0){
				this.boxArr.splice(i,1);
				this.boxArr.unshift(data);
			}
		}
		for(i=0;i<this.itemArr.length;i++){
			var item=this.itemArr[i];
			if(i<this.boxArr.length){
				var data=this.boxArr[i];
				if(data.endTime>0)this["sp"+(i+1)].addChild(this.itemTime);
				item.setItemId(data.itemId);
				item.visible=true;
			}
			else{
				item.visible=false;
			}
		}
		if(this.boxArr.length>0){
			this.clickBox(0);
		}
		else{
			this.clear();
		}
	}

	__proto.clear=function(){
		this.currData=null;
		Laya.timer.clear(this,this.loopFun);
		this.wupinshuoming2.text="";
		this.wupinshuoming.text="";
		this.currItem.visible=false;
		this.xuanzhongmingcheng.text="";
		this.kaixiang.disabled=true;
		this.kaixiang.visible=false;
		this.sheqi.visible=false;
		this.wupinjindu.visible=false;
	}

	return BagBox;
})(beibao_11UI)


//class ui.lianmeng_dongtaiUI extends laya.ui.Dialog
var lianmeng_dongtaiUI=(function(_super){
	function lianmeng_dongtaiUI(){
		this.cha=null;
		this.ti=null;
		this.liebiao=null;
		lianmeng_dongtaiUI.__super.call(this);
	}

	__class(lianmeng_dongtaiUI,'ui.lianmeng_dongtaiUI',_super);
	var __proto=lianmeng_dongtaiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_dongtai");
	}

	return lianmeng_dongtaiUI;
})(Dialog)


//class ui.SLGGAME.lianmeng_1UI extends laya.ui.Dialog
var lianmeng_1UI=(function(_super){
	function lianmeng_1UI(){
		this.cha=null;
		this.ti=null;
		this.list0=null;
		this.yin=null;
		this.jin=null;
		this.wen=null;
		lianmeng_1UI.__super.call(this);
	}

	__class(lianmeng_1UI,'ui.SLGGAME.lianmeng_1UI',_super);
	var __proto=lianmeng_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/lianmeng_1");
	}

	return lianmeng_1UI;
})(Dialog)


//class ui.lianmeng_tips_1UI extends laya.ui.Dialog
var lianmeng_tips_1UI=(function(_super){
	function lianmeng_tips_1UI(){
		this.cha=null;
		this.ti=null;
		lianmeng_tips_1UI.__super.call(this);
	}

	__class(lianmeng_tips_1UI,'ui.lianmeng_tips_1UI',_super);
	var __proto=lianmeng_tips_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_tips_1");
	}

	return lianmeng_tips_1UI;
})(Dialog)


//class huamao.panel.bag.EquipView extends ui.SLGGAME.beibao_0UI
var EquipView=(function(_super){
	function EquipView(){
		this.bagSession=null;
		this.bagAction=null;
		this.remSelectIndex=0;
		this.remData=null;
		EquipView.__super.call(this);
		App.injOne(this);
		this.mouseThrough=true;
		this.shiyong2.visible=false;
		this.fenjie.visible=false;
		this.init();
	}

	__class(EquipView,'huamao.panel.bag.EquipView',_super);
	var __proto=EquipView.prototype;
	__proto.init=function(){
		this.list0.repeatX=6;
		this.list0.repeatY=5;
		this.list0.vScrollBarSkin="";
		this.list0.selectEnable=true;
		this.list0.selectHandler=new Handler(this,this.onSelect);
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.shiyong2.visible=false;
		var img_icon=this.xuanzhongwupin.getChildByName("icon");
		if(img_icon==null){
			img_icon=new Image();
			img_icon.pos(2,2);
			img_icon.size(70,70);
			img_icon.name="icon";
			this.xuanzhongwupin.addChild(img_icon);
		}
		this.qianhua.on("click",this,this.qiangHuaClick);
		this.chushou.on("click",this,this.chuShouClick);
		this.fenjie.on("click",this,this._$7_fenjie);
		this.btn0.on("click",this,this.xieZaiAllCB);
		this.updataLeftContentPanel(null);
		this.flushData();
	}

	__proto.xieZaiAllCB=function(){
		App.dialogManager.showMiniDialog(TipsXieZaiAllEquip,true,true,true);
	}

	__proto._$7_fenjie=function(){
		if(this.remData !=null){
			var tips=App.dialogManager.showMiniDialog(TipsFenJie,true,true);
			tips.flushPanel(this.remData);
		}
	}

	//强化
	__proto.qiangHuaClick=function(){
		if(this.remData !=null){
			if(this.remData.ifMaxStep()){
				FlyUpTips.setTips("已经是最强等级了！");
				}else{
				var tips=App.dialogManager.showMiniDialog(TipsStronger,true,true);
				tips.flushPanel(this.remData);
			}
		}
	}

	//出售
	__proto.chuShouClick=function(){
		if(this.remData !=null){
			var tips=App.dialogManager.showMiniDialog(TipsSell,true,true);
			tips.setItem(this.remData);
		}
	}

	__proto.flushRender=function(cell){
		var celldata=cell.dataSource;
		var img_wenzidi=cell.getChildByName("wenzidi");
		var lbl_shu=cell.getChildByName("shu");
		var box_box0=cell.getChildByName("box_0");
		var img_icon=box_box0.getChildByName("icon");
		var label_hecheng=cell.getChildByName("hecheng");
		if(img_icon==null){
			img_icon=new Image();
			box_box0.addChild(img_icon);
			img_icon.name="icon";
			img_icon.pos(0,0);
			img_icon.size(75,74);
		}
		if(celldata==null){
			img_wenzidi.visible=false;
			lbl_shu.visible=false;
			label_hecheng.visible=false;
			img_icon.visible=false;
			cell.disabled=true;
			}else{
			cell.disabled=false;
			lbl_shu.visible=false;
			lbl_shu.text=celldata.itemNum+"";
			img_icon.visible=true;
			img_icon.skin=GameUtils.getItemIconPath(celldata.itemId);
			if(celldata.overTime > GameUtils.GetServerTime()){
				img_wenzidi.visible=true;
				}else{
				img_wenzidi.visible=false;
			}
			if(celldata.lv > 0){
				label_hecheng.visible=true;
				label_hecheng.text="+"+celldata.lv;
				}else{
				label_hecheng.visible=false;
			}
		}
	}

	__proto.getShuXingStr=function(celldata,type){
		var result="";
		var shuxingary=celldata.getShuXing(type);
		for(var i=0;i<shuxingary.length;i+=2){
			result+=shuxingary[i]+"+"+shuxingary[i+1]+"\n";
		}
		return result;
	}

	//更新左侧物品详情面板
	__proto.updataLeftContentPanel=function(celldata){
		var img_icon=this.xuanzhongwupin.getChildByName("icon");
		if(celldata==null){
			img_icon.visible=false;
			this.xuanzhongshuliang.visible=false;
			this.yongyou.visible=false;
			this.wupinshuoming.visible=false;
			this.xuanzhongmingcheng.visible=false;
			this.shoujia.visible=false;
			this.qianhua.visible=false;
			this.chushou.visible=false;
			this.box_s.visible=false;
			}else{
			img_icon.visible=true;
			this.wupinshuoming.visible=true;
			this.qianhua.visible=true;
			this.chushou.visible=true;
			this.xuanzhongmingcheng.visible=true;
			if(celldata.lv > 0){
				this.box_s.visible=true;
				this.box_s.text="+"+celldata.lv;
				this.fenjie.visible=true;
				this.xuanzhongshuliang.visible=false;
				this.yongyou.visible=false;
				}else{
				this.fenjie.visible=false;
				this.box_s.visible=false;
				this.xuanzhongshuliang.visible=true;
				this.yongyou.visible=true;
				this.xuanzhongshuliang.text=""+celldata.itemNum;
			}
			console.log("leftpanel celldata.itemId = "+celldata.itemId);
			img_icon.skin=GameUtils.getItemIconPath(celldata.itemId);
			var sysItem=celldata.getSysItem();
			if(sysItem.ifCanSell()){
				this.shoujia.visible=true;
				this.txt0.text=(sysItem.sellPrice *(celldata.lv+1)).toString();
				}else{
				this.shoujia.visible=false;
			}
			this.wupinshuoming.text=this.getShuXingStr(celldata,0)+sysItem.itemDescription;
			this.wupinshuoming.wordWrap=true;
			this.xuanzhongmingcheng.text=sysItem.itemName;
		}
	}

	__proto.updateItem=function(cell,index){
		var img_di=cell.getChildByName("di");
		var img_select=cell.getChildByName("xuanzhong");
		if(this.remSelectIndex==index){
			img_select.visible=true;
			this.remData=cell.dataSource
			this.updataLeftContentPanel(this.remData);
			}else{
			img_select.visible=false;
		}
		this.flushRender(cell);
	}

	__proto.onSelect=function(index){
		this.remSelectIndex=index;
	}

	// }
	__proto.flushData=function(){
		var maxsize=30;
		var t=this.bagSession.getEquipAry();
		var itemary=[];
		for(i=0;i<t.length;i++){
			var data=t [i];
			if(data.heroId==0){
				itemary.push(data);
			}
		}
		itemary.sort(this.bagSession.sortFun);
		var dataary=[];
		dataary[maxsize-1]=null;
		if(itemary.length < maxsize){
			for(var i=0;i<itemary.length;i++){
				dataary[i]=itemary[i];
			}
			this.list0.array=dataary;
			}else{
			this.list0.array=itemary;
		}
		if(this.remSelectIndex > itemary.length-1){
			this.remSelectIndex=itemary.length-1;
		}
		if(itemary.length <=0){
			this.updataLeftContentPanel(null);
		}
	}

	return EquipView;
})(beibao_0UI)


//class ui.SLGGAME.lianmeng_jsUI extends laya.ui.Dialog
var lianmeng_jsUI=(function(_super){
	function lianmeng_jsUI(){
		this.cha=null;
		this.txt0=null;
		this.shi=null;
		this.fou=null;
		this.txt2=null;
		this.txt1=null;
		this.txt3=null;
		this.img3=null;
		this.img2=null;
		this.img1=null;
		this.ti=null;
		lianmeng_jsUI.__super.call(this);
	}

	__class(lianmeng_jsUI,'ui.SLGGAME.lianmeng_jsUI',_super);
	var __proto=lianmeng_jsUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/lianmeng_js");
	}

	return lianmeng_jsUI;
})(Dialog)


//class huamao.panel.bag.ItemView extends ui.SLGGAME.beibao_0UI
var ItemView=(function(_super){
	function ItemView(){
		this.bagSession=null;
		this.bagAction=null;
		this.remSelectIndex=0;
		ItemView.__super.call(this);
		App.injOne(this);
		this.mouseThrough=true;
		this.qianhua.visible=false;
		this.chushou.visible=false;
		this.btn0.visible=false;
		this.fenjie.visible=false;
		this.box_s.visible=false;
		this.init();
	}

	__class(ItemView,'huamao.panel.bag.ItemView',_super);
	var __proto=ItemView.prototype;
	__proto.init=function(){
		this.list0.repeatX=6;
		this.list0.repeatY=5;
		this.list0.vScrollBarSkin="";
		this.list0.selectEnable=true;
		this.list0.selectHandler=new Handler(this,this.onSelect);
		this.list0.renderHandler=new Handler(this,this.updateItem);
		var img_icon=this.xuanzhongwupin.getChildByName("icon");
		if(img_icon==null){
			img_icon=new Image();
			img_icon.pos(0,0);
			img_icon.size(75,75);
			img_icon.name="icon";
			this.xuanzhongwupin.addChild(img_icon);
		}
		this.shiyong2.on("click",this,this.useClick);
		this.updataLeftContentPanel(null);
		this.flushData();
	}

	__proto.useClick=function(){
		var data=this.bagSession.getItemAry()[this.remSelectIndex];
		var sysitem=ConfigManager.getConfig("sys_item.txt",data.itemId);
		if(sysitem.ifCanUseAllSuperPosition()){
			var tips=App.dialogManager.showMiniDialog(TipsUseItem,true,true);
			tips.flushPanel(data);
			}else{
			App.voiceManager.playSound("sue.wav");
			this.bagAction.sendUseItem(data.onlyId,1);
		}
	}

	__proto.flushRender=function(cell){
		var celldata=cell.dataSource;
		var img_wenzidi=cell.getChildByName("wenzidi");
		var lbl_shu=cell.getChildByName("shu");
		var box_box0=cell.getChildByName("box_0");
		var label_hecheng=cell.getChildByName("hecheng");
		var img_icon=box_box0.getChildByName("icon");
		if(img_icon==null){
			img_icon=new Image();
			box_box0.addChild(img_icon);
			img_icon.name="icon";
			img_icon.pos(0,0);
			img_icon.size(75,74);
		}
		if(celldata==null){
			img_wenzidi.visible=false;
			lbl_shu.visible=false;
			img_icon.visible=false;
			label_hecheng.visible=false;
			cell.disabled=true;
			}else{
			cell.disabled=false;
			lbl_shu.visible=true;
			lbl_shu.text=celldata.itemNum+"";
			img_icon.visible=true;
			img_icon.skin=GameUtils.getItemIconPath(celldata.itemId);
			if(celldata.overTime > GameUtils.GetServerTime()){
				img_wenzidi.visible=true;
				}else{
				img_wenzidi.visible=false;
			}
			if(celldata.lv > 0){
				label_hecheng.visible=true;
				label_hecheng.text="+"+celldata.lv;
				}else{
				label_hecheng.visible=false;
			}
		}
	}

	//更新左侧物品详情面板
	__proto.updataLeftContentPanel=function(celldata){
		var img_icon=this.xuanzhongwupin.getChildByName("icon");
		if(celldata==null){
			img_icon.visible=false;
			this.xuanzhongshuliang.visible=false;
			this.yongyou.visible=false;
			this.wupinshuoming.visible=false;
			this.xuanzhongmingcheng.visible=false;
			this.shoujia.visible=false;
			this.shiyong2.disabled=true;
			this.shiyong2.visible=false;
			}else{
			img_icon.visible=true;
			this.xuanzhongshuliang.visible=true;
			this.yongyou.visible=true;
			this.wupinshuoming.visible=true;
			this.xuanzhongmingcheng.visible=true;
			this.shiyong2.disabled=false;
			this.shiyong2.visible=true;
			this.xuanzhongshuliang.text=celldata.itemNum+"";
			img_icon.skin=GameUtils.getItemIconPath(celldata.itemId);
			var sysItem=ConfigManager.getConfig("sys_item.txt",celldata.itemId);
			if(sysItem.ifCanSell()){
				this.shoujia.visible=true;
				this.txt0.text=sysItem.sellPrice.toString();
				}else{
				this.shoujia.visible=false;
			}
			if(sysItem.ifCanUse(true)){
				this.shiyong2.disabled=false;
				}else{
				this.shiyong2.disabled=true;
			}
			this.wupinshuoming.text=sysItem.itemDescription;
			this.wupinshuoming.wordWrap=true;
			this.xuanzhongmingcheng.text=sysItem.itemName;
		}
	}

	__proto.updateItem=function(cell,index){
		var img_di=cell.getChildByName("di");
		var img_select=cell.getChildByName("xuanzhong");
		if(this.remSelectIndex==index){
			img_select.visible=true;
			this.updataLeftContentPanel(cell.dataSource);
			}else{
			img_select.visible=false;
		}
		this.flushRender(cell);
	}

	__proto.onSelect=function(index){
		this.remSelectIndex=index;
	}

	__proto.flushData=function(){
		var maxsize=30;
		var itemary=this.bagSession.getItemAry();
		var dataary=[];
		dataary[maxsize-1]=null;
		if(itemary.length < maxsize){
			for(var i=0;i<itemary.length;i++){
				dataary[i]=itemary[i];
			}
			this.list0.array=dataary;
			}else{
			this.list0.array=itemary;
		}
		if(this.remSelectIndex > itemary.length-1){
			this.remSelectIndex=itemary.length-1;
		}
		if(itemary.length <=0){
			this.updataLeftContentPanel(null);
		}
	}

	return ItemView;
})(beibao_0UI)


//class ui.SLGGAME.lianmeng_lbUI extends laya.ui.Dialog
var lianmeng_lbUI=(function(_super){
	function lianmeng_lbUI(){
		this.id0=null;
		this.lianmeng=null;
		this.shenqing=null;
		this.jiaru=null;
		this.gonggao=null;
		this.list0=null;
		this.xuanzhong=null;
		this.mengzhu=null;
		this.time0=null;
		this.paiming=null;
		this.fanyou=null;
		this.fanzuo=null;
		this.mingzi=null;
		this.txt0=null;
		this.ye=null;
		lianmeng_lbUI.__super.call(this);
	}

	__class(lianmeng_lbUI,'ui.SLGGAME.lianmeng_lbUI',_super);
	var __proto=lianmeng_lbUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/lianmeng_lb");
	}

	return lianmeng_lbUI;
})(Dialog)


//class ui.lianmeng_chakanUI extends laya.ui.Dialog
var lianmeng_chakanUI=(function(_super){
	function lianmeng_chakanUI(){
		this.cha=null;
		this.ti=null;
		this.id0=null;
		this.lianmeng=null;
		this.gonggao=null;
		this.list0=null;
		this.xuanzhong=null;
		this.mengzhu=null;
		this.paiming=null;
		this.fanyou=null;
		this.fanzuo=null;
		this.ye=null;
		lianmeng_chakanUI.__super.call(this);
	}

	__class(lianmeng_chakanUI,'ui.lianmeng_chakanUI',_super);
	var __proto=lianmeng_chakanUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_chakan");
	}

	return lianmeng_chakanUI;
})(Dialog)


//class ui.lianmeng_cjlbUI extends laya.ui.Dialog
var lianmeng_cjlbUI=(function(_super){
	function lianmeng_cjlbUI(){
		this.d=null;
		this.qian=null;
		this.qBox0=null;
		this.liang=null;
		this.zhuyou=null;
		this.zhuchengyou=null;
		this.diming=null;
		this.lianmengmingcheng=null;
		this.jingyan=null;
		this.dengji=null;
		this.jingyanzhi=null;
		this.mengzhu=null;
		this.chengyuan=null;
		this.chengshi=null;
		this.liebiao=null;
		this.qita=null;
		this.tuichu=null;
		this.weixinhao=null;
		this.tan=null;
		this.jianshe=null;
		this.shangdian=null;
		this.zhanzheng=null;
		this.dongtai=null;
		this.libao=null;
		this.shenqing=null;
		this.jiesan=null;
		this.genghuan=null;
		this.zaixian=null;
		this.zan=null;
		this.zan2=null;
		lianmeng_cjlbUI.__super.call(this);
	}

	__class(lianmeng_cjlbUI,'ui.lianmeng_cjlbUI',_super);
	var __proto=lianmeng_cjlbUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_cjlb");
	}

	return lianmeng_cjlbUI;
})(Dialog)


//class ui.lianmeng_qizhiUI extends laya.ui.Dialog
var lianmeng_qizhiUI=(function(_super){
	function lianmeng_qizhiUI(){
		this.list0=null;
		this.gengfai=null;
		this.geng=null;
		this.yuanbao=null;
		this.xuanze=null;
		this.xuan=null;
		this.ben=null;
		lianmeng_qizhiUI.__super.call(this);
	}

	__class(lianmeng_qizhiUI,'ui.lianmeng_qizhiUI',_super);
	var __proto=lianmeng_qizhiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_qizhi");
	}

	return lianmeng_qizhiUI;
})(Dialog)


//class ui.SLGGAME.lianmeng_sdUI extends laya.ui.Dialog
var lianmeng_sdUI=(function(_super){
	function lianmeng_sdUI(){
		this.shu0=null;
		this.cha=null;
		this.ti=null;
		this.list0=null;
		this.ming=null;
		this.banggong=null;
		lianmeng_sdUI.__super.call(this);
	}

	__class(lianmeng_sdUI,'ui.SLGGAME.lianmeng_sdUI',_super);
	var __proto=lianmeng_sdUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/lianmeng_sd");
	}

	return lianmeng_sdUI;
})(Dialog)


//class ui.lianmeng_shuomingUI extends laya.ui.Dialog
var lianmeng_shuomingUI=(function(_super){
	function lianmeng_shuomingUI(){
		this.cha=null;
		this.ti=null;
		this.diaochan=null;
		lianmeng_shuomingUI.__super.call(this);
	}

	__class(lianmeng_shuomingUI,'ui.lianmeng_shuomingUI',_super);
	var __proto=lianmeng_shuomingUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("lianmeng_shuoming");
	}

	return lianmeng_shuomingUI;
})(Dialog)


//class ui.SLGGAME.tips_syjcUI extends laya.ui.Dialog
var tips_syjcUI=(function(_super){
	function tips_syjcUI(){
		this.cha=null;
		this.txt0=null;
		this.shengyu=null;
		this.shu=null;
		this.img0=null;
		this.quxiao=null;
		this.yanjiu=null;
		this.shiyong=null;
		tips_syjcUI.__super.call(this);
	}

	__class(tips_syjcUI,'ui.SLGGAME.tips_syjcUI',_super);
	var __proto=tips_syjcUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_syjc");
	}

	return tips_syjcUI;
})(Dialog)


//class huamao.panel.chuzheng.ChuzhengCell extends ui.SLGGAME.chuzheng_1UI
var ChuzhengCell=(function(_super){
	function ChuzhengCell(){
		this._index=0;
		this.mainPlayerSession=null;
		this.isMax=false;
		this.limit=false;
		ChuzhengCell.__super.call(this);
		App.injOne(this);
		this.on("click",this,this.onClick);
		this.wenzi1.visible=false;
		this.jia.visible=!this.wenzi1.visible;
	}

	__class(ChuzhengCell,'huamao.panel.chuzheng.ChuzhengCell',_super);
	var __proto=ChuzhengCell.prototype;
	__proto.onClick=function(){
		if(this.isMax){
			App.dialogManager.openDialogByStr("SELECTZHENGRONG",{index:this._index},true,true);
		}
		else{
			if(this.mainPlayerSession.mainPlayerData.job < 1004 && this._index > 5){
				FlyUpTips.setTips("升至县令开放");
				return;
			}
			App.dialogManager.openDialogByStr("SELECT_WUJIANG",{index:this._index},true,true);
		}
	}

	__getset(0,__proto,'index',function(){
		return this._index;
		},function(value){
		this._index=value;
		this.wenzi1.visible=this._index > 5;
		this.jia.visible=!this.wenzi1.visible;
		this.limit=this._index > 5;
		if(this.mainPlayerSession.mainPlayerData.job >=1004){
			this.wenzi1.visible=false;
			this.jia.visible=true;
			this.limit=false;
		}
		if(this.isMax){
			this.wenzi1.visible=false;
			this.jia.visible=!this.wenzi1.visible;
			this.limit=false
		}
	});

	return ChuzhengCell;
})(chuzheng_1UI)


//class huamao.panel.chuzheng.ChuzhengItem extends ui.SLGGAME.chuzhengkaUI
var ChuzhengItem=(function(_super){
	function ChuzhengItem(){
		this.toIndex=0;
		this.mapCitySession=null;
		this.friendSession=null;
		this._data=null;
		this._isFriend=false;
		ChuzhengItem.__super.call(this);
		App.injOne(this);
		this.on("click",this,this.onClick);
		this.yuancha.visible=false;
	}

	__class(ChuzhengItem,'huamao.panel.chuzheng.ChuzhengItem',_super);
	var __proto=ChuzhengItem.prototype;
	__proto.onClick=function(){
		App.eventManager.event("SET_SELECT_WUJIANG",[this.toIndex,this._data]);
		var panel=this._isFriend ? "SELECTZHENGRONG" :"SELECT_WUJIANG";
		var dialog=Dialog.manager.getChildByName(panel);
		if(dialog){
			dialog.close();
		}
	}

	__proto.update=function(data,isFriend){
		(isFriend===void 0)&& (isFriend=false);
		this._isFriend=isFriend;
		this._data=data;
		this.box.removeChildren();
		var img=new HeroImage();
		img.setHeroId(data.heroId);
		img.setScaleSize(this.box.width,0);
		this.box.addChild(img);
		this.box.scrollRect=new Rectangle(0,0,this.box.width,this.box.height);
		this.xing.visible=false;
		for(var i=1;i <=5;i++){
			if(i <=data.heroStar){
				this["xing"+i].visible=true;
				this.xing.visible=true;
				}else{
				this["xing"+i].visible=false;
			}
		}
		this.tiao.skin=GameUtils.getZiDi(data.sysHero.heroColor);
		this.guojia.skin=GameUtils.getCountry(data.sysHero.heroCountry);
		this.name0.text=data.sysHero.heroName;
		this.dengji.text=data.heroLv+"";
		if(isFriend){
			this.txt0.text=data.soldierMax+"/"+data.soldierMax;
			this.binglitiao.value=data.soldierMax / data.soldierMax;
		}
		else{
			this.txt0.text=data.soldier+"/"+data.soldierMax;
			this.binglitiao.value=data.soldier / data.soldierMax;
		}
		this.kaung.skin=GameUtils.getKuang(data.sysHero.heroColor);
		this.di.skin=GameUtils.getDi(data.sysHero.heroColor);
		GameUtils.getKaKuang(this.wk,data.sysHero.heroColor);
		this.clip0.visible=false;
		this.clip0.stop();
		this.setZuheSkill();
	}

	__proto.setZuheSkill=function(){
		var obj;
		if(this._isFriend){
			obj=this.friendSession.selectedZhenrongObj;
		}
		else{
			obj=this.mapCitySession.chuzhengDic;
		}
		var heroData;
		for(var $each_heroData in obj){
			heroData=obj[$each_heroData];
			var mixSkillIds=heroData.sysHero.heroMixSkill.split(",");
			for(var j=0;j < mixSkillIds.length;j++){
				var mixSkillId=parseInt(mixSkillIds[j]);
				var sysMixSkill=ConfigManager.getConfig("sys_skill_mix.txt",mixSkillId);
				if(sysMixSkill==null){
					continue ;
				};
				var heroIds=sysMixSkill.mixSkillHero.split(",");
				if(heroIds.indexOf(this._data.heroId+"")!=-1){
					this.clip0.visible=true;
					this.clip0.play();
				}
			}
		}
	}

	return ChuzhengItem;
})(chuzhengkaUI)


//class ui.SLGGAME.huiyuanfuwuUI extends laya.ui.Dialog
var huiyuanfuwuUI=(function(_super){
	function huiyuanfuwuUI(){
		this.dianji1=null;
		this.zi=null;
		this.dianji2=null;
		this.biao1=null;
		this.di1=null;
		this.di2=null;
		this.biao2=null;
		this.te1=null;
		this.te2=null;
		this.lj1=null;
		this.lj2=null;
		this.ti=null;
		huiyuanfuwuUI.__super.call(this);
	}

	__class(huiyuanfuwuUI,'ui.SLGGAME.huiyuanfuwuUI',_super);
	var __proto=huiyuanfuwuUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huiyuanfuwu");
	}

	return huiyuanfuwuUI;
})(Dialog)


//class huamao.panel.chuzheng.ChuzhengKa extends ui.SLGGAME.chuzhengkaUI
var ChuzhengKa=(function(_super){
	function ChuzhengKa(){
		this._index=0;
		this.heroData=null;
		ChuzhengKa.__super.call(this);
		this.yuancha.on("click",this,this.onCancel);
	}

	__class(ChuzhengKa,'huamao.panel.chuzheng.ChuzhengKa',_super);
	var __proto=ChuzhengKa.prototype;
	__proto.onCancel=function(){
		App.eventManager.event("CANLE_BUZHENG_ITEM",this._index);
	}

	__proto.update=function(data,isMax){
		(isMax===void 0)&& (isMax=false);
		this.heroData=data;
		this.box.removeChildren();
		var img=new HeroImage();
		img.setHeroId(data.heroId);
		img.setScaleSize(this.box.width,0);
		this.box.addChild(img);
		this.box.scrollRect=new Rectangle(0,0,this.box.width,this.box.height);
		this.guojia.skin=GameUtils.getCountry(data.sysHero.heroCountry);
		for(var i=1;i <=5;i++){
			this["xing"+i].visible=i <=data.heroStar;
		}
		this.tiao.skin=GameUtils.getZiDi(data.sysHero.heroColor);
		this.xing.visible=data.heroStar > 0;
		this.name0.text=data.sysHero.heroName;
		this.dengji.text=data.heroLv+"";
		if(isMax){
			this.txt0.text=data.soldierMax+"/"+data.soldierMax;
			this.binglitiao.value=data.soldierMax / data.soldierMax;
		}
		else{
			this.txt0.text=data.soldier+"/"+data.soldierMax;
			this.binglitiao.value=data.soldier / data.soldierMax;
		}
		this.kaung.skin=GameUtils.getKuang(data.sysHero.heroColor);
		this.di.skin=GameUtils.getDi(data.sysHero.heroColor);
		GameUtils.getKaKuang(this.wk,data.sysHero.heroColor);
	}

	__getset(0,__proto,'index',function(){
		return this._index;
		},function(value){
		this._index=value;
	});

	return ChuzhengKa;
})(chuzhengkaUI)


//class ui.SLGGAME.tips_tmsqUI extends laya.ui.Dialog
var tips_tmsqUI=(function(_super){
	function tips_tmsqUI(){
		this.cha=null;
		this.shen=null;
		this.txt1=null;
		this.txt0=null;
		this.btn0=null;
		this.btn1=null;
		tips_tmsqUI.__super.call(this);
	}

	__class(tips_tmsqUI,'ui.SLGGAME.tips_tmsqUI',_super);
	var __proto=tips_tmsqUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_tmsq");
	}

	return tips_tmsqUI;
})(Dialog)


//class ui.SLGGAME.waijiaoUI extends laya.ui.Dialog
var waijiaoUI=(function(_super){
	function waijiaoUI(){
		this.cha=null;
		this.shuoming=null;
		this.touxiang=null;
		this.txt0=null;
		this.ti=null;
		waijiaoUI.__super.call(this);
	}

	__class(waijiaoUI,'ui.SLGGAME.waijiaoUI',_super);
	var __proto=waijiaoUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/waijiao");
	}

	return waijiaoUI;
})(Dialog)


//class huamao.panel.chuzheng.SelectItem extends ui.SLGGAME.ka0UI
var SelectItem=(function(_super){
	function SelectItem(){
		SelectItem.__super.call(this);
		for(var i=1;i <=5;i++){
			this["xing"+i].visible=false;
		}
		this.width=this.width *this.scaleX;
		this.height=this.height *this.scaleY;
	}

	__class(SelectItem,'huamao.panel.chuzheng.SelectItem',_super);
	var __proto=SelectItem.prototype;
	__proto.update=function(data){
		this.box.removeChildren();
		var img=new HeroImage();
		img.setHeroId(data.heroId);
		img.setScaleSize(this.box.width,0);
		this.box.addChild(img);
		this.box.scrollRect=new Rectangle(0,0,this.box.width,this.box.height);
		this.name0.text=data.sysHero.heroName;
		this.dengji.text=data.heroLv+"";
		this.txt0.text=data.soldier+"";
		this.bar0.value=1;
		this.wk2.skin=GameUtils.getKaKuangImg(data.sysHero.heroColor);
		this.di.skin=GameUtils.getDi(data.sysHero.heroColor);
		this.img0.skin=GameUtils.getCountry(data.sysHero.heroCountry);
		this.tiao.skin=GameUtils.getZiDi(data.sysHero.heroColor);
		for (var i=1;i <=5;i++){
			this["xing"+i].visible=(i <=data.heroStar);
		}
	}

	return SelectItem;
})(ka0UI)


//class ui.SLGGAME.mapUI extends laya.ui.Dialog
var mapUI=(function(_super){
	function mapUI(){
		this.box=null;
		this.sousuo=null;
		this.sou0=null;
		this.box0=null;
		this.shou=null;
		this.kai=null;
		this.cha=null;
		this.ti=null;
		mapUI.__super.call(this);
	}

	__class(mapUI,'ui.SLGGAME.mapUI',_super);
	var __proto=mapUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map");
	}

	return mapUI;
})(Dialog)


//class huamao.panel.city.ItemB extends ui.SLGGAME.chengchi_1_0UI
var ItemB=(function(_super){
	function ItemB(){
		this.mapCityAction=null;
		this.cityId=0;
		ItemB.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(ItemB,'huamao.panel.city.ItemB',_super);
	var __proto=ItemB.prototype;
	__proto.init=function(){
		this.on("click",this,this.cityNameCB);
	}

	__proto.cityNameCB=function(){
		this.mapCityAction.onEnterCityById(this.cityId);
	}

	__proto.flush=function(data,index){
		this.cityId=data.cityId;
		if(index%2==0){
			this.di.visible=false;
			}else{
			this.di.visible=true;
		};
		var sysCity=ConfigManager.getConfig("sys_city.txt",this.cityId);
		if(sysCity.cityType==1){
			this.cheng.color="#ffce0a";
			}else{
			this.cheng.color="#e5d3c0";
		}
		this.cheng.text=sysCity.cityName;
		this.kong.text=10-data.mjNum-data.sjNum-data.ntNum+"";
		this.min.text=data.mjNum+"";
		this.shi.text=data.sjNum+"";
		this.tian.text=data.ntNum+"";
		this.fu.text=data.cityLv+"级";
		this.dengji.text=data.pjLv+"";
		if(data.checkCityUp()){
			this.chui1.visible=true;
			this.chui1.play(0,true);
			}else{
			this.chui1.visible=false;
			this.chui1.stop();
		}
		if(data.checkMainCityUp()){
			this.chui2.visible=true;
			this.chui2.play(0,true);
			}else{
			this.chui2.visible=false;
			this.chui2.stop();
		}
	}

	return ItemB;
})(chengchi_1_0UI)


//class ui.SLGGAME.wujiang_dl0UI extends laya.ui.Dialog
var wujiang_dl0UI=(function(_super){
	function wujiang_dl0UI(){
		this.dier=null;
		this.dier2=null;
		this.qingkongduilie=null;
		this.quxiao=null;
		this.baocun=null;
		this.wenzi=null;
		this.list0=null;
		this.list2=null;
		this.biaotiti=null;
		this.cha=null;
		this.rightBtn=null;
		this.leftBtn=null;
		this.box0=null;
		wujiang_dl0UI.__super.call(this);
	}

	__class(wujiang_dl0UI,'ui.SLGGAME.wujiang_dl0UI',_super);
	var __proto=wujiang_dl0UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.chuzhengkaUI",chuzhengkaUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_dl0");
	}

	return wujiang_dl0UI;
})(Dialog)


//class ui.SLGGAME.wujiang_dlUI extends laya.ui.Dialog
var wujiang_dlUI=(function(_super){
	function wujiang_dlUI(){
		this.cha=null;
		this.txt0=null;
		this.btn1=null;
		this.btn2=null;
		this.btn3=null;
		this.btn4=null;
		this.btn5=null;
		this.btn6=null;
		this.ti=null;
		wujiang_dlUI.__super.call(this);
	}

	__class(wujiang_dlUI,'ui.SLGGAME.wujiang_dlUI',_super);
	var __proto=wujiang_dlUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_dl");
	}

	return wujiang_dlUI;
})(Dialog)


//class ui.SLGGAME.tips_wqUI extends laya.ui.Dialog
var tips_wqUI=(function(_super){
	function tips_wqUI(){
		this.cha=null;
		this.tab0=null;
		this.list0=null;
		this.btn0=null;
		this.ti=null;
		tips_wqUI.__super.call(this);
	}

	__class(tips_wqUI,'ui.SLGGAME.tips_wqUI',_super);
	var __proto=tips_wqUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_wq");
	}

	return tips_wqUI;
})(Dialog)


//class ui.SLGGAME.wujiang0_3_bzdqUI extends laya.ui.Dialog
var wujiang0_3_bzdqUI=(function(_super){
	function wujiang0_3_bzdqUI(){
		this.bu=null;
		this.qi=null;
		this.gong=null;
		this.teshu=null;
		this.list0=null;
		this.ti=null;
		wujiang0_3_bzdqUI.__super.call(this);
	}

	__class(wujiang0_3_bzdqUI,'ui.SLGGAME.wujiang0_3_bzdqUI',_super);
	var __proto=wujiang0_3_bzdqUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.wujiang0_3_bzdq0UI",wujiang0_3_bzdq0UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_3_bzdq");
	}

	return wujiang0_3_bzdqUI;
})(Dialog)


//class ui.SLGGAME.wujiang_pingjia_1UI extends laya.ui.Dialog
var wujiang_pingjia_1UI=(function(_super){
	function wujiang_pingjia_1UI(){
		this.ti=null;
		this.cha=null;
		this.la=null;
		this.timu1=null;
		this.w1=null;
		this.timu2=null;
		this.w2=null;
		this.timu3=null;
		this.w3=null;
		this.zheng1=null;
		this.shu1=null;
		this.shu5=null;
		this.shu9=null;
		this.tt1=null;
		this.tt2=null;
		this.tt3=null;
		this.jin=null;
		wujiang_pingjia_1UI.__super.call(this);
	}

	__class(wujiang_pingjia_1UI,'ui.SLGGAME.wujiang_pingjia_1UI',_super);
	var __proto=wujiang_pingjia_1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_pingjia_1");
	}

	return wujiang_pingjia_1UI;
})(Dialog)


//class ui.SLGGAME.wujiang_pingjiaUI extends laya.ui.Dialog
var wujiang_pingjiaUI=(function(_super){
	function wujiang_pingjiaUI(){
		this.ti=null;
		this.cha=null;
		this.huadong=null;
		this.timu1=null;
		this.timu2=null;
		this.timu3=null;
		this.zheng1=null;
		this.zu1=null;
		this.zu2=null;
		this.zu3=null;
		this.jieshou=null;
		this.chehui=null;
		wujiang_pingjiaUI.__super.call(this);
	}

	__class(wujiang_pingjiaUI,'ui.SLGGAME.wujiang_pingjiaUI',_super);
	var __proto=wujiang_pingjiaUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_pingjia");
	}

	return wujiang_pingjiaUI;
})(Dialog)


//class huamao.panel.cityBudui.BinglijijieItem extends ui.SLGGAME.budui_bljj_0UI
var BinglijijieItem=(function(_super){
	function BinglijijieItem(){
		this.mapCitySession=null;
		this.fromCityId=0;
		this.toCityId=0;
		this.yubeiyi=0;
		this.liang=0;
		BinglijijieItem.__super.call(this);
		App.injOne(this);
		this.check0.clickHandler=new Handler(this,this.onClick);
	}

	__class(BinglijijieItem,'huamao.panel.cityBudui.BinglijijieItem',_super);
	var __proto=BinglijijieItem.prototype;
	__proto.onClick=function(){
		var xishu=this.check0.selected ? 1 :-1;
		this.mapCitySession.jiJieObj[this.fromCityId]=this.check0.selected;
		App.eventManager.event("SELECT_JIJIE_CITY");
	}

	__proto.update=function(arr){
		var fromId=arr[0];
		this.fromCityId=fromId;
		var toId=arr[1];
		this.toCityId=toId;
		var juli=arr[2];
		var sysCity=ConfigManager.getConfig("sys_city.txt",fromId);
		this.cheng.text=sysCity.cityName;
		var cityData=this.mapCitySession.getCity(fromId);
		this.yubeiyi=cityData.yubeiyiNum;
		this.t1.text=this.yubeiyi+"";
		this.t2.text=juli+"";
		var takeTime0=ConfigManager.getConfig("sys_timetake.txt",2);
		this.t3.text=GameUtils.time(takeTime0.timeCd *juli);
		this.liang=this.yubeiyi *juli *takeTime0.supplyCostRatio;
		this.t4.text=this.liang+"";
		this.isSelect=this.mapCitySession.jiJieObj[fromId];
	}

	__getset(0,__proto,'isSelect',null,function(value){
		this.check0.selected=value;
		if(value){
			this.onClick();
		}
	});

	return BinglijijieItem;
})(budui_bljj_0UI)


//class ui.SLGGAME.wujiang_BZZZUI extends laya.ui.Dialog
var wujiang_BZZZUI=(function(_super){
	function wujiang_BZZZUI(){
		this.cha=null;
		this.ti=null;
		this.zi=null;
		this.yijianzhuan=null;
		this.zhuanzhi=null;
		this.quxiao=null;
		this.yuanbao=null;
		this.zhuan=null;
		wujiang_BZZZUI.__super.call(this);
	}

	__class(wujiang_BZZZUI,'ui.SLGGAME.wujiang_BZZZUI',_super);
	var __proto=wujiang_BZZZUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_BZZZ");
	}

	return wujiang_BZZZUI;
})(Dialog)


//class huamao.panel.cityBudui.CityBuduiItem extends ui.SLGGAME.kaUI
var CityBuduiItem=(function(_super){
	function CityBuduiItem(){
		this.isCopy=false;
		this.imageFont=null;
		this.heroData=null;
		this.cityBuildData=null;
		this.allFont=new Sprite();
		CityBuduiItem.__super.call(this);
		this.imageFont=new ImageFont(9);
		this.allFont.addChild(this.imageFont);
		this.imageFont.x=30;
		this.txt0.visible=false;
		this.size(this.width,this.height);
		this.box_jt.visible=false;
		this.box_tb.visible=this.box_c.visible=this.zhuangtai.visible=false;
	}

	__class(CityBuduiItem,'huamao.panel.cityBudui.CityBuduiItem',_super);
	var __proto=CityBuduiItem.prototype;
	__proto.openPanel=function(arr){
		App.dialogManager.openDialogByStr("CITY_BUDUI_DIAOBING",{heroData:this.heroData,cityId:this.cityBuildData.cityId,team:arr},true,true);
	}

	__proto.update=function(data,cityData){
		this.heroData=data;
		this.cityBuildData=cityData;
		this.box.removeChildren();
		var img=new Image();
		img.skin=GameUtils.getHeroSkin(data.heroId);
		img.size(this.box.width,this.box.height);
		this.box.addChild(img);
		this.imageFont.setValue(data.fight);
		var w=TheGame.getWidth(this.imageFont);
		this.tiao.skin=GameUtils.getZiDi(data.sysHero.heroColor);
		for(var i=1;i <=5;i++){
			this["xing"+i].visible=i <=data.heroStar;
		}
		this.box_xing.visible=data.heroStar > 0;
		this.img0.skin=GameUtils.getCountry(this.heroData.sysHero.heroCountry);
		this.kuang0.skin=GameUtils.getKuang(this.heroData.sysHero.heroColor);
		this.di.skin=GameUtils.getDi(this.heroData.sysHero.heroColor);
		GameUtils.getKaKuang(this.wk,this.heroData.sysHero.heroColor);
		this.name0.text=this.heroData.sysHero.heroName;
		this.dengji.text=data.heroLv+"";
		this.binglishu.text=data.soldier+"/"+data.soldierMax;
		this.bingli.value=data.soldier / data.soldierMax;
		this.txt0.text="勇"+data.force+"\n"
		+"御"+data.resist+"\n"
		+"智"+data.wisdom+"\n"
		+"威"+data.might;
	}

	return CityBuduiItem;
})(kaUI)


//class ui.SLGGAME.wujiang0UI extends laya.ui.Dialog
var wujiang0UI=(function(_super){
	function wujiang0UI(){
		this.tab0=null;
		this.cha=null;
		this.fenjie=null;
		this.bingzhong=null;
		this.xia1=null;
		this.qian1=null;
		this.ti=null;
		wujiang0UI.__super.call(this);
	}

	__class(wujiang0UI,'ui.SLGGAME.wujiang0UI',_super);
	var __proto=wujiang0UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.wujiang_ka0UI",wujiang_ka0UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0");
	}

	return wujiang0UI;
})(Dialog)


//class ui.SLGGAME.tips_wujiang_chongzhiUI extends laya.ui.Dialog
var tips_wujiang_chongzhiUI=(function(_super){
	function tips_wujiang_chongzhiUI(){
		this.ti=null;
		this.shuzi=null;
		this.gou=null;
		this.shuzia=null;
		this.benyu=null;
		this.benyue=null;
		this.shua=null;
		this.b1=null;
		this.b2=null;
		tips_wujiang_chongzhiUI.__super.call(this);
	}

	__class(tips_wujiang_chongzhiUI,'ui.SLGGAME.tips_wujiang_chongzhiUI',_super);
	var __proto=tips_wujiang_chongzhiUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_wujiang_chongzhi");
	}

	return tips_wujiang_chongzhiUI;
})(Dialog)


//class ui.wujiang_BZJSUI extends laya.ui.Dialog
var wujiang_BZJSUI=(function(_super){
	function wujiang_BZJSUI(){
		this.cha=null;
		this.ti=null;
		this.zi=null;
		this.yijian=null;
		this.zhuanzhi=null;
		this.quxiao=null;
		this.yuanbao=null;
		this.zhuanzhifu=null;
		wujiang_BZJSUI.__super.call(this);
	}

	__class(wujiang_BZJSUI,'ui.wujiang_BZJSUI',_super);
	var __proto=wujiang_BZJSUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("wujiang_BZJS");
	}

	return wujiang_BZJSUI;
})(Dialog)


//class ui.SLGGAME.wujiang_tips_xzfjUI extends laya.ui.Dialog
var wujiang_tips_xzfjUI=(function(_super){
	function wujiang_tips_xzfjUI(){
		this.list0=null;
		this.list1=null;
		this.cha=null;
		this.ti=null;
		wujiang_tips_xzfjUI.__super.call(this);
	}

	__class(wujiang_tips_xzfjUI,'ui.SLGGAME.wujiang_tips_xzfjUI',_super);
	var __proto=wujiang_tips_xzfjUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.chuzhengkaUI",chuzhengkaUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang_tips_xzfj");
	}

	return wujiang_tips_xzfjUI;
})(Dialog)


//class ui.SLGGAME.tips_zbUI extends laya.ui.Dialog
var tips_zbUI=(function(_super){
	function tips_zbUI(){
		this.name0=null;
		this.txt0=null;
		this.shuxing=null;
		this.tihuan=null;
		this.xiexia=null;
		this.suo=null;
		this.img0=null;
		this.qianghua=null;
		tips_zbUI.__super.call(this);
	}

	__class(tips_zbUI,'ui.SLGGAME.tips_zbUI',_super);
	var __proto=tips_zbUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_zb");
	}

	return tips_zbUI;
})(Dialog)


//class ui.SLGGAME.tips_jjUI extends laya.ui.Dialog
var tips_jjUI=(function(_super){
	function tips_jjUI(){
		this.ti=null;
		this.cha=null;
		this.txt0_1=null;
		this.txt0_2=null;
		this.txt0_3=null;
		this.txt0_4=null;
		this.txt_n=null;
		this.xing0=null;
		this.x0_1=null;
		this.x0_2=null;
		this.x0_3=null;
		this.x0_4=null;
		this.x0_5=null;
		this.xing1=null;
		this.x1_1=null;
		this.x1_2=null;
		this.x1_3=null;
		this.x1_4=null;
		this.x1_5=null;
		this.txt1_1=null;
		this.txt1_2=null;
		this.txt1_3=null;
		this.txt1_4=null;
		this.jt=null;
		this.ka=null;
		this.xh=null;
		this.img0=null;
		this.shu0=null;
		this.jinjie=null;
		tips_jjUI.__super.call(this);
	}

	__class(tips_jjUI,'ui.SLGGAME.tips_jjUI',_super);
	var __proto=tips_jjUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_jj");
	}

	return tips_jjUI;
})(Dialog)


//class ui.SLGGAME.tips_bfUI extends laya.ui.Dialog
var tips_bfUI=(function(_super){
	function tips_bfUI(){
		this.ti=null;
		this.cha=null;
		this.lista=null;
		tips_bfUI.__super.call(this);
	}

	__class(tips_bfUI,'ui.SLGGAME.tips_bfUI',_super);
	var __proto=tips_bfUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_bf");
	}

	return tips_bfUI;
})(Dialog)


//class ui.SLGGAME.wujiang0_3_zzUI extends laya.ui.Dialog
var wujiang0_3_zzUI=(function(_super){
	function wujiang0_3_zzUI(){
		this.list0=null;
		this.xuexi=null;
		this.ti=null;
		wujiang0_3_zzUI.__super.call(this);
	}

	__class(wujiang0_3_zzUI,'ui.SLGGAME.wujiang0_3_zzUI',_super);
	var __proto=wujiang0_3_zzUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.wujiang0_3_zz0UI",wujiang0_3_zz0UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/wujiang0_3_zz");
	}

	return wujiang0_3_zzUI;
})(Dialog)


//class ui.SLGGAME.xiangouUI extends laya.ui.Dialog
var xiangouUI=(function(_super){
	function xiangouUI(){
		this.cha=null;
		this.di=null;
		this.txt1=null;
		this.btn0=null;
		this.zizi=null;
		this.time=null;
		this.yilingqu=null;
		this.zhuan1=null;
		this.ti=null;
		xiangouUI.__super.call(this);
	}

	__class(xiangouUI,'ui.SLGGAME.xiangouUI',_super);
	var __proto=xiangouUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/xiangou");
	}

	return xiangouUI;
})(Dialog)


//class ui.SLGGAME.map_xjlbUI extends laya.ui.Dialog
var map_xjlbUI=(function(_super){
	function map_xjlbUI(){
		this.cha=null;
		this.xiangyou=null;
		this.xiangzuo=null;
		this.ti=null;
		map_xjlbUI.__super.call(this);
	}

	__class(map_xjlbUI,'ui.SLGGAME.map_xjlbUI',_super);
	var __proto=map_xjlbUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/map_xjlb");
	}

	return map_xjlbUI;
})(Dialog)


//class huamao.panel.cityBuild.CreateBuildItem extends ui.SLGGAME.icon_cheng_js0UI
var CreateBuildItem=(function(_super){
	function CreateBuildItem(){
		this._sysBuilding=null;
		this.mapCityAction=null;
		this.mapCitySession=null;
		this._curData=null;
		CreateBuildItem.__super.call(this);
		App.injOne(this);
		this.jianzao.on("click",this,this.onCreate,[0]);
		this.piliang.on("click",this,this.onCreate,[1]);
	}

	__class(CreateBuildItem,'huamao.panel.cityBuild.CreateBuildItem',_super);
	var __proto=CreateBuildItem.prototype;
	__proto.setData=function(buildData){
		this._curData=buildData;
	}

	__proto.onCreate=function(type){
		if(type==0){
			if(this.mapCitySession.checkTongqian(this._sysBuilding.upgradeCost)==false){
				FlyUpTips.setTips("铜钱不足");
				return;
			}
			this.mapCityAction.onLvupBuild(this._curData.cityId,this._curData.index,this._sysBuilding.buildType);
			App.voiceManager.playSound("build.wav");
		}
		else if(type==1){
			if(this.mapCitySession.checkTongqian(this._sysBuilding.upgradeCost)==false){
				FlyUpTips.setTips("铜钱不足");
				return;
			}
			this.mapCitySession._sendDataList.length=0;
			var data;
			for(var $each_data in this.mapCitySession.innerBuildObj){
				data=this.mapCitySession.innerBuildObj[$each_data];
				if(data.isHas==0){
					this.mapCitySession._sendDataList.push([data.cityId,data.index]);
				}
			}
			App.voiceManager.playSound("build.wav");
			this.mapCitySession.startJs(this._sysBuilding);
		};
		var dialog=Dialog.manager.getChildByName("CITY_BUILD_CREATE");
		if(dialog){
			dialog.close();
		}
	}

	__proto.update=function(type,level){
		this._sysBuilding=ConfigManager.getConfig("sys_building.txt",type+"_"+level);
		this.name0.text=this._sysBuilding.buildName;
		this.txt0.text=this._sysBuilding.buildText;
		this.jinbi.text=this._sysBuilding.upgradeCost+"";
		this.time0.text=GameUtils.time(this._sysBuilding.upgradeTime);
		this.ka.skin="comp/town/k_"+type+".png";
	}

	return CreateBuildItem;
})(icon_cheng_js0UI)


//class ui.tips_fenxiangUI extends laya.ui.Dialog
var tips_fenxiangUI=(function(_super){
	function tips_fenxiangUI(){
		this.shijie=null;
		this.guojia=null;
		this.dangqian=null;
		this.xuepai=null;
		this.quxiao=null;
		this.queding=null;
		tips_fenxiangUI.__super.call(this);
	}

	__class(tips_fenxiangUI,'ui.tips_fenxiangUI',_super);
	var __proto=tips_fenxiangUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("tips_fenxiang");
	}

	return tips_fenxiangUI;
})(Dialog)


//class huamao.panel.dropGift.DropGiftItem extends ui.SLGGAME.icon_dl_tips1UI
var DropGiftItem=(function(_super){
	function DropGiftItem(){
		this.num=5;
		this.imgArr=[];
		DropGiftItem.__super.call(this);
		App.injOne(this);
		for (var i=0;i < this.num;i++){
			var item=new Item();
			item.size(this.b1.width-6,this.b1.height-6);
			item.pos(3,3);
			item.isViewTips(true);
			this["b"+(i+1)].addChild(item);
			this.imgArr.push(item);
		}
	}

	__class(DropGiftItem,'huamao.panel.dropGift.DropGiftItem',_super);
	var __proto=DropGiftItem.prototype;
	__proto.upData=function(data){
		var drop=data;
		var sysCity=ConfigManager.getConfig("sys_city.txt",drop.cityId);
		this.txt0.text=GameUtils.timeFormat(drop.dropTime,2)+"进攻"+sysCity.cityName+"获胜";
		this.ChoiceName(drop.dropStr);
	}

	__proto.ChoiceName=function(dropStr){
		var item=dropStr.split(",");
		for (var i=0;i < item.length/2;i++){
			this["t"+(i+1)].text=item[i*2+1];
			this.imgArr[i].setItemId(parseInt(item[i*2]));
		}
		this.visibleItem(item.length/2);
	}

	__proto.visibleItem=function(num){
		for (var i=num;i < 5;i++){
			this["b"+(i+1)].visible=this.imgArr[i].visible=this["t"+(i+1)].visible=false;
		}
	}

	return DropGiftItem;
})(icon_dl_tips1UI)


//class ui.zhanbao_shoucangUI extends laya.ui.Dialog
var zhanbao_shoucangUI=(function(_super){
	function zhanbao_shoucangUI(){
		this.zuo=null;
		this.you=null;
		this.yema=null;
		this.ti=null;
		zhanbao_shoucangUI.__super.call(this);
	}

	__class(zhanbao_shoucangUI,'ui.zhanbao_shoucangUI',_super);
	var __proto=zhanbao_shoucangUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("zhanbao_shoucang");
	}

	return zhanbao_shoucangUI;
})(Dialog)


//class huamao.panel.duobao.DuoBaoJiLuItem extends ui.SLGGAME.icon_dl_tips1UI
var DuoBaoJiLuItem=(function(_super){
	function DuoBaoJiLuItem(){
		this.num=5;
		this.imgArr=[];
		DuoBaoJiLuItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(DuoBaoJiLuItem,'huamao.panel.duobao.DuoBaoJiLuItem',_super);
	var __proto=DuoBaoJiLuItem.prototype;
	__proto.init=function(){
		this.n0.visible=this.txt0.visible=false;
		for (var i=0;i < this.num;i++){
			var item=new Item();
			item.size(this.b1.width-6,this.b1.height-6);
			item.pos(3,3);
			item.isViewTips(true);
			this["b"+(i+1)].addChild(item);
			this.imgArr.push(item);
		}
	}

	__proto.flushData=function(){
		this.txt0.visible=false;
		for (var i=0;i < this.num;i++){
			this["b"+(i+1)].visible=this["t"+(i+1)].visible=false;
		}
	}

	__proto.upData=function(data){
		var item=data.toString().split(",")
		this.txt0.text=GameUtils.timeFormat(parseInt(item[0])/1000,2);
		if(item.length==2){
			this.changeitem(1,this.getdraw(item[1]).drawType,this.getdraw(item[1]).drawNumber);
			}else if(item.length==6){
			for (var i=1;i <=5;i++){
				this.changeitem5((i),this.getdraw(item[i]).drawType,this.getdraw(item[i]).drawNumber);
			}
			}else{
			this.flushData();
		}
	}

	__proto.changeitem5=function(numLength,type,num){
		this["t"+numLength].text=num;
		this.imgArr[numLength-1].setItemId(type);
		this["b"+numLength].visible=this["t"+numLength].visible=this.txt0.visible=true;
	}

	__proto.changeitem=function(numLength,type,num){
		for (var i=0;i < numLength;i++){
			this["t"+(i+1)].text=num;
			this.imgArr[i].setItemId(type);
		}
		for (var j=numLength+1;j <=5;j++){
			this["b"+j].visible=this["t"+j].visible=false;
		}
		this.txt0.visible=true;
	}

	__proto.getdraw=function(num){
		var sys=ConfigManager.getConfig("sys_draw.txt",num);
		return sys;
	}

	return DuoBaoJiLuItem;
})(icon_dl_tips1UI)


//class ui.SLGGAME.zhanbao_zdtjUI extends laya.ui.Dialog
var zhanbao_zdtjUI=(function(_super){
	function zhanbao_zdtjUI(){
		this.cha=null;
		this.box0=null;
		this.box1=null;
		this.img0=null;
		this.ti=null;
		zhanbao_zdtjUI.__super.call(this);
	}

	__class(zhanbao_zdtjUI,'ui.SLGGAME.zhanbao_zdtjUI',_super);
	var __proto=zhanbao_zdtjUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhanbao_zdtj");
	}

	return zhanbao_zdtjUI;
})(Dialog)


//class huamao.panel.duobao.DuoBaoPanel extends ui.huodong_duobaoUI
var DuoBaoPanel=(function(_super){
	function DuoBaoPanel(){
		this.quanNum=7;
		//转盘旋转圈数
		this.Jpwz=3;
		//奖品位置 0-11 可以自己修改
		this.Jpwz2=7;
		this.drawTimesArr=[];
		this.RotationLong=NaN;
		//总的角位移
		this.fiveZhuanNum=0;
		this.isColdTime=true;
		this.itemArr=[];
		this.juanNum=0;
		//奖券数量
		this.dataArr=null;
		this.duoBaoSession=null;
		this.bagSession=null;
		this.zhuanNum=0;
		this.itemPosArr=[279,81,360,107,420,170,441,248,420,327,
		360,391,279,405,199,391,137,327,111,248,137,170,199,107];
		this.clipPosArr=[269,71,351,94,410,158,433,236,411,316,351,380,269,394,
		189,379,129,314,100,236,127,158,190,96];
		this.count=0;
		this.dataArr5=[];
		this.lastJpwz=0;
		this.zhenZ=0;
		DuoBaoPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(DuoBaoPanel,'huamao.panel.duobao.DuoBaoPanel',_super);
	var __proto=DuoBaoPanel.prototype;
	//App.setCloseDialogOnSide()
	__proto.init=function(){
		this.duo1.on("click",this,this.oneDuoBao);
		this.duo5.on("click",this,this.fiveDuoBao);
		this.jilu.on("click",this,this.openDBJL);
		this.zhen.liang.visible=false;
		this.createItem();
		this.guize.on("click",this,this.getTips);
		this.OnEventClick();
		this.riqi.text=KaBaoData.getHuoDongTime(8);
		this.zhuandong.visible=false;
		this.l1.visible=false;
		this.pinzhiImg();
	}

	__proto.pinzhiImg=function(){
		var sys=ConfigManager.getDataArr("sys_draw.txt");
		for (var i=0;i < sys.length;i++){
			if(sys[i].drawQuality==1){
				}else{
				var img=new Image();
				if(sys[i].drawQuality==2){
					img.skin="comp/huodong/XYjiao.png";
					}else{
					img.skin="comp/huodong/JPjiao.png";
				}
				this.yimaizhi.addChild(img);
				img.pos(this.itemPosArr[i*2]-3,this.itemPosArr[i*2+1]-44-3)
			}
		}
	}

	__proto.OnEventClick=function(){
		for (var i=0;i < 5;i++){
			this["xiangzi"+(i+1)].on("click",this,this.baoXingLingQu,[(i+1)]);
			this["xiang"+(i+1)].text=this.getBoxLabel(i+1);
		}
	}

	__proto.upData=function(arr){
		this.dataArr=arr;
		this.BaoXiangItem();
		this.ewai.text=""+this.dataArr.weekBaoXiangNum;
	}

	//
	__proto.zhuanDraw=function(num){
		App.setCloseDialogOnSide(false);
		App.eventManager.event("CANCELCHA",[false]);
		this.Jpwz=this.duoBaoSession.drawArr[0]-1;
		if(num==1){
			this.RotationLong=this.quanLong();
			Tween.to(this.zhen,{rotation:this.RotationLong},3000,Ease.sineOut,Handler.create(this,this.OnAwarded,[(this.Jpwz+1)]));
			this.isColdTime=false;
			this.dataArr.juanNum--;
			}else{
			this.RotationLong=this.quanLong();
			Tween.to(this.zhen,{rotation:this.RotationLong},3000,Ease.sineOut,Handler.create(this,this.fiveAwarded));
			this.isColdTime=false;
			this.dataArr.juanNum-=5;
		}
	}

	__proto.baoXingLingQu=function(num){
		App.eventManager.event("DUOBAOBAOXIANG",[num]);
	}

	__proto.BaoXiangItem=function(){
		var item=this.dataArr.drawBoxLog.split(";")
		for (var i=0;i < 5;i++){
			var isView=item[i].split(",")[1]
			if(isView==0){
				this["xiangzi"+(i+1)].disabled=true;
				this["yiling"+(i+1)].visible=false;
				}else if(isView==2){
				this["xiangzi"+(i+1)].disabled=this["yiling"+(i+1)].visible=true;
			}
			else{
				this["xiangzi"+(i+1)].disabled=this["yiling"+(i+1)].visible=false;
			}
		}
		this.ci1.text=this.bagSession.getItemNumByItemId(10606)+"/1";
		this.ci5.text=this.bagSession.getItemNumByItemId(10606)+"/5";
		this.ci1.color="#ffffff";
		if(this.dataArr.freeJuan==0){
			this.ci1.text="免费";
			this.ci1.color="#41be3b";
		}
		console.log("dataArr.juanNum0-->"+this.dataArr.juanNum);
	}

	__proto.createItem=function(){
		var duoBaoData=new DuoBaoData();
		for (var i=0;i < 12;i++){
			var icon=new Item();
			this.yimaizhi.addChild(icon);
			icon.pos(this.itemPosArr[i*2],this.itemPosArr[i*2+1]-44);
			icon.size(44,44);
			var num=duoBaoData.getItem(i+1).drawType;
			icon.setItemId(num);
			icon.setNum(duoBaoData.getItem(i+1).drawNumber);
			this.itemArr.push(icon);
			console.log("num ="+num);
			var sysitem=ConfigManager.getConfig("sys_item.txt",num);
			this["wu"+(i+1)].text=sysitem.itemName;
			this["wu"+(i+1)].fontSize=16;
			this["wu"+(i+1)].align="center";
		}
	}

	__proto.liangZhen=function(){
		Laya.timer.frameLoop(2,this,this.LiangZhenZhuan);
	}

	__proto.LiangZhenZhuan=function(){
		for (var i=0;i < 12;i++){
			if((this.zhen.rotation%360>=(360/12)*i)&&(this.zhen.rotation%360<(360/12)*(i+1))){
				this.l1.pos(this.clipPosArr[i*2],this.clipPosArr[i*2+1]);
				this.l1.visible=true;
				break ;
			}
		}
	}

	__proto.openDBJL=function(){
		App.dialogManager.openDialogByStr("DUOBAOJILU",null,true,true);
	}

	__proto.oneDuoBao=function(){
		if(this.isColdTime||this.dataArr.freeJuan>=50){
			if(this.dataArr.freeJuan>=50){
				App.eventManager.event("DUOBAOSEND",[1]);
				}else if(this.dataArr.juanNum>=1||this.dataArr.freeJuan==0){
				this.duoduo.ani1.play(0,false);
				this.liangZhen();
				App.eventManager.event("DUOBAOSEND",[1]);
				this.isColdTime=false;
				}else{
				var tips=App.dialogManager.showMiniDialog(DuoBaoTips,true,true);
				tips.onClickBtn(1);
				tips.buyJaunTips(0,1);
			}
		}
		console.log("weekBaoXiangNum---->"+this.dataArr.weekBaoXiangNum);
	}

	__proto.oneDB=function(count){
		this.liangZhen();
		this.duoduo.ani1.play(0,false);
		App.eventManager.event("DUOBAOSEND",[count]);
		console.log("App.eventManager");
		this.isColdTime=false;
	}

	__proto.fiveDuoBao=function(){
		if(this.isColdTime||this.dataArr.freeJuan>=50){
			if(this.dataArr.freeJuan>=50){
				App.eventManager.event("DUOBAOSEND",[5]);
				}else if(this.dataArr.juanNum>=5){
				this.duoduo.ani1.play(0,false);
				this.liangZhen();
				App.eventManager.event("DUOBAOSEND",[5]);
				console.log("App.eventManager5ci");
				this.isColdTime=false;
				}else{
				var tips=App.dialogManager.showMiniDialog(DuoBaoTips,true,true);
				var num=5-this.dataArr.juanNum;
				tips.onClickBtn(num,5);
				tips.buyJaunTips(0,num);
				console.log("App.eventManager5");
			}
		}
	}

	__proto.OnAwarded=function(numId){
		this.isColdTime=true;
		this.LiangZhenZhuan();
		Laya.timer.clear(this,this.LiangZhenZhuan);
		GameUtils.setFlyToItem([this.itemArr[numId-1]],15,2000);
		this.flashZhen();
		Laya.timer.once(500,this,this.getRewardTips,[numId]);
	}

	//App.setCloseDialogOnSide(true);
	__proto.flashZhen=function(){
		this.zhen.liang.visible=true;
		this.zhen.liang.blendMode="lighter";
		Laya.timer.once(70,this,this.isBlendMode);
	}

	__proto.isBlendMode=function(){
		if(this.count==3){
			this.count=0;
			}else{
			if(this.count%2==0){
				this.zhen.liang.visible=false;
				}else{
				this.zhen.liang.visible=true;
			}
			Laya.timer.once(70,this,this.isBlendMode);
			this.count++;
		}
	}

	__proto.fiveAwarded=function(){
		GameUtils.setFlyToItem([this.itemArr[this.Jpwz]],15,2000);
		this.flashZhen();
		this.quanNum=2;
		this.Jpwz=this.duoBaoSession.drawArr[this.fiveZhuanNum+1]-1;
		this.fiveZhuanNum++;
		if(this.fiveZhuanNum<=4){
			this.RotationLong=this.quanLong();
			Tween.to(this.zhen,{rotation:this.RotationLong},2000,Ease.quartInOut,Handler.create(this,this.fiveAwarded));
			}else{
			Laya.timer.once(500,this,this.getReward5Tips);
			this.fiveZhuanNum=0;
			this.isColdTime=true;
			this.quanNum=7;
			Laya.timer.clear(this,this.LiangZhenZhuan);
		}
	}

	//App.setCloseDialogOnSide(true);
	__proto.getRewardTips=function(numId){
		App.setCloseDialogOnSide(true);
		App.eventManager.event("CANCELCHA",[true]);
		var str=this.getAwardTipsStr(numId);
		FlyUpTips.setTips(str);
	}

	__proto.getReward5Tips=function(){
		App.setCloseDialogOnSide(true);
		App.eventManager.event("CANCELCHA",[true]);
		this.dataArr5.length=0;
		for (var i=0;i < this.duoBaoSession.drawArr.length;i++){
			var sys=this.getdrawNumber(this.duoBaoSession.drawArr[i]);
			this.dataArr5.push(sys.drawType,sys.drawNumber);
		};
		var tips=App.dialogManager.showMiniDialog(TipsGetItem,true,false);
		tips.setData(0,this.dataArr5);
	}

	__proto.quanLong=function(){
		var RotationLongZ=0;
		console.log("zhen.rotation-->"+this.zhen.rotation);
		if(this.zhen.rotation==0){
			RotationLongZ=360*this.quanNum+360/12*this.Jpwz;
			this.lastJpwz=this.Jpwz;
			}else{
			this.zhen.rotation=360/12*this.lastJpwz+this.zhenZ;
			RotationLongZ=(360*this.quanNum+1)+360/12*this.Jpwz;
			this.zhenZ=1;
			this.lastJpwz=this.Jpwz;
		}
		console.log("lastJpwz==>"+this.lastJpwz);
		return RotationLongZ;
	}

	__proto.getTips=function(){
		var sys=ConfigManager.getConfig("sys_tips.txt",3012);
		FlyLittleUpTips.setTips(sys.tipsDescribe);
	}

	__proto.getBoxLabel=function(num){
		var sys=ConfigManager.getConfig("sys_draw_award.txt",num);
		return sys.drawAwardNeed;
	}

	__proto.getAwardTipsStr=function(numId){
		var sys=ConfigManager.getConfig("sys_draw.txt",numId);
		var sysitem=ConfigManager.getConfig("sys_item.txt",sys.drawType);
		var str="获得"+sys.drawNumber+"个"+sysitem.itemName;
		return str;
	}

	__proto.getdrawNumber=function(numId){
		var sys=ConfigManager.getConfig("sys_draw.txt",numId);
		return sys;
	}

	return DuoBaoPanel;
})(huodong_duobaoUI)


//class ui.SLGGAME.tips_bzUI extends laya.ui.Dialog
var tips_bzUI=(function(_super){
	function tips_bzUI(){
		this.cha=null;
		this.list0=null;
		tips_bzUI.__super.call(this);
	}

	__class(tips_bzUI,'ui.SLGGAME.tips_bzUI',_super);
	var __proto=tips_bzUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.tips_bz0UI",tips_bz0UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_bz");
	}

	return tips_bzUI;
})(Dialog)


//class ui.SLGGAME.zhaomu_mjhcUI extends laya.ui.Dialog
var zhaomu_mjhcUI=(function(_super){
	function zhaomu_mjhcUI(){
		this.list0=null;
		this.hecheng=null;
		this.hun=null;
		this.wu=null;
		zhaomu_mjhcUI.__super.call(this);
	}

	__class(zhaomu_mjhcUI,'ui.SLGGAME.zhaomu_mjhcUI',_super);
	var __proto=zhaomu_mjhcUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.ka1UI",ka1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhaomu_mjhc");
	}

	return zhaomu_mjhcUI;
})(Dialog)


//class ui.SLGGAME.zhaomu_mjlUI extends laya.ui.Dialog
var zhaomu_mjlUI=(function(_super){
	function zhaomu_mjlUI(){
		this.list0=null;
		this.shu=null;
		this.tab0=null;
		zhaomu_mjlUI.__super.call(this);
	}

	__class(zhaomu_mjlUI,'ui.SLGGAME.zhaomu_mjlUI',_super);
	var __proto=zhaomu_mjlUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.ka1UI",ka1UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhaomu_mjl");
	}

	return zhaomu_mjlUI;
})(Dialog)


//class huamao.panel.gameOver.DianzanItem extends ui.SLGGAME.jiesuan_1_0UI
var DianzanItem=(function(_super){
	function DianzanItem(){
		this.playerInfoAction=null;
		this.data=null;
		DianzanItem.__super.call(this);
		App.injOne(this);
		this.on("click",this,this.onClick);
		this.xin.mouseEnabled=false;
	}

	__class(DianzanItem,'huamao.panel.gameOver.DianzanItem',_super);
	var __proto=DianzanItem.prototype;
	__proto.onClick=function(){
		this.playerInfoAction.sendDianzan(this.data.playerId ,(this.data.isZan==0)?1:0);
	}

	__proto.setDianZanData=function(data){
		this.data=data;
		this.txt0.text=data.playerName;
		this.xin.selected=(data.isZan==1);
		this.img0.skin=GameUtils.getHeadUrl(data.playerStyle);
		this.txt0.width=this.width;
		this.txt0.centerX=0;
	}

	return DianzanItem;
})(jiesuan_1_0UI)


//class ui.SLGGAME.zhaomu_mjl_wjUI extends laya.ui.Dialog
var zhaomu_mjl_wjUI=(function(_super){
	function zhaomu_mjl_wjUI(){
		this.bingzhong=null;
		this.fujiang=null;
		this.d0=null;
		this.box0=null;
		this.dengji=null;
		this.name0=null;
		this.czz=null;
		this.img0=null;
		this.tex1=null;
		this.huo=null;
		this.mingzi=null;
		this.juexing=null;
		this.tex3=null;
		this.pingjia=null;
		this.ti=null;
		this.yong=null;
		this.yu=null;
		this.zhi=null;
		this.wei=null;
		this.wk=null;
		zhaomu_mjl_wjUI.__super.call(this);
	}

	__class(zhaomu_mjl_wjUI,'ui.SLGGAME.zhaomu_mjl_wjUI',_super);
	var __proto=zhaomu_mjl_wjUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("HTMLDivElement",HTMLDivElement);
		View.regComponent("ui.wujiangka_daUI",wujiangka_daUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhaomu_mjl_wj");
	}

	return zhaomu_mjl_wjUI;
})(Dialog)


//class ui.SLGGAME.tips_tjfjUI extends laya.ui.Dialog
var tips_tjfjUI=(function(_super){
	function tips_tjfjUI(){
		this.cha=null;
		this.fj=null;
		this.list0=null;
		tips_tjfjUI.__super.call(this);
	}

	__class(tips_tjfjUI,'ui.SLGGAME.tips_tjfjUI',_super);
	var __proto=tips_tjfjUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.chuzhengkaUI",chuzhengkaUI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/tips_tjfj");
	}

	return tips_tjfjUI;
})(Dialog)


//class ui.SLGGAME.zhaomu_jlUI extends laya.ui.Dialog
var zhaomu_jlUI=(function(_super){
	function zhaomu_jlUI(){
		this.txt0=null;
		this.list0=null;
		this.v0=null;
		zhaomu_jlUI.__super.call(this);
	}

	__class(zhaomu_jlUI,'ui.SLGGAME.zhaomu_jlUI',_super);
	var __proto=zhaomu_jlUI.prototype;
	__proto.createChildren=function(){
		View.regComponent("ui.SLGGAME.zhaomu_jl0UI",zhaomu_jl0UI);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhaomu_jl");
	}

	return zhaomu_jlUI;
})(Dialog)


//class ui.SLGGAME.zhaomu_ghUI extends laya.ui.Dialog
var zhaomu_ghUI=(function(_super){
	function zhaomu_ghUI(){
		this.btn_1=null;
		this.btn_2=null;
		this.btn_0=null;
		this.btn_3=null;
		this.btn_no=null;
		this.btn_yes=null;
		zhaomu_ghUI.__super.call(this);
	}

	__class(zhaomu_ghUI,'ui.SLGGAME.zhaomu_ghUI',_super);
	var __proto=zhaomu_ghUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhaomu_gh");
	}

	return zhaomu_ghUI;
})(Dialog)


//class ui.SLGGAME.zhaomuUI extends laya.ui.Dialog
var zhaomuUI=(function(_super){
	function zhaomuUI(){
		this.wuhun=null;
		this.houmianfei0=null;
		this.houmianfei=null;
		this.zhaomuling=null;
		this.zhao1ge=null;
		this.zhao5ge=null;
		this.mai5ge=null;
		this.mai1ge=null;
		this.huafei=null;
		this.mingjianglu=null;
		this.zhaomujilu=null;
		this.hecheng=null;
		this.cha=null;
		this.mian=null;
		this.zaigou=null;
		this.mingzi=null;
		this.ti=null;
		this.shu=null;
		this.geng=null;
		this.yuanbao=null;
		this.btn_yb=null;
		zhaomuUI.__super.call(this);
	}

	__class(zhaomuUI,'ui.SLGGAME.zhaomuUI',_super);
	var __proto=zhaomuUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/zhaomu");
	}

	return zhaomuUI;
})(Dialog)


//class ui.SLGGAME.npc_yqhyUI extends laya.ui.Dialog
var npc_yqhyUI=(function(_super){
	function npc_yqhyUI(){
		this.tab0=null;
		this.txt_0=null;
		this.txt1=null;
		npc_yqhyUI.__super.call(this);
	}

	__class(npc_yqhyUI,'ui.SLGGAME.npc_yqhyUI',_super);
	var __proto=npc_yqhyUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/npc_yqhy");
	}

	return npc_yqhyUI;
})(Dialog)


//class huamao.panel.haoyou.ChatItem extends ui.SLGGAME.haoyou_qipaoUI
var ChatItem=(function(_super){
	function ChatItem(){
		this.hh=0;
		this._head=null;
		this._head1=null;
		this.mainPlayerSession=null;
		this.friendSession=null;
		this.headlen=50;
		this._chatData=null;
		ChatItem.__super.call(this);
		App.injOne(this);
		this._head=new Image();
		this._head.size(this.headlen,this.headlen);
		this._head1=new Image();
		this._head1.size(this.headlen,this.headlen);
		this.addChild(this._head);
		this._head.x=this.qipao1.box0.x;
		this.addChild(this._head1);
		this._head1.x=this.qipao0.box0.x;
		this.on("click",this,this.onClick);
		this._head.x+=12;
		this._head1.x+=4;
		this._head.y+=3;
		this._head1.y+=3;
	}

	__class(ChatItem,'huamao.panel.haoyou.ChatItem',_super);
	var __proto=ChatItem.prototype;
	__proto.onClick=function(){
		if(this._chatData.msgType==1){
			App.eventManager.event("BATTLE",this._chatData.content);
		}
	}

	__proto.update=function(data){
		this._chatData=data;
		this.qipao0.visible=this.qipao1.visible=false;
		var txtHeight=0;
		this.hh=60;
		this._head.visible=this._head1.visible=false;
		if(data.isSelf){
			this._head.visible=true;
			this._head.skin=GameUtils.getHeadUrl(this.mainPlayerSession.mainPlayerData.style);
			this.qipao1.visible=true;
			this.setContent(this.qipao1.txt0);
			txtHeight=this.qipao1.txt0.textField.textHeight;
			if(txtHeight > 40){
				this.qipao1.txt0.height=this.qipao1.txt0.textField.textHeight+5;
				this.qipao1.img0.height=this.qipao1.txt0.height;
				this.hh=this.qipao1.img0.y+this.qipao1.img0.height;
			}
		}
		else{
			this._head1.visible=true;
			this._head1.skin=GameUtils.getHeadUrl(this.friendSession.getFriend(data.fromId).style);
			this.qipao0.visible=true;
			this.setContent(this.qipao0.tox0);
			txtHeight=this.qipao1.txt0.textField.textHeight;
			if(txtHeight > 40){
				this.qipao0.tox0.height=this.qipao0.tox0.textField.textHeight+5;
				this.qipao0.img0.height=this.qipao0.tox0.height;
				this.hh=this.qipao0.img0.y+this.qipao0.img0.height;
			}
		}
	}

	__proto.setContent=function(label){
		label.underline=false;
		if(this._chatData.msgType==0){
			label.text=this._chatData.content;
		}
		else if(this._chatData.msgType==1){
			label.text="我分享了一份战报给你";
			label.underline=true;
		}
	}

	return ChatItem;
})(haoyou_qipaoUI)


/**
*英雄卡
*@aHeroBox
*
*/
//class huamao.panel.hero.HeroBox extends ui.SLGGAME.kaUI
var HeroBox=(function(_super){
	function HeroBox(){
		this.heroImage=null;
		this.sysHero=null;
		this.heroData=null;
		this.heroType=0;
		this.maxStar=5;
		this.team=0;
		this.imageFont=null;
		this.bagSession=null;
		this.weapon=null;
		this.def=null;
		this.mount=null;
		this.wuJiangSession=null;
		this.weaponSp=new Sprite();
		this.allFont=new Sprite();
		HeroBox.__super.call(this);
		App.injOne(this);
		this.addChild(this.weaponSp);
		this.imageFont=new ImageFont(9);
		this.heroImage=new HeroImage();
		this.heroImage.size(this.box.width,this.box.height);
		this.box.addChild(this.heroImage);
		this.allFont.addChild(this.imageFont);
		this.imageFont.x=30;
		this.weapon=new Item();
		this.def=new Item();
		this.mount=new Item();
		this.makeBox(this.weapon,this.box1);
		this.makeBox(this.def,this.box2);
		this.makeBox(this.mount,this.box3);
	}

	__class(HeroBox,'huamao.panel.hero.HeroBox',_super);
	var __proto=HeroBox.prototype;
	__proto.makeBox=function(item,box){
		box.addChild(item);
		item.size(box.width,box.height);
	}

	/**
	*设置武将数据
	*@param data
	*@param type 1武将列表显示的武将 2 其他人的武将 3 商店里的武将 4 展示自己的武将只显示名字 等级 品质 国家 目前 和 2 查看其它人 一样
	*/
	__proto.setHeroData=function(data,type){
		(type===void 0)&& (type=1);
		this.heroType=type;
		this.setType(type);
		this.heroData=data;
		this.tiao.skin=GameUtils.getZiDi(data.sysHero.heroColor);
		this.sysHero=data.sysHero;
		this.di.skin=GameUtils.getDi(this.sysHero.heroColor);
		GameUtils.getKaKuang(this.wk,this.sysHero.heroColor);
		this.kuang0.visible=this.hei.visible=this.box_x.visible=false;
		this.name0.text=this.sysHero.heroName;
		this.img0.skin=GameUtils.getCountry(this.sysHero.heroCountry);
		this.heroImage.setHeroId(data.heroId);
		this.setLv(this.heroData.heroLv);
		this.setHeroStar(this.heroData.heroStar);
		this.setFight(this.heroData.fight);
		this.zhuangtai.skin=this.getState();
		var sysCity=ConfigManager.getConfig("sys_city.txt",this.heroData.cityId);
		this.txt0.text="";
		if(sysCity){
			this.txt0.text=sysCity.cityName;
			this.box_c.visible=true;
		}
		else{
			this.box_c.visible=false;
		}
		if(data.legion !="" || data.masterId !=0){
			this.box_jt.visible=true;
			var hero;
			if(data.legion!=""){
				hero=data;
			}
			else{
				hero=this.wuJiangSession.getHero(data.masterId);
			}
			this.txt1.text="<"+hero.sysHero.heroName+"军团>";
		}
		else{
			this.box_jt.visible=false;
		}
	}

	//如果当前自己是副将 就显示副将 否则显示正常的状态
	__proto.getState=function(){
		if(this.heroData.masterId>0){
			return "comp/G/zt_fujiang.png";
		}
		else if(this.heroData.heroState==0){
			return "comp/G/zt_kongxian.png";
		}
		else if(this.heroData.heroState==1){
			return "comp/G/zt_xingjunzhong.png";
		}
		else if(this.heroData.heroState==2){
			return "comp/G/zt_zhushouzhong.png";
		}
		else if(this.heroData.heroState==3){
			return "comp/G/zt_xiefangzhong.png";
		}
		return "";
	}

	__proto.setFight=function(fight){
		this.imageFont.setValue(fight);
		var w=TheGame.getWidth(this.imageFont);
	}

	// allFont.x=(zhan_d.width-(w+zhan.width))/2-10;
	__proto.setType=function(type){
		if(type==1){
			this.zhuangtai.visible=true;
			this.box_x.visible=false;
		}
		else if(type==2){
			this.zhuangtai.visible=false;
			this.box_x.visible=false;
		}
		else if(type==3){
			this.zhuangtai.visible=false;
			this.box_x.visible=false;
		}
		else if(type==4){
			this.zhuangtai.visible=false;
			this.box_x.visible=false;
		}
	}

	__proto.setLv=function(lv){
		this.dengji.text=lv+"";
	}

	__proto.setHeroStar=function(star){
		for(var i=0;i<this.maxStar;i++){
			this["xing"+(i+1)].visible=(i < star && this.heroType==1);
		}
	}

	__proto.setWeapon=function(value){
		this.weaponSp.removeChildren();
		if(value){
			var item=new Item();
			item.setItemId(this.heroData.attack);
		}
	}

	__proto.setTeam=function(value){
		this.team=value;
	}

	__proto.setEquip=function(isShow){
		this.box_tb.visible=isShow;
		var boxArr=[this.weapon,this.def,this.mount];
		for (var j=0;j < boxArr.length;j++){
			(boxArr [j]).clear();
		}
		if(isShow==false){
			return;
		};
		var arr=this.bagSession.getEquipByHeroId(this.heroData.heroId)
		for (var i=0;i < arr.length;i++){
			var data=arr [i];
			var sys=ConfigManager.getConfig("sys_item.txt",data.itemId);
			var item=boxArr[sys.itemType-1];
			item.setItemId(sys.itemId);
			item.setLv2(data.lv);
		}
	}

	HeroBox.getResUrl=function(fileName){
		return App.loaderManager.getUrl("HERO",fileName+".png");
	}

	return HeroBox;
})(kaUI)


//class huamao.panel.haoyou.HaoyouItem extends ui.SLGGAME.haoyou_0UI
var HaoyouItem=(function(_super){
	function HaoyouItem(){
		this.data=null;
		this._head=null;
		this.wDRed=null;
		this.friendSession=null;
		HaoyouItem.__super.call(this);
		App.injOne(this);
		this.jiantou.clickHandler=new Handler(this,this.showMenu);
		this.jiantou.name="jiantou";
		this.tiaozhanzhong.clickHandler=new Handler(this,this.onBattle);
		this._head=new Image();
		this._head.size(60,60);
		this.box0.addChild(this._head);
		this.wDRed=new RedPoint(0,this._head);
	}

	__class(HaoyouItem,'huamao.panel.haoyou.HaoyouItem',_super);
	var __proto=HaoyouItem.prototype;
	__proto.execute=function(){
		var boo=false;
		if(this.data && this.friendSession.getRed(this.data.friendId)){
			this.wDRed.visible=true;
			boo=true;
			}else{
			this.wDRed.visible=false;
		}
		if(boo==false && this.data){
			var isApply=this.data.checkState(4);
			var isInvite=this.data.checkState(16);
			if(isApply || isInvite){
				this.wDRed.visible=true;
			}
		}
	}

	__proto.onBattle=function(){
		if(this.data.battleFileUrl.length > 0){
			App.eventManager.event("BATTLE",this.data.battleFileUrl+"");
		}
	}

	__proto.showMenu=function(){
		App.eventManager.event("SHOW_MENU_FRIEND",[this.data]);
	}

	__proto.update=function(fdata){
		this.data=fdata;
		this.execute();
		this.namr0.text=this.data.friendName;
		this._head.skin=GameUtils.getHeadUrl(fdata.style);
		this._head.gray=fdata.isOnLine==0;
		if(fdata.beizhu !=""){
			this.txto.text=fdata.beizhu;
		}
		else{
			this.txto.text=fdata.checkState(2)? "好友" :"陌生人";
		}
		this.nameBg.skin=fdata.isTop==0 ? "comp/G/QiangHua＿0.png" :"comp/G/QiangHua＿1.png";
		if(fdata.checkState(8)){
			this.tiaozhanzhong.visible=false;
		}
		else{
			this.tiaozhanzhong.visible=this.data.battleEndTime > GameUtils.GetServerTime()&& this.data.battleFileUrl!="";
			if(this.tiaozhanzhong.visible){
				Laya.timer.loop(1000,this,this.onUpdate);
			}
			else{
				Laya.timer.clear(this,this.onUpdate);
			}
		}
	}

	__proto.onUpdate=function(){
		if(GameUtils.GetServerTime()> this.data.battleEndTime){
			this.tiaozhanzhong.visible=false;
			Laya.timer.clear(this,this.onUpdate);
		}
	}

	__getset(0,__proto,'isSelect',null,function(value){
		this.btn0.selected=value;
	});

	return HaoyouItem;
})(haoyou_0UI)


//class huamao.panel.haoyou.HaoyouMenu extends ui.SLGGAME.tips_hyUI
var HaoyouMenu=(function(_super){
	function HaoyouMenu(){
		this.btnW=60;
		this._content=null;
		this._curData=null;
		this.playerInfoAction=null;
		this.friendAction=null;
		this.friendSession=null;
		this.openFunctionSession=null;
		HaoyouMenu.__super.call(this);
		App.injOne(this);
		HaoyouMenu.obj[1]="查看";
		HaoyouMenu.obj[2]="挑战";
		HaoyouMenu.obj[3]="备注";
		HaoyouMenu.obj[4]="特别关心";
		HaoyouMenu.obj[5]="删除";
		HaoyouMenu.obj[6]="取消关心";
		HaoyouMenu.obj[7]="删除会话";
		this._content=new Sprite();
		this.addChild(this._content);
	}

	__class(HaoyouMenu,'huamao.panel.haoyou.HaoyouMenu',_super);
	var __proto=HaoyouMenu.prototype;
	__proto.setMenu=function(data,page){
		this._curData=data;
		this._content.removeChildren();
		var arr=[];
		if(page==0){
			if(data.checkState(2)){
				arr=[1,2,7];
			}
			else{
				arr=[1,7];
			}
		}
		else if(page==1){
			if(data.checkState(2)){
				if(data.isTop){
					arr=[1,2,3,6,5];
				}
				else{
					arr=[1,2,3,4,5];
				}
			}
		}
		else if(page==2){
			if(data.checkState(8)){
				if(data.isTop){
					arr=[1,3,6,5];
				}
				else{
					arr=[1,3,4,5];
				}
			}
		};
		var size=arr.length;
		for(var i=0;i < size;i++){
			var item=new MenuItem();
			var type=arr[i];
			item.update(type,HaoyouMenu.obj[type],new Handler(this,this.clickMenu,[type]));
			this._content.addChild(item);
			item.pos(7,4+i *this.btnW);
		}
		this.di.size(152,size *this.btnW+5);
		this.size(152,size *this.btnW+5);
	}

	__proto.clickMenu=function(type){
		switch(type){
			case 1:
				this.playerInfoAction.sendViewPlayerMes(this._curData.friendId);
				break ;
			case 2:
				if(this.openFunctionSession.isFunction("tiaozhan")){
					return;
				}
				App.dialogManager.openDialogByStr("ZHENGRONGXUANZE",{friendId:this._curData.friendId},true,true);
				break ;
			case 3:
				App.dialogManager.openDialogByStr("BEIZHU",{friendId:this._curData.friendId},true,true);
				break ;
			case 4:
			case 6:
				this.friendAction.onTop(this._curData.friendId,this._curData.isTop==0 ? 1 :0);
				break ;
			case 5:;
				var normalAlert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
				normalAlert.setAll("删除好友","删除后您将从对方的好友列表中消失，确定删除好友吗",new Handler(this,this.onDelete,[this._curData.friendId]));
				break ;
			case 7:
				if(this._curData.checkState(2)){
					this.friendAction.onSend(FriendAction.SubRecent,this._curData.friendId);
					this.onRmoveHuihua();
				}
				else{
					normalAlert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
					normalAlert.setAll("删除会话","删除后对方不能接受您的好友申请，需重新申请才能发起聊天",new Handler(this,this.onRmoveHuihua));
					break ;
				}
				break ;
			}
		this.removeSelf();
	}

	__proto.onRmoveHuihua=function(){
		this.friendAction.onSend(FriendAction.SubRecent,this._curData.friendId);
		this.friendSession.removeChat(this._curData.friendId);
	}

	__proto.onDelete=function(friendId){
		this.friendAction.onSend(FriendAction.Delete,friendId);
	}

	HaoyouMenu.chakan=1;
	HaoyouMenu.tiaozhan=2;
	HaoyouMenu.beizhu=3;
	HaoyouMenu.tebieguanxin=4;
	HaoyouMenu.shanchu=5;
	HaoyouMenu.quxiaoguanxin=6;
	HaoyouMenu.shanchuhuihua=7;
	__static(HaoyouMenu,
	['obj',function(){return this.obj=new Object();}
	]);
	return HaoyouMenu;
})(tips_hyUI)


//class huamao.panel.haoyou.MenuItem extends ui.SLGGAME.tips_hy0UI
var MenuItem=(function(_super){
	function MenuItem(){
		this._type=0;
		MenuItem.__super.call(this);
	}

	__class(MenuItem,'huamao.panel.haoyou.MenuItem',_super);
	var __proto=MenuItem.prototype;
	__proto.update=function(type,value,clickHandler){
		this._type=type;
		this.btn0.label=value;
		this.btn0.clickHandler=clickHandler;
	}

	return MenuItem;
})(tips_hy0UI)


//class huamao.panel.haoyou.youjian.BattleItem extends ui.SLGGAME.map0UI
var BattleItem=(function(_super){
	function BattleItem(){
		this.data=null;
		this.playerId=0;
		this.mengyou=null;
		BattleItem.__super.call(this);
		this.isSelect=false;
		this.mengyou=new MengyouBorder();
	}

	__class(BattleItem,'huamao.panel.haoyou.youjian.BattleItem',_super);
	var __proto=BattleItem.prototype;
	__proto.update=function(playerData){
		this.data=playerData;
		this.playerId=playerData.playerId;
		this.name0.text=playerData.playerName;
		this.box0.graphics.drawRect(0,0,20,20,"#"+playerData.cityFlag);
		if(this.data.hasBorder){
			console.log(playerData.playerName);
			this.mengyou.pos(-5,-4);
			this.addChild(this.mengyou);
		}
		else{
			this.mengyou.removeSelf();
		}
	}

	__getset(0,__proto,'isSelect',null,function(value){
		this.xuan.visible=value;
	});

	return BattleItem;
})(map0UI)


//class huamao.panel.haoyou.youjian.MailItem extends ui.SLGGAME.haoyou_0UI
var MailItem=(function(_super){
	function MailItem(){
		this.mailSession=null;
		this.red=null;
		this.zbRed=null;
		this.icon=null;
		MailItem.__super.call(this);
		this.init();
	}

	__class(MailItem,'huamao.panel.haoyou.youjian.MailItem',_super);
	var __proto=MailItem.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.tiaozhanzhong.visible=false;
		this.jiantou.visible=false;
		this.icon=new Item();
		this.icon.size(60,60);
		this.box0.addChild(this.icon);
		this.red=new RedPoint(0,this.icon);
	}

	__proto.selectBtn=function(boo){
		this.btn0.selected=boo;
	}

	__proto.update=function(data){
		if(data.itemArr.length>0){
			if(data.isRead!=2){
				this.red.visible=true;
				}else{
				this.red.visible=false;
			}
			}else{
			if(data.isRead>0){
				this.red.visible=false;
				}else{
				this.red.visible=true;
			}
		}
		this.namr0.text=data.mailTitle;
		if(data.mailType!=MailType.ZHANBAO){
			this.namr0.y=12;
			this.nameBg.y=13;
			this.txto.text=GameUtils.timeFormat(data.time);
			var arr=this.mailSession.sysObj[data.mailType];
			this.icon.setItemId(arr[0].mailIcon);
			if(this.zbRed){
				this.zbRed.removeSelf();
			}
		}
		else{
			if(this.zbRed){
				this.zbRed.removeSelf();
			}
			this.zbRed=new RedPoint(RedPointType.ZHANBAO,this.icon);
			var arrB=this.mailSession.getBattleArr();
			for(var i=0;i<arrB.length;i++){
				var datab=arrB[i];
				if(datab.isRead!=1){
					if(this.zbRed)this.zbRed.visible=true;
					break ;
				}
			}
			this.icon.addChild(this.zbRed);
			this.red.visible=false;
			this.txto.text="";
			this.namr0.y=28;
			this.nameBg.y=29;
			this.icon.setItemId(10501);
		}
	}

	return MailItem;
})(haoyou_0UI)


//class huamao.panel.haoyou.youjian.MailBattleItem extends ui.SLGGAME.zhanbao_0UI
var MailBattleItem=(function(_super){
	function MailBattleItem(){
		this.currData=null;
		this.mainPlayerSession=null;
		MailBattleItem.__super.call(this);
		this.init();
	}

	__class(MailBattleItem,'huamao.panel.haoyou.youjian.MailBattleItem',_super);
	var __proto=MailBattleItem.prototype;
	__proto.init=function(){
		App.injOne(this);
	}

	__proto.upData=function(data){
		if(!data)return;
		this.currData=data;
		this.time0.text=GameUtils.timeFormat(data.time);
		var sysCity=ConfigManager.getConfig("sys_city.txt",data.cityId);
		this.where0.text=sysCity.cityName;
		if(this.mainPlayerSession.mainPlayerData.playerId==data.atkId){
			this.who0.text=data.defenseId==0 ? sysCity.cityName+"守军" :data.defenseName;
			this.zhuangtai.skin="comp/zhanbaolb/zb_0.png";
			this.jieguo.skin=data.type==1 ? "comp/G/img_sl.png" :"comp/G/img_sb.png";
		}
		else{
			this.who0.text=data.atkName;
			this.zhuangtai.skin="comp/zhanbaolb/zb_1.png";
			this.jieguo.skin=data.type==0 ? "comp/G/img_sl.png" :"comp/G/img_sb.png";
		}
	}

	return MailBattleItem;
})(zhanbao_0UI)


//class huamao.panel.haoyou.youjian.TiaoZhanItem extends ui.SLGGAME.haoyoutiaozhan1UI
var TiaoZhanItem=(function(_super){
	function TiaoZhanItem(){
		this.currData=null;
		this.friendAction=null;
		TiaoZhanItem.__super.call(this);
		this.init();
	}

	__class(TiaoZhanItem,'huamao.panel.haoyou.youjian.TiaoZhanItem',_super);
	var __proto=TiaoZhanItem.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.shanchu.on("click",this,this.clickHandlen);
	}

	__proto.clickHandlen=function(){
		if(this.currData){
			this.friendAction.sendDeleteBattle(this.currData.battleId);
		}
	}

	__proto.upData=function(data){
		if(!data)return;
		this.currData=data;
		this.time0.text=GameUtils.timeFormat(data.time);
		this.txt1.text=data.type==0 ? data.atkLoseReoops+"" :data.defenseLoseTroops+"";
		this.name0.text=data.type==0 ? data.defenseName :data.atkName;
		this.tz0.skin=data.type==0 ? "comp/haoyou/Haoyou_tz.png" :"comp/haoyou/Haoyou_yz.png";
		this.img0.skin=data.result==0 ? "comp/haoyou/Haoyou_gxsl.png" :"comp/haoyou/Haoyou_yhgf.png";
		this.di.gray=data.isRead==1 ? true :false;
	}

	return TiaoZhanItem;
})(haoyoutiaozhan1UI)


//class huamao.panel.hero.HeroBoxMax extends ui.SLGGAME.wujiang_ka0UI
var HeroBoxMax=(function(_super){
	function HeroBoxMax(){
		this.heroImage=null;
		this.sysHero=null;
		this.heroData=null;
		this.heroType=0;
		HeroBoxMax.__super.call(this);
	}

	__class(HeroBoxMax,'huamao.panel.hero.HeroBoxMax',_super);
	var __proto=HeroBoxMax.prototype;
	/**
	*设置武将数据
	*@param data
	*@param type 1武将列表显示的武将 2 其他人的武将 3 商店里的武将 4 展示自己的武将只显示名字 等级 品质 国家 目前 和 2 查看其它人 一样
	*/
	__proto.setHeroData=function(data,type){
		(type===void 0)&& (type=1);
		this.heroType=type;
		this.setType(type);
		this.heroData=data;
		this.sysHero=data.sysHero;
		this.tiao.skin=GameUtils.getZiDi(data.sysHero.heroColor);
		this.kapinzhi.skin=GameUtils.getDi(this.sysHero.heroColor);
		this.name0.text=this.sysHero.heroName;
		this.img0.skin=GameUtils.getCountry(this.sysHero.heroCountry);
		this.setHeroImg(this.heroData.heroId);
		this.setLv(this.heroData.heroLv);
		this.bingli.text=""+data.soldierMax;
	}

	/**
	*更改武将形象
	*
	*/
	__proto.setHeroImg=function(id){
		if(!this.heroImage){
			this.heroImage=new Image();
			this.ka0.addChild(this.heroImage);
		}
		this.heroImage.skin=GameUtils.getHeroSkin(id);
		this.heroImage.size(this.ka0.width,this.ka0.height);
	}

	__proto.setType=function(type){
		this.off("click",this,this.clickHandler);
		if(type==1){
			this.on("click",this,this.clickHandler);
			this.bingli.visible=true;
		}
		else{
			this.bingli.visible=false;
		}
	}

	__proto.setLv=function(lv){
		this.dengji.text=lv+"";
	}

	__proto.clickHandler=function(){}
	return HeroBoxMax;
})(wujiang_ka0UI)


//class ui.SLGGAME.shangdian_2UI extends laya.ui.Dialog
var shangdian_2UI=(function(_super){
	function shangdian_2UI(){
		this.cha=null;
		this.ti=null;
		this.wenzi=null;
		shangdian_2UI.__super.call(this);
	}

	__class(shangdian_2UI,'ui.SLGGAME.shangdian_2UI',_super);
	var __proto=shangdian_2UI.prototype;
	__proto.createChildren=function(){
		View.regComponent("HTMLDivElement",HTMLDivElement);
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/shangdian_2");
	}

	return shangdian_2UI;
})(Dialog)


//class huamao.panel.huodong.huoyuedu.HuoyueItemView extends ui.SLGGAME.huodong_huoyue2UI
var HuoyueItemView=(function(_super){
	function HuoyueItemView(){
		HuoyueItemView.__super.call(this);
		App.injOne(this);
	}

	__class(HuoyueItemView,'huamao.panel.huodong.huoyuedu.HuoyueItemView',_super);
	var __proto=HuoyueItemView.prototype;
	__proto.upData=function(data){
		if(data.status!=1){
			this.bbo2.visible=false;
		};
		var task=data;
		this.zi1.text=task.systask.taskName;
		this.zizi1.text=task.systask.taskTargetDisplay.replace("{}",task.nowValue);
		var items=task.systask.taskReward.split(",");
		this.shuzi2.text=items[1];
		if(task.isOk==1){
			this.weida1.disabled=false;
			this.weida1.label="已达成";
			this.zhuan.visible=true;
			this.zhuan.play();
			}else if(task.isOk==0){
			this.weida1.disabled=true;
			this.weida1.label="未达成";
			this.zhuan.visible=false;
			this.zhuan.stop();
		}
		if(TaskData.isboxVisble==0){
			this.chou1.disabled=true;
		}
		this.weida1.clickHandler=new Handler(this,this.onBtnClick,[this.bbo2,data]);
		this.clo1.clickHandler=new Handler(this,this.deleteTask,[this.bbo2,data]);
		this.chou1.clickHandler=new Handler(this,this.chouTask,[this.bbo2,data]);
	}

	/**抽取任务*/
	__proto.chouTask=function(box,arr){
		box.visible=true;
		var task=arr;
		App.eventManager.event("HUOYUEGIFT",[3,task.taskId]);
	}

	/**删除任务*/
	__proto.deleteTask=function(box,arr){
		box.visible=false;
		var task=arr;
		App.eventManager.event("HUOYUEGIFT",[4,task.taskId]);
	}

	/**发送消息给后台*/
	__proto.onBtnClick=function(box,arr){
		box.visible=false;
		var task=arr;
		App.eventManager.event("HUOYUEGIFT",[5,task.taskId]);
	}

	return HuoyueItemView;
})(huodong_huoyue2UI)


//class huamao.panel.huodong.huoyuedu.HuoyueView extends ui.SLGGAME.huodong_huoyueUI
var HuoyueView=(function(_super){
	function HuoyueView(){
		this.barValue=0;
		this.huiyueGiftArray=[];
		this.strTip="";
		HuoyueView.__super.call(this);
		App.injOne(this);
		this.hyd.text="0";
		this.bar0.value=0;
		this.list0.itemRender=HuoyueItemView;
		this.list0.renderHandler=new Handler(this,this.listHandler);
		this.btn0.visible=false;
		this.btn0.clickHandler=new Handler(this,this.lastWar);
		this.list0.vScrollBarSkin="";
		this.tips0.clickHandler=new Handler(this,this.tipsFuc);
		this.getTips();
		App.eventManager.event("HUO_DONG_NOT_READ",[true]);
		this.on("undisplay",this,this.undisplayer);
		for (var i=0;i <3;i++){
			var itemImg=new Image();
			itemImg.size(42,42);
			var huoyueGift=new HuoyueGift(itemImg,this["gou"+(i+1)],this["s"+i],this["shu"+i],this["box"+i],this["te"+(i+1)]);
			this.huiyueGiftArray.push(huoyueGift);
			this.addChilds(this.huiyueGiftArray[i].box,itemImg);
		}
	}

	__class(HuoyueView,'huamao.panel.huodong.huoyuedu.HuoyueView',_super);
	var __proto=HuoyueView.prototype;
	__proto.listHandler=function(item,index){
		item.upData(this.list0.getItem(index));
	}

	__proto.undisplayer=function(){
		console.log("undisplayer--->")
	}

	__proto.update=function(actArr,arr,huoyuedu,giftArr){
		for (var i=0;i <this.huiyueGiftArray.length;i++){
			var huoyueGift=this.huiyueGiftArray[i];
			var items=actArr[i].activityReward.split(",");
			var itemsTarget=actArr[i].activityTarget.split(",");
			huoyueGift.setData(items[1],items[0],itemsTarget[1]);
			huoyueGift.imgPic.on("click",this,this.ImgClick,[actArr[i].activityId,itemsTarget[1]]);
			ActivityPicTips.nameTips(huoyueGift.imgPic,this,parseInt(items[0]));
			if(huoyuedu>=parseInt(this.huiyueGiftArray[i].shu.text)){
				huoyueGift.setIsOver(true);
			}
			if(giftArr[i]==1){
				huoyueGift.setIsOver(false);
			}
		}
		this.list0.array=arr;
		this.hyd.text=huoyuedu.toString();
		this.barValue=huoyuedu;
		this.bar0.value=huoyuedu/parseInt(this.shu2.text);
	}

	__proto.ImgClick=function(activityId,item){
		if(this.barValue>=parseInt(item)){
			var actID=parseInt(activityId);
			App.eventManager.event("HUOYUEGIFT",[6,actID]);
		}
	}

	__proto.tipsFuc=function(){
		FlyLittleUpTips.setTips(this.strTip);
	}

	__proto.getTips=function(){
		var sysArr=ConfigManager.getDataArr("sys_tips.txt");
		for (var j=0;j < sysArr.length;j++){
			if(sysArr[j].tipsId==3003){
				this.strTip=sysArr[j].tipsDescribe;
			}
		}
	}

	__proto.addChilds=function(box,img){
		box.addChild(img);
	}

	// public var mainPlayerSession:MainPlayerSession;
	__proto.lastWar=function(){
		var huodong_tips=App.dialogManager.showMiniDialog(huodong_tips_szzbUI);
	}

	return HuoyueView;
})(huodong_huoyueUI)


//class huamao.panel.huodong.jijin.JijinItem extends ui.SLGGAME.huodong_jijin_0UI
var JijinItem=(function(_super){
	function JijinItem(){
		this.activitySession=null;
		this.activityAction=null;
		this.currData=null;
		this.activityData=null;
		this.item=null;
		JijinItem.__super.call(this);
		this.init();
	}

	__class(JijinItem,'huamao.panel.huodong.jijin.JijinItem',_super);
	var __proto=JijinItem.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.btn0.on("click",this,this.sendLingQu);
		this.item=new Item();
		this.box0.addChild(this.item);
		this.item.size(this.box0.width,this.box0.height);
	}

	__proto.sendLingQu=function(){
		this.activityAction.sendLingQu(this.currData.activityId);
	}

	__proto.upData=function(data){
		this.currData=data;
		this.item.setItemId(this.currData.activityReward.split(",")[0]);
		ActivityPicTips.nameTips(this.item,this,this.currData.activityReward.split(",")[0]);
		this.shu0.text=this.currData.activityReward.split(",")[1];
		this.txt0.text=data.activityDescribe;
		this.activityData=this.activitySession.ativityObj[this.currData.activityId];
		if(this.activityData){
			if(this.activityData.rewardStatus==2){
				this.btn0.visible=false;
				this.lq.visible=true;
				this.zhuan.visible=false;
				this.zhuan.stop();
			}
			else{
				this.btn0.visible=true;
				this.lq.visible=false;
				if(this.activityData.rewardStatus==0){
					this.btn0.label="未达成";
					this.btn0.disabled=true;
					this.zhuan.visible=false;
					this.zhuan.stop();
				}
				else{
					this.btn0.label="领取奖励";
					this.btn0.disabled=false;
					this.zhuan.visible=true;
					this.zhuan.play();
				}
			}
		}
		else{
			this.btn0.visible=true;
			this.lq.visible=false;
			this.btn0.label="未达成";
			this.btn0.disabled=true;
		}
	}

	return JijinItem;
})(huodong_jijin_0UI)


//class huamao.panel.huodong.jijin.JiJinPanel extends ui.SLGGAME.huodong_jijinUI
var JiJinPanel=(function(_super){
	function JiJinPanel(){
		this.activitySession=null;
		JiJinPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(JiJinPanel,'huamao.panel.huodong.jijin.JiJinPanel',_super);
	var __proto=JiJinPanel.prototype;
	__proto.init=function(){
		this.list0.itemRender=JijinItem;
		this.list0.renderHandler=new Handler(this,this.listHandler);
		this.list0.vScrollBarSkin="";
		this.upData();
		var arr=this.activitySession.sysjijinData.activityTarget.split(",");
		this.yuanbao.text=arr[1]+"";
		this.txt0.text=this.activitySession.sysjijinData.activityDescribe;
	}

	__proto.listHandler=function(item,index){
		item.upData(this.activitySession.jijinDataArr[index]);
	}

	__proto.upData=function(){
		this.ygm.visible=false;
		this.chaozhi.visible=true;
		this.chaozhi.label="立即购买";
		this.list0.array=this.activitySession.jijinDataArr;
		var activityData=this.activitySession.ativityObj[this.activitySession.sysjijinData.activityId];
		if(!activityData)return;
		this.time0.text=GameUtils.timeFormat(activityData.endTime,4);
		var arr=activityData.tarGetStatus.split(",");
		for(var i=0;i<arr.length;i+=3){
			if(arr[i]==106 && arr[i+1]==arr[i+2]){
				this.chaozhi.label="已购买";
				this.ygm.visible=true;
				this.chaozhi.visible=false;
				this.guang.visible=false;
				this.guang.stop();
				break ;
			}
		}
	}

	return JiJinPanel;
})(huodong_jijinUI)


//class huamao.panel.huodong.kaBao.KaBaoItem extends ui.SLGGAME.huodong_kabao_1UI
var KaBaoItem=(function(_super){
	function KaBaoItem(){
		this.actData=null;
		this.activitySession=null;
		this.mainPlayerSession=null;
		this.wuJiangSession=null;
		this.itemArr=[];
		this.imgArr=[];
		this.numLength=6;
		this.haveArr=[];
		this.posIdArr=[];
		this.sys2=null;
		this.heroIdArr=[];
		this.jumpArr=[];
		this.numRewLen=0;
		KaBaoItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(KaBaoItem,'huamao.panel.huodong.kaBao.KaBaoItem',_super);
	var __proto=KaBaoItem.prototype;
	__proto.init=function(){
		for (var i=0;i < this.numLength;i++){
			var item=new Item();
			item.isViewTips(true);
			item.size(70,70);
			item.pos(4,4);
			var img=new Image();
			img.skin="comp/huodong/yiyongyou.png";
			this["b"+(i+1)].addChild(item);
			item.addChild(img);
			img.visible=false;
			this.itemArr.push(item);
			this.imgArr.push(img);
		}
		this.btn0.on("click",this,this.sendBuy);
	}

	__proto.findHaveId=function(){
		for (var i=0;i < this.wuJiangSession.heroArr.length;i++){
			for (var j=0;j < this.heroIdArr.length;j++){
				if((this.wuJiangSession.heroArr [i]).heroId==this.heroIdArr[j]){
					this.haveArr.push(this.heroIdArr[j]);
				}
			}
		}
	}

	__proto.findIdPos=function(sys){
		var numRew=sys.activityReward.split(",");
		for (var i=0;i < numRew.length;i++){
			for (var j=0;j < this.haveArr.length;j++){
				if(numRew[i]==this.haveArr[j]){
					this.imgArr[(i-1)/2].visible=true;
				}
			}
		}
	}

	__proto.sellMoney=function(str){
		var num=0;
		for (var i=0;i < this.numRewLen;i++){
			if(this.imgArr[i].visible){
				num++;
			}
		}
		if(this.numRewLen==num){
			this.btn0.disabled=true;
		}
		return ""+(parseInt(str)/this.numRewLen)*(this.numRewLen-num);
	}

	__proto.sendBuy=function(){
		this.sendMessage(this.actData.activityId);
	}

	__proto.sendMessage=function(itemId){
		App.eventManager.event("KABAOBUYGIFT",[itemId]);
		this.isjumpItem(itemId);
	}

	__proto.isjumpItem=function(itemId){
		var sys=ConfigManager.getConfig("sys_activity.txt",itemId);
		var data=this.mainPlayerSession.mainPlayerData;
		if(data.gold>=sys.activityTarget.split(",")[1]){
			this.jumpItemCreate(sys);
		}
	}

	__proto.upData=function(data){
		var sys=ActivityData.getSys(data.activityId);
		this.sys2=sys;
		this.lan.text=sys.activityDescribe;
		this.getitem(sys,data);
		this.findHaveId();
		var moneyNum=0;
		this.findIdPos(sys);
		this.shuzi.text=this.sellMoney(sys.activityTarget.split(",")[1]);
	}

	__proto.jumpItemCreate=function(sys){
		this.jumpArr.length=0;
		var numRew=sys.activityReward.split(",");
		for (var i=0;i < numRew.length/2;i++){
			var heroId=numRew[i*2+1];
			var item=new Item();
			item.setItemId(heroId,false);
			item.isViewTips(true);
			item.size(70,70);
			item.pos(4,4);
			item.setNum(1);
			this["b"+(i+1)].addChild(item);
			this.jumpArr.push(item);
		}
		for (var j=0;j < this.jumpArr.length;j++){
			if(!this.imgArr[j].visible){
				GameUtils.setFlyToItem([this.jumpArr[j]],15,2000,false);
			}
		}
	}

	__proto.getTips=function(numId){
		var sys=ConfigManager.getConfig("sys_activity.txt",numId);
		return sys;
	}

	__proto.getitem=function(sys,data){
		var numRew=sys.activityReward.split(",");
		for (var i=0;i < numRew.length/2;i++){
			this.numRewLen=numRew.length/2;
			var heroId=numRew[i*2+1];
			this.itemArr[i].setItemId(heroId,false);
			this.itemArr[i].setNum(1);
			this.heroIdArr.push(heroId);
		}
		this.actData=this.activitySession.ativityObj[data.activityId];
		if(this.actData.rewardStatus==0){
			this.yigou.visible=false;
			}else{
			this.yigou.visible=true;
			this.btn0.visible=this.yuanyuan.visible=this.shuzi.visible=false;
		}
		for (var j=0;j < 6-numRew.length/2;j++){
			this["b"+(numRew.length/2+1+j)].visible=false;
		}
	}

	return KaBaoItem;
})(huodong_kabao_1UI)


//class huamao.panel.huodong.kaBao.KaBaoPanel extends ui.SLGGAME.huodong_kabaoUI
var KaBaoPanel=(function(_super){
	function KaBaoPanel(){
		KaBaoPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(KaBaoPanel,'huamao.panel.huodong.kaBao.KaBaoPanel',_super);
	var __proto=KaBaoPanel.prototype;
	__proto.init=function(){
		this.list0.itemRender=KaBaoItem;
		this.list0.renderHandler=new Handler(this,this.listHandler);
		this.list0.vScrollBarSkin="";
		this.shijian.text="活动时间:"+KaBaoData.getHuoDongTime(9);
	}

	__proto.listHandler=function(item,index){
		item.upData(this.list0.getItem(index));
	}

	__proto.onUpdate=function(arr){
		this.list0.array=arr;
	}

	return KaBaoPanel;
})(huodong_kabaoUI)


//class huamao.panel.huodong.leiji.LeijiItem extends ui.SLGGAME.huodong_leiji_0UI
var LeijiItem=(function(_super){
	function LeijiItem(){
		this.activitySession=null;
		this.activityAction=null;
		this.currData=null;
		this.activityData=null;
		this.item=null;
		this.num=6;
		this.itemArr=[];
		LeijiItem.__super.call(this);
		this.init();
	}

	__class(LeijiItem,'huamao.panel.huodong.leiji.LeijiItem',_super);
	var __proto=LeijiItem.prototype;
	__proto.init=function(){
		App.injOne(this);
		for(var i=0;i<this.num;i++){
			var item=new Item();
			this["di"+(i+1)].addChild(item);
			item.x=item.y=2;
			item.size(60,60);
			item.isViewTips(true);
			this.itemArr.push(item);
		}
		console.log("itemArr.legnth-->"+this.itemArr.legnth);
		this.btn0.on("click",this,this.sendLingQu);
	}

	__proto.sendLingQu=function(){
		if(this.activityData.rewardStatus==0){
			App.dialogManager.openDialogByStr("RECHARGEPANEL",null,true,true);
		}
		else{
			this.activityAction.sendLingQu(this.currData.activityId);
		}
	}

	__proto.clearItem=function(){
		for(var i=0;i<this.num;i++){
			this["di"+(i+1)].visible=false;
		}
	}

	__proto.upData=function(data){
		this.clearItem();
		this.currData=data;
		this.qian.text=this.currData.activityTarget.split(",")[1];
		var rArr=this.currData.activityReward.split(",");
		var index=0;
		var i=0;
		for(i=0;i<rArr.length;i+=2){
			this["di"+(index+1)].visible=true;
			this.itemArr[index].setItemId(rArr[i]);
			this.itemArr[index].setNum(rArr[i+1]);
			index++;
		}
		this.activityData=this.activitySession.ativityObj[this.currData.activityId];
		if(this.activityData){
			var arr=this.activityData.tarGetStatus.split(",");
			this.shu0.text=arr[2]+"/"+arr[1];
			if(this.activityData.rewardStatus==2){
				this.btn0.visible=false;
				this.lq.visible=true;
				this.shu0.visible=false;
				this.zhuan.visible=false;
				this.zhuan.stop();
			}
			else{
				this.btn0.visible=true;
				this.lq.visible=false;
				this.shu0.visible=true;
				if(this.activityData.rewardStatus==0){
					this.btn0.label="充值";
					this.zhuan.visible=false;
					this.zhuan.stop();
				}
				else{
					this.btn0.label="领取奖励";
					this.zhuan.visible=true;
					this.zhuan.play();
				}
			}
		}
		else{
			arr=this.currData.activityTarget.split(",");
			this.shu0.text=0+"/"+arr[1];
			this.shu0.visible=true;
			this.btn0.visible=true;
			this.lq.visible=false;
			this.btn0.label="充值";
			this.btn0.disabled=true;
		}
	}

	return LeijiItem;
})(huodong_leiji_0UI)


//class huamao.panel.huodong.leiji.LeijiPanel extends ui.SLGGAME.huodong_leijiUI
var LeijiPanel=(function(_super){
	function LeijiPanel(){
		this.activitySession=null;
		this.activityData=null;
		LeijiPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(LeijiPanel,'huamao.panel.huodong.leiji.LeijiPanel',_super);
	var __proto=LeijiPanel.prototype;
	__proto.init=function(){
		this.list0.selectEnable=true;
		this.list0.itemRender=LeijiItem;
		this.list0.renderHandler=new Handler(this,this.listHandler);
		this.list0.vScrollBarSkin="";
		this.upData();
	}

	__proto.listHandler=function(item,index){
		item.upData(this.activitySession.leijiDataArr[index]);
	}

	__proto.upData=function(){
		this.list0.array=this.activitySession.leijiDataArr;
		this.activityData=this.activitySession.ativityObj[this.activitySession.sysLeijiData.activityId];
		if(this.activityData){
			this.txt0.text="活动剩余时间:"+GameUtils.timeFormat(this.activityData.endTime,4);
			var arr=this.activityData.tarGetStatus.split(",");
			this.shu0.text=arr[2];
		}
		else{
			this.shu0.text=0+"";
		}
	}

	return LeijiPanel;
})(huodong_leijiUI)


//class huamao.panel.huodong.leijiNew.LeijiNewPanel extends ui.SLGGAME.huodong_leijiUI
var LeijiNewPanel=(function(_super){
	function LeijiNewPanel(){
		this.activitySession=null;
		this.activityData=null;
		LeijiNewPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(LeijiNewPanel,'huamao.panel.huodong.leijiNew.LeijiNewPanel',_super);
	var __proto=LeijiNewPanel.prototype;
	__proto.init=function(){
		this.list0.selectEnable=true;
		this.list0.itemRender=LeijiItem;
		this.list0.renderHandler=new Handler(this,this.listHandler);
		this.list0.vScrollBarSkin="";
		this.upData();
	}

	__proto.listHandler=function(item,index){
		console.log("1111--------->");
		item.upData(this.activitySession.leijiNewDataArr[index]);
		console.log("activitySession.leijiNewDataArr[index].activityId--->"+this.activitySession.leijiNewDataArr[index].activityId)
	}

	__proto.upData=function(){
		this.list0.array=this.activitySession.leijiNewDataArr;
		this.activityData=this.activitySession.ativityObj[this.activitySession.sysLeijiNewData.activityId];
		if(this.activityData){
			this.txt0.text="活动剩余时间:"+GameUtils.timeFormat(this.activityData.endTime,4);
			var arr=this.activityData.tarGetStatus.split(",");
			this.shu0.text=arr[2];
		}
		else{
			this.shu0.text=0+"";
		}
	}

	return LeijiNewPanel;
})(huodong_leijiUI)


//class huamao.panel.huodong.qiandao.QiandaoItem extends ui.SLGGAME.huodong_qiandao_0UI
var QiandaoItem=(function(_super){
	function QiandaoItem(){
		this.signInSession=null;
		this.signInAction=null;
		this._sys=null;
		this._index=0;
		this._item=new Item();
		QiandaoItem.__super.call(this);
		App.injOne(this);
		this._item.size(75,75);
		this.box_0.addChild(this._item);
		this.qian.visible=false;
		this.clip0.visible=false;
		this.clip0.stop();
		this.on("click",this,this.onClick);
	}

	__class(QiandaoItem,'huamao.panel.huodong.qiandao.QiandaoItem',_super);
	var __proto=QiandaoItem.prototype;
	__proto.onClick=function(){
		if(this.signInSession.curMonthDays < this._index){
			return;
		}
		if(this.signInSession.isSignin(this._index)){
			return;
		}
		this.signInAction.onSignIn(this._index);
	}

	__proto.update=function(sys){
		this._sys=sys;
		this._index=this._sys.subNumber-1;
		var items=sys.activityReward.split(",");
		this._item.isViewTips(true);
		if(items[0]==0){
			this._item.setItemId(parseInt(items[1]),false);
			this._item.setNum(1);
			}else{
			this._item.setItemId(parseInt(items[0]));
			this._item.setNum(items[1]);
		}
		this.qian.visible=false;this.signInSession.isSignin(this._index);
		this.clip0.visible=false;
		this.clip0.stop();
		if(this._index <=this.signInSession.curMonthDays){
			if(this.signInSession.isSignin(this._index)==false){
				this.clip0.visible=true;
				this.clip0.play();
			}
			else{
				this.qian.visible=this.signInSession.isSignin(this._index);
			}
		}
	}

	return QiandaoItem;
})(huodong_qiandao_0UI)


//class huamao.panel.huodong.qiandao.QiandaoView extends ui.SLGGAME.huodong_qiandaoUI
var QiandaoView=(function(_super){
	function QiandaoView(){
		this.list0=null;
		this.signInSession=null;
		QiandaoView.__super.call(this);
		App.injOne(this);
		this.list0=new List();
		this.list0.itemRender=QiandaoItem;
		this.list0.repeatX=5;
		this.list0.repeatY=3;
		this.list0.spaceX=5;
		this.list0.spaceY=20;
		this.list0.vScrollBarSkin="";
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.addChild(this.list0);
		this.list0.size(694,450);
		this.list0.pos(3,64);
		this.onUpdate();
	}

	__class(QiandaoView,'huamao.panel.huodong.qiandao.QiandaoView',_super);
	var __proto=QiandaoView.prototype;
	__proto.onUpdate=function(){
		this.txt0.text="已累计登陆"+this.signInSession.totalDays+"天";
		var arr=SysActivity.getSigninData(this.signInSession.curMonth==1 ? 0 :999);
		this.list0.array=arr;
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	return QiandaoView;
})(huodong_qiandaoUI)


//class huamao.panel.huodong.sevenrenwu.SevenrenwuView extends ui.SLGGAME.huodong_7renwuUI
var SevenrenwuView=(function(_super){
	function SevenrenwuView(){
		this.desText="";
		this.sysArr=null;
		this.strTip="";
		SevenrenwuView.__super.call(this);
		App.injOne(this);
		this.list0.vScrollBarSkin='';
		this.list0.spaceY=3;
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.sysArr=ConfigManager.getDataArr("sys_activity.txt");
		this.tips0.clickHandler=new Handler(this,this.tipsFuc);
		this.getTips();
	}

	__class(SevenrenwuView,'huamao.panel.huodong.sevenrenwu.SevenrenwuView',_super);
	var __proto=SevenrenwuView.prototype;
	__proto.setData=function(arr){
		this.list0.array=arr;
	}

	__proto.updateItem=function(cell,index){
		var day0=cell.getChildByName("day0");
		day0.text="第"+(index+1)+"天";
		var clip=cell.getChildByName("zhuan");
		var seven=this.list0.getItem(index);
		this.onSevenData(seven,cell,index);
		var items=this.sysArr[index].activityReward.split(",");
		var shu1=cell.getChildByName("shu1");
		shu1.text=items[1];
		var box1=cell.getChildByName("box1");
		box1.skin=GameUtils.getItemIconPath(parseInt(items[0]));
		ActivityPicTips.nameTips(box1,this,parseInt(items[0]));
		var btn0=cell.getChildByName("btn0");
		btn0.disabled=seven.btnDis;
		var ylq=cell.getChildByName("ylq");
		ylq.visible=seven.isGetGift();
		btn0.visible=(seven.isLing==0 ? true :false);
		btn0.label=(seven.btnDis ? "未达成" :"已达成");
		this.isPlayClip(clip,seven);
		btn0.clickHandler=new Handler(this,this.getGift,[btn0,ylq,clip,seven.activityId]);
	}

	__proto.isPlayClip=function(clip,seven){
		if(seven.isLing!=0&&!seven.btnDis){
			clip.visible=false;
			clip.stop();
			}else if(seven.isLing==0&&!seven.btnDis){
			clip.visible=true;
			clip.play();
			}else{
			clip.visible=false;
			clip.stop();
		}
	}

	__proto.onSevenData=function(seven,cell,index){
		var txt0=cell.getChildByName("txt0");
		this.desText=this.sysArr[index].activityDescribe;
		txt0.text=this.desText.replace("/n","\n");
		var item=seven.programArr;
		if(item[3]!=null){
			txt0.text=txt0.text.replace("{}",item[2]);
			txt0.text=txt0.text.replace("{}",item[3]);
			console.log("item[2]:"+item[2]+"item[3]:"+item[3]);
		}
		else{
			txt0.text=txt0.text.replace("{}",item[2]);
		}
		seven.isGetPrograss(index);
		var btn0=cell.getChildByName("btn0");
		btn0.disabled=seven.getActDay(index);
		var img=cell.getChildByName("war");
		img.gray=seven.getActDay(index);
	}

	//cell.gray=seven.getActDay(index);
	__proto.getGift=function(btn0,ylq,clip,actionId){
		btn0.visible=false;
		ylq.visible=true;
		clip.visible=false;
		clip.stop();
		App.eventManager.event("SEVENRENWU_DATA",actionId);
	}

	__proto.tipsFuc=function(){
		FlyLittleUpTips.setTips(this.strTip);
	}

	//FlyUpTips.setHtml(str3);
	__proto.getTips=function(){
		var sysArr=ConfigManager.getDataArr("sys_tips.txt");
		for (var j=0;j < sysArr.length;j++){
			if(sysArr[j].tipsId==3004){
				this.strTip=sysArr[j].tipsDescribe;
			}
		}
	}

	return SevenrenwuView;
})(huodong_7renwuUI)


//class huamao.panel.union.UnionMenu extends ui.SLGGAME.tips_hyUI
var UnionMenu=(function(_super){
	function UnionMenu(){
		this._content=null;
		this.btnW=60;
		UnionMenu.__super.call(this);
		this.init();
	}

	__class(UnionMenu,'huamao.panel.union.UnionMenu',_super);
	var __proto=UnionMenu.prototype;
	__proto.init=function(){
		UnionMenu.obj[UnionMenu.RenMing]="任命";
		UnionMenu.obj[UnionMenu.CheZhi]="撤职";
		UnionMenu.obj[UnionMenu.RangWei]="让位";
		UnionMenu.obj[UnionMenu.ZhuChu]="逐出联盟";
		UnionMenu.obj[UnionMenu.JiaHaoYou]="加为好友";
		UnionMenu.obj[UnionMenu.XiangQing]="详情";
		this._content=new Sprite();
		this._content.autoSize=true;
		this.addChild(this._content);
	}

	__proto.setData=function(arr,data){
		this._content.removeChildren();
		var size=arr.length;
		for(var i=0;i < size;i++){
			var item=new UnionMenuItem();
			var type=arr[i];
			item.update(UnionMenu.obj[type],new Handler(this,this.clickMenu,[type,data]));
			this._content.addChild(item);
			item.pos(7,4+i *this.btnW);
		}
		this.di.size(152,size *this.btnW+5);
		this.size(152,size *this.btnW+5);
		this.addPos();
	}

	__proto.addPos=function(){
		this.clickClose();
		Laya.stage.addChild(this);
		this.x=Laya.stage.mouseX;
		this.y=Laya.stage.mouseY;
		var ww=(this.x+this.width);
		var hh=(this.y+this.height);
		if(ww>Laya.stage.width){
			this.x=Laya.stage.width-this.width;
		}
		if(hh>Laya.stage.height){
			this.y=Laya.stage.height-this.height;
		}
		if(this.x<0){
			this.x=0;
		}
		if(this.y<0){
			this.y=this.height;
		}
		Laya.timer.callLater(this,this.laterFun);
	}

	__proto.laterFun=function(){
		Laya.stage.on("click",this,this.clickClose);
	}

	__proto.clickMenu=function(type,obj){
		this.event("MENUCLICK",{type:type,data:obj});
		this.clickClose();
	}

	__proto.clickClose=function(){
		Laya.stage.offAll("click");
		this.removeSelf();
	}

	UnionMenu.RenMing=1;
	UnionMenu.CheZhi=2;
	UnionMenu.RangWei=3;
	UnionMenu.ZhuChu=4;
	UnionMenu.JiaHaoYou=5;
	UnionMenu.XiangQing=6;
	__static(UnionMenu,
	['obj',function(){return this.obj=new Object();}
	]);
	return UnionMenu;
})(tips_hyUI)


//class huamao.panel.union.UnionMenuItem extends ui.SLGGAME.tips_hy0UI
var UnionMenuItem=(function(_super){
	function UnionMenuItem(){
		UnionMenuItem.__super.call(this);
	}

	__class(UnionMenuItem,'huamao.panel.union.UnionMenuItem',_super);
	var __proto=UnionMenuItem.prototype;
	__proto.update=function(value,clickHandler){
		this.btn0.label=value;
		this.btn0.clickHandler=clickHandler;
	}

	return UnionMenuItem;
})(tips_hy0UI)


//class huamao.panel.wujiangxinxi.LegionSmallBox extends ui.SLGGAME.chuzhengkaUI
var LegionSmallBox=(function(_super){
	function LegionSmallBox(){
		this.data=null;
		this.img=null;
		this.wuJiangSession=null;
		this.wuJiangAction=null;
		LegionSmallBox.__super.call(this);
		this.init();
	}

	__class(LegionSmallBox,'huamao.panel.wujiangxinxi.LegionSmallBox',_super);
	var __proto=LegionSmallBox.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.xue.visible=false;
		this.hun.visible=false;
		this.img=new HeroImage();
		this.img.setScaleSize(this.box.width,0);
		this.box.addChild(this.img);
		this.box.scrollRect=new Rectangle(0,0,this.box.width,this.box.height);
		this.yuancha.on("click",this,this.deleteHero);
		this.yiyongyou.visible=false;
	}

	__proto.setVisiShanchu=function(currData){
		this.yuancha.visible=false;
		if(this.wuJiangSession.getHero(this.data.heroId)){
			this.yiyongyou.visible=false;
			this.gray=false;
			if(this.data.masterId>0){
				var hd=this.wuJiangSession.getHero(currData.heroId);
				if(hd.legion.indexOf(this.data.heroId+"")!=-1){
					this.yiyongyou.visible=true;
					this.yiyongyou.skin="comp/G/tj_yxz.png";
					this.box_jt.visible=false;
				}
			}
		}
		else{
			this.yiyongyou.skin="comp/G/tj_wyy.png";
			this.yiyongyou.visible=true;
			this.gray=true;
		}
	}

	__proto.deleteHero=function(){
		this.wuJiangAction.sendDeleLegion(this.data.masterId,this.data.heroId);
	}

	__proto.setHeroData=function(data){
		this.data=data;
		this.img.setHeroId(data.heroId);
		for(var i=1;i <=5;i++){
			this["xing"+i].visible=i <=data.heroStar;
		}
		this.tiao.skin=GameUtils.getZiDi(data.sysHero.heroColor);
		this.xing.visible=data.heroStar > 0;
		this.name0.text=data.sysHero.heroName;
		this.dengji.text=data.heroLv+"";
		this.di.skin=GameUtils.getDi(data.sysHero.heroColor);
		this.kaung.skin=GameUtils.getKuang(data.sysHero.heroColor);
		this.guojia.skin=GameUtils.getCountry(data.sysHero.heroCountry);
		if(data.legion !="" || data.masterId !=0){
			this.box_jt.visible=true;
			var hero;
			if(data.legion!=""){
				hero=data;
			}
			else{
				hero=this.wuJiangSession.getHero(data.masterId);
			}
			this.txt1.text="<"+hero.sysHero.heroName+"军团>";
		}
		else{
			this.box_jt.visible=false;
		}
	}

	__proto.tuijian=function(){
		var hd=this.wuJiangSession.getHero(this.data.masterId);
		if(hd.sysHero.viceHero.indexOf(this.data.heroId+"")!=-1){
			this.yiyongyou.visible=true;
			this.yiyongyou.skin="comp/G/tj_tjfjpng.png";
		}
		else{
			this.yiyongyou.visible=false;
		}
	}

	return LegionSmallBox;
})(chuzhengkaUI)


//class huamao.panel.worldMap.PlayerItem extends ui.SLGGAME.map0UI
var PlayerItem=(function(_super){
	function PlayerItem(){
		this.data=null;
		this.playerId=0;
		this.mengyou=null;
		PlayerItem.__super.call(this);
		this.isSelect=false;
		this.mengyou=new MengyouBorder();
	}

	__class(PlayerItem,'huamao.panel.worldMap.PlayerItem',_super);
	var __proto=PlayerItem.prototype;
	__proto.update=function(playerData){
		this.data=playerData;
		this.playerId=playerData.playerId;
		this.name0.text=playerData.playerName;
		this.box0.graphics.drawRect(0,0,20,20,"#"+playerData.cityFlag);
		if(this.data.hasBorder){
			console.log(playerData.playerName);
			this.mengyou.pos(this.x,this.y-3);
			this.parent.addChild(this.mengyou);
		}
		else{
			this.mengyou.removeSelf();
		}
	}

	__getset(0,__proto,'isSelect',null,function(value){
		this.xuan.visible=value;
	});

	return PlayerItem;
})(map0UI)


//class huamao.panel.talk.TalkPanel extends ui.SLGGAME.liaotianUI
var TalkPanel=(function(_super){
	function TalkPanel(){
		this.tabBind=null;
		this.contentSp=null;
		this.mainPlayerSession=null;
		this.unionSession=null;
		this.mapCitySession=null;
		this.talkAction=null;
		this.channelAry=[];
		this.autoevent=null;
		this.sendCD=true;
		this.sendTime=2*1000;
		TalkPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TalkPanel,'huamao.panel.talk.TalkPanel',_super);
	var __proto=TalkPanel.prototype;
	__proto.init=function(){
		this.autoevent=new AutoEvent(this);
		this.autoevent.add("WAIJIAO_FLUSH",this,this.flushTabCB);
		this.autoevent.add("UNIONUPDATA",this,this.flushTabCB);
		this.fasong.on("click",this,this.sendCB);
		this.txt0.text="";
		this.txt0.align="left";
		this.txt0.height=30;
		this.txt0.y=this.txt0.y-5;
		this.contentSp=new Sprite;
		this.addChild(this.contentSp);
		this.contentSp.pos(127,21);
		this.tab0.on("change",this,this.tabChangeCB);
		this.flushTabCB();
		Laya.timer.callLater(this,this.tabChangeCB);
		this.shezhi.on("click",this,this.setCB);
		this.width=554;
		this.di.width=554;
		this.di.on("click",this,this.closeCB);
		this.img0.mouseEnabled=true;
		this.img0.mouseThrough=false;
		this.hide();
	}

	__proto.removeEvent=function(){}
	__proto.flushTabCB=function(){
		var count=0;
		console.log("talk flushtabcb ---->");
		this.tabBind=null;
		this.channelAry=[];
		this.tab0.labels="系统,世界,当前";
		this.tabBind=new TabBind(this.tab0,this.contentSp,1);
		this.channelAry[count]=0;
		this.tabBind.addTabCell(count++,SystemT,TSystemMediator);
		this.channelAry[count]=2;
		this.tabBind.addTabCell(count++,WordT,TWordMediator);
		this.channelAry[count]=1;
		this.tabBind.addTabCell(count++,CurrentT,TCurrentMediator);
		var myplayerid=this.mainPlayerSession.mainPlayerData.playerId;
		var mengyouid=this.mapCitySession.getCityPlayer(myplayerid).mengyouId;
		if(mengyouid > 0){
			this.tab0.labels=this.tab0.labels+",队伍";
			this.channelAry[count]=4;
			this.tabBind.addTabCell(count++,TeamT,TTeamMediator);
		}
		if(this.unionSession.isUnion()){
			this.tab0.labels=this.tab0.labels+",联盟";
			this.channelAry[count]=5;
			this.tabBind.addTabCell(count++,ColeageT,TColeageMediator);
		}
	}

	__proto.setCB=function(){
		App.dialogManager.showMiniDialog(TipsTalkSet,true,true);
	}

	__proto.tabChangeCB=function(){
		console.log("tabChangeCB  1 = "+this.tab0.selectedIndex);
		if(this.tab0.selectedIndex==-1)return;
		var channelId=this.channelAry[this.tab0.selectedIndex];
		if((this.tabBind.getTabCell(this.tab0.selectedIndex))!=null){
			console.log("tabChangeCB  2 = "+this.tab0.selectedIndex);
			(this.tabBind.getTabCell(this.tab0.selectedIndex)).clearAllContent();
			(this.tabBind.getTabCell(this.tab0.selectedIndex)).resetAllContent();
		}
		if(channelId==0){
			this.txt0.disabled=true;
			this.txt0.prompt="该频道不可发言";
			this.fasong.disabled=true;
			}else{
			this.txt0.disabled=false;
			this.fasong.disabled=false;
			this.txt0.prompt="请输入聊天内容";
		}
	}

	__proto.closeCB=function(){
		Tween.to(this,{x:-554},500,null,Handler.create(this,this.closeComplete));
		this.width=554;
		this.di.width=504;
	}

	__proto.closeComplete=function(){
		this.visible=false;
		MainUIControl.closeTalkPanel();
	}

	__proto.hide=function(){
		this.x=-554;
	}

	__proto.checkGui=function(content){
		if(GuideMain.stopGuide || !this.mainPlayerSession.checkIfInGuide())return false;
		var array=content.split(",");
		if(array[0]=="guide"){
			var step=parseInt(array[1]);
			GuideMain.getMe().setGuideToDo(step);
			this.closeCB();
			return true;
		}
		return false;
	}

	//5秒
	__proto.timeCB=function(){
		this.sendCD=true;
	}

	__proto.sendCB=function(){
		var content=this.txt0.text;
		var charlen=GameUtils.getStringCharLen(content);
		if(charlen > 160){
			FlyUpTips.setTips("您的发言太长，请不要超过80字");
			return;
		}
		if(charlen <=0){
			FlyUpTips.setTips("请输入发言内容");
			return;
		}
		if(!this.sendCD){
			var sysTips=ConfigManager.getConfig("sys_tips.txt",41);
			FlyUpTips.setTips(sysTips.tipsDescribe);
			return;
		};
		var mainPlayerData=this.mainPlayerSession.mainPlayerData;
		var data=new OtherTalkData();
		data.channelId=this.channelAry[this.tab0.selectedIndex];
		data.paoBg=0;
		data.playerid=0;
		data.playerset=0;
		data.playerName="";
		data.playerJob=0;
		data.playerCountry=0;
		data.playerCollege=0;
		data.battleId="";
		data.content=content;
		data.time=0;
		console.log("send talk = "+content);
		this.talkAction.sendOtherTalkData(data);
		this.txt0.text="";
		this.sendCD=false;
		Laya.timer.once(this.sendTime,this,this.timeCB);
	}

	TalkPanel.getMe=function(){
		if(TalkPanel.me==null){
			TalkPanel.me=new TalkPanel();
		}
		return TalkPanel.me;
	}

	TalkPanel.me=null;
	TalkPanel.PANEL_W=400;
	TalkPanel.PANEL_H=615;
	return TalkPanel;
})(liaotianUI)


//class huamao.panel.task.RewardItem extends ui.SLGGAME.renwu_0UI
var RewardItem=(function(_super){
	function RewardItem(){
		this.item=null;
		this.itemId=0;
		// tip.lab0.text=sysItem.itemDescription;
		this.labelNum=null;
		RewardItem.__super.call(this);
		this.img0.visible=false;
	}

	__class(RewardItem,'huamao.panel.task.RewardItem',_super);
	var __proto=RewardItem.prototype;
	__proto.setItemId=function(itemid,boo){
		(boo===void 0)&& (boo=true);
		this.itemId=itemid;
		if(this.item==null){
			this.item=new Item();
			this.item.x=this.img0.x+2;
			this.item.y=this.img0.y+2;
			this.item.width=this.img0.width-4;
			this.item.height=this.img0.height-4;
			this.addChild(this.item);
		}
		this.item.setItemId(itemid,boo);
		ActivityPicTips.nameTips(this.item,this,itemid);
		var sysItem=ConfigManager.getConfig("sys_item.txt",itemid);
	}

	__proto.setNum=function(num){
		if(this.labelNum==null){
			this.labelNum=new Label();
			this.labelNum.bold=true;
			this.labelNum.fontSize=16;
			this.labelNum.color="#ffffff";
			this.addChild(this.labelNum);
		}
		if(num > 0){
			this.labelNum.text="×"+num;
			}else {
			this.labelNum.text="";
		}
		console.log(" labelNum.text = " ,this.labelNum.text);
		console.log("height = " ,this.height ,this.labelNum.height);
		console.log("width = " ,this.width ,this.labelNum.width);
		this.labelNum.y=this.height-this.labelNum.height-5;
		this.labelNum.x=this.width-this.labelNum.width-5;
	}

	return RewardItem;
})(renwu_0UI)


//class huamao.panel.union.NewUnionView extends ui.SLGGAME.lianmeng_lb_12UI
var NewUnionView=(function(_super){
	function NewUnionView(){
		this.unionAction=null;
		this.unionSession=null;
		this.mc=null;
		this.autoEvent=null;
		this.input=null;
		this.mainPlayerSession=null;
		this.sensitiveSession=null;
		this.sys=null;
		this.gold=0;
		NewUnionView.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(NewUnionView,'huamao.panel.union.NewUnionView',_super);
	var __proto=NewUnionView.prototype;
	__proto.init=function(){
		this.sys=ConfigManager.getConfig("sys_society_basic.txt" ,1);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("SELEQIZHI",this,this.upDataQizhi);
		this.autoEvent.add("FLUSH_PLAYER_GOLD",this,this.upDataYuanBao);
		this.autoEvent.addEventNow();
		this.mc=new ClipMc();
		this.mc.autoPlay=true;
		this.mc.scale(1.5,1.5);
		this.mc.pos(836,190);
		this.addChild(this.mc);
		this.input=new Input();
		this.input.multiline=true;
		this.input.wordWrap=true;
		this.input.promptColor="#95acc1";
		this.input.color="#95acc1";
		this.input.size(617,351);
		this.input.pos(33,144);
		this.input.maxChars=60;
		this.input.fontSize=24;
		this.input.prompt="联盟公告最长60个字";
		this.addChild(this.input);
		this.upDataYuanBao();
		this.chuangjian.on("click",this,this.newUnion);
		this.xuanqi.on("click",this,this.openXuanQi);
		this.upDataQizhi();
		this.on("display",this,this.addFun);
	}

	__proto.upDataYuanBao=function(){
		this.gold=this.mainPlayerSession.mainPlayerData.gold;
		this.jin.text=this.gold+"/"+this.sys.buildCost;
	}

	__proto.addFun=function(){
		this.upDataQizhi();
	}

	__proto.upDataQizhi=function(){
		this.mc.setClipName("clip"+this.unionSession.seleQizhi+"_4_4");
	}

	__proto.openXuanQi=function(){
		App.dialogManager.showMiniDialog(UnionQiZhi,true,true,false,false);
	}

	/**创建联盟*/
	__proto.newUnion=function(){
		var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true,false,false);
		alert.setAll(null,"是否花费"+this.sys.buildCost+"元宝，创建联盟",new Handler(this,this.chuangjianFun));
	}

	__proto.chuangjianFun=function(){
		if(this.gold<this.sys.buildCost){
			GameUtils.openBuZu(this.sys.buildCost);
			return;
		}
		if(this.mingcheng.text==""){
			GameUtils.setError(1023);
			return;
		};
		var namelen=GameUtils.getStringCharLen(this.mingcheng.text);
		if(namelen > 12 || namelen < 4){
			FlyUpTips.setTips("名字长度应在4-12个字符之间");
			return;
		}
		if(!this.sensitiveSession.IsSensitiveWord(this.mingcheng.text)){
			GameUtils.setError(1024);
			return;
		}
		this.unionAction.sendNewUnion(this.mingcheng.text,1,this.input.text);
	}

	__proto.upData=function(){}
	return NewUnionView;
})(lianmeng_lb_12UI)


//class huamao.panel.zhanbao.ZhanbaoItem extends ui.SLGGAME.zhanbao_0UI
var ZhanbaoItem=(function(_super){
	function ZhanbaoItem(){
		this.curData=null;
		this.listE=null;
		ZhanbaoItem.__super.call(this);
		this.listE=new ListItemEvent(this);
	}

	__class(ZhanbaoItem,'huamao.panel.zhanbao.ZhanbaoItem',_super);
	var __proto=ZhanbaoItem.prototype;
	__proto.update=function(data){
		this.curData=data;
		this.time0.text=GameUtils.timeFormat(data.startTime);
		this.zhuangtai.skin=data.isAttack==0 ? "comp/zhanbaolb/zb_0.png" :"comp/zhanbaolb/zb_1.png";
		var sysCity=ConfigManager.getConfig("sys_city.txt",data.cityId);
		this.where0.text=sysCity.cityName;
		this.who0.text=(data.secondName=="" ? sysCity.cityName+"守军" :data.secondName);
		this.jieguo.skin=data.isWin==0 ? "comp/G/img_sl.png" :"comp/G/img_sb.png";
		if(data.isRead==0){
			this.di.gray=false;
			this.yidu.visible=false;
			this.di.skin="comp/G/d2_0.png";
			}else{
			this.di.gray=true;
			this.yidu.visible=true;
			this.di.skin="comp/G/d2.png";
		}
	}

	return ZhanbaoItem;
})(zhanbao_0UI)


//class huamao.panel.union.UnionDongTaiItem extends ui.lianmeng_dongtai_1UI
var UnionDongTaiItem=(function(_super){
	function UnionDongTaiItem(){
		this.txt=null;
		this.unionSession=null;
		UnionDongTaiItem.__super.call(this);
		App.injOne(this);
	}

	__class(UnionDongTaiItem,'huamao.panel.union.UnionDongTaiItem',_super);
	var __proto=UnionDongTaiItem.prototype;
	// public static final int TYPE_APPOINT=7;// 任命
	__proto.upData=function(data){
		this.txt="";
		this.txt+=GameUtils.timeFormat(data.time,7)+",";
		var type=data.getType;
		var con=data.content;
		var arr=[];
		switch (type){
			case 1:
				this.txt+="<font color='#56f809'> "+con+"</font>"+" 创建了 "+"<font color='#56f809'> "+this.unionSession.unionName+"</font>";
				break ;
			case 2:
				this.txt+="<font color='#56f809'> "+con+"</font>"+"加入了联盟";
				break ;
			case 3:
				this.txt+="<font color='#56f809'> "+con+"</font>"+"退出了联盟";
				break ;
			case 4:
				arr=con.split(",");
				this.txt+="<font color='#56f809'> "+arr[0]+"</font>"+"将"+"<font color='#56f809'> "+arr[1]+"</font>"+"逐出联盟";
				break ;
			case 5:
				arr=con.split(",");
				var id=arr[1];
				var sys=ConfigManager.getConfig("sys_society_cost.txt" ,id);
				this.txt+="<font color='#56f809'> "+arr[0]+"</font>"+"进行了"+this.unionSession.titleTxt[id]+",获得了"+"<font color='#56f809'> "+sys.allianceLvup+"</font>"+"建设值,"+"获得了"+"<font color='#56f809'> "+(sys.allianceLvup*20)+"</font>"+"贡献,"+"获得了"+"<font color='#56f809'> "+sys.contribution+"</font>"+"帮贡";
				break ;
			case 6:
				this.txt+="联盟升级到"+"<font color='#56f809'> "+con+"</font>"+"级";
				break ;
			case 7:
				arr=con.split(",");
				if(arr[2]==UnionAction.ZHUMENGZHU){
					this.txt+="<font color='#56f809'> "+arr[0]+"</font>"+"转让"+"<font color='#56f809'> "+arr[1]+"</font>"+"为联盟盟主";
					}else if(arr[2]==UnionAction.FUMENGZHU){
					this.txt+="<font color='#56f809'> "+arr[0]+"</font>"+"任命"+"<font color='#56f809'> "+arr[1]+"</font>"+"为联盟副盟主";
				}
				break ;
			}
		this.qiming.style.fontSize=20;
		this.qiming.style.color="#ffffff";
		this.qiming.innerHTML=this.txt;
	}

	return UnionDongTaiItem;
})(lianmeng_dongtai_1UI)


//class ui.SLGGAME.huodong_tips_szzbUI extends laya.ui.Dialog
var huodong_tips_szzbUI=(function(_super){
	function huodong_tips_szzbUI(){
		this.ti=null;
		this.cha=null;
		this.txt0=null;
		this.name0=null;
		this.time0=null;
		this.btn0=null;
		huodong_tips_szzbUI.__super.call(this);
	}

	__class(huodong_tips_szzbUI,'ui.SLGGAME.huodong_tips_szzbUI',_super);
	var __proto=huodong_tips_szzbUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/huodong_tips_szzb");
	}

	return huodong_tips_szzbUI;
})(Dialog)


//class ui.SLGGAME.icon_dlUI extends laya.ui.Dialog
var icon_dlUI=(function(_super){
	function icon_dlUI(){
		this.box0=null;
		icon_dlUI.__super.call(this);
	}

	__class(icon_dlUI,'ui.SLGGAME.icon_dlUI',_super);
	var __proto=icon_dlUI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_dl");
	}

	return icon_dlUI;
})(Dialog)


//class ui.SLGGAME.icon_dl_tips2UI extends laya.ui.Dialog
var icon_dl_tips2UI=(function(_super){
	function icon_dl_tips2UI(){
		this.chushou=null;
		this.cha=null;
		this.box0=null;
		icon_dl_tips2UI.__super.call(this);
	}

	__class(icon_dl_tips2UI,'ui.SLGGAME.icon_dl_tips2UI',_super);
	var __proto=icon_dl_tips2UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/icon_dl_tips2");
	}

	return icon_dl_tips2UI;
})(Dialog)


//class huamao.panel.union.UnionJianZhuItem extends ui.lianmeng_1_1UI
var UnionJianZhuItem=(function(_super){
	function UnionJianZhuItem(){
		this.unionAction=null;
		this.unionSession=null;
		this.mainPlayerSession=null;
		this.arr=[];
		this.sys=null;
		this.num=0;
		UnionJianZhuItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionJianZhuItem,'huamao.panel.union.UnionJianZhuItem',_super);
	var __proto=UnionJianZhuItem.prototype;
	__proto.init=function(){
		for(var i=0;i<2;i++){
			var item=new Item();
			item.isViewTips(true);
			this["box"+i].addChild(item);
			item.size(this["box"+i].width,this["box"+i].height);
			this.arr.push(item);
		}
		this.btn0.on("click",this,this.sendjs);
	}

	__proto.sendjs=function(){
		if(this.sys.argentumCost>0){
			if(GameUtils.openBuZu(this.sys.argentumCost,2)==false){
				return;
			}
			}else{
			if(GameUtils.openBuZu(this.sys.goldCost)==false){
				return;
			}
		}
		if((this.sys.buildLimit-this.num)<=0){
			GameUtils.setError(1057);
			return;
		}
		this.unionAction.sendjs(this.sys.costId);
	}

	__proto.upData=function(data){
		this.sys=data;
		this.jianti.text=this.unionSession.titleTxt[data.costId];
		this.num=this.unionSession.buildObj[data.costId] ? this.unionSession.buildObj[data.costId] :0;
		this.shu.text=(data.buildLimit-this.num)+"/"+data.buildLimit;
		if(data.argentumCost>0){
			this.yin1.skin="comp/G/x_yinding.png";
			this.btn0.label=data.argentumCost+"";
			}else{
			this.yin1.skin="comp/G/x_yuanbao.png";
			this.btn0.label=data.goldCost+"";
		};
		var sysitem=ConfigManager.getConfig("sys_item.txt",data.contributionId);
		this.wu1.text=sysitem.itemName;
		sysitem=ConfigManager.getConfig("sys_item.txt",data.allianceLvupid);
		this.wu2.text=sysitem.itemName;
		this.arr[0].setItemId(data.contributionId);
		this.arr[1].setItemId(data.allianceLvupid);
		this.arr[0].setNum(data.contribution);
		this.arr[1].setNum(data.allianceLvup);
	}

	return UnionJianZhuItem;
})(lianmeng_1_1UI)


//class ui.SLGGAME.paihangbang1UI extends laya.ui.Dialog
var paihangbang1UI=(function(_super){
	function paihangbang1UI(){
		paihangbang1UI.__super.call(this);;
	}

	__class(paihangbang1UI,'ui.SLGGAME.paihangbang1UI',_super);
	var __proto=paihangbang1UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/paihangbang1");
	}

	return paihangbang1UI;
})(Dialog)


//class ui.SLGGAME.paihangbang3UI extends laya.ui.Dialog
var paihangbang3UI=(function(_super){
	function paihangbang3UI(){
		paihangbang3UI.__super.call(this);;
	}

	__class(paihangbang3UI,'ui.SLGGAME.paihangbang3UI',_super);
	var __proto=paihangbang3UI.prototype;
	__proto.createChildren=function(){
		laya.ui.Component.prototype.createChildren.call(this);
		this.loadUI("SLGGAME/paihangbang3");
	}

	return paihangbang3UI;
})(Dialog)


//class huamao.panel.union.UnionListItem extends ui.lianmeng_lb_1UI
var UnionListItem=(function(_super){
	function UnionListItem(){
		this.unionSession=null;
		this.mc=null;
		UnionListItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionListItem,'huamao.panel.union.UnionListItem',_super);
	var __proto=UnionListItem.prototype;
	__proto.init=function(){
		this.mc=new ClipMc();
		this.mc.scale(0.5,0.5);
		this.mc.autoPlay=true;
		this.mc.centerX=this.mc.centerY=0;
		this.qiB.addChild(this.mc);
	}

	__proto.upData=function(data){
		this.name0.text=data.unionName;
		this.dengji0.text=data.unionLv+"";
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",data.job);
		this.weizhi0.text=sysTitle.titleName;
		var sys=ConfigManager.getConfig("sys_society_levelup.txt",data.unionLv);
		this.shu0.text=data.playerNum+"/"+sys.allianceNum;
		if(this.unionSession.getApplyId(data.id)){
			this.box0.visible=true;
			}else{
			this.box0.visible=false;
		}
		this.mc.setClipName("clip"+data.Banner+"_4_4");
	}

	return UnionListItem;
})(lianmeng_lb_1UI)


//class huamao.panel.union.UnionPlayerListItem extends ui.SLGGAME.lianmeng_lixianUI
var UnionPlayerListItem=(function(_super){
	function UnionPlayerListItem(){
		this.unionSession=null;
		this.mainPlayerSession=null;
		this.icon={0:"qun",8:"fu",9:"zhu"};
		this.currData=null;
		UnionPlayerListItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionPlayerListItem,'huamao.panel.union.UnionPlayerListItem',_super);
	var __proto=UnionPlayerListItem.prototype;
	__proto.init=function(){
		this.btn0.on("click",this,this.clickFun);
	}

	__proto.clickFun=function(){
		App.eventManager.event("PLAYERCLICK",this.currData);
	}

	__proto.upData=function(data){
		this.currData=data;
		this.ming.text=data.playerName;
		this.deng.text=data.playerLv+"";
		this.zhi.text=this.unionSession.zhiwuObj[data.zhiWu];
		this.dang.text=data.dayScore+"";
		this.zhu.skin="comp/lianmeng/"+this.icon[data.zhiWu]+".png";
		if(data.getLine()==1){
			this.li.text="在线";
			this.setLabelColor("#ffffff");
			}else{
			var time=GameUtils.GetServerTime()-data.logoutTime;
			this.li.text=GameUtils.getDayHoursMinutes(time);
			this.setLabelColor("#646262");
		}
		this.btn0.visible=true;
		if(this.mainPlayerSession.mainPlayerData.playerId==data.playerId){
			this.btn0.visible=false;
			this.setLabelColor("#1eff00");
		}
	}

	/**
	*不在线 #646262 在线#ffffff 自己#1eff00
	*@param str
	*
	*/
	__proto.setLabelColor=function(str){
		this.ming.color=str;
		this.deng.color=str;
		this.zhi.color=str;
		this.dang.color=str;
		this.li.color=str;
	}

	return UnionPlayerListItem;
})(lianmeng_lixianUI)


//class huamao.panel.union.UnionQiZhiItem extends ui.lianmeng_qizhi_1UI
var UnionQiZhiItem=(function(_super){
	function UnionQiZhiItem(){
		this.mc=null;
		this.unionSession=null;
		UnionQiZhiItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionQiZhiItem,'huamao.panel.union.UnionQiZhiItem',_super);
	var __proto=UnionQiZhiItem.prototype;
	__proto.init=function(){
		this.mc=new ClipMc();
		this.mc.centerX=this.mc.centerY=0;
		this.mc.autoPlay=true;
		this.addChild(this.mc);
	}

	__proto.upData=function(id){
		if(this.unionSession.unionBanner==id){
			this.dang.visible=true;
			}else{
			this.dang.visible=false;
		}
		this.mc.setClipName("clip"+id+"_4_4");
	}

	return UnionQiZhiItem;
})(lianmeng_qizhi_1UI)


//class huamao.panel.union.UnionShenQingItem extends ui.lianmeng_sq_1UI
var UnionShenQingItem=(function(_super){
	function UnionShenQingItem(){
		this.unionAction=null;
		this.currData=null;
		UnionShenQingItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionShenQingItem,'huamao.panel.union.UnionShenQingItem',_super);
	var __proto=UnionShenQingItem.prototype;
	__proto.init=function(){
		this.yes0.on("click",this,this.tongyi);
		this.no0.on("click",this,this.jujue);
	}

	__proto.jujue=function(){
		this.unionAction.ApplyJujue(this.currData.playerId);
	}

	__proto.tongyi=function(){
		this.unionAction.sendTongGuo(this.currData.playerId);
	}

	__proto.upData=function(data){
		this.currData=data;
		this.name0.text=data.playerName;
		this.dengji.text=data.playerLv+"";
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",data.job);
		this.guan.text=sysTitle.titleName;
		var time=GameUtils.GetServerTime()-data.time;
		this.time0.text=GameUtils.getDayHoursMinutes(time);
	}

	return UnionShenQingItem;
})(lianmeng_sq_1UI)


//class huamao.panel.union.UnionShopItem extends ui.lianmeng_sd_1UI
var UnionShopItem=(function(_super){
	function UnionShopItem(){
		this.item=null;
		this.unionAction=null;
		this.sys=null;
		this.unionSession=null;
		this.num=0;
		this.currBg=0;
		UnionShopItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionShopItem,'huamao.panel.union.UnionShopItem',_super);
	var __proto=UnionShopItem.prototype;
	__proto.init=function(){
		this.btn0.on("click",this,this.sendGoumai);
		this.item=new Item();
		this.item.size(this.box_0.width,this.box_0.height);
		this.box_0.addChild(this.item);
	}

	__proto.sendGoumai=function(){
		if((this.sys.shopLimit-this.num)<=0){
			GameUtils.setError(1041);
			return;
		}
		if(this.unionSession.feat < this.currBg){
			GameUtils.setError(1042);
			return;
		}
		this.unionAction.sendShop(this.sys.id);
	}

	__proto.upData=function(data){
		this.sys=data;
		var sysitem=ConfigManager.getConfig("sys_item.txt",data.shopItemId);
		this.item.setItemId(data.shopItemId);
		this.item.setNum(data.itemNum);
		this.name0.text=sysitem.itemName;
		var arr=data.itemPrice.split(",");
		this.currBg=arr[1];
		this.btn0.label=this.currBg+"";
		this.num=this.unionSession.shopObj[data.id] ? this.unionSession.shopObj[data.id] :0;
		this.sheng.text="剩余:"+(data.shopLimit-this.num);
		if(data.societyLevelup>this.unionSession.unionLv){
			this.btn0.disabled=true;
			this.shi.text=GameUtils.lang(1067,[data.societyLevelup]);
			}else{
			this.btn0.disabled=false;
			this.shi.text="";
		}
	}

	return UnionShopItem;
})(lianmeng_sd_1UI)


//class huamao.panel.union.UnionShuoMingItem extends ui.lianmeng_shuoming_1UI
var UnionShuoMingItem=(function(_super){
	function UnionShuoMingItem(){
		UnionShuoMingItem.__super.call(this);
	}

	__class(UnionShuoMingItem,'huamao.panel.union.UnionShuoMingItem',_super);
	var __proto=UnionShuoMingItem.prototype;
	__proto.upData=function(data){
		this.dengji.text=data.allianceLv+"";
		if(data.allianceLvup==-1){
			this.xujing.text="满级";
			}else{
			this.xujing.text=data.allianceLvup+"";
		}
		this.fumeng.text=data.allianceChairNum+"";
		this.renshu.text=data.allianceNum+"";
	}

	return UnionShuoMingItem;
})(lianmeng_shuoming_1UI)


//class huamao.panel.vip.VipItem extends ui.huiyuanfuwo_1UI
var VipItem=(function(_super){
	function VipItem(){
		this.rechargeSession=null;
		this.itemArr=[];
		this.vip=null;
		this.sys
		VipItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(VipItem,'huamao.panel.vip.VipItem',_super);
	var __proto=VipItem.prototype;
	__proto.init=function(){
		this.vip=new Item();
		this.vip.pos(2,2);
		this.vip.size(75,75);
		this.kuang.addChild(this.vip);
		for(var i=0;i<2;i++){
			var item=new Item();
			this["kuang"+(i+1)].addChild(item);
			item.pos(2,2);
			item.size(75,75);
			this.itemArr.push(item);
		}
	}

	__proto.upData=function(id){
		this.clear();
		this.sys=ConfigManager.getConfig("sys_member.txt",id);
		var arr=this.sys.memberReward.split(",");
		this.vip.setItemId(this.sys.memberIcon);
		var index=0;
		for(var i=0;i<arr.length;i+=2){
			var item=this.itemArr[index];
			item.setItemId(arr[i]);
			item.setNum(arr[i+1]);
			index++;
		}
		this.zi.text="购买可以获得"+this.sys.memberTime+"天"+this.sys.memberType;
		this.qian.text=this.sys.rechargeCurrencyType+"  "+this.sys.memberCost;
		if(this.rechargeSession.getVip(id)){
			this.kuang1.visible=true;
			this.kuang2.visible=true;
		}
		else{
			this.kuang.visible=true;
			this.zi.visible=true;
			this.qian.visible=true;
		}
	}

	__proto.clear=function(){
		this.kuang1.visible=false;
		this.kuang2.visible=false;
		this.kuang.visible=false;
		this.zi.visible=false;
		this.qian.visible=false;
	}

	return VipItem;
})(huiyuanfuwo_1UI)


//class huamao.panel.wujiangxinxi.HeroInfoArmsTab extends ui.SLGGAME.wujiang0_3_1UI
var HeroInfoArmsTab=(function(_super){
	function HeroInfoArmsTab(){
		this.unlockSoldier=null;
		this.curSoldier=0;
		this.heroId=0;
		this.mainPlayerSession=null;
		this.armsAction=null;
		HeroInfoArmsTab.__super.call(this);
		App.injOne(this);
		this.huadong.renderHandler=new Handler(this,this.flushListCell);
		this.huadong.vScrollBarSkin="";
		this.huadong.height=this.huadong.height-4;
		this.checkifClose();
	}

	__class(HeroInfoArmsTab,'huamao.panel.wujiangxinxi.HeroInfoArmsTab',_super);
	var __proto=HeroInfoArmsTab.prototype;
	__proto.initList=function(_heroid,ary,_unlocksoldier,_soldier){
		if(this.checkifClose()){
			this.huadong.array=ary;
			this.unlockSoldier=_unlocksoldier;
			this.curSoldier=_soldier;
			this.heroId=_heroid;
		}
	}

	__proto.checkIfUnlock=function(forceid){
		for(var i=0;i<this.unlockSoldier.length;i++){
			if(this.unlockSoldier[i]==forceid){
				return true;
			}
		}
		return false;
	}

	__proto.checkifClose=function(){
		if(this.mainPlayerSession.mainPlayerData.job>=1004){
			this.ii.visible=true;
			this.huadong.visible=true;
			this.daquan.visible=true;
			this.ll.visible=false;
			return true;
			}else{
			this.ll.visible=true;
			this.ii.visible=false;
			this.huadong.visible=false;
			this.daquan.visible=false;
			return false;
		}
	}

	__proto.flushListCell=function(box){
		var UI=box._childs [0];
		var forceId=box.dataSource;
		var sysForce=ConfigManager.getConfig("sys_force.txt",forceId);
		UI.bing.text=sysForce.forceName;
		UI.txt0.text=sysForce.forceDescription;
		UI.shu.text=sysForce.copperCost+"";
		UI.img0.skin=this.getIconFromForceType(sysForce.forceType);
		UI.gou.on("click",this,this.radioCB,[forceId]);
		if(this.curSoldier==forceId){
			UI.gou.selected=true;
			}else{
			UI.gou.selected=false;
		}
		if(this.checkIfUnlock(forceId)){
			UI.chubei.text="消耗:";
			UI.qian.visible=true;
			UI.shu.visible=true;
			UI.suo.visible=false;
			UI.suo.mouseEnabled=false;
			UI.off("click",this,this.suoClickCB);
			UI.gou.visible=true;
			UI.gou.mouseEnabled=true;
			}else{
			UI.chubei.text="未解锁";
			UI.qian.visible=false;
			UI.shu.visible=false;
			UI.suo.visible=true;
			UI.suo.mouseEnabled=true;
			UI.on("click",this,this.suoClickCB,[forceId]);
			UI.gou.visible=false;
			UI.gou.mouseEnabled=false;
		}
	}

	__proto.suoClickCB=function(forceid,e){
		if(!((e.target instanceof laya.ui.CheckBox ))){
			var tips=App.dialogManager.showMiniDialog(HeroUnlockSoldier,true,true);
			tips.setForce(this.heroId,forceid);
		}
	}

	__proto.radioCB=function(forceid,e){
		var radio=e.target;
		if(this.setAllRadioFalse(radio)){
			radio.selected=!radio.selected;
			if(GameState.state==1){
				this.armsAction.sendArms(this.heroId,forceid,0);
				}else{
				var tips=App.dialogManager.showMiniDialog(HeroChangeSoldier,true,true);
				tips.setChangeForce(this.heroId,forceid);
			}
		}
	}

	__proto.setAllRadioFalse=function(target){
		var result=false;
		var len=this.huadong.array.length;
		for(var i=0;i<len;i++){
			var box=this.huadong.getCell(i);
			var UI=box._childs [0];
			if(target !=UI.gou){
				if(UI.gou.selected){
					result=true;
				}
			}
		}
		return result;
	}

	__proto.getIconFromForceType=function(type){
		var url="";
		switch(type){
			case 1:
				url="comp/G/bz_bu.png";
				break ;
			case 2:
				url="comp/G/bz_qi.png";
				break ;
			case 3:
				url="comp/G/bz_gong.png";
				break ;
			case 4:
				url="comp/G/bz_fa.png";
				break ;
			}
		return url;
	}

	__proto.setSys=function(heroId,forceId){}
	/*
	var sysForce:SysForce=ConfigManager.getConfig(MyGameInit.sys_force,forceId)as SysForce;
	bing.text=sysForce.forceName;
	txt0.text=sysForce.forceDescription;
	shu.text=sysForce.copperCost+"";
	<<<<<<< .mine
	//dengji.text=((sysForce.forceLevel==1)?"初级兵种":"高级兵种");
	=======
	>>>>>>> .r40933
	if(sysForce.forceLevel==1 ){
		//初级兵种 不显示他的初级兵种信息
		return;
	}

	var baseSysForce:SysForce=this.getBaseSys(sysForce.forceType);
	if(baseSysForce.forceType==4 && baseSysForce.forceLevel==1 ){
		//这个兵种不显示基础属性
		return;
	}

	txt0.text=baseSysForce.forceDescription+"\n"+sysForce.forceDescription;
	//*/
	__proto.getBaseSys=function(forceType){
		var arr=ConfigManager.getDataArr("sys_force.txt");
		for (var i=0;i < arr.length;i++){
			var sys=arr [i];
			if(sys.forceType==forceType && sys.forceLevel==1){
				return sys;
			}
		}
		return null;
	}

	return HeroInfoArmsTab;
})(wujiang0_3_1UI)


//class huamao.panel.wujiangxinxi.HeroInfoEquipTab extends ui.SLGGAME.wujiang0_1UI
var HeroInfoEquipTab=(function(_super){
	function HeroInfoEquipTab(){
		this.star=null;
		this.weapon=null;
		this.def=null;
		this.mount=null;
		this.yongH=new HTMLDivElement();
		this.yuH=new HTMLDivElement();
		this.zhiH=new HTMLDivElement();
		this.weiH=new HTMLDivElement();
		HeroInfoEquipTab.__super.call(this);
		this.bar0.value=0;
		this.star=new SpStat();
		this.star.setMax(25,5);
		this.star.setURL("comp/G/x_xiaoxingxing.png",null);
		this.makeHtml(this.yongH,this.yong0);
		this.makeHtml(this.yuH,this.yu0);
		this.makeHtml(this.zhiH,this.zhi0);
		this.makeHtml(this.weiH,this.wei0);
		this.weapon=new Item();
		this.weapon.size(this.box1.width+3,this.box1.height+3);
		this.weapon.pos(-1.5,5.5);
		this.def=new Item();
		this.def.size(this.weapon.width,this.weapon.height);
		this.def.pos(this.weapon.x,this.weapon.y);
		this.mount=new Item();
		this.mount.size(this.weapon.width,this.weapon.height);
		this.mount.pos(this.weapon.x,this.weapon.y);
		this.box1.addChild(this.weapon);
		this.box2.addChild(this.def);
		this.box3.addChild(this.mount);
		this.xing.addChild(this.star);
		this.on("display",this,this.disFun);
	}

	__class(HeroInfoEquipTab,'huamao.panel.wujiangxinxi.HeroInfoEquipTab',_super);
	var __proto=HeroInfoEquipTab.prototype;
	__proto.disFun=function(){
		FlyLittleUpTips.regByString(this.tip1,"1.储备经验为所有武将共享，可用于武将升级。\n2.击败敌军可获得储备经验，也可以通过使用兵书获得储备经验。\n3.储备经验存储上限为一千万。经验超出存储上限后，不可通过击败\n敌军获得储备经验。");
	}

	__proto.makeHtml=function(html,box){
		box.addChild(html);
		html.y=-5;
	}

	__proto.setHeroData=function(heroData){
		this.chengzhanga.text=heroData.growth+"";
		this.yongH.innerHTML=this.getHtml(heroData.force,heroData.growthCourage);
		this.yuH.innerHTML=this.getHtml(heroData.resist,heroData.growthDef);
		this.zhiH.innerHTML=this.getHtml(heroData.wisdom,heroData.growthInt);
		this.weiH.innerHTML=this.getHtml(heroData.might,heroData.growthPrestige);
		this.setStar(heroData.heroStar);
	}

	__proto.getHtml=function(now,add){
		return TheGame.FONT(TheGame.getNum(now),"#ffffff",24 ,null)+TheGame.FONT("(+"+TheGame.getNum(add)+")","#8ee068",24,null);
	}

	__proto.setStar=function(value){
		this.star.setNow(value);
	}

	// }
	__proto.setMaxSoul=function(value){
		this.txt3.text=value+"";
	}

	__proto.setExp=function(value){
		this.txt1.text=value+"";
	}

	__proto.setNeedExp=function(value){
		this.txt_bar0.text="0/"+value;
	}

	__proto.setEquip=function(arr){
		var boxArr=[this.weapon,this.def,this.mount];
		for (var j=0;j < boxArr.length;j++){
			(boxArr [j]).clear();
		}
		for (var i=0;i < arr.length;i++){
			var data=arr [i];
			var sys=ConfigManager.getConfig("sys_item.txt",data.itemId);
			var item=boxArr[sys.itemType-1];
			item.setItemId(sys.itemId);
			item.setLv(data.lv);
		}
	}

	return HeroInfoEquipTab;
})(wujiang0_1UI)


//class huamao.panel.wujiangxinxi.HeroInfoLegionTab extends ui.SLGGAME.wujiang0_4UI
var HeroInfoLegionTab=(function(_super){
	function HeroInfoLegionTab(){
		this.wuJiangSession=null;
		this.bagSession=null;
		this.mainPlayerSession=null;
		this.heroBox=[];
		this.arrData=[];
		this.shuArr=["force","resist","wisdom","might","attack","defense","stratagemAttack","stratagemDefense"];
		this.nameArr=["勇","御","智","威","物理攻击","物理防御","计策攻击","计策防御"];
		this.newName=["物攻","物防","魔攻","魔防"];
		HeroInfoLegionTab.__super.call(this);
		this.init();
	}

	__class(HeroInfoLegionTab,'huamao.panel.wujiangxinxi.HeroInfoLegionTab',_super);
	var __proto=HeroInfoLegionTab.prototype;
	__proto.init=function(){
		App.injOne(this);
		var hbox=new LegionSmallBox();
		this.addChild(hbox);
		hbox.x=this.meika0.x+30;
		hbox.y=this.meika0.y-3;
		hbox.on("click",this,this.selectFun1);
		var hbox1=new LegionSmallBox();
		this.addChild(hbox1);
		hbox1.x=this.meika1.x+30;
		hbox1.y=this.meika1.y-3;
		hbox1.on("click",this,this.selectFun2);
		this.heroBox.push(hbox,hbox1);
		this.txt0.wordWrap=true;
		this.meika0.wenzi1.visible=false;
		this.meika1.wenzi1.visible=false;
	}

	__proto.selectFun1=function(e){
		if((e.target instanceof laya.ui.Button ))return;
		App.eventManager.event("CHAKANZHUJIANG",this.arrData[0].heroId);
	}

	__proto.selectFun2=function(e){
		if((e.target instanceof laya.ui.Button ))return;
		App.eventManager.event("CHAKANZHUJIANG",this.arrData[1].heroId);
	}

	/**
	*显示副将信息
	*@param heroId
	*
	*/
	__proto.upDataLegion=function(heroId){
		this.clear();
		this.upDataUI(heroId);
		var heroData=this.wuJiangSession.getHero(heroId);
		var arr=heroData.legion.split(",");
		if(heroData.legion!=""){
			for(var i=0;i<2;i++){
				if(i<arr.length){
					var item=this.heroBox[i];
					item.visible=true;
					item.setHeroData(this.wuJiangSession.getHero(arr[i]));
					item.tuijian();
					this.arrData.push(this.wuJiangSession.getHero(arr[i]));
				}
			}
			this.vice(heroData,arr);
		}
	}

	__proto.upDataUI=function(heroId){
		if(this.mainPlayerSession.mainPlayerData.job>=1004){
			var heroData=this.wuJiangSession.getHero(heroId);
			var masterData;
			if(heroData.sysHero.heroColor==MyGameConst.COLOR_YELLOW){
				this.box1.visible=true;
			}
			else if(heroData.sysHero.heroColor==MyGameConst.COLOR_PURPLE){
				this.zhujiang.visible=true;
				if(heroData.masterId > 0){
					this.box0.visible=true;
					masterData=this.wuJiangSession.getHero(heroData.masterId);
					this.txt_b.text="该武将当前从属于"+masterData.sysHero.heroName+"军团";
				}
				else{
					this.box1.visible=true;
					this.meika1.visible=false;
				}
			}
			else if(heroData.sysHero.heroColor<=MyGameConst.COLOR_BLUE){
				this.box0.visible=true;
				if(heroData.masterId > 0){
					masterData=this.wuJiangSession.getHero(heroData.masterId);
					this.txt_b.text="该武将当前从属于"+masterData.sysHero.heroName+"军团";
				}
				else{
					this.txt_b.text="只有紫色武将橙色武将才能统帅军团";
					this.txt_b.color="#f40623";
					this.tuijian.x=112;
					this.chakan.visible=false;
				}
			}
		}
		else{
			this.box0.visible=true;
			this.tuijian.visible=false;
			this.chakan.visible=false;
			this.txt_b.text="官职达到县令后开放军团";
			this.txt_b.color="#f40623";
		}
	}

	__proto.clear=function(){
		this.arrData=[];
		this.box1.visible=false;
		this.box0.visible=false;
		this.zhujiang.visible=false;
		this.meika0.visible=true;
		this.meika1.visible=true;
		this.tuijian.x=233;
		this.chakan.visible=true;
		this.tuijian.visible=true;
		this.txt_b.color="#ffdeb9";
		this.txt0.text="";
		for(var i=0;i<this.heroBox.length;i++){
			var item=this.heroBox[i];
			item.visible=false;
		}
	}

	__proto.vice=function(data,arr){
		var num=0;
		if(data.legion!=""){
			for(var i=0;i<arr.length;i++){
				var fujiang=this.wuJiangSession.getHero(arr[i]);
				var eArr=this.bagSession.getEquipByHeroId(fujiang.heroId);
				var sys=ConfigManager.getConfig("sys_hero_vice.txt",fujiang.heroStar);
				num=data.sysHero.viceHero.indexOf(fujiang.heroId+"")==-1 ? sys.commonRatio :sys.recommendedRatio;
				num=num/1000;
				this.txt0.text+=fujiang.sysHero.heroName+": ";
				for(var j=0;j<this.shuArr.length;j++){
					var shu=NaN;
					var str="";
					if(j<4){
						shu=fujiang[this.shuArr[j]];
						if(shu>0){
							shu=Math.floor(shu*num);
							str=shu+"";
							this.txt0.text+=this.nameArr[j]+"+"+str+" ";
						}
						else{
							continue ;
						}
					}
				}
				if(eArr.length>0){
					for(var s=0;s<eArr.length;s++){
						var bitem=eArr[s];
						var shuxing=bitem.getShuXing(0);
						for(var sn=0;sn<shuxing.length;sn+=2){
							for(var name=0;name<this.newName.length;name++){
								if(shuxing[sn]==this.newName[name]){
									shu=shuxing[sn+1];
									shu=shu*num;
									str=shu.toFixed(1);
									this.txt0.text+=this.nameArr[name+4]+"+"+str+" ";
									break ;
								}
							}
						}
					}
				}
				this.txt0.text+="\n\n";
			}
		}
	}

	return HeroInfoLegionTab;
})(wujiang0_4UI)


//class huamao.panel.wujiangxinxi.HeroInfoSkillTab extends ui.SLGGAME.wujiang0_2UI
var HeroInfoSkillTab=(function(_super){
	function HeroInfoSkillTab(){
		this.spStat=null;
		this.contentSp=null;
		this.blackFilter=[new GlowFilter("#000000",2,0,0)];
		HeroInfoSkillTab.__super.call(this);
		this.contentSp=new Sprite();
		this.spStat=new SpStat();
		this.spStat.setButton(this.huo.skin,2);
		this.addChild(this.spStat);
		this.spStat.pos(this.huo.x,this.huo.y);
		this.huo.visible=false;
		this.addChild(this.contentSp);
		this.contentSp.pos(this.html0.x,this.html0.y);
		this.html0.visible=false;
	}

	__class(HeroInfoSkillTab,'huamao.panel.wujiangxinxi.HeroInfoSkillTab',_super);
	var __proto=HeroInfoSkillTab.prototype;
	__proto.setSkill=function(skillId){
		var sys=ConfigManager.getConfig("sys_skill.txt",skillId);
		this.txt_bt.text=sys.skillName;
		this.txt0.text=sys.skillDescription;
		this.spStat.setBtnMax(30,sys.skillRage);
		this.spStat.setBtnNow(sys.skillRage);
	}

	__proto.setMix=function(arr){
		this.contentSp.removeChildren();
		for (var i=0;i < arr.length;i+=2){
			this.addOne(arr[i] ,arr[i+1]);
		}
	}

	__proto.addOne=function(skillName,content){
		var sprite=new Sprite();
		var nameDiv=new HTMLDivElement();
		var contentDiv=new HTMLDivElement();
		nameDiv.innerHTML=skillName;
		contentDiv.innerHTML=content;
		contentDiv.x=nameDiv.contextWidth+3;
		contentDiv.width=380;
		sprite.addChild(nameDiv);
		sprite.addChild(contentDiv);
		this.contentSp.autoSize=true;
		if(this.contentSp.numChildren > 0){
			sprite.y=this.contentSp.height+20;
		}
		this.contentSp.addChild(sprite);
		nameDiv.filters=this.blackFilter;
		this.contentSp.filters=this.blackFilter;
	}

	return HeroInfoSkillTab;
})(wujiang0_2UI)


//class huamao.panel.wujiangxinxi.WujiangDetailInfo extends ui.SLGGAME.wujiang_ka1UI
var WujiangDetailInfo=(function(_super){
	function WujiangDetailInfo(){
		this.content=null;
		this._info=null;
		this._rect=null;
		WujiangDetailInfo.__super.call(this);
		this.content=new Box();
		this.content.autoSize=true;
		this.addChild(this.content);
		this.content.pos(10,40);
		this.content.centerX=0;
		this.content.scrollRect=new Rectangle(0,0,400,500);
		this._info=new Info();
		this.content.addChild(this._info);
		this._info.on("mousedown",this,this.onDown);
	}

	__class(WujiangDetailInfo,'huamao.panel.wujiangxinxi.WujiangDetailInfo',_super);
	var __proto=WujiangDetailInfo.prototype;
	__proto.onDown=function(){
		console.log("======");
		this._info.startDrag(this._rect);
	}

	__proto.update=function(heroData){
		this.wujiangming.text=heroData.sysHero.heroName;
		this._info.update(heroData);
		this._rect=new Rectangle(0,500-this._info._hh,0,this._info._hh-500);
	}

	return WujiangDetailInfo;
})(wujiang_ka1UI)


//class huamao.panel.xingjunList.XingjunListItem extends ui.SLGGAME.map_xjlb0UI
var XingjunListItem=(function(_super){
	var KeyValue;
	function XingjunListItem(){
		this._btnState=0;
		this.takeTime=null;
		this.takeTime2=null;
		this.bagSession=null;
		this.mapCityAction=null;
		this.mapCitySession=null;
		this.mainPlayerSession=null;
		this.kvBox=null;
		this.listE=null;
		this._actionData=null;
		XingjunListItem.__super.call(this);
		App.injOne(this);
		this.takeTime=ConfigManager.getConfig("sys_timetake.txt",25);
		this.takeTime2=ConfigManager.getConfig("sys_timetake.txt",26);
		this.btn0.clickHandler=new Handler(this,this.onClick);
		this.listE=new ListItemEvent(this.btn0);
		this.kvBox=new Sprite();
		this.addChild(this.kvBox);
	}

	__class(XingjunListItem,'huamao.panel.xingjunList.XingjunListItem',_super);
	var __proto=XingjunListItem.prototype;
	__proto.onClick=function(){
		if(this._btnState==1){
			UseJice.ins.onUse(4004,this.takeTime2.timeCd,new Handler(this,this.useHandler,[0,this._actionData.actionId]),new Handler(this,this.useHandler,[1,this._actionData.actionId]));
		}
		else if(this._btnState==2){
			this.mapCityAction.onChefang(this._actionData.toId);
			this.mapCitySession.delActionById(this._actionData.actionId);
		}
		else if(this._btnState==3){
			App.eventManager.event("BATTLE",this._actionData.battleFileUrl+"");
			App.dialogManager.closeDialogByStr("XINGJUN_LIST");
		}
	}

	__proto.useHandler=function(type,actionId){
		UseJice.ins.close();
		if(type==0){
			var num=this.bagSession.getItemNumByItemId(4004);
			if(num==0){
				var openFunctionSession=App.getSession("openFunctionSession");
				if(openFunctionSession.isFunction("jice")){
					return;
				}
				App.dialogManager.openDialogByStr("DIALOG_STRATAGEM",null,true,true);
				return;
			}
		}
		else if(type==1){
			if(this.mainPlayerSession.mainPlayerData.gold < this.takeTime2.timeCd){
				FlyUpTips.setTips("元宝不足");
				return;
			}
			if(UseJiceTips.XingJunJiaSu_IFVIEW){
				var tips=App.dialogManager.showMiniDialog(UseJiceTips,true,true);
				tips.setHandler(4004,this.takeTime2.timeCd,new Handler(this,this.UseJiceTipsCB,[actionId,type]));
				return;
			}
		}
		this.UseJiceTipsCB(actionId,type);
	}

	__proto.UseJiceTipsCB=function(actionId,type){
		App.voiceManager.playSound("yongjimou.wav");
		this.mapCityAction.onJiasu(actionId,type);
	}

	__proto.update=function(data){
		this.kvBox.removeChildren();
		this.img0.skin="comp/G/jc_0"+data.actionType+".png";
		this._actionData=data;
		this.c1.text=(ConfigManager.getConfig("sys_city.txt",data.fromId)).cityName;
		this.c2.text=(ConfigManager.getConfig("sys_city.txt",data.toId)).cityName;
		if(data.yubeiyiNum > 0){
			var kv=new KeyValue();
			kv.update("预备役","#ffffff",data.yubeiyiNum);
			kv.pos(18,50);
			this.kvBox.addChild(kv);
		}
		else{
			var size=data.heroList.length;
			for(var i=0;i < size;i++){
				var heroData=data.heroList[i];
				kv=new KeyValue();
				kv.update(heroData.sysHero.heroName,GameUtils.getHeroNameColor(heroData.sysHero.heroColor),heroData.soldier);
				kv.pos(18,50+i *25);
				this.kvBox.addChild(kv);
			}
		}
		this.onUpdate();
		Laya.timer.loop(1000,this,this.onUpdate);
	}

	__proto.clear=function(){
		Laya.timer.clear(this,this.onUpdate);
	}

	__proto.onUpdate=function(){
		if(this._actionData.remainingTime > 0){
			this.time0.text=GameUtils.time(this._actionData.remainingTime);
			this.btn0.skin="comp/G/btn_blue.png";
			var jiasu=this.takeTime.timeCd-this._actionData.jiasuTimes;
			this.btn0.label="加速("+jiasu+"/"+this.takeTime.timeCd+")";
			this._btnState=1;
			this.btn0.disabled=jiasu==0;
			if(this._actionData.battleId > 0){
				this.time0.text="";
				this.btn0.skin="comp/G/btn_yello.png";
				this.btn0.label="进入战场";
				this._btnState=3;
				this.btn0.disabled=false;
			}
		}
		else{
			if(this._actionData.actionType==CityPlayerType.SELF){
				Laya.timer.clear(this,this.onUpdate);
				this.visible=false;
				this._btnState=0;
				console.log("运输结束");
			}
			else if(this._actionData.actionType==CityPlayerType.FRIEND){
				Laya.timer.clear(this,this.onUpdate);
				this.time0.text="";
				this.c2.text="协防中";
				this.btn0.skin="comp/G/btn_honghong.png";
				this.btn0.label="撤回";
				this._btnState=2;
				this.btn0.disabled=false;
			}
			else{
				if(this._actionData.actionType==CityPlayerType.ENEMY || this._actionData.actionType==CityPlayerType.KONG){
					Laya.timer.clear(this,this.onUpdate);
					this.visible=false;
					this._btnState=0;
					console.log("战斗时间结束了");
				}
			}
		}
	}

	XingjunListItem.SPACE="               ";
	XingjunListItem.__init$=function(){
		//class KeyValue extends ui.SLGGAME.map_xjlb0_1UI
		KeyValue=(function(_super){
			function KeyValue(){
				KeyValue.__super.call(this);
			}
			__class(KeyValue,'',_super);
			var __proto=KeyValue.prototype;
			__proto.update=function(name,color,vv){
				this.txt0.text=name;
				this.txt0.color=color;
				this.txt1.text=vv+"";
			}
			return KeyValue;
		})(map_xjlb0_1UI)
	}

	return XingjunListItem;
})(map_xjlb0UI)


//class huamao.panel.zhanbao.tongji.TongjiItem extends ui.SLGGAME.zhanbao_zdtj0UI
var TongjiItem=(function(_super){
	function TongjiItem(){
		TongjiItem.__super.call(this);
		for(var i=1;i <=5;i++){
			this.ka["xing"+i].visible=false;
		}
		this.ka.yuancha.visible=false;
		this.ka.hun.visible=false;
	}

	__class(TongjiItem,'huamao.panel.zhanbao.tongji.TongjiItem',_super);
	var __proto=TongjiItem.prototype;
	__proto.update=function(data,mvpId){
		this.ka.box.removeChildren();
		var img=new HeroImage();
		img.setHeroId(data.heroId);
		img.setScaleSize(this.ka.box.width,0);
		this.ka.box.addChild(img);
		this.ka.box.scrollRect=new Rectangle(0,0,this.ka.box.width,this.ka.box.height);
		var sysHero=ConfigManager.getConfig("sys_hero.txt",data.heroId);
		this.ka.guojia.skin=GameUtils.getCountry(sysHero.heroCountry);
		this.ka.name0.text=sysHero.heroName;
		this.ka.dengji.text=data.lv+"";
		this.ka.txt0.text=data.nowHp+"/"+data.maxHp;
		this.ka.binglitiao.value=data.nowHp / data.maxHp;
		this.ka.kaung.skin=GameUtils.getKuang(sysHero.heroColor);
		this.ka.di.skin=GameUtils.getDi(sysHero.heroColor);
		GameUtils.getKaKuang(this.ka.wk,sysHero.heroColor);
		this.bar0.value=data.kill > 0 ? 1 :0;
		this.shu0.text=""+data.kill;
		this.bar1.value=data.damage > 0 ? 1 :0;
		this.shu1.text=""+data.damage;
		this.bar2.value=data.cure > 0 ? 1 :0;
		this.shu2.text=""+data.cure;
		this.img0.visible=data.heroId==mvpId;
	}

	return TongjiItem;
})(zhanbao_zdtj0UI)


//class huamao.panel.zhaomu.mjl.JlItem extends ui.SLGGAME.zhaomu_jl0UI
var JlItem=(function(_super){
	function JlItem(){
		this.txtArr=["普通招募","普通5连抽","重金招募","重金5连抽"];
		JlItem.__super.call(this);
		this.init();
	}

	__class(JlItem,'huamao.panel.zhaomu.mjl.JlItem',_super);
	var __proto=JlItem.prototype;
	__proto.init=function(){
		this.list0.renderHandler=new Handler(this,this.updateItem);
	}

	__proto.updateItem=function(cell,index){
		var obj=this.list0.array[index];
		var cellUI=cell.getChildAt(0);
		cellUI.box.scrollRect=new Rectangle(0,0,cellUI.box.width,cellUI.box.height-3);
		cellUI.hun.visible=obj.num>0 ? true :false;
		cellUI.shuH.text=obj.num;
		cellUI.xing.visible=false;
		cellUI.xue.visible=false;
		cellUI.yuancha.visible=false;
		cellUI.box.removeChildren();
		var sysHero=ConfigManager.getConfig("sys_hero.txt",obj.id);
		var sys=ConfigManager.getConfig("sys_recruit_hero.txt",obj.id);
		var img=new HeroImage();
		cellUI.box.addChild(img);
		img.setScaleSize(cellUI.box.width,0);
		if(sys && sys.recruitHeroSoul>0){
			img.setHeroId(sys.recruitHero);
			cellUI.dengji.text="";
			cellUI.name0.text="武魂卡";
			cellUI.guojia.visible=false;
			cellUI.di.skin=GameUtils.getDi(1);
			cellUI.kaung.skin=GameUtils.getNoKuang(1);
			cell.off("click",this,this.clickFun);
		}
		else{
			cellUI.guojia.visible=true;
			img.setHeroId(sysHero.heroId);
			cellUI.dengji.text="1";
			cellUI.name0.text=sysHero.heroName;
			cellUI.guojia.skin=GameUtils.getCountry(sysHero.heroCountry);
			cellUI.di.skin=GameUtils.getDi(sysHero.heroColor);
			GameUtils.getKaKuang(cellUI.wk,sysHero.heroColor);
			cellUI.xue.visible=cellUI.kaung.visible=cellUI.hei.visible=false;
			cell.on("click",this,this.clickFun,[index]);
		}
	}

	__proto.clickFun=function(index){
		var sysHero=ConfigManager.getConfig("sys_hero.txt",this.list0.array[index].id);
		App.dialogManager.openDialogByStr("MJLSHUOMING",{heroId:sysHero.heroId});
	}

	__proto.setData=function(obj){
		var openWarDate=new Date();
		openWarDate.setTime(obj.timer *1000);
		this.txt0.text=openWarDate.getFullYear()+"-"+(openWarDate.getMonth()+1)+"-"+openWarDate.getDate()+" "+openWarDate.getHours()+":"+openWarDate.getMinutes()+":"+openWarDate.getSeconds();
		var arr=obj.str.split(",");
		this.txt1.text=this.txtArr[arr[0]];
		arr.shift();
		var arr1=[];
		for(var i=0;i<arr.length;i+=2){
			var obj1={};
			obj1.id=arr[i];
			obj1.num=arr[i+1];
			arr1.push(obj1);
		}
		this.list0.array=arr1;
	}

	return JlItem;
})(zhaomu_jl0UI)


//class huamao.panel.zhaomu.ZhaomuAnimation extends ui.SLGGAME.zhaomukaUI
var ZhaomuAnimation=(function(_super){
	function ZhaomuAnimation(){
		this.kabei=null;
		this.index=0;
		//private var a2:Animation2;
		this.hun=null;
		this.showScale=0.7;
		// }
		this.sp=null;
		ZhaomuAnimation.__super.call(this);
		this.hun=new Image("comp/G/x_hun.png");
		this.addChild(this.hun);
	}

	__class(ZhaomuAnimation,'huamao.panel.zhaomu.ZhaomuAnimation',_super);
	var __proto=ZhaomuAnimation.prototype;
	__proto.setData=function(hid,snum){
		this.scaleX=this.showScale;
		this.scaleY=this.showScale;
		this.index=0;
		var sysh=ConfigManager.getConfig("sys_hero.txt",hid);
		var sys=ConfigManager.getConfig("sys_recruit_hero.txt",hid);
		this.centerX=this.centerY=0;
		this.renwu.centerX=this.renwu.centerY=0;
		this.renwu.skin=null;
		this.tiao.skin=GameUtils.getZiDi(sysh.heroColor);
		if(sys && sys.recruitHeroSoul>0){
			this.yong.text="";
			this.zhi.text="";
			this.yu.text="";
			this.wei.text="";
			this.wujiangming.text="武魂卡";
			GameUtils.getKaKuang(this.wk,1);
			this.di.skin=GameUtils.getDi(1);
			this.renwu.skin=GameUtils.getHeroSkin(hid);
			this.dengji.text="";
		}
		else{
			this.yong.text=sysh.heroCourage+"";
			this.zhi.text=sysh.heroInt+"";
			this.yu.text=sysh.heroDef+"";
			this.wei.text=sysh.heroPrestige+"";
			this.wujiangming.text=sysh.heroName+"";
			GameUtils.getKaKuang(this.wk,sysh.heroColor);
			this.zy.skin=GameUtils.getCountry(sysh.heroCountry);
			this.di.skin=GameUtils.getDi(sysh.heroColor);
			this.renwu.skin=GameUtils.getHeroSkin(hid);
			this.dengji.text="1";
		}
		if(this.kabei==null){
			this.kabei=new Image(SysHero.ColorPng[SysHero.ColorPng.length-1]);
			this.addChild(this.kabei);
		}
		this.kabei.visible=true;
		this.offAll("click");
		this.hun.centerX=this.hun.centerY=0;
		if(snum==0){
			this.hun.visible=false;
		}
	}

	__proto.showParticles=function(){
		Laya.loader.load("TestParticles.part",Handler.create(this,this.onAssetsLoaded),null,"json");
	}

	__proto.stopParticles=function(){
		this.sp.stop();
	}

	//
	__proto.onAssetsLoaded=function(settings){
		this.sp=new Particle2D(settings);
		this.sp.emitter.start();
		this.sp.play();
		this.sp.x=this.width/2;
		this.sp.y=this.height/2;
		this.addChildAt(this.sp,0);
	}

	return ZhaomuAnimation;
})(zhaomukaUI)


//class huamao.panel.zudui.ZuduiItem extends ui.SLGGAME.npc_yqhy0UI
var ZuduiItem=(function(_super){
	function ZuduiItem(){
		this.mapCityAction=null;
		this.mapCitySession=null;
		this.friendSession=null;
		this._state=0;
		this._head=null;
		this.playerData=null;
		ZuduiItem.__super.call(this);
		App.injOne(this);
		this.txto.visible=false;
		this.yqh.visible=false;
		this.yaoqing.visible=false;
		this._head=new Image();
		this._head.size(60,60);
		this.box0.addChild(this._head);
		this.yaoqing.clickHandler=new Handler(this,this.onYaoqing);
		this.yqh.clickHandler=new Handler(this,this.onYaoqinghan);
	}

	__class(ZuduiItem,'huamao.panel.zudui.ZuduiItem',_super);
	var __proto=ZuduiItem.prototype;
	__proto.onYaoqinghan=function(){
		var normalAlert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
		normalAlert.setAll("邀请函",this.playerData.playerName+" 邀请您开始新的征程",new Handler(this,this.onTongyi),new Handler(this,this.onJujue));
	}

	__proto.onTongyi=function(){
		this.mapCityAction.onTongyiYaoqing(this.playerData.playerId);
	}

	__proto.onJujue=function(){
		this.mapCityAction.onJujueYaoqing(this.playerData.playerId);
	}

	__proto.update=function(data){
		this.playerData=data;
		this.namr0.text=data.playerName;
		this._head.skin=GameUtils.getHeadUrl(data.style);
		var friendData=this.friendSession.getFriend(data.playerId);
		if(friendData.checkState(16)){
			this.yqh.visible=true;
			this.yaoqing.visible=false;
		}
		else{
			this.yqh.visible=false;
			this.yaoqing.visible=true;
			if(this.mapCitySession.invitedPlayerId==this.playerData.playerId){
				this.yaoqing.label="取消邀请";
				this.yaoqing.skin="comp/G/btn_red.png";
				this._state=2;
			}
			else{
				this.yaoqing.label="邀请";
				this.yaoqing.skin="comp/G/btn_green.png";
				this._state=1;
			}
		}
	}

	__proto.onYaoqing=function(){
		if(this._state==1){
			this.mapCityAction.onYaoqing(this.playerData.playerId);
		}
		else if(this._state==2){
			this.mapCityAction.onCancelYaoqing(this.playerData.playerId);
		}
	}

	return ZuduiItem;
})(npc_yqhy0UI)


//class LoadScene extends ui.SLGGAME.loadingUI
var LoadScene=(function(_super){
	function LoadScene(){
		this.autoEvent=null;
		this.loadingText=[
		"武将先升级或先进阶都不会影响属性的成长","一旦出征便无法主动撤回,出征前请先仔细清点人马",
		"公元280年对局会强制结束，占领城池最多方获胜","凌晨1点之后，攻击玩家会消耗10倍粮草",
		"商店每4小时会自动刷新一次货物列表","每局比赛结束或完成君主任务时可获得君主经验"];
		this.nowValue=0;
		LoadScene.__super.call(this);
		this.txt1.visible=false;
		var animation=new Animation();
		animation.loadAnimation("ANI/uiAction/uiLoad.ani",null,"res/atlas/uiAction/load.atlas");
		this.addChild(animation);
		animation.pos(750,510);
		animation.play();
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("LOAD_RES",this,this.eventFun);
		this.autoEvent.add("SET_SCENE_PROGRESS",this,this.progressFun);
		this.autoEvent.add("LOAD_SCENE_AUTO",this,this.autoFun);
		this.centerX=0;
		this.loadingTips();
		Laya.timer.loop(2000,this,this.loadingTips);
		this.on("undisplay",this,this.clearloadingTips);
		this.txt1.centerY=120;
		this.suibian.fontSize=24;
		this.on("display",this,this.disFun);
	}

	__class(LoadScene,'LoadScene',_super);
	var __proto=LoadScene.prototype;
	__proto.disFun=function(){
		this.bar0.value=0;
	}

	__proto.loadingTips=function(){
		var imgNum=Math.floor((this.loadingText.length)*Math.random());
		this.suibian.text=this.loadingText[imgNum];
	}

	__proto.clearloadingTips=function(){
		Laya.timer.clear(this,this.loadingTips);
	}

	/**
	*假进度条
	*/
	__proto.autoFun=function(){
		Laya.timer.frameLoop(5,this,this.autoProgressFun);
		this.nowValue=0;
		this.on("undisplay",this,this.undisFun);
	}

	__proto.undisFun=function(){
		Laya.timer.clear(this,this.autoProgressFun);
	}

	__proto.autoProgressFun=function(){
		this.nowValue+=(1000/60/LoadScene.AUTO_ALL_TIME);
		this.nowValue=TheGame.betweenLoop(this.nowValue,0,1);
		this.bar0.value=this.nowValue;
	}

	__proto.progressFun=function(value){
		this.bar0.value=value;
		App.eventManager.off("LOAD_SCENE_AUTO",this,this.autoFun);
	}

	__proto.eventFun=function(o){
		this.bar0.value=o.value;
		this.txt1.text=o.text1;
		this.txt1.text=o.text2;
	}

	LoadScene.AUTO_ALL_TIME=1000;
	return LoadScene;
})(loadingUI)


//class map.AutoUpgradeLv extends ui.SLGGAME.icon_cheng0_tipsUI
var AutoUpgradeLv=(function(_super){
	function AutoUpgradeLv(){
		this.mapCityAction=null;
		this.arr=[0,30,50,80];
		AutoUpgradeLv.__super.call(this);
		App.injOne(this);
		for(var i=1;i < 4;i++){
			var check=this["b"+i];
			check.clickHandler=new Handler(this,this.onClick,[check,this.arr[i]]);
		}
	}

	__class(AutoUpgradeLv,'map.AutoUpgradeLv',_super);
	var __proto=AutoUpgradeLv.prototype;
	__proto.onClick=function(check,value){
		console.log(value);
		if(check.selected)this.mapCityAction.onAutoLv(value);
		this.removeSelf();
	}

	__proto.clear=function(){
		for(var i=1;i < 4;i++){
			var check1=this["b"+i];
			check1.selected=false;
		}
	}

	return AutoUpgradeLv;
})(icon_cheng0_tipsUI)


//class map.CityHeader extends ui.SLGGAME.cityInfoUI
var CityHeader=(function(_super){
	function CityHeader(){
		this.mapCityAction=null;
		this.cityData=null;
		this._cityCell=null;
		CityHeader.__super.call(this);
		App.injOne(this);
		this.jinbu.jinBtn.name="jinBtn";
		this.jinbu.buBtn.name="buBtn";
		this.zhenqing.chaBtn.name="chaBtn";
		this.zhenqing.qingbaoBtn.name="qingbaoBtn";
		this.mouseThrough=true;
		this.on("removed",this,this.onRemove);
	}

	__class(CityHeader,'map.CityHeader',_super);
	var __proto=CityHeader.prototype;
	__proto.onRemove=function(){
		this._cityCell.refresh();
	}

	__proto.setHeader=function(cityCell){
		this._cityCell=cityCell;
		cityCell.hideInfo();
		this.jinbu.visible=this.zhenqing.visible=this.info.visible=false;
		var cityPlayerData=cityCell.cityPlayerData;
		this.cityData=cityCell.cityData;
		var playerType=0;
		if(cityPlayerData){
			playerType=cityPlayerData.playerType;
		}
		if(playerType==CityPlayerType.KONG){
			this.setZhenChaQingbao();
		}
		else if(playerType==CityPlayerType.SELF){
			console.log("进城按钮",Laya.loader.getRes("comp/G/btn_jc.png"),this.jinbu.jinBtn.visible,this.jinbu.jinBtn.parent,this.jinbu.jinBtn.alpha,this.jinbu.jinBtn.x,this.jinbu.jinBtn.y);
			console.log("部队按钮",Laya.loader.getRes("comp/G/btn_bd.png"),this.jinbu.buBtn.visible,this.jinbu.buBtn.parent,this.jinbu.buBtn.alpha,this.jinbu.buBtn.x,this.jinbu.buBtn.y);
			this.jinbu.visible=true;
			this.setHeroInfo();
		}
		else if(playerType==CityPlayerType.FRIEND){
			this.setHeroInfo();
		}
		else if(playerType==CityPlayerType.ENEMY){
			this.setZhenChaQingbao();
		}
		if(this.cityData.sysCity.cityType==0){
			this.txt0.text=this.cityData.level+"级乡镇";
		}
		else{
			this.txt0.text=this.cityData.level+"级城池";
		}
		console.log("所点城池===============",this._cityCell.cityData.sysCity.cityName);
	}

	__proto.setZhenChaQingbao=function(){
		this.zhenqing.visible=true;
		if(this.cityData.heroNum==0 && this.cityData.childNum==0 && this.cityData.yubeiyiNum==0){
			this.zhenqing.qingbaoBtn.visible=false;
		}
		else{
			this.zhenqing.qingbaoBtn.visible=true;
		}
	}

	__proto.setHeroInfo=function(){
		if(this.cityData.heroNum > 0){
			this.info.visible=true;
			var arr=this.cityData.heroList;
			for(var i=0;i < 6;i++){
				var index=i+1;
				var nameTxt=this.info["wujiangmingzi"+index];
				var numTxt=this.info["bingli"+index];
				nameTxt.text=numTxt.text="";
				if(i < arr.length){
					var cityHeroData=arr[i];
					nameTxt.text=cityHeroData.sysHero.heroName;
					numTxt.text=cityHeroData.soldier+"";
					nameTxt.color=GameUtils.getHeroNameColor(cityHeroData.sysHero.heroColor);
				}
			}
		}
	}

	CityHeader.jinBtn="jinBtn";
	CityHeader.buBtn="buBtn";
	CityHeader.chaBtn="chaBtn";
	CityHeader.qingbaoBtn="qingbaoBtn";
	return CityHeader;
})(cityInfoUI)


//class map.CityInner extends ui.SLGGAME.icon_cheng0UI
var CityInner=(function(_super){
	function CityInner(){
		this.mapCityAction=null;
		this.mapCitySession=null;
		this._autoLvView=null;
		this.nenggong=null;
		this.luban=null;
		this.bagSession=null;
		this.mainPlayerSession=null;
		this.auto=null;
		this.isopen=false;
		this.lastTime=0;
		this._taishouData=null;
		this._heroDic=new Object();
		CityInner.__super.call(this);
		App.injOne(this);
		for(var i=0;i < 11;i++){
			var build=this["b"+i];
			build && build.on("click",this,this.onLvup,[i]);
			var chuizi=this["chuizi"+i];
			chuizi.play();
			chuizi.removeSelf();
			if(i < 6){
				var heroBox=this["bb"+i];
				heroBox && heroBox.on("click",this,this.onBudui);
				this._heroDic[i]=new BattleHeroDpo();
				this._heroDic[i].scale(0.4,0.4);
				this._heroDic[i].pos(0,0);
			}
		}
		this.nenggong=ConfigManager.getConfig("sys_timetake.txt",28);
		this.luban=ConfigManager.getConfig("sys_timetake.txt",27);
		this._autoLvView=new AutoUpgradeLv();
		this._autoLvView.pos(250,178);
		this._autoLvView.on("undisplay",this,this.remove);
		this.auto=new AutoEvent(this);
		App.eventManager.on("BUILD_LVUP_SUCCESS",this,this.onSuccess);
		App.eventManager.on("UPDATE_CITY_INFO",this,this.updateHero);
	}

	__class(CityInner,'map.CityInner',_super);
	var __proto=CityInner.prototype;
	//b0.x=0;
	__proto.remove=function(){
		this.isopen=false;
	}

	__proto.addView=function(){
		var cityData=this.mapCitySession.getCity(this.mapCitySession.innerCityId);
		this.updateHero(cityData,this.mapCitySession.getCityPlayer(this.mapCitySession.selfDataInfo.playerId));
	}

	__proto.onShow=function(){
		this.onStep();
		Laya.timer.loop(1000,this,this.onStep);
	}

	__proto.onHide=function(){
		Laya.timer.clear(this,this.onStep);
	}

	__proto.updateLeft=function(){
		this.check1.clickHandler=new Handler(this,this.onIsBubing);
		this.check1.selected=this.mapCitySession.isAutoBubing==1;
		this.box_check2.on("click",this,this.showView);
		this.check2.selected=this.mapCitySession.autoLvNum > 0;
		if(this.mapCitySession.autoLvNum==0){
			this.Txtcheck2.text="自动升级城池建筑";
		}
		else{
			this.Txtcheck2.text="自动升级城池建筑("+this.mapCitySession.autoLvNum+")";
		}
	}

	__proto.onIsBubing=function(){
		this.mapCityAction.onAutoBubing(this.check1.selected ? 1 :0);
	}

	__proto.showView=function(){
		if(!this.isopen){
			this.check2.selected=false;
			this.mapCityAction.onAutoLv(0);
			this._autoLvView.clear();
			this.addChild(this._autoLvView);
			Laya.timer.once(10*1000,this,this.removeView);
			this.isopen=true;
		}
		else{
			this._autoLvView.removeSelf();
			Laya.timer.clear(this,this.removeView);
			this.isopen=false;
		}
	}

	__proto.removeView=function(){
		this._autoLvView.removeSelf();
	}

	__proto.updateHero=function(cityData,playerData){
		if(!cityData || cityData.cityId !=this.mapCitySession.innerCityId){
			return;
		}
		console.log("城内的武将",cityData.sysCity.cityName,cityData.heroList.length);
		var urlArr=[];
		for(var i=0;i < 6;i++){
			var heroBox=this["bb"+i];
			heroBox.removeChildren();
			if(i < cityData.heroList.length){
				var heroData=cityData.heroList[i];
				var sys=ConfigManager.getConfig("sys_force.txt",heroData.soldierType);
				var url=sys.forceResource+".atlas";
				if(urlArr.indexOf(url)==-1){
					urlArr.push(url);
				}
			}
		}
		App.loaderManager.load("BATTLE_CLIP",urlArr,new Handler(this,this.onLoadResCom,[cityData]));
	}

	__proto.onLoadResCom=function(cityData){
		for(var i=0;i < 6;i++){
			var heroBox=this["bb"+i];
			heroBox.removeChildren();
			if(i < cityData.heroList.length){
				var heroData=cityData.heroList[i];
				var heroPlayer=this._heroDic[i];
				heroBox.addChild(heroPlayer);
				heroPlayer.setHero(heroData,0);
			}
		}
	}

	__proto.onBudui=function(){
		App.dialogManager.openDialogByStr("CITY_BUDUI",{cityId:this.mapCitySession.innerCityId,isShowBtn:true},true,true);
	}

	__proto.onStep=function(){
		var buildData1;
		for(var $each_buildData1 in this.mapCitySession.timeObj){
			buildData1=this.mapCitySession.timeObj[$each_buildData1];
			var buildData=this.mapCitySession.getBuildDataByIndex(buildData1.index);
			var timeBox=this["time"+buildData.index];
			var timeTxt=this["shijian"+buildData.index];
			var chuizi=this["chuizi"+buildData.index];
			if(buildData.endTime > 0){
				timeBox.visible=true;
				timeTxt.text=GameUtils.time(buildData.endTime);
				this.addChild(chuizi);
			}
			else{
				delete this.mapCitySession.timeObj[buildData.index];
				timeBox.visible=false;
				timeTxt.text="1111111";
				chuizi.removeSelf();
				if(this.lastTime !=0 && Browser.now()-this.lastTime < 1000){
					return;
				}
				this.lastTime=Browser.now();
				App.voiceManager.playSound("buildover.wav");
			}
		}
	}

	__proto.onSuccess=function(buildData){
		var timeBox=this["time"+buildData.index];
		var timeTxt=this["shijian"+buildData.index];
		var chuizi=this["chuizi"+buildData.index];
		chuizi.removeSelf();
		var build=this["b"+buildData.index];
		if(buildData.index==0){
			this._taishouData=buildData;
			this.name0.text=""+buildData.lv;
			timeBox.visible=false;
			if(buildData.endTime > 0){
				timeBox.visible=true
				timeTxt.text=""+GameUtils.time(buildData.endTime);
			}
		}
		else{
			console.log("小建筑"+buildData.index);
			if(SmallTaskView.isDiaoChanTip){
				App.eventManager.event("SENDDIAOCHANTIP");
			};
			var buildName=this["buildName"+buildData.index];
			timeBox.visible=buildName.visible=false;
			build.skin="comp/G/btn_4.png";
			if(buildData.isHas==1){
				build.selected=true;
				build.selected=false;
				timeBox.visible=buildName.visible=true;
				buildName.text=buildData.sysBuilding.buildName;
				build.skin="comp/G/btn_"+buildData.type+".png";
				timeBox.visible=buildData.endTime > 0;
				timeTxt.text=""+GameUtils.time(buildData.endTime);
			}
		}
		if(buildData.endTime > 0){
			this.addChild(chuizi);
		}
	}

	__proto.useHandler=function(type){
		UseJice.ins.close();
		if(type==0){
			var num=this.bagSession.getItemNumByItemId(4005);
			if(num==0){
				var openFunctionSession=App.getSession("openFunctionSession");
				if(openFunctionSession.isFunction("jice")){
					return;
				}
				App.dialogManager.openDialogByStr("DIALOG_STRATAGEM",null,true,true);
				return;
			}
		}
		else if(type==1){
			if(this.mainPlayerSession.mainPlayerData.gold < this.nenggong.timeCd){
				FlyUpTips.setTips("元宝不足");
				return;
			}
			if(UseJiceTips.NengGongQiaoJiang_IFVIEW){
				var tips=App.dialogManager.showMiniDialog(UseJiceTips,true,true);
				tips.setHandler(4005,this.nenggong.timeCd,new Handler(this,this.useJiceTipsCB,[type]));
				return;
			}
		}
		this.useJiceTipsCB(type);
	}

	__proto.useJiceTipsCB=function(type){
		App.voiceManager.playSound("buildover.wav");
		this.mapCityAction.onNenggong(type);
	}

	__proto.useHandler2=function(type){
		UseJice.ins.close();
		if(type==0){
			var num=this.bagSession.getItemNumByItemId(4006);
			if(num==0){
				var openFunctionSession=App.getSession("openFunctionSession");
				if(openFunctionSession.isFunction("jice")){
					return;
				}
				App.dialogManager.openDialogByStr("DIALOG_STRATAGEM",null,true,true);
				return;
			}
		}
		else if(type==1){
			if(this.mainPlayerSession.mainPlayerData.gold < this.luban.timeCd){
				FlyUpTips.setTips("元宝不足");
				return;
			}
			if(UseJiceTips.LuBanZaiShi_IFVIEW){
				var tips=App.dialogManager.showMiniDialog(UseJiceTips,true,true);
				tips.setHandler(4006,this.luban.timeCd,new Handler(this,this.useJiceTipsCB2,[type]));
				return;
			}
		}
		this.useJiceTipsCB2(type);
	}

	__proto.useJiceTipsCB2=function(type){
		App.voiceManager.playSound("buildover.wav");
		this.mapCityAction.onLuban(type);
	}

	__proto.onLvup=function(index){
		var buildData1=this.mapCitySession.getBuildDataByIndex(index);
		if(buildData1.endTime > 0){
			if(index==0){
				UseJice.ins.onUse(4006,this.luban.timeCd,new Handler(this,this.useHandler2,[0]),new Handler(this,this.useHandler2,[1]));
			}
			else{
				UseJice.ins.onUse(4005,this.nenggong.timeCd,new Handler(this,this.useHandler,[0]),new Handler(this,this.useHandler,[1]));
			}
			return;
		}
		if(index==0){
			App.dialogManager.openDialogByStr("CITY_BUILD_LVUP",{buildData:buildData1},true,true);
		}
		else{
			if(this.mapCitySession.ckeckCityBuildByIndex(index)){
				App.dialogManager.openDialogByStr("CITY_BUILD_LVUP",{buildData:buildData1},true,true);
			}
			else{
				App.dialogManager.openDialogByStr("CITY_BUILD_CREATE",{buildData:buildData1},true,true);
			}
		}
	}

	__proto.update=function(){
		this.onShow();
		var data;
		for(var $each_data in this.mapCitySession.innerBuildObj){
			data=this.mapCitySession.innerBuildObj[$each_data];
			this.onSuccess(data);
		}
		this.updateLeft();
	}

	return CityInner;
})(icon_cheng0UI)


//class map.HomePage extends ui.SLGGAME.npcUI
var HomePage=(function(_super){
	function HomePage(){
		this.mapCityAction=null;
		this.mainPlayerSession=null;
		this._zudui=null;
		this._talksArr=[];
		this._content=null;
		this._count=0;
		HomePage.__super.call(this);
		App.injOne(this);
		var arr=ConfigManager.getDataArr("sys_tips.txt");
		var tips;
		for(var $each_tips in arr){
			tips=arr[$each_tips];
			if(tips.tipsId > 2000 && tips.tipsId < 3000){
				this._talksArr.push(tips);
			}
		}
		this._zudui=new ZuduiView();
		Laya.stage.on("resize",this,this.onResize);
		this.on("display",this,this.onDis);
		this.on("undisplay",this,this.onUndis);
		this.onClick()
	}

	__class(HomePage,'map.HomePage',_super);
	var __proto=HomePage.prototype;
	__proto.kaishiFun=function(){
		this.mapCityAction.onStart();
	}

	__proto.zuDuiFun=function(){
		this.mapCityAction.onZudui();
	}

	__proto.update=function(){
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this.mainPlayerSession.mainPlayerData.job);
		var sys=ConfigManager.getConfig("sys_match.txt",sysTitle.titleRoom);
		if(sys !=null){
		}
	}

	// jinru.text=sys.roomDescribe;
	__proto.onDis=function(){}
	__proto.onUndis=function(){}
	__proto.onResize=function(){
		this.size(Laya.stage.width,Laya.stage.height);
	}

	__proto.onClick=function(){
		this.addChild(this._zudui);
		this._zudui.update();
		this._zudui.centerX=0-70;
		this._zudui.centerY=20;
	}

	__proto.onRandom=function(){
		this._count=0;
		var index=Math.floor((this._talksArr.length *Math.random()));
		var tips=this._talksArr[index];
		this._content=tips.tipsDescribe;
		this.onTxt();
	}

	__proto.onTxt=function(){
		this._count++;
		if(this._count < this._content.length){
			Laya.timer.once(50,this,this.onTxt);
		}
	}

	return HomePage;
})(npcUI)


//class map.ZuduiView extends ui.SLGGAME.npc_0UI
var ZuduiView=(function(_super){
	function ZuduiView(){
		this.mapCitySession=null;
		this.mapCityAction=null;
		this.mainPlayerSession=null;
		this.strTip="";
		this._curJob=0;
		this.item=[];
		ZuduiView.__super.call(this);
		App.injOne(this);
		this.fanhui.clickHandler=new Handler(this,this.onClose);
		this.zudui.clickHandler=new Handler(this,this.onZudui);
		this.kaishi.clickHandler=new Handler(this,this.onStart);
		this.leftBtn.clickHandler=new Handler(this,this.onPage,[-1]);
		this.rightBtn.clickHandler=new Handler(this,this.onPage,[1]);
		this.tips0.clickHandler=new Handler(this,this.tipsFuc);
		this.fanhui.visible=false;
		App.eventManager.on("FLUSH_PLAYER_JOB",this,this.update)
	}

	__class(ZuduiView,'map.ZuduiView',_super);
	var __proto=ZuduiView.prototype;
	__proto.tipsFuc=function(){
		FlyLittleUpTips.setTips(this.strTip);
	}

	__proto.onPage=function(type){
		this._curJob+=type;
		this._curJob=Math.max(this._curJob,1002);
		this._curJob=Math.min(this._curJob,1009);
		this.setPage();
	}

	__proto.onClose=function(){
		this.removeSelf();
	}

	__proto.onZudui=function(){
		this.mapCityAction.onZudui();
	}

	__proto.onStart=function(){
		this.mapCityAction.onStart();
		App.eventManager.event("START_NEW_GAME");
	}

	__proto.update=function(){
		this._curJob=this.mainPlayerSession.mainPlayerData.job;
		this.setPage();
	}

	__proto.setPage=function(){
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this._curJob);
		var sys=ConfigManager.getConfig("sys_match.txt",sysTitle.titleRoom);
		if(sys !=null){
			this.shu0.text=sys.roomLevel+"";
			this.guanzhia.skin="comp/npc/qu"+sys.titleId+".png";
			this.zhiyou.text=sys.roomDescribe;
			var sysTip=ConfigManager.getConfig("sys_tips.txt",sys.roomContent);
			if(sysTip !=null){
				this.strTip=sysTip.tipsDescribe;
				console.log(this.strTip);
				this.item=this.strTip.split("\n");
				console.log("item[0]:"+this.item[0]+"item[1]:"+this.item[1]);
				var txt=new Text();
				this.strTip=sysTip.tipsDescribe;
			}
		}
		else{
			console.log("sys_match.txt表里次官职的数据,官职id:"+this._curJob);
		}
		this.zudui.visible=this.mainPlayerSession.mainPlayerData.job==this._curJob;
		this.kaishi.visible=this.mainPlayerSession.mainPlayerData.job==this._curJob;
		this.leftBtn.visible=this._curJob > 1002;
		this.rightBtn.visible=this._curJob < 1009;
		var replace=((this._curJob-1)+"").replace("100","");
		this.dituae.skin=null;
		this.dituae.skin="res/load/npc/p"+replace+".jpg";
	}

	ZuduiView.min=1002;
	ZuduiView.max=1009;
	return ZuduiView;
})(npc_0UI)


//class scene.LoginScene extends ui.SLGGAME.LoginUI
var LoginScene=(function(_super){
	function LoginScene(){
		this.role=null;
		this.qi=null;
		this.guang=null;
		this.loding_dongUI2=null;
		LoginScene.__super.call(this);
		this.role=new DragonBonesMc(false,false);
		this.role.setUrl("res/load/dengluqt.sk");
		this.role.pos(685,360);
		this.addChild(this.role);
		this.qi=new DragonBonesMc(false,false);
		this.qi.setUrl("res/load/dengluq.sk");
		this.qi.pos(683,390);
		this.addChild(this.qi);
		this.guang=new DragonBonesMc(false);
		this.guang.setUrl("res/load/denglu.sk");
		this.guang.pos(701,377);
		this.addChild(this.guang);
		var label=new Label();
		label.color="#ffffff";
		label.text=MyGameInit.VER;
		label.stroke=2;
		this.addChild(label);
		label.centerX=0;
		label.bottom=0;
		this.sao.on("loaded",this,this.loadFun);
		this.comFun();
	}

	__class(LoginScene,'scene.LoginScene',_super);
	var __proto=LoginScene.prototype;
	__proto.comFun=function(){
		this.sao.alpha=0;
		this.goBtn.alpha=0;
		this.visible=false;
		this.loding_dongUI2=new loding_dongUI();
		this.loding_dongUI2.centerX=0;
		this.loding_dongUI2.ani1.play(0,false);
		this.loding_dongUI2.ani1.on("complete",this,this.dongCom);
		Laya.stage.addChild(this.loding_dongUI2);
	}

	__proto.hideGoBtn=function(){
		this.goBtn.visible=false;
		this.sao.visible=false;
	}

	__proto.dongCom=function(){
		this.visible=true;
		if(this.loding_dongUI2){
			this.loding_dongUI2.ani1.stop();
			this.loding_dongUI2.removeSelf();
			this.loding_dongUI2.destroy();
			this.loding_dongUI2=null;
		};
		var tw=Tween.to(this.sao,{alpha:1},500);
		var tw2=Tween.to(this.goBtn,{alpha:1},500);
	}

	__proto.clickFun=function(a){
		a.play(0,false);
	}

	__proto.loadFun=function(){
		Laya.timer.loop(2000,this,this.playOnce);
		this.playOnce();
		this.on("undisplay",this,this.undisFun);
	}

	__proto.undisFun=function(){
		Laya.timer.clear(this,this.playOnce);
		Laya.loader.clearResByGroup("LOGIN_GROUP");
		this.role.dispose();
		this.qi.dispose();
		this.guang.dispose();
	}

	__proto.playOnce=function(){
		this.sao.play(0,this.sao.total-1);
	}

	LoginScene.GROUP="LOGIN_GROUP";
	return LoginScene;
})(LoginUI)


//class huamao.utils.GameTab extends laya.ui.Tab
var GameTab=(function(_super){
	function GameTab(tab){
		GameTab.__super.call(this);
		this.x=tab.x;
		this.y=tab.y;
		this.width=tab.width;
		this.height=tab.height;
		this.labels=tab.labels;
		this.skin=tab.skin;
		this.direction=tab.direction;
		this.space=tab.space;
		this.labelBold=tab.labelBold;
		this.labelColors=tab.labelColors;
		this.labelFont=tab.labelFont;
		this.labelPadding=tab.labelPadding;
		this.labelSize=tab.labelSize;
		this.labelStrokeColor=tab.labelStrokeColor;
		this.labelSize=tab.labelSize;
		this.labelSize=tab.labelSize;
		this.scaleX=tab.scaleX;
		this.scaleY=tab.scaleY;
		tab.visible=false;
	}

	__class(GameTab,'huamao.utils.GameTab',_super);
	var __proto=GameTab.prototype;
	/**
	*隐藏按钮
	*@param index 初始index是多少 始终是多少
	*
	*/
	__proto.setDelItem=function(index){
		var item=this._items [index];
		if(item){
			item.visible=false;
			this.upDataPosition(index,item,false);
		}
	}

	/**
	*显示按钮
	*@param index 初始index是多少 始终是多少
	*
	*/
	__proto.setAddItem=function(index){
		var item=this._items [index];
		if(item){
			item.visible=true;
			this.upDataPosition(index,item,true);
		}
	}

	__proto.upDataPosition=function(index,item,isadd){
		var num=0;
		if (this._direction=="horizontal"){
			num=item.width;
			}else {
			num=item.height;
		}
		for (var i=index+1,n=this._items.length;i < n;i++){
			var child=this._items [i];
			if (this._direction=="horizontal"){
				isadd==true ? child.x+=item.width+this._space :child.x-=item.width+this._space;
				}else {
				isadd==true ? child.y+=item.height+this._space :child.y-=item.height+this._space;
			}
		}
	}

	__proto.changeLabels=function(){
		this._labelChanged=false;
		if (this._items){
			var left=0
			for (var i=0,n=this._items.length;i < n;i++){
				var btn=this._items [i];
				this._skin && (btn.skin=this._skin);
				this._labelColors && (btn.labelColors=this._labelColors);
				this._labelSize && (btn.labelSize=this._labelSize);
				this._labelStroke && (btn.labelStroke=this._labelStroke);
				this._labelStrokeColor && (btn.labelStrokeColor=this._labelStrokeColor);
				this._strokeColors && (btn.strokeColors=this._strokeColors);
				this._labelBold && (btn.labelBold=this._labelBold);
				this._labelPadding && (btn.labelPadding=this._labelPadding);
				this._labelAlign && (btn.labelAlign=this._labelAlign);
				this._stateNum && (btn.stateNum=this._stateNum);
				this.labelFont && (btn.labelFont=this.labelFont);
				if(btn.visible){
					if (this._direction==="horizontal"){
						btn.y=0;
						btn.x=left;
						left+=btn.width+this._space;
						}else {
						btn.x=0;
						btn.y=left;
						left+=btn.height+this._space;
					}
				}
			}
		}
		this.changeSize();
	}

	return GameTab;
})(Tab)


/**
*...
*@author ww
*/
//class laya.debug.uicomps.RankListItem extends laya.debug.ui.debugui.comps.RankListItemUI
var RankListItem=(function(_super){
	function RankListItem(){
		RankListItem.__super.call(this);
		Base64AtlasManager.replaceRes(RankListItemUI.uiView);
		this.createView(RankListItemUI.uiView);
	}

	__class(RankListItem,'laya.debug.uicomps.RankListItem',_super);
	var __proto=RankListItem.prototype;
	__proto.createChildren=function(){}
	return RankListItem;
})(RankListItemUI)


/**
*...
*@author ww
*/
//class laya.debug.uicomps.TreeListItem extends laya.debug.ui.debugui.comps.ListItemUI
var TreeListItem=(function(_super){
	function TreeListItem(){
		TreeListItem.__super.call(this);
		Base64AtlasManager.replaceRes(ListItemUI.uiView);
		this.createView(ListItemUI.uiView);
	}

	__class(TreeListItem,'laya.debug.uicomps.TreeListItem',_super);
	var __proto=TreeListItem.prototype;
	__proto.createChildren=function(){}
	return TreeListItem;
})(ListItemUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.DebugPage extends laya.debug.ui.debugui.DebugPanelUI
var DebugPage=(function(_super){
	function DebugPage(){
		this.views=null;
		DebugPage.__super.call(this);
		this.msRec=new Rectangle();
		Base64AtlasManager.replaceRes(DebugPanelUI.uiView);
		this.createView(DebugPanelUI.uiView);
		DisControlTool.setResizeAbleEx(this);
		this.views=[this.treePanel,this.selectPanel,this.profilePanel];
		this.tab.selectedIndex=0;
		this.tabChange();
		this.tab.on("change",this,this.tabChange);
		this.changeSize();
	}

	__class(DebugPage,'laya.debug.view.nodeInfo.nodetree.DebugPage',_super);
	var __proto=DebugPage.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
	}

	__proto.tabChange=function(){
		DisControlTool.addOnlyByIndex(this.views,this.tab.selectedIndex,this);
		DisControlTool.setTop(this.resizeBtn);
	}

	__proto.changeSize=function(){
		if (this.width < 245){
			this.width=245;
		}
		if (this.height < 100){
			this.height=200;
		}
		laya.ui.Component.prototype.changeSize.call(this);
		this.msRec.setTo(0,0,this.width,this.height);
		this.scrollRect=this.msRec;
	}

	return DebugPage;
})(DebugPanelUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.FindNodeSmall extends laya.debug.ui.debugui.FindNodeSmallUI
var FindNodeSmall=(function(_super){
	function FindNodeSmall(){
		FindNodeSmall.__super.call(this);
		Base64AtlasManager.replaceRes(FindNodeSmallUI.uiView);
		this.createView(FindNodeSmallUI.uiView);
	}

	__class(FindNodeSmall,'laya.debug.view.nodeInfo.nodetree.FindNodeSmall',_super);
	var __proto=FindNodeSmall.prototype;
	__proto.createChildren=function(){}
	return FindNodeSmall;
})(FindNodeSmallUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.FindNode extends laya.debug.ui.debugui.FindNodeUI
var FindNode=(function(_super){
	function FindNode(){
		FindNode.__super.call(this);
		Base64AtlasManager.replaceRes(FindNodeUI.uiView);
		this.createView(FindNodeUI.uiView);
	}

	__class(FindNode,'laya.debug.view.nodeInfo.nodetree.FindNode',_super);
	var __proto=FindNode.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
	}

	return FindNode;
})(FindNodeUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.MinBtnComp extends laya.debug.ui.debugui.MinBtnCompUI
var MinBtnComp=(function(_super){
	function MinBtnComp(){
		this.tar=null;
		this.minHandler=null;
		this.maxHandler=null;
		this.prePos=new Point();
		MinBtnComp.__super.call(this);
		Base64AtlasManager.replaceRes(MinBtnCompUI.uiView);
		this.createView(MinBtnCompUI.uiView);
		this.init();
	}

	__class(MinBtnComp,'laya.debug.view.nodeInfo.nodetree.MinBtnComp',_super);
	var __proto=MinBtnComp.prototype;
	__proto.createChildren=function(){}
	__proto.init=function(){
		this.minBtn.on("click",this,this.onMinBtn);
		this.maxBtn.on("click",this,this.onMaxBtn);
		this.minState=false;
		this.maxUI.removeSelf();
		DisControlTool.setDragingItem(this.bg,this.maxUI);
	}

	__proto.onMaxBtn=function(){
		this.maxUI.removeSelf();
		if (this.maxHandler){
			this.maxHandler.run();
		}
		if (this.tar){
			this.tar.x+=this.maxUI.x-this.prePos.x;
			this.tar.y+=this.maxUI.y-this.prePos.y;
		}
	}

	__proto.onMinBtn=function(){
		if (!this.displayedInStage)return;
		var tPos;
		tPos=Point.TEMP;
		tPos.setTo(0,0);
		tPos=this.localToGlobal(tPos);
		tPos=DebugInfoLayer.I.popLayer.globalToLocal(tPos);
		this.maxUI.pos(tPos.x,tPos.y);
		DebugInfoLayer.I.popLayer.addChild(this.maxUI);
		if (this.tar){
			this.prePos.setTo(tPos.x,tPos.y);
		}
		if (this.minHandler){
			this.minHandler.run();
		}
	}

	__getset(0,__proto,'minState',null,function(v){
	});

	return MinBtnComp;
})(MinBtnCompUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.NodeListPanel extends laya.debug.ui.debugui.NodeListPanelUI
var NodeListPanel=(function(_super){
	function NodeListPanel(){
		NodeListPanel.__super.call(this);
		Base64AtlasManager.replaceRes(NodeListPanelUI.uiView);
		this.createView(NodeListPanelUI.uiView);
	}

	__class(NodeListPanel,'laya.debug.view.nodeInfo.nodetree.NodeListPanel',_super);
	var __proto=NodeListPanel.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
	}

	return NodeListPanel;
})(NodeListPanelUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.NodeTool extends laya.debug.ui.debugui.NodeToolUI
var NodeTool=(function(_super){
	function NodeTool(){
		NodeTool.__super.call(this);
		Base64AtlasManager.replaceRes(NodeToolUI.uiView);
		this.createView(NodeToolUI.uiView);
	}

	__class(NodeTool,'laya.debug.view.nodeInfo.nodetree.NodeTool',_super);
	var __proto=NodeTool.prototype;
	__proto.createChildren=function(){}
	return NodeTool;
})(NodeToolUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.NodeTreeSetting extends laya.debug.ui.debugui.NodeTreeSettingUI
var NodeTreeSetting=(function(_super){
	function NodeTreeSetting(){
		NodeTreeSetting.__super.call(this);
		Base64AtlasManager.replaceRes(NodeTreeSettingUI.uiView);
		this.createView(NodeTreeSettingUI.uiView);
	}

	__class(NodeTreeSetting,'laya.debug.view.nodeInfo.nodetree.NodeTreeSetting',_super);
	var __proto=NodeTreeSetting.prototype;
	//inits();
	__proto.createChildren=function(){}
	return NodeTreeSetting;
})(NodeTreeSettingUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.NodeTree extends laya.debug.ui.debugui.NodeTreeUI
var NodeTree=(function(_super){
	function NodeTree(){
		this.showProps=false;
		this._closeSettingHandler=null;
		this._tar=null;
		NodeTree.__super.call(this);
		Base64AtlasManager.replaceRes(NodeTreeUI.uiView);
		View.regComponent("Tree",TreeBase);
		this.createView(NodeTreeUI.uiView);
		View.regComponent("Tree",Tree);
		this.inits();
		NodeTree.I=this;
	}

	__class(NodeTree,'laya.debug.view.nodeInfo.nodetree.NodeTree',_super);
	var __proto=NodeTree.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
	}

	__proto.inits=function(){
		this.nodeTree.list.scrollBar.hide=true;
		this.nodeTree.list.selectEnable=true;
		this.settingBtn.on("click",this,this.onSettingBtn);
		this.freshBtn.on("click",this,this.fresh);
		this.closeBtn.on("click",this,this.onCloseBtn);
		this.fliterTxt.on("enter",this,this.onFliterTxtChange);
		this.fliterTxt.on("blur",this,this.onFliterTxtChange);
		NodeMenu.I.setNodeListAction(this.nodeTree.list);
		this.nodeTree.list.on("click",this,this.onListClick,[this.nodeTree.list]);
		this.nodeTree.renderHandler=new Handler(this,this.treeRender);
		this._closeSettingHandler=new Handler(this,this.closeSetting);
		this.onIfShowPropsChange();
		this.ifShowProps.on("change",this,this.onIfShowPropsChange);
	}

	__proto.onIfShowPropsChange=function(){
		this.showProps=this.ifShowProps.selected;
		this.fresh();
	}

	__proto.onListClick=function(list){
		if (list.selectedItem){
			if (list.selectedItem.isDirectory){
				list.selectedItem.isOpen=!list.selectedItem.isOpen;
				this.nodeTree.fresh();
			}
		}
	}

	//}
	__proto.onFindBtn=function(){
		FindSmallView.I.show();
	}

	__proto.onCloseBtn=function(){
		this.removeSelf();
	}

	__proto.onTreeDoubleClick=function(e){
		if (this.nodeTree.selectedItem){
			var tarNode;
			tarNode=this.nodeTree.selectedItem.path;
			NodeMenu.I.objRightClick(tarNode);
		}
	}

	//}
	__proto.onTreeRightMouseDown=function(e){
		if (this.nodeTree.selectedItem){
			var tarNode;
			tarNode=this.nodeTree.selectedItem.path;
			NodeMenu.I.objRightClick(tarNode);
		}
	}

	//}
	__proto.onSettingBtn=function(){
		NodeTreeSettingView.I.showSetting(NodeTree.showKeys,this._closeSettingHandler,this._tar);
	}

	__proto.closeSetting=function(newKeys){
		NodeTree.showKeys=newKeys;
		this.fresh();
	}

	__proto.onFliterTxtChange=function(e){
		var key;
		key=this.fliterTxt.text;
		if (key=="")return;
		if (key !=NodeTree.showKeys.join(",")){
			NodeTree.showKeys=key.split(",");
			this.fresh();
		}
		return;
		this.selecteByFile(key);
	}

	__proto.selecteByFile=function(key){
		var arr;
		arr=this.nodeTree.source;
		var rsts;
		rsts=DebugTool.findNameHas(key,false);
		if (rsts && rsts.length > 0){
			var tar;
			tar=rsts[0];
			this.parseOpen(arr,tar);
		}
	}

	__proto.showSelectInStage=function(node){
		this.setDis(Laya.stage);
		this.selectByNode(node);
	}

	__proto.selectByNode=function(node){
		if (!node)return;
		var arr;
		arr=this.nodeTree.source;
		this.parseOpen(arr,node);
	}

	__proto.showNodeList=function(nodeList){
		if (!nodeList)return;
		var i=0,len=0;
		len=nodeList.length;
		var showList;
		showList=[];
		var tData;
		var tSprite;
		for (i=0;i < len;i++){
			tSprite=nodeList[i];
			tData={};
			tData.label=ClassTool.getNodeClassAndName(tSprite);
			tData.path=tSprite;
			showList.push(tData);
		}
		this.nodeTree.array=showList;
	}

	__proto.parseOpen=function(tree,node){
		if (tree.length < 1)return;
		if (!node)return;
		var i=0,len=0;
		len=tree.length;
		var tItem;
		for(i=0;i<len;i++){
			tItem=tree[i];
			if(tItem.path==node){
				var sItem;
				sItem=tItem;
				while (tItem){
					tItem.isOpen=true;
					this.nodeTree.fresh();
					tItem=tItem.nodeParent;
				}
				this.nodeTree.selectedItem=sItem;
				return;
			}
		}
	}

	/**
	*@private
	*获取数据源中指定键名的值。
	*/
	__proto.getFilterSource=function(array,result,key){
		key=key.toLocaleLowerCase();
		var item;
		for(var $each_item in array){
			item=array[$each_item];
			if (item.isDirectory && String(item.label).toLowerCase().indexOf(key)>-1){
				item.x=0;
				result.push(item);
			}
			if (item.child && item.child.length > 0){
				this.getFilterSource(item.child,result,key);
			}
		}
	}

	__proto.onControlDown=function(){
		this.startDrag();
	}

	__proto.setDis=function(sprite){
		this._tar=sprite;
		this.fresh();
	}

	__proto.fresh=function(){
		var preTar;
		if (this.nodeTree.selectedItem){
			var tItem;
			tItem=this.nodeTree.selectedItem;
			while (tItem && (! (tItem.path instanceof laya.display.Sprite ))){
				tItem=tItem.nodeParent;
			}
			if (tItem && tItem.path){
				preTar=tItem.path;
			}
		}
		if (!this._tar){
			this.nodeTree.array=[];
			}else{
			this.nodeTree.array=NodeUtils.getNodeTreeData(this._tar,this.showProps?NodeTree.showKeys:NodeTree.emptyShowKey);
		}
		if (preTar){
			this.selectByNode(preTar);
		}
	}

	__proto.treeRender=function(cell,index){
		var item=cell.dataSource;
		if (item){
			var isDirectory=item.child || item.isDirectory;
			var label=cell.getChildByName("label");
			if ((item.path instanceof laya.display.Node )){
				label.color="#09a4f6";
				}else{
				if (item.isChilds){
					label.color="#00ff11";
					}else{
					label.color="#838bc5";
				}
			}
		}
	}

	NodeTree.I=null;
	NodeTree.emptyShowKey=[];
	__static(NodeTree,
	['showKeys',function(){return this.showKeys=["x","y","width","height","renderCost"];}
	]);
	return NodeTree;
})(NodeTreeUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.ObjectCreate extends laya.debug.ui.debugui.ObjectCreateUI
var ObjectCreate=(function(_super){
	function ObjectCreate(){
		ObjectCreate.__super.call(this);
		Base64AtlasManager.replaceRes(ObjectCreateUI.uiView);
		this.createView(ObjectCreateUI.uiView);
	}

	__class(ObjectCreate,'laya.debug.view.nodeInfo.nodetree.ObjectCreate',_super);
	var __proto=ObjectCreate.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
	}

	return ObjectCreate;
})(ObjectCreateUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.ObjectInfo extends laya.debug.ui.debugui.ObjectInfoUI
var ObjectInfo=(function(_super){
	function ObjectInfo(){
		ObjectInfo.__super.call(this);
		Base64AtlasManager.replaceRes(ObjectInfoUI.uiView);
		this.createView(ObjectInfoUI.uiView);
	}

	__class(ObjectInfo,'laya.debug.view.nodeInfo.nodetree.ObjectInfo',_super);
	var __proto=ObjectInfo.prototype;
	__proto.createChildren=function(){}
	return ObjectInfo;
})(ObjectInfoUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.OutPut extends laya.debug.ui.debugui.OutPutUI
var OutPut=(function(_super){
	function OutPut(){
		OutPut.__super.call(this);
		Base64AtlasManager.replaceRes(OutPutUI.uiView);
		this.createView(OutPutUI.uiView);
	}

	__class(OutPut,'laya.debug.view.nodeInfo.nodetree.OutPut',_super);
	var __proto=OutPut.prototype;
	__proto.createChildren=function(){}
	return OutPut;
})(OutPutUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.Profile extends laya.debug.ui.debugui.ProfileUI
var Profile=(function(_super){
	function Profile(){
		this.views=null;
		Profile.__super.call(this);
		Base64AtlasManager.replaceRes(ProfileUI.uiView);
		this.createView(ProfileUI.uiView);
		this.views=[this.createPanel,this.renderPanel,this.cachePanel,this.resPanel];
		this.tab.selectedIndex=0;
		this.tabChange();
		this.tab.on("change",this,this.tabChange);
	}

	__class(Profile,'laya.debug.view.nodeInfo.nodetree.Profile',_super);
	var __proto=Profile.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
	}

	__proto.tabChange=function(){
		DisControlTool.addOnlyByIndex(this.views,this.tab.selectedIndex,this);
	}

	return Profile;
})(ProfileUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.Rank extends laya.debug.ui.debugui.RankUI
var Rank=(function(_super){
	function Rank(){
		Rank.__super.call(this);
		Base64AtlasManager.replaceRes(RankUI.uiView);
		this.createView(RankUI.uiView);
	}

	__class(Rank,'laya.debug.view.nodeInfo.nodetree.Rank',_super);
	var __proto=Rank.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
	}

	return Rank;
})(RankUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.SelectInfos extends laya.debug.ui.debugui.SelectInfosUI
var SelectInfos=(function(_super){
	function SelectInfos(){
		SelectInfos.__super.call(this);
		Base64AtlasManager.replaceRes(SelectInfosUI.uiView);
		this.createView(SelectInfosUI.uiView);
	}

	__class(SelectInfos,'laya.debug.view.nodeInfo.nodetree.SelectInfos',_super);
	var __proto=SelectInfos.prototype;
	__proto.createChildren=function(){
		this.viewMapRegists();
	}

	return SelectInfos;
})(SelectInfosUI)


/**
*...
*@author ww
*/
//class laya.debug.view.nodeInfo.nodetree.ToolBar extends laya.debug.ui.debugui.ToolBarUI
var ToolBar=(function(_super){
	function ToolBar(){
		ToolBar.__super.call(this);
		Base64AtlasManager.replaceRes(ToolBarUI.uiView);
		this.createView(ToolBarUI.uiView);
	}

	__class(ToolBar,'laya.debug.view.nodeInfo.nodetree.ToolBar',_super);
	var __proto=ToolBar.prototype;
	__proto.createChildren=function(){}
	return ToolBar;
})(ToolBarUI)


//class fight.ExplainDialog extends ui.SLGGAME.tips_zc0UI
var ExplainDialog=(function(_super){
	function ExplainDialog(){
		ExplainDialog.__super.call(this);
		for (var i=1;i <=15;i++){
			var ii=i;
			if(ii==13){
				ii=11;
				}else if(ii==11){
				ii=13;
			};
			var box=this["b"+i];
			var bufferDpo=new SBufferDpo();
			box.addChild(bufferDpo);
			bufferDpo.pos(0,0);
			bufferDpo.setEffectAni("buffSeat"+ii);
		}
	}

	__class(ExplainDialog,'fight.ExplainDialog',_super);
	return ExplainDialog;
})(tips_zc0UI)


//class huamao.panel.bag.BagPanel extends ui.SLGGAME.beibaoUI
var BagPanel=(function(_super){
	function BagPanel(){
		this.tabBind=null;
		this.contentSp=null;
		BagPanel.__super.call(this);
		this.contentSp=new Sprite;
		this.addChild(this.contentSp);
		this.contentSp.pos(59,97);
		this.tabBind=new TabBind(this.tab0,this.contentSp);
		this.tabBind.addTabCell(0,ItemView,BagItemMediator);
		this.tabBind.addTabCell(1,EquipView,BagEquipMediator);
		this.tabBind.addTabCell(2,BagBox,BagBoxMediator);
	}

	__class(BagPanel,'huamao.panel.bag.BagPanel',_super);
	var __proto=BagPanel.prototype;
	__proto.show=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.show.call(this,closeOther,showEffect);
		this.tabBind.defaultIndex=0;
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
	}

	return BagPanel;
})(beibaoUI)


//class huamao.panel.bag.TipsFenJie extends ui.SLGGAME.tips_fjUI
var TipsFenJie=(function(_super){
	function TipsFenJie(){
		this.onlyid=0;
		this.bagAction=null;
		this.topItem=new Item();
		this.leftItem=new Item();
		this.rightItem=new Item();
		this.needItem=new Item();
		TipsFenJie.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsFenJie,'huamao.panel.bag.TipsFenJie',_super);
	var __proto=TipsFenJie.prototype;
	__proto.init=function(){
		this.box0.addChild(this.topItem);
		this.topItem.size(80,80);
		this.topItem.pos(-2,-2);
		this.box0.parent.addChild(this.box0);
		this.box1.addChild(this.leftItem);
		this.leftItem.size(63,63);
		this.leftItem.pos(-1,-1);
		this.box2.addChild(this.rightItem);
		this.rightItem.size(62,62);
		this.xuyao.addChild(this.needItem);
		this.needItem.size(52,52);
		this.needItem.pos(1,1);
		this.txt_box.visible=this.txt_xy.visible=this.txt1.visible=this.s1.visible=this.txt2.visible=this.s2.visible=false;
		this.fenjie.clickHandler=new Handler(this,this.fenJieCB);
	}

	__proto.fenJieCB=function(){
		this.bagAction.sendFenJie(this.onlyid);
		this.close();
	}

	__proto.flushPanel=function(data){
		this.leftItem.setItemId(data.itemId);
		this.rightItem.setItemId(data.itemId);
		this.topItem.setItemId(data.itemId);
		this.topItem.setLv(data.lv);
		this.leftItem.setLv(data.lv);
		this.rightItem.setNum(data.lv+1);
		var sysstrenght=data.getSysStrenght();
		var array=sysstrenght.strengthDecomposeItemNeed.split(",");
		var needItemId=parseInt(array[0]);
		var needItemNum=parseInt(array[1]);
		this.needItem.setItemId(needItemId);
		this.needItem.setNum(needItemNum);
		this.onlyid=data.onlyId;
	}

	return TipsFenJie;
})(tips_fjUI)


//class huamao.panel.bag.TipsGetItem extends ui.SLGGAME.tips_gxbxUI
var TipsGetItem=(function(_super){
	function TipsGetItem(){
		this.viary=[];
		this.boxW=75;
		this.boxDis=17;
		this.itemW=65;
		this.itemDis=75;
		this.midPos=0;
		this.biaoTiDragon=null;
		this.liuGuangDragon=null;
		this.skipDragon=null;
		this.Dis=this.boxW+this.boxDis;
		TipsGetItem.__super.call(this);
		this.init();
		this.on("undisplay",this,this.undisplayerCB);
	}

	__class(TipsGetItem,'huamao.panel.bag.TipsGetItem',_super);
	var __proto=TipsGetItem.prototype;
	__proto.undisplayerCB=function(){
		Laya.timer.clear(this,this.timeFun);
		this.off("undisplay",this,this.undisplayerCB);
		Laya.stage.off("click",this,this.queDingCB);
		App.setCloseDialogOnSide(true);
	}

	__proto.init=function(){
		this.midPos=this.width/2;
		this.queding.visible=false;
		this.resetBGSize(0);
		this.biaoTiDragon=new DragonBonesMc(true,false);
		this.biaoTiDragon.pos(this.width/2+15,50);
		this.biaoTiDragon.playByTimes(1,false);
		this.biaoTiDragon.setUrl("res/load/biaoti.sk");
		this.liuGuangDragon=new DragonBonesMc(false);
		this.liuGuangDragon.setUrl("res/load/liuguang.sk");
		this.liuGuangDragon.pos(this.width/2,this.height/2);
		this.skipDragon=new DragonBonesMc(false);
		this.skipDragon.setUrl("res/load/liuguang1.sk");
		this.skipDragon.pos(this.width/2,this.height+30);
		Laya.timer.once(500,this,this.timeFun);
		App.setCloseDialogOnSide(false);
	}

	__proto.timeFun=function(){
		Laya.stage.on("click",this,this.queDingCB);
	}

	__proto.queDingCB=function(event){
		if(!((event.target instanceof laya.ui.Button )))
			this.close();
	}

	__proto.resetBGSize=function(dataNum){
		var posx=this.midPos-(dataNum*this.itemW+(dataNum-1)*this.itemDis)/2;
		for(var i=0;i<dataNum;i++){
			var tt=new tips_gxbx1UI();
			tt.pos(posx+(this.itemDis+this.itemW)*i,90);
			this.viary[i]=tt;
			this.addChild(tt);
		}
	}

	__proto.setData=function(fromId,ary){
		var dataSize=ary.length/2;
		this.resetBGSize(dataSize);
		for(var i=0;i<dataSize;i++){
			var itemId=ary[i*2];
			var itemNum=ary[i*2+1];
			var ui=this.viary [i];
			var btn=ui.btn1;
			var lbl=ui.txt1;
			var img=ui.img1;
			var lbl_name=ui.getChildByName("lab");
			img.size(60,61);
			var name="";
			if(itemId>0){
				var skin=GameUtils.getItemIconPath(itemId);
				var item=SysItem.getDataFromItemId(itemId);
				lbl.text=itemNum+"";
				img.skin=skin;
				lbl_name.text=item.itemName;
				name=item.itemName;
				}else{
				var syshero=ConfigManager.getConfig("sys_hero.txt",itemNum);
				img.skin="res/item/"+syshero.heroResId+"001.png";
				lbl.text="1";
				lbl_name.text=syshero.heroName;
				name=syshero.heroName;
			}
			btn.on("click",this,this.tipsCB,[name]);
		}
		this.addChild(this.liuGuangDragon);
		this.addChild(this.skipDragon);
		Laya.timer.callLater(this,this.addBiaoTi);
	}

	__proto.tipsCB=function(name){
		FlyLittleUpTips.setTips(name);
	}

	__proto.addBiaoTi=function(){
		this.addChild(this.biaoTiDragon);
	}

	return TipsGetItem;
})(tips_gxbxUI)


//class huamao.panel.bag.TipsSell extends ui.SLGGAME.tips_tsUI
var TipsSell=(function(_super){
	function TipsSell(){
		this.remData=null;
		this.bagAction=null;
		TipsSell.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsSell,'huamao.panel.bag.TipsSell',_super);
	var __proto=TipsSell.prototype;
	__proto.init=function(){
		this.box0.visible=false;
		this.btn1.on("click",this,this.quxiaoCB);
		this.btn0.on("click",this,this.queDingCB);
	}

	__proto.setItem=function(itemdata){
		this.remData=itemdata;
		var item=ConfigManager.getConfig("sys_item.txt",this.remData.itemId);
		var itemname=item.itemName;
		this.txt1.text="确定将"+itemname+"出售?";
	}

	__proto.quxiaoCB=function(){
		this.close();
	}

	__proto.queDingCB=function(){
		this.bagAction.sellEquip(this.remData.onlyId);
		App.voiceManager.playSound("buy.wav");
		this.close();
	}

	return TipsSell;
})(tips_tsUI)


//class huamao.panel.bag.TipsStronger extends ui.SLGGAME.tips_qhUI
var TipsStronger=(function(_super){
	function TipsStronger(){
		this.mainPlayerSession=null;
		this.bagSession=null;
		this.bagAction=null;
		this.leftLables=[];
		this.rightLables=[];
		this.remOnlyId=0;
		this.curr
		TipsStronger.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsStronger,'huamao.panel.bag.TipsStronger',_super);
	var __proto=TipsStronger.prototype;
	__proto.init=function(){
		this.mouseThrough=true;
		this.anchorX=this.anchorY=0.5;
		this.pos((Laya.stage.width)*0.5,(Laya.stage.height)*0.5);
		var img_icon=this.box0.getChildByName("icon");
		if(null==img_icon){
			img_icon=new Image();
			img_icon.name="icon";
			img_icon.pos(0,0);
			img_icon.size(75,75);
			this.box0.addChild(img_icon);
		};
		var img_icon2=this.xuyao.getChildByName("icon2");
		if(null==img_icon2){
			img_icon2=new Image();
			img_icon2.name="icon2";
			img_icon2.pos(1,1);
			img_icon2.size(58,58);
			this.xuyao.addChild(img_icon2);
		};
		var btn_close=this.getChildByName("close");
		btn_close.on("click",this,this.close);
		this.qianghua.on("click",this,this.strongerCB);
		this.leftLables=[this.wei1,this.time1,this.wei3,this.time3,this.wei5,this.time5];
		this.rightLables=[this.wei2,this.time2,this.wei4,this.time4,this.wei6,this.time6];
	}

	//强化
	__proto.strongerCB=function(){
		var sysItem=ConfigManager.getConfig("sys_item.txt",this.curr.itemId);
		var sysStrength=ConfigManager.getConfig("sys_strength.txt",sysItem.itemColor+"_"+this.curr.lv);
		if(this.bagSession.getEquipNum(this.curr.onlyId,this.curr.itemId)>=sysStrength.strengthItemNum){
			App.voiceManager.playSound("qianghua.wav");
		}
		this.bagAction.sendStronger(this.remOnlyId);
		this.close();
	}

	__proto.flushLeftShuXing=function(data){
		this.txt1.text="+"+data.lv;
		this.setArrLabel(this.leftLables,data.getShuXing(0));
	}

	__proto.flushRightShuXing=function(data){
		this.txt2.text="+"+(data.lv+1);
		this.setArrLabel(this.rightLables,data.getShuXing(1));
	}

	__proto.setArrLabel=function(labelArr,shuxingary){
		for (var i=0;i < labelArr.length;i+=2){
			var la1=labelArr[i];
			var la2=labelArr[i+1];
			la1.visible=la2.visible=(i < shuxingary.length);
			if(la1.visible){
				la1.text=shuxingary[i]+"";
				la2.text="+"+shuxingary[i+1];
				la1.align="center";
			}
		}
	}

	__proto.resetBtn=function(){
		var data=this.bagSession.getEquipByOnlyId(this.remOnlyId);
		var sysItem=ConfigManager.getConfig("sys_item.txt",data.itemId);
		var sysStrength=ConfigManager.getConfig("sys_strength.txt",sysItem.itemColor+"_"+data.lv);
		var canLvUp=true;
		if(sysStrength.strengthLordLv > this.mainPlayerSession.mainPlayerData.Lv){
			canLvUp=false;
		}
		this.qianghua.visible=canLvUp;
		this.tishi.visible=!canLvUp;
		if(canLvUp==false){
			this.tishi.text="君主等级达到"+sysStrength.strengthLordLv+"才可强化";
		}
		this.txt0.visible=this.xuyao.visible=this.txt_xy.visible=canLvUp;
		if(sysStrength.strengthItemNum==-1){
			this.txt0.text="当前强化等级已满";
		}
	}

	__proto.flushPanel=function(data){
		this.curr=data;
		var itemId=data.itemId;
		var itemNum=data.itemNum;
		this.remOnlyId=data.onlyId;
		console.log("强化 itemid = "+itemId);
		var img_icon=this.box0.getChildByName("icon");
		var img_icon2=this.xuyao.getChildByName("icon2");
		img_icon.skin=img_icon2.skin=GameUtils.getItemIconPath(itemId);
		this.txt_box.text="+"+data.lv;
		var sysStrength=data.getSysStrenght();
		this.txt_xy.visible=(sysStrength.strengthItemNum !=-1);
		if(this.txt_xy.visible){
			this.txt_xy.text=this.bagSession.getEquipNum(data.onlyId,itemId)+"/"+sysStrength.strengthItemNum;
		}
		this.txt_xy.x=this.xuyao.x;
		this.txt_xy.align="right";
		this.tishi.visible=false;
		if(data.ifMaxStep()){
		}else{}
		this.resetBtn();
		this.flushLeftShuXing(data);
		this.flushRightShuXing(data);
	}

	return TipsStronger;
})(tips_qhUI)


//class huamao.panel.bag.TipsXieZaiAllEquip extends ui.SLGGAME.tips_tsUI
var TipsXieZaiAllEquip=(function(_super){
	function TipsXieZaiAllEquip(){
		this.wuJiangAction=null;
		TipsXieZaiAllEquip.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsXieZaiAllEquip,'huamao.panel.bag.TipsXieZaiAllEquip',_super);
	var __proto=TipsXieZaiAllEquip.prototype;
	__proto.init=function(){
		this.txt1.text="是否要一键卸下所有武将装备？";
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.box0.visible=false;
		this.check1.visible=false;
		this.checktext.visible=false;
	}

	__proto.queDingCB=function(){
		this.wuJiangAction.sendUninstallAllEquip();
		this.close();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	return TipsXieZaiAllEquip;
})(tips_tsUI)


//class huamao.panel.bag.TipsUseItem extends ui.SLGGAME.tips_sydjUI
var TipsUseItem=(function(_super){
	function TipsUseItem(){
		this.maxLimt=0;
		this.itemOnlyId=0;
		this.bagAction=null;
		TipsUseItem.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsUseItem,'huamao.panel.bag.TipsUseItem',_super);
	var __proto=TipsUseItem.prototype;
	__proto.init=function(){
		var img_icon=this.box0.getChildByName("icon");
		if(img_icon==null){
			img_icon=new Image();
			img_icon.name="icon";
			img_icon.size(71,70);
			img_icon.pos(2,2);
			this.box0.addChild(img_icon);
		};
		var btn_close=this.getChildByName("close")
		btn_close.on("click",this,this.close);
		this.quxiao.on("click",this,this.close);
		this.queding.on("click",this,this.quedingCB);
		this.leftBtn.on("click",this,this.leftCB);
		this.rightBtn.on("click",this,this.rightCB);
		this.max.on("click",this,this.maxCB);
		this.txt0.restrict="0-9";
		this.txt0.on("input",this,this.inputOver);
	}

	__proto.inputOver=function(){
		var num=parseInt(this.txt0.text);
		if(num > this.maxLimt){
			this.txt0.text=this.maxLimt+"";
			}else if(num < 1){
			this.txt0.text=1+"";
		}
	}

	__proto.maxCB=function(){
		this.txt0.text=this.maxLimt.toString();
	}

	__proto.leftCB=function(){
		var num=parseInt(this.txt0.text);
		if(num > 1){
			num--;
			this.txt0.text=num.toString();
		}
	}

	__proto.rightCB=function(){
		var num=parseInt(this.txt0.text);
		if(num < this.maxLimt){
			num++;
			this.txt0.text=num.toString();
		}
	}

	//发送使用数量
	__proto.quedingCB=function(){
		var quedingNum=parseInt(this.txt0.text);
		this.bagAction.sendUseItem(this.itemOnlyId,quedingNum);
		this.close();
	}

	__proto.flushPanel=function(data){
		var itemid=data.itemId;
		var itemnum=data.itemNum;
		this.maxLimt=itemnum;
		this.itemOnlyId=data.onlyId;
		var sysitem=ConfigManager.getConfig("sys_item.txt",itemid);
		if(sysitem !=null){
			var img_icon=this.box0.getChildByName("icon");
			img_icon.skin=GameUtils.getItemIconPath(itemid);
			this.name0.text=sysitem.itemName;
			this.shu.text=itemnum.toString();
			this.txt0.text="1";
		}
	}

	return TipsUseItem;
})(tips_sydjUI)


//class huamao.panel.chuzheng.ChuZheng extends ui.SLGGAME.chuzhengUI
var ChuZheng=(function(_super){
	function ChuZheng(){
		this._fromKa=null;
		this._fromCell=null;
		this._toKa=null;
		this._toCell=null;
		this._fromKaCopy=null;
		this._fromCellCopy=null;
		this._toKaCopy=null;
		this._toCellCopy=null;
		this.mapCityAction=null;
		this.mapCitySession=null;
		this.mainPlayerSession=null;
		this._uiLayer=null;
		this._kaLayer=null;
		this._liangcao=0;
		this.downIndex=-1;
		this._isDrag=false;
		this._tmpRect=null;
		this.totalBingli=0;
		this._maxSize=0;
		this._tmpSize=0;
		this._curSize=0;
		this._curList=[];
		this.takeTime0=null;
		this.takeTime=null;
		//private var _date23:Date=new Date();
		this.toPlayer=null;
		this.zhenRong0=[0,3,6];
		//最后面的替补下标
		this.zhenRong1=[1,4,7];
		//最后面的替补下标
		this.zhenRong2=[2,5,8];
		this._cellObj=new Object();
		this._kaObj=new Object();
		this._date0=new Date();
		this._date8=new Date();
		ChuZheng.__super.call(this);
		App.injOne(this);
		this._uiLayer=new Sprite;
		this.addChild(this._uiLayer);
		this._uiLayer.pos(23,53);
		this._kaLayer=new Sprite;
		this.addChild(this._kaLayer);
		this._kaLayer.pos(this._uiLayer.x,this._uiLayer.y);
		for(var i=0;i < 9;i++){
			var col=i % 3;
			var row=i / 3;
			var cell=new ChuzhengCell();
			cell.pos(col *180,parseInt(row+"")*165);
			cell.x+=10;
			cell.y+=5;
			cell.index=i;
			this._cellObj[i]=cell;
			this._uiLayer.addChild(cell);
			var ka=new ChuzhengKa();
			ka.pos(cell.x,cell.y);
			ka.index=i;
			this._kaObj[i]=ka;
			ka.visible=false;
			this._kaLayer.addChild(ka);
		}
		this._fromKaCopy=new ChuzhengKa();
		this._fromCellCopy=new ChuzhengCell();
		this._toKaCopy=new ChuzhengKa();
		this._toCellCopy=new ChuzhengCell();
		this.chuzheng.on("click",this,this.onChuzheng);
		this.buzhen.on("click",this,this.onBuzheng);
		this._kaLayer.on("mousedown",this,this.onKaDown);
		this._kaLayer.on("mouseup",this,this.onKaUp);
		this._kaLayer.on("mouseout",this,this.onKaUp);
		this.wenhao.clickHandler=new Handler(this,this.onwenhao);
	}

	__class(ChuZheng,'huamao.panel.chuzheng.ChuZheng',_super);
	var __proto=ChuZheng.prototype;
	__proto.onwenhao=function(){
		FlyLittleUpTips.setTips("出征需要消耗粮草，消耗粮草的数量与出征兵力和行军距离有关。1点-9点（UTC+9）攻打其他玩家的城池将消耗10倍粮草。",300);
	}

	__proto.onKaDown=function(e){
		this._isDrag=false;
		if((e.target instanceof huamao.panel.chuzheng.ChuzhengKa )){
			Laya.timer.clear(this,this.onKa);
			Laya.timer.once(1000,this,this.onKa,[e.target]);
		}
	}

	__proto.onKa=function(ka){
		this._isDrag=true;
		this._fromKa=ka;
		this._fromKa.visible=false;
		this.downIndex=this._fromKa.index;
		this._fromCell=this._cellObj[this._fromKa.index];
		this._fromKaCopy.update(this._fromKa.heroData);
		this._fromKaCopy.scale(1.2,1.2);
		this._fromKaCopy.pos(ka.x-0.1 *this._fromKaCopy.width,ka.y-0.1 *this._fromKaCopy.height);
		this._kaLayer.addChild(this._fromKaCopy);
		this._fromKaCopy.startDrag();
	}

	__proto.onKaUp=function(){
		Laya.timer.clear(this,this.onKa);
		if(!this._isDrag){
			return;
		}
		this._isDrag=false;
		this._toKa=null;
		this._toCell=null;
		if(this._fromKa.heroData){
			var p=this._uiLayer.getMousePoint();
			var cell;
			for(var $each_cell in this._cellObj){
				cell=this._cellObj[$each_cell];
				if(cell !=this._fromCell){
					this._tmpRect=new Rectangle(cell.x,cell.y,cell.width,cell.height);
					if(this._tmpRect.contains(p.x,p.y)&& cell.limit==false){
						this._toKa=this._kaObj[cell.index];
						this._toCell=cell;
						break ;
					}
				}
			}
		}
		this._fromKaCopy.scale(1,1);
		this._fromKaCopy.stopDrag();
		if(this._toKa==null && this._toCell==null){
			Tween.to(this._fromKaCopy,{x:this._fromCell.x,y:this._fromCell.y},100,null,new Handler(this,this.onSwap0));
			return;
		}
		if(this._toKa.heroData==null){
			this._toKa.visible=true;
			this._toKa.update(this._fromKaCopy.heroData);
			if(this._toKa && this.oneZhenrong(this._toKa.index)==false){
				Tween.to(this._fromKaCopy,{x:this._fromCell.x,y:this._fromCell.y},100,null,new Handler(this,this.onSwap0));
				return;
			}
			this._fromKaCopy.removeSelf();
			this.downIndex=-1;
			this._toCell.visible=false;
			this._uiLayer.addChild(this._toCellCopy);
			this._toCellCopy.pos(this._toCell.x,this._toCell.y);
			Tween.to(this._toCellCopy,{x:this._fromCell.x,y:this._fromCell.y},this.getDelay(),null,new Handler(this,this.onSwap1));
			return;
		}
		this._fromKaCopy.removeSelf();
		this._toKaCopy.update(this._toKa.heroData);
		this._kaLayer.addChild(this._toKaCopy);
		this._toKaCopy.pos(this._toKa.x,this._toKa.y);
		this._fromKa.update(this._toKa.heroData);
		this._toKa.update(this._fromKaCopy.heroData);
		Tween.to(this._toKaCopy,{x:this._fromCell.x,y:this._fromCell.y},this.getDelay(),null,new Handler(this,this.onSwap2));
	}

	__proto.getDelay=function(){
		var deltaX=this._toCell.x-this._fromCell.x;
		var deltaY=this._toCell.y-this._fromCell.y;
		var distance=Math.sqrt(deltaX *deltaX+deltaY *deltaY);
		var delay=parseInt(distance+"")*0.5;
		return delay;
	}

	__proto.onSwap0=function(){
		this._fromCell.visible=false;
		this._fromKa.visible=true;
		this.removeCopy();
	}

	__proto.onSwap1=function(){
		this._fromCell.visible=true;
		this._fromKa.visible=false;
		this._fromKa.heroData=null;
		if(this._toCell){
			this._toCell.visible=false;
		}
		if(this._toKa){
			this._toKa.visible=true;
		}
		this.removeCopy();
	}

	__proto.onSwap2=function(){
		this._fromKa.visible=true;
		this._toKa.visible=true;
		this._fromCell.visible=false;
		this._toCell.visible=false;
		if(this._toKa && this.oneZhenrong(this._toKa.index)==false){
			Tween.to(this._fromKaCopy,{x:this._fromCell.x,y:this._fromCell.y},100,null,new Handler(this,this.onSwap0));
			return;
		}
		this.downIndex=-1;
		this.removeCopy();
	}

	__proto.removeCopy=function(){
		this._isDrag=false;
		this._fromKaCopy.removeSelf();
		this._toKaCopy.removeSelf();
		this._fromCellCopy.removeSelf();
		this._toCellCopy.removeSelf();
	}

	__proto.onCancelItem=function(index){
		var cell=this._cellObj[index];
		cell.visible=true;
		var ka=this._kaObj[index];
		ka.visible=false;
		this.totalBingli-=ka.heroData.soldier;
		delete this.mapCitySession.chuzhengDic[ka.heroData.heroId];
		this.bingli.text=""+this.totalBingli;
		ka.heroData=null;
		this.updateLiang();
		this.deleteZhenRong(index);
	}

	__proto.onSet=function(idx,data){
		console.log("---------------"+idx);
		var cell=this._cellObj[idx];
		cell.visible=false;
		var ka=this._kaObj[idx];
		ka.update(data);
		ka.visible=true;
		this.totalBingli+=data.soldier;
		this.bingli.text=""+this.totalBingli;
		this.mapCitySession.chuzhengDic[data.heroId]=data;
		this.updateLiang();
		this.deleteZhenRong(idx);
	}

	__proto.updateLiang=function(){
		if(this.mapCitySession.getCity(this.mapCitySession.chuzhengParam.toId).playerType==CityPlayerType.ENEMY){
			this._liangcao=this.totalBingli *(this.mapCitySession.chuzhengParam.juli-1)*this.takeTime0.supplyCostRatio+this.totalBingli *this.takeTime.supplyCostRatio;
		}
		else{
			this._liangcao=this.totalBingli *this.mapCitySession.chuzhengParam.juli *this.takeTime0.supplyCostRatio;
		}
		this.liangcao.text=""+this._liangcao;
		this.updateMixSkill();
	}

	__proto.updateMixSkill=function(){
		this.zuhe.text="";
		var heroIdArr=[];
		var ka;
		for(var $each_ka in this._kaObj){
			ka=this._kaObj[$each_ka];
			if(ka.index > 5){
				continue ;
			}
			if(ka.heroData){
				heroIdArr.push(ka.heroData.heroId);
			}
		}
		if(heroIdArr.length <=1){
			return;
		};
		var mixObj=new Object();
		var $each_ka;
		for($each_ka in this._kaObj){
			ka=this._kaObj[$each_ka];
			if(ka.index > 5){
				continue ;
			}
			if(ka.heroData){
				var mixSkillIds=ka.heroData.sysHero.heroMixSkill.split(",");
				for(var j=0;j < mixSkillIds.length;j++){
					var mixSkillId=parseInt(mixSkillIds[j]);
					var sysMixSkill=ConfigManager.getConfig("sys_skill_mix.txt",mixSkillId);
					if(sysMixSkill==null){
						continue ;
					};
					var heroIds=sysMixSkill.mixSkillHero.split(",");
					var isHasAll=true;
					for(var i=0;i < heroIds.length;i++){
						var heroId=parseInt(heroIds[i]+"");
						if(heroIdArr.indexOf(heroId)==-1){
							isHasAll=false;
						}
					}
					if(isHasAll){
						mixObj[sysMixSkill.mixSkillId]=sysMixSkill.mixSkillName;
					}
				}
			}
		}
		var mixName;
		for(var $each_mixName in mixObj){
			mixName=mixObj[$each_mixName];
			this.zuhe.text+=mixName+"\n";
		}
	}

	__proto.onBuzheng=function(){
		this.totalBingli=0;
		for(var i=0;i < 9;i++){
			var cell=this._cellObj[i];
			cell.visible=true;
			var ka=this._kaObj[i];
			ka.visible=false;
			ka.heroData=null;
		}
		this._curList.length=0;
		this._maxSize=0;
		if(this.mainPlayerSession.mainPlayerData.job < 1004){
			this._maxSize=6;
		}
		else{
			this._maxSize=9;
		};
		var cityData=this.mapCitySession.getCity(this.mapCitySession.chuzhengParam.fromId);
		for(i=0;i < this._maxSize;i++){
			if(i < cityData.heroList.length){
				this._curList[i]=cityData.heroList[i];
			}
		}
		this._tmpSize=this._curList.length;
		this._curSize=0;
		this.onStart();
	}

	__proto.onStart=function(){
		if(this._curList.length > 0 && this._curSize < this._tmpSize){
			var data=this._curList[this._curSize];
			Laya.timer.once(100,this,this.buzheng,[data]);
		}
	}

	__proto.buzheng=function(data){
		this.onSet(this._curSize,data);
		this._curSize++;
		if(this._curSize < this._maxSize){
			this.onStart();
		}
		if(!this.ifAnimiOver()){
			App.eventManager.event("BUZHEN_ANIMI_OVER");
		}
	}

	//布阵未完成
	__proto.ifAnimiOver=function(){
		return (this._curSize !=this._tmpSize);
	}

	__proto.onChuzheng=function(){
		if(this.ifAnimiOver()){
			FlyUpTips.setTips("正在布局武将，请您稍后再试");
			return;
		};
		var heroIds=[];
		var bingli=0;
		var ka;
		for(var $each_ka in this._kaObj){
			ka=this._kaObj[$each_ka];
			if(ka.heroData){
				heroIds.push([ka.index,ka.heroData.heroId]);
				bingli+=ka.heroData.soldier;
			}
		}
		if(bingli==0){
			FlyUpTips.setTips("请选择出征武将");
			return;
		}
		if(this.mapCitySession.checkLiangcao(this._liangcao)==false){
			FlyUpTips.setTips("粮草不足");
			return;
		}
		App.voiceManager.playSound("go.wav");
		this.mapCityAction.onChuzheng(this.mapCitySession.chuzhengParam.chuzhengType,this.mapCitySession.chuzhengParam.fromId,this.mapCitySession.chuzhengParam.toId,bingli,heroIds,this.mapCitySession.chuzhengParam.jicetype);
		this.close();
		App.eventManager.event("CANCLE_CHUZHENG");
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		this.mapCitySession.chuzhengParam.reset();
		FlyLittleUpTips.getinstance().close();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		console.log("出征界面");
		this._liangcao=0;
		this.takeTime0=ConfigManager.getConfig("sys_timetake.txt",2);
		this._date0.setHours(0);
		this._date8.setHours(9);
		this.toPlayer=this.mapCitySession.getCityPlayer(this.mapCitySession.getCity(this.mapCitySession.chuzhengParam.toId).playerId);
		if(GameUtils.GetServerTime()> this._date0.getTime()&& GameUtils.GetServerTime()< this._date8.getTime()&& this.toPlayer !=null){
			this.takeTime=ConfigManager.getConfig("sys_timetake.txt",8);
		}
		else if(this.mainPlayerSession.mainPlayerData.job==1001){
			this.takeTime=ConfigManager.getConfig("sys_timetake.txt",61);
		}
		else{
			this.takeTime=ConfigManager.getConfig("sys_timetake.txt",1);
		}
		this.mapCitySession.chuzhengDic=new Object();
		var toCity=ConfigManager.getConfig("sys_city.txt",this.mapCitySession.chuzhengParam.toId);
		this.mudi.text=toCity.cityName;
		var playerType=this.mapCitySession.getCity(this.mapCitySession.chuzhengParam.toId).playerType;
		if(playerType==CityPlayerType.ENEMY || playerType==CityPlayerType.KONG){
			this.time0.text=GameUtils.time(this.takeTime0.timeCd *(this.mapCitySession.chuzhengParam.juli-1)+this.takeTime.timeCd);
		}
		else{
			this.time0.text=GameUtils.time(this.takeTime0.timeCd *this.mapCitySession.chuzhengParam.juli);
		}
		if(this.mainPlayerSession.mainPlayerData.job > 1001){
			this.shili.text=this.toPlayer.pName;
		}
		else{
			this.shili.text="董卓";
		}
		this.updateLiang();
	}

	//wenhao.visible=GameUtils.GetServerTime()> _date23.getTime()&& GameUtils.GetServerTime()< _date8.getTime();
	__proto.deleteZhenRong=function(index){
		for(var i=0;i<3;i++){
			var arr=this ["zhenRong"+i];
			for(var j=0;j<arr.length;j++){
				var in3=arr[arr.length-1];
				var in2=in3-3;
				var in1=in2-3;
				var ka1=this._kaObj[in1];
				var ka2=this._kaObj[in2];
				var ka3=this._kaObj[in3];
				var cell1=this._cellObj[in1];
				var cell2=this._cellObj[in2];
				var cell3=this._cellObj[in3];
				if(arr[arr.length-1] !=index){
					if(ka1.visible==false && ka2.visible==false){
						ka3.visible=false;
						cell3.visible=true;
					}
					}else{
					if(ka3.visible==true){
						if(ka1.visible==false && ka2.visible==false){
							ka3.visible=false;
							cell3.visible=true;
							FlyUpTips.setTips("当列前后排人数不够，替补位置无效");
						}
					}
				}
			}
		}
	}

	//最后面的替补下标
	__proto.oneZhenrong=function(index){
		var boo=true;
		for(var i=0;i<3;i++){
			var arr=this ["zhenRong"+i];
			if(arr.indexOf(index)!=-1){
				var in3=arr[arr.length-1];
				var in2=in3-3;
				var in1=in2-3;
				var ka1=this._kaObj[in1];
				var ka2=this._kaObj[in2];
				var ka3=this._kaObj[in3];
				var cell1=this._cellObj[in1];
				var cell2=this._cellObj[in2];
				var cell3=this._cellObj[in3];
				if(arr[arr.length-1]==index){
					if(ka1.visible==false && ka2.visible==false){
						FlyUpTips.setTips("当列前后排人数不够，替补位置无效");
						boo=false;
					}
				}
			}
		}
		this.deleteZhenRong(index);
		return boo;
	}

	return ChuZheng;
})(chuzhengUI)


//class huamao.panel.city.TipsJieSanAllWJ extends ui.SLGGAME.tips_tsUI
var TipsJieSanAllWJ=(function(_super){
	function TipsJieSanAllWJ(){
		this.mapCityAction=null;
		TipsJieSanAllWJ.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsJieSanAllWJ,'huamao.panel.city.TipsJieSanAllWJ',_super);
	var __proto=TipsJieSanAllWJ.prototype;
	__proto.init=function(){
		this.txt1.text="确定解散所有城池武将？";
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.box0.visible=false;
	}

	__proto.queDingCB=function(){
		this.mapCityAction.sendJieSanAllJeneral();
		this.quXiaoCB();
		FlyUpTips.setTips("解散城池武将成功");
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	return TipsJieSanAllWJ;
})(tips_tsUI)


//class huamao.panel.chuzheng.SelectChuzheng extends ui.SLGGAME.chuzheng_0UI
var SelectChuzheng=(function(_super){
	function SelectChuzheng(){
		this.mapCitySession=null;
		this.list=null;
		this._index=0;
		SelectChuzheng.__super.call(this);
		App.injOne(this);
		this.list=new List();
		this.list.itemRender=ChuzhengItem;
		this.list.repeatX=3;
		this.list.repeatY=2;
		this.list.spaceX=12;
		this.list.spaceY=10;
		this.list.pos(94,88);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.vScrollBarSkin="";
		this.list.size(568,328);
		this.addChild(this.list);
	}

	__class(SelectChuzheng,'huamao.panel.chuzheng.SelectChuzheng',_super);
	var __proto=SelectChuzheng.prototype;
	__proto.updateItem=function(item,index){
		item.toIndex=this._index;
		item.update(item.dataSource);
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this._index=this.tag.index;
		var cityData=this.mapCitySession.getCity(this.mapCitySession.chuzhengParam.fromId);
		var arr=[];
		var data;
		for(var $each_data in cityData.heroList){
			data=cityData.heroList[$each_data];
			if(!this.mapCitySession.chuzhengDic.hasOwnProperty(data.heroId)){
				arr.push(data);
			}
		}
		this.list.array=arr;
	}

	return SelectChuzheng;
})(chuzheng_0UI)


//class huamao.panel.city.CityPanel extends ui.SLGGAME.chengchiUI
var CityPanel=(function(_super){
	function CityPanel(){
		this.tabBind=null;
		this.contentSp=null;
		// private var uiloading:UiLoading;
		this.auto=null;
		CityPanel.__super.call(this);
		App.injOne(this);
		this.contentSp=new Sprite;
		this.addChild(this.contentSp);
		this.contentSp.pos(0,115);
		this.tabBind=new TabBind(this.tab0,this.contentSp);
		this.tabBind.addTabCell(0,BuildView,BuidViewMediator);
		this.tabBind.addTabCell(1,MilitaryView,MilitaryViewMediator);
		this.init();
		this.on("undisplay",this,this.undisFun);
	}

	__class(CityPanel,'huamao.panel.city.CityPanel',_super);
	var __proto=CityPanel.prototype;
	//this.getChildByName("close");
	__proto.undisFun=function(){
		console.log(11111);
	}

	__proto.flushBtn=function(){}
	// this.removeChild(uiloading);
	__proto.init=function(){
		CityPanel.Open=true;
		this.btn0.on("click",this,this.jieSan);
		this.btn0.zOrder=99;
		this.txt0.visible=false;
		this.txt1.visible=false;
	}

	__proto.jieSan=function(){
		App.dialogManager.showMiniDialog(TipsJieSanAllWJ,true,true ,false,false);
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		CityPanel.Open=false;
		if(type=="close"){
			this.destroy();
		}
	}

	CityPanel.Open=false;
	return CityPanel;
})(chengchiUI)


//class huamao.panel.cityBudui.Binglijijie extends ui.SLGGAME.budui_bljjUI
var Binglijijie=(function(_super){
	function Binglijijie(){
		this.list=null;
		this.mapCitySession=null;
		this.mapCityAction=null;
		this.autoEvent=null;
		this.bingNum=0;
		this.liangNum=0;
		this._cityId=0;
		this._resultArr=[];
		this._distance=0;
		this._fromCityId=0;
		this._findedList=[];
		Binglijijie.__super.call(this);
		App.injOne(this);
		this.list=new List();
		this.list.itemRender=BinglijijieItem;
		this.addChild(this.list);
		this.list.pos(40,127);
		this.list.height=355;
		this.list.repeatX=1;
		this.list.repeatY=7;
		this.list.spaceY=2;
		this.list.vScrollBarSkin="";
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("SELECT_JIJIE_CITY",this,this.onUpdate);
		this.check0.clickHandler=new Handler(this,this.onClick);
		this.queding.clickHandler=new Handler(this,this.onQueding);
		this.quxiao.clickHandler=new Handler(this,this.close);
	}

	__class(Binglijijie,'huamao.panel.cityBudui.Binglijijie',_super);
	var __proto=Binglijijie.prototype;
	__proto.onQueding=function(){
		if(this.mapCitySession.selfDataInfo.liangcao < this.liangNum){
			FlyUpTips.setTips("粮草不足");
			return;
		}
		var arr;
		for(var $each_arr in this.list.array){
			arr=this.list.array[$each_arr];
			if(this.mapCitySession.jiJieObj[arr[0]]){
				var cityData=this.mapCitySession.getCity(arr[0]);
				this.mapCityAction.onChuzheng(0,arr[0],arr[1],cityData.yubeiyiNum,[]);
			}
		}
		this.close();
	}

	__proto.onClick=function(){
		this.bingNum=0;
		this.liangNum=0;
		for(var id=0 in this.mapCitySession.jiJieObj){
			this.mapCitySession.jiJieObj[id]=this.check0.selected;
		}
		this.list.refresh();
		if(this.check0.selected==false){
			this.updateBingLiang();
		}
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	__proto.onUpdate=function(){
		this.bingNum=0;
		this.liangNum=0;
		var takeTime0=ConfigManager.getConfig("sys_timetake.txt",2);
		var arr;
		for(var $each_arr in this.list.array){
			arr=this.list.array[$each_arr];
			if(this.mapCitySession.jiJieObj[arr[0]]){
				var cityData=this.mapCitySession.getCity(arr[0]);
				this.bingNum+=cityData.yubeiyiNum;
				this.liangNum+=cityData.yubeiyiNum *arr[2] *takeTime0.supplyCostRatio;
			}
		}
		this.updateBingLiang();
	}

	__proto.updateBingLiang=function(){
		this.bing.text=this.bingNum+"";
		this.liang.text=this.liangNum+"";
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.mapCitySession.jiJieObj={};
		this._cityId=this.tag.cityId;
		this.bingNum=0;
		this.liangNum=0;
		this.updateBingLiang();
		this._findedList.length=this._resultArr.length=0;
		this._distance=0;
		var curData=this.mapCitySession.getCity(this._cityId);
		var arr=curData.sysCity.cityRelation.split(",");
		this._findedList.push(this._cityId);
		this.findPath(arr);
		var resArr=[];
		for(var i=0;i < this._resultArr.length;i++){
			var itemArr=this._resultArr[i];
			var nextData=this.mapCitySession.getCity(itemArr[0]);
			if(nextData.yubeiyiNum>0){
				resArr.push(itemArr);
				this.mapCitySession.jiJieObj[itemArr[0]]=false;
			}
		}
		this.list.array=resArr;
	}

	__proto.findPath=function(curFindArr){
		this._distance++;
		var nextFindArr=[];
		for(var i=0;i < curFindArr.length;i++){
			var nextId=parseInt(curFindArr[i]);
			if(this._findedList.indexOf(nextId)!=-1){
				continue ;
			}
			this._findedList.push(nextId);
			var nextData=this.mapCitySession.getCity(nextId);
			var playerType=nextData.playerType;
			if(nextData.battleFileUrl.length > 0){
				continue ;
			}
			if(playerType !=CityPlayerType.SELF){
				continue ;
			}
			this._resultArr.push([nextId,this._cityId,this._distance]);
			var curData=this.mapCitySession.getCity(nextId);
			var arr=curData.sysCity.cityRelation.split(",");
			nextFindArr=nextFindArr.concat(arr);
		}
		if(nextFindArr.length > 0){
			this.findPath(nextFindArr);
		}
	}

	return Binglijijie;
})(budui_bljjUI)


//class huamao.panel.duobao.DuoBaoTips extends ui.SLGGAME.tips_tsUI
var DuoBaoTips=(function(_super){
	function DuoBaoTips(){
		this.sys=null;
		this.systk=null;
		this.duoBaoAction=null;
		DuoBaoTips.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(DuoBaoTips,'huamao.panel.duobao.DuoBaoTips',_super);
	var __proto=DuoBaoTips.prototype;
	__proto.init=function(){
		this.checktext.visible=false;
		this.btn1.on("click",this,this.removeTips);
		this.systk=ConfigManager.getConfig("sys_timetake.txt",60);
	}

	__proto.removeTips=function(){
		this.close();
	}

	__proto.onClickBtn=function(num,count){
		(count===void 0)&& (count=1);
		this.btn0.on("click",this,this.buyJuan,[num,count]);
	}

	__proto.buyJuan=function(num,count){
		this.duoBaoAction.onMaiJuan(num);
		this.close();
		console.log("买卷-->"+count);
	}

	__proto.buyJaunTips=function(haveNum,buyNum){
		this.sys=ConfigManager.getConfig("sys_tips.txt",1047);
		TheGame.lang(this.txt1,this.sys.tipsDescribe,haveNum,this.systk.timeCd*buyNum,buyNum);
		this.shu0.text=""+this.systk.timeCd*buyNum;
	}

	return DuoBaoTips;
})(tips_tsUI)


//class huamao.panel.cityBudui.CityBudui extends ui.SLGGAME.buduiUI
var CityBudui=(function(_super){
	function CityBudui(){
		this.list=null;
		this.wuJiangSession=null;
		this.mapCitySession=null;
		this.mapCityAction=null;
		this.bagSession=null;
		this.mainPlayerSession=null;
		this.takeTime2=null;
		this.heroTeamSession=null;
		this._curCityId=0;
		this._cityData=null;
		CityBudui.__super.call(this);
		App.injOne(this);
		this.chuzheng.on("click",this,this.onChuzheng);
		this.bubing.on("click",this,this.onBubing);
		this.jiesan.on("click",this,this.onJiesan);
		this.yunshu.on("click",this,this.onYunshu);
		this.zhao.on("click",this,this.onZhao);
		this.jijie.on("click",this,this.onJijie);
		this.comb0.selectHandler=new Handler(this,this.onSelect);
		this.list=new BuduiList();
		this.addChild(this.list);
		this.takeTime2=ConfigManager.getConfig("sys_timetake.txt",29);
	}

	__class(CityBudui,'huamao.panel.cityBudui.CityBudui',_super);
	var __proto=CityBudui.prototype;
	__proto.onSelect=function(index){
		if(index < 0){
			return;
		}
		console.log("========="+index);
		this.zizi.visible=index==0;
		this.list.isDrag=index==0;
		this.update();
	}

	__proto.onZhao=function(){
		UseJice.ins.onUse(4003,this.takeTime2.timeCd,new Handler(this,this.useHandler,[0]),new Handler(this,this.useHandler,[1]));
	}

	__proto.useHandler=function(type){
		UseJice.ins.close();
		if(type==0){
			var num=this.bagSession.getItemNumByItemId(4003);
			if(num==0){
				var openFunctionSession=App.getSession("openFunctionSession");
				if(openFunctionSession.isFunction("jice")){
					return;
				}
				App.dialogManager.openDialogByStr("DIALOG_STRATAGEM",null,true,true);
				return;
			}
		}
		else if(type==1){
			if(this.mainPlayerSession.mainPlayerData.gold < this.takeTime2.timeCd){
				FlyUpTips.setTips("元宝不足");
				return;
			}
			if(UseJiceTips.ZhaoBingMaiMa_IFVIEW){
				var tips=App.dialogManager.showMiniDialog(UseJiceTips,true,true);
				tips.setHandler(4003,this.takeTime2.timeCd,new Handler(this,this.useJiceTipsCB,[this._curCityId,type]));
				return;
			}
		}
		this.useJiceTipsCB(this._curCityId,type);
	}

	__proto.useJiceTipsCB=function(cityId,type){
		App.voiceManager.playSound("yongjimou.wav");
		this.mapCityAction.onZhaobing(cityId,type);
	}

	__proto.onSingle=function(heroId,num){
		if(this._cityData.heroList.length==18){
			if(this._cityData.heroObj[heroId]==null){
				FlyUpTips.setTips("您的城池最多容纳18支队伍");
				return;
			}
		};
		var arr=[];
		var curList=this.getHeroList();
		for(var i=0;i < curList.length;i++){
			var data=curList[i];
			if(data.heroId==heroId){
				if(num==0){
					data.cityId=0;
					data.index=HeroData.maxIndex;
				}
				arr.push([heroId,num]);
				break ;
			}
		}
		console.log("调整兵力-----------",this._cityData.sysCity.cityName);
		this.mapCityAction.onSetBingli(this._cityData.cityId,arr);
	}

	__proto.onYunshu=function(){
		if(this._cityData.yubeiyiNum==0){
			FlyUpTips.setTips("该城池没有预备役");
			return;
		}
		this.close();
		App.eventManager.event("BINGLI_YUNSHU",[this._curCityId]);
	}

	__proto.onJijie=function(){
		App.dialogManager.openDialogByStr("BINGLIJJ",{cityId:this._curCityId},true,true);
	}

	__proto.onBubing=function(){
		if(this._cityData.yubeiyiNum==0){
			FlyUpTips.setTips("该城池没有预备役");
			return;
		};
		var size=this._cityData.heroList.length;
		if(size==18){
			FlyUpTips.setTips("您的城池最多容纳18支队伍");
			return;
		}
		App.voiceManager.playSound("bubing.wav");
		var curList=this.getHeroList();
		var arr=[];
		var first=0;
		var max=0;
		first=0;
		max=6;
		if(this.checkIsFull(6)){
			first=6;
			max=9;
		}
		if(this.checkIsFull(9)){
			first=9;
			max=12;
		}
		if(this.checkIsFull(12)){
			first=12;
			max=15;
		}
		if(this.checkIsFull(15)){
			first=15;
			max=18;
		}
		for(var i=first;i < max;i++){
			if(i < curList.length){
				var heroData=curList[i];
				arr.push([heroData.heroId,heroData.soldierMax]);
			}
		}
		this.mapCityAction.onSetBingli(this._cityData.cityId,arr);
	}

	__proto.checkIsFull=function(cur){
		var size=this._cityData.heroList.length;
		if(size < cur){
			return false;
		}
		for(var i=0;i < cur;i++){
			if(i < size){
				var heroData=this._cityData.heroList[i];
				if(heroData.soldierMax !=heroData.soldier){
					return false;
				}
			}
		}
		return true;
	}

	__proto.onJiesan=function(){
		var arr=[];
		var heroList=this._cityData.heroList;
		for(var i=0;i < heroList.length;i++){
			var heroData=heroList[i];
			heroData.soldier=0;
			heroData.cityId=0;
			heroData.heroState=0;
			heroData.index=HeroData.maxIndex;
			arr.push([heroData.heroId,0]);
			console.log("要解散的武将",heroData.heroId,heroData.soldier);
		}
		if(arr.length>0){
			App.voiceManager.playSound("jiesan.wav");
		}
		this.mapCityAction.onSetBingli(this._cityData.cityId,arr);
	}

	__proto.ifBingLiEmpty=function(){
		return (this.mapCitySession.getBuduiBingli(this._curCityId)==0)
	}

	__proto.onChuzheng=function(){
		if(this.ifBingLiEmpty()){
			FlyUpTips.setTips("请先给武将补兵");
			return;
		}
		this.close();
		App.eventManager.event("SELECT_CHUZHENG_CITY",[this._curCityId]);
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource,this._cityData);
	}

	__proto.swap=function(hero1,hero2){
		this.list.swap(hero1,hero2);
	}

	__proto.update=function(){
		this.list.updateList(this.getHeroList(),this._cityData);
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this._curCityId=this.tag.cityId;
		var isShowBtn=this.tag.isShowBtn;
		this.chuzheng.visible=this.yunshu.visible=isShowBtn;
		this._cityData=this.mapCitySession.getCity(this._curCityId);
		console.log("这个部队属于============="+this._cityData.sysCity.cityName);
		this.txt0.text=this._cityData.yubeiyiNum+"/50000";
		this.updateTimes();
		this.resetTab();
	}

	__proto.resetTab=function(){
		var str="默认队列";
		var teamArr=this.heroTeamSession.getTeamArr();
		for (var i=0;i < teamArr.length;i++){
			var data=teamArr[i];
			if(data.heroIdArr.length !=0){
				str+=(","+data.teamName);
			}
		}
		this.comb0.labels=str;
		this.comb0.selectedIndex=0;
	}

	__proto.updateTimes=function(){
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this.mainPlayerSession.mainPlayerData.job);
		var sysmath=ConfigManager.getConfig("sys_match.txt",sysTitle.titleRoom);
		var shengyu=sysmath.dailyLimit-this.mapCitySession.zhaobingmaimaTimes;
		this.zhao.label="招兵买马("+shengyu+"/"+sysmath.dailyLimit+")";
	}

	__proto.onSuccess=function(cityData,playerData){
		console.log("刷新部队信息");
		this.txt0.text=this._cityData.yubeiyiNum+"/50000";
		this.update();
	}

	__proto.getHeroList=function(){
		var index=this.comb0.selectedIndex;
		var arr=[];
		arr=this._cityData.heroList;
		if(index==0){
			arr=arr.concat(this.mapCitySession.getBuduiHeros(this._cityData.cityId));
		}
		else{
			var teamData=this.heroTeamSession.getTeamByIndex(index+1000);
			var teamArr=this.heroTeamSession.getTeam(teamData);
			arr=arr.concat(this.heroTeamSession.getBuduiList(teamArr));
		}
		return arr;
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
	}

	return CityBudui;
})(buduiUI)


//class huamao.panel.cityBudui.Diaobing extends ui.SLGGAME.budui_dcblUI
var Diaobing=(function(_super){
	function Diaobing(){
		this.mainPlayerSession=null;
		this.mapCitySession=null;
		this.mapCityAction=null;
		this.wuJiangSession=null;
		this.currbl=0;
		this._tmpSoldier=0;
		this._heroData=null;
		this._array=null;
		this._cityBuildData=null;
		this._curSolder=0;
		this.img=new Image();
		Diaobing.__super.call(this);
		App.injOne(this);
		this.leftBtn.on("click",this,this.onClick,[1]);
		this.rightBtn.on("click",this,this.onClick,[2]);
		this.quxiao.on("click",this,this.onClose);
		this.queding.on("click",this,this.onSure);
		this.chakan.on("click",this,this.onChakan);
		this.hs0.showLabel=false;
	}

	__class(Diaobing,'huamao.panel.cityBudui.Diaobing',_super);
	var __proto=Diaobing.prototype;
	__proto.onChakan=function(){
		App.dialogManager.openDialogByStr("WUJIANGSHUOMING",{heroId:this._heroData.heroId,team:this._array });
		this.close();
	}

	__proto.onSure=function(){
		var heroData=this.wuJiangSession.getHero(this._heroData.heroId);
		if(heroData && this._tmpSoldier==0){
			heroData.heroState=0;
		}
		App.eventManager.event("DIAOBING_SINGLE",[this._heroData.heroId,this._tmpSoldier]);
		this.close();
	}

	__proto.onClose=function(){
		this.close();
	}

	__proto.onChange=function(value){
		value=value / 100;
		var min=Math.min(this._cityBuildData.yubeiyiNum+this._curSolder,this._heroData.soldierMax);
		var cur=min *value;
		cur=parseInt(cur+"");
		this.txt4.text=cur+"/"+min;
		this._tmpSoldier=cur;
		this.txt1.text=(this._cityBuildData.yubeiyiNum+this.currbl-cur)+"/50000";
		this.setXiaohao();
	}

	__proto.setXiaohao=function(){
		if(this._heroData.soldierType==0){
			this.xiaohao.text="0";
		}
	}

	__proto.onClick=function(btnId){
		if(btnId==1){
			this.hs0.value=0;
		}
		else if(btnId==2){
			this.hs0.value=100;
		}
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this._heroData=this.tag.heroData;
		this._cityBuildData=this.mapCitySession.getCity(this.tag.cityId);
		console.log("调兵面板",this._cityBuildData.sysCity.cityName,this._cityBuildData.yubeiyiNum);
		this._array=this.tag.team;
		this.img.skin=GameUtils.getHeroSkin(this._heroData.heroId);
		this.img.size(this.box0.width,this.box0.height);
		this.box0.addChild(this.img);
		this.name0.text=this._heroData.sysHero.heroName;
		this.di0.skin=GameUtils.getDi(this._heroData.sysHero.heroColor);
		this.tiao.skin=GameUtils.getZiDi(this._heroData.sysHero.heroColor);
		GameUtils.getKaKuang(this.wk,this._heroData.sysHero.heroColor);
		this.dengji.text=this._heroData.heroLv+"";
		this.txt1.text=this._cityBuildData.yubeiyiNum+"/50000";
		this.txt2.text=this.mapCitySession.selfDataInfo.tongqian+"";
		this.txt3.text=this.getBingzhong(this._heroData.soldierType);
		this.txt0.text="勇"+this._heroData.force+"\n"
		+"御"+this._heroData.resist+"\n"
		+"智"+this._heroData.wisdom+"\n"
		+"威"+this._heroData.might;
		this.img0.skin=GameUtils.getCountry(this._heroData.sysHero.heroCountry);
		this._curSolder=this._heroData.soldier;
		var min=Math.min(this._cityBuildData.yubeiyiNum+this._curSolder,this._heroData.soldierMax);
		this.txt4.text=this._curSolder+"/"+min;
		this.currbl=this._curSolder;
		var num=this._curSolder / min *100;
		if(num > 0){
			this.hs0.value=num;
			}else{
			this.hs0.value=0;
		}
		this.hs0.changeHandler=new Handler(this,this.onChange);
	}

	__proto.getBingzhong=function(type){
		var sysForce=ConfigManager.getConfig("sys_force.txt",type);
		return sysForce.forceName;
	}

	return Diaobing;
})(budui_dcblUI)


//class huamao.panel.cityBudui.Yunshu extends ui.SLGGAME.tips_ysblUI
var Yunshu=(function(_super){
	function Yunshu(){
		this.mapCitySession=null;
		this.mapCityAction=null;
		this._curBingli=0;
		this._liangcao=0;
		this.fromCityData=null;
		this.toCityData=null;
		this.timeTake=null;
		Yunshu.__super.call(this);
		App.injOne(this);
		this.yubeiyi.text="";
		this.mubiao.text="";
		this.bingli.text="0/0";
		this.liangcao.text="";
		this.time0.text=GameUtils.time(0);
		this.der0.showLabel=false;
		this.der0.changeHandler=new Handler(this,this.onChange);
		this.leftBtn.on("click",this,this.onClick,[1]);
		this.rightBtn.on("click",this,this.onClick,[2]);
		this.quxiao.on("click",this,this.onQuxiao);
		this.queding.on("click",this,this.onQueding);
	}

	__class(Yunshu,'huamao.panel.cityBudui.Yunshu',_super);
	var __proto=Yunshu.prototype;
	__proto.onQueding=function(){
		if(this.mapCitySession.checkLiangcao(this._liangcao)==false){
			FlyUpTips.setTips("粮草不足");
		}
		else{
			App.voiceManager.playSound("go.wav");
			this.mapCityAction.onChuzheng(0,this.mapCitySession.chuzhengParam.fromId,this.mapCitySession.chuzhengParam.toId,this._curBingli,[]);
			this.close();
			this.mapCitySession.isGoMapCity=1;
			App.eventManager.event("GOTO_MAPCITY");
		}
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		this.mapCitySession.chuzhengParam.reset();
	}

	__proto.onQuxiao=function(){
		this.close();
	}

	__proto.onClick=function(btnId){
		if(btnId==1){
			this._curBingli=0;
			this.der0.value=0;
		}
		else if(btnId==2){
			this._curBingli=this.fromCityData.yubeiyiNum;
			this.der0.value=100;
		}
		this.setXiaohao();
	}

	__proto.setXiaohao=function(){
		this.bingli.text=this._curBingli+"/"+this.fromCityData.yubeiyiNum;
		this._liangcao=this._curBingli *this.mapCitySession.chuzhengParam.juli *this.timeTake.supplyCostRatio;
		this.liangcao.text=this._liangcao+"";
		this.time0.text=GameUtils.time(this.timeTake.timeCd *this.mapCitySession.chuzhengParam.juli);
	}

	__proto.onChange=function(value){
		value=value / 100;
		var cur=this.fromCityData.yubeiyiNum *value;
		this._curBingli=parseInt(cur+"");
		this.setXiaohao();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this._curBingli=0;
		this.timeTake=ConfigManager.getConfig("sys_timetake.txt",2);
		this.fromCityData=this.mapCitySession.getCity(this.mapCitySession.chuzhengParam.fromId);
		this.toCityData=this.mapCitySession.getCity(this.mapCitySession.chuzhengParam.toId);
		this.yubeiyi.text=""+this.fromCityData.yubeiyiNum;
		this.mubiao.text=this.toCityData.sysCity.cityName;
		this.setXiaohao();
	}

	return Yunshu;
})(tips_ysblUI)


//class huamao.panel.cityBuild.CityBuildCreate extends ui.SLGGAME.icon_cheng_jsUI
var CityBuildCreate=(function(_super){
	function CityBuildCreate(){
		this._curData=null;
		CityBuildCreate.__super.call(this);
		this.itemDic=new Object();
		for(var i=1;i <=3;i++){
			var item=new CreateBuildItem();
			item.update(i,0);
			this.addChild(item);
			item.pos(75+(i-1)*260,60);
			this.itemDic[i]=item;
		}
	}

	__class(CityBuildCreate,'huamao.panel.cityBuild.CityBuildCreate',_super);
	var __proto=CityBuildCreate.prototype;
	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		var buildData=this.tag.buildData;
		this._curData=buildData;
		var item;
		for(var $each_item in this.itemDic){
			item=this.itemDic[$each_item];
			item.setData(this._curData);
		}
	}

	return CityBuildCreate;
})(icon_cheng_jsUI)


//class huamao.panel.cityBuild.CityBuildLvup extends ui.SLGGAME.icon_cheng_tipsUI
var CityBuildLvup=(function(_super){
	function CityBuildLvup(){
		this.mapCityAction=null;
		this.mapCitySession=null;
		this._sendDataList=[];
		this._curData=null;
		CityBuildLvup.__super.call(this);
		App.injOne(this);
		this.shengji0.on("click",this,this.onLvup,[0]);
		this.shengji.on("click",this,this.onLvup,[1]);
		this.piliang.on("click",this,this.onLvup,[2]);
		this.chaichu.on("click",this,this.onRemove);
	}

	__class(CityBuildLvup,'huamao.panel.cityBuild.CityBuildLvup',_super);
	var __proto=CityBuildLvup.prototype;
	__proto.onLvup=function(btnType){
		if(btnType==0 || btnType==1){
			var buildData=this.mapCitySession.getBuildDataByIndex(this._curData.index);
			var sysBuilding=ConfigManager.getConfig("sys_building.txt",buildData.type+"_"+buildData.lv);
			if(this.mapCitySession.checkTongqian(sysBuilding.upgradeCost)==false){
				FlyUpTips.setTips("铜钱不足");
				return;
			}
			App.voiceManager.playSound("build.wav");
			this.mapCityAction.onLvupBuild(this._curData.cityId,this._curData.index,this._curData.type);
		}
		else if(btnType==2){
			this._sendDataList.length=0;
			var data;
			for(var $each_data in this.mapCitySession.innerBuildObj){
				data=this.mapCitySession.innerBuildObj[$each_data];
				if(data.isHas==1 && data.type==this._curData.type){
					this._sendDataList.push([data.cityId,data.index,data.type]);
				}
			}
			App.voiceManager.playSound("build.wav");
			this.onStart();
		}
		this.close();
	}

	__proto.onStart=function(){
		if(this._sendDataList.length > 0){
			var arr=this._sendDataList.shift();
			Laya.timer.once(100,this,this.onLvupBuild,arr);
			MouseManager.enabled=false;
			}else{
			MouseManager.enabled=true;
		}
	}

	__proto.onLvupBuild=function(cityId,index,type){
		var buildData=this.mapCitySession.getBuildDataByIndex(index);
		var sysBuilding=ConfigManager.getConfig("sys_building.txt",buildData.type+"_"+buildData.lv);
		if(this.mapCitySession.checkTongqian(sysBuilding.upgradeCost)==false){
			FlyUpTips.setTips("铜钱不足");
			MouseManager.enabled=true;
			return;
		}
		this.mapCityAction.onLvupBuild(cityId,index,type);
		this.onStart();
	}

	__proto.onRemove=function(){
		App.dialogManager.openDialogByStr("REMOVE_BUILD",{buildData:this._curData},true,true);
		this.close();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		var buildData=this.tag.buildData;
		this._curData=buildData;
		this.img0.skin="comp/town/k_"+buildData.type+".png";
		var buidIndex=buildData.index;
		this.box0.visible=buidIndex !=0;
		this.shengji0.visible=buidIndex==0;
		this.name0.text=this._curData.sysBuilding.buildName;
		this.txt0.text=this._curData.sysBuilding.buildText;
		this.tong0.text=""+this._curData.sysBuilding.upgradeCost;
		this.time0.text=GameUtils.time(this._curData.sysBuilding.upgradeTime);
		this.pipi.visible=false;
		var firstCity=ConfigManager.getConfig("sys_city.txt",this._curData.cityId);
		if(this._curData.type!=0 && this._curData.sysBuilding.upgradeCost==-1){
			this.shengji0.visible=false;
			this.laopi.visible=false;
			this.pipi.visible=true;
			this.shengji.visible=false;
			this.piliang.visible=false;
			}else if(this._curData.type==0 && firstCity.maxMainBuildingLevel <=this._curData.lv){
			this.shengji0.visible=false;
			this.laopi.visible=false;
			this.pipi.visible=true;
			this.shengji.visible=false;
			this.piliang.visible=false;
		}
	}

	return CityBuildLvup;
})(icon_cheng_tipsUI)


//class huamao.panel.cityBuild.CityBuildRemove extends ui.SLGGAME.tips_tishiUI
var CityBuildRemove=(function(_super){
	function CityBuildRemove(){
		this.mapCityAction=null;
		this.mapCitySession=null;
		this._sendDataList=[];
		this._curData=null;
		CityBuildRemove.__super.call(this);
		App.injOne(this);
		this.txt0.text="确定要拆除这座建筑吗？";
		this.btn0.on("click",this,this.onClick,[0]);
		this.btn1.on("click",this,this.onClick,[1]);
		this.btn2.on("click",this,this.onClick,[2]);
	}

	__class(CityBuildRemove,'huamao.panel.cityBuild.CityBuildRemove',_super);
	var __proto=CityBuildRemove.prototype;
	__proto.onClick=function(type){
		if(type==1){
			this._sendDataList.length=0;
			var data;
			for(var $each_data in this.mapCitySession.innerBuildObj){
				data=this.mapCitySession.innerBuildObj[$each_data];
				if(data.isHas==1 && data.type==this._curData.type){
					this._sendDataList.push([data.cityId,data.index]);
				}
			}
			this.onStart();
		}
		else if(type==2){
			this.mapCityAction.onRemoveBuild(this._curData.cityId,this._curData.index);
		}
		this.close();
	}

	__proto.onStart=function(){
		if(this._sendDataList.length > 0){
			var arr=this._sendDataList.shift();
			Laya.timer.once(100,this,this.onRemove,arr);
			MouseManager.enabled=false;
			}else{
			MouseManager.enabled=true;
		}
	}

	__proto.onRemove=function(cityId,index){
		this.mapCityAction.onRemoveBuild(cityId,index);
		this.onStart();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this._curData=this.tag.buildData;
	}

	return CityBuildRemove;
})(tips_tishiUI)


//class huamao.panel.haoyou.SelectZhenrong extends ui.SLGGAME.chuzheng_0UI
var SelectZhenrong=(function(_super){
	function SelectZhenrong(){
		this.friendSession=null;
		this.wuJiangSession=null;
		this.list=null;
		this._index=0;
		SelectZhenrong.__super.call(this);
		App.injOne(this);
		this.list=new List();
		this.list.itemRender=ChuzhengItem;
		this.list.repeatX=3;
		this.list.repeatY=2;
		this.list.spaceX=12;
		this.list.spaceY=10;
		this.list.pos(94,88);
		this.list.size(587,323);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.vScrollBarSkin="";
		this.addChild(this.list);
	}

	__class(SelectZhenrong,'huamao.panel.haoyou.SelectZhenrong',_super);
	var __proto=SelectZhenrong.prototype;
	__proto.updateItem=function(item,index){
		item.toIndex=this._index;
		item.update(item.dataSource,true);
	}

	__proto.getHeros=function(){
		var arr=[];
		var hero;
		for(var $each_hero in this.wuJiangSession.heroArr){
			hero=this.wuJiangSession.heroArr[$each_hero];
			if(hero.masterId==0 && hero.haveHero()&& this.friendSession.getIsSelect(hero.heroId)==false){
				arr.push(hero);
			}
		}
		arr.sort(function(a,b){
			if(b.sysHero.heroColor !=a.sysHero.heroColor){
				return b.sysHero.heroColor-a.sysHero.heroColor;
			}
			else{
				if(b.heroLv !=a.heroLv){
					return b.heroLv-a.heroLv;
				}
				else{
					if(b.fight !=a.fight){
						return b.fight-a.fight;
					}
					else{
						return a.sysHero.heroId-b.sysHero.heroId;
					}
				}
			}
		});
		return arr;
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this._index=this.tag.index;
		this.list.array=this.getHeros();
	}

	return SelectZhenrong;
})(chuzheng_0UI)


//class huamao.panel.dropGift.DropGiftPanel extends ui.SLGGAME.icon_dl_tips0UI
var DropGiftPanel=(function(_super){
	function DropGiftPanel(){
		this.bagAction=null;
		this.ClickNum=0;
		DropGiftPanel.__super.call(this);
		App.injOne(this);
		this.list0.itemRender=DropGiftItem;
		this.list0.renderHandler=new Handler(this,this.listHandler);
		this.list0.vScrollBarSkin="";
		this.chushou.on("click",this,this.sellGift)
		this.shouqu.on("click",this,this.oneKeyGetGift);
	}

	__class(DropGiftPanel,'huamao.panel.dropGift.DropGiftPanel',_super);
	var __proto=DropGiftPanel.prototype;
	__proto.listHandler=function(item,index){
		item.upData(this.list0.getItem(index));
	}

	__proto.update=function(arr){
		this.list0.array=arr;
	}

	__proto.sellGift=function(){
		var dropTip=App.dialogManager.showMiniDialog(icon_dl_tips2UI);
		dropTip.chushou.on("click",this,this.maiGift);
		dropTip.box0.labels="白色装备,绿色装备,蓝色装备,紫色装备,橙色装备";
		dropTip.box0.labelSize=22;
		dropTip.box0.selectedIndex=0;
		dropTip.box0.selectHandler=new Handler(this,this.onClick0);
		dropTip.cha.on("click",this,this.removeDia,[dropTip])
	}

	__proto.onClick0=function(index){
		this.ClickNum=index;
	}

	__proto.oneKeyGetGift=function(){
		App.eventManager.event("VICTORYDROPGET");
		App.dialogManager.closeDialogByStr("DROPGIFT");
	}

	__proto.maiGift=function(){
		this.bagAction.sendAllEquipBuyColor(this.ClickNum);
	}

	__proto.removeDia=function(dropTip){
		dropTip.removeSelf();
	}

	return DropGiftPanel;
})(icon_dl_tips0UI)


//class huamao.panel.duobao.DuoBaoJiLuPanel extends ui.SLGGAME.icon_dl_tips0UI
var DuoBaoJiLuPanel=(function(_super){
	function DuoBaoJiLuPanel(){
		DuoBaoJiLuPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(DuoBaoJiLuPanel,'huamao.panel.duobao.DuoBaoJiLuPanel',_super);
	var __proto=DuoBaoJiLuPanel.prototype;
	__proto.init=function(){
		this.chushou.visible=this.shouqu.visible=false;
		this.list0.itemRender=DuoBaoJiLuItem;
		this.list0.renderHandler=new Handler(this,this.listHandler);
		this.list0.vScrollBarSkin="";
	}

	__proto.listHandler=function(item,index){
		item.upData(this.list0.getItem(index));
	}

	__proto.update=function(arr){
		this.list0.array=arr;
	}

	return DuoBaoJiLuPanel;
})(icon_dl_tips0UI)


//class huamao.panel.gameOver.Dianzan extends ui.SLGGAME.jiesuan_1UI
var Dianzan=(function(_super){
	function Dianzan(){
		this.list=null;
		this.gameOver=null;
		Dianzan.__super.call(this);
		this.list=new List();
		this.list.itemRender=DianzanItem;
		this.addChild(this.list);
		this.list.pos(100,133);
		this.list.size(600,282);
		this.list.spaceX=70;
		this.list.repeatX=3;
		this.list.repeatY=3;
		this.list.vScrollBarSkin="";
		this.list.renderHandler=new Handler(this,this.renderFun);
		this.list.array=[];
		this.sousuo.clickHandler=new Handler(this,this.onSou);
	}

	__class(Dianzan,'huamao.panel.gameOver.Dianzan',_super);
	var __proto=Dianzan.prototype;
	__proto.onSou=function(){
		var list=[];
		if(this.ming.text.length > 0){
			var arr;
			for(var $each_arr in this.gameOver.dizanList){
				arr=this.gameOver.dizanList[$each_arr];
				var playername=arr[1];
				if(playername.indexOf(this.ming.text)!=-1){
					list.push(arr);
				}
			}
		}
		list.array=list;
	}

	__proto.renderFun=function(item,index){
		item.setDianZanData(this.list.getItem(index));
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.gameOver=this.tag.gameOver;
	}

	__proto.setData=function(arr){
		this.list.array=arr;
	}

	return Dianzan;
})(jiesuan_1UI)


//class huamao.panel.gameOver.DianzanView extends ui.SLGGAME.jiesuan_2UI
var DianzanView=(function(_super){
	function DianzanView(){
		DianzanView.__super.call(this);
	}

	__class(DianzanView,'huamao.panel.gameOver.DianzanView',_super);
	return DianzanView;
})(jiesuan_2UI)


//class huamao.panel.gameOver.GameOver extends ui.SLGGAME.jiesuanUI
var GameOver=(function(_super){
	function GameOver(){
		this.mapCityAction=null;
		this.mainPlayerSession=null;
		this.data=null;
		GameOver.__super.call(this);
		App.injOne(this);
		this.goBtn.on("click",this,this.onClick);
		this.btn0.clickHandler=new Handler(this,this.onDianzan);
		App.setCloseDialogOnSide(false);
		this.closeHandler=new Handler(this,this.closeFun);
	}

	__class(GameOver,'huamao.panel.gameOver.GameOver',_super);
	var __proto=GameOver.prototype;
	__proto.closeFun=function(){
		App.setCloseDialogOnSide(true);
	}

	__proto.onDianzan=function(){
		App.dialogManager.openDialogByStr("DIANZAN",{gameOver:this.data},true,true);
	}

	__proto.onClick=function(){
		this.mapCityAction.clearData();
		this.close();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.data=this.tag.data;
		var arr=this.gettitles();
		this.img0.skin=arr[0];
		this.wenben.text=arr[1];
		this.shili.text=this.data.killEnemyNum+"";
		this.shu.text=this.data.maxCityNum+"";
		this.shijian.text=this.data.timeExp+"";
		this.tongyi.text=this.data.tongyiReward+"";
		this.duli.text=this.data.dutongReward+"";
		var sysData=ConfigManager.getConfig("sys_timetake.txt",58);
		if(this.mainPlayerSession.mainPlayerData.job>=sysData.timeCd){
			if(this.data.taskType==0){
				this.renwu.text="未达成";
				}else if(this.data.taskType==1){
				this.renwu.text="未领取";
				}else if(this.data.taskType==2){
				this.renwu.text="已领取";
			}
			}else{
			var sysTitlePlayer=ConfigManager.getConfig("sys_title_player.txt",sysData.timeCd);
			this.renwu.text=sysTitlePlayer.titleName+"开放";
		}
		var sys;
		for(var $each_sys in ConfigManager.getDataArr("sys_estimate.txt")){
			sys=ConfigManager.getDataArr("sys_estimate.txt")[$each_sys];
			var arr2=sys.estimateCondition.split(",");
			var min=parseInt(arr2[0]);
			var max=parseInt(arr2[1]);
			if(this.data.grade >=min && this.data.grade < max){
				this.fen.skin="comp/jiesuan/"+sys.estimate+".png";
				this.fen0.skin="comp/jiesuan/zi"+sys.estimate+".png";
				break ;
			}
		};
		var pingjia=this.getPingjia();
		if(pingjia==""){
			this.img1.visible=false;
		}
		else{
			this.img1.skin=pingjia;
		}
		this.btn0.visible=this.data.dizanList.length > 0;
		console.log("本局结束");
	}

	__proto.getPingjia=function(){
		if(this.data.bawang==1){
			return "comp/jiesuan/bawang.png";
		}
		if(this.data.zhanshen==1){
			return "comp/jiesuan/zhanshen.png";
		}
		if(this.data.zhizhe==1){
			return "comp/jiesuan/zhizhe.png";
		}
		if(this.data.xibai==1){
			return "comp/jiesuan/xibai.png";
		}
		return "";
	}

	__proto.gettitles=function(){
		var arr=[];
		if(this.data.type==1){
			var who=this.data.playerName=="" ? "贼寇" :this.data.playerName;
			arr=["comp/jiesuan/tongyitianxia.png",who+"的最后一个城池被攻破，天下统一，本局结束。"];
		}
		else if(this.data.type==11){
			arr=["comp/jiesuan/tongyitianxia.png","董卓的最后一个城池被攻破，天下统一，本局结束。"];
		}
		else if(this.data.type==2){
			arr=["comp/jiesuan/pingfentianxia.png",this.mainPlayerSession.mainPlayerData.playerName+"与"+this.data.playerName+"联盟统一天下，本局结束"];
		}
		else if(this.data.type==3){
			arr=["comp/jiesuan/baibei.png","您的最后壹个城市被"+this.data.playerName+"攻破，本局游戏结束。"];
		}
		else if(this.data.type==4){
			arr=["comp/jiesuan/baibei.png","您为了让百姓免于战火，和平投降。"];
		}
		else if(this.data.type==5){
			arr=["comp/jiesuan/pingju.png","征战九十六载，"+this.mainPlayerSession.mainPlayerData.playerName+"统一天下，本局结束。"];
		}
		else if(this.data.type==6){
			arr=["comp/jiesuan/pingju.png","征战九十六载，"+this.mainPlayerSession.mainPlayerData.playerName+"与"+this.data.playerName+"联盟统一天下，本局结束"];
		}
		else if(this.data.type==7){
			arr=["comp/jiesuan/pingju.png","征战九十六载，终不敌沧桑岁月，本局结束"];
		}
		else if(this.data.type==8){
			arr=["comp/jiesuan/pingju.png","征战九十六载，终不敌沧桑岁月，本局结束"];
		}
		else{
			arr=["comp/jiesuan/pingju.png","天下统一，只差一步，本局结束。"];
		}
		return arr;
	}

	GameOver.StartGame=0;
	GameOver.DuTong=1;
	GameOver.LMTongyi=2;
	GameOver.ShiBai=3;
	GameOver.TouXiang=4;
	GameOver.DuTong_280=5;
	GameOver.LMTongyi_280=6;
	GameOver.ShiBai_280=7;
	GameOver.LMShiBai_280=8;
	GameOver.JiBai=9;
	GameOver.XXXTouXiang=10;
	GameOver.New_Dutong=11;
	return GameOver;
})(jiesuanUI)


//class huamao.panel.haoyou.AddHaoyou extends ui.SLGGAME.tips_tjhyUI
var AddHaoyou=(function(_super){
	var TianjiaItem;
	function AddHaoyou(){
		this.list=null;
		this.friendAction=null;
		AddHaoyou.__super.call(this);
		App.injOne(this);
		this.list=new List();
		this.list.itemRender=TianjiaItem;
		this.list.repeatX=1;
		this.list.repeatY=3;
		this.list.spaceY=3;
		this.list.pos(103,157);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.vScrollBarSkin="";
		this.list.size(575,245);
		this.addChild(this.list);
		this.refreshList([]);
		this.name0.text="";
		this.name0.prompt="可查找已有好友，或添加新的好友";
		this.name0.maxChars=10;
		this.suosuo.clickHandler=new Handler(this,this.onSou);
	}

	__class(AddHaoyou,'huamao.panel.haoyou.AddHaoyou',_super);
	var __proto=AddHaoyou.prototype;
	__proto.refreshList=function(arr){
		this.list.array=arr;
	}

	__proto.onSou=function(){
		if(this.name0.text==""){
			FlyUpTips.setTips("请输入");
			return;
		}
		this.friendAction.onFind(this.name0.text);
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	AddHaoyou.__init$=function(){
		//class TianjiaItem extends ui.SLGGAME.tips_tjhy0UI
		TianjiaItem=(function(_super){
			function TianjiaItem(){
				this._data=null;
				this.friendAction=null;
				this._head=null;
				TianjiaItem.__super.call(this);
				App.injOne(this);
				this.jia.clickHandler=new Handler(this,this.onJia);
				this.liaotian.clickHandler=new Handler(this,this.onClose);
				this._head=new Image();
				this._head.size(this.box0.width,this.box0.height);
				this.box0.addChild(this._head);
				this.jia.visible=this.liaotian.visible=false;
			}
			__class(TianjiaItem,'',_super);
			var __proto=TianjiaItem.prototype;
			__proto.onClose=function(){
				App.dialogManager.closeDialogByStr("ADDHAOYOU");
			}
			__proto.onJia=function(){
				this.friendAction.sendApplyFriend(this._data.friendId);
			}
			__proto.update=function(data){
				this._data=data;
				this.name0.text=data.friendName;
				var isFriend=data.isFriend==1;
				this.txt0.text=isFriend ? "好友" :"陌生人";
				this._head.skin=GameUtils.getHeadUrl(data.style);
				this.jia.visible=!isFriend;
				this.liaotian.visible=isFriend;
			}
			return TianjiaItem;
		})(tips_tjhy0UI)
	}

	return AddHaoyou;
})(tips_tjhyUI)


//class huamao.panel.haoyou.Beizhu extends ui.SLGGAME.tips_gmUI
var Beizhu=(function(_super){
	function Beizhu(){
		this.friendAction=null;
		Beizhu.__super.call(this);
		App.injOne(this);
		this.txt0.text="在下面输入此好友的备注内容";
		this.name0.text="";
		this.name0.prompt="请输入...";
		this.name0.maxChars=10;
		this.yuanbao.visible=false;
		this.queding.clickHandler=new Handler(this,this.onQueding);
		this.quxiao.clickHandler=new Handler(this,this.onQuxiao);
	}

	__class(Beizhu,'huamao.panel.haoyou.Beizhu',_super);
	var __proto=Beizhu.prototype;
	__proto.onQuxiao=function(){
		this.close();
	}

	__proto.onQueding=function(){
		if(this.name0.text.length==0){
			FlyUpTips.setTips("请输入");
			return;
		}
		this.friendAction.onBeizhu(parseInt(this.tag.friendId),this.name0.text);
		this.close();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
	}

	return Beizhu;
})(tips_gmUI)


//class huamao.panel.haoyou.Haoyou extends ui.SLGGAME.haoyouUI
var Haoyou=(function(_super){
	function Haoyou(){
		this.listArr=[];
		this.friendSession=null;
		this.friendAction=null;
		this.mapCityAction=null;
		this.mailAction=null;
		this.mailSession=null;
		this.curShowList=null;
		this._menu=null;
		this._chat=null;
		this.mail=null;
		this.autoEvent=null;
		this.mailBattleSession=null;
		this.mainPlayerSession=null;
		this.redZj=null;
		this.redHy=null;
		this.redYj=null;
		this._curData=null;
		this.lastTime=0;
		this.currFriendId=-1;
		this._index=-1;
		this.len=-1;
		this.idid=0;
		this.currData=null;
		this.panel=null;
		Haoyou.__super.call(this);
		App.injOne(this);
		this.shanchu.visible=this.tianjia.visible=this.shan.visible=false;
		this.tab0.selectHandler=new Handler(this,this.onSelect);
		this.autoEvent=new AutoEvent(this);
		for(var i=0;i < 3;i++){
			var list=new List();
			list.itemRender=HaoyouItem;
			list.repeatX=1;
			list.repeatY=5;
			list.spaceY=3;
			list.renderHandler=new Handler(this,this.updateItem);
			list.selectEnable=i < 2;
			list.selectHandler=new Handler(this,this.selectItem);
			list.vScrollBarSkin="";
			this.listArr[i]=list;
		}
		this.tianjia.clickHandler=new Handler(this,this.onTianjia);
		this.box0.visible=false;
		this.huigu.visible=false;
		this.tongyi.clickHandler=new Handler(this,this.onTongyi);
		this.jujue.clickHandler=new Handler(this,this.onJujue);
		this.shan.clickHandler=new Handler(this,this.shanAll);
		this.shanyj.clickHandler=new Handler(this,this.shanChu);
		this.lingqu.clickHandler=new Handler(this,this.lingQu);
		this.huigu.clickHandler=new Handler(this,this.huiGu);
		this.autoEvent.add("SHOW_MENU_FRIEND",this,this.showMenu);
		this.autoEvent.add("MAILCLICK",this,this.mailHandler);
		this.autoEvent.add("MAILUI",this,this.mailUi);
		this.autoEvent.add("REAPOINT",this,this.execute);
		this.autoEvent.addEventNow();
		this._menu=new HaoyouMenu();
		this._chat=new ChatView();
		this._chat.y=15;
		this.liaotian.addChild(this._chat);
		this.txt1.prompt="请输入聊天内容";
		this.txt1.text="";
		this.txt1.maxChars=80;
		this.txt_yj.leading=15;
		this.fasong.clickHandler=new Handler(this,this.sendMsg);
		this.qingchu.clickHandler=new Handler(this,this.onQingChu);
		this.on("click",this,this.onClick);
		this.redZj=new RedPoint(RedPointType.ZUIJIN,this.tab0.items [0]);
		this.redZj.setPos(-17);
		this.redHy=new RedPoint(RedPointType.PENGYOU,this.tab0.items [1]);
		this.redHy.setPos(-17);
		this.redYj=new RedPoint(RedPointType.YOUJIAN,this.tab0.items [3]);
		this.redYj.setPos(-17);
		this.on("undisplay",this,this.remove);
	}

	__class(Haoyou,'huamao.panel.haoyou.Haoyou',_super);
	var __proto=Haoyou.prototype;
	__proto.execute=function(id){
		if(id==RedPointType.WEIDU){
			this.curShowList.refresh();
		}
	}

	__proto.remove=function(){
		for(var i=0;i < this.listArr.length;i++){
			var list=this.listArr[i];
			list.itemRender=null;
			list=null;
		}
		this.listArr.length=0;
	}

	//this.destroy();
	__proto.onClick=function(e){
		if((e.target instanceof laya.ui.Button )){
			var btn=e.target;
			if(btn.name=="jiantou"){
				return;
			}
		}
		this._menu.removeSelf();
	}

	__proto.showMenu=function(data){
		this._menu.setMenu(data,this.tab0.selectedIndex);
		this.addChild(this._menu);
		var point=this.getMousePoint();
		this._menu.pos(360,point.y);
		var h=this._menu.y+this._menu.height;
		if(h>=Laya.stage.height){
			this._menu.y=h-Laya.stage.height;
		}
	}

	__proto.selectItem=function(index){
		this.updateRightView(this.curShowList.getItem(index),index);
	}

	__proto.onJujue=function(){
		if(this._curData.checkState(4)){
			this.friendAction.onSend(FriendAction.Reject,this._curData.friendId);
		}
		else if(this._curData.checkState(16)){
			this.mapCityAction.onJujueYaoqing(this._curData.friendId);
		}
	}

	__proto.onTongyi=function(){
		if(this._curData.checkState(4)){
			this.friendAction.onSend(FriendAction.Accept,this._curData.friendId);
		}
		else if(this._curData.checkState(16)){
			this.mapCityAction.onTongyiYaoqing(this._curData.friendId);
			this.close();
		}
	}

	__proto.onTianjia=function(){
		App.dialogManager.openDialogByStr("ADDHAOYOU",null,true,true);
	}

	__proto.onQingChu=function(){
		if(this._curData){
			var normalAlert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
			normalAlert.setAll("提示","删除与"+this._curData.friendName+"的聊天记录将无法找回，确定删除吗",new Handler(this,this.onQingChu2));
		}
	}

	__proto.onQingChu2=function(){
		this.friendSession.removeChat(this._curData.friendId);
		this._chat.clear();
		this.friendAction.onSend(FriendAction.ClearMsg,this._curData.friendId);
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	__proto.updateRightView=function(data,index){
		this.currFriendId=data.friendId;
		this.friendAction.readXiaoXi(this.currFriendId);
		this._index=index;
		var item;
		for(var $each_item in this.curShowList.cells){
			item=this.curShowList.cells[$each_item];
			item.isSelect=false;
		};
		var curItem=this.curShowList.getCell(index);
		if(curItem){
			curItem.isSelect=true;
		}
		this.box0.visible=false;
		this._chat.clear();
		if(data !=null){
			this.box0.visible=false;
			var isApply=data.checkState(4);
			var isInvite=data.checkState(16);
			if(isApply){
				this.box0.visible=true;
				this.txt0.text="对方发起了添加好友申请";
			}
			else if(isInvite){
				this.box0.visible=true;
				this.txt0.text="对方向你发组队邀请";
			}
			this._curData=data;
			var chatList=this.friendSession.getFriendChatList(this._curData.friendId);
			if(chatList==null || chatList.length==0){
				this.friendAction.sendMsgList(this._curData.friendId);
			}
			else{
				this.onChatList(this._curData.friendId);
			}
		}
	}

	__proto.onChatList=function(friendId){
		this._chat.clear();
		var chatList=this.friendSession.getFriendChatList(this._curData.friendId);
		if(chatList && chatList.length > 0){
			for(var i=0;i < chatList.length;i++){
				this.addMsg(chatList[i]);
			}
		}
	}

	__proto.sendMsg=function(){
		if(this._curData==null){
			FlyUpTips.setTips("请选择一个好友",1000,"#ff0000");
			return;
		}
		if(this.lastTime !=0 && Browser.now()-this.lastTime <=5000){
			var ss=5000+this.lastTime-Browser.now();
			ss=ss / 1000;
			ss=Math.ceil(ss);
			FlyUpTips.setTips("发言过于频繁，请休息"+ss+"秒再发言",1000,"#ff0000");
			return;
		}
		if(this.txt1.text==""){
			FlyUpTips.setTips("聊天内容不能为空",1000,"#ff0000");
			return;
		}
		this.friendAction.sendMsg(this._curData.friendId,this.txt1.text);
		this.txt1.text="";
		this.lastTime=Browser.now();
	}

	__proto.addMsg=function(data,isRead){
		(isRead===void 0)&& (isRead=false);
		var curr=0;
		if(data.isSelf){
			curr=data.toId;
		}
		else{
			curr=data.fromId;
		}
		if(this.currFriendId==curr){
			this._chat.addMsg(data);
			if(isRead)this.friendAction.readXiaoXi(this.currFriendId);
		}
	}

	__proto.onDelete=function(friendId){
		if(friendId==this._curData.friendId){
			this._chat.clear();
			this._curData=null;
		}
	}

	__proto.onUpdate=function(friendId){
		for(var item in this.curShowList.cells){
			if(item && item.data && item.data.friendId==friendId){
				item.update(this.friendSession.getFriend(friendId));
				break ;
			}
		}
	}

	__proto.refresh=function(){
		var arr=this.friendSession.getList(this.tab0.selectedIndex);
		this.curShowList.array=arr;
		this.boxb.addChild(this.curShowList);
		if(arr.length > 0){
			if(this.currFriendId==-1){
				this.updateRightView(arr[0],0);
			}
			else{
				if(this.len!=arr.length){
					this.updateRightView(arr[0],0);
				}
				else{
					for(var i=0;i<arr.length;i++){
						var fdata=arr[i];
						if(this.currFriendId==fdata.friendId){
							this.updateRightView(this.friendSession.getFriend(this.currFriendId),i);
							break ;
						}
					}
				}
				this.len=arr.length;
			}
		}
		else{
			this._chat.clear();
		}
	}

	__proto.onSelect=function(index){
		this.liaotian.visible=this.tianjia.visible=this.box1.visible=index < 2;
		this.lingqu.visible=this.huigu.visible=this.shan.visible=this.shanyj.visible=index==3;
		this.heimingdan.text=this.txt_yj.text="";
		this.boxb.removeChildren();
		this.box0.visible=false;
		this.mailUi();
		if(index < 3){
			if(index < 2){
				this._chat.clear();
			}
			if(this.curShowList){
				this.curShowList.removeSelf();
			}
			this.curShowList=this.listArr[index];
			this.refresh();
			if(index==2){
				this.heimingdan.text="加入黑名单后您将不会收到来自该玩家的消息，也不会在任何聊天频道看到该玩家的发言";
			}
		}
		else if(index==3){
			if(!this.mail){
				this.mail=new MailPanel();
			}
			this.mail.setSelect();
			this.boxb.addChild(this.mail);
		}
	}

	__proto.mailHandler=function(data){
		this.currData=data;
		this.mailUi();
		if(this.currData.mailType!=MailType.ZHANBAO){
			this.wanjiaming.text="亲爱的"+this.mainPlayerSession.mainPlayerData.playerName+":";
			this.txt_yj.text="\n\n"+data.mailContent;
			this.setItem(data.itemArr);
			if(data.itemArr.length>0 && data.isRead!=2){
				this.lingqu.visible=true;
			}
			else{
				this.shanyj.visible=true;
			}
		}
		switch (data.mailType){
			case 1:
				this.huigu.visible=true;
				this.mailBattleSession.currBattleUrl=data.contentArr[0];
				break ;
			case MailType.ZHANBAO:
				App.dialogManager.showMiniDialog(FriendTiaoZhan,true,true);
				break ;
			}
	}

	__proto.clearItem=function(){
		if(this.panel){
			this.panel.removeChildren();
			this.panel.removeSelf();
			this.panel.destroyChildren();
			this.panel.destroy();
			this.panel=null;
		}
	}

	__proto.setItem=function(arr){
		this.clearItem();
		if(arr.length==0)return;
		this.panel=new Panel();
		this.addChild(this.panel);
		this.panel.pos(455,495);
		this.panel.size(500,80);
		this.panel.hScrollBarSkin="";
		var _index=0;
		for(var i=0;i<arr.length;i+=2){
			var image=new Image();
			image.skin="comp/G/g.png";
			this.panel.addChild(image);
			image.x=(image.width)*_index;
			var item=new Item();
			item.size(70,70);
			var id=arr[i];
			if(id==0){
				item.setItemId(arr[i+1],false);
				item.setNum(1);
				}else{
				item.setItemId(arr[i]);
				item.setNum(arr[i+1]);
			}
			image.addChild(item);
			item.x=4;
			item.y=5;
			_index++;
		}
		this.panel.hScrollBar.setScroll(0,this.panel.contentHeight,0);
	}

	__proto.mailUi=function(){
		this.wanjiaming.text="";
		this.txt_yj.text="";
		this.huigu.visible=false;
		this.shanyj.visible=false;
		this.lingqu.visible=false;
		this.clearItem();
	}

	__proto.shanAll=function(){
		var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
		alert.setAll("","将为您保留未领取物品的邮件",new Handler(this,this.shanChuAllMail));
	}

	__proto.shanChuAllMail=function(){
		this.mailAction.deleteAll();
	}

	__proto.shanChu=function(){
		var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
		alert.setAll("","确定删除此邮件吗？",new Handler(this,this.shanChuMail));
	}

	__proto.lingQu=function(){
		this.mailAction.getItem(this.currData.mailId);
	}

	__proto.shanChuMail=function(){
		if(this.currData && this.currData.mailId!=-1){
			this.mailAction.deleteMail(this.currData.mailId);
		}
	}

	__proto.huiGu=function(){
		this.mailBattleSession.load(this.mailBattleSession.currBattleUrl);
	}

	//"1531819084609"
	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.tab0.selectedIndex=0;
	}

	return Haoyou;
})(haoyouUI)


//class huamao.panel.myMessage.TipsAddBlackList extends ui.SLGGAME.tips_tsUI
var TipsAddBlackList=(function(_super){
	function TipsAddBlackList(){
		this.friendAction=null;
		this.playerId=0;
		TipsAddBlackList.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsAddBlackList,'huamao.panel.myMessage.TipsAddBlackList',_super);
	var __proto=TipsAddBlackList.prototype;
	__proto.setData=function(playerid,name){
		this.playerId=playerid;
		this.txt1.text="确定将"+name+"拉入到黑名单？";
	}

	__proto.init=function(){
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.box0.visible=false;
	}

	__proto.queDingCB=function(){
		this.friendAction.sendAddBlackList(this.playerId);
		this.quXiaoCB();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	return TipsAddBlackList;
})(tips_tsUI)


//class huamao.panel.haoyou.HaoyouJieSuan extends ui.SLGGAME.haoyou_jiesuanUI
var HaoyouJieSuan=(function(_super){
	function HaoyouJieSuan(){
		this.mailSession=null;
		this.data=null;
		this.shouFenAction=null;
		this.shouFenSession=null;
		this.autoEvent=null;
		HaoyouJieSuan.__super.call(this);
		App.injOne(this);
		this.init();
		this.on("click",this,this.clickFun);
	}

	__class(HaoyouJieSuan,'huamao.panel.haoyou.HaoyouJieSuan',_super);
	var __proto=HaoyouJieSuan.prototype;
	__proto.clickFun=function(e){
		if(!((e.target instanceof laya.ui.Button ))){
			this.close();
		}
	}

	__proto.init=function(){
		this.autoEvent=new AutoEvent(this);
		this.data=this.mailSession.currTiaoZhanData;
		this.jg_0.text=this.data.atkName;
		this.jg_txt.text=(this.data.atkTroops-this.data.atkLoseReoops)+"/"+this.data.atkTroops;
		this.jg_1.value=(this.data.atkTroops-this.data.atkLoseReoops)/this.data.atkTroops;
		this.jg_2.text=this.data.atkLoseReoops+"";
		this.fs_0.text=this.data.defenseName;
		this.fs_txt.text=(this.data.defenseTroops-this.data.defenseLoseTroops)+"/"+this.data.defenseTroops;
		this.fs_1.value=(this.data.defenseTroops-this.data.defenseLoseTroops)/this.data.defenseTroops;
		this.fs_2.text=this.data.defenseLoseTroops+"";
		this.haoyou.on("click",this,this.tiaoZhan);
		this.shoucang.on("click",this,this.shouCang);
		this.fenxiang.on("click",this,this.fenXiang);
		this.tongji.on("click",this,this.tongJi);
		this.huifang.on("click",this,this.huiFang);
		this.autoEvent.add("SHOUCANG_SUCCESS",this,this.onUpdate);
		this.autoEvent.addEventNow();
		this.shengli.skin=((this.data.result==0)? "comp/haoyou/shegnli.png" :"comp/haoyou/shibai.png");
	}

	__proto.onUpdate=function(id){
		if(this.data.battleId==id){
			this.shoucang.label=this.shouFenSession.getIsHas(this.data.battleId)? "取消收藏" :"收藏";
		}
	}

	__proto.huiFang=function(){
		this.close();
		App.eventManager.event("BATTLE",this.data.URL);
	}

	__proto.tongJi=function(){
		App.dialogManager.openDialogByStr("TONGJI",{battleId:this.data.URL},true,true);
	}

	__proto.fenXiang=function(){
		App.dialogManager.openDialogByStr("FENXIANG",{battleId:this.data.battleId},true,true);
	}

	__proto.shouCang=function(){
		if(this.shouFenSession.getIsHas(this.data.battleId)){
			this.shouFenAction.sendQuxiao(this.data.battleId);
		}
		else{
			this.shouFenAction.sendShoucang(this.data.battleId,0);
		}
	}

	__proto.tiaoZhan=function(){
		App.dialogManager.openDialogByStr("ZHENGRONGXUANZE",{friendId:this.data.friendId},true,true);
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		this.mailSession.currTiaoZhanData=null;
	}

	return HaoyouJieSuan;
})(haoyou_jiesuanUI)


//class huamao.panel.haoyou.youjian.BattlePanel extends ui.SLGGAME.haoyou_zkhgUI
var BattlePanel=(function(_super){
	function BattlePanel(){
		this.mailBattleSession=null;
		this._playerList=null;
		this.autoEvent=null;
		this.panel=null;
		this.isplayer=true;
		this.remY=0;
		this.fps=[1,2,5,20];
		this._index=0;
		BattlePanel.__super.call(this);
		this.init();
	}

	__class(BattlePanel,'huamao.panel.haoyou.youjian.BattlePanel',_super);
	var __proto=BattlePanel.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.mailBattleSession.mapScaleX=3840 / this.box.width;
		this.mailBattleSession.mapScaleY=2560 / this.box.height;
		var cityData;
		for(var $each_cityData in this.mailBattleSession.getCityObj()){
			cityData=this.mailBattleSession.getCityObj()[$each_cityData];
			var cell;
			if(this.mailBattleSession.mapCellObj[cityData.cityId] !=null){
				cell=this.mailBattleSession.mapCellObj[cityData.cityId];
			}
			else{
				cell=new BattleMapCell();
				this.mailBattleSession.mapCellObj[cityData.cityId]=cell;
			}
			cell.init(cityData);
			this.box.addChild(cell);
		}
		this._playerList=new BattleList();
		this.addChild(this._playerList);
		this._playerList.x=847;
		this._playerList.y=66;
		this._playerList.on("click",this,this.onClick);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("BATTLEPLAYERUPDATA",this,this.upData);
		this.autoEvent.add("BATTLECHAT",this,this.upDataChat);
		this.autoEvent.add("BATTLEPLAY",this,this.battlePlay);
		this.autoEvent.add("BATTLEJINDU",this,this.battleJinDu);
		this.autoEvent.addEventNow();
		this.btn2.on("click",this,this.fpsFun);
		this.btn2.label="×"+this.fps[this._index];
		this.btn0.on("click",this,this.closeFun);
		this.btn1.on("click",this,this.playStopFun);
		this.zanting.on("click",this,this.playStopFun);
		this.zhanbao.on("click",this,this.zhanBao);
		this.panel=new Panel();
		this.addChild(this.panel);
		this.panel.pos(this.dd.x,this.dd.y);
		this.panel.size(714,this.dd.height);
		this.panel.vScrollBarSkin="";
		this.addChild(this.zhanbao);
		var startTime=this.mailBattleSession.newTime;
		var openTime=this.mailBattleSession.openTime;
		var endTime=this.mailBattleSession.endTime;
		var open=openTime-startTime;
		var max=endTime-startTime;
		this.d.width=this.j1.width*(open/max);
		this.closeFun();
		this.upData();
	}

	__proto.playStopFun=function(){
		if(this.isplayer){
			this.mailBattleSession.startFun();
		}
		else{
			this.mailBattleSession.colseTime();
		}
		this.isplayer=!this.isplayer;
	}

	__proto.zhanBao=function(){
		App.dialogManager.openDialogByStr("MAILBATTLE");
	}

	__proto.battleJinDu=function(time){
		var startTime=this.mailBattleSession.newTime;
		var openTime=this.mailBattleSession.openTime;
		var endTime=this.mailBattleSession.endTime;
		var maxTime=endTime-startTime;
		this.j1.scrollRect=new Rectangle(0,0,time/maxTime *this.j1.width,this.j1.height);
		var open=openTime-startTime;
		if(time>open)return;
		this.d.scrollRect=new Rectangle(0,0,time/open *this.d.width,this.d.height);
	}

	__proto.battlePlay=function(num){
		if(num==1){
			this.btn1.visible=true;
			this.zanting.visible=false;
		}
		else{
			this.btn1.visible=false;
			this.zanting.visible=true;
		}
	}

	__proto.upDataChat=function(str){
		var txt=new Label();
		txt.pos(0,this.remY);
		this.panel.addChild(txt);
		this.remY+=20;
		txt.text=str+this.remY;
		txt.fontSize=15;
		txt.width=711;
		txt.wordWrap=true;
		txt.color="#debd7e";
		txt.stroke=2;
		txt.strokeColor="#2c1b09";
		this.panel.vScrollBar.setScroll(0,this.panel.contentHeight,this.panel.contentHeight);
	}

	__proto.closeFun=function(){
		this.isplayer=true;
		this.btn1.visible=true;
		this.zanting.visible=false;
		this._index=-1;
		this.fpsFun();
		this.mailBattleSession.closeData();
		this._playerList.clearSelectItem();
	}

	__proto.fpsFun=function(){
		if(this._index==3){
			this._index=-1;
		}
		this._index++;
		this.mailBattleSession.fpsNum=this.fps[this._index];
		this.btn2.label="×"+this.fps[this._index];
	}

	__proto.onClick=function(e){
		if((e.target instanceof huamao.panel.haoyou.youjian.BattleItem )){
			var item=e.target;
			item && this.setBorderPos(item);
			var cell;
			for(var $each_cell in this.mailBattleSession.mapCellObj){
				cell=this.mailBattleSession.mapCellObj[$each_cell];
				cell.isSelect=cell.playerId==item.playerId;
			}
		}
	}

	__proto.setBorderPos=function(item){
		this.mailBattleSession.currPlayerId=item.playerId;
		this._playerList.selectItem(item);
	}

	__proto.upData=function(){
		this._playerList.update(this.mailBattleSession.getPlayerArr());
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		this.mailBattleSession.colseTime();
	}

	return BattlePanel;
})(haoyou_zkhgUI)


//class huamao.panel.haoyou.youjian.FriendTiaoZhan extends ui.SLGGAME.haoyou_tzUI
var FriendTiaoZhan=(function(_super){
	function FriendTiaoZhan(){
		this.list=null;
		this.mailSession=null;
		this.friendAction=null;
		this.autoEvent=null;
		this.arr=null;
		FriendTiaoZhan.__super.call(this);
		this.init();
	}

	__class(FriendTiaoZhan,'huamao.panel.haoyou.youjian.FriendTiaoZhan',_super);
	var __proto=FriendTiaoZhan.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.friendAction.sendBattleList();
		this.qingkong.on("click",this,this.qingKongHandler);
		this.list=new List();
		this.list.x=16;
		this.list.y=63;
		this.list.width=917;
		this.list.height=448;
		this.list.itemRender=TiaoZhanItem;
		this.list.repeatX=1;
		this.list.repeatY=4;
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.on("click",this,this.onSeleFun);
		this.list.vScrollBarSkin="";
		this.list.selectEnable=true;
		this.addChild(this.list);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("BATTLEUPDATA",this,this.upData);
		this.autoEvent.addEventNow();
		this.upData();
		this.yidu.on("click",this,this.allDuQu);
	}

	__proto.onSeleFun=function(e){
		if((e.target instanceof huamao.panel.haoyou.youjian.TiaoZhanItem )){
			var item=e.target;
			if(item.currData.isRead==0){
				this.friendAction.readBattleYIGE(item.currData.battleId);
			}
			console.log("item.currData.isRead:"+item.currData.isRead);
			this.mailSession.currTiaoZhanData=item.currData;
			App.dialogManager.showMiniDialog(HaoyouJieSuan,true,true);
		}
	}

	__proto.allDuQu=function(){
		this.friendAction.allReadBattle();
	}

	__proto.qingKongHandler=function(){
		var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
		alert.setAll("","确定清空所有好友挑战战报吗？",new Handler(this,this.deleteAll));
	}

	__proto.deleteAll=function(){
		this.friendAction.sendDeleteAllBattle();
	}

	__proto.updateItem=function(cell,index){
		cell.upData(cell.dataSource);
	}

	__proto.upData=function(){
		this.arr=this.mailSession.getBattleArr();
		this.list.array=this.arr;
	}

	return FriendTiaoZhan;
})(haoyou_tzUI)


//class huamao.panel.shop.TipsClearCD extends ui.SLGGAME.tips_tsUI
var TipsClearCD=(function(_super){
	function TipsClearCD(){
		// private var label:Label;
		this.shopAction=null;
		TipsClearCD.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsClearCD,'huamao.panel.shop.TipsClearCD',_super);
	var __proto=TipsClearCD.prototype;
	__proto.init=function(){
		var posx=10;
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.check1.visible=true;
		this.checktext.visible=true;
		this.check1.on("change",this,this.checkBoxCB);
	}

	__proto.checkBoxCB=function(){
		TipsClearCD.IFVIEW=!this.check1.selected;
	}

	__proto.queDingCB=function(){
		this.shopAction.sendFlushItemOrClearCD();
		this.close();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	__proto.setTime=function(value){
		if(value <=0){
			value=0;
		};
		var v=value/TipsClearCD.TEN_MIN;
		v=parseInt(""+v);
		if(value%TipsClearCD.TEN_MIN > 0){
			v+=1;
		};
		var systimetake=ConfigManager.getConfig("sys_timetake.txt",0);
		if(v > systimetake.diamondCost){
			v=systimetake.diamondCost;
		}
		this.shu0.text=v+"";
		this.txt1.text="您确定要消耗"+v+"元宝，刷新商店吗？";
	}

	TipsClearCD.TEN_MIN=60*10;
	TipsClearCD.IFVIEW=true;
	return TipsClearCD;
})(tips_tsUI)


//class huamao.panel.shop.tipsForBuySilver extends ui.SLGGAME.tips_tsUI
var tipsForBuySilver=(function(_super){
	function tipsForBuySilver(){
		this.shopAction=null;
		this._buyid=0;
		tipsForBuySilver.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(tipsForBuySilver,'huamao.panel.shop.tipsForBuySilver',_super);
	var __proto=tipsForBuySilver.prototype;
	__proto.init=function(){
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.check1.visible=true;
		this.checktext.visible=true;
		this.check1.on("change",this,this.checkBoxCB);
	}

	__proto.checkBoxCB=function(){
		tipsForBuySilver.IFVIEW=!this.check1.selected;
	}

	__proto.setId=function(id,buyNum){
		this._buyid=id;
		this.shu0.text=buyNum+"";
		this.txt1.text="购买该物品将消耗"+buyNum+"元宝，确定要购买该物品吗？";
	}

	__proto.queDingCB=function(){
		this.shopAction.sendBuySilver(this._buyid);
		this.close();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	tipsForBuySilver.IFVIEW=true;
	return tipsForBuySilver;
})(tips_tsUI)


//class huamao.panel.shop.TipsPayBuyGold extends ui.SLGGAME.tips_tsUI
var TipsPayBuyGold=(function(_super){
	function TipsPayBuyGold(){
		this.shopAction=null;
		this.BuyIdx=0;
		TipsPayBuyGold.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsPayBuyGold,'huamao.panel.shop.TipsPayBuyGold',_super);
	var __proto=TipsPayBuyGold.prototype;
	__proto.init=function(){
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.check1.visible=true;
		this.checktext.visible=true;
		this.check1.on("change",this,this.checkBoxCB);
	}

	__proto.checkBoxCB=function(){
		TipsPayBuyGold.IFVIEW=!this.check1.selected;
	}

	__proto.setId=function(buyNum,index){
		this.BuyIdx=index;
		this.shu0.text=buyNum+"";
		this.txt1.text="购买该物品将消耗"+buyNum+"元宝，确定要购买该物品吗？";
	}

	__proto.queDingCB=function(){
		this.shopAction.sendBuyItem(this.BuyIdx);
		this.close();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	TipsPayBuyGold.IFVIEW=true;
	return TipsPayBuyGold;
})(tips_tsUI)


//class huamao.panel.haoyou.youjian.MailBattleJieSuan extends ui.SLGGAME.zhanbao_jiesuanUI
var MailBattleJieSuan=(function(_super){
	function MailBattleJieSuan(){
		this.mainPlayerSession=null;
		this.shouFenAction=null;
		this.shouFenSession=null;
		this.autoEvent=null;
		this.obj={};
		this.currData=null;
		MailBattleJieSuan.__super.call(this);
		this.init();
	}

	__class(MailBattleJieSuan,'huamao.panel.haoyou.youjian.MailBattleJieSuan',_super);
	var __proto=MailBattleJieSuan.prototype;
	__proto.show=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.show.call(this,closeOther,showEffect);
		this.setData(this.tag);
	}

	__proto.init=function(){
		App.injOne(this);
		this.autoEvent=new AutoEvent(this);
		this.jl_2.text="";
		this.shoucang.x=this.fenxiang.x;
		this.fenxiang.visible=false;
		this.shoucang.on("click",this,this.shouCang);
		this.tongji.on("click",this,this.tongJi);
		this.huifang.on("click",this,this.huiFang);
		this.autoEvent.add("SHOUCANG_SUCCESS",this,this.onUpdate);
		this.autoEvent.addEventNow();
		this.on("click",this,this.clickFun);
	}

	__proto.clickFun=function(e){
		if(!((e.target instanceof laya.ui.Button ))){
			this.close();
		}
	}

	__proto.onUpdate=function(id){
		if(this.currData.battleId==id){
			this.shoucang.label=this.shouFenSession.getIsHas(this.currData.battleId)? "取消收藏" :"收藏";
		}
	}

	__proto.huiFang=function(){
		this.close();
		App.eventManager.event("BATTLE",this.currData.URL);
	}

	__proto.tongJi=function(){
		App.dialogManager.openDialogByStr("TONGJI",{battleId:this.currData.URL},true,true);
	}

	__proto.shouCang=function(){
		if(this.shouFenSession.getIsHas(this.currData.battleId)){
			this.shouFenAction.sendQuxiao(this.currData.battleId);
		}
		else{
			this.obj.time=this.currData.time;
			this.obj.cityId=this.currData.cityId;
			this.obj.atkName=this.currData.atkName;
			this.obj.atkTroops=this.currData.atkTroops;
			this.obj.atkLoseTroops=this.currData.atkLoseReoops;
			this.obj.defenseTroops=this.currData.defenseTroops;
			this.obj.defenseLoseTroops=this.currData.defenseLoseTroops;
			this.obj.URL=this.currData.URL;
			this.shouFenAction.sendShoucang(this.currData.battleId,2,this.obj);
		}
	}

	__proto.setData=function(data){
		this.currData=data;
		this.jg_0.text=data.atkName;
		this.jg_1.value=(data.atkTroops-data.atkLoseReoops)/ data.atkTroops;
		this.jg_txt.text=(data.atkTroops-data.atkLoseReoops)+"/"+data.atkTroops;
		this.jg_2.text=data.atkLoseReoops+"";
		var sysCity=ConfigManager.getConfig("sys_city.txt",data.cityId);
		if(data.defenseId==0){
			this.fs_0.text=sysCity.cityName+"守军";
			this.obj.defenseName="";
		}
		else{
			this.fs_0.text=data.defenseName;
			this.obj.defenseName=data.defenseName;
		}
		this.fs_1.value=(data.defenseTroops-data.defenseLoseTroops)/ data.defenseTroops;
		this.fs_txt.text=(data.defenseTroops-data.defenseLoseTroops)+"/"+data.defenseTroops;
		this.fs_2.text=data.defenseLoseTroops+"";
		if(this.mainPlayerSession.mainPlayerData.playerId==data.atkId){
			this.obj.type=0;
			if(data.type==1){
				this.obj.result=0;
				this.img_0.skin="comp/haoyou/shengli.png";
			}
			else{
				this.obj.result=1;
				this.img_0.skin="comp/haoyou/shibai.png";
			}
			this.jl_1.text=data.atkExp+"";
			this.obj.exp=data.atkExp;
			this.obj.newexp=data.newatkExp;
		}
		else{
			this.obj.type=1;
			if(data.type==0){
				this.obj.result=0;
				this.img_0.skin="comp/haoyou/shengli.png";
			}
			else{
				this.obj.result=1;
				this.img_0.skin="comp/haoyou/shibai.png";
			}
			this.jl_1.text=data.defenseExp+"";
			this.obj.exp=data.defenseExp;
			this.obj.newexp=data.newdefenseExp;
		}
	}

	return MailBattleJieSuan;
})(zhanbao_jiesuanUI)


//class huamao.panel.haoyou.youjian.MailBattlePanel extends ui.SLGGAME.zhanbaoUI
var MailBattlePanel=(function(_super){
	function MailBattlePanel(){
		this.list=null;
		this.mailBattleSession=null;
		MailBattlePanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(MailBattlePanel,'huamao.panel.haoyou.youjian.MailBattlePanel',_super);
	var __proto=MailBattlePanel.prototype;
	__proto.init=function(){
		this.btn0.visible=false;
		this.btn1.visible=false;
		this.list=new List();
		this.list.x=14;
		this.list.y=58;
		this.list.height=452;
		this.list.itemRender=MailBattleItem;
		this.list.repeatX=1;
		this.list.repeatY=4;
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.selectHandler=new Handler(this,this.seleFun);
		this.list.vScrollBarSkin="";
		this.list.selectEnable=true;
		this.addChild(this.list);
		this.setData();
	}

	__proto.updateItem=function(cell,index){
		cell.upData(cell.dataSource);
	}

	__proto.seleFun=function(index){
		if(index<0)return;
		App.dialogManager.openDialogByStr("Mail_Battle_Jie_Suan",this.list.array[index]);
		this.list.selectedIndex=-1;
	}

	__proto.setData=function(){
		var arr=this.mailBattleSession.battleArr;
		this.list.array=arr;
	}

	return MailBattlePanel;
})(zhanbaoUI)


//class huamao.panel.stratagem.TipsStratagemBuy2 extends ui.SLGGAME.tips_tsUI
var TipsStratagemBuy2=(function(_super){
	function TipsStratagemBuy2(){
		this.stratagemAction=null;
		TipsStratagemBuy2.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsStratagemBuy2,'huamao.panel.stratagem.TipsStratagemBuy2',_super);
	var __proto=TipsStratagemBuy2.prototype;
	__proto.init=function(){
		var lbl_tishi=new Label();
		lbl_tishi.color="#7f8b96";
		lbl_tishi.fontSize=22;
		lbl_tishi.text="提示：每隔10分钟恢复计策令*1";
		lbl_tishi.pos(106,327);
		this.addChild(lbl_tishi);
		var data=ConfigManager.getConfig("sys_timetake.txt",47);
		var jicelingNum=data.timeCd;
		var yuanbaoNum=data.timeMax;
		this.txt1.text="购买"+jicelingNum+"个计策令将消耗"+yuanbaoNum+"元宝，确定要购买吗？";
		this.shu0.text=yuanbaoNum+"";
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.check1.visible=true;
		this.checktext.visible=true;
		this.check1.on("change",this,this.checkBoxCB);
	}

	__proto.checkBoxCB=function(){
		TipsStratagemBuy2.IFVIEW=!this.check1.selected;
	}

	__proto.queDingCB=function(){
		this.stratagemAction.sendBuyStratagemOrder();
		this.close();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	TipsStratagemBuy2.IFVIEW=true;
	return TipsStratagemBuy2;
})(tips_tsUI)


//class huamao.panel.haoyou.ZhenrongXuanze extends ui.SLGGAME.haoyou_zrxzUI
var ZhenrongXuanze=(function(_super){
	function ZhenrongXuanze(){
		this._fromKa=null;
		this._fromCell=null;
		this._toKa=null;
		this._toCell=null;
		this._fromKaCopy=null;
		this._fromCellCopy=null;
		this._toKaCopy=null;
		this._toCellCopy=null;
		this._uiLayer=null;
		this._kaLayer=null;
		this.friendSession=null;
		this.friendAction=null;
		this.wuJiangSession=null;
		this._head=null;
		this.zhenRong0=[0,3,6];
		//最后面的替补下标
		this.zhenRong1=[1,4,7];
		//最后面的替补下标
		this.zhenRong2=[2,5,8];
		this.downIndex=-1;
		this._isDrag=false;
		this._tmpRect=null;
		this._friendData=null;
		this._cellObj=new Object();
		this._kaObj=new Object();
		ZhenrongXuanze.__super.call(this);
		App.injOne(this);
		this._uiLayer=new Sprite;
		this.addChild(this._uiLayer);
		this._uiLayer.pos(50,70);
		this._kaLayer=new Sprite;
		this.addChild(this._kaLayer);
		this._kaLayer.pos(this._uiLayer.x,this._uiLayer.y);
		for(var i=0;i < 9;i++){
			var col=i % 3;
			var row=i / 3;
			var cell=new ChuzhengCell();
			cell.pos(col *180,parseInt(row+"")*165);
			cell.x+=-20;
			cell.y-=10;
			cell.isMax=true;
			cell.index=i;
			this._cellObj[i]=cell;
			this._uiLayer.addChild(cell);
			var ka=new ChuzhengKa();
			ka.pos(cell.x,cell.y);
			ka.index=i;
			this._kaObj[i]=ka;
			ka.visible=false;
			this._kaLayer.addChild(ka);
		}
		this._head=new Image();
		this._head.size(76,76);
		this.box0.addChild(this._head);
		this._fromKaCopy=new ChuzhengKa();
		this._fromCellCopy=new ChuzhengCell();
		this._toKaCopy=new ChuzhengKa();
		this._toCellCopy=new ChuzhengCell();
		this.zhenr.on("click",this,this.onSave);
		this.chuzhan.on("click",this,this.onChuzhan);
		this._kaLayer.on("mousedown",this,this.onKaDown);
		this._kaLayer.on("mouseup",this,this.onKaUp);
		this._kaLayer.on("mouseout",this,this.onKaUp);
		App.eventManager.on("CANLE_BUZHENG_ITEM",this,this.onCancelItem);
		App.eventManager.on("SET_SELECT_WUJIANG",this,this.onSet);
	}

	__class(ZhenrongXuanze,'huamao.panel.haoyou.ZhenrongXuanze',_super);
	var __proto=ZhenrongXuanze.prototype;
	__proto.getZhenrong=function(){
		var zhenrong="";
		var heroIds=[];
		var ka;
		for(var $each_ka in this._kaObj){
			ka=this._kaObj[$each_ka];
			if(ka.heroData){
				heroIds.push([ka.index,ka.heroData.heroId]);
				zhenrong+=",";
				zhenrong+=ka.index+","+ka.heroData.heroId;
			}
		}
		return zhenrong.substring(1);
	}

	__proto.onSave=function(){
		this.friendAction.sendSaveZhenrong(this.getZhenrong());
	}

	__proto.onChuzhan=function(){
		this.friendAction.sendChuzhan(this._friendData.friendId,this.getZhenrong());
		this.close();
	}

	__proto.onKaDown=function(e){
		this._isDrag=false;
		if((e.target instanceof huamao.panel.chuzheng.ChuzhengKa )){
			Laya.timer.clear(this,this.onKa);
			Laya.timer.once(1000,this,this.onKa,[e.target]);
		}
	}

	__proto.onKa=function(ka){
		this._isDrag=true;
		this._fromKa=ka;
		this._fromKa.visible=false;
		this.downIndex=this._fromKa.index;
		this._fromCell=this._cellObj[this._fromKa.index];
		this._fromKaCopy.update(this._fromKa.heroData,true);
		this._fromKaCopy.scale(1.2,1.2);
		this._fromKaCopy.pos(ka.x-0.1 *this._fromKaCopy.width,ka.y-0.1 *this._fromKaCopy.height);
		this._kaLayer.addChild(this._fromKaCopy);
		this._fromKaCopy.startDrag();
	}

	__proto.onKaUp=function(){
		Laya.timer.clear(this,this.onKa);
		if(!this._isDrag){
			return;
		}
		this._isDrag=false;
		this._toKa=null;
		this._toCell=null;
		if(this._fromKa.heroData){
			var p=this._uiLayer.getMousePoint();
			var cell;
			for(var $each_cell in this._cellObj){
				cell=this._cellObj[$each_cell];
				if(cell !=this._fromCell){
					this._tmpRect=new Rectangle(cell.x,cell.y,cell.width,cell.height);
					if(this._tmpRect.contains(p.x,p.y)&& cell.limit==false){
						this._toKa=this._kaObj[cell.index];
						this._toCell=cell;
						break ;
					}
				}
			}
		}
		this._fromKaCopy.scale(1,1);
		this._fromKaCopy.stopDrag();
		if(this._toKa==null && this._toCell==null){
			Tween.to(this._fromKaCopy,{x:this._fromCell.x,y:this._fromCell.y},100,null,new Handler(this,this.onSwap0));
			return;
		}
		if(this._toKa.heroData==null || this._toKa.visible==false){
			this._toKa.visible=true;
			this._toKa.update(this._fromKaCopy.heroData,true);
			if(this._toKa && this.oneZhenrong(this._toKa.index)==false){
				Tween.to(this._fromKaCopy,{x:this._fromCell.x,y:this._fromCell.y},100,null,new Handler(this,this.onSwap0));
				return;
			}
			this._fromKaCopy.removeSelf();
			this.downIndex=-1;
			this._toCell.visible=false;
			this._uiLayer.addChild(this._toCellCopy);
			this._toCellCopy.pos(this._toCell.x,this._toCell.y);
			Tween.to(this._toCellCopy,{x:this._fromCell.x,y:this._fromCell.y},this.getDelay(),null,new Handler(this,this.onSwap1));
			return;
		}
		this._fromKaCopy.removeSelf();
		this._toKaCopy.update(this._toKa.heroData,true);
		this._kaLayer.addChild(this._toKaCopy);
		this._toKaCopy.pos(this._toKa.x,this._toKa.y);
		this._fromKa.update(this._toKa.heroData,true);
		this._toKa.update(this._fromKaCopy.heroData,true);
		Tween.to(this._toKaCopy,{x:this._fromCell.x,y:this._fromCell.y},this.getDelay(),null,new Handler(this,this.onSwap2));
	}

	__proto.getDelay=function(){
		var deltaX=this._toCell.x-this._fromCell.x;
		var deltaY=this._toCell.y-this._fromCell.y;
		var distance=Math.sqrt(deltaX *deltaX+deltaY *deltaY);
		var delay=parseInt(distance+"")*0.5;
		return delay;
	}

	__proto.onSwap0=function(){
		this._fromCell.visible=false;
		this._fromKa.visible=true;
		this.removeCopy();
	}

	__proto.onSwap1=function(){
		this._fromCell.visible=true;
		this._fromKa.visible=false;
		this._fromKa.heroData=null;
		if(this._toCell){
			this._toCell.visible=false;
		}
		if(this._toKa){
			this._toKa.visible=true;
		}
		this.removeCopy();
	}

	__proto.onSwap2=function(){
		this._fromKa.visible=true;
		this._toKa.visible=true;
		this._fromCell.visible=false;
		this._toCell.visible=false;
		if(this._toKa && this.oneZhenrong(this._toKa.index)==false){
			Tween.to(this._fromKaCopy,{x:this._fromCell.x,y:this._fromCell.y},100,null,new Handler(this,this.onSwap0));
			return;
		}
		this.downIndex=-1;
		this.removeCopy();
	}

	__proto.removeCopy=function(){
		this._isDrag=false;
		this._fromKaCopy.removeSelf();
		this._toKaCopy.removeSelf();
		this._fromCellCopy.removeSelf();
		this._toCellCopy.removeSelf();
	}

	__proto.onCancelItem=function(index){
		var cell=this._cellObj[index];
		cell.visible=true;
		var ka=this._kaObj[index];
		delete this.friendSession.selectedZhenrongObj[index];
		ka.visible=false;
		ka.heroData=null;
		this.updateMixSkill();
		this.deleteZhenRong(index);
	}

	__proto.onSet=function(idx,data){
		var cell=this._cellObj[idx];
		if(cell.limit==false){
			cell.visible=false;
			var ka=this._kaObj[idx];
			ka.update(data,true);
			ka.visible=true;
			this.friendSession.selectedZhenrongObj[idx]=data;
			this.updateMixSkill();
			this.deleteZhenRong(idx);
		}
	}

	__proto.updateMixSkill=function(){
		this.txt0.text="";
		var heroIdArr=[];
		var ka;
		for(var $each_ka in this._kaObj){
			ka=this._kaObj[$each_ka];
			if(ka.index > 5){
				continue ;
			}
			if(ka.heroData){
				heroIdArr.push(ka.heroData.heroId);
			}
		}
		if(heroIdArr.length <=1){
			return;
		};
		var mixObj=new Object();
		var $each_ka;
		for($each_ka in this._kaObj){
			ka=this._kaObj[$each_ka];
			if(ka.index > 5){
				continue ;
			}
			if(ka.heroData){
				var mixSkillIds=ka.heroData.sysHero.heroMixSkill.split(",");
				for(var j=0;j < mixSkillIds.length;j++){
					var mixSkillId=parseInt(mixSkillIds[j]);
					var sysMixSkill=ConfigManager.getConfig("sys_skill_mix.txt",mixSkillId);
					if(sysMixSkill==null){
						continue ;
					};
					var heroIds=sysMixSkill.mixSkillHero.split(",");
					var isHasAll=true;
					for(var i=0;i < heroIds.length;i++){
						var heroId=parseInt(heroIds[i]+"");
						if(heroIdArr.indexOf(heroId)==-1){
							isHasAll=false;
						}
					}
					if(isHasAll){
						mixObj[sysMixSkill.mixSkillId]=sysMixSkill.mixSkillName;
					}
				}
			}
		}
		var mixName;
		for(var $each_mixName in mixObj){
			mixName=mixObj[$each_mixName];
			this.txt0.text+=mixName+"\n";
		}
	}

	__proto.updateZhenrong=function(){
		this.friendSession.selectedZhenrongObj=new Object();
		if(this.friendSession.myZhenrong.length > 0){
			var arr=this.friendSession.myZhenrong.split(",");
			for(var i=0;i < arr.length;i+=2){
				var index=parseInt(arr[i]);
				var heroId=parseInt(arr[i+1]);
				var heroData=this.wuJiangSession.getHero(heroId);
				this.onSet(index,heroData);
			}
		}
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		var friendId=this.tag.friendId;
		this._friendData=this.friendSession.getFriend(friendId);
		this.txt0.text="";
		this._head.skin=GameUtils.getHeadUrl(this._friendData.style);
		this.updateZhenrong();
	}

	__proto.deleteZhenRong=function(index){
		for(var i=0;i<3;i++){
			var arr=this ["zhenRong"+i];
			for(var j=0;j<arr.length;j++){
				var in3=arr[arr.length-1];
				var in2=in3-3;
				var in1=in2-3;
				var ka1=this._kaObj[in1];
				var ka2=this._kaObj[in2];
				var ka3=this._kaObj[in3];
				var cell1=this._cellObj[in1];
				var cell2=this._cellObj[in2];
				var cell3=this._cellObj[in3];
				if(arr[arr.length-1] !=index){
					if(ka1.visible==false && ka2.visible==false){
						ka3.visible=false;
						cell3.visible=true;
					}
					}else{
					if(ka3.visible==true){
						if(ka1.visible==false && ka2.visible==false){
							ka3.visible=false;
							cell3.visible=true;
							FlyUpTips.setTips("当列前后排人数不够，替补位置无效");
						}
					}
				}
			}
		}
	}

	__proto.oneZhenrong=function(index){
		var boo=true;
		for(var i=0;i<3;i++){
			var arr=this ["zhenRong"+i];
			if(arr.indexOf(index)!=-1){
				var in3=arr[arr.length-1];
				var in2=in3-3;
				var in1=in2-3;
				var ka1=this._kaObj[in1];
				var ka2=this._kaObj[in2];
				var ka3=this._kaObj[in3];
				var cell1=this._cellObj[in1];
				var cell2=this._cellObj[in2];
				var cell3=this._cellObj[in3];
				if(arr[arr.length-1]==index){
					if(ka1.visible==false && ka2.visible==false){
						FlyUpTips.setTips("当列前后排人数不够，替补位置无效");
						boo=false;
					}
				}
			}
		}
		this.deleteZhenRong(index);
		return boo;
	}

	return ZhenrongXuanze;
})(haoyou_zrxzUI)


//class huamao.panel.hero.CheckOtherHero extends ui.SLGGAME.wujiangUI
var CheckOtherHero=(function(_super){
	function CheckOtherHero(){
		CheckOtherHero.__super.call(this);
		this.init();
	}

	__class(CheckOtherHero,'huamao.panel.hero.CheckOtherHero',_super);
	var __proto=CheckOtherHero.prototype;
	__proto.init=function(){
		this.list0.visible=true;
		this.tab0.visible=false;
		this.check0.visible=false;
		this.txt0.visible=false;
		this.txt1.visible=false;
		this.btn0.visible=false;
		this.list0.itemRender=HeroBox;
		this.list0.vScrollBarSkin="";
		this.list0.selectEnable=true;
		this.list0.renderHandler=new Handler(this,this.renderFun);
		Laya.timer.callLater(this,this.nextFun);
	}

	__proto.nextFun=function(){
		this.list0.array=this.tag;
	}

	__proto.renderFun=function(cell,index){
		cell.setHeroData(cell.dataSource ,2);
		cell.setEquip(false);
	}

	__proto.setHeroArr=function(arr){
		this.list0.array=arr;
	}

	return CheckOtherHero;
})(wujiangUI)


//class huamao.panel.myMessage.TipsChangeName extends ui.SLGGAME.tips_gmUI
var TipsChangeName=(function(_super){
	function TipsChangeName(){
		this.playerInfoAction=null;
		this.sensitiveSession=null;
		TipsChangeName.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsChangeName,'huamao.panel.myMessage.TipsChangeName',_super);
	var __proto=TipsChangeName.prototype;
	__proto.init=function(){
		this.quxiao.on("click",this,this.quXiaoCB);
		this.queding.on("click",this,this.queDingCB);
		this.qian0.text="100";
		this.name0.prompt="4-12个字符";
		this.name0.text="";
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	__proto.queDingCB=function(){
		var newName=this.name0.text;
		var namelen=GameUtils.getStringCharLen(newName);
		if(newName.indexOf(" ")!=-1){
			FlyUpTips.setTips("名称包含空格符");
			return;
		}
		if(namelen > 12 || namelen < 4){
			FlyUpTips.setTips("名字长度应在4-12个字符之间");
			return;
		}
		if(!this.sensitiveSession.IsSensitiveWord(newName)){
			FlyUpTips.setTips("名字包含敏感字符");
			return;
		}
		this.playerInfoAction.sendChangeName(newName);
		this.close();
	}

	return TipsChangeName;
})(tips_gmUI)


//class huamao.panel.huodong.HuodongPanel extends ui.SLGGAME.huodongUI
var HuodongPanel=(function(_super){
	function HuodongPanel(){
		this.duoBaoSession=null;
		this.tabBind=null;
		this.contentSp=null;
		this.tabArr=[];
		this.activitySession=null;
		this.tab=null;
		this.sevenrenwuSession=null;
		this.mainPlayerSession=null;
		this.mainPlayerData=new PlayerData();
		HuodongPanel.__super.call(this);
		App.injOne(this);
		this.tab0.labels=this.getLabels(1)+","+this.getLabels(2)+","+this.getLabels(3)+","+this.getLabels(4)+","+
		this.getLabels(6)+","+this.getLabels(7)+","+this.getLabels(8)+","+this.getLabels(9);
		this.tab=new GameTab(this.tab0);
		this.addChild(this.tab);
		this.contentSp=new Sprite;
		this.addChild(this.contentSp);
		this.contentSp.pos(228,59);
		this.tabBind=new TabBind(this.tab,this.contentSp);
		this.tabBind.addTabCell(0,QiandaoView,QiandaoMediator);
		this.tabBind.addTabCell(1,SevenrenwuView,SevenrenwuMediator);
		this.tabBind.addTabCell(2,LeijiPanel,LeijiMediator);
		this.tabBind.addTabCell(3,JiJinPanel,JijinMediator);
		this.tabBind.addTabCell(4,HuoyueView,HuoyueMediator);
		this.tabBind.addTabCell(5,LeijiNewPanel,LeijiNewMediator);
		this.tabBind.addTabCell(6,DuoBaoPanel,DuoBaoMediator);
		this.tabBind.addTabCell(7,KaBaoPanel,KaBaoMediator);
		var redQd=new RedPoint(RedPointType.LIANXU,this.tab.items [0]);
		redQd.x=180;
		var redQt=new RedPoint(RedPointType.XINSHOUQITIAN,this.tab.items [1]);
		redQt.x=180;
		var redLj=new RedPoint(RedPointType.LEIJI,this.tab.items [2]);
		redLj.x=180;
		var redJj=new RedPoint(RedPointType.CHENGZHANG,this.tab.items [3]);
		redJj.x=180;
		var redZy=new RedPoint(RedPointType.MEIHZOUHUOYUE,this.tab.items [4]);
		redZy.x=180;
		var redLeiji=new RedPoint(RedPointType.NEWLEIJI,this.tab.items [5]);
		redLeiji.x=180;
		var redDb=new RedPoint(RedPointType.DUOBAO,this.tab.items [6]);
		redDb.x=180;
		this.setTab();
		this.on("undisplay",this,this.remove);
	}

	__class(HuodongPanel,'huamao.panel.huodong.HuodongPanel',_super);
	var __proto=HuodongPanel.prototype;
	//unEable(false);
	__proto.remove=function(){
		this.destroy();
	}

	__proto.setTab=function(){
		if(this.sevenrenwuSession.isSevenXian==false){
			this.tab.setDelItem(1);
		};
		var data=this.mainPlayerSession.mainPlayerData;
		if(data.job==1001){
			this.tab.setDelItem(4);
			}else{
			this.tab.setAddItem(4);
		};
		var activityData=this.activitySession.getTypeActivity(3);
		if(!activityData)this.tab.setDelItem(3);
		activityData=this.activitySession.getTypeActivity(2);
		if(!activityData)this.tab.setDelItem(2);
		activityData=this.activitySession.getTypeActivity(9);
		if(!activityData)this.tab.setDelItem(5);
		activityData=this.activitySession.getTypeActivity(11);
		if(!activityData)this.tab.setDelItem(7);
		if(this.duoBaoSession.duoBaoData.length==0)this.tab.setDelItem(6);
	}

	__proto.getLabels=function(labelNum){
		var sysAct=ConfigManager.getDataArr("sys_activity.txt");
		for (var i=0;i < sysAct.length;i++){
			if(sysAct[i].order==labelNum){
				return sysAct[i].activityTitle;
			}
		}
		return sysAct[i].activityTitle;
	}

	__proto.unEable=function(boo){
		this.tab.mouseEnabled=this.cha.mouseEnabled=boo;
		console.log("tab0.selectedInde-->"+this.tab0.selectedIndex);
	}

	return HuodongPanel;
})(huodongUI)


//class huamao.panel.huodong.huoyueDay.HuoyueDayView extends ui.SLGGAME.meiriUI
var HuoyueDayView=(function(_super){
	function HuoyueDayView(){
		this.huiyueGiftArray=[];
		this.barValue=0;
		this.strTip="";
		this.scaleManager=new ScaleManager();
		HuoyueDayView.__super.call(this);
		App.injOne(this);
		this.listD.vScrollBarSkin='';
		this.listD.renderHandler=new Handler(this,this.updateItem);
		this.tips0.clickHandler=new Handler(this,this.tipsFuc);
		this.getTips();
	}

	__class(HuoyueDayView,'huamao.panel.huodong.huoyueDay.HuoyueDayView',_super);
	var __proto=HuoyueDayView.prototype;
	__proto.updateItem=function(cell,index){
		var hydayData=this.listD.getItem(index);
		hydayData.isGetPrograss();
		var clip=cell.getChildByName("zhuan");
		var btn0=cell.getChildByName("btn0");
		btn0.disabled=hydayData.getStatus==1 ? true:false;
		var txt0=cell.getChildByName("txt0");
		txt0.text=HuoyueDayData.sysNewArr[index].taskName;
		var txt1=cell.getChildByName("txt1");
		txt1.text=HuoyueDayData.sysNewArr[index].taskTargetDisplay.replace("{}",hydayData.getOne);
		btn0.disabled=hydayData.Disbtn;
		btn0.label=btn0.disabled==false ? "已达成":"未达成";
		this.isPlayClip(hydayData,clip);
		hydayData.isLing(btn0);
		btn0.clickHandler=new Handler(this,this.getGift,[btn0,hydayData.taskId]);
		var item=HuoyueDayData.sysNewArr[index].taskReward.split(",");
		var shu0=cell.getChildByName("shu0");
		shu0.text=item[1];
	}

	__proto.isPlayClip=function(hydayData,clip){
		if(hydayData.isOk==0){
			clip.visible=false;
			clip.stop();
			}else if(hydayData.isOk==1&&hydayData.getStatus==0){
			clip.visible=true;
			clip.play();
			}else if(hydayData.isOk==1&&hydayData.getStatus==1){
			clip.visible=false;
			clip.stop();
		}
	}

	__proto.getGiftData=function(arr){
		for (var k=0;k < 3;k++){
			var itemImg=new Image();
			itemImg.size(42,42);
			var huoyueGift=new HuoyueGift(itemImg,this["dui"+(k+1)],this["s"+k],this["shu"+k],this["box"+k],this["te"+(k+1)]);
			this.addChilds(huoyueGift.box,itemImg);
			var itemgift=arr[k].activityReward.split(",");
			var itemTarget=arr[k].activityTarget.split(",");
			huoyueGift.setData(itemgift[1],itemgift[0],itemTarget[1]);
			huoyueGift.imgPic.on("click",this,this.imgGift,[arr[k].activityId,itemTarget[1]]);
			ActivityPicTips.nameTips(huoyueGift.imgPic,this,parseInt(itemgift[0]));
			this.huiyueGiftArray.push(huoyueGift);
		}
		this.hyd.text="0";
		this.bar0.value=0;
	}

	__proto.onUpdate=function(dataArr,huoYueDu,giftArr){
		this.listD.array=dataArr;
		this.hyd.text=huoYueDu.toString();
		this.barValue=huoYueDu;
		this.bar0.value=huoYueDu/parseInt(this.shu2.text);
		for (var i=0;i < this.huiyueGiftArray.length;i++){
			var huoyueGift=this.huiyueGiftArray [i];
			if(this.barValue>=parseInt(this.huiyueGiftArray[i].shu.text)){
				huoyueGift.setIsOver(true);
			}
			if(giftArr[i]==1){
				huoyueGift.setIsOver(false);
			}
		}
	}

	__proto.getGift=function(btn0,actIDS){
		btn0.disabled=true;
		var actID=parseInt(actIDS);
		App.eventManager.event("HUOYUEDAYGIFT",[8,actID]);
	}

	__proto.addChilds=function(box,img){
		box.addChild(img);
	}

	__proto.tipsFuc=function(){
		FlyLittleUpTips.setTips(this.strTip);
	}

	__proto.getTips=function(){
		var sysArr=ConfigManager.getDataArr("sys_tips.txt");
		for (var j=0;j < sysArr.length;j++){
			if(sysArr[j].tipsId==3005){
				this.strTip=sysArr[j].tipsDescribe;
			}
		}
	}

	__proto.imgGift=function(activityId,item){
		if(this.barValue>=parseInt(item)){
			var actID=parseInt(activityId);
			App.eventManager.event("HUOYUEDAYGIFT",[9,actID]);
		}
	}

	return HuoyueDayView;
})(meiriUI)


//class huamao.panel.UseJiceTips extends ui.SLGGAME.tips_tsUI
var UseJiceTips=(function(_super){
	function UseJiceTips(){
		this.type=0;
		this.mapCityAction=null;
		this.handler=null;
		UseJiceTips.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UseJiceTips,'huamao.panel.UseJiceTips',_super);
	var __proto=UseJiceTips.prototype;
	__proto.init=function(){
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.check1.visible=true;
		this.checktext.visible=true;
		this.check1.on("change",this,this.checkBoxCB);
	}

	__proto.checkBoxCB=function(){
		if(this.type==4003){
			UseJiceTips.ZhaoBingMaiMa_IFVIEW=!this.check1.selected;
			}else if(this.type==4004){
			UseJiceTips.XingJunJiaSu_IFVIEW=!this.check1.selected;
			}else if(this.type==4005){
			UseJiceTips.NengGongQiaoJiang_IFVIEW=!this.check1.selected;
			}else if(this.type==4006){
			UseJiceTips.LuBanZaiShi_IFVIEW=!this.check1.selected;
			}else if(this.type==4007){
			UseJiceTips.QianLiChiYuan_IFVIEW=!this.check1.selected;
		}
	}

	__proto.setcontent=function(buyNum,itemid){
		this.shu0.text=buyNum+"";
		var sysitem=ConfigManager.getConfig("sys_item.txt",itemid);
		var name=sysitem.itemName;
		TheGame.lang(this.txt1,"购买\"{0}\"将消耗{1}元宝，确定购买该计策吗？",name,buyNum);
	}

	__proto.setHandler=function(itemid,buyNum,_handler){
		this.type=itemid;
		this.handler=_handler;
		this.setcontent(buyNum,itemid);
	}

	__proto.queDingCB=function(){
		if(this.handler !=null){
			this.handler.run();
		}
		this.close();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	UseJiceTips.ZhaoBingMaiMa_IFVIEW=true;
	UseJiceTips.XingJunJiaSu_IFVIEW=true;
	UseJiceTips.NengGongQiaoJiang_IFVIEW=true;
	UseJiceTips.LuBanZaiShi_IFVIEW=true;
	UseJiceTips.QianLiChiYuan_IFVIEW=true;
	return UseJiceTips;
})(tips_tsUI)


//class huamao.panel.waijiao.TipsTouXiang extends ui.SLGGAME.tips_tsUI
var TipsTouXiang=(function(_super){
	function TipsTouXiang(){
		this.mapCityAction=null;
		TipsTouXiang.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsTouXiang,'huamao.panel.waijiao.TipsTouXiang',_super);
	var __proto=TipsTouXiang.prototype;
	__proto.init=function(){
		this.txt1.text="您确定投降并结束本局游戏吗？";
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.box0.visible=false;
		var label=new Label();
		label.align="center";
		label.color="#d2132a";
		label.fontSize=20;
		label.pos(220,145);
		label.text="结束后可以开启一局新的游戏"
		this.addChild(label);
		this.check1.visible=false;
		this.checktext.visible=false;
	}

	__proto.queDingCB=function(){
		this.mapCityAction.sendTouXiang();
		this.quXiaoCB();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	return TipsTouXiang;
})(tips_tsUI)


//class huamao.panel.wujiangxinxi.HeroAssessDetailTips extends ui.SLGGAME.tips_tsUI
var HeroAssessDetailTips=(function(_super){
	function HeroAssessDetailTips(){
		this.handler=null;
		HeroAssessDetailTips.__super.call(this);
		this.init();
	}

	__class(HeroAssessDetailTips,'huamao.panel.wujiangxinxi.HeroAssessDetailTips',_super);
	var __proto=HeroAssessDetailTips.prototype;
	__proto.init=function(){
		this.check1.visible=false;
		this.checktext.visible=false;
		this.box0.visible=false;
		var sysTips=ConfigManager.getConfig("sys_tips.txt",8004);
		this.txt1.text=sysTips.tipsDescribe;
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
	}

	__proto.queDingCB=function(){
		if(this.handler !=null){
			this.handler.run();
		}
		this.close();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	__proto.setHandler=function(_handler){
		this.handler=_handler;
	}

	return HeroAssessDetailTips;
})(tips_tsUI)


//class huamao.panel.myMessage.MessagePanel extends ui.SLGGAME.gerenxinxiUI
var MessagePanel=(function(_super){
	function MessagePanel(){
		this.mainPlayerSession=null;
		this.playerInfoSession=null;
		this.playerInfoAction=null;
		this.monthAry=[];
		this.role=null;
		this.box=null;
		MessagePanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(MessagePanel,'huamao.panel.myMessage.MessagePanel',_super);
	var __proto=MessagePanel.prototype;
	__proto.init=function(){
		this.huanmingzi.on("click",this,this.changeNameCB);
		this.dianzan.on("click",this,this.dianZanCB);
		this.guojiayilan.on("click",this,this.contryViewCB);
		this.jifen.on("click",this,this.officalScoreViewCB);
		this.dianling.on("click",this,this.getPerDayItemCB);
		this.junzhuxingxiang.on("click",this,this.monarchStyleCB);
		this.touxiangkuang.on("click",this,this.heardIconCB);
		this.chengchipifu.on("click",this,this.changeCitySkinCB);
		this.lingqu.on("click",this,this.lingQuMonthItem);
		this.tips0.on("click",this,this.guanZhiCB);
		var redJf=new RedPoint(RedPointType.JIFEN,this.jifen);
		var redMr=new RedPoint(RedPointType.MEIR,this.dianling);
		var redMy=new RedPoint(RedPointType.MEIYUE,this.lingqu);
		var redGz=new RedPoint(RedPointType.GUANZHI,this.tips0);
		this.flushPlayerName();
		this.flushLv();
		this.flushExp();
		this.flushGameTimes();
		this.flushWinTimes();
		this.flushResultName();
		this.flushOffcial();
		this.flushOffcialScore();
		this.flushDianZan();
		this.flushBodySkin();
		this.setMaxOfficalInMonth();
		this.ID0.text=this.mainPlayerSession.mainPlayerData.playerId+"";
		GameUtils.getKaKuang(this.wk,4);
		this.flushJiCeBaoLingQuZT();
		var job=this.mainPlayerSession.mainPlayerData.job;
		var sysTitlePlayer=ConfigManager.getConfig("sys_title_player.txt",job);
		var str=sysTitlePlayer.titleBonusStrategyPack;
		var num=0;
		if(str !=null && str.length > 0){
			var ary=str.split(",");
			num=ary.length;
			this._setPerDayItemView(this.di1,this.wp0,this.shu1,false);
			this._setPerDayItemView(this.di2,this.wp5,this.shu5,false);
			if(num > 1){
				var id1=parseInt(ary[0]);
				var idnum1=parseInt(ary[1]);
				this._setPerDayItemView(this.di1,this.wp0,this.shu1,true);
				this.wp0.skin=GameUtils.getItemIconPath(id1);
				this.shu1.text="×"+idnum1;
				this.wp0.size(75,75);
				this.wp0.mouseEnabled=true;
				this.wp0.on("click",this,this.tipsTuCB,[id1]);
			}
			if(num > 2){
				var id2=parseInt(ary[2]);
				var idnum2=parseInt(ary[3]);
				this._setPerDayItemView(this.di2,this.wp5,this.shu5,true);
				this.wp5.skin=GameUtils.getItemIconPath(id2);
				this.shu5.text="x"+idnum2;
				this.wp5.size(75,75);
				this.wp5.mouseEnabled=true;
				this.wp5.on("click",this,this.tipsTuCB,[id2]);
			}
		}
		if(num > 1){
			this.dianling.disabled=false;
			this.dianling.visible=true;
			}else{
			this.dianling.disabled=true;
			this.dianling.visible=false;
		};
		var i=0;
		this.monthAry[i++]=this.wpd_1;
		this.monthAry[i++]=this.wp1;
		this.monthAry[i++]=this.z1;
		this.monthAry[i++]=this.wpd_2;
		this.monthAry[i++]=this.wp2;
		this.monthAry[i++]=this.z2;
		this.monthAry[i++]=this.wpd_3;
		this.monthAry[i++]=this.wp3;
		this.monthAry[i++]=this.z3;
		this.monthAry[i++]=this.wpd_4;
		this.monthAry[i++]=this.wp4;
		this.monthAry[i++]=this.z4;
		var dropId=sysTitlePlayer.titleSalary;
		var dropAry=[];
		if(dropId !=0){
			var sysdrop=ConfigManager.getConfig("sys_drop.txt",dropId);
			dropAry=sysdrop.getDropList();
		}
		if(dropAry.length > 0){
			this.xianling.visible=false;
			}else{
			this.xianling.visible=true;
		}
		for(i=0;i<this.monthAry.length;i+=3){
			var imgDi=this.monthAry [i];
			var imgTu=this.monthAry [i+1];
			var lbl=this.monthAry [i+2];
			imgTu.size(75,75);
			if(i/3*2 < dropAry.length){
				var itemId=dropAry[i/3*2];
				var itemNum=dropAry[i/3*2+1];
				this._setPerDayItemView(imgDi,imgTu,lbl,true);
				imgTu.skin=GameUtils.getItemIconPath(itemId);
				lbl.text=itemNum+"";
				imgTu.mouseEnabled=true;
				imgTu.on("click",this,this.tipsTuCB,[itemId]);
				}else{
				this._setPerDayItemView(imgDi,imgTu,lbl,false);
			}
		}
		this.flushMonthSalaryBtn();
		this.flushJiCeBaoLingQuZT();
		this.visibleBtn();
		this.on("undisplay",this,this.undisFun);
	}

	__proto.undisFun=function(){
		this.callLater(this.destroy);
	}

	__proto.tipsTuCB=function(itemId){
		var sysitem=ConfigManager.getConfig("sys_item.txt",itemId);
		FlyLittleUpTips.setTips(sysitem.itemName);
	}

	__proto._setPerDayItemView=function(img1,img2,text,view){
		img1.visible=view;
		img2.visible=view;
		text.visible=view;
	}

	__proto.visibleBtn=function(){
		this.guojiayilan.visible=false;
		this.junzhuxingxiang.visible=false;
		this.touxiangkuang.visible=false;
		this.chengchipifu.visible=false;
	}

	__proto.flushBodySkin=function(){
		this.box=new Sprite();
		this.box.scrollRect=new Rectangle(0,0,307,393);
		this.box.pos(23,188);
		this.addChildAt(this.box,this.getChildIndex(this.ren));
		this.ren.removeSelf();
		var style=this.mainPlayerSession.mainPlayerData.style;
		this.role=new DragonBonesMc(false,false);
		this.role.setUrl("res/load/"+GameUtils.LongGuRoleRes(style)+".sk");
		this.box.addChild(this.role);
		this.role.pos(155,400);
		this.role.scale(0.7,0.7);
	}

	__proto.guanZhiCB=function(){
		App.dialogManager.showMiniDialog(TipsGuanZhi,true,true);
	}

	__proto.lingQuMonthItem=function(){
		this.playerInfoAction.sendGetMonthPackage();
	}

	__proto.changeCitySkinCB=function(){}
	__proto.heardIconCB=function(){}
	//更新头像框
	__proto.monarchStyleCB=function(){}
	//君主形象
	__proto.flushDianZan=function(){
		var all=this.playerInfoSession.praise;
		this.dianzanshu.text=all+"";
	}

	__proto.flushMonthSalaryBtn=function(){
		var job=this.mainPlayerSession.mainPlayerData.job;
		var sysTitlePlayer=ConfigManager.getConfig("sys_title_player.txt",job);
		var dropId=sysTitlePlayer.titleSalary;
		var dropAry=[];
		if(dropId !=0){
			var sysdrop=ConfigManager.getConfig("sys_drop.txt",dropId);
			dropAry=sysdrop.getDropList();
		};
		var droplen=dropAry.length;
		if(droplen > 0){
			var monthSalary=this.playerInfoSession.monthSalary;
			var monthGameSize=this.playerInfoSession.monthGameSize;
			var systimetake=ConfigManager.getConfig("sys_timetake.txt",43);
			var maxTimes=systimetake.timeCd;
			if(monthGameSize >=maxTimes){
				if(monthSalary==0){
					this.lingqu.visible=true;
					this.lingqu.disabled=false;
					this.liangtianhou.visible=false;
					}else{
					this.lingqu.visible=false;
					this.lingqu.disabled=true;
					this.liangtianhou.visible=true;
					this.liangtianhou.text=monthSalary+"天后可领取";
				}
				}else{
				this.lingqu.visible=false;
				this.lingqu.disabled=true;
				this.liangtianhou.visible=true;
				this.liangtianhou.text=(maxTimes-monthGameSize)+"局对战后领取";
			}
			}else{
			this.liangtianhou.visible=false;
			this.lingqu.visible=false;
		}
	}

	__proto.flushJiCeBaoLingQuZT=function(){
		if(this.playerInfoSession.daySalary==0){
			this.dianling.label="点击领取";
			this.dianling.disabled=false;
			}else{
			this.dianling.label="今日已领取";
			this.dianling.disabled=true;
		}
	}

	__proto.getPerDayItemCB=function(){
		if(this.playerInfoSession.daySalary==0){
			this.playerInfoAction.sendGetDaySalary();
		}
	}

	// }
	__proto.officalScoreViewCB=function(){
		if(this.playerInfoSession.getScorLogAry().length > 0){
			App.dialogManager.showMiniDialog(TipsJiFenJiLu,true,true,true);
			}else{
			this.playerInfoAction.sendScoreList();
		}
	}

	//设置个人最高官职
	__proto.setMaxOfficalInMonth=function(){
		var maxjob=this.playerInfoSession.monthMaxJob;
		this.guanzhi4.text=this.getOfficalName(maxjob);
	}

	__proto.contryViewCB=function(){}
	//国家一览
	__proto.dianZanCB=function(){
		var sysTip=ConfigManager.getConfig("sys_tips.txt",3010);
		FlyLittleUpTips.setTips(sysTip.tipsDescribe);
	}

	__proto.changeNameCB=function(){
		App.dialogManager.showMiniDialog(TipsChangeName,true,true,true);
	}

	//更新等级
	__proto.flushLv=function(){
		var lv=this.mainPlayerSession.mainPlayerData.Lv;
		this.wanjiadengji.text="Lv."+lv;
	}

	__proto.flushPlayerName=function(){
		var name=this.mainPlayerSession.mainPlayerData.playerName;
		this.wanjiaming.text=name;
	}

	//更新经验
	__proto.flushExp=function(){
		var curExp=this.mainPlayerSession.mainPlayerData.exp;
		var lv=this.mainPlayerSession.mainPlayerData.Lv;
		var sysLevelLord=ConfigManager.getConfig("sys_level_lord.txt",lv);
		if(null !=sysLevelLord){
			var maxExp=sysLevelLord.lordExp;
			this.txt_jy.text=curExp+"/"+maxExp;
			this.jingyantiao.value=curExp/maxExp;
			}else{
			console.log("lv = "+lv);
		}
	}

	//更新点赞
	__proto.flushHeart=function(){}
	//更新局数信息 参与
	__proto.flushGameTimes=function(){
		var gameTimes=this.mainPlayerSession.mainPlayerData.gameTimes;
		this.canyujushu.text=gameTimes+"";
	}

	//更新统一次数
	__proto.flushWinTimes=function(){
		var winTimes=this.mainPlayerSession.mainPlayerData.winTimes;
		this.tongyishu.text=winTimes+"";
	}

	//更新 霸王、战神、智者、惜败次数
	__proto.flushResultName=function(){
		var tortoise=this.mainPlayerSession.mainPlayerData.tortoise;
		var mars=this.mainPlayerSession.mainPlayerData.mars;
		var wise=this.mainPlayerSession.mainPlayerData.wise;
		var defeat=this.mainPlayerSession.mainPlayerData.defeat;
		this.wanshangshu.text=tortoise+"";
		this.zhanshenshu.text=mars+"";
		this.zhizheshu.text=wise+"";
		this.xibaishu.text=defeat+"";
	}

	//更新国家
	__proto.flushCountry=function(){}
	__proto.getOfficalName=function(job){
		var systitle=ConfigManager.getConfig("sys_title_player.txt",job);
		if(systitle !=null){
			return systitle.titleName;
		}
		return job+"有问题";
	}

	//更新官职
	__proto.flushOffcial=function(){
		var offcial=this.mainPlayerSession.mainPlayerData.job;
		this.guanzhi1.text=this.getOfficalName(offcial);
	}

	//更新官职积分
	__proto.flushOffcialScore=function(){
		var score=this.mainPlayerSession.mainPlayerData.jobScore;
		var offcial=this.mainPlayerSession.mainPlayerData.job;
		var nextOffical=GameUtils.getNextOffical(offcial);
		var sysTitlePlayer=ConfigManager.getConfig("sys_title_player.txt",offcial);
		var maxScor=sysTitlePlayer.titleUpgradePoint;
		this.jifenshu.text=score+"";
		if(offcial==1002){
			this.ming.visible=false;
			this.titi.visible=true;
			this.titi.fontSize=21;
			this.titi.text=this.getTips(2024);
			}else{
			this.ming.visible=true;
			this.titi.visible=false;
		}
		this.guanzhi2.text=this.getOfficalName(offcial);
		this.guanzhi3.text=this.getOfficalName(nextOffical);
		this.shu0.text=score+"/"+maxScor;
		this.guanzhijindu.value=score/maxScor;
	}

	__proto.getTips=function(tipsId){
		var systips=ConfigManager.getConfig("sys_tips.txt",tipsId);
		return systips.tipsDescribe;
	}

	//刷新奖励物品
	__proto.flushItem=function(){}
	return MessagePanel;
})(gerenxinxiUI)


//class huamao.panel.myMessage.TipsGuanZhi extends ui.SLGGAME.gerenxinxi_gzUI
var TipsGuanZhi=(function(_super){
	function TipsGuanZhi(){
		this.mainPlayerSession=null;
		this.playerInfoSession=null;
		this.playerInfoAction=null;
		this.jobId=0;
		this.aryBox=[];
		this.aryLable=[];
		this.aryImgBox=[];
		this.aryHtml=[];
		this.dis=95;
		this.posX=[
		[594+this.dis],
		[549+this.dis,638+this.dis],
		[505+this.dis,594+this.dis,683+this.dis],
		[460+this.dis,549+this.dis,638+this.dis,727+this.dis],];
		this.posY=211;
		this.imgTuBiao2=null;
		this.itemary=null;
		TipsGuanZhi.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsGuanZhi,'huamao.panel.myMessage.TipsGuanZhi',_super);
	var __proto=TipsGuanZhi.prototype;
	__proto.init=function(){
		this.leftBtn.on("click",this,this.leftCB);
		this.rightBtn.on("click",this,this.rightCB);
		this.aryBox[0]=this.h1;
		this.aryBox[1]=this.h2;
		this.aryBox[2]=this.h3;
		this.aryBox[3]=this.h4;
		for(var i=0;i<4;i++){
			this.aryBox[i].on("click",this,this.viewItemCB,[i]);
		}
		this.aryImgBox[0]=this.b1;
		this.aryImgBox[1]=this.b2;
		this.aryImgBox[2]=this.b3;
		this.aryImgBox[3]=this.b4;
		this.aryLable[0]=this.s1;
		this.aryLable[1]=this.s2;
		this.aryLable[2]=this.s3;
		this.aryLable[3]=this.s4;
		this.aryHtml[0]=this.jc_1;
		this.aryHtml[1]=this.jc_2;
		this.aryHtml[2]=this.jc_3;
		this.aryHtml[3]=this.jc_4;
		this.checkLeftorRightBtn();
		this.tubiao.on("click",this,this.jobPackCB);
		App.eventManager.on("FLUSH_JOB_BOX",this,this.flushJobBoxCB);
		if(this.imgTuBiao2==null){
			this.imgTuBiao2=new Image();
			this.imgTuBiao2.anchorX=this.imgTuBiao2.anchorY=0.5;
			this.imgTuBiao2.pos(this.tubiao.x+this.tubiao.width/2,this.tubiao.y+this.tubiao.height/2);
			this.imgTuBiao2.on("click",this,this.jobPackCB2);
			this.addChild(this.imgTuBiao2);
		}
		this.jobId=this.mainPlayerSession.mainPlayerData.job;
		this.flushJobPanel(this.jobId);
		this.tequan.font=null;
		this.tequan.fontSize=20;
	}

	__proto.viewItemCB=function(index){
		if(index < this.itemary.length/2){
			var itemId=this.itemary[index*2];
			var itemNum=this.itemary[index*2+1];
			var sysitem=ConfigManager.getConfig("sys_item.txt",itemId);
			var name=sysitem.itemName;
			var str=name+" X "+itemNum;
			FlyLittleUpTips.setTips(sysitem.itemDescription,200);
		}
	}

	__proto.flushJobBoxCB=function(){
		this.flushJobPanel(this.jobId);
	}

	__proto.jobPackCB=function(){
		var systitleplayer=ConfigManager.getConfig("sys_title_player.txt",this.jobId);
		FlyLittleUpTips.setTips(systitleplayer.getTitlePackageDropStr());
	}

	__proto.jobPackCB2=function(){
		if(this.playerInfoSession.checkJobBox(this.jobId)){
			FlyUpTips.setTips("该宝箱已领取过");
			}else{
			this.playerInfoAction.sendGetJobBox(this.jobId);
		}
	}

	__proto.flushJobPanel=function(_jobid){
		var systitleplayer=ConfigManager.getConfig("sys_title_player.txt",_jobid);
		this.xianling.text=systitleplayer.titleName;
		var dropid=systitleplayer.titleSalary;
		if(dropid !=0){
			var sysdrop=ConfigManager.getConfig("sys_drop.txt",dropid);
			this.itemary=sysdrop.getDropList();
			var j=0;
			var dataSize=this.itemary.length/2;
			var posx=708-(dataSize*82+(dataSize-1)*9)/2;
			for(var i=0;i<4;i++){
				var boxF=this.aryBox [i];
				if(i<dataSize){
					var itemId=this.itemary[i*2];
					var itemNum=this.itemary[i*2+1];
					boxF.visible=true;
					boxF.pos(posx+i*(82+9),this.posY);
					(this.aryLable [i]).text=itemNum+"";
					var boxImg=this.aryImgBox [i];
					var icon=boxImg.getChildByName("icon");
					if(icon==null){
						icon=new Image();
						icon.size(75,75);
						icon.name="icon";
						boxImg.addChild(icon);
					}
					icon.skin=GameUtils.getItemIconPath(itemId);
					}else{
					boxF.visible=false;
				}
			}
			}else{
			for(i=0;i<4;i++){
				(this.aryBox [i]).visible=false;
			}
		};
		var list=[];
		var str=systitleplayer.getTitleBounsBuildingString();
		if(str.length > 0){
			list.push(str);
		}
		str=systitleplayer.getTitleBonusHeroExpString();
		if(str.length > 0){
			list.push(str);
		}
		str=systitleplayer.getTitleBonusstrategyPackString();
		if(str.length > 0){
			list.push(str);
		}
		str=systitleplayer.getTitleBonusHonorPointString();
		if(str.length > 0){
			list.push(str);
		}
		for(i=0;i<4;i++){
			var html=(this.aryHtml [i]);
			if(i<list.length){
				html.visible=true;
				html.innerHTML=list[i];
				html.x=310-html.contextWidth/2;
				}else{
				html.visible=false;
			}
		}
		this.tequan.text=systitleplayer.titleRight;
		var titlepackage=systitleplayer.titlePackage;
		var myjobid=this.mainPlayerSession.mainPlayerData.job;
		if(titlepackage > 0){
			if(myjobid >=_jobid){
				if(this.playerInfoSession.checkJobBox(_jobid)){
					this.tubiao.visible=false;
					this.tubiao.mouseEnabled=false;
					this.imgTuBiao2.visible=true;
					this.imgTuBiao2.skin="comp/gerenxinxi/xiangkai.png";
					this.imgTuBiao2.mouseEnabled=false;
					}else{
					this.tubiao.visible=false;
					this.tubiao.mouseEnabled=false;
					this.imgTuBiao2.visible=true;
					this.imgTuBiao2.skin="comp/gerenxinxi/xiangguan.png";
					this.imgTuBiao2.mouseEnabled=true;
				}
				}else{
				this.tubiao.visible=true;
				this.tubiao.mouseEnabled=true;
				this.imgTuBiao2.visible=false;
				this.imgTuBiao2.mouseEnabled=false;
			}
			}else{
			this.tubiao.visible=false;
			this.tubiao.mouseEnabled=true;
			this.imgTuBiao2.visible=true;
			this.imgTuBiao2.skin="comp/gerenxinxi/weikaifang.png";
			this.imgTuBiao2.mouseEnabled=false;
		}
	}

	__proto.checkLeftorRightBtn=function(){
		if(this.jobId==1001){
			this.leftBtn.visible=false;
		}
		if(this.jobId==1013){
			this.rightBtn.visible=false;
		}
	}

	__proto.leftCB=function(){
		if(this.jobId > 1001){
			this.jobId-=1;
			this.flushJobPanel(this.jobId);
		}
		this.checkLeftorRightBtn();
		this.rightBtn.visible=true;
	}

	__proto.rightCB=function(){
		if(this.jobId < 1013){
			this.jobId+=1;
			this.flushJobPanel(this.jobId);
		}
		this.leftBtn.visible=true;
		this.checkLeftorRightBtn();
	}

	return TipsGuanZhi;
})(gerenxinxi_gzUI)


//class huamao.panel.wujiangxinxi.HeroResetTips extends ui.SLGGAME.tips_tsUI
var HeroResetTips=(function(_super){
	function HeroResetTips(){
		this.wuJiangAction=null;
		this.curHeroId=0;
		this.curSelect=0;
		HeroResetTips.__super.call(this);
		App.injOne(this);
		this.check1.visible=true;
		this.checktext.visible=true;
		this.check1.on("change",this,this.checkBoxCB);
	}

	__class(HeroResetTips,'huamao.panel.wujiangxinxi.HeroResetTips',_super);
	var __proto=HeroResetTips.prototype;
	//backSoul:武魂返还
	__proto.setData=function(heroId,select,curcount,neadgold,backSoul){
		this.curHeroId=heroId;
		this.curSelect=select;
		var sysHero=ConfigManager.getConfig("sys_hero.txt",heroId);
		TheGame.lang(this.txt1,"确定将{0}的星级重置为0吗？您将获得{1}武魂.(您本月第{2}次重置，需要消耗{3}元宝)",sysHero.heroName,backSoul,curcount,neadgold);
		this.shu0.text=neadgold+"";
		this.btn1.on("click",this,this.quXiaoCB);
		this.btn0.on("click",this,this.queDingCB);
	}

	__proto.checkBoxCB=function(){
		HeroResetTips.IFVIEW=!this.check1.selected;
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	__proto.queDingCB=function(){
		this.wuJiangAction.sendReset(this.curHeroId,0,this.curSelect);
		this.close();
	}

	HeroResetTips.IFVIEW=true;
	return HeroResetTips;
})(tips_tsUI)


//class huamao.panel.myMessage.TipsJiFenJiLu extends ui.SLGGAME.tips_jfjlUI
var TipsJiFenJiLu=(function(_super){
	function TipsJiFenJiLu(){
		this.playerInfoSession=null;
		TipsJiFenJiLu.__super.call(this);
		App.injOne(this);
		this.init();
		App.eventManager.on("GET_NEW_SCORE",this,this.flushData);
	}

	__class(TipsJiFenJiLu,'huamao.panel.myMessage.TipsJiFenJiLu',_super);
	var __proto=TipsJiFenJiLu.prototype;
	__proto.init=function(){
		this.jieshao.on("click",this,this.openJieShaoCB);
		this.list0.vScrollBarSkin="";
		this.list0.repeatX=1;
		this.list0.repeatY=0;
		this.list0.spaceX=0;
		this.list0.spaceY=0;
		this.list0.selectHandler=new Handler(this,this.onSelect);
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.array=this.playerInfoSession.getScorLogAry().sort(this.sortFun);
		this.flushData();
		this.playerInfoSession.jifen=false;
		App.eventManager.event("REAPOINT",RedPointType.JIFEN);
	}

	__proto.flushData=function(){
		this.list0.array=this.playerInfoSession.getScorLogAry().sort(this.sortFun);
	}

	__proto.sortFun=function(dataA,dataB){
		return dataB.addTime-dataA.addTime;
	}

	__proto.onSelect=function(index){}
	__proto.getContentStr=function(data){
		var result;
		var type=data.type;
		var name=data.name;
		var lv=data.lv;
		var job=data.job;
		var jobScore=data.jobScore;
		var exp=data.exp;
		var straight=data.straight;
		var addTime=data.addTime;
		var systitleplayer=ConfigManager.getConfig("sys_title_player.txt",job);
		var jobName=systitleplayer.titleName;
		console.log("已经获取到type："+type);
		if(type==11){
			type=1;
		};
		var sysTitleRecord=ConfigManager.getConfig("sys_title_record.txt",type);
		console.log("sysTitleRecord已经获取到："+sysTitleRecord);
		result="无描述";
		var ary=[];
		var i=0;
		switch(type){
			case 0:
				ary[i++]=jobScore;
				break ;
			case 1:
			case 11:
				break ;
			case 2:
				ary[i++]=lv;
				ary[i++]=name;
				ary[i++]=jobName;
				break ;
			case 3:
				ary[i++]=lv;
				ary[i++]=name;
				ary[i++]=jobName;
				ary[i++]=jobScore;
				ary[i++]=straight;
				break ;
			case 4:
				ary[i++]=lv;
				ary[i++]=name;
				ary[i++]=jobName;
				ary[i++]=jobScore;
				ary[i++]=straight;
				break ;
			case 5:
				break ;
			case 6:
				ary[i++]=lv;
				ary[i++]=name;
				ary[i++]=jobName;
				break ;
			case 7:
				ary[i++]=lv;
				ary[i++]=name;
				ary[i++]=jobName;
				ary[i++]=jobScore;
				ary[i++]=straight;
				break ;
			case 8:
				ary[i++]=lv;
				ary[i++]=name;
				ary[i++]=jobName;
				ary[i++]=jobScore;
				ary[i++]=straight;
				break ;
			case 9:
				ary[i++]=lv;
				ary[i++]=name;
				ary[i++]=jobName;
				ary[i++]=jobScore;
				ary[i++]=exp;
				break ;
			case 10:
				ary[i++]=lv;
				ary[i++]=name;
				ary[i++]=jobName;
				ary[i++]=jobScore;
				ary[i++]=exp;
				break ;
			}
		return GameUtils.replaceLocaleConfigFH(result,ary);
	}

	__proto.updateItem=function(cell,index){
		var time=cell.getChildByName("txt");
		var content=cell.getChildByName("lab");
		var data=cell.dataSource;
		time.text=GameUtils.timeFormat(data.addTime,2);
		content.text=this.getContentStr(data);
	}

	__proto.openJieShaoCB=function(){
		App.dialogManager.showMiniDialog(TipsScoreRule,true,true,true);
	}

	return TipsJiFenJiLu;
})(tips_jfjlUI)


//class huamao.panel.myMessage.TipsPlayerMessage extends ui.SLGGAME.wanjiaxxUI
var TipsPlayerMessage=(function(_super){
	function TipsPlayerMessage(){
		this.wuJiangAction=null;
		this.friendAction=null;
		this.playerId=0;
		this.playerName=null;
		TipsPlayerMessage.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsPlayerMessage,'huamao.panel.myMessage.TipsPlayerMessage',_super);
	var __proto=TipsPlayerMessage.prototype;
	__proto.init=function(){
		this.chakan.on("click",this,this.chaKanCB);
		this.jia.on("click",this,this.addFriendCB);
		this.hmd.on("click",this,this.addBlackListCB);
	}

	__proto.chaKanCB=function(){
		this.wuJiangAction.sendViewPlayerHeroList(this.playerId);
	}

	__proto.addFriendCB=function(){
		this.friendAction.sendApplyFriend(this.playerId);
	}

	//FlyUpTips.setTips("好友申请已发送");
	__proto.addBlackListCB=function(){
		var tips=App.dialogManager.showMiniDialog(TipsAddBlackList,true,true,true);
		tips.setData(this.playerId,this.playerName);
	}

	__proto.setData=function(data){
		this.playerId=data.playerId;
		this.playerName=data.playerName;
		this.dengji.text="Lv."+data.playerLv;
		this.name0.text=data.playerName;
		this.bw.text=data.tortoise+"";
		this.zs.text=data.mars+"";
		this.zz.text=data.wise+"";
		this.xb.text=data.defeat+"";
		var style=data.style;
		var syslordbody=ConfigManager.getConfig("sys_lordbody.txt",style+1);
		this.ka.skin="comp/G/"+syslordbody.lordRes+".png";
		var sysTitlePlayer=ConfigManager.getConfig("sys_title_player.txt",data.playerJob);
		this.txt0.text=sysTitlePlayer.titleName;
		this.txt2.text=data.heroNum+"";
		this.txt3.text=data.gameTimes+"";
		this.txt4.text=data.winTimes+"";
		this.txt1.text="--";
		this.txt5.text="--";
		this.txt6.text="--";
	}

	return TipsPlayerMessage;
})(wanjiaxxUI)


//class huamao.panel.myMessage.TipsScoreRule extends ui.SLGGAME.tips0UI
var TipsScoreRule=(function(_super){
	function TipsScoreRule(){
		this.mainPlayerSession=null;
		TipsScoreRule.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsScoreRule,'huamao.panel.myMessage.TipsScoreRule',_super);
	var __proto=TipsScoreRule.prototype;
	__proto.init=function(){
		this.width=this.img0.width=690;
		this.height=this.img0.height=373;
		this.autoSize=true;
		this.list0.spaceX=1;
		this.list0.spaceY=1;
		this.disabled=false;
		this.mouseEnabled=true;
		this.list0.mouseEnabled=true;
		this.list0.disabled=false;
		this.list0.selectHandler=new Handler(this,this.onSelect);
		this.list0.renderHandler=new Handler(this,this.updateItem);
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this.mainPlayerSession.mainPlayerData.job);
		var sysmath=ConfigManager.getConfig("sys_match.txt",sysTitle.titleRoom);
		var str=GameUtils.replaceLocaleConfigFH("您每进入一局游戏，便会立刻获得1点官职积分。\n您击败其他玩家时，将根据该玩家曾经拥有的最大城池数获得官职积分：\n最大城池数小于5座，不获得官职积分；\n最大城池达到5座且小于10座，获得2点官职积分；\n最大城池达到10座且小于20座，获得4点官职积分；\n最大城池数到到20，获得8点积分。\n除此之外，您还将获得额外的君主经验奖励；对手的君主等级高您越多，您获得的君主经验也越多。\n您被其他玩家击败或者投降时，将会根据您的连败场数扣除您的官职积分：\n第一次战败扣1分，第二次战败扣2分（即连败2场），以此类推。\n当前官职您战败时最多会扣除{0}点官职积分。\n当您完成统一时，将重置您的连败场数。\n官职积分达到500分以上的玩家累计7天未进入战局，每天会扣除5点官职积分。",[sysmath.titlePointLostLimit]);
		this.list0.array=[str];
	}

	__proto.onSelect=function(index){}
	__proto.updateItem=function(cell,index){
		var datasource=cell.dataSource;
		var lable=cell.getChildByName("txt0");
		cell.width=630;
		cell.height=0;
		cell.autoSize=true;
		lable.autoSize=true;
		lable.width=630;
		lable.height=0;
		lable.wordWrap=true;
		lable.text=datasource;
	}

	return TipsScoreRule;
})(tips0UI)


//class huamao.panel.PayInfoPanel extends ui.SLGGAME.zhifu_1UI
var PayInfoPanel=(function(_super){
	function PayInfoPanel(){
		PayInfoPanel.__super.call(this);
	}

	__class(PayInfoPanel,'huamao.panel.PayInfoPanel',_super);
	var __proto=PayInfoPanel.prototype;
	__proto.setInfo=function(type){
		this.te1.visible=this.te2.visible=false;
		if(type==0){
			this.te1.visible=true;
			}else if(type==1){
			this.te2.visible=true;
			}else if(type==3){
			this.te2.visible=true;
			this.te2.text="您好，不支持IOS支付！";
		}
	}

	return PayInfoPanel;
})(zhifu_1UI)


//class huamao.panel.wujiangxinxi.TipsWuJiangFenJie extends ui.SLGGAME.tips_tsUI
var TipsWuJiangFenJie=(function(_super){
	function TipsWuJiangFenJie(){
		this.wuJiangAction=null;
		this.heroData=null;
		this.yesHandler=null;
		TipsWuJiangFenJie.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsWuJiangFenJie,'huamao.panel.wujiangxinxi.TipsWuJiangFenJie',_super);
	var __proto=TipsWuJiangFenJie.prototype;
	__proto.init=function(){
		this.btn0.on("click",this,this.queDingCB);
		this.btn1.on("click",this,this.quXiaoCB);
		this.box0.visible=false;
	}

	__proto.queDingCB=function(){
		this.wuJiangAction.sendFenJie(this.heroData.heroId);
		if(this.yesHandler){
			this.yesHandler.run();
		}
		this.close();
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	__proto.setHeroData=function(_heroData){
		this.heroData=_heroData;
		var herostar=this.heroData.heroStar;
		var syshero=ConfigManager.getConfig("sys_hero.txt",this.heroData.heroId);
		var herocolor=syshero.heroColor;
		var sysHeroProgress=ConfigManager.getConfig("sys_hero_progress.txt",herocolor+"_"+herostar);
		var heroDecompose=sysHeroProgress.heroDecompose;
		this.txt1.text="分解该武将您将获得 "+heroDecompose+" 武魂，确认分解吗？";
	}

	return TipsWuJiangFenJie;
})(tips_tsUI)


//class huamao.panel.qingbao.Qingbao extends ui.SLGGAME.tips_zcUI
var Qingbao=(function(_super){
	function Qingbao(){
		this.mapCitySession=null;
		this.list=null;
		Qingbao.__super.call(this);
		App.injOne(this);
		this.list=new List();
		this.list.itemRender=SelectItem;
		this.list.repeatX=3;
		this.list.spaceX=10;
		this.list.spaceY=5;
		this.list.pos(24,150);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.size(533,410);
		this.addChild(this.list);
	}

	__class(Qingbao,'huamao.panel.qingbao.Qingbao',_super);
	var __proto=Qingbao.prototype;
	__proto.updateItem=function(item,index){
		item.update(this.list.getItem(index));
	}

	//item.dataSource
	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		var cityId=this.tag.cityId;
		var cityData=this.mapCitySession.getCity(cityId);
		this.list.array=cityData.heroList;
		var time1=GameUtils.GetServerTime()-cityData.zhenchaTime;
		time1=time1 / 60;
		time1=parseInt(time1+"");
		this.time.text=time1+"";
		this.chengshu.text=cityData.level+"";
		this.bingshu.text=cityData.childNum+"";
		this.yushu.text=cityData.yubeiyiNum+"";
	}

	return Qingbao;
})(tips_zcUI)


//class huamao.panel.rank.RankItem extends ui.SLGGAME.paihangbang2UI
var RankItem=(function(_super){
	function RankItem(){
		this._index=0;
		this.rankData=null;
		this.playerInfoAction=null;
		this.mainPlayerSession=null;
		RankItem.__super.call(this);
		App.injOne(this);
		this.on("click",this,this.onClick);
	}

	__class(RankItem,'huamao.panel.rank.RankItem',_super);
	var __proto=RankItem.prototype;
	__proto.onClick=function(){
		if(this.rankData.playerId==this.mainPlayerSession.mainPlayerData.playerId){
			return;
		}
		this.playerInfoAction.sendViewPlayerMes(this.rankData.playerId);
	}

	__proto.update=function(data,index){
		this.rankData=data;
		var sys=ConfigManager.getConfig("sys_title_player.txt",data.job);
		if(sys==null){
			sys=ConfigManager.getConfig("sys_title_player.txt",1001);
		}
		this._index=index+1;
		this.di0.visible=this._index % 2==0;
		this.img0.visible=this._index <=3;
		this.shu0.visible=this._index > 3;
		if(this._index <=3){
			this.img0.skin="comp/G/phb_"+this._index+".png";
		}
		else{
			this.shu0.text=this._index+"";
		}
		this.name0.text=data.playerName;
		this.guan0.text=sys.titleName;
		this.ji0.text=data.playerLv+"";
		this.fen0.text=data.jobScore+"";
	}

	return RankItem;
})(paihangbang2UI)


//class huamao.panel.rank.RankItem2 extends ui.SLGGAME.paihangbang4UI
var RankItem2=(function(_super){
	function RankItem2(){
		this._index=0;
		this.rankData=null;
		this.playerInfoAction=null;
		this.mainPlayerSession=null;
		RankItem2.__super.call(this);
		App.injOne(this);
		this.on("click",this,this.onClick);
	}

	__class(RankItem2,'huamao.panel.rank.RankItem2',_super);
	var __proto=RankItem2.prototype;
	__proto.onClick=function(){
		if(this.rankData.playerId==this.mainPlayerSession.mainPlayerData.playerId){
			return;
		}
		this.playerInfoAction.sendViewPlayerMes(this.rankData.playerId);
	}

	__proto.update=function(data,index){
		this.rankData=data;
		this._index=index+1;
		var sys=ConfigManager.getConfig("sys_title_player.txt",data.job);
		this.di0.visible=this._index % 2==0;
		this.img0.visible=this._index <=3;
		this.shu0.visible=this._index > 3;
		if(this._index <=3){
			this.img0.skin="comp/G/phb_"+this._index+".png";
		}
		else{
			this.shu0.text=this._index+"";
		}
		this.name0.text=data.playerName;
		this.guan0.text=sys.titleName;
		this.fen0.text=data.praise+"";
	}

	return RankItem2;
})(paihangbang4UI)


//class huamao.panel.rank.RankList extends ui.SLGGAME.paihangbangUI
var RankList=(function(_super){
	function RankList(){
		this._list=null;
		this.rankSession=null;
		this.rankAction=null;
		this.playerInfoAction=null;
		this.sysTips=null;
		RankList.__super.call(this);
		App.injOne(this);
		this._list=new List();
		this._list.repeatX=1;
		this._list.repeatY=9;
		this._list.spaceY=8;
		this._list.pos(37,160);
		this._list.size(858,490);
		this._list.renderHandler=new Handler(this,this.updateItem);
		this._list.vScrollBarSkin="";
		this.addChild(this._list);
		this.box0.labels="官职榜,获赞榜";
		this.box1.labels="全部获赞数排名,本月获赞数排名";
		this.box0.selectHandler=new Handler(this,this.onClick0);
		this.box1.selectHandler=new Handler(this,this.onClick1);
		this.sysTips=ConfigManager.getConfig("sys_tips.txt",3008);
		FlyLittleUpTips.regByString(this.wen,this.sysTips.tipsDescribe);
	}

	__class(RankList,'huamao.panel.rank.RankList',_super);
	var __proto=RankList.prototype;
	__proto.onClick0=function(index){
		this.box1.selectedIndex=-1;
		if(index==0){
			this.rankAction.getListByType(1);
		}
		else if(index==1){
			this.box1.selectedIndex=0;
		}
	}

	__proto.onClick1=function(index){
		if(index==0){
			this.rankAction.getListByType(2);
		}
		else if(index==1){
			this.rankAction.getListByType(3);
		}
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource,index);
	}

	__proto.onRefresh=function(type){
		if(type==1){
			this._list.itemRender=RankItem;
		}
		else{
			this._list.itemRender=RankItem2;
		}
		this._list.array=this.rankSession.getListByType(type);
		this._list.scrollTo(0);
		this.box1.visible=type !=1;
		this.t2.visible=type==1;
		this.t1.visible=type !=1;
		var myData=this.rankSession.getMyDataByType(type);
		this.txt0.text=myData==null ? "未上榜" :myData.index+"";
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.box1.visible=false;
		this.t1.visible=this.t2.visible=false;
		this.box0.selectedIndex=0;
	}

	return RankList;
})(paihangbangUI)


//class huamao.panel.shop.ItemTips extends ui.SLGGAME.tips0UI
var ItemTips=(function(_super){
	function ItemTips(){
		this.nameLa=new HTMLDivElement();
		this.shuLa=new HTMLDivElement();
		this.infoLa=new HTMLDivElement();
		ItemTips.__super.call(this);
		this.init();
	}

	__class(ItemTips,'huamao.panel.shop.ItemTips',_super);
	var __proto=ItemTips.prototype;
	__proto.init=function(){
		this.addChild(this.nameLa);
		this.addChild(this.shuLa);
		this.addChild(this.infoLa);
		this.nameLa.pos(15,10);
		this.shuLa.pos(15,35);
		this.shuLa.width=280;
		this.infoLa.width=280;
		this.infoLa.x=15;
		this.list0.visible=false;
	}

	__proto.setItemId=function(itemId){
		Laya.timer.callLater(this,this.nextFun);
		var sys=SysItem.getDataFromItemId(itemId);
		var bagItemData=new BagItemData();
		bagItemData.itemId=itemId;
		var tips=this.getShuXingStr(bagItemData);
		this.nameLa.innerHTML=TheGame.FONT(sys.itemName,"#00ff00",18,null);
		this.infoLa.innerHTML=TheGame.FONT(sys.itemDescription,"#ffffff",18,null);
		this.shuLa.innerHTML=tips;
		var arr=[this.nameLa,this.infoLa,this.shuLa];
		var maxWid=0;
		for (var i=0;i < arr.length;i++){
			var item=arr[i];
			maxWid=Math.max(item.contextWidth,maxWid);
		}
		this.infoLa.y=this.shuLa.y+this.shuLa.contextHeight+5;
		this.setSize(maxWid+30,this.infoLa.contextHeight+this.shuLa.contextHeight+70);
	}

	__proto.getShuXingStr=function(celldata){
		var result="";
		var shuxingary=celldata.getShuXing(0);
		for(var i=0;i<shuxingary.length;i+=2){
			result+=TheGame.FONT(shuxingary[i] ,"#ffffff" ,18 ,null)+TheGame.FONT("+"+shuxingary[i+1],"#00ff00",18,null);
		}
		return result;
	}

	__proto.nextFun=function(){
		Laya.stage.once("click",this,this.clearFun);
	}

	__proto.clearFun=function(){
		ItemTips.instance.removeSelf();
		Laya.stage.off("click",this,this.clearFun);
	}

	__proto.setSize=function(wid,hei){
		this.width=this.img0.width=wid;
		this.height=this.img0.height=hei;
	}

	ItemTips.show=function(itemId){
		if(ItemTips.instance==null){
			ItemTips.instance=new ItemTips();
		}
		ItemTips.instance.clearFun();
		App.layerManager.tipsLayer.addChild(ItemTips.instance);
		ItemTips.instance.pos(Laya.stage.mouseX,Laya.stage.mouseY);
		ItemTips.instance.setItemId(itemId);
	}

	ItemTips.instance=null;
	ItemTips.FONT_SIZE=18;
	return ItemTips;
})(tips0UI)


//class huamao.panel.recharge.RechargePanel extends ui.SLGGAME.chongzhiUI
var RechargePanel=(function(_super){
	function RechargePanel(){
		this.rechargeSession=null;
		this.rechargeAction=null;
		this.activitySession=null;
		this.sdkSession=null;
		this.arr=null;
		RechargePanel.__super.call(this);
		Dialog.closeAll();
		this.init();
	}

	__class(RechargePanel,'huamao.panel.recharge.RechargePanel',_super);
	var __proto=RechargePanel.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.arr=ConfigManager.getDataArr("sys_recharge_fytx.txt");
		for(var i=0;i<this.arr.length;i++){
			var rdata=this.arr[i];
			var box=this["b"+(i+1)];
			var imgNum=new ImageNumber("comp/chongzhi");
			imgNum.setValue(rdata.rechargeGold,-19);
			console.log(imgNum.width);
			//box.addChild(imgNum);
			//imgNum.x=box.width-imgNum.width+5;
			var btn=this ["cn"+(i+1)];
			var label=this ["zi"+(i+1)];
			var labelN=this ["n"+(i+1)];
			var labelS=this ["s"+(i+1)];
			var type=rdata.rechargeLimitType;
			//label.text=this.arr[i].rechargeDescribe;
			//btn.on("click",this,this.chongZhiFun,[rdata.rechargeId,rdata.rechargeChannelStage]);
			//labelN.text=rdata.rechargeCurrencyType;
			//labelS.text=rdata.rechargeCost+"";
			switch(type){
				case 1:
					this["d"+(i+1)].source="SLGGAME/chongzhi2.ani";
					break ;
				case 2:
					this["d"+(i+1)].source="SLGGAME/chongzhi1.ani";
					break ;
				}
		}
		this.upData();
	}

	__proto.chongZhiFun=function(id,str){
		if(this.sdkSession.checkFBPay()==false){
			return;
		}
		this.rechargeAction.sendGoumai(0,id,str);
	}

	__proto.upData=function(){
		for(var i=0;i<this.arr.length;i++){
			var num=this.rechargeSession.rechargeObj[this.arr[i].rechargeId];
			if(num>0){
				this["zi"+(i+1)].visible=false;
				this["d"+(i+1)].visible=false;
			}
			else{
				//this["zi"+(i+1)].visible=true;
				//this["d"+(i+1)].visible=true;
			}
		};
		var data=this.activitySession.getTypeActivity(6);
		if(data && data.rewardStatus==0){
			this["zi"+1].visible=true;
			this["d"+1].visible=true;
			var sysa=ConfigManager.getConfig("sys_activity.txt",data.activityId);
			this["zi"+1].text=sysa.activityDescribe;
		}
		else{
			this["zi"+1].visible=false;
			this["d"+1].visible=false;
		}
	}

	return RechargePanel;
})(chongzhiUI)


//class huamao.panel.setting.CDkeyPanel extends ui.SLGGAME.tips_cdKeyUI
var CDkeyPanel=(function(_super){
	function CDkeyPanel(){
		this.settingAction=null;
		CDkeyPanel.__super.call(this);
		App.injOne(this);
		this.duihuan.clickHandler=new Handler(this,this.onDuihuan);
		this.zhantie.clickHandler=new Handler(this,this.onZhantie);
		this.quxiao.clickHandler=new Handler(this,this.onClose);
	}

	__class(CDkeyPanel,'huamao.panel.setting.CDkeyPanel',_super);
	var __proto=CDkeyPanel.prototype;
	__proto.onClose=function(){
		this.close();
	}

	__proto.onZhantie=function(){}
	// TODO Auto Generated method stub
	__proto.onDuihuan=function(){
		this.settingAction.onSendMsg(2,this.txt0.text);
	}

	return CDkeyPanel;
})(tips_cdKeyUI)


//class huamao.panel.setting.SettingPanel extends ui.SLGGAME.shezhiUI
var SettingPanel=(function(_super){
	function SettingPanel(){
		this.settingSession=null;
		this.settingAction=null;
		this.kaiguanObj=new Object();
		SettingPanel.__super.call(this);
		App.injOne(this);
		for(var i=0;i < 5;i++){
			var radioGroup=this["r"+i];
			radioGroup.selectHandler=new Handler(this,this.onSelect,[i]);
			this.kaiguanObj[i]=radioGroup;
		}
		this.zhuxiao.clickHandler=new Handler(this,this.onZhuxiao);
		this.duihuan.clickHandler=new Handler(this,this.onDuihuan);
	}

	__class(SettingPanel,'huamao.panel.setting.SettingPanel',_super);
	var __proto=SettingPanel.prototype;
	__proto.onDuihuan=function(){
		App.dialogManager.openDialogByStr("CDKEY",null,true,true);
	}

	__proto.onZhuxiao=function(){
		LocalStorage.clear();
		App.reload();
	}

	__proto.onSelect=function(key){
		if(key==3 && GameState.state==1){
			return;
		};
		var radioGroup=this.kaiguanObj[key];
		var value=radioGroup.selectedIndex;
		this.settingSession.setValueByType(key,value);
		this.settingAction.onSendMsg(1,this.settingSession.getValue());
	}

	__proto.update=function(type){
		var radioGroup=this.kaiguanObj[type];
		if(type==3 && GameState.state==1){
			radioGroup.selectedIndex=1;
			return;
		}
		radioGroup.selectedIndex=this.settingSession.getValueByKey(type);
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		for(var key=0 in this.kaiguanObj){
			this.update(key);
		}
		for(var i=0;i < 5;i++){
			var radioGroup=this.kaiguanObj[i];
			radioGroup.selectHandler=new Handler(this,this.onSelect,[i]);
		}
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		for(var i=0;i < 5;i++){
			var radioGroup=this.kaiguanObj[i];
			radioGroup.selectHandler=null;
		}
	}

	return SettingPanel;
})(shezhiUI)


//class huamao.panel.wujiang.TeamChangeNameDialog extends ui.SLGGAME.tips_gmUI
var TeamChangeNameDialog=(function(_super){
	function TeamChangeNameDialog(){
		this.heroTeamAction=null;
		this.teamData=null;
		this.disArr=null;
		TeamChangeNameDialog.__super.call(this);
		App.injOne(this);
		this.yuanbao.visible=false;
		this.txt0.text="将队列的名字保存为:";
		this.quxiao.clickHandler=new Handler(this,this.cancelFun);
		this.queding.clickHandler=new Handler(this,this.enterFun);
	}

	__class(TeamChangeNameDialog,'huamao.panel.wujiang.TeamChangeNameDialog',_super);
	var __proto=TeamChangeNameDialog.prototype;
	__proto.setName=function(str){
		this.name0.text=str;
	}

	__proto.enterFun=function(){
		var len=GameUtils.getStringCharLen(this.name0.text);
		if(len < 4 || len > 8){
			FlyUpTips.setTips("请输入4-8个字符");
			return;
		}
		this.heroTeamAction.sendTeam(this.teamData.teamIndex,this.disArr,this.name0.text);
		this.close();
	}

	__proto.cancelFun=function(){
		this.close();
	}

	__proto.setAll=function(teamData,disArr){
		this.disArr=disArr;
		this.teamData=teamData;
		this.setName(teamData.teamName);
	}

	return TeamChangeNameDialog;
})(tips_gmUI)


//class huamao.panel.shop.ShopPanel extends ui.SLGGAME.shangdianUI
var ShopPanel=(function(_super){
	function ShopPanel(){
		this.shopSession=null;
		this.mainPlayerSession=null;
		this.shopAction=null;
		this.shopCd=NaN;
		this.itemary=null;
		//物品列表
		this.shopMaxCd=NaN;
		ShopPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(ShopPanel,'huamao.panel.shop.ShopPanel',_super);
	var __proto=ShopPanel.prototype;
	__proto._initBtnCB=function(v,index){
		v.ygm.visible=false;
		v.GOUMAI2.mouseEnabled=true;
		v.GOUMAI2.on("click",this,this.buyItem,[index]);
	}

	__proto.init=function(){
		this._initBtnCB(this.v1,1);
		this._initBtnCB(this.v2,2);
		this._initBtnCB(this.v3,3);
		this.xiaochulengque1.on("click",this,this.flushOrClear);
		this.jiahao.on("click",this,this.openChongZhiCB);
		this.jiahao1.on("click",this,this.openBuySilver);
		this.wenhao1.on("click",this,this.wenHaoCB);
		var data=ConfigManager.getConfig("sys_timetake.txt",0);
		this.shopMaxCd=data.timeMax;
		this.on("undisplay",this,this.removeTimer);
		this.flushCd();
		this.flushItem();
		this.flushIntimacy();
		this.flushGold();
		this.flushSilver();
		Laya.stage.timer.loop(1000,this,this._flushCd);
	}

	__proto.removeTimer=function(){
		Laya.stage.timer.clear(this,this._flushCd);
	}

	__proto.wenHaoCB=function(){
		FlyLittleUpTips.setTips("1.玩家可以一次性刷新商店中的三件商品。\n2.商店每4小时自动刷新一次。\n3.玩家每天可以免费手动刷新商店一次，此后手动刷新商店将消耗相应数量元宝。");
	}

	__proto.buyItem=function(index){
		if(this.itemary[(index-1)*2+1]==1){
			FlyUpTips.setTips("购买物品 购买过了 index = "+index);
			return;
		};
		var itemid=this.itemary[(index-1)*2];
		var sysshop=ConfigManager.getConfig("sys_shop.txt",itemid);
		if(sysshop.getPriceType()==MyGameConst.GOLD_ID){
			if(TipsPayBuyGold.IFVIEW){
				var tips=App.dialogManager.showMiniDialog(TipsPayBuyGold,true,true);
				tips.setId(sysshop.getPriceNum(),index);
				}else{
				App.voiceManager.playSound("buy.wav");
				this.shopAction.sendBuyItem(index);
			}
			}else{
			App.voiceManager.playSound("buy.wav");
			this.shopAction.sendBuyItem(index);
		}
	}

	__proto.openChongZhiCB=function(){
		App.dialogManager.openDialogByStr("RECHARGEPANEL",null,true,true);
	}

	__proto.openBuySilver=function(){
		App.dialogManager.openDialogByStr("Shop_Buy_Silver",null,true,true);
	}

	__proto.flushOrClear=function(){
		if(TipsClearCD.IFVIEW){
			var systimetake=ConfigManager.getConfig("sys_timetake.txt",54);
			var job=this.mainPlayerSession.mainPlayerData.job;
			var systitleplayer=ConfigManager.getConfig("sys_title_player.txt",job);
			if(this.shopSession._ramFlushTimes <=systimetake.timeCd-systitleplayer.titleFreeShopRefresh){
				var tipscd=App.dialogManager.showMiniDialog(TipsClearCD,true,true);
				tipscd.setTime(this.shopCd-GameUtils.GetServerTime());
				}else{
				this.shopAction.sendFlushItemOrClearCD();
			}
			}else{
			this.shopAction.sendFlushItemOrClearCD();
		}
	}

	// }
	__proto.flushCellView=function(v,id,stata){
		var sysitem=ConfigManager.getConfig("sys_item.txt",id);
		v.WUQI1.skin=GameUtils.getItemIconPath(id);
		v.WUQI1.size(85,85);
		v.WUQIMING.text=((sysitem==null)? (id+""):sysitem.itemName);
		var sysshop=ConfigManager.getConfig("sys_shop.txt",id);
		v.JINE.text=sysshop.getPriceNum()+"";
		v.img0.skin=GameUtils.getMoneyImg(sysshop.getPriceType());
		if(stata==0){
			v.ygm.visible=false;
			v.GOUMAI2.mouseEnabled=true;
			v.GOUMAI2.visible=true;
			}else{
			v.ygm.visible=true;
			v.GOUMAI2.mouseEnabled=false;
			v.GOUMAI2.visible=false;
		}
		v.WUQI1.on("click",this,this.clickItemFun,[id]);
	}

	__proto.clickItemFun=function(itemId){
		ItemTips.show(itemId);
	}

	__proto.resetFlushBtn=function(){
		var systimetake=ConfigManager.getConfig("sys_timetake.txt",54);
		var job=this.mainPlayerSession.mainPlayerData.job;
		var systitleplayer=ConfigManager.getConfig("sys_title_player.txt",job);
		if(this.shopSession._ramFlushTimes <=systimetake.timeCd-systitleplayer.titleFreeShopRefresh){
			this.xiaochulengque1.skin="comp/G/btn_yello.png";
			this.xiaochulengque1.label="立即刷新";
			}else{
			this.xiaochulengque1.skin="comp/G/btn_green.png";
			this.xiaochulengque1.label="免费刷新";
		}
	}

	__proto.flushItem=function(){
		this.itemary=this.shopSession.getItemAry();
		this.flushCellView(this.v1,this.itemary[0],this.itemary[1]);
		this.flushCellView(this.v2,this.itemary[2],this.itemary[3]);
		this.flushCellView(this.v3,this.itemary[4],this.itemary[5]);
		this.cishu.text=this.shopSession._ramFlushTimes+"";
		this.resetFlushBtn();
	}

	__proto.flushIntimacy=function(){
		var intimacylv=this.shopSession.getIntimacyLv();
		var intimacynum=this.shopSession.getIntimacyNum()
	}

	//qinmidengji.text="Lv."+intimacylv;
	__proto._checkIfOverTime=function(){
		if((this.shopCd-GameUtils.GetServerTime())> this.shopMaxCd){
			return true;
		}
		return false;
	}

	//重置刷新恩建外观
	__proto.resetClearBtnView=function(){
		if(this._checkIfOverTime()){}
			}
	//TODO:更改恩建外观，和倒计时颜色
	__proto.flushCd=function(){
		this.shopCd=this.shopSession.getShopCD();
		this.resetClearBtnView();
		this._flushCd();
	}

	__proto._flushCd=function(){
		var str=GameUtils.time(this.shopCd-GameUtils.GetServerTime());
		this.shijian1.text=str;
	}

	__proto.show=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.show.call(this,closeOther,showEffect);
		console.log("show shop --->");
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		FlyLittleUpTips.getinstance().close();
		console.log("close shop --->");
	}

	__proto.flushGold=function(){
		var gold=this.mainPlayerSession.mainPlayerData.gold;
		this.txt1.text=gold+"";
	}

	__proto.flushSilver=function(){
		var silver=this.mainPlayerSession.mainPlayerData.silver;
		this.txt2.text=silver+"";
	}

	return ShopPanel;
})(shangdianUI)


//class huamao.panel.shop.TipsBuySilver extends ui.SLGGAME.shangdian_tips1UI
var TipsBuySilver=(function(_super){
	function TipsBuySilver(){
		this.shopAction=null;
		TipsBuySilver.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsBuySilver,'huamao.panel.shop.TipsBuySilver',_super);
	var __proto=TipsBuySilver.prototype;
	__proto.init=function(){
		this.initVi(this.v1,10508);
		this.initVi(this.v2,10509);
		this.initVi(this.v3,10510);
	}

	__proto.initVi=function(v,id){
		var sysshop=ConfigManager.getConfig("sys_shop.txt",id);
		var sysitem=ConfigManager.getConfig("sys_item.txt",id);
		var itemid=sysshop.getPriceType();
		var num=sysshop.getPriceNum();
		v.WUQI1.skin=GameUtils.getItemIconPath(sysitem.itemIcon);
		v.WUQI1.size(84,85);
		v.WUQIMING.text=sysitem.itemName;
		v.img0.skin="comp/G/x_yuanbao.png";
		v.JINE.text=num+"";
		v.GOUMAI2.on("click",this,this.gouMaiCB,[id]);
		v.ygm.visible=false;
		var ary=sysitem.useScript.split(",");
		var lbl=new Label();
		lbl.fontSize=18;
		lbl.color="#e8d8d7";
		lbl.align="right";
		lbl.anchorX=lbl.anchorY=1;
		lbl.text=ary[2];
		lbl.pos(178,194);
		lbl.zOrder=30;
		v.addChild(lbl);
	}

	__proto.gouMaiCB=function(id){
		var sysshop=ConfigManager.getConfig("sys_shop.txt",id);
		var num=sysshop.getPriceNum();
		if(tipsForBuySilver.IFVIEW){
			var tips=App.dialogManager.showMiniDialog(tipsForBuySilver,true,true,false,false);
			tips.setId(id,num);
			}else{
			this.shopAction.sendBuySilver(id);
		}
	}

	return TipsBuySilver;
})(shangdian_tips1UI)


//class huamao.panel.shouchong.ShouChongPanel extends ui.SLGGAME.shouchongUI
var ShouChongPanel=(function(_super){
	function ShouChongPanel(){
		this.activitySession=null;
		this.activityAction=null;
		this.role=null;
		this.image=null;
		this.currData=null;
		ShouChongPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(ShouChongPanel,'huamao.panel.shouchong.ShouChongPanel',_super);
	var __proto=ShouChongPanel.prototype;
	__proto.init=function(){
		this.role=new DragonBonesMc(false,false);
		this.role.setUrl("res/load/juesesi.sk");
		this.addChild(this.role);
		this.role.pos(275,590);
		this.role.scaleX=-0.8;
		this.role.scaleY=0.8;
		this.addChild(this.heiehi);
		this.addChild(this.diao);
		this.upData();
		if(this.currData){
			var arr=this.currData.getSysData().activityReward.split(",");
			arr.splice(0,2);
			var index=0;
			for(var i=0;i<arr.length;i+=2){
				var icon=new Item();
				var image=this["k"+index];
				image.addChild(icon);
				icon.size(image.width-8,image.height-8);
				icon.pos(4,4);
				if(arr[i]>0){
					icon.setItemId(arr[i]);
					icon.setNum(arr[i+1]);
					ActivityPicTips.nameTips(icon,this,arr[i]);
					}else{
					icon.setItemId(arr[i+1],false);
					icon.setNum(1);
					ActivityPicTips.heroNameTips(icon,this,arr[i+1]);
				}
				index++;
			}
		}
		this.chongzhi.on("click",this,this.clickFun);
	}

	__proto.upData=function(){
		this.chongzhi.visible=true;
		this.lingqu.visible=false;
		this.currData=this.activitySession.getTypeActivity(5);
		if(!this.currData)return;
		if(this.currData.rewardStatus==0){
			this.chongzhi.label="去充值";
			}else if(this.currData.rewardStatus==1){
			this.chongzhi.label="领取奖励";
			}else if(this.currData.rewardStatus==2){
			this.chongzhi.label="已领取";
			this.chongzhi.visible=false;
			this.lingqu.visible=true;
		}
	}

	__proto.clickFun=function(){
		if(!this.currData)return;
		if(this.currData.rewardStatus==0){
			App.dialogManager.openDialogByStr("RECHARGEPANEL",null,true,true);
			}else if(this.currData.rewardStatus==1){
			this.activityAction.sendLingQu(this.currData.activityId);
		}
	}

	return ShouChongPanel;
})(shouchongUI)


//class huamao.panel.stratagem.StratagemPanel extends ui.SLGGAME.jiceUI
var StratagemPanel=(function(_super){
	function StratagemPanel(){
		this.stratagemSession=null;
		this.stratagemAction=null;
		this.mainPlayerSession=null;
		this.stratagemcd=NaN;
		StratagemPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(StratagemPanel,'huamao.panel.stratagem.StratagemPanel',_super);
	var __proto=StratagemPanel.prototype;
	__proto.yanJiuClick=function(id){
		var strategy=ConfigManager.getConfig("sys_strategy.txt",id);
		if(this.stratagemSession.getStratagemOrder()>=strategy.getCostNum()){
			App.voiceManager.playSound("maijimou.wav");
		}
		this.stratagemAction.sendStratagem(id);
	}

	__proto.initcell=function(v,id,skin){
		v.yanjiu.on("click",this,this.yanJiuClick,[id]);
		var strategy=ConfigManager.getConfig("sys_strategy.txt",id);
		var itemid=strategy.strItem;
		var sysitem=ConfigManager.getConfig("sys_item.txt",itemid);
		v.dikuang.skin="comp/jice/"+skin+".png";
		v.caiyuan.skin="res/item/"+itemid+".png";
		v.caiyuan.size(75,75);
		v.shijian2.text=strategy.getCostNum()+"";
		v.caiyuan.on("click",this,this.shuoMingCB,[sysitem.itemDescription]);
		this.flushOrder();
		this.flushCd();
		this._flushCd();
	}

	__proto.shuoMingCB=function(str){
		FlyLittleUpTips.setTips(str);
	}

	__proto.init=function(){
		this.initcell(this.v1,1001,"caiyuan");
		this.initcell(this.v2,1002,"wugu");
		this.initcell(this.v3,1003,"zhaobing");
		this.initcell(this.v4,1004,"xingjun");
		this.initcell(this.v5,1005,"nenggong");
		this.initcell(this.v6,1006,"luban");
		this.initcell(this.v7,1007,"qianli");
		this.initcell(this.v8,1008,"miaoshou");
		this.on("undisplay",this,this.removeTimer);
		Laya.stage.timer.loop(1000,this,this._flushCd);
		this.jia.on("click",this,this.buyCB);
		this.wenhao.on("click",this,this.wenHaoCB);
		this.checkJob();
	}

	__proto.removeTimer=function(){
		Laya.stage.timer.clear(this,this._flushCd);
	}

	__proto.wenHaoCB=function(){
		FlyLittleUpTips.setTips("1.玩家通过消耗计策令立即研究并获得任意计策。\n2.计策令每10分钟增加1个，上限为80个。\n3.点击计策令右侧“+”号按钮，可消耗一定的元宝增加对应计策令。\n消耗元宝获得的计策令不受上限影响。");
	}

	__proto.buyCB=function(){
		if(TipsStratagemBuy2.IFVIEW){
			App.dialogManager.showMiniDialog(TipsStratagemBuy2,true,true);
			}else{
			this.stratagemAction.sendBuyStratagemOrder();
		}
	}

	__proto.flushCd=function(){
		this.stratagemcd=this.stratagemSession.getStratagemCd();
	}

	__proto.flushOrder=function(){
		var order=this.stratagemSession.getStratagemOrder();
		this.shu0.text=order+"";
	}

	__proto._flushCd=function(){
		var str=GameUtils.time(this.stratagemcd-GameUtils.GetServerTime());
		this.shijian.text=str;
	}

	__proto.checkJob=function(){
		var curjob=this.mainPlayerSession.mainPlayerData.job;
		if(curjob >=1006){
			this.v8.visible=true;
			}else{
			this.v8.visible=false;
		}
	}

	return StratagemPanel;
})(jiceUI)


/**
*显示所有武将的面板
*/
//class huamao.panel.wujiang.WuJiangPanel extends ui.SLGGAME.wujiangUI
var WuJiangPanel=(function(_super){
	function WuJiangPanel(){
		WuJiangPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(WuJiangPanel,'huamao.panel.wujiang.WuJiangPanel',_super);
	var __proto=WuJiangPanel.prototype;
	__proto.init=function(){
		this.check0.selected=WuJiangPanel.DIS_WEAPON;
		this.check1.selected=WuJiangPanel.DIS_LEGION;
		this.xue.selected=WuJiangPanel.DIS_XUECANG;
		this.check1.visible=true;
		this.check1.mouseEnabled=true;
		this.xue.visible=true;
		this.xue.mouseEnabled=true;
		this.list0.spaceY=8;
		this.list0.itemRender=HeroBox;
		this.list0.vScrollBarSkin="";
		this.list0.selectEnable=true;
		this.list0.renderHandler=new Handler(this,this.renderFun);
	}

	__proto.renderFun1=function(cell,index){
		var heroData=this.list0.getItem(index);
		cell.setAll(heroData,WuJiangPanel.DIS_WEAPON,this.tab0.selectedIndex);
		cell.on("click",this,this.clickFun,[heroData]);
	}

	__proto.renderFun=function(cell,index){
		var heroData=this.list0.getItem(index);
		cell.setHeroData(heroData,1);
		cell.setEquip(WuJiangPanel.DIS_WEAPON);
		cell.setTeam(this.tab0.selectedIndex);
		cell.on("click",this,this.clickFun,[heroData]);
	}

	__proto.clickFun=function(heroData){
		App.dialogManager.openDialogByStr("WUJIANGSHUOMING",{heroId:heroData.heroId,team:this.list0.array });
	}

	__proto.setHeroArr=function(arr){
		this.list0.array=arr;
	}

	//获取紫色品质武将
	__proto.getCellIndexZi=function(type){
		for(var i=0;i<this.list0.array.length;i++){
			var data=this.list0.array [i];
			var heroid=data.heroId;
			var syshero=ConfigManager.getConfig("sys_hero.txt",heroid);
			if(syshero.heroColor==type){
				return i;
			}
		}
		return 0;
	}

	//获取武将所在排序
	__proto.getJeneralCellIndex=function(id){
		for(var i=0;i<this.list0.array.length;i++){
			var data=this.list0.array [i];
			var heroid=data.heroId;
			if(id==heroid){
				return i;
			}
		}
		return 0;
	}

	__proto.setHeroNum=function(value){
		this.txt1.text=value+"";
	}

	WuJiangPanel.DIS_WEAPON=false;
	WuJiangPanel.DIS_LEGION=false;
	WuJiangPanel.DIS_XUECANG=false;
	return WuJiangPanel;
})(wujiangUI)


//class huamao.panel.talk.TipsTalkSet extends ui.SLGGAME.tips_ltshezhiUI
var TipsTalkSet=(function(_super){
	function TipsTalkSet(){
		this._index=0;
		this.vieAry=[];
		this.vieAry2=[];
		this._qipaoindex=0;
		this.mapCitySession=null;
		this.mainPlayerSession=null;
		this.rechargeSession=null;
		this.settingAction=null;
		this.settingSession=null;
		this.unionSession=null;
		this.ifvip1=false;
		this.ifvip2=false;
		this.posary1=[
		[323,95],
		[455,95],
		[590,95],];
		this.posary2=[
		[323,152],
		[455,152],
		[590,152],
		[323,201],
		[455,201],
		[590,201],];
		TipsTalkSet.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsTalkSet,'huamao.panel.talk.TipsTalkSet',_super);
	var __proto=TipsTalkSet.prototype;
	__proto.init=function(){
		this.ifvip1=(this.rechargeSession.getVip(1)!=null);
		this.ifvip2=(this.rechargeSession.getVip(2)!=null);
		App.eventManager.on("WAIJIAO_FLUSH",this,this.flushViewZuDuiCB);
		this.quxiao.on("click",this,this.quXiaoCB);
		this.queding.on("click",this,this.queDingCB);
		this.xuankuang.x=75;
		this.qipao0.on("click",this,this.imgCB,[0]);
		this.qipao1.on("click",this,this.imgCB,[1]);
		this._index=0;
		this.vieAry[0]=this.gz;
		this.vieAry[1]=this.gj;
		this.vieAry[2]=this.lm;
		for(var i=0;i<3;i++){
			var checkbox=this.vieAry [i];
			checkbox.on("click",this,this.radioGroupCB,[i]);
		}
		this.vieAry2[0]=this.shijie;
		this.vieAry2[1]=this.dangqian;
		this.vieAry2[2]=this.duiwu;
		this.vieAry2[3]=this.xitong;
		this.vieAry2[4]=this.guojia;
		this.vieAry2[5]=this.lianmeng0;
		this.shijie.on("change",this,this.shiJieCB);
		this.dangqian.on("change",this,this.dangQianCB);
		this.duiwu.on("change",this,this.duiWuCB);
		this.xitong.on("change",this,this.xiTongCB);
		this.guojia.on("change",this,this.guoJiaCB);
		this.lianmeng0.on("change",this,this.lianMengCB);
		(this.ifvip1 || this.ifvip2)? (this.qipao1.visible=true):(this.qipao1.visible=false);
		this.guojia.visible=false;
		this.gj.visible=false;
		this.settingSession.resetSetting();
		for(i=0;i<3;i++){
			if(TipsTalkSet.VIEW==i){
				(this.vieAry [i]).selected=true;
				}else{
				(this.vieAry [i]).selected=false;
			}
		}
		TipsTalkSet.PINDAO_SHIJIE ? (this.shijie.selected=true):(this.shijie.selected=false);
		TipsTalkSet.PINDAO_DANGQIAN ? (this.dangqian.selected=true):(this.dangqian.selected=false);
		TipsTalkSet.PINDAO_XITONG ? (this.xitong.selected=true):(this.xitong.selected=false);
		TipsTalkSet.PINDAO_DUIWU ? (this.duiwu.selected=true):(this.duiwu.selected=false);
		TipsTalkSet.PINDAO_LIANMENG ?(this.lianmeng0.selected=true):(this.lianmeng0.selected=false);
		TipsTalkSet.QIPAO=this.imgCB(TipsTalkSet.QIPAO);
		this.flushViewZuDuiCB();
		this.flushViewLianMeng();
	}

	__proto.resetPos1=function(){
		var j=0;
		for(var i=0;i<this.vieAry.length;i++){
			var checkbox=this.vieAry [i];
			if(checkbox.visible){
				checkbox.pos(this.posary1[j][0],this.posary1[j][1]);
				j++;
			}
		}
	}

	__proto.resetPos2=function(){
		var j=0;
		for(var i=0;i<this.vieAry2.length;i++){
			var checkbox=this.vieAry2 [i];
			if(checkbox.visible){
				checkbox.pos(this.posary2[j][0],this.posary2[j][1]);
				j++;
			}
		}
	}

	__proto.flushViewZuDuiCB=function(){
		var myplayerid=this.mainPlayerSession.mainPlayerData.playerId;
		var mengyouid=this.mapCitySession.getCityPlayer(myplayerid).mengyouId;
		if(mengyouid > 0){
			this.duiwu.visible=true;
			this.duiwu.mouseEnabled=true;
			}else{
			this.duiwu.visible=false;
			this.duiwu.mouseEnabled=false;
		}
		this.resetPos1();
	}

	__proto.flushViewLianMeng=function(){
		if(this.unionSession.isUnion()){
			this.lianmeng0.visible=true;
			this.lm.visible=true;
			}else{
			this.lianmeng0.visible=false;
			this.lm.visible=false;
		}
		this.resetPos1();
		this.resetPos2();
	}

	__proto.imgCB=function(index){
		if(index==0){
			this._qipaoindex=0;
			this.xuankuang.x=75;
		}
		if(index==1){
			if(this.ifvip1){
				this._qipaoindex=1;
				this.xuankuang.x=224;
				this.qipao1.visible=true;
				}else{
				this.qipao1.visible=false;
				this._qipaoindex=0;
				this.xuankuang.x=75;
				return 0;
			}
		}
		if(index==2){
			if(this.ifvip2){
				this._qipaoindex=2;
				this.xuankuang.x=224;
				}else{
				this._qipaoindex=0;
				this.xuankuang.x=75;
			}
		}
		return index;
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	__proto.remSet=function(){
		TipsTalkSet.VIEW=this._index;
		TipsTalkSet.PINDAO_LIANMENG=this.lianmeng0.selected;
		TipsTalkSet.PINDAO_GUOJIA=this.guojia.selected;
		TipsTalkSet.PINDAO_XITONG=this.xitong.selected;
		TipsTalkSet.PINDAO_DUIWU=this.duiwu.selected;
		TipsTalkSet.PINDAO_DANGQIAN=this.dangqian.selected;
		TipsTalkSet.PINDAO_SHIJIE=this.shijie.selected;
		var pd_lm=TipsTalkSet.PINDAO_LIANMENG ?1:0;
		var pd_gj=TipsTalkSet.PINDAO_GUOJIA ?1:0;
		var pd_xt=TipsTalkSet.PINDAO_XITONG ?1:0;
		var pd_dw=TipsTalkSet.PINDAO_DUIWU ?1:0;
		var pd_dq=TipsTalkSet.PINDAO_DANGQIAN ?1:0;
		var pd_sj=TipsTalkSet.PINDAO_SHIJIE ?1:0;
		TipsTalkSet.QIPAO=this._qipaoindex;
		var result=""+TipsTalkSet.VIEW+pd_sj+pd_dq+pd_dw+pd_xt+pd_gj+pd_lm+TipsTalkSet.QIPAO;
		console.log("发送聊天设置 --》 "+result);
		this.settingAction.onSendMsg(3,result);
	}

	__proto.queDingCB=function(){
		this.remSet();
		this.close();
	}

	__proto.lianMengCB=function(){}
	__proto.guoJiaCB=function(){}
	__proto.xiTongCB=function(){}
	__proto.duiWuCB=function(){}
	__proto.dangQianCB=function(){}
	__proto.shiJieCB=function(){}
	//0官职 1国家 2联盟
	__proto.radioGroupCB=function(index){
		for(var i=0;i<3;i++){
			var checkbox=this.vieAry [i];
			if(index !=i){
				checkbox.selected=false;
				}else{
				if(checkbox.selected){
					this._index=index;
					}else{
					this._index=-1;
				}
			}
		}
		console.log("select = "+this._index);
	}

	TipsTalkSet.remFist=true;
	TipsTalkSet.VIEW=0;
	TipsTalkSet.PINDAO_SHIJIE=true;
	TipsTalkSet.PINDAO_DANGQIAN=true;
	TipsTalkSet.PINDAO_DUIWU=false;
	TipsTalkSet.PINDAO_XITONG=true;
	TipsTalkSet.PINDAO_GUOJIA=false;
	TipsTalkSet.PINDAO_LIANMENG=false;
	TipsTalkSet.QIPAO=0;
	return TipsTalkSet;
})(tips_ltshezhiUI)


//class huamao.panel.task.RenwuPanel extends ui.SLGGAME.renwuUI
var RenwuPanel=(function(_super){
	function RenwuPanel(){
		RenwuPanel.__super.call(this);
	}

	__class(RenwuPanel,'huamao.panel.task.RenwuPanel',_super);
	return RenwuPanel;
})(renwuUI)


//class huamao.panel.TaskDialog extends ui.SLGGAME.renwuUI
var TaskDialog=(function(_super){
	function TaskDialog(){
		TaskDialog.__super.call(this);
	}

	__class(TaskDialog,'huamao.panel.TaskDialog',_super);
	return TaskDialog;
})(renwuUI)


//class huamao.panel.tipsPanel.TZSXZPanel extends ui.tips_npcUI
var TZSXZPanel=(function(_super){
	function TZSXZPanel(){
		TZSXZPanel.__super.call(this);
		App.injOne(this);
		this.queren.on("click",this,this.tzshengXZ);
		this.zi.text=this.getTips(2021);
		this.lis.labels=this.getTips(2022)+","+this.getTips(2023);
		App.setCloseDialogOnSide(false);
		this.on("undisplay",this,this.undisplayerCB);
	}

	__class(TZSXZPanel,'huamao.panel.tipsPanel.TZSXZPanel',_super);
	var __proto=TZSXZPanel.prototype;
	__proto.undisplayerCB=function(){
		App.setCloseDialogOnSide(true);
	}

	__proto.tzshengXZ=function(){
		if(this.lis.selectedIndex==0){
			App.eventManager.event("TINGBUBIAN");
		}
		this.close();
	}

	__proto.getTips=function(tipsId){
		var systips=ConfigManager.getConfig("sys_tips.txt",tipsId);
		return systips.tipsDescribe;
	}

	__proto.onSelect=function(){}
	return TZSXZPanel;
})(tips_npcUI)


//class huamao.panel.union.NewUnionPanel extends ui.SLGGAME.lianmeng_cjUI
var NewUnionPanel=(function(_super){
	function NewUnionPanel(){
		this.listView=null;
		this.newUnion=null;
		this.contentSp=null;
		this.autoEvent=null;
		this.unionSession=null;
		NewUnionPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(NewUnionPanel,'huamao.panel.union.NewUnionPanel',_super);
	var __proto=NewUnionPanel.prototype;
	__proto.init=function(){
		this.unionSession.seleQizhi=1;
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("CHUANGJIANCOM",this,this.chuangJianCom);
		this.autoEvent.addEventNow();
		this.ti1.selectHandler=new Handler(this,this.setView);
		this.ti1.selectedIndex=0;
	}

	__proto.chuangJianCom=function(){
		this.close();
	}

	__proto.setView=function(index){
		if(this.contentSp)this.contentSp.removeSelf();
		if(index==0){
			if(!this.listView){
				this.listView=new UnionList();
			}
			this.listView.upData();
			this.contentSp=this.listView;
			}else if(index==1){
			if(!this.newUnion){
				this.newUnion=new NewUnionView();
			}
			this.newUnion.upData();
			this.contentSp=this.newUnion;
		}
		this.addChild(this.contentSp);
		this.contentSp.pos(29,128);
	}

	return NewUnionPanel;
})(lianmeng_cjUI)


//class huamao.panel.union.ShenQingList extends ui.SLGGAME.lianmeng_sqUI
var ShenQingList=(function(_super){
	function ShenQingList(){
		this.unionAction=null;
		this.unionSession=null;
		this.autoEvent=null;
		ShenQingList.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(ShenQingList,'huamao.panel.union.ShenQingList',_super);
	var __proto=ShenQingList.prototype;
	__proto.init=function(){
		this.xuanzhong.visible=false;
		this.list0.mouseEnabled=true;
		this.list0.itemRender=UnionShenQingItem;
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("SHENQING",this,this.upData);
		this.autoEvent.addEventNow();
		this.tongguo.on("click",this,this.tongguoFun);
		this.jujue.on("click",this,this.jujueFun);
		this.unionAction.sendShenQing();
		this.upData();
	}

	__proto.jujueFun=function(){
		this.unionAction.sendAllJuJue();
	}

	__proto.tongguoFun=function(){
		this.unionAction.sendAllTongGuo();
	}

	__proto.updateItem=function(item,index){
		item.upData(item.dataSource);
	}

	__proto.upData=function(){
		this.list0.array=this.unionSession.shenQingList;
	}

	return ShenQingList;
})(lianmeng_sqUI)


//class huamao.panel.zhanbao.Shoucang.ShoucangZhanbaoInfo extends ui.SLGGAME.zhanbao_jiesuanUI
var ShoucangZhanbaoInfo=(function(_super){
	function ShoucangZhanbaoInfo(){
		this.shouFenSession=null;
		this.shouFenAction=null;
		this.zhanbaoInfo
		ShoucangZhanbaoInfo.__super.call(this);
		App.injOne(this);
		this.fenxiang.visible=false;
		this.shoucang.clickHandler=new Handler(this,this.onShoucang);
		this.tongji.clickHandler=new Handler(this,this.onTongji);
		this.huifang.clickHandler=new Handler(this,this.onHuifang);
		this.on("click",this,this.clickFun);
	}

	__class(ShoucangZhanbaoInfo,'huamao.panel.zhanbao.Shoucang.ShoucangZhanbaoInfo',_super);
	var __proto=ShoucangZhanbaoInfo.prototype;
	__proto.clickFun=function(e){
		if(!((e.target instanceof laya.ui.Button ))){
			this.close();
		}
	}

	__proto.onTongji=function(){
		App.dialogManager.openDialogByStr("TONGJI",{battleId:this.zhanbaoInfo.battleFileUrl},true,true);
	}

	__proto.onShoucang=function(){
		if(this.shouFenSession.getIsHas(this.zhanbaoInfo.battleId)){
			this.shouFenAction.sendQuxiao(this.zhanbaoInfo.battleId);
		}
		else{
			this.shouFenAction.sendShoucang(this.zhanbaoInfo.battleId,this.zhanbaoInfo.type);
		}
	}

	__proto.onHuifang=function(){
		this.close();
		App.eventManager.event("BATTLE",this.zhanbaoInfo.battleFileUrl+"");
	}

	__proto.onUpdate=function(id){
		if(this.zhanbaoInfo.battleId==id){
			this.shoucang.label=this.shouFenSession.getIsHas(this.zhanbaoInfo.battleId)? "取消收藏" :"收藏";
		}
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.zhanbaoInfo=this.tag.data;
		this.img_0.skin=this.zhanbaoInfo.result==0 ? "comp/haoyou/shengli.png" :"comp/haoyou/shibai.png";
		this.jg_0.text=this.zhanbaoInfo.attackName;
		this.jg_1.value=(this.zhanbaoInfo.attackBingli-this.zhanbaoInfo.attackLoseBingli)/ this.zhanbaoInfo.attackBingli;
		this.jg_txt.text=(this.zhanbaoInfo.attackBingli-this.zhanbaoInfo.attackLoseBingli)+"/"+this.zhanbaoInfo.attackBingli;
		this.jg_2.text=this.zhanbaoInfo.attackLoseBingli+"";
		if(this.zhanbaoInfo.defenseName==""){
			var sysCity=ConfigManager.getConfig("sys_city.txt",this.zhanbaoInfo.cityId);
			this.fs_0.text=sysCity.cityName+"守军";
		}
		else{
			this.fs_0.text=this.zhanbaoInfo.defenseName;
		}
		this.fs_1.value=(this.zhanbaoInfo.defenseBingli-this.zhanbaoInfo.defenseLoseBingli)/ this.zhanbaoInfo.defenseBingli;
		this.fs_txt.text=(this.zhanbaoInfo.defenseBingli-this.zhanbaoInfo.defenseLoseBingli)+"/"+this.zhanbaoInfo.defenseBingli;
		this.fs_2.text=this.zhanbaoInfo.defenseLoseBingli+"";
		this.shoucang.label=this.shouFenSession.getIsHas(this.zhanbaoInfo.battleId)? "取消收藏" :"收藏";
		this.jiangli.visible=this.jl_0.visible=this.jl_1.visible=this.jl_2.visible=false;
		this.wenhao.visible=this.zhanbaoInfo.deltaExp !=0;
		if(this.zhanbaoInfo.type==1){
			this.jiangli.visible=this.jl_0.visible=this.jl_1.visible=this.jl_2.visible=true;
			this.jl_1.text=this.zhanbaoInfo.exp+"";
			if(this.zhanbaoInfo.deltaExp==0){
				this.jl_2.text="";
			}
			else{
				this.jl_2.text="("+this.zhanbaoInfo.deltaExp+"%)";
			}
		}
	}

	return ShoucangZhanbaoInfo;
})(zhanbao_jiesuanUI)


//class huamao.panel.union.TipsChongZhi extends ui.lianmeng_tipsUI
var TipsChongZhi=(function(_super){
	function TipsChongZhi(){
		/**1元宝充值 2 银两充值*/
		this.type=0;
		TipsChongZhi.__super.call(this);
	}

	__class(TipsChongZhi,'huamao.panel.union.TipsChongZhi',_super);
	var __proto=TipsChongZhi.prototype;
	__proto.upData=function(_type){
		this.type=_type;
		this.init();
	}

	__proto.init=function(){
		if(this.type==1){
			this.wenben.text="元宝不足";
			}else{
			this.wenben.text="银两不足";
		}
		this.chongzhi.on("click",this,this.openChongZhi);
		this.quxiao.on("click",this,this.close);
	}

	__proto.openChongZhi=function(){
		if(this.type==1){
			App.dialogManager.openDialogByStr("RECHARGEPANEL",null,true,true);
			}else{
			App.dialogManager.showMiniDialog(TipsBuySilver,true,true,false,false)
		}
		this.close();
	}

	return TipsChongZhi;
})(lianmeng_tipsUI)


//class huamao.panel.zhanbao.ZhanBaoInfo extends ui.SLGGAME.zhanbao_jiesuanUI
var ZhanBaoInfo=(function(_super){
	function ZhanBaoInfo(){
		this.mapCitySession=null;
		this.shouFenAction=null;
		this.shouFenSession=null;
		this.zhanbaoInfo=null;
		ZhanBaoInfo.__super.call(this);
		App.injOne(this);
		this.fenxiang.clickHandler=new Handler(this,this.onFenxiang);
		this.shoucang.clickHandler=new Handler(this,this.onShoucang);
		this.tongji.clickHandler=new Handler(this,this.onTongji);
		this.huifang.clickHandler=new Handler(this,this.onHuifang);
		this.wenhao.clickHandler=new Handler(this,this.onWenhao);
		this.on("click",this,this.clickFun);
	}

	__class(ZhanBaoInfo,'huamao.panel.zhanbao.ZhanBaoInfo',_super);
	var __proto=ZhanBaoInfo.prototype;
	__proto.clickFun=function(e){
		if(!((e.target instanceof laya.ui.Button ))){
			this.close();
		}
	}

	__proto.onWenhao=function(){
		FlyLittleUpTips.setTips("当对手等级低于您3级以上时，获得经验减少，等级差越多，获得经验越少。",320);
	}

	__proto.onShoucang=function(){
		if(this.shouFenSession.getIsHas(this.zhanbaoInfo.battleId)){
			this.shouFenAction.sendQuxiao(this.zhanbaoInfo.battleId);
		}
		else{
			this.shouFenAction.sendShoucang(this.zhanbaoInfo.battleId);
		}
	}

	__proto.onFenxiang=function(){
		App.dialogManager.openDialogByStr("FENXIANG",{battleId:this.zhanbaoInfo.battleFileUrl},true,true);
	}

	__proto.onTongji=function(){
		App.dialogManager.openDialogByStr("TONGJI",{battleId:this.zhanbaoInfo.battleFileUrl},true,true);
	}

	__proto.onHuifang=function(){
		this.close();
		App.eventManager.event("BATTLE",this.zhanbaoInfo.battleFileUrl+"");
	}

	__proto.onUpdate=function(id){
		if(this.zhanbaoInfo.battleId==id){
			this.shoucang.label=this.shouFenSession.getIsHas(this.zhanbaoInfo.battleId)? "取消收藏" :"收藏";
		}
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this);
		FlyLittleUpTips.getinstance().close();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.zhanbaoInfo=this.tag.data;
		this.img_0.skin=this.zhanbaoInfo.isWin==0 ? "comp/haoyou/shengli.png" :"comp/haoyou/shibai.png";
		this.jg_0.text=this.zhanbaoInfo.attName;
		this.jg_1.value=(this.zhanbaoInfo.attBingli-this.zhanbaoInfo.attLoseBingli)/ this.zhanbaoInfo.attBingli;
		this.jg_txt.text=(this.zhanbaoInfo.attBingli-this.zhanbaoInfo.attLoseBingli)+"/"+this.zhanbaoInfo.attBingli;
		this.jg_2.text=this.zhanbaoInfo.attLoseBingli+"";
		if(this.zhanbaoInfo.defName==""){
			var sysCity=ConfigManager.getConfig("sys_city.txt",this.zhanbaoInfo.cityId);
			this.fs_0.text=sysCity.cityName+"守军";
		}
		else{
			this.fs_0.text=this.zhanbaoInfo.defName;
		}
		this.fs_1.value=(this.zhanbaoInfo.defBingli-this.zhanbaoInfo.defLoseBingli)/ this.zhanbaoInfo.defBingli;
		this.fs_txt.text=(this.zhanbaoInfo.defBingli-this.zhanbaoInfo.defLoseBingli)+"/"+this.zhanbaoInfo.defBingli;
		this.fs_2.text=this.zhanbaoInfo.defLoseBingli+"";
		this.jl_1.text=this.zhanbaoInfo.exp+"";
		if(this.zhanbaoInfo.deltaExp==0){
			this.jl_2.text="";
		}
		else{
			this.jl_2.text="("+this.zhanbaoInfo.deltaExp+"%)";
		}
		this.wenhao.visible=this.zhanbaoInfo.deltaExp !=0;
		this.shoucang.label=this.shouFenSession.getIsHas(this.zhanbaoInfo.battleId)? "取消收藏" :"收藏";
	}

	return ZhanBaoInfo;
})(zhanbao_jiesuanUI)


//class huamao.panel.union.UnionDongTai extends ui.lianmeng_dongtaiUI
var UnionDongTai=(function(_super){
	function UnionDongTai(){
		this.autoEvent=null;
		this.unionAction=null;
		this.unionSession=null;
		UnionDongTai.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionDongTai,'huamao.panel.union.UnionDongTai',_super);
	var __proto=UnionDongTai.prototype;
	__proto.init=function(){
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("UPDATADONGTAI",this,this.upData);
		this.liebiao.itemRender=UnionDongTaiItem;
		this.liebiao.vScrollBarSkin="";
		this.liebiao.selectEnable=true;
		this.liebiao.renderHandler=new Handler(this,this.updateItem);
		this.unionAction.sendDongTai();
		this.upData();
	}

	__proto.upData=function(){
		this.liebiao.array=this.unionSession.dongtaiArr;
	}

	__proto.updateItem=function(item,index){
		item.upData(item.dataSource);
	}

	return UnionDongTai;
})(lianmeng_dongtaiUI)


//class huamao.panel.zhanbao.ZhanbaoList extends ui.SLGGAME.zhanbaoUI
var ZhanbaoList=(function(_super){
	function ZhanbaoList(){
		this._list=null;
		this.mapCitySession=null;
		this.mapCityAction=null;
		this.shouFenSession=null;
		ZhanbaoList.__super.call(this);
		App.injOne(this);
		this._list=new List();
		this._list.itemRender=ZhanbaoItem;
		this._list.repeatX=1;
		this._list.repeatY=4;
		this._list.height=450;
		this._list.pos(15,63);
		this._list.renderHandler=new Handler(this,this.updateItem);
		this._list.selectEnable=true;
		this._list.vScrollBarSkin="";
		this.addChild(this._list);
		this.btn0.clickHandler=new Handler(this,this.onZhanbao);
		this.btn1.clickHandler=new Handler(this,this.allRead);
	}

	__class(ZhanbaoList,'huamao.panel.zhanbao.ZhanbaoList',_super);
	var __proto=ZhanbaoList.prototype;
	__proto.onZhanbao=function(){
		if(this.shouFenSession.getDataList().length==0){
			FlyUpTips.setTips("尚未收藏战报");
			return;
		}
		App.dialogManager.openDialogByStr("SHOUCANG",null,true,true);
	}

	__proto.onSelect=function(z){
		var item=z;
		this.mapCityAction.onJianbao(item.curData.battleId);
		item.curData.isRead=1;
		item.update(item.curData);
		App.eventManager.event("BATTLE_INFO_IS_READ");
		this.update();
	}

	__proto.allRead=function(){
		if(this.mapCitySession.isAllRead()){
			FlyUpTips.setTips("暂无未读战报");
			return;
		}
		this.mapCityAction.onZhanbaoAllRead();
		this.mapCitySession.allRead();
		this.update();
		var sysTips=ConfigManager.getConfig("sys_tips.txt",33);
		if(sysTips){
			FlyUpTips.setTips(sysTips.tipsDescribe);
		}
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
		item.on("click",this,this.onSelect,[item]);
	}

	//item.on(ListItemEvent.SELECT_LIST,this,onSelect);
	__proto.update=function(){
		this._list.array=this.mapCitySession.getList();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.update();
	}

	return ZhanbaoList;
})(zhanbaoUI)


//class huamao.panel.union.UnionJianZhu extends ui.SLGGAME.lianmeng_1UI
var UnionJianZhu=(function(_super){
	function UnionJianZhu(){
		this.arrData=[];
		this.autoEvent=null;
		this.mainPlayerSession=null;
		UnionJianZhu.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionJianZhu,'huamao.panel.union.UnionJianZhu',_super);
	var __proto=UnionJianZhu.prototype;
	__proto.init=function(){
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("UNIONUPDATA",this,this.upData);
		this.autoEvent.add("FLUSH_PLAYER_GOLD",this,this.flushGold);
		this.autoEvent.add("FLUSH_PLAYER_SILVER",this,this.flushSilver);
		this.arrData=ConfigManager.getDataArr("sys_society_cost.txt");
		this.list0.itemRender=UnionJianZhuItem;
		this.list0.vScrollBarSkin="";
		this.list0.selectEnable=true;
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.array=this.arrData;
		this.flushGold();
		this.flushSilver();
		this.wen.on("click",this,this.openTips);
	}

	__proto.openTips=function(){
		App.dialogManager.showMiniDialog(UnionJianZhuTips,true,true,false,false);
	}

	__proto.flushSilver=function(){
		this.yin.text=this.mainPlayerSession.mainPlayerData.silver+"";
	}

	__proto.flushGold=function(){
		this.jin.text=this.mainPlayerSession.mainPlayerData.gold+"";
	}

	__proto.upData=function(){
		this.list0.refresh();
	}

	__proto.updateItem=function(item,index){
		item.upData(item.dataSource);
	}

	return UnionJianZhu;
})(lianmeng_1UI)


//class huamao.panel.union.UnionJianZhuTips extends ui.lianmeng_tips_1UI
var UnionJianZhuTips=(function(_super){
	function UnionJianZhuTips(){
		UnionJianZhuTips.__super.call(this);
	}

	__class(UnionJianZhuTips,'huamao.panel.union.UnionJianZhuTips',_super);
	return UnionJianZhuTips;
})(lianmeng_tips_1UI)


//class huamao.panel.union.UnionJieSan extends ui.SLGGAME.lianmeng_jsUI
var UnionJieSan=(function(_super){
	function UnionJieSan(){
		this.type=0;
		UnionJieSan.__super.call(this);
		this.init();
	}

	__class(UnionJieSan,'huamao.panel.union.UnionJieSan',_super);
	var __proto=UnionJieSan.prototype;
	__proto.init=function(){
		this.fou.on("click",this,this.closeFun);
		this.shi.on("click",this,this.yesFun);
	}

	/**1退出 2解散*/
	__proto.upData=function(_type){
		this.type=_type;
		if(this.type==1){
			this.ti.text="退出联盟";
			this.txt1.text="退出联盟后，联盟总贡献清零";
			this.txt2.text="退出联盟后，需要等待24个小时方可创建、申请其他联盟";
			this.txt3.text="退出联盟后，保留你的帮贡值";
			}else if(this.type==2){
			this.ti.text="解散联盟";
			this.txt1.text="解散联盟后，联盟总贡献清零";
			this.txt2.text="解散联盟后，需要等待24个小时方可创建、申请其他联盟";
			this.txt3.text="解散联盟后，保留你的帮贡值";
		}
	}

	__proto.yesFun=function(){
		App.eventManager.event("UNIONTISHI",this.type);
		this.closeFun();
	}

	__proto.closeFun=function(){
		this.close();
	}

	return UnionJieSan;
})(lianmeng_jsUI)


//class huamao.panel.union.UnionList extends ui.SLGGAME.lianmeng_lbUI
var UnionList=(function(_super){
	function UnionList(){
		/**从0开始*/
		this.index=0;
		/**每页多少个*/
		this.pageNum=5;
		this.unionAction=null;
		this.autoEvent=null;
		this.unionSession=null;
		/**0：正常列表 1：搜索列表*/
		this.type=0;
		this.souCurrPage=0;
		this.souMaxPage=0;
		this.currData=null;
		this.sys=null;
		this.time=0;
		UnionList.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionList,'huamao.panel.union.UnionList',_super);
	var __proto=UnionList.prototype;
	__proto.init=function(){
		this.xuanzhong.visible=false;
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("UNIONLISTUPDATA",this,this.upDataList);
		this.autoEvent.add("MYSHENQING",this,this.upDataShenQing);
		this.autoEvent.add("SOUSUOLIST",this,this.upDataSousuo);
		this.autoEvent.addEventNow();
		this.list0.itemRender=UnionListItem;
		this.list0.vScrollBarSkin="";
		this.list0.height=343;
		this.list0.selectEnable=true;
		this.list0.selectHandler=new Handler(this,this.seleFun);
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.scrollBar.elasticDistance=0;
		this.list0.scrollBar.elasticBackTime=0;
		this.list0.refresh();
		this.fanzuo.on("click",this,this.zuoFun);
		this.fanyou.on("click",this,this.youFun);
		this.shenqing.on("click",this,this.shenQingFun);
		this.mingzi.on("click",this,this.sendSouSuo);
	}

	__proto.upDataSousuo=function(){
		this.xuanzhong.visible=false;
		this.souMaxPage=Math.ceil(this.unionSession.souSuoList.length/this.pageNum);
		this.type=1;
		var arr=[];
		var dataArr=this.unionSession.souSuoList;
		for(var i=this.souCurrPage;i<dataArr.length;i++){
			arr.push(dataArr[i]);
		}
		this.list0.array=arr;
	}

	__proto.sendSouSuo=function(){
		if(this.txt0.text==""){
			this.upData();
			}else{
			this.unionAction.sendSuoSuo(this.txt0.text);
		}
	}

	__proto.upDataShenQing=function(){
		this.list0.refresh();
	}

	__proto.shenQingFun=function(){
		if((this.sys.reallianceCd-this.time)>0){
			GameUtils.setError(1022,GameUtils.time(this.sys.reallianceCd-this.time));
			return;
		}
		if(this.currData){
			this.unionAction.sendJiaRuId(this.currData.id);
		}
	}

	__proto.seleFun=function(index){
		if(index==-1)return;
		this.xuanzhong.visible=true;
		this.selectItem(index);
	}

	__proto.selectItem=function(index){
		var item=this.list0.getCell(index);
		this.xuanzhong.y=item.y+70;
		this.currData=this.list0.getItem(index);
		this.lianmeng.text=this.currData.unionName;
		this.id0.text=this.currData.id+"";
		this.mengzhu.text=this.currData.mengZhu;
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this.currData.job);
		this.paiming.text=sysTitle.titleName;
		this.gonggao.text=this.currData.notice;
	}

	__proto.updateItem=function(item,index){
		item.upData(item.dataSource);
	}

	__proto.upDataList=function(){
		this.xuanzhong.visible=false;
		this.index=this.unionSession.index;
		this.list0.array=this.unionSession.currArr;
		if(this.list0.array.length>0){
			this.ye.text=(this.index/this.pageNum+1)+"/"+Math.ceil(this.unionSession.maxNum/this.pageNum);
			this.list0.selectedIndex=-1;
			this.selectItem(0);
			}else{
			this.ye.text="0/0";
		}
		this.fanzuo.visible=true;
		this.fanyou.visible=true;
		if((this.index/this.pageNum)==0){
			this.fanzuo.visible=false;
		}
		if((this.index/this.pageNum+1)==Math.ceil(this.unionSession.maxNum/this.pageNum)){
			this.fanyou.visible=false;
		}
	}

	__proto.youFun=function(){
		if(this.type==0){
			if((this.index+this.pageNum)<this.unionSession.maxNum){
				this.index+=this.pageNum;
			}
			this.setPage();
			}else{
			this.souCurrPage++;
			if(this.souCurrPage>=this.souMaxPage){
				this.souCurrPage=this.souMaxPage-1;
			}
			this.upDataSousuo();
		}
	}

	__proto.zuoFun=function(){
		if(this.type==0){
			if(this.index>0){
				this.index-=this.pageNum;
			}
			this.setPage();
			}else{
			this.souCurrPage--;
			if(this.souCurrPage<0){
				this.souCurrPage=0;
			}
			this.upDataSousuo();
		}
	}

	__proto.setPage=function(){
		this.unionAction.sendList(this.index,this.pageNum);
	}

	__proto.upData=function(){
		this.type=0;
		this.index=0;
		this.unionAction.sendList(this.index,this.pageNum);
		this.clearTime();
		this.sys=ConfigManager.getConfig("sys_society_basic.txt" ,1);
		this.time=GameUtils.GetServerTime()-this.unionSession.endTime;
		if(this.time<this.sys.reallianceCd){
			Laya.timer.loop(1000,this,this.loopFun);
			this.loopFun();
		}
	}

	__proto.loopFun=function(){
		this.time=GameUtils.GetServerTime()-this.unionSession.endTime;
		this.time0.text="冷却中"+"："+GameUtils.time(this.sys.reallianceCd-this.time);
		if((this.sys.reallianceCd-this.time)<=0){
			this.clearTime();
		}
	}

	__proto.clearTime=function(){
		this.time0.text="";
		Laya.timer.clear(this,this.loopFun);
	}

	return UnionList;
})(lianmeng_lbUI)


//class huamao.panel.union.UnionOtheList extends ui.lianmeng_chakanUI
var UnionOtheList=(function(_super){
	function UnionOtheList(){
		/**从0开始*/
		this.index=0;
		/**每页多少个*/
		this.pageNum=6;
		this.unionAction=null;
		this.autoEvent=null;
		this.unionSession=null;
		this.currData=null;
		UnionOtheList.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionOtheList,'huamao.panel.union.UnionOtheList',_super);
	var __proto=UnionOtheList.prototype;
	__proto.init=function(){
		this.xuanzhong.visible=false;
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("UNIONLISTUPDATA",this,this.upDataList);
		this.autoEvent.add("MYSHENQING",this,this.upDataShenQing);
		this.autoEvent.addEventNow();
		this.list0.repeatY=this.pageNum;
		this.list0.itemRender=UnionListItem;
		this.list0.vScrollBarSkin="";
		this.list0.height=411;
		this.list0.selectEnable=true;
		this.list0.selectHandler=new Handler(this,this.seleFun);
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.scrollBar.elasticDistance=0;
		this.list0.scrollBar.elasticBackTime=0;
		this.list0.refresh();
		this.fanzuo.on("click",this,this.zuoFun);
		this.fanyou.on("click",this,this.youFun);
		this.upData();
	}

	__proto.upDataShenQing=function(){
		this.list0.refresh();
	}

	__proto.seleFun=function(index){
		if(index==-1)return;
		this.xuanzhong.visible=true;
		this.selectItem(index);
	}

	__proto.selectItem=function(index){
		var item=this.list0.getCell(index);
		this.xuanzhong.y=item.y+148;
		this.currData=this.list0.getItem(index);
		this.lianmeng.text=this.currData.unionName;
		this.id0.text=this.currData.id+"";
		this.mengzhu.text=this.currData.mengZhu;
		var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this.currData.job);
		this.paiming.text=sysTitle.titleName;
		this.gonggao.text=this.currData.notice;
	}

	__proto.updateItem=function(item,index){
		item.upData(item.dataSource);
	}

	__proto.upDataList=function(){
		this.xuanzhong.visible=false;
		this.index=this.unionSession.index;
		this.list0.array=this.unionSession.currArr;
		if(this.list0.array.length>0){
			this.ye.text=(this.index/this.pageNum+1)+"/"+Math.ceil(this.unionSession.maxNum/this.pageNum);
			this.list0.selectedIndex=-1;
			this.selectItem(0);
			}else{
			this.ye.text="0/0";
		}
		this.fanzuo.visible=true;
		this.fanyou.visible=true;
		if((this.index/this.pageNum)==0){
			this.fanzuo.visible=false;
		}
		if((this.index/this.pageNum+1)==Math.ceil(this.unionSession.maxNum/this.pageNum)){
			this.fanyou.visible=false;
		}
	}

	__proto.youFun=function(){
		if((this.index+this.pageNum)<this.unionSession.maxNum){
			this.index+=this.pageNum;
		}
		this.setPage();
	}

	__proto.zuoFun=function(){
		if(this.index>0){
			this.index-=this.pageNum;
		}
		this.setPage();
	}

	__proto.setPage=function(){
		this.unionAction.sendList(this.index,this.pageNum);
	}

	__proto.upData=function(){
		this.index=0;
		this.setPage();
	}

	return UnionOtheList;
})(lianmeng_chakanUI)


//class huamao.panel.union.UnionPanel extends ui.lianmeng_cjlbUI
var UnionPanel=(function(_super){
	function UnionPanel(){
		this.mc=null;
		this.autoEvent=null;
		this.unionAction=null;
		this.unionSession=null;
		this.playerInfoAction=null;
		this.friendAction=null;
		this.menu=null;
		this.input=null;
		this.currPlayer=null;
		this.arr=null;
		UnionPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionPanel,'huamao.panel.union.UnionPanel',_super);
	var __proto=UnionPanel.prototype;
	__proto.init=function(){
		this.input=new Input();
		this.input.multiline=true;
		this.input.wordWrap=true;
		this.input.promptColor="#95acc1";
		this.input.color="#95acc1";
		this.input.size(276,175);
		this.input.pos(54,498);
		this.input.maxChars=60;
		this.input.fontSize=24;
		this.input.prompt="联盟公告最长60个字";
		this.input.on("blur",this,this.sendGongGao);
		this.addChild(this.input);
		this.mc=new ClipMc();
		this.mc.pos(187,178);
		this.mc.autoPlay=true;
		this.addChild(this.mc);
		this.menu=new UnionMenu();
		this.menu.on("MENUCLICK",this,this.selectFun);
		this.unionAction.sendPlayerList();
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("DISSOLVE",this,this.dissFun);
		this.autoEvent.add("PLAYERLIST",this,this.setDataFun);
		this.autoEvent.add("MYUNIONUPDATA",this,this.setData);
		this.autoEvent.add("UNIONUPDATA",this,this.setBtn);
		this.autoEvent.add("PLAYERCLICK",this,this.clickPlayerFun);
		this.autoEvent.add("QIZHIUPDATA",this,this.qizhi);
		this.autoEvent.add("UPDATAGONGGAO",this,this.upDataGongGao);
		this.autoEvent.add("UNIONTISHI",this,this.tishiFun);
		this.autoEvent.add("UNIONEXP",this,this.expFun);
		this.autoEvent.add("UNIONMENGZHU",this,this.mengzhuFun);
		this.autoEvent.add("UNIONRENSHU",this,this.renshuFun);
		this.autoEvent.addEventNow();
		this.zaixian.on("change",this,this.changeFun);
		this.genghuan.on("click",this,this.genghuanFun);
		this.jiesan.on("click",this,this.exitFun);
		this.tuichu.on("click",this,this.tuichuFun);
		this.liebiao.itemRender=UnionPlayerListItem;
		this.liebiao.vScrollBarSkin="";
		this.liebiao.selectEnable=true;
		this.liebiao.renderHandler=new Handler(this,this.updateItem);
		this.setDataFun();
		this.setData();
		this.shenqing.on("click",this,this.openShenQing);
		this.jianshe.on("click",this,this.openJianShe);
		this.shangdian.on("click",this,this.openShop);
		this.dongtai.on("click",this,this.openDongtai);
		this.qita.on("click",this,this.openQita);
		this.tan.on("click",this,this.openLvPanel);
	}

	__proto.openLvPanel=function(){
		App.dialogManager.showMiniDialog(UnionShuoMing,true,true,false,false);
	}

	__proto.openQita=function(){
		App.dialogManager.showMiniDialog(UnionOtheList,true,true,false,false);
	}

	__proto.renshuFun=function(){
		var sys=ConfigManager.getConfig("sys_society_levelup.txt",this.unionSession.unionLv);
		this.chengyuan.text=this.unionSession.unionPlayerNum+"/"+sys.allianceNum;
	}

	__proto.mengzhuFun=function(){
		this.mengzhu.text=this.unionSession.unionMengZhuName;
	}

	__proto.expFun=function(){
		var sys=ConfigManager.getConfig("sys_society_levelup.txt",this.unionSession.unionLv);
		this.jingyanzhi.text=this.unionSession.unionExp+"/"+sys.allianceLvup;
		this.jingyan.value=this.unionSession.unionExp/sys.allianceLvup;
	}

	__proto.sendGongGao=function(){
		if(this.unionSession.unionNotice !=this.input.text){
			this.unionAction.sendGongGao(this.input.text);
		}
	}

	__proto.openDongtai=function(){
		App.dialogManager.showMiniDialog(UnionDongTai,true,true,false,false);
	}

	__proto.upDataGongGao=function(){
		this.input.text=this.unionSession.unionNotice;
	}

	__proto.openShop=function(){
		App.dialogManager.showMiniDialog(UnionShop,true,true,false,false);
	}

	__proto.openJianShe=function(){
		App.dialogManager.showMiniDialog(UnionJianZhu,true,true,false,false);
	}

	__proto.genghuanFun=function(){
		App.dialogManager.showMiniDialog(UnionQiZhi,true,true,false,false);
	}

	__proto.changeFun=function(){
		this.setDataFun();
	}

	__proto.tuichuFun=function(){
		if(this.unionSession.zhiWu==UnionAction.ZHUMENGZHU){
			GameUtils.setError(1038);
			return;
		};
		var jiesan=App.dialogManager.showMiniDialog(UnionJieSan,true,true,false,false);
		jiesan.upData(1);
	}

	__proto.exitFun=function(){
		var jiesan=App.dialogManager.showMiniDialog(UnionJieSan,true,true,false,false);
		jiesan.upData(2);
	}

	/**1退出 2解散*/
	__proto.tishiFun=function(type){
		if(type==1){
			this.unionAction.sendExit();
			}else if(type==2){
			this.unionAction.DissolveFun();
		}
	}

	__proto.openShenQing=function(){
		App.dialogManager.showMiniDialog(ShenQingList,true,true,false,false);
	}

	__proto.selectFun=function(obj){
		var type=obj.type;
		var data=obj.data;
		switch (type){
			case UnionMenu.RenMing:
				this.unionAction.sendRenZhiCheXiao(data.playerId,UnionAction.FUMENGZHU);
				break ;
			case UnionMenu.CheZhi:
				this.unionAction.sendRenZhiCheXiao(data.playerId,UnionAction.CHENGYUAN);
				break ;
			case UnionMenu.RangWei:
				this.unionAction.sendRenZhiCheXiao(data.playerId,UnionAction.ZHUMENGZHU);
				break ;
			case UnionMenu.ZhuChu:
				if(this.unionSession.zhiWu==type){
					GameUtils.setError(1052);
					return;
				}
				this.unionAction.sendZhuChu(data.playerId);
				break ;
			case UnionMenu.JiaHaoYou:
				this.friendAction.sendApplyFriend(data.playerId);
				break ;
			case UnionMenu.XiangQing:
				this.playerInfoAction.sendViewPlayerMes(data.playerId);
				break ;
			}
	}

	__proto.clickPlayerFun=function(data){
		var arr=[];
		if(this.unionSession.zhiWu==UnionAction.CHENGYUAN){
			arr=[UnionMenu.JiaHaoYou,UnionMenu.XiangQing];
			}else if(this.unionSession.zhiWu==UnionAction.FUMENGZHU){
			if(data.zhiWu==UnionAction.ZHUMENGZHU){
				arr=[UnionMenu.JiaHaoYou,UnionMenu.XiangQing];
				}else{
				arr=[UnionMenu.ZhuChu,UnionMenu.JiaHaoYou,UnionMenu.XiangQing];
			}
			}else if(this.unionSession.zhiWu==UnionAction.ZHUMENGZHU){
			if(data.zhiWu==UnionAction.FUMENGZHU){
				arr=[UnionMenu.CheZhi,UnionMenu.RangWei,UnionMenu.ZhuChu,UnionMenu.JiaHaoYou,UnionMenu.XiangQing];
				}else{
				arr=[UnionMenu.RenMing,UnionMenu.RangWei,UnionMenu.ZhuChu,UnionMenu.JiaHaoYou,UnionMenu.XiangQing];
			}
		}
		this.menu.setData(arr,data);
	}

	__proto.setDataFun=function(){
		this.arr=this.unionSession.getPlayerList(this.zaixian.selected);
		this.liebiao.array=this.arr;
		this.setBtn();
	}

	__proto.setBtn=function(){
		this.arr=this.unionSession.getPlayerList(false);
		this.liang.text=this.unionSession.feat+"";
		this.qita.visible=this.tuichu.visible=this.shenqing.visible=this.jiesan.visible=this.genghuan.visible=false;
		if(this.unionSession.zhiWu==UnionAction.FUMENGZHU || this.unionSession.zhiWu==UnionAction.ZHUMENGZHU){
			this.genghuan.visible=true;
			this.input.editable=true;
			this.shenqing.visible=true;
			if(this.arr.length>1){
				this.tuichu.visible=true;
				}else{
				this.jiesan.visible=true;
			}
			}else{
			this.input.editable=false;
			this.qita.visible=true;
			this.tuichu.visible=true;
		}
	}

	__proto.updateItem=function(item,index){
		item.upData(item.dataSource);
	}

	/**联盟信息*/
	__proto.setData=function(){
		this.lianmengmingcheng.text=this.unionSession.unionName;
		this.dengji.text=this.unionSession.unionLv+"";
		var sys=ConfigManager.getConfig("sys_society_levelup.txt",this.unionSession.unionLv);
		this.jingyanzhi.text=this.unionSession.unionExp+"/"+sys.allianceLvup;
		this.jingyan.value=this.unionSession.unionExp/sys.allianceLvup;
		this.mengzhu.text=this.unionSession.unionMengZhuName;
		this.chengyuan.text=this.unionSession.unionPlayerNum+"/"+sys.allianceNum;
		this.input.text=this.unionSession.unionNotice;
		this.qizhi();
	}

	__proto.qizhi=function(){
		this.mc.setClipName("clip"+this.unionSession.unionBanner+"_4_4");
	}

	__proto.dissFun=function(){
		this.close();
	}

	return UnionPanel;
})(lianmeng_cjlbUI)


//class huamao.utils.NormalAlert extends ui.SLGGAME.tips_tsUI
var NormalAlert=(function(_super){
	function NormalAlert(){
		this._sureHandler=null;
		this._cancelHandler=null;
		NormalAlert.__super.call(this);
		this.btn1.clickHandler=new Handler(this,this.onClose);
		this.btn0.clickHandler=new Handler(this,this.onSure);
		this.box0.visible=false;
	}

	__class(NormalAlert,'huamao.utils.NormalAlert',_super);
	var __proto=NormalAlert.prototype;
	__proto.onClose=function(){
		this._cancelHandler && this._cancelHandler.runWith(this._cancelHandler.args);
		this.close();
	}

	__proto.onSure=function(){
		this._sureHandler && this._sureHandler.runWith(this._sureHandler.args);
		this.close();
	}

	__proto.setAll=function(title,content,sureHandler,cancelHandler){
		if(title){}
			this.txt1.text=content;
		this._sureHandler=sureHandler;
		this._cancelHandler=cancelHandler;
	}

	return NormalAlert;
})(tips_tsUI)


//class huamao.panel.union.UnionQiZhi extends ui.lianmeng_qizhiUI
var UnionQiZhi=(function(_super){
	function UnionQiZhi(){
		this.unionSession=null;
		this.unionAction=null;
		this.autoEvent=null;
		this.mainPlayerSession=null;
		this.sys=null;
		this.gold=0;
		this.currIndex=0;
		UnionQiZhi.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionQiZhi,'huamao.panel.union.UnionQiZhi',_super);
	var __proto=UnionQiZhi.prototype;
	__proto.init=function(){
		this.autoEvent=new AutoEvent(this);
		this.sys=ConfigManager.getConfig("sys_society_basic.txt" ,1);
		this.autoEvent.add("FLUSH_PLAYER_GOLD",this,this.upDataYuanBao);
		this.gengfai.visible=false;
		this.xuanze.visible=false;
		if(this.unionSession.unionId==0){
			this.xuanze.visible=true;
			}else{
			this.gengfai.visible=true;
		}
		this.list0.itemRender=UnionQiZhiItem;
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.selectHandler=new Handler(this,this.seleFun);
		this.list0.array=this.unionSession.qizhiList;
		this.list0.vScrollBarSkin="";
		this.list0.selectEnable=true;
		this.list0.selectedIndex=0;
		this.xuan.on("click",this,this.xuanzeFun);
		this.geng.on("click",this,this.genghuanFun);
		this.upDataYuanBao();
	}

	__proto.upDataYuanBao=function(){
		this.gold=this.mainPlayerSession.mainPlayerData.gold;
		this.yuanbao.text=this.gold+"/"+this.sys.flagCost;
	}

	__proto.genghuanFun=function(){
		var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true,false,false);
		alert.setAll(null,"是否花费"+this.sys.flagCost+"元宝，更改旗帜",new Handler(this,this.genghuan));
	}

	__proto.genghuan=function(){
		if(this.gold<this.sys.flagCost){
			GameUtils.openBuZu(this.sys.flagCost);
			return;
		}
		this.unionAction.sendQiZhi(this.unionSession.seleQizhi);
		this.close();
	}

	__proto.xuanzeFun=function(){
		App.eventManager.event("SELEQIZHI");
		this.close();
	}

	__proto.seleFun=function(index){
		this.currIndex=index;
		this.unionSession.seleQizhi=this.unionSession.qizhiList[index];
		var item=this.list0.getCell(index);
		if(item){
			item.xuan.visible=true;
		}
	}

	__proto.updateItem=function(item,index){
		if(this.currIndex==index){
			item.xuan.visible=true;
			}else{
			item.xuan.visible=false;
		}
		item.upData(item.dataSource);
	}

	return UnionQiZhi;
})(lianmeng_qizhiUI)


//class huamao.panel.union.UnionShop extends ui.SLGGAME.lianmeng_sdUI
var UnionShop=(function(_super){
	function UnionShop(){
		this.arrData=null;
		this.autoEvent=null;
		this.unionSession=null;
		UnionShop.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(UnionShop,'huamao.panel.union.UnionShop',_super);
	var __proto=UnionShop.prototype;
	__proto.init=function(){
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("UNIONUPDATA",this,this.upData);
		this.list0.itemRender=UnionShopItem;
		this.list0.vScrollBarSkin="";
		this.list0.selectEnable=true;
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.arrData=ConfigManager.getDataArr("sys_society_shop.txt");
		this.list0.array=this.arrData;
		this.banggong.text=this.unionSession.feat+"";
	}

	__proto.upData=function(){
		this.banggong.text=this.unionSession.feat+"";
		this.list0.refresh();
	}

	__proto.updateItem=function(item,index){
		item.upData(item.dataSource);
	}

	return UnionShop;
})(lianmeng_sdUI)


//class huamao.panel.union.UnionShuoMing extends ui.lianmeng_shuomingUI
var UnionShuoMing=(function(_super){
	function UnionShuoMing(){
		UnionShuoMing.__super.call(this);
		this.init();
	}

	__class(UnionShuoMing,'huamao.panel.union.UnionShuoMing',_super);
	var __proto=UnionShuoMing.prototype;
	__proto.init=function(){
		var arr=ConfigManager.getDataArr("sys_society_levelup.txt");
		this.diaochan.itemRender=UnionShuoMingItem;
		this.diaochan.renderHandler=new Handler(this,this.updateItem);
		this.diaochan.vScrollBarSkin="";
		this.diaochan.selectEnable=true;
		this.diaochan.array=arr;
	}

	__proto.updateItem=function(item,index){
		item.upData(item.dataSource);
	}

	return UnionShuoMing;
})(lianmeng_shuomingUI)


//class huamao.panel.UseJice extends ui.SLGGAME.tips_syjcUI
var UseJice=(function(_super){
	function UseJice(){
		this.mapCityAction=null;
		this.mapCitySession=null;
		this.bagSession=null;
		this.mainPlayerSession=null;
		UseJice.__super.call(this);
		App.injOne(this);
		this.quxiao.clickHandler=new Handler(this,this.onClose);
	}

	__class(UseJice,'huamao.panel.UseJice',_super);
	var __proto=UseJice.prototype;
	__proto.onUse=function(itemId,gold,daojuHandler,yuanbaoHandler){
		this.yanjiu.clickHandler=yuanbaoHandler;
		this.shiyong.clickHandler=daojuHandler;
		this.shu.text=gold+"元宝";
		var itemNum=0;
		if(itemId==4003){
			var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this.mainPlayerSession.mainPlayerData.job);
			var sysmath=ConfigManager.getConfig("sys_match.txt",sysTitle.titleRoom);
			var shengyuTimes=sysmath.dailyLimit-this.mapCitySession.zhaobingmaimaTimes;
			this.txt0.text="使用1个招兵买马可增加10000预备役(今日剩余"+shengyuTimes+"次)";
			itemNum=this.bagSession.getItemNumByItemId(4003);
			this.shengyu.text="剩余："+itemNum+"个";
		}
		else if(itemId==4004){
			this.txt0.text="减少一半的行军时间需要花费1个行军加速";
			itemNum=this.bagSession.getItemNumByItemId(4004);
			this.shengyu.text="剩余："+itemNum+"个";
		}
		else if(itemId==4005){
			this.txt0.text="使用1个能工巧匠可以让城池除太守府外的所有建筑立即完成升级";
			itemNum=this.bagSession.getItemNumByItemId(4005);
			this.shengyu.text="剩余："+itemNum+"个";
		}
		else if(itemId==4006){
			this.txt0.text="使用1个鲁班在世可以让太守府立即完成升级";
			itemNum=this.bagSession.getItemNumByItemId(4006);
			this.shengyu.text="剩余："+itemNum+"个";
		}
		else if(itemId==4007){
			this.txt0.text="使用1个千里驰远，可以派遣一支队伍进去盟友城池协助防守。队伍可撤回或者阵亡后自动返回。";
			itemNum=this.bagSession.getItemNumByItemId(4007);
			this.shengyu.text="剩余："+itemNum+"个";
		}
		if(itemNum==0){
			this.shiyong.label="研究";
		}
		else{
			this.shiyong.label="使用";
		}
		this.popup();
	}

	__proto.onClose=function(){
		this.close();
	}

	__getset(1,UseJice,'ins',function(){
		if(UseJice._ins==null){
			UseJice._ins=new UseJice();
		}
		return UseJice._ins;
	},ui.SLGGAME.tips_syjcUI._$SET_ins);

	UseJice._ins=null;
	return UseJice;
})(tips_syjcUI)


//class huamao.panel.vip.VipPanel extends ui.SLGGAME.huiyuanfuwuUI
var VipPanel=(function(_super){
	function VipPanel(){
		this.rechargeSession=null;
		this.rechargeAction=null;
		this.itemArr=[];
		this.sdkSession=null;
		this.arr=null;
		VipPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(VipPanel,'huamao.panel.vip.VipPanel',_super);
	var __proto=VipPanel.prototype;
	__proto.init=function(){
		this.arr=ConfigManager.getDataArr("sys_member.txt");
		var sys1=this.arr[0];
		this.te1.text=sys1.memberDescribe;
		var item1=new VipItem();
		item1.centerX=item1.centerY=0;
		this.di1.addChild(item1);
		this.itemArr.push(item1);
		this.dianji1.on("click",this,this.clickFun,[sys1.memberId]);
		this.lj1.on("click",this,this.goumaiFun,[sys1.memberId,sys1.rechargeChannelStage]);
		var sys2=this.arr[1];
		this.te2.text=sys2.memberDescribe;
		var item2=new VipItem();
		item2.centerX=item2.centerY=0;
		this.di2.addChild(item2);
		this.itemArr.push(item2);
		this.dianji2.on("click",this,this.clickFun,[sys2.memberId]);
		this.lj2.on("click",this,this.goumaiFun,[sys2.memberId,sys2.rechargeChannelStage]);
		this.upData();
	}

	/**
	*购买vip
	*@param id
	*@param str
	*
	*/
	__proto.goumaiFun=function(id,str){
		if(this.sdkSession.checkFBPay()==false){
			return;
		}
		this.rechargeAction.sendGoumai(1,id,str);
	}

	/**
	*领取vip
	*@param id
	*
	*/
	__proto.clickFun=function(id){
		if(this.sdkSession.checkFBPay()==false){
			return;
		}
		this.rechargeAction.lingVip(id);
	}

	__proto.upData=function(){
		this.clear();
		var i=0;
		for(i=0;i<this.itemArr.length;i++){
			var item=this.itemArr[i];
			var sys=this.arr[i];
			item.upData(sys.memberId);
			var vipArr=this.rechargeSession.getVip(sys.memberId);
			if(vipArr){
				this["dianji"+(i+1)].visible=true;
				var num=vipArr[0];
				if(num==0){
					this["dianji"+(i+1)].label="领取奖励";
				}
				else{
					this["dianji"+(i+1)].label="已领取";
				}
			}
			else{
				this["lj"+(i+1)].visible=true;
			}
		}
	}

	__proto.clear=function(){
		this.lj1.visible=false;
		this.lj2.visible=false;
		this.dianji1.visible=false;
		this.dianji2.visible=false;
	}

	return VipPanel;
})(huiyuanfuwuUI)


//class huamao.panel.waijiao.TipsShenQing extends ui.SLGGAME.tips_tmsqUI
var TipsShenQing=(function(_super){
	function TipsShenQing(){
		this.cityPlayerData=null;
		this._type=false;
		this.mypalyerid=0;
		this.mapCityAction=null;
		TipsShenQing.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(TipsShenQing,'huamao.panel.waijiao.TipsShenQing',_super);
	var __proto=TipsShenQing.prototype;
	__proto.init=function(){
		this.btn0.on("click",this,this.juJueCB);
		this.btn1.on("click",this,this.jieShouCB);
		this.txt1.text="注意：您只能有一个同盟，本局游戏除非盟友灭亡否则无法改变盟友关系";
	}

	__proto.juJueCB=function(){
		this.close();
	}

	__proto.jieShouCB=function(){
		if(this._type){
			this.mapCityAction.sendShenQingJiaMeng(this.cityPlayerData.playerId);
			}else{
			this.mapCityAction.sendTongYiJieMeng(this.cityPlayerData.playerId);
		}
		this.close();
	}

	//type:true申请 false被申请
	__proto.resetData=function(data,type){
		this.cityPlayerData=data;
		this._type=type;
		if(type){
			this.btn0.label="取消";
			this.btn1.label="确定";
			this.txt0.text="确定向"+this.cityPlayerData.playerName+"发起同盟申请吗？";
			}else{
			this.btn0.label="拒绝";
			this.btn1.label="接受";
			this.txt0.text=this.cityPlayerData.playerName+" 想与您结盟，您接收吗？";
		}
	}

	return TipsShenQing;
})(tips_tmsqUI)


//class huamao.panel.waijiao.WaiJiaoPanel extends ui.SLGGAME.waijiaoUI
var WaiJiaoPanel=(function(_super){
	var Item;
	function WaiJiaoPanel(){
		this.list=null;
		this.dataAry=null;
		this.mapCitySession=null;
		this.mainPlayerSession=null;
		this.mapCityAction=null;
		WaiJiaoPanel.__super.call(this);
		App.injOne(this);
		this.init();
		this.initList();
		App.eventManager.event("OPEN_WAIJIAO");
	}

	__class(WaiJiaoPanel,'huamao.panel.waijiao.WaiJiaoPanel',_super);
	var __proto=WaiJiaoPanel.prototype;
	__proto.init=function(){
		this.touxiang.on("click",this,this.touXiangCB);
		this.shuoming.on("click",this,this.shuoMingCB);
	}

	__proto.touXiangCB=function(){
		if(this.mapCitySession.canTouXiang()){
			App.dialogManager.showMiniDialog(TipsTouXiang,true,true);
			}else{
			FlyUpTips.setTips("公元220年后才可以投降");
		}
	}

	__proto.shuoMingCB=function(){
		FlyLittleUpTips.setTips("与世无争：该玩家最多拥有城池数小于5座，击败他不获得官职积分\n韬光养晦：该玩家最多拥有城池数达到5座，击败他可获得2点官职积分\n厉兵秣马：该玩家最多拥有城池数达到10座，击败他可获得4点官职积分\n君临天下：该玩家最多拥有城池数达到20座，击败他可获得8点官职积分\n敌对：该玩家攻占您城池次数最多，您投降后他将获得击败您对应的官职积分\n败将：您攻占该玩家城池次数最多，他投降后您将获得击败他对应的官职积分");
	}

	__proto.initList=function(){
		this.list=new List();
		this.list.pos(17,66);
		this.list.size(920,430);
		this.list.vScrollBarSkin="";
		this.list.repeatX=1;
		this.list.repeatY=4;
		this.list.spaceX=0;
		this.list.spaceY=0;
		this.list.itemRender=Item;
		this.list.selectHandler=new Handler(this,this.onSelect);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.flushData();
		this.addChild(this.list);
	}

	__proto.flushData=function(){
		this.dataAry=this.mapCitySession.getCityPlayerList();
		this.list.array=this.dataAry;
	}

	// list.array=[1,1,1,1,1,1,1,1,1];
	__proto.onSelect=function(index){}
	// remSelectIndex=index;
	__proto.updateItem=function(cell,index){
		console.log("外交 updateItem --》");
		var datasource=cell.dataSource;
		cell.flush(datasource);
	}

	__proto.show=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.show.call(this,closeOther,showEffect);
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
	}

	WaiJiaoPanel.__init$=function(){
		//class Item extends ui.SLGGAME.waijiao_0UI
		Item=(function(_super){
			function Item(){
				this.mapCitySession=null;
				this.mapCityAction=null;
				this.mainPlayerSession=null;
				this.cityPlayerData=null;
				this.playerInfoAction=null;
				Item.__super.call(this);
				App.injOne(this);
				this.shenqing.on("click",this,this.btn0CB);
				this.touxiang.size(60,61);
				this.touxiang.on("click",this,this.viewPlayerCB);
			}
			__class(Item,'',_super);
			var __proto=Item.prototype;
			//点击头像查看玩家信息
			__proto.viewPlayerCB=function(){
				var myplayerid=this.mainPlayerSession.mainPlayerData.playerId;
				if(myplayerid==this.cityPlayerData.playerId){
					FlyUpTips.setTips("这是你自己哟，点其他玩家可查看信息");
					}else{
					this.playerInfoAction.sendViewPlayerMes(this.cityPlayerData.playerId);
				}
			}
			__proto.btn0CB=function(){
				var myplayerid=this.mainPlayerSession.mainPlayerData.playerId;
				if(myplayerid !=this.cityPlayerData.playerId){
					var data=this.mapCitySession.getCityPlayer(myplayerid);
					var My_mengyouId=data.mengyouId;
					var He_mengyouId=this.cityPlayerData.mengyouId;
					var My_S=(My_mengyouId !=0);
					var He_S=(He_mengyouId !=0);
					if(My_S && He_S){
						if(myplayerid==He_mengyouId){}
							}else if((!My_S)&& (!He_S)){
						if(this.checkIfInMyInviteList(this.cityPlayerData.playerId)){
							var tips=App.dialogManager.showMiniDialog(TipsShenQing,true,true);
							tips.resetData(this.cityPlayerData,false);
							}else{
							if(data.inviteToPlayerId==this.cityPlayerData.playerId){
								this.mapCityAction.sendQuXiaoShenQingJiaMeng(this.cityPlayerData.playerId);
								}else{
								tips=App.dialogManager.showMiniDialog(TipsShenQing,true,true);
								tips.resetData(this.cityPlayerData,true);
							}
						}
					}
				}
			}
			__proto.flush=function(datasource){
				var myid=this.mainPlayerSession.mainPlayerData.playerId;
				this.cityPlayerData=datasource;
				this.flushIcon(this.cityPlayerData.headId);
				this.flushName(this.cityPlayerData.playerName);
				this.flushLv(this.cityPlayerData.playerLv);
				this.flushGuanZhi(this.cityPlayerData.guanzhiId);
				this.flushCityNum(this.cityPlayerData.maxCityNum);
				this.flushother(this.cityPlayerData,myid);
			}
			__proto.flushLv=function(lv){
				this.dengji.text="Lv."+lv;
			}
			__proto.flushIcon=function(hearId){
				this.touxiang.skin=GameUtils.getHeadUrl(hearId);
			}
			__proto.flushName=function(playername){
				this.name0.text=playername;
			}
			__proto.flushGuanZhi=function(guanzhiId){
				var data=ConfigManager.getConfig("sys_title_player.txt",guanzhiId)
				this.guanzhi.text=data.titleName;
			}
			__proto.flushCityNum=function(citynum){
				this.cheng.text=citynum+"座";
			}
			//该玩家是否在申请加我为盟友
			__proto.checkIfInMyInviteList=function(playerid){
				var myplayerid=this.mainPlayerSession.mainPlayerData.playerId;
				var ary=this.mapCitySession.getCityPlayer(myplayerid).inviteFromPlayerList;
				for(var i=0;i<ary.length;i++){
					if(playerid==ary[i]){
						return true;
					}
				}
				return false;
			}
			//同盟信息和按键的处理
			__proto.viewSome=function(txt,btn_txt){
				if(txt==null && btn_txt !=null){
					this.txt_name.visible=false
					this.txt0.visible=false;
					this.shenqing.visible=true;
					this.shenqing.label=btn_txt;
					}else if(txt !=null && btn_txt==null){
					this.txt_name.visible=true
					this.txt0.visible=true;
					this.txt_name.text=txt;
					this.shenqing.visible=false;
					}else if(txt==null && btn_txt==null){
					this.txt_name.visible=false;
					this.txt0.visible=false;
					this.shenqing.visible=false;
				}
			}
			//敌对度处理-1隐藏
			__proto.viewDiDuiDu=function(num){
				if(num==-1){
					this.didui.visible=false;
					this.didui0.visible=false;
					}else{
					this.didui.visible=true;
					this.didui0.visible=true;
					this.didui.text=num+"";
				}
			}
			//标签显示
			__proto.viewImg=function(cityNum,ifChou,ifBai){
				this.choudi.visible=false;
				this.baijing.visible=false;
				if(cityNum==-1){
					this.img1.visible=false;
					}else{
					this.img1.visible=true;
					if(cityNum < 5){
						this.img1.skin="comp/waijiao/yushiwuzheng.png";
						}else if(cityNum >=5 && cityNum < 10){
						this.img1.skin="comp/waijiao/taoguangyanghui.png";
						}else if(cityNum >=10 &&cityNum < 20){
						this.img1.skin="comp/waijiao/libingmoma.png";
						}else if(cityNum >=20){
						this.img1.skin="comp/waijiao/junlintianxia.png";
					}
				}
				if(ifChou > 0){
					this.choudi.visible=true;
				}
				if(ifBai > 0){
					this.baijing.visible=true;
				}
			}
			__proto.flushTongMengImg=function(type){
				type ? (this.tongmeng.visible=true):(this.tongmeng.visible=false);
			}
			__proto.flushother=function(datasource,myplayerid){
				this.flushTongMengImg(false);
				if(myplayerid==datasource.playerId){
					this.viewImg(-1,-1,-1);
					this.viewDiDuiDu(-1);
					if(datasource.mengyouId !=0){
						this.viewSome(this.mapCitySession.getCityPlayer(datasource.mengyouId).playerName,null);
						}else{
						this.viewSome(null,null);
					}
					}else{
					var data=this.mapCitySession.getCityPlayer(myplayerid);
					var My_mengyouId=data.mengyouId;
					var He_mengyouId=datasource.mengyouId;
					var My_S=(My_mengyouId !=0);
					var He_S=(He_mengyouId !=0);
					if(My_S && He_S){
						if(myplayerid==He_mengyouId){
							this.viewDiDuiDu(-1)
							this.viewSome(null,"推送消息");
							this.shenqing.visible=false;
							this.shenqing.skin="comp/G/btn_green.png";
							this.viewImg(-1,-1,-1);
							this.flushTongMengImg(true);
							}else{
							this.viewSome(this.mapCitySession.getCityPlayer(datasource.mengyouId).playerName,null);
							this.viewDiDuiDu(datasource.diduidu);
							this.viewImg(datasource.maxCityNum,datasource.isChoudi,datasource.isBaijiang);
						}
						}else if(My_S && (!He_S)){
						this.viewSome(null,null);
						this.viewDiDuiDu(datasource.diduidu);
						this.viewImg(datasource.maxCityNum,datasource.isChoudi,datasource.isBaijiang);
						}else if((!My_S)&& He_S){
						this.viewSome(this.mapCitySession.getCityPlayer(datasource.mengyouId).playerName,null);
						this.viewDiDuiDu(datasource.diduidu);
						this.viewImg(datasource.maxCityNum,datasource.isChoudi,datasource.isBaijiang);
						}else if((!My_S)&& (!He_S)){
						if(this.checkIfInMyInviteList(datasource.playerId)){
							this.viewSome(null,"查看");
							this.shenqing.skin="comp/G/btn_blue.png";
							}else{
							if(data.inviteToPlayerId==datasource.playerId){
								this.viewSome(null,"取消申请");
								this.shenqing.skin="comp/G/btn_red.png";
								}else{
								this.viewSome(null,"申请同盟");
								this.shenqing.skin="comp/G/btn_green.png";
							}
						}
						this.viewDiDuiDu(datasource.diduidu);
						this.viewImg(datasource.maxCityNum,datasource.isChoudi,datasource.isBaijiang);
					}
				}
			}
			return Item;
		})(waijiao_0UI)
	}

	return WaiJiaoPanel;
})(waijiaoUI)


//class huamao.panel.worldMap.WorldMap extends ui.SLGGAME.mapUI
var WorldMap=(function(_super){
	function WorldMap(){
		this._rect=null;
		this._playerList=null;
		this.mapCitySession=null;
		this.mainPlayerSession=null;
		this._border=null;
		this._cityDic=new Object();
		WorldMap.__super.call(this);
		App.injOne(this);
		this.shou.clickHandler=new Handler(this,this.onShou);
		this.kai.clickHandler=new Handler(this,this.onKai);
		this.shou.visible=true;
		this.kai.visible=false;
		this._rect=new Rectangle(0,0,300,560);
		this.box0.scrollRect=this._rect;
		this._playerList=new PlayerList();
		this.box0.addChild(this._playerList);
		this._playerList.on("click",this,this.onClick);
		this.sousuo.clickHandler=new Handler(this,this.onSou);
		this.sou0.text="";
		this.sou0.prompt="搜索城池";
		this._border=new Border(this.box.width,this.box.height);
		this.box.addChild(this._border);
		this.box.on("click",this,this.onBorderPos);
	}

	__class(WorldMap,'huamao.panel.worldMap.WorldMap',_super);
	var __proto=WorldMap.prototype;
	__proto.onBorderPos=function(){
		var mapScaleX=GameMap.scaleWidth / this.box.width;
		var mapScaleY=GameMap.scaleHeight / this.box.height;
		var point=this.box.getMousePoint();
		App.eventManager.event("SET_POSITION",[0,point.x *mapScaleX,point.y *mapScaleY]);
		this.setGreenBorderPos(point.x,point.y);
	}

	__proto.onSou=function(){
		var data;
		var cityData;
		for(var $each_cityData in this.mapCitySession.getAllCitys()){
			cityData=this.mapCitySession.getAllCitys()[$each_cityData];
			if(cityData.sysCity.cityName==this.sou0.text){
				data=cityData;
				break ;
			}
		}
		if(data==null){
			FlyUpTips.setTips("未找到该城池");
			return;
		}
		App.eventManager.event("SET_POSITION",[data.cityId,0,0]);
		var cell=this._cityDic[data.cityId];
		this.setGreenBorderPos(cell.x,cell.y);
	}

	__proto.setGreenBorderPos=function(xx,yy){
		this._border.pos(xx,yy);
		this._border.x=Math.min(this._border.x,this.box.width-this._border.ww2 *0.5);
		this._border.y=Math.min(this._border.y,this.box.height-this._border.hh2 *0.5);
		this._border.x=Math.max(this._border.x,this._border.ww2 *0.5);
		this._border.y=Math.max(this._border.y,this._border.hh2 *0.5);
	}

	__proto.onClick=function(e){
		if((e.target instanceof huamao.panel.worldMap.PlayerItem )){
			var item=e.target;
			item && this.setBorderPos(item);
			var cell;
			for(var $each_cell in this._cityDic){
				cell=this._cityDic[$each_cell];
				cell.isSelect=cell.playerId==item.playerId;
			}
		}
	}

	__proto.setBorderPos=function(item){
		var cityId=item.data.firstCityId;
		App.eventManager.event("SET_POSITION",[cityId,0,0]);
		var cell=this._cityDic[cityId];
		this.setGreenBorderPos(cell.x,cell.y);
		this._playerList.selectItem(item);
	}

	__proto.onKai=function(){
		this.shou.visible=true;
		this.kai.visible=false;
		Tween.clearTween(this.box0);
		Tween.to(this.box0,{x:581},200);
		Tween.to(this._rect,{width:300,update:new Handler(this,this.onUpdate)},200);
	}

	__proto.onShou=function(){
		this.shou.visible=false;
		this.kai.visible=true;
		Tween.clearTween(this.box0);
		Tween.to(this.box0,{x:775},200);
		Tween.to(this._rect,{width:100,update:new Handler(this,this.onUpdate)},200);
	}

	__proto.onUpdate=function(){
		this.box0.scrollRect=this._rect;
	}

	__proto.popup=function(closeOther,showEffect){
		var _$this=this;
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.update();
		this.callLater(function(){
			var mapScaleX=GameMap.scaleWidth / _$this.box.width;
			var mapScaleY=GameMap.scaleHeight / _$this.box.height;
			_$this._border.pos(GameMap.tempX / mapScaleX,GameMap.tempY / mapScaleY);
		});
	}

	__proto.update=function(){
		this._playerList.update(this.mapCitySession.getCityPlayerList());
		this.updateCitys();
	}

	__proto.updateCitys=function(){
		var mapScaleX=GameMap.mapWidth / this.box.width;
		var mapScaleY=GameMap.mapHeight / this.box.height;
		var cityData;
		for(var $each_cityData in this.mapCitySession.getAllCitys()){
			cityData=this.mapCitySession.getAllCitys()[$each_cityData];
			var cell;
			if(this._cityDic[cityData.cityId] !=null){
				cell=this._cityDic[cityData.cityId];
			}
			else{
				cell=new MapCell();
				this._cityDic[cityData.cityId]=cell;
			}
			cell.init(cityData,mapScaleX,mapScaleY);
			if(this.mainPlayerSession.checkIfInGuide()){
				if(cityData.sysCity.cityGuide !=0){
					this.box.addChild(cell);
				}
			}
			else{
				this.box.addChild(cell);
			}
		}
	}

	__proto.addFightFire=function(cityId){
		console.log("世界地图添加战斗");
		var cell=this._cityDic[cityId];
		cell.isWar=true;
	}

	__proto.onDanger=function(){
		var action;
		for(var $each_action in this.mapCitySession.actionObj){
			action=this.mapCitySession.actionObj[$each_action];
			if(action.actionType==CityPlayerType.ENEMY){
				var cityData=this.mapCitySession.getCity(action.toId);
				if(cityData.playerId==this.mapCitySession.selfDataInfo.playerId){
					var cell=this._cityDic[cityData.cityId];
					cell.action=action;
					cell.isDangerous=true;
				}
			}
		}
	}

	return WorldMap;
})(mapUI)


//class huamao.panel.wujiang.HeroTeamDetailDialog extends ui.SLGGAME.wujiang_dl0UI
var HeroTeamDetailDialog=(function(_super){
	function HeroTeamDetailDialog(){
		this.heroTeamAction=null;
		this.wuJiangSession=null;
		this.disArr=[];
		this.teamData=null;
		this.autoEvent=null;
		this.dragSmall=null;
		this.startIndex=0;
		this.numText=["一","二","三","四","五","六","七","八","九"];
		this.sys=null;
		this.countryArr=[-1,2,1,0,3,4];
		this.nowHeroArr=[];
		this.heroBoxSmall=new HeroBoxSmall();
		this.myList=new MyList();
		HeroTeamDetailDialog.__super.call(this);
		App.injOne(this);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("TEAM_CHANGE",this,this.teamChangeFun);
		this.init();
	}

	__class(HeroTeamDetailDialog,'huamao.panel.wujiang.HeroTeamDetailDialog',_super);
	var __proto=HeroTeamDetailDialog.prototype;
	__proto.teamChangeFun=function(){
		this.close();
	}

	__proto.init=function(){
		this.qingkongduilie.clickHandler=new Handler(this,this.clearFun);
		this.baocun.clickHandler=new Handler(this,this.saveFun);
		this.quxiao.clickHandler=new Handler(this,this.cancelFun);
		this.leftBtn.clickHandler=new Handler(this,this.scrollFun,[-1]);
		this.rightBtn.clickHandler=new Handler(this,this.scrollFun,[1]);
		this.myList.contentSp.x=100;
		this.myList.itemRender=chuzhengkaUI;
		this.myList.renderHandler=new Handler(this,this.listRenderFun);
		this.addChild(this.myList);
		this.myList.pos(this.list0.x,this.list0.y+5);
		this.myList.repeatX=3;
		this.myList.spaceX=180;
		this.myList.spaceY=170;
		this.myList.setSize(this.list0.width+40 ,this.list0.height-10);
		this.myList.x-=40;
		this.list0.visible=false;
		this.list2.renderHandler=new Handler(this,this.list2RenderFun);
		this.list2.hScrollBarSkin="";
		this.updateList();
	}

	__proto.listRenderFun=function(cell,index){
		var mainUI=cell;
		var heroId=this.disArr[index];
		var heroData;
		if(heroId==0){
			mainUI.visible=false;
			return;
			}else{
			heroData=this.wuJiangSession.getHero(heroId);
			if(heroData.haveHero()==false){
				mainUI.visible=false;
				return;
			}
		};
		var small=new HeroBoxSmall();
		small.setMainUI(mainUI);
		small.setHeroData(heroData);
		mainUI.binglitiao.value=1;
		mainUI.txt0.text=heroData.soldierMax+"";
		mainUI.yuancha.clickHandler=new Handler(this,this.removeHeroFun,[heroId]);
		mainUI.on("mousedown",this,this.downFun,[mainUI]);
	}

	__proto.downFun=function(view){
		this.dragSmall=view;
		Laya.stage.once("mouseup",this,this.upFun);
		Laya.stage.once("mousemove",this,this.upFun);
		Laya.timer.once(700,this,this.timeFun);
	}

	/**
	*取消拖拽 滑动列表
	*/
	__proto.upFun=function(){
		Laya.stage.off("mouseup",this,this.upFun);
		Laya.timer.clear(this,this.timeFun);
	}

	/**
	*时间到了 开始拖拽
	*/
	__proto.timeFun=function(){
		this.upFun();
		this.myList.stopListDrag();
		this.dragSmall.scale(1.2,1.2);
		this.dragSmall.zOrder=10000;
		Laya.timer.loop(1,this,this.moveFun);
		Laya.stage.once("mouseup",this,this.dragEndFun);
		Laya.stage.once("mouseout",this,this.dragEndFun);
		this.startIndex=this.myList.getDisIndex(this.dragSmall);
	}

	__proto.moveFun=function(){
		this.dragSmall.pos(this.myList.contentSp.mouseX-this.dragSmall.width/2 ,this.myList.contentSp.mouseY-this.dragSmall.height/2);
	}

	__proto.dragEndFun=function(e){
		Laya.stage.off("mouseup",this,this.dragEndFun);
		Laya.stage.off("mouseout",this,this.dragEndFun);
		for (var j=0;j < this.myList.rectArr.length;j++){
			var rect=this.myList.rectArr [j];
			if(rect.contains(this.myList.contentSp.mouseX,this.myList.contentSp.mouseY)){
				this.swapDis(this.startIndex,j);
				this.stopMyDrag();
				return;
			}
		}
		this.back();
		this.stopMyDrag();
	}

	__proto.back=function(){
		this.fly(this.dragSmall,this.myList.rectArr[this.startIndex]);
	}

	__proto.swapDis=function(a,b){
		this.swapData(a,b);
		this.fly(this.myList.disArr[a],this.myList.rectArr[b]);
		this.fly(this.myList.disArr[b],this.myList.rectArr[a]);
		Laya.timer.once(200,this,this.flyOverFun);
	}

	__proto.flyOverFun=function(){
		this.resetList0();
	}

	__proto.fly=function(dis,rect){
		if(dis==null){
			return;
		};
		var tween=new Tween();
		tween.to(dis,{x:rect.x,y:rect.y},200);
	}

	/**
	*停止拖拽
	*/
	__proto.stopMyDrag=function(){
		this.dragSmall.scale(1,1);
		this.dragSmall.zOrder=0;
		Laya.timer.clear(this,this.moveFun);
		this.dragSmall=null;
	}

	/**
	*交换位置
	*@param a
	*@param b
	*/
	__proto.swapData=function(index1,index2){
		if(index1==index2){
			return;
		};
		var value=this.disArr[index1];
		this.disArr[index1]=this.disArr[index2];
		this.disArr[index2]=value;
	}

	/**
	*移除这个武将
	*/
	__proto.removeHeroFun=function(heroId){
		for (var i=0;i < this.disArr.length;i++){
			if(this.disArr[i]==heroId){
				this.disArr[i]=0;
			}
		}
		this.removeLast0(this.disArr);
		this.updateList();
	}

	__proto.scrollFun=function(value){
		this.list2.tweenTo(this.list2.startIndex+value *this.list2.repeatX,200);
	}

	__proto.list2RenderFun=function(cell,index){
		var kaui=cell.getChildAt(0);
		this.heroBoxSmall.setMainUI(kaui);
		kaui.yuancha.visible=false;
		var heroData=this.list2.getItem(index);
		this.heroBoxSmall.setHeroData(heroData);
		kaui.binglitiao.value=1;
		kaui.txt0.text=heroData.soldierMax+"";
		cell.on("click",this,this.clickFun,[heroData.heroId]);
	}

	/**
	*点击下面的卡牌 移到上面去
	*/
	__proto.clickFun=function(heroId){
		for (var i=0;i < this.disArr.length;i++){
			if(this.disArr[i]==0){
				this.disArr[i]=heroId;
				this.updateList();
				this.myList.scrollTo(i);
				return;
			}
		}
		if(this.disArr.length >=this.sys.queueHeroLimit){
			return;
		}
		this.disArr.push(heroId);
		this.updateList();
		this.myList.scrollTo(this.disArr.length-1);
	}

	/**
	*刷新上面列表
	*/
	__proto.resetList0=function(){
		this.myList.setArr(this.disArr);
		var titleSp=new Sprite();
		this.myList.contentSp.addChild(titleSp);
		titleSp.x=-70;
		var num=Math.ceil(this.disArr.length/3);
		for (var i=0;i < num;i++){
			var title=new wujiang_dlzUI();
			titleSp.addChild(title);
			title.txt0.text=this.numText[i];
			title.y=this.myList.spaceY *i+50;
		}
	}

	/**
	*刷新下面列表
	*/
	__proto.resetList2=function(){
		var arr=[];
		for (var i=0;i < this.nowHeroArr.length;i++){
			var heroData=this.nowHeroArr [i];
			if(this.isDis(heroData.heroId)==false){
				arr.push(heroData);
			}
		}
		this.list2.array=arr;
	}

	/**
	*是否显示在上面的列表中
	*@return
	*/
	__proto.isDis=function(disHeroId){
		for (var i=0;i < this.disArr.length;i++){
			if(disHeroId==this.disArr[i]){
				return true;
			}
		}
		return false;
	}

	__proto.clearFun=function(){
		this.disArr.length=0;
		this.updateList();
	}

	__proto.saveFun=function(){
		var dialog=App.dialogManager.showMiniDialog(TeamChangeNameDialog,true,true);
		this.removeLast0(this.disArr);
		dialog.setAll(this.teamData,this.disArr);
	}

	__proto.cancelFun=function(){
		this.close();
	}

	/**
	*更新所有列表
	*/
	__proto.updateList=function(){
		this.resetList0();
		this.resetList2();
	}

	/**
	*去除被分解过的武将
	*@return
	*/
	__proto.getDisArr=function(){
		var arr=this.teamData.heroIdArr.concat();
		for (var i=0;i < arr.length;i++){
			if(arr[i] !=0){
				var heroData=this.wuJiangSession.getHero(arr[i]);
				if(heroData.haveHero()==false){
					arr[i]=0;
				}
			}
		}
		this.removeLast0(arr);
		return arr;
	}

	/**
	*去除最后的0
	*@param arr
	*/
	__proto.removeLast0=function(arr){
		while(true){
			if(arr.length==0){
				return;
			};
			var heroId=arr[arr.length-1];
			if(heroId==0){
				arr.pop();
				}else{
				return;
			}
		}
	}

	__proto.setTeamData=function(data){
		this.teamData=data;
		this.sys=ConfigManager.getConfig("sys_hero_queue.txt",data.teamIndex);
		this.disArr=this.getDisArr();
		this.biaotiti.text=data.teamName;
		this.box0.scale(1,1);
		this.box0.labels="全部武将,魏国武将,吴国武将,蜀国武将,群雄武将";
		this.box0.selectHandler=new Handler(this,this.selectChangeFun);
		this.box0.selectedIndex=0;
		this.box0.itemSize=30;
		this.box0.list.spaceY=10;
		this.box0.list.on("display",this,this.disFun);
		this.updateList();
	}

	__proto.disFun=function(){
		this.box0.list.graphics.clear();
		this.box0.list.graphics.drawRect(0,0,this.box0.width ,225 ,"#1b1003","#1b1003");
	}

	__proto.selectChangeFun=function(index){
		this.nowHeroArr=this.wuJiangSession.getHeroByCountry(this.countryArr[index]);
		this.resetList2();
		this.list2.scrollTo(0);
	}

	HeroTeamDetailDialog.FLY_TIME=200;
	return HeroTeamDetailDialog;
})(wujiang_dl0UI)


//class huamao.panel.wujiang.HeroTeamDialog extends ui.SLGGAME.wujiang_dlUI
var HeroTeamDialog=(function(_super){
	function HeroTeamDialog(){
		this.heroTeamSession=null;
		this.wuJiangSession=null;
		this.autoEvent=null;
		HeroTeamDialog.__super.call(this);
		App.injOne(this);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("TEAM_CHANGE",this,this.changeFun);
		this.resetBtn();
	}

	__class(HeroTeamDialog,'huamao.panel.wujiang.HeroTeamDialog',_super);
	var __proto=HeroTeamDialog.prototype;
	__proto.changeFun=function(){
		this.resetBtn();
	}

	__proto.resetBtn=function(){
		var sysArr=ConfigManager.getDataArr("sys_hero_queue.txt");
		for (var i=0;i < sysArr.length;i++){
			var btn=this["btn"+(i+1)];
			var sys=sysArr [i];
			btn.label=sys.queueName;
			if(this.wuJiangSession.heroArr.length >=sys.queueHeroUnlock){
				btn.alpha=1;
				var teamData=this.heroTeamSession.getTeamByIndex(sys.queueId);
				if(teamData){
					btn.label=teamData.teamName;
				}
				btn.clickHandler=new Handler(this,this.clickFun,[sys]);
				btn.mouseEnabled=true;
				}else{
				btn.alpha=0.5;
				btn.mouseEnabled=false;
			}
		}
	}

	__proto.clickFun=function(sys){
		var dialog=App.dialogManager.showMiniDialog(HeroTeamDetailDialog);
		var data=this.heroTeamSession.getTeamByIndex(sys.queueId);
		if(data==null){
			data=new HeroTeamData();
			data.teamIndex=sys.queueId;
			data.teamName=sys.queueName;
		}
		dialog.setTeamData(data);
	}

	return HeroTeamDialog;
})(wujiang_dlUI)


//class huamao.panel.wujiangxinxi.EquipItemDialog extends ui.SLGGAME.tips_wqUI
var EquipItemDialog=(function(_super){
	function EquipItemDialog(){
		this.bagSession=null;
		this.wuJiangAction=null;
		this.map={};
		this.openData=null;
		this.heroId=0;
		EquipItemDialog.__super.call(this);
		App.injOne(this);
		this.map[1]=new OpenData(1,["空闲",EquipItemDialog.FREE,"枪",1,"刀",2,"剑",3,"扇",4]);
		this.map[2]=new OpenData(2,["空闲",EquipItemDialog.FREE,"甲",5,"袍",6]);
		this.map[3]=new OpenData(3,["空闲",EquipItemDialog.FREE,"全部",EquipItemDialog.ALL]);
		this.list0.repeatX=8;
		this.list0.repeatY=3;
		this.list0.height=205;
		this.list0.itemRender=Item;
		this.list0.renderHandler=new Handler(this,this.renderFun);
		this.tab0.selectedIndex=-1;
		this.tab0.selectHandler=new Handler(this,this.changeFun);
		this.list0.selectEnable=true;
		this.list0.selectHandler=new Handler(this,this.selectFun);
		this.btn0.clickHandler=new Handler(this,this.openShopFun);
	}

	__class(EquipItemDialog,'huamao.panel.wujiangxinxi.EquipItemDialog',_super);
	var __proto=EquipItemDialog.prototype;
	__proto.openShopFun=function(){
		this.close();
		App.dialogManager.openDialogByStr("DIALOG_SHOP");
	}

	__proto.selectFun=function(index){
		var data=this.list0.getItem(index);
		this.wuJiangAction.sendEquip(this.heroId,data.onlyId);
		this.close();
	}

	__proto.renderFun=function(cell,index){
		if(index >=this.list0.array.length){
			}else{
			var bagItemData=this.list0.getItem(index);
			var item=cell;
			item.setItemId(bagItemData.itemId);
			item.setLv(bagItemData.lv);
			item.setHeroId(bagItemData.heroId);
		}
	}

	__proto.changeFun=function(index){
		var arr=this.bagSession.getEquip(this.openData.bigType,this.openData.getType(this.tab0.selectedIndex));
		this.list0.array=arr.sort(this.bagSession.sortFun);
	}

	__proto.setType=function(type,heroId){
		this.heroId=heroId;
		this.openData=this.map[type];
		this.tab0.labels=this.openData.getLabel();
		this.tab0.selectedIndex=0;
	}

	__proto.setBagData=function(){}
	EquipItemDialog.FREE=-1;
	EquipItemDialog.ALL=-2;
	return EquipItemDialog;
})(tips_wqUI)


//class huamao.panel.wujiangxinxi.HeroArmsDialog extends ui.SLGGAME.wujiang0_3_bzdqUI
var HeroArmsDialog=(function(_super){
	function HeroArmsDialog(){
		this.iconArr=["comp/G/bz_bu.png","comp/G/bz_qi.png","comp/G/bz_gong.png","comp/G/bz_fa.png"];
		this.disType=0;
		this.btnArr=[];
		HeroArmsDialog.__super.call(this);
		this.btnArr.push(this.bu,this.qi,this.gong,this.teshu);
		this.bu.clickHandler=new Handler(this,this.changeFun,[1]);
		this.qi.clickHandler=new Handler(this,this.changeFun,[2]);
		this.gong.clickHandler=new Handler(this,this.changeFun,[3]);
		this.teshu.clickHandler=new Handler(this,this.changeFun,[4]);
		this.list0.renderHandler=new Handler(this,this.renderFun);
		this.list0.vScrollBarSkin="";
		this.changeFun(1);
		this.list0.visible=true;
		this.list0.pos(18,126);
	}

	__class(HeroArmsDialog,'huamao.panel.wujiangxinxi.HeroArmsDialog',_super);
	var __proto=HeroArmsDialog.prototype;
	__proto.changeFun=function(type){
		this.disType=type;
		var arr=ConfigManager.getDataArr("sys_force.txt");
		var disArr=[];
		for (var i=0;i < arr.length;i++){
			var sys=arr [i];
			if(sys.forceType==type){
				disArr.push(sys);
			}
		}
		this.list0.array=disArr;
		for (var j=0;j < this.btnArr.length;j++){
			(this.btnArr [j]).selected=(j==(type-1));
		}
	}

	__proto.renderFun=function(cell,index){
		if(index >=this.list0.array.length){
			cell.visible=false;
			return;
			}else{
			cell.visible=true;
		};
		var cellUI=cell.getChildAt(0);
		var sys=this.list0.getItem(index);
		cellUI.img0.skin=this.iconArr[this.disType-1];
		cellUI.name0.text=sys.forceName;
		cellUI.txt0.text=sys.forceDescription;
		cellUI.shu.text=sys.copperCost+"";
		var t=Math.floor(index%4)
		console.log("index = "+index," t = "+t);
		if(t==0 || t==1){
			cellUI.kongzhi.visible=false;
			}else{
			cellUI.kongzhi.visible=true;
		}
	}

	return HeroArmsDialog;
})(wujiang0_3_bzdqUI)


//class huamao.panel.wujiangxinxi.HeroAssess extends ui.SLGGAME.wujiang_pingjia_1UI
var HeroAssess=(function(_super){
	function HeroAssess(){
		this.autoEvent=null;
		this.wuJiangSession=null;
		this.heroid=0;
		HeroAssess.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(HeroAssess,'huamao.panel.wujiangxinxi.HeroAssess',_super);
	var __proto=HeroAssess.prototype;
	__proto.init=function(){
		HeroAssess.ifOpen=true;
		this.jin.on("click",this,this.touPiaoCB);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("ASSESS_VOTE_FLUSH",this,this.flushData);
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this);
		HeroAssess.ifOpen=false;
	}

	__proto.initText=function(lable1,label2,ary){
		lable1.text=ary[2];
		label2.text=ary[1]+"%";
	}

	__proto.flushData=function(){
		var assessData=this.wuJiangSession.assessData;
		var ary=assessData.getQuestionPer(1);
		this.initText(this.tt1,this.shu1,ary);
		ary=assessData.getQuestionPer(2);
		this.initText(this.tt2,this.shu5,ary);
		ary=assessData.getQuestionPer(3);
		this.initText(this.tt3,this.shu9,ary);
	}

	__proto.touPiaoCB=function(){
		var tips=App.dialogManager.showMiniDialog(HeroAssessDetail,true,true,false,false);
		tips.setHero(this.heroid);
	}

	__proto.setHero=function(_heroid){
		this.heroid=_heroid;
	}

	HeroAssess.ifOpen=false;
	return HeroAssess;
})(wujiang_pingjia_1UI)


//class huamao.panel.wujiangxinxi.HeroAssessDetail extends ui.SLGGAME.wujiang_pingjiaUI
var HeroAssessDetail=(function(_super){
	function HeroAssessDetail(){
		this.wuJiangAction=null;
		this.wuJiangSession=null;
		this.autoEvent=null;
		this.remOldSel1=-1;
		this.remOldSel2=-1;
		this.remOldSel3=-1;
		this.heroid=0;
		HeroAssessDetail.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(HeroAssessDetail,'huamao.panel.wujiangxinxi.HeroAssessDetail',_super);
	var __proto=HeroAssessDetail.prototype;
	__proto.init=function(){
		this.huadong.vScrollBarSkin="";
		this.jieshou.on("click",this,this.touPiaoCB);
		this.chehui.on("click",this,this.cheHuiCB);
		this.zu1.on("click",this,this.selectZui1);
		this.zu2.on("click",this,this.selectZui2);
		this.zu3.on("click",this,this.selectZui3);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("ASSESS_VOTE_FLUSH",this,this.flushData);
	}

	__proto.flushData=function(){
		var heroData=this.wuJiangSession.getHero(this.heroid);
		this.remOldSel1=this.zu1.selectedIndex=heroData.getAssessByIndex(0);
		this.remOldSel2=this.zu2.selectedIndex=heroData.getAssessByIndex(1);
		this.remOldSel3=this.zu3.selectedIndex=heroData.getAssessByIndex(2);
	}

	__proto.touPiaoCB=function(){
		this.wuJiangAction.sendTouPiao(this.heroid,this.remOldSel1,this.remOldSel2,this.remOldSel3);
	}

	__proto.cheHuiCB=function(){
		var tips=App.dialogManager.showMiniDialog(HeroAssessDetailTips,true,true,false,false);
		tips.setHandler(new Handler(this,this.cheHuiDone));
	}

	__proto.cheHuiDone=function(){
		this.wuJiangAction.sendQuXiaoTouPiao(this.heroid);
	}

	__proto.selectZui1=function(e){
		if(this.remOldSel1==this.zu1.selectedIndex){
			this.zu1.selectedIndex=-1;
		}
		this.remOldSel1=this.zu1.selectedIndex;
	}

	__proto.selectZui2=function(e){
		if(this.remOldSel2==this.zu2.selectedIndex){
			this.zu2.selectedIndex=-1;
		}
		this.remOldSel2=this.zu2.selectedIndex;
	}

	__proto.selectZui3=function(e){
		if(this.remOldSel3==this.zu3.selectedIndex){
			this.zu3.selectedIndex=-1;
		}
		this.remOldSel3=this.zu3.selectedIndex;
	}

	__proto.initQue3=function(heroid){
		var str="";
		var sysHero=ConfigManager.getConfig("sys_hero.txt",heroid);
		var strAry=sysHero.getForceNameArr();
		for(var i=0;i<strAry.length;i++){
			var name=strAry[i];
			if(str.length==0){
				str=(i+1)+"."+name;
				}else{
				str+=","+(i+1)+"."+name;
			}
		}
		this.zu3.labels=str;
	}

	__proto.setHero=function(_heroid){
		this.heroid=_heroid;
		this.initQue3(this.heroid);
		this.flushData();
	}

	return HeroAssessDetail;
})(wujiang_pingjiaUI)


//class huamao.panel.wujiangxinxi.HeroChangeSoldier extends ui.SLGGAME.wujiang_BZZZUI
var HeroChangeSoldier=(function(_super){
	function HeroChangeSoldier(){
		this.bagSession=null;
		this.armsAction=null;
		this.curHeroId=0;
		this.curForceId=0;
		HeroChangeSoldier.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(HeroChangeSoldier,'huamao.panel.wujiangxinxi.HeroChangeSoldier',_super);
	var __proto=HeroChangeSoldier.prototype;
	__proto.init=function(){
		this.quxiao.on("click",this,this.quXiaoCB);
		this.yijianzhuan.on("click",this,this.goldCB);
		this.zhuanzhi.on("click",this,this.huFuCB);
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	//元宝转职
	__proto.goldCB=function(){
		this.armsAction.sendArms(this.curHeroId,this.curForceId,0);
		this.close();
	}

	//虎符转职
	__proto.huFuCB=function(){
		this.armsAction.sendArms(this.curHeroId,this.curForceId,1);
		this.close();
	}

	//设置转职信息
	__proto.setChangeForce=function(heroid,forceid){
		this.curHeroId=heroid;
		this.curForceId=forceid;
		var sysforce=ConfigManager.getConfig("sys_force.txt",forceid);
		TheGame.lang(this.zi,"对局内转职武将兵种需要消耗{0}个虎符",sysforce.forceChange);
		this.yuanbao.text=sysforce.forceChangeGold+"";
		var hufunum=this.bagSession.getItemNumByItemId(10301);
		this.zhuan.text=hufunum+"";
	}

	return HeroChangeSoldier;
})(wujiang_BZZZUI)


//class huamao.panel.wujiangxinxi.HeroInfoTab extends ui.SLGGAME.wujiang0UI
var HeroInfoTab=(function(_super){
	function HeroInfoTab(){
		this.heroBox=null;
		this.info=null;
		this.tabBind=null;
		this.heroData=null;
		this.errorTipsAction=null;
		this.openFunctionSession=null;
		this.wuJiangAction=null;
		this.xx=NaN;
		this.yy=NaN;
		this.mc=null;
		HeroInfoTab.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(HeroInfoTab,'huamao.panel.wujiangxinxi.HeroInfoTab',_super);
	var __proto=HeroInfoTab.prototype;
	__proto.init=function(){
		var autoEvent=new AutoEvent(this);
		autoEvent.add("XUE_CANG",this,this.upDataXueCang);
		autoEvent.add("HEROLVMC",this,this.addLvMc);
		this.heroBox=new HeroBoxMax();
		this.addChild(this.heroBox);
		this.heroBox.pos(26,54);
		this.heroBox.on("click",this,this.showInfo);
		this.info=new WujiangDetailInfo();
		this.info.pos(this.heroBox.x,this.heroBox.y);
		this.info.on("mousedown",this,this.onDown);
		this.info.on("mouseup",this,this.showBase);
		var content=new Sprite();
		this.tabBind=new TabBind(this.tab0,content,0);
		this.addChild(content);
		content.pos(440,124);
		this.tabBind.addTabCell(0,HeroInfoEquipTab,HeroInfoEquipTabMediator);
		this.tabBind.addTabCell(1,HeroInfoSkillTab,HeroInfoSkillTabMediator);
		this.tabBind.addTabCell(2,HeroInfoArmsTab,HeroInfoArmsTabMediator);
		this.tabBind.addTabCell(3,HeroInfoLegionTab,HeroInfoLegionTabMediator);
		this.fenjie.on("click",this,this.xueCangCB);
		this.bingzhong.on("click",this,this.pingJiaCB);
		this.addChild(this.qian1);
		this.fenjie.pos(46,525);
		this.bingzhong.pos(236,525);
		this.resetOrder();
	}

	__proto.resetOrder=function(){
		this.heroBox.zOrder=1;
		this.fenjie.zOrder=2;
		this.bingzhong.zOrder=2;
		this.info.zOrder=3;
		this.qian1.zOrder=4;
	}

	//雪藏
	__proto.xueCangCB=function(){
		if(this.heroData.isXueCang==0){
			this.wuJiangAction.sendXueCang(this.heroData.heroId,1);
			}else{
			this.wuJiangAction.sendXueCang(this.heroData.heroId,0);
		}
	}

	__proto.upDataXueCang=function(){
		if(this.heroData.isXueCang==0){
			this.fenjie.label="雪藏";
			}else{
			this.fenjie.label="解除雪藏";
		}
	}

	//评价
	__proto.pingJiaCB=function(){
		this.wuJiangAction.sendViewPingJia(this.heroData.heroId);
	}

	//分解
	__proto.fenJieCB=function(){
		if(this.openFunctionSession.isFunction("fenjie")){
			return;
		}
		if(this.heroData.cityId==0){
			var tips=App.dialogManager.showMiniDialog(TipsWuJiangFenJie,true,true,false,false);
			tips.setHeroData(this.heroData);
			}else{
			FlyUpTips.setTips(this.errorTipsAction.arr[ErrorTipsAction.NOT_FREE]);
		}
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		FlyLittleUpTips.getinstance().close();
	}

	__proto.setHeroData=function(heroData){
		this.heroData=heroData;
		this.heroBox.setHeroData(heroData,1);
		this.info.update(heroData);
		this.upDataXueCang();
	}

	__proto.onDown=function(){
		this.xx=Laya.stage.mouseX;
		this.yy=Laya.stage.mouseY;
	}

	__proto.showBase=function(){
		if(Laya.stage.mouseX==this.xx && Laya.stage.mouseY==this.yy){
			this.info.removeSelf();
			this.addChild(this.heroBox);
			this.addChild(this.qian1);
			this.resetOrder();
		}
	}

	__proto.showInfo=function(){
		this.heroBox.removeSelf();
		this.addChild(this.info);
		this.addChild(this.qian1);
		this.resetOrder();
	}

	__proto.addLvMc=function(){
		if(this.mc){
			this.mc.offAll();
			this.mc.removeSelf();
			this.mc=null;
		}
		this.mc=new DragonBonesMc(false);
		this.mc.on("stopped",this,this.comPlay);
		this.mc.playbackRate(4);
		this.mc.playByTimes(1);
		this.mc.setUrl("res/load/LvUp.sk");
		this.addChild(this.mc);
		this.mc.zOrder=5;
		this.mc.pos(227,300);
	}

	__proto.comPlay=function(){
		App.eventManager.event("WUJIANGLVCOM");
	}

	return HeroInfoTab;
})(wujiang0UI)


//class huamao.panel.wujiangxinxi.HeroReset extends ui.SLGGAME.tips_wujiang_chongzhiUI
var HeroReset=(function(_super){
	function HeroReset(){
		this.mainPlayerSession=null;
		this.bagSession=null;
		this.heroData=null;
		this.wuJiangAction=null;
		this.backSoul=0;
		HeroReset.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(HeroReset,'huamao.panel.wujiangxinxi.HeroReset',_super);
	var __proto=HeroReset.prototype;
	__proto.init=function(){
		this.b1.on("click",this,this.buyReset);
		this.b2.on("click",this,this.souleReset);
		this.gou.on("click",this,this.checkBoxCB);
	}

	__proto.getSelect=function(){
		return (this.gou.selected ? 1 :0);
	}

	//免费或元宝重置
	__proto.buyReset=function(){
		if(this.checkIfFree()){
			this.wuJiangAction.sendReset(this.heroData.heroId,0,this.getSelect());
			this.close();
			}else{
			if(HeroResetTips.IFVIEW){
				this.close();
				var tips=App.dialogManager.showMiniDialog(HeroResetTips,true,true,true);
				var curResetCount=this.mainPlayerSession.mainPlayerData.resetCount;
				var neadgold=this.getPayNeadGold();
				tips.setData(this.heroData.heroId,this.getSelect(),curResetCount+1,neadgold,this.backSoul);
				}else{
				this.wuJiangAction.sendReset(this.heroData.heroId,0,this.getSelect());
				this.close();
			}
		}
	}

	//武魂丹重置
	__proto.souleReset=function(){
		this.wuJiangAction.sendReset(this.heroData.heroId,1,this.getSelect());
		this.close();
	}

	__proto.checkBoxCB=function(){}
	//免费重置次数
	__proto.getFreeTimes=function(){
		var job=this.mainPlayerSession.mainPlayerData.job;
		var systitleplayer=ConfigManager.getConfig("sys_title_player.txt",job);
		var freeCount=systitleplayer.titleResetHeroSoul;
		return freeCount;
	}

	//本次是否免费
	__proto.checkIfFree=function(){
		var curResetCount=this.mainPlayerSession.mainPlayerData.resetCount;
		var freeCount=this.getFreeTimes();
		if(curResetCount < freeCount){
			return true;
		}
		return false;
	}

	//如果不免费，本次需要花费多少元宝
	__proto.getPayNeadGold=function(){
		var result=0;
		var curResetCount=this.mainPlayerSession.mainPlayerData.resetCount-this.getFreeTimes();
		var times=((curResetCount+1)> 6 ? 6 :(curResetCount+1));
		var sysHeroReset=ConfigManager.getConfig("sys_hero_reset.txt" ,times);
		result=sysHeroReset.resetCost;
		return result;
	}

	__proto.setHeroData=function(hero){
		this.heroData=hero;
		var curResetCount=this.mainPlayerSession.mainPlayerData.resetCount;
		if(this.checkIfFree()){
			TheGame.lang(this.benyu,"您本月第{0}次重置,本次重置免费！",(curResetCount+1));
			this.b1.label="本次免费";
			}else{
			TheGame.lang(this.benyu,"您本月第{0}次重置,需要消耗{1}元宝",(curResetCount+1),this.getPayNeadGold());
			this.b1.label="花费元宝";
		};
		var sysHeroProgress=ConfigManager.getConfig("sys_hero_progress.txt",hero.sysHero.heroColor+"_"+hero.heroStar);
		var heroColor=GameUtils.getHeroColorName(hero.sysHero.heroColor);
		TheGame.lang(this.benyue,"该武将为{0}将,需花费{1}个武将重置丹进行重置",heroColor,sysHeroProgress.heroResetCost);
		this.backSoul=sysHeroProgress.heroResetSoul;
		this.shuzi.text=""+this.backSoul;
		this.shua.width=0;
		this.shua.text=this.bagSession.getItemNumByItemId(10201)+"";
		this.shuzia.text=""+this.backExpNum(hero.heroLv);
	}

	//当前等级返还多少经验
	__proto.backExpNum=function(lv){
		var result=0;
		for(var i=lv-1;i>0;i--){
			var t=ConfigManager.getConfig("sys_level_hero.txt",i);
			result+=t.heroExp;
		}
		return result;
	}

	return HeroReset;
})(tips_wujiang_chongzhiUI)


//class huamao.panel.wujiangxinxi.HeroUnlockSoldier extends ui.wujiang_BZJSUI
var HeroUnlockSoldier=(function(_super){
	function HeroUnlockSoldier(){
		this.bagSession=null;
		this.armsAction=null;
		this.curHeroId=0;
		this.curForceId=0;
		HeroUnlockSoldier.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(HeroUnlockSoldier,'huamao.panel.wujiangxinxi.HeroUnlockSoldier',_super);
	var __proto=HeroUnlockSoldier.prototype;
	__proto.init=function(){
		this.quxiao.on("click",this,this.quXiaoCB);
		this.yijian.on("click",this,this.goldCB);
		this.zhuanzhi.on("click",this,this.bingFuCB);
	}

	__proto.quXiaoCB=function(){
		this.close();
	}

	//元宝解锁
	__proto.goldCB=function(){
		this.armsAction.sendUnlockSoldier(this.curHeroId,this.curForceId,0);
		this.close();
	}

	//兵符解锁
	__proto.bingFuCB=function(){
		this.armsAction.sendUnlockSoldier(this.curHeroId,this.curForceId,1);
		this.close();
	}

	__proto.setForce=function(heroid,forceid){
		this.curHeroId=heroid;
		this.curForceId=forceid;
		var sysforce=ConfigManager.getConfig("sys_force.txt",forceid);
		this.yuanbao.text=sysforce.forceBookGold+"";
		this.zhuanzhifu.text=this.bagSession.getItemNumByItemId(10401)+"";
		TheGame.lang(this.zi,"您确定消耗{0}个兵书解锁该兵种吗?",sysforce.forceBook);
	}

	return HeroUnlockSoldier;
})(wujiang_BZJSUI)


//class huamao.panel.wujiangxinxi.LegionListPanel extends ui.SLGGAME.wujiang_tips_xzfjUI
var LegionListPanel=(function(_super){
	function LegionListPanel(){
		this.wuJiangSession=null;
		this.wuJiangAction=null;
		this.sysTips=null;
		this.currData=null;
		LegionListPanel.__super.call(this);
		this.init();
	}

	__class(LegionListPanel,'huamao.panel.wujiangxinxi.LegionListPanel',_super);
	var __proto=LegionListPanel.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.list0.vScrollBarSkin="";
		this.list0.itemRender=LegionSmallBox;
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.selectEnable=true;
		this.list0.selectHandler=new Handler(this,this.selectFun);
		this.list1.vScrollBarSkin="";
		this.list1.itemRender=LegionSmallBox;
		this.list1.renderHandler=new Handler(this,this.updateItem);
		this.list1.selectEnable=true;
		this.list1.selectHandler=new Handler(this,this.seleFun);
		this.list0.height=170;
		this.list0.spaceX=-15;
		this.list1.spaceX=-15;
		this.list1.spaceY=-15;
		this.sysTips=ConfigManager.getConfig("sys_tips.txt",1014);
	}

	__proto.selectFun=function(index){
		if(index==-1)return;
		if(this.list0.array[index].heroState!=0){
			FlyUpTips.setTips(this.sysTips.tipsDescribe);
			this.list0.selectedIndex=-1;
			return;
		}
		if(this.list0.array[index].masterId==0 && this.list0.array[index].legion==""){
			this.sendData(this.currData.heroId,this.list0.array[index].heroId);
		}
	}

	__proto.seleFun=function(index){
		if(index==-1)return;
		if(this.list1.array[index].heroState!=0){
			FlyUpTips.setTips(this.sysTips.tipsDescribe);
			this.list1.selectedIndex=-1;
			return;
		}
		if(this.list1.array[index].masterId==0 && this.list1.array[index].legion==""){
			this.sendData(this.currData.heroId,this.list1.array[index].heroId);
		}
	}

	__proto.sendData=function(heroId,legionId){
		if(this.wuJiangSession.getHero(legionId)){
			this.wuJiangAction.sendAddLegion(heroId,legionId);
			this.close();
		}
	}

	__proto.updateItem=function(cell,index){
		cell.setHeroData(cell.dataSource);
		cell.setVisiShanchu(this.currData);
	}

	__proto.setData=function(data){
		this.currData=data;
		var arr=this.currData.sysHero.viceHero.split(",");
		var arr1=[];
		for(var i=0;i<arr.length;i++){
			if(this.wuJiangSession.getHero(arr[i])){
				arr1.push(this.wuJiangSession.getHero(arr[i]));
			}
			else{
				var data1=new HeroData();
				data1.heroId=arr[i];
				data1.heroLv=1;
				arr1.push(data1);
			}
		}
		this.list0.array=arr1;
		var arr2=this.wuJiangSession.getHeroSnArr().concat();
		var array=[];
		for(i=0;i<arr2.length;i++){
			var cd=this.wuJiangSession.getHero(arr2[i].heroId);
			if(cd.masterId==0 && cd.legion=="" && cd.sysHero.heroColor < this.currData.sysHero.heroColor && cd.heroState==0){
				array.push(arr2[i]);
			}
		}
		this.list1.array=array;
	}

	return LegionListPanel;
})(wujiang_tips_xzfjUI)


//class huamao.panel.wujiangxinxi.ReplaceEquipDialog extends ui.SLGGAME.tips_zbUI
var ReplaceEquipDialog=(function(_super){
	function ReplaceEquipDialog(){
		this.wuJiangAction=null;
		this.bagAction=null;
		this.data=null;
		this.autoEvent=null;
		this.bagSession=null;
		ReplaceEquipDialog.__super.call(this);
		App.injOne(this);
		this.autoEvent=new AutoEvent(this);
		this.autoEvent.add("BAG_EQUIP_FLUSH",this,this.updateFun);
		this.xiexia.clickHandler=new Handler(this,this.xieZaiFun);
		this.tihuan.clickHandler=new Handler(this,this.tiHuanFun);
		this.suo.clickHandler=new Handler(this,this.lockFun);
		this.qianghua.clickHandler=new Handler(this,this.qiangHuaFun);
	}

	__class(ReplaceEquipDialog,'huamao.panel.wujiangxinxi.ReplaceEquipDialog',_super);
	var __proto=ReplaceEquipDialog.prototype;
	__proto.updateFun=function(){
		var data1=this.bagSession.getEquipByOnlyId(this.data.onlyId);
		this.setBagData(data1);
	}

	__proto.qiangHuaFun=function(){
		this.close();
		var tipsStronger=App.dialogManager.showMiniDialog(TipsStronger,true,true);
		tipsStronger.flushPanel(this.data);
	}

	__proto.lockFun=function(){
		this.bagAction.sendSuoEquip(this.data.onlyId ,((this.data.isLock==1)?0:1));
	}

	__proto.tiHuanFun=function(){
		if(this.data.lock()){
			FlyUpTips.setTips("该装备被锁住了");
			return;
		}
		this.close();
		var dialog=App.dialogManager.showMiniDialog(EquipItemDialog,true,true);
		dialog.setType(this.data.getBigType(),this.data.heroId);
	}

	__proto.xieZaiFun=function(){
		if(this.data.lock()){
			FlyUpTips.setTips("该装备被锁住了");
			return;
		}
		this.wuJiangAction.sendUnEquip(this.data.heroId,this.data.getBigType());
		this.close();
	}

	__proto.setBagData=function(data){
		this.data=data;
		var sys=data.getSysItem();
		var info="";
		if(data.lv > 0){
			info=" +"+data.lv
		}
		this.name0.text=sys.itemName+info;
		this.txt0.text=sys.itemDescription;
		var sysEquip=ConfigManager.getConfig("sys_equip.txt",data.itemId);
		var arr=sysEquip.getArr();
		var str="";
		for (var i=0;i < arr.length;i++){
			var value=arr[i];
			if(value !=0){
				arr[i]=(data.lv *0.5+1)*value;
				str+=(PropertyChangeData.arr[i]+"+"+arr[i]);
			}
		}
		this.shuxing.text=str;
		this.img0.skin=data.lock()?"comp/G/suo.png":"comp/G/suo0.png";
	}

	return ReplaceEquipDialog;
})(tips_zbUI)


//class huamao.panel.wujiangxinxi.SoulLvUpDialog extends ui.SLGGAME.tips_jjUI
var SoulLvUpDialog=(function(_super){
	function SoulLvUpDialog(){
		this.wuJiangAction=null;
		this.bagSession=null;
		this.mainPlayerSession=null;
		this.heroData=null;
		this.auto=null;
		this.head=null;
		this.leftArr=[];
		this.rightArr=[];
		this.attLeft=[];
		this.attRight=[];
		this.sys=null;
		this.laArr=["勇","御","智","威"];
		SoulLvUpDialog.__super.call(this);
		App.injOne(this);
		this.jinjie.clickHandler=new Handler(this,this.jinJieFun);
		this.auto=new AutoEvent(this);
		this.auto.add("HEROUPDATE",this,this.heroUpdateFun);
		this.leftArr.push(this.x0_1,this.x0_2,this.x0_3,this.x0_4,this.x0_5);
		this.rightArr.push(this.x1_1,this.x1_2,this.x1_3,this.x1_4,this.x1_5);
		this.attLeft.push(this.txt0_1,this.txt0_2,this.txt0_3,this.txt0_4);
		this.attRight.push(this.txt1_1,this.txt1_2,this.txt1_3,this.txt1_4);
		this.head=new HeroBox();
		this.ka.addChild(this.head);
		this.head.setEquip(false);
	}

	__class(SoulLvUpDialog,'huamao.panel.wujiangxinxi.SoulLvUpDialog',_super);
	var __proto=SoulLvUpDialog.prototype;
	__proto.heroUpdateFun=function(heroId){
		if(heroId==this.heroData.heroId){
			this.setHeroData(this.heroData);
		}
	}

	__proto.jinJieFun=function(){
		var stat=this.canLvUp();
		if(stat==1){
			FlyUpTips.setTips("已经满星");
			}else if(stat==2){
			FlyUpTips.setTips("武魂数量不足");
			}else if(stat==3){
			var heroColor=["","","蓝","紫","橙"];
			var sysTitle=ConfigManager.getConfig("sys_title_player.txt",this.sys.titleLimit);
			var color=heroColor[this.heroData.sysHero.heroColor];
			var str="官职达到"+sysTitle.titleName+"后才可将"+color+"将进阶到"+this.sys.nextStar+"星";
			FlyUpTips.setTips(str);
			}else{
			App.voiceManager.playSound("jinjie.wav");
			this.wuJiangAction.sendSoulLvUp(this.heroData.heroId);
		}
	}

	__proto.setHeroData=function(heroData){
		this.heroData=heroData;
		var key=heroData.sysHero.heroColor+"_"+heroData.heroStar;
		this.sys=ConfigManager.getConfig("sys_hero_progress.txt",key);
		this.reset();
	}

	__proto.reset=function(){
		this.head.setHeroData(this.heroData);
		this.setStar(this.leftArr,this.heroData.heroStar);
		this.setStar(this.rightArr,this.sys.nextStar);
		this.setTalent(this.sys.nextStar);
		var num=this.bagSession.getItemNumByItemId(8001);
		if(this.sys.soulCost==-1){
			this.shu0.text=num+"/----";
			}else {
			this.shu0.text=num+"/"+this.sys.soulCost;
		};
		var sysHero=this.heroData.sysHero;
		var allArr1=[this.heroData.force,this.heroData.resist,this.heroData.wisdom,this.heroData.might];
		var add1=sysHero.getGrowth(this.heroData.heroStar);
		var add2=sysHero.getGrowth(this.sys.nextStar);
		var allArr2=this.getAddAll(allArr1,add1,add2);
		this.setAttribute(this.attLeft,allArr1,add1);
		this.setAttribute(this.attRight,allArr2,add2);
		if(this.sys.nextStar==-1){
			this.xing1.visible=false;
			for(var i=0;i < this.rightArr.length;i++){
				this.rightArr[i].visible=false;
			}
			for (i=0;i < this.attRight.length;i++){
				var la=this.attRight [i];
				la.text="";
			}
		}
	}

	__proto.getAddAll=function(data,add1,add2){
		var arr=[];
		for (var i=0;i < data.length;i++){
			arr.push(data[i]+(add2[i]-add1[i])*this.heroData.heroLv);
		}
		return arr;
	}

	__proto.setAttribute=function(arr,data,addData){
		for (var i=0;i < arr.length;i++){
			var la=arr [i];
			la.text=this.laArr[i]+":"+parseInt(data[i]+"")+"(+"+TheGame.getNum(addData[i])+")";
		}
	}

	__proto.setTalent=function(star){
		if(star==-1 || this.sys.nextStar==-1){
			this.txt_n.text="";
			}else{
			var t=this.heroData.sysHero.talentArr[this.sys.nextStar-1];
			var sysT=ConfigManager.getConfig("sys_talent.txt",t.id);
			this.txt_n.text="新增属性:"+sysT.talentDescription+"+"+t.getValue();
		}
	}

	__proto.setStar=function(arr,star){
		for (var i=0;i < arr.length;i++){
			var img=arr [i];
			img.visible=i < star;
		}
	}

	__proto.canLvUp=function(){
		if(this.sys.nextStar==-1){
			return 1;
		};
		var num=this.bagSession.getItemNumByItemId(8001);
		if(this.sys.soulCost > num){
			return 2;
		}
		if(this.sys.titleLimit > this.mainPlayerSession.mainPlayerData.job){
			return 3;
		}
		return 0;
	}

	return SoulLvUpDialog;
})(tips_jjUI)


//class huamao.panel.wujiangxinxi.StudyDialog extends ui.SLGGAME.tips_bfUI
var StudyDialog=(function(_super){
	function StudyDialog(){
		this.armsAction=null;
		this.wuJiangSession=null;
		this.bagSession=null;
		//兵书 type 11
		this.heroId=0;
		this.selectForceId=0;
		StudyDialog.__super.call(this);
		App.injOne(this);
		this.lista.selectEnable=true;
		this.lista.renderHandler=new Handler(this,this.renderFun);
	}

	__class(StudyDialog,'huamao.panel.wujiangxinxi.StudyDialog',_super);
	var __proto=StudyDialog.prototype;
	/**
	*不显示已经有的兵种
	*@return
	*/
	__proto.getArr=function(){
		var heroData=this.wuJiangSession.getHero(this.heroId);
		var arr=[];
		var array=ConfigManager.getDataArr("sys_force.txt");
		for (var i=0;i < array.length;i++){
			var sys=array [i];
			if(sys.forceLevel !=3){
				continue ;
			}
			if(heroData.studyArms.indexOf(sys.forceId)!=-1){
				continue ;
			};
			var num=this.bagSession.getItemNumByItemId(sys.forceBook);
			if(num==0){
				continue ;
			};
			var studyData=new StudyData();
			studyData.forceId=sys.forceId;
			studyData.itemId=sys.forceBook;
			studyData.itemNum=num;
			arr.push(studyData);
		}
		return arr;
	}

	__proto.selectFun=function(index){
		var studyData=this.lista.array [index];
		this.selectForceId=studyData.forceId;
		var normalAlert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
		var sysHero=ConfigManager.getConfig("sys_hero.txt",this.heroId);
		normalAlert.setAll(null,"您确定要"+sysHero.heroName+"学习该兵种吗?",new Handler(this,this.enterFun));
	}

	__proto.enterFun=function(){
		this.armsAction.sendStudy(this.heroId,this.selectForceId);
		this.close();
	}

	__proto.renderFun=function(cell,index){
		if(index >=this.lista.array.length){
			cell.visible=false;
			return;
			}else{
			cell.visible=true;
		};
		var studyData=this.lista.getItem(index);
		var sys=SysItem.getDataFromItemId(studyData.itemId);
		var image=cell.getChildByName("img");
		var nameLabel=cell.getChildByName("lab");
		var numLabel=cell.getChildByName("txt");
		nameLabel.text=sys.itemName;
		numLabel.text=studyData.itemNum+"";
		image.skin=null;
		image.skin=GameUtils.getItemIconPath(studyData.itemId);
		cell.on("click",this,this.selectFun,[index]);
	}

	__proto.setHeroId=function(heroId){
		this.heroId=heroId;
		this.lista.array=this.getArr();
	}

	return StudyDialog;
})(tips_bfUI)


/**
*转职选择兵种那个界面
*@author chengxu03
*/
//class huamao.panel.wujiangxinxi.ZhuanZhiDialog extends ui.SLGGAME.wujiang0_3_zzUI
var ZhuanZhiDialog=(function(_super){
	function ZhuanZhiDialog(){
		this.wuJiangSession=null;
		this.bagSession=null;
		this.armsAction=null;
		this.auto=null;
		this.heroId=0;
		this.forceId=0;
		ZhuanZhiDialog.__super.call(this);
		App.injOne(this);
		this.auto=new AutoEvent(this);
		this.list0.renderHandler=new Handler(this,this.renderFun);
		this.auto.add("ZHUAN_ZHI_SUCCESS",this,this.zhuanZhiSuccessFun);
		this.auto.add("STUDY_SUCCESS",this,this.studySuccessFun);
		this.xuexi.clickHandler=new Handler(this,this.studyFun);
	}

	__class(ZhuanZhiDialog,'huamao.panel.wujiangxinxi.ZhuanZhiDialog',_super);
	var __proto=ZhuanZhiDialog.prototype;
	/**学习成功 刷新列表 */
	__proto.studySuccessFun=function(){
		this.setHeroId(this.heroId);
	}

	__proto.studyFun=function(){
		var studyDialog=App.dialogManager.showMiniDialog(StudyDialog,true,true);
		studyDialog.setHeroId(this.heroId);
	}

	/**转职成功 关闭窗口 */
	__proto.zhuanZhiSuccessFun=function(){
		this.close();
	}

	__proto.renderFun=function(cell,index){
		if(index >=this.list0.array.length){
			cell.visible=false;
			return;
			}else{
			cell.visible=true;
		};
		var cellUI=cell.getChildAt(0);
		var forceId=this.list0.getItem(index);
		var sys=ConfigManager.getConfig("sys_force.txt",forceId);
		cellUI.name0.text=sys.forceName;
		cellUI.txt0.text=sys.forceDescription;
		cellUI.shu0.text=sys.copperCost+"";
		cellUI.txt_0.color=this.itemEnough(forceId)?"#1c1105":"#ff0000";
		cellUI.txt_0.text=sys.forceChange+"/"+this.bagSession.getItemNumByItemId(10301);
		cellUI.btn0.clickHandler=new Handler(this,this.btnFun,[forceId]);
		var heroData=this.wuJiangSession.getHero(this.heroId);
		cellUI.btn0.disabled=(heroData.soldierType==forceId);
	}

	__proto.btnFun=function(forceId){
		this.forceId=forceId;
		var heroData=this.wuJiangSession.getHero(this.heroId);
		if(heroData.soldier > 0){
			FlyUpTips.setTips("请先解散武将带兵才可以转职兵种喔！");
			return;
		};
		var sys=ConfigManager.getConfig("sys_title_player.txt",1003);
		if(heroData.heroLv < (sys.titleMaxLordLv+1)){
			FlyUpTips.setTips("武将等级必须达到"+(sys.titleMaxLordLv+1));
			return;
		}
		if(this.itemEnough(forceId)==false){
			FlyUpTips.setTips("转职书不够!");
			return;
		};
		var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true);
		alert.setAll("t_zz.png","您要使用转职书更换武将的兵种吗?",new Handler(this,this.zhuanZhiFun));
	}

	__proto.zhuanZhiFun=function(){}
	/**
	*物品足够不
	*@param forceId
	*@return
	*/
	__proto.itemEnough=function(forceId){
		var sys=ConfigManager.getConfig("sys_force.txt",forceId);
		var have=this.bagSession.getItemNumByItemId(10301);
		return have >=sys.forceChange;
	}

	__proto.setHeroId=function(heroId){
		this.heroId=heroId;
		var sys=ConfigManager.getConfig("sys_hero.txt",heroId);
		var arr=sys.forceArr.concat();
		arr.shift();
		var heroData=this.wuJiangSession.getHero(heroId);
		arr=arr.concat(heroData.studyArms);
		this.list0.array=arr;
	}

	return ZhuanZhiDialog;
})(wujiang0_3_zzUI)


//class huamao.panel.xiangou.XianGouPanel extends ui.SLGGAME.xiangouUI
var XianGouPanel=(function(_super){
	function XianGouPanel(){
		this.activitySession=null;
		this.activityAction=null;
		this.currData=null;
		this.xiangouTime=0;
		XianGouPanel.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(XianGouPanel,'huamao.panel.xiangou.XianGouPanel',_super);
	var __proto=XianGouPanel.prototype;
	__proto.init=function(){
		this.on("undisplay",this,this.clearFun);
		this.upData();
		if(this.currData){
			var icon=new Item();
			this.di.addChild(icon);
			icon.pos(2,2);
			icon.size(75,75);
			icon.setItemId(this.currData.getSysData().activityReward.split(",")[0]);
			icon.setNum(this.currData.getSysData().activityReward.split(",")[1]);
			var sysitem=ConfigManager.getConfig("sys_item.txt",this.currData.getSysData().activityReward.split(",")[0]);
			this.txt1.text=sysitem.itemName;
		}
		this.btn0.on("click",this,this.clickFun);
		this.xiangouTime=this.currData.endTime-GameUtils.GetServerTime();
		if(this.xiangouTime>0){
			Laya.timer.loop(1000,this,this.timeFun);
			this.timeFun();
		}
		else{
			this.time.text="00:00:00";
		}
	}

	__proto.clearFun=function(){
		Laya.timer.callLater(this,this.destroy);
	}

	__proto.timeFun=function(){
		this.xiangouTime=this.currData.endTime-GameUtils.GetServerTime();
		if(this.xiangouTime<=0){
			Laya.timer.clear(this,this.timeFun);
		}
		this.time.text=GameUtils.time(this.xiangouTime,5);
	}

	__proto.upData=function(){
		this.yilingqu.visible=false;
		this.btn0.visible=true;
		this.currData=this.activitySession.getTypeActivity(6);
		if(this.currData.rewardStatus==0){
			this.btn0.label="去充值";
			}else if(this.currData.rewardStatus==1){
			this.btn0.label="领取奖励";
			}else if(this.currData.rewardStatus==2){
			this.btn0.label="已领取";
			this.btn0.visible=false;
			this.zhuan1.visible=false;
			this.zhuan1.stop();
			this.yilingqu.visible=true;
		}
	}

	__proto.clickFun=function(){
		if(this.currData.rewardStatus==0){
			App.dialogManager.openDialogByStr("RECHARGEPANEL",null,true,true);
			}else if(this.currData.rewardStatus==1){
			this.activityAction.sendLingQu(this.currData.activityId);
		}
	}

	return XianGouPanel;
})(xiangouUI)


//class huamao.panel.xingjunList.XingjunList extends ui.SLGGAME.map_xjlbUI
var XingjunList=(function(_super){
	function XingjunList(){
		this.list=null;
		this.mapCitySession=null;
		this.mapCityAction=null;
		XingjunList.__super.call(this);
		App.injOne(this);
		this.list=new List();
		this.list.itemRender=XingjunListItem;
		this.list.repeatX=3;
		this.list.repeatY=1;
		this.list.spaceX=-2;
		this.list.pos(75,55);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.hScrollBarSkin="";
		this.addChild(this.list);
		this.xiangzuo.on("click",this,this.leftCB);
		this.xiangyou.on("click",this,this.rightCB);
	}

	__class(XingjunList,'huamao.panel.xingjunList.XingjunList',_super);
	var __proto=XingjunList.prototype;
	__proto.leftCB=function(){
		if(this.list.startIndex > 0){
			this.list.scrollTo(this.list.startIndex-1);
		}
	}

	__proto.rightCB=function(){
		if(this.list.startIndex < this.list.length){
			this.list.scrollTo(this.list.startIndex+1);
		}
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	__proto.update=function(){
		this.list.array=this.updateBattleData();
	}

	__proto.updateBattleData=function(){var battleList=[];
		var finalList=[];
		var dataList=this.mapCitySession.getActionList();
		for (var i=0;i < dataList.length;i++){
			if(dataList[i].battleId>0){
				battleList.push(dataList[i]);
				}else{
				finalList.push(dataList[i]);
			}
		}
		return battleList.concat(finalList);
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this.update();
	}

	__proto.close=function(type,showEffect){
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.close.call(this,type,showEffect);
		var item;
		for(var $each_item in this.list.cells){
			item=this.list.cells[$each_item];
			item.clear();
		}
	}

	return XingjunList;
})(map_xjlbUI)


//class huamao.panel.zhanbao.fenxiang.FenxiangPanel extends ui.tips_fenxiangUI
var FenxiangPanel=(function(_super){
	var FenxiangItem;
	function FenxiangPanel(){
		this.shouFenAction=null;
		this.shouFenSession=null;
		this.friendSession=null;
		this.list=null;
		this._pindaoObj=null;
		this.pindaoArr=[];
		this.friendArr=[];
		this._battleUrl=null;
		FenxiangPanel.__super.call(this);
		App.injOne(this);
		this.dangqian.clickHandler=new Handler(this,this.onClick,[this.dangqian,1]);
		this.shijie.clickHandler=new Handler(this,this.onClick,[this.shijie,2]);
		this.guojia.clickHandler=new Handler(this,this.onClick,[this.guojia,3]);
		this.xuepai.clickHandler=new Handler(this,this.onClick,[this.xuepai,5]);
		this.quxiao.clickHandler=new Handler(this,this.onHandler,[0]);
		this.queding.clickHandler=new Handler(this,this.onHandler,[1]);
		this.list=new List();
		this.list.itemRender=FenxiangItem;
		this.addChild(this.list);
		this.list.pos(16,176);
		this.list.repeatX=2;
		this.list.repeatY=7;
		this.list.spaceY=2;
		this.list.vScrollBarSkin="";
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.addChild(this.list);
	}

	__class(FenxiangPanel,'huamao.panel.zhanbao.fenxiang.FenxiangPanel',_super);
	var __proto=FenxiangPanel.prototype;
	__proto.onHandler=function(type){
		if(type==1){
			this.pindaoArr.length=this.friendArr.length=0;
			var pindao;
			for(var $each_pindao in this._pindaoObj){
				pindao=this._pindaoObj[$each_pindao];
				this.pindaoArr.push(pindao);
			}
			var item;
			for(var $each_item in this.list.cells){
				item=this.list.cells[$each_item];
				if(item.selectId !=-1){
					this.friendArr.push(item.selectId);
				}
			}
			this.shouFenAction.sendFenxiang(this._battleUrl,this.pindaoArr,this.friendArr);
		}
		this.close();
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	__proto.onClick=function(checkBox,pindao){
		if(checkBox.selected){
			this._pindaoObj[pindao]=pindao;
		}
		else{
			delete this._pindaoObj[pindao];
		}
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this._battleUrl=this.tag.battleId;
		this.list.array=this.friendSession.getList(1);
		this._pindaoObj=new Object();
	}

	FenxiangPanel.__init$=function(){
		//class FenxiangItem extends ui.tips_fenxiang_0UI
		FenxiangItem=(function(_super){
			function FenxiangItem(){
				this.friendData=null;
				FenxiangItem.__super.call(this);
				this.wanjiajia.clickHandler=new Handler(this,this.onClick);
			}
			__class(FenxiangItem,'',_super);
			var __proto=FenxiangItem.prototype;
			__proto.onClick=function(){}
			// TODO Auto Generated method stub
			__proto.update=function(data){
				this.friendData=data;
				this.wanjia.text=this.friendData.friendName;
			}
			__getset(0,__proto,'selectId',function(){
				return this.wanjiajia.selected ? this.friendData.friendId :-1;
			});
			return FenxiangItem;
		})(tips_fenxiang_0UI)
	}

	return FenxiangPanel;
})(tips_fenxiangUI)


//class huamao.panel.zhanbao.Shoucang.ShoucangPanel extends ui.zhanbao_shoucangUI
var ShoucangPanel=(function(_super){
	var ShoucangItem;
	function ShoucangPanel(){
		this._itemList=[];
		this._curPage=0;
		this._maxPage=0;
		this.shouFenSession=null;
		this.curNum=4;
		this.panel=null;
		this._dataList=null;
		ShoucangPanel.__super.call(this);
		App.injOne(this);
		this.panel=new Panel();
		this.addChild(this.panel);
		this.panel.pos(15,63);
		this.panel.size(892,452);
		this.panel.vScrollBarSkin="";
		for(var i=0;i < this.curNum;i++){
			var item=new ShoucangItem();
			item.pos(0,i *128);
			this.panel.addChild(item);
			this._itemList.push(item);
		}
		this.zuo.clickHandler=new Handler(this,this.onPage,[0]);
		this.you.clickHandler=new Handler(this,this.onPage,[1]);
	}

	__class(ShoucangPanel,'huamao.panel.zhanbao.Shoucang.ShoucangPanel',_super);
	var __proto=ShoucangPanel.prototype;
	__proto.onPage=function(type){
		if(type==0){
			if(this._curPage > 1){
				this._curPage--;
			}
		}
		else if(type==1){
			if(this._curPage < this._maxPage){
				this._curPage++;
			}
		}
		this.gotoPage();
	}

	__proto.gotoPage=function(){
		var size=this._itemList.length;
		var totle=this._dataList.length;
		for(var i=0;i < size;i++){
			var item=this._itemList[i];
			item.removeSelf();
			var index=(this._curPage-1)*this.curNum+i;
			if(index < totle){
				this.panel.addChild(item);
				item.update(this._dataList[index]);
			}
		}
		this.yema.text=this._curPage+"/"+this._maxPage;
	}

	__proto.update=function(){
		this._dataList=this.shouFenSession.getDataList();
		this._maxPage=Math.ceil(this._dataList.length / this.curNum);
		this._maxPage=Math.max(1,this._maxPage);
		this._curPage=Math.min(this._curPage,this._maxPage);
		this.gotoPage();
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		this._curPage=1;
		this.update();
	}

	ShoucangPanel.__init$=function(){
		//class ShoucangItem extends ui.zhanbao_shoucang01UI
		ShoucangItem=(function(_super){
			function ShoucangItem(){
				this.curData=null;
				ShoucangItem.__super.call(this);
				this.on("click",this,this.onClick);
			}
			__class(ShoucangItem,'',_super);
			var __proto=ShoucangItem.prototype;
			__proto.onClick=function(){
				App.dialogManager.openDialogByStr("SHOUCANG_INFO",{data:this.curData},true,true);
			}
			__proto.update=function(data){
				this.curData=data;
				this.shijian.text=GameUtils.timeFormat(data.dateTime);
				this.shengbai.skin=data.result==0 ? "comp/G/img_sl.png" :"comp/G/img_sb.png";
				if(data.type==1){
					this.jin.skin=data.battleType==0 ? "comp/zhanbaolb/zb_0.png" :"comp/zhanbaolb/zb_1.png";
					var sysCity=ConfigManager.getConfig("sys_city.txt",data.cityId);
					this.wanjia.text=data.attackName;
					this.difang.text=(data.defenseName=="" ? sysCity.cityName :data.defenseName)+"守军";
					this.zhanbao.text="普通战区战报";
				}
				else if(data.type==0){
					this.jin.skin=data.battleType==0 ? "comp/zhanbaolb/zb_0.png" :"comp/zhanbaolb/zb_1.png";
					this.wanjia.text=data.battleType==0 ? data.defenseName :data.attackName;
					this.difang.text=""+(data.battleType==0 ? data.attackLoseBingli :data.defenseLoseBingli);
					this.zhanbao.text="好友挑战战报";
				}
			}
			return ShoucangItem;
		})(zhanbao_shoucang01UI)
	}

	return ShoucangPanel;
})(zhanbao_shoucangUI)


//class huamao.panel.zhanbao.tongji.TongjiPanel extends ui.SLGGAME.zhanbao_zdtjUI
var TongjiPanel=(function(_super){
	function TongjiPanel(){
		this.list0=null;
		this.list1=null;
		this.mvpId=0;
		this.mvpId1=0;
		TongjiPanel.__super.call(this);
		this.list0=new List();
		this.list0.itemRender=TongjiItem;
		this.addChild(this.list0);
		this.list0.pos(15,130);
		this.list0.height=510;
		this.list0.repeatX=1;
		this.list0.repeatY=3;
		this.list0.spaceY=3;
		this.list0.vScrollBarSkin="";
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list1=new List();
		this.list1.itemRender=TongjiItem;
		this.addChild(this.list1);
		this.list1.pos(465,130);
		this.list1.height=510;
		this.list1.repeatX=1;
		this.list1.repeatY=3;
		this.list1.spaceY=3;
		this.list1.vScrollBarSkin="";
		this.list1.renderHandler=new Handler(this,this.updateItem1);
	}

	__class(TongjiPanel,'huamao.panel.zhanbao.tongji.TongjiPanel',_super);
	var __proto=TongjiPanel.prototype;
	__proto.updateItem=function(item,index){
		item.update(item.dataSource,this.mvpId);
	}

	__proto.updateItem1=function(item,index){
		item.update(item.dataSource,this.mvpId1);
	}

	__proto.update=function(battleData){
		this.img0.skin=battleData.nowCell.defMaxHp==battleData.nowCell.defDamageHp ? "comp/G/img_sl.png" :"comp/G/img_sb.png";
		this.box0.labels=battleData.nowCell.atkName;
		this.box0.selectedIndex=0;
		var sysCity=ConfigManager.getConfig("sys_city.txt",battleData.nowCell.citiId);
		this.box1.labels=battleData.nowCell.defName=="" ? sysCity.cityName+"守军" :battleData.nowCell.defName;
		this.box1.selectedIndex=0;
		this.mvpId=this.getMvpId(battleData.nowCell.atkStatArr);
		this.mvpId1=this.getMvpId(battleData.nowCell.defStatArr);
		console.log("两个mvp",this.mvpId,this.mvpId1);
		this.list0.array=battleData.nowCell.atkStatArr;
		this.list1.array=battleData.nowCell.defStatArr;
	}

	__proto.getMvpId=function(list){
		var arr=[];
		var data;
		for(var $each_data in list){
			data=list[$each_data];
			arr.push(data);
		}
		arr.sort(function(a,b){
			return b.damage+b.cure-a.damage-a.cure;
		});
		return arr.length > 0 ? arr[0].heroId :0;
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
		var battleId=this.tag.battleId;
		App.eventManager.event("BATTLE_INFO",battleId+"");
	}

	return TongjiPanel;
})(zhanbao_zdtjUI)


//class huamao.panel.zhaomu.mjl.BingZhongPanel extends ui.SLGGAME.tips_bzUI
var BingZhongPanel=(function(_super){
	function BingZhongPanel(){
		this.forceArr=[];
		BingZhongPanel.__super.call(this);
		this.init();
	}

	__class(BingZhongPanel,'huamao.panel.zhaomu.mjl.BingZhongPanel',_super);
	var __proto=BingZhongPanel.prototype;
	__proto.init=function(){
		this.list0.renderHandler=new Handler(this,this.updateItem);
	}

	__proto.updateItem=function(cell,index){
		var sysForce=ConfigManager.getConfig("sys_force.txt",this.forceArr[index]);
		var cellUI=cell.getChildAt(0);
		cellUI.name0.text=sysForce.forceName;
		cellUI.img0.skin=GameUtils.getBingZhong(sysForce.forceType);
		cellUI.txt2.text=sysForce.copperCost+"";
		cellUI.txt0.text=sysForce.forceDescription;
	}

	__proto.setData=function(id){
		var sysHero=ConfigManager.getConfig("sys_hero.txt",id);
		this.forceArr=sysHero.heroForce.split(",");
		if(this.forceArr.length>this.list0.repeatY){
			this.list0.vScrollBarSkin="";
		}
		this.list0.array=this.forceArr;
	}

	return BingZhongPanel;
})(tips_bzUI)


//class huamao.panel.zhaomu.mjl.HeChengPanel extends ui.SLGGAME.zhaomu_mjhcUI
var HeChengPanel=(function(_super){
	function HeChengPanel(){
		this.wuJiangSession=null;
		this.zhaoMuSession=null;
		this.wuJiangAction=null;
		this.bagSession=null;
		this.autoEvent=null;
		HeChengPanel.__super.call(this);
		this.init();
	}

	__class(HeChengPanel,'huamao.panel.zhaomu.mjl.HeChengPanel',_super);
	var __proto=HeChengPanel.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.autoEvent=new AutoEvent(this);
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.vScrollBarSkin="";
		this.autoEvent.add("HEROUPDATE",this,this.UpDate);
		this.autoEvent.add("BAG_ITEM_FLUSH",this,this.initPanel);
		this.autoEvent.addEventNow();
		this.UpDate();
		this.initPanel();
	}

	__proto.UpDate=function(){
		var arr=this.wuJiangSession.getHecheng();
		this.wu.visible=arr.length>0 ? false :true;
		this.list0.array=arr;
	}

	__proto.initPanel=function(){
		this.hun.text=this.bagSession.getItemNumByItemId(8001)+"";
	}

	__proto.updateItem=function(cell,index){
		var sysHero=ConfigManager.getConfig("sys_hero.txt",this.list0.array[index].heroId);
		var cellUI=cell.getChildByName("ka");
		cellUI.yiyongyou.visible=false;
		var sysHeroProgress=ConfigManager.getConfig("sys_hero_progress.txt",sysHero.heroColor+"_"+0);
		cellUI.wuhun.visible=true;
		cellUI.hun1.text=sysHeroProgress.heroCompose+"";
		cellUI.dengji.text="1";
		cellUI.name0.text=sysHero.heroName;
		cellUI.tiao.skin=GameUtils.getZiDi(sysHero.heroColor);
		GameUtils.getKaKuang(cellUI.wk,sysHero.heroColor);
		cellUI.di.skin=GameUtils.getDi(sysHero.heroColor);
		cellUI.img0.skin=GameUtils.getCountry(sysHero.heroCountry);
		cellUI.box.skin=GameUtils.getHeroSkin(sysHero.heroId);
		cellUI.yong.text=sysHero.heroCourage+"";
		cellUI.yu.text=sysHero.heroDef+"";
		cellUI.zhi.text=sysHero.heroInt+"";
		cellUI.wei.text=sysHero.heroPrestige+"";
		cellUI.chengzhangshu.text=sysHero.heroPoint+"";
		cellUI.on("click",this,this.clickFun,[sysHero.heroId]);
		var btn=cell.getChildByName("hecheng");
		btn.on("click",this,this.onClick,[sysHero.heroId,sysHeroProgress.heroCompose]);
	}

	__proto.clickFun=function(id){
		App.dialogManager.openDialogByStr("MJLSHUOMING",{heroId:id});
	}

	__proto.onClick=function(id,num){
		if(this.bagSession.getItemNumByItemId(8001)>=num){
			var alert=App.dialogManager.showMiniDialog(NormalAlert,true,true,false,false);
			alert.setAll("合成","确定用"+num+"武魂合成武将吗？",new Handler(this,this.heCheng,[id]));
		}
		else{
			FlyUpTips.setTips("武魂数量不足");
		}
	}

	__proto.heCheng=function(id){
		this.wuJiangAction.sendHeCheng(id);
	}

	return HeChengPanel;
})(zhaomu_mjhcUI)


//class huamao.panel.zhaomu.mjl.MjlPanel extends ui.SLGGAME.zhaomu_mjlUI
var MjlPanel=(function(_super){
	function MjlPanel(){
		this.zhaoMuSession=null;
		this.wuJiangSession=null;
		this.numObj=null;
		this.currArr=[];
		this.max=0;
		MjlPanel.__super.call(this);
		this.init();
	}

	__class(MjlPanel,'huamao.panel.zhaomu.mjl.MjlPanel',_super);
	var __proto=MjlPanel.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.vScrollBarSkin="";
		this.list0.selectEnable=true;
		this.zhaoMuSession.mjlData={};
		this.numObj={};
		var arr=ConfigManager.getDataArr("sys_hero.txt");
		for(var i=0;i<arr.length;i++){
			var hero=arr[i];
			if(!this.zhaoMuSession.mjlData[hero.heroCountry]){
				this.zhaoMuSession.mjlData[hero.heroCountry]=[];
			}
			if(hero.heroSn!=0)this.zhaoMuSession.mjlData[hero.heroCountry].push(hero);
			if(!this.numObj[hero.heroCountry]){
				this.numObj[hero.heroCountry]=0;
			}
			if(this.wuJiangSession.getHero(hero.heroId)){
				this.numObj[hero.heroCountry]++;
			}
		}
		this.tab0.on("change",this,this.onTab);
		this.tab0.selectedIndex=0;
	}

	__proto.clickFun=function(index){
		var sysHero=this.currArr[index];
		App.dialogManager.openDialogByStr("MJLSHUOMING",{heroId:sysHero.heroId});
	}

	__proto.updateItem=function(cell,index){
		var sysHero=this.currArr[index];
		var cellUI=cell.getChildAt(0);
		cellUI.dengji.text="1";
		cellUI.name0.text=sysHero.heroName;
		GameUtils.getKaKuang(cellUI.wk,sysHero.heroColor);
		cellUI.di.skin=GameUtils.getDi(sysHero.heroColor);
		cellUI.img0.skin=GameUtils.getCountry(sysHero.heroCountry);
		cellUI.box.skin=GameUtils.getHeroSkin(sysHero.heroId);
		cellUI.tiao.skin=GameUtils.getZiDi(sysHero.heroColor);
		cell.on("click",this,this.clickFun,[index]);
		var herodata=this.wuJiangSession.getHero(sysHero.heroId);
		if(herodata && herodata.haveHero()){
			cellUI.yiyongyou.visible=true;
			cellUI.weiyongyou.visible=false;
			var openWarDate=new Date();
			openWarDate.setTime(herodata.heroTime *1000);
			cellUI.huodeshijian.text=openWarDate.getFullYear()+"-"+(openWarDate.getMonth()+1)+"-"+openWarDate.getDate()+"获";
		}
		else{
			cellUI.yong.text=sysHero.heroCourage+"";
			cellUI.yu.text=sysHero.heroDef+"";
			cellUI.zhi.text=sysHero.heroInt+"";
			cellUI.wei.text=sysHero.heroPrestige+"";
			cellUI.chengzhangshu.text=sysHero.heroPoint+"";
			cellUI.weiyongyou.visible=true;
			cellUI.yiyongyou.visible=false;
		}
	}

	__proto.onTab=function(){
		this.currArr=this.zhaoMuSession.mjlData[this.tab0.selectedIndex];
		this.max=this.currArr.length;
		this.currArr.sort(this.sortColorSn);
		this.list0.array=this.currArr;
		this.shu.text=this.numObj[this.tab0.selectedIndex]+"/"+this.max;
	}

	__proto.sortColorSn=function(a,b){
		if(b.heroColor !=a.heroColor){
			return b.heroColor-a.heroColor;
		}
		else{
			return a.heroId-b.heroId;
		}
	}

	return MjlPanel;
})(zhaomu_mjlUI)


//class huamao.panel.zhaomu.mjl.MjlXinxiPanel extends ui.SLGGAME.zhaomu_mjl_wjUI
var MjlXinxiPanel=(function(_super){
	function MjlXinxiPanel(){
		this.spStat=null;
		this.sysHero=null;
		MjlXinxiPanel.__super.call(this);
		this.init();
	}

	__class(MjlXinxiPanel,'huamao.panel.zhaomu.mjl.MjlXinxiPanel',_super);
	var __proto=MjlXinxiPanel.prototype;
	__proto.init=function(){
		this.spStat=new SpStat();
		this.spStat.setButton(this.huo.skin,2);
		this.addChild(this.spStat);
		this.spStat.pos(740,70);
		this.huo.visible=false;
		this.tex1.text="";
		this.tex3.text="";
	}

	__proto.setData=function(id){
		this.sysHero=ConfigManager.getConfig("sys_hero.txt",id);
		this.dengji.text="1";
		this.name0.text=this.sysHero.heroName;
		GameUtils.getKaKuang(this.wk,this.sysHero.heroColor);
		this.d0.skin=GameUtils.getDi(this.sysHero.heroColor);
		this.img0.skin=GameUtils.getCountry(this.sysHero.heroCountry);
		this.box0.skin=GameUtils.getHeroSkin(this.sysHero.heroId);
		this.yong.text=this.sysHero.heroCourage+"";
		this.yu.text=this.sysHero.heroDef+"";
		this.zhi.text=this.sysHero.heroInt+"";
		this.wei.text=this.sysHero.heroPrestige+"";
		this.czz.text=this.sysHero.heroPoint+"";
	}

	__proto.tianfu=function(){
		var index=0;
		for(var i=1;i <=this.sysHero.talentArr.length;i++){
			var t=this.sysHero.talentArr[i-1];
			var label=new HTMLDivElement();
			label.color="#ffffff";
			label.width=280;
			label.height=24;
			var sysTalent=ConfigManager.getConfig("sys_talent.txt",t.id);
			label.innerHTML=this.getHtml("<font color='#7280a5'>"+sysTalent.talentName+":</font>    <font color='#7f8b96'>"+sysTalent.talentDescription+"</font><font color='#4bd438'>+"+t.getValue()+"</font>");
			this.addChild(label);
			var xx=parseInt((index%2)+"");
			var yy=parseInt((index/2)+"");
			label.x=xx*(240)+386;
			label.y=yy*(30)+274;
			index++;
		}
	}

	__proto.getHtml=function(str,color){
		(color===void 0)&& (color="#f3942a");
		return TheGame.FONT(str,color,24,"Microsoft YaHei");
	}

	__proto.setSkill=function(skillId,str){
		var sys=ConfigManager.getConfig("sys_skill.txt",skillId);
		this.mingzi.text=sys.skillName;
		this.tex1.innerHTML=str;
		this.spStat.setBtnMax(30,sys.skillRage);
		this.spStat.setBtnNow(sys.skillRage);
	}

	__proto.setMix=function(arr){
		var str="";
		for (var i=0;i < arr.length;i++){
			str+=(arr[i]+"<br>");
		}
		this.tex3.innerHTML=str;
	}

	return MjlXinxiPanel;
})(zhaomu_mjl_wjUI)


//class huamao.panel.zhaomu.mjl.TuijianWujiang extends ui.SLGGAME.tips_tjfjUI
var TuijianWujiang=(function(_super){
	function TuijianWujiang(){
		this.heroArr=[];
		this.strHero="";
		TuijianWujiang.__super.call(this);
		this.init();
	}

	__class(TuijianWujiang,'huamao.panel.zhaomu.mjl.TuijianWujiang',_super);
	var __proto=TuijianWujiang.prototype;
	__proto.init=function(){
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.list0.hScrollBarSkin="";
	}

	/**
	*
	*@param id
	*@param type 0推荐 副将 1 推荐主将
	*
	*/
	__proto.setData=function(id,type){
		(type===void 0)&& (type=0);
		var sysHero=ConfigManager.getConfig("sys_hero.txt",id);
		if(type==0){
			this.strHero=sysHero.viceHero;
			this.fj.text="comp/G/t_tjfj.png";
		}
		else{
			this.strHero=sysHero.mainHero;
			this.fj.text="comp/G/t_tjzj.png";
		}
		if(this.strHero!=""){
			this.heroArr=this.strHero.split(",");
			this.list0.array=this.heroArr;
		}
		else{
			this.list0.array=[];
		}
	}

	__proto.updateItem=function(cell,index){
		var cellUI=cell.getChildAt(0);
		cellUI.xing.visible=false;
		cellUI.xue.visible=false;
		cellUI.yuancha.visible=false;
		cellUI.box.removeChildren();
		var sysHero=ConfigManager.getConfig("sys_hero.txt",this.heroArr[index]);
		var img=new HeroImage();
		img.setHeroId(sysHero.heroId);
		img.setScaleSize(cellUI.box.width,0);
		cellUI.box.addChild(img);
		cellUI.box.scrollRect=new Rectangle(0,0,cellUI.box.width,cellUI.box.height-3);
		cellUI.dengji.text="1";
		cellUI.name0.text=sysHero.heroName;
		cellUI.guojia.skin=GameUtils.getCountry(sysHero.heroCountry);
		cellUI.di.skin=GameUtils.getDi(sysHero.heroColor);
		cellUI.kaung.skin=GameUtils.getNoKuang(sysHero.heroColor);
		GameUtils.getKaKuang(cellUI.wk,sysHero.heroColor);
	}

	return TuijianWujiang;
})(tips_tjfjUI)


//class huamao.panel.zhaomu.mjl.ZhaoMuJl extends ui.SLGGAME.zhaomu_jlUI
var ZhaoMuJl=(function(_super){
	function ZhaoMuJl(){
		this.zhaoMuSession=null;
		ZhaoMuJl.__super.call(this);
		this.init();
	}

	__class(ZhaoMuJl,'huamao.panel.zhaomu.mjl.ZhaoMuJl',_super);
	var __proto=ZhaoMuJl.prototype;
	__proto.init=function(){
		App.injOne(this);
		this.list0.vScrollBarSkin="";
		this.list0.itemRender=JlItem;
		this.list0.renderHandler=new Handler(this,this.updateItem);
		this.zhaoMuSession.heroJl.sort(this.sortHandler);
		this.list0.array=this.zhaoMuSession.heroJl;
	}

	__proto.sortHandler=function(a,b){
		return b.timer-a.timer;
	}

	__proto.updateItem=function(cell,index){
		cell.setData(this.zhaoMuSession.heroJl[index]);
	}

	return ZhaoMuJl;
})(zhaomu_jlUI)


//class huamao.panel.zhaomu.ZhaoMuGengHuan extends ui.SLGGAME.zhaomu_ghUI
var ZhaoMuGengHuan=(function(_super){
	function ZhaoMuGengHuan(){
		this.zhaoMuSession=null;
		this.currIndex=0;
		ZhaoMuGengHuan.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(ZhaoMuGengHuan,'huamao.panel.zhaomu.ZhaoMuGengHuan',_super);
	var __proto=ZhaoMuGengHuan.prototype;
	__proto.init=function(){
		for(var i=0;i<4;i++){
			this["btn_"+i].on("click",this,this.clickFun,[i]);
		}
		this.btn_yes.on("click",this,this.closeFun);
		this.btn_no.on("click",this,this.oKFun);
		this.setBtn(this.zhaoMuSession.country);
	}

	__proto.oKFun=function(){
		this.zhaoMuSession.country=this.currIndex;
		App.eventManager.event("COUNTRYUPDATA");
		this.close();
	}

	__proto.closeFun=function(){
		this.close();
	}

	__proto.clickFun=function(index){
		if(this.zhaoMuSession.getGHCountry()){
			this.setBtn(index);
		}
	}

	__proto.setBtn=function(index){
		this.currIndex=index;
		for(var i=0;i<4;i++){
			var btn=this["btn_"+i];
			btn.disabled=true;
			if(i==0){
				btn.disabled=false;
				}else{
				if(this.zhaoMuSession.getGHCountry()){
					btn.disabled=false;
				}
			}
			if(i==index){
				btn.selected=true;
				}else{
				btn.selected=false;
			}
		}
	}

	return ZhaoMuGengHuan;
})(zhaomu_ghUI)


//class huamao.panel.zhaomu.ZhaomuPanel extends ui.SLGGAME.zhaomuUI
var ZhaomuPanel=(function(_super){
	function ZhaomuPanel(){
		ZhaomuPanel.__super.call(this);
	}

	__class(ZhaomuPanel,'huamao.panel.zhaomu.ZhaomuPanel',_super);
	return ZhaomuPanel;
})(zhaomuUI)


//class huamao.panel.zudui.YaoqingZudui extends ui.SLGGAME.npc_yqhyUI
var YaoqingZudui=(function(_super){
	function YaoqingZudui(){
		this.list=null;
		this.mapCitySession=null;
		YaoqingZudui.__super.call(this);
		App.injOne(this);
		this.init();
	}

	__class(YaoqingZudui,'huamao.panel.zudui.YaoqingZudui',_super);
	var __proto=YaoqingZudui.prototype;
	__proto.init=function(){
		this.list=new List();
		this.list.itemRender=ZuduiItem;
		this.list.repeatX=1;
		this.list.repeatY=5;
		this.list.spaceY=3;
		this.list.pos(39,108);
		this.list.renderHandler=new Handler(this,this.updateItem);
		this.list.hScrollBarSkin="";
		this.addChild(this.list);
		this.txt_0.wordWrap=true;
		this.txt_0.leading=15;
		this.tab0.on("change",this,this.selectFun);
		this.tab0.selectedIndex=0;
	}

	__proto.selectFun=function(){
		if(this.tab0.selectedIndex==0){
			this.txt_0.text=GameUtils.getTips(3013);
			this.txt1.text=GameUtils.getTips(3014);
			this.list.array=this.mapCitySession.zuduiList;
			}else{
			this.txt_0.text=GameUtils.getTips(3015);
			this.txt1.text=GameUtils.getTips(3016);
			this.list.array=this.mapCitySession.unionList;
		}
	}

	__proto.onUpdate=function(){
		this.list.refresh();
	}

	__proto.updateItem=function(item,index){
		item.update(item.dataSource);
	}

	__proto.popup=function(closeOther,showEffect){
		(closeOther===void 0)&& (closeOther=false);
		(showEffect===void 0)&& (showEffect=true);
		laya.ui.Dialog.prototype.popup.call(this,closeOther,showEffect);
	}

	return YaoqingZudui;
})(npc_yqhyUI)


//class huamao.utils.GameTipsView extends ui.SLGGAME.shangdian_2UI
var GameTipsView=(function(_super){
	function GameTipsView(){
		GameTipsView.__super.call(this);
		this.init();
	}

	__class(GameTipsView,'huamao.utils.GameTipsView',_super);
	var __proto=GameTipsView.prototype;
	__proto.init=function(){
		this.wenzi.style.fontSize=24;
		this.wenzi.style.color="#94a8dd";
		this.wenzi.innerHTML=GameUtils.lang(3009,[8,10]);
	}

	return GameTipsView;
})(shangdian_2UI)


	Laya.__init([EventDispatcher,LoaderManager,Browser,View,ShoucangPanel,Render,XingjunListItem,MilitaryView,AddHaoyou,GraphicAnimation,WaiJiaoPanel,WebGLFilter,FenxiangPanel,LocalStorage,DrawText,WebGLContext2D,ShaderCompile,Timer,AtlasGrid]);
	/**LayaGameStart**/
	new LayaSample();

})(window,document,Laya);

if (typeof define === 'function' && define.amd){
	define('laya.core', ['require', "exports"], function(require, exports) {
        'use strict';
        Object.defineProperty(exports, '__esModule', { value: true });
        for (var i in Laya) {
			var o = Laya[i];
            o && o.__isclass && (exports[i] = o);
        }
    });
}